{
    "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        group by i_item_id\n         union all\n        select NULL AS i_item_id, NULL as s_state, 1 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        ) foo\n  order by i_item_id, s_state\n limit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY27A.TPL QUERY 16 IN STREAM 0 */ /* TPC-DS QUERY27A.TPL 0.16 */ WITH RESULTS AS ( SELECT I_ITEM_ID , S_STATE , 0 AS G_STATE , SS_QUANTITY AS AGG1 , SS_LIST_PRICE AS AGG2 , SS_COUPON_AMT AS AGG3 , SS_SALES_PRICE AS AGG4 FROM STORE_SALES , CUSTOMER_DEMOGRAPHICS , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND SS_CDEMO_SK = CD_DEMO_SK AND CD_GENDER = 'F' AND CD_MARITAL_STATUS = 'S' AND CD_EDUCATION_STATUS = 'Advanced Degree' AND D_YEAR = 1999 AND S_STATE IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) ) SELECT I_ITEM_ID , S_STATE , G_STATE , AGG1 , AGG2 , AGG3 , AGG4 FROM ( SELECT I_ITEM_ID , S_STATE , 0 AS G_STATE , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 FROM RESULTS GROUP BY I_ITEM_ID , S_STATE UNION ALL SELECT I_ITEM_ID , NULL AS S_STATE , 1 AS G_STATE , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 FROM RESULTS GROUP BY I_ITEM_ID UNION ALL SELECT NULL AS I_ITEM_ID , NULL AS S_STATE , 1 AS G_STATE , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 FROM RESULTS ) AS FOO ORDER BY I_ITEM_ID NULLS FIRST , S_STATE NULLS FIRST LIMIT 21",
            "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0               None    None        1    50   75.79   192.61  37.90\n1   AAAAAAAAAAAABAAA    None        1    57   81.36   425.09  40.96\n2   AAAAAAAAAAAABAAA      MI        0    59   67.65   122.77  29.24\n3   AAAAAAAAAAAABAAA      MN        0    41   86.02   159.66  54.68\n4   AAAAAAAAAAAABAAA      SD        0    72   92.69   923.99  39.80\n5   AAAAAAAAAAAABAAA      TX        0    59   24.33     0.00   0.00\n6   AAAAAAAAAAAACAAA    None        1    52   84.45     0.00  59.89\n7   AAAAAAAAAAAACAAA      MI        0    57   98.20     0.00  82.05\n8   AAAAAAAAAAAACAAA      MN        0    41  100.73     0.00  51.02\n9   AAAAAAAAAAAACAAA      SD        0    65   21.42     0.00  13.18\n10  AAAAAAAAAAAACAAA      TX        0    46   62.86     0.00  55.94\n11  AAAAAAAAAAAAEAAA    None        1    46   87.55    46.95  46.52\n12  AAAAAAAAAAAAEAAA      MI        0    27  105.06     0.00  25.70\n13  AAAAAAAAAAAAEAAA      MN        0    56  109.77   103.30  75.87\n14  AAAAAAAAAAAAEAAA      NM        0    41    5.84     0.00   4.38\n15  AAAAAAAAAAAAEAAA      SD        0    58   50.26     0.00  46.23\n16  AAAAAAAAAAAAEAAA      TX        0    48   42.89     0.00   4.71\n17  AAAAAAAAAAABAAAA    None        1    44   65.23   409.46  41.79\n18  AAAAAAAAAAABAAAA      MI        0    21  104.43  1443.93  66.62\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 3.331951,
                "execution_time": 3.16406,
                "compile_time": 0.001292,
                "planning_time": 0.120791
            },
            "query_metrics_warm_up": {
                "elapsed_time": 14.579613,
                "execution_time": 14.332808,
                "compile_time": 0.001223,
                "planning_time": 0.197045
            }
        }
    ],
    "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0               None    None        1    50   75.79   192.61  37.90\n1   AAAAAAAAAAAABAAA    None        1    57   81.36   425.09  40.96\n2   AAAAAAAAAAAABAAA      MI        0    59   67.65   122.77  29.24\n3   AAAAAAAAAAAABAAA      MN        0    41   86.02   159.66  54.68\n4   AAAAAAAAAAAABAAA      SD        0    72   92.69   923.99  39.80\n5   AAAAAAAAAAAABAAA      TX        0    59   24.33     0.00   0.00\n6   AAAAAAAAAAAACAAA    None        1    52   84.45     0.00  59.89\n7   AAAAAAAAAAAACAAA      MI        0    57   98.20     0.00  82.05\n8   AAAAAAAAAAAACAAA      MN        0    41  100.73     0.00  51.02\n9   AAAAAAAAAAAACAAA      SD        0    65   21.42     0.00  13.18\n10  AAAAAAAAAAAACAAA      TX        0    46   62.86     0.00  55.94\n11  AAAAAAAAAAAAEAAA    None        1    46   87.55    46.95  46.52\n12  AAAAAAAAAAAAEAAA      MI        0    27  105.06     0.00  25.70\n13  AAAAAAAAAAAAEAAA      MN        0    56  109.77   103.30  75.87\n14  AAAAAAAAAAAAEAAA      NM        0    41    5.84     0.00   4.38\n15  AAAAAAAAAAAAEAAA      SD        0    58   50.26     0.00  46.23\n16  AAAAAAAAAAAAEAAA      TX        0    48   42.89     0.00   4.71\n17  AAAAAAAAAAABAAAA    None        1    44   65.23   409.46  41.79\n18  AAAAAAAAAAABAAAA      MI        0    21  104.43  1443.93  66.62\n...*/"
}