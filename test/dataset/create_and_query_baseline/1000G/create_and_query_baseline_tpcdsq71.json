{
    "input": "-- start template query71.tpl query 72 in stream 0\nselect /* TPC-DS query71.tpl 0.72 */ i_brand_id brand_id, i_brand brand,t_hour,t_minute,\n \tsum(ext_price) ext_price\n from item, (select ws_ext_sales_price as ext_price, \n                        ws_sold_date_sk as sold_date_sk,\n                        ws_item_sk as sold_item_sk,\n                        ws_sold_time_sk as time_sk  \n                 from web_sales,date_dim\n                 where d_date_sk = ws_sold_date_sk\n                   and d_moy=12\n                   and d_year=2001\n                 union all\n                 select cs_ext_sales_price as ext_price,\n                        cs_sold_date_sk as sold_date_sk,\n                        cs_item_sk as sold_item_sk,\n                        cs_sold_time_sk as time_sk\n                 from catalog_sales,date_dim\n                 where d_date_sk = cs_sold_date_sk\n                   and d_moy=12\n                   and d_year=2001\n                 union all\n                 select ss_ext_sales_price as ext_price,\n                        ss_sold_date_sk as sold_date_sk,\n                        ss_item_sk as sold_item_sk,\n                        ss_sold_time_sk as time_sk\n                 from store_sales,date_dim\n                 where d_date_sk = ss_sold_date_sk\n                   and d_moy=12\n                   and d_year=2001\n                 ) tmp,time_dim\n where\n   sold_item_sk = i_item_sk\n   and i_manager_id=1\n   and time_sk = t_time_sk\n   and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\n group by i_brand, i_brand_id,t_hour,t_minute\n order by ext_price desc, i_brand_id\nlimit 100\n ",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY71.TPL QUERY 72 IN STREAM 0 */ /* TPC-DS QUERY71.TPL 0.72 */ SELECT I_BRAND_ID AS BRAND_ID , I_BRAND AS BRAND , T_HOUR , T_MINUTE , SUM ( EXT_PRICE ) AS EXT_PRICE FROM ITEM , ( SELECT WS_EXT_SALES_PRICE AS EXT_PRICE , WS_SOLD_DATE_SK AS SOLD_DATE_SK , WS_ITEM_SK AS SOLD_ITEM_SK , WS_SOLD_TIME_SK AS TIME_SK FROM WEB_SALES , DATE_DIM WHERE D_DATE_SK = WS_SOLD_DATE_SK AND D_MOY = 12 AND D_YEAR = 2001 UNION ALL SELECT CS_EXT_SALES_PRICE AS EXT_PRICE , CS_SOLD_DATE_SK AS SOLD_DATE_SK , CS_ITEM_SK AS SOLD_ITEM_SK , CS_SOLD_TIME_SK AS TIME_SK FROM CATALOG_SALES , DATE_DIM WHERE D_DATE_SK = CS_SOLD_DATE_SK AND D_MOY = 12 AND D_YEAR = 2001 UNION ALL SELECT SS_EXT_SALES_PRICE AS EXT_PRICE , SS_SOLD_DATE_SK AS SOLD_DATE_SK , SS_ITEM_SK AS SOLD_ITEM_SK , SS_SOLD_TIME_SK AS TIME_SK FROM STORE_SALES , DATE_DIM WHERE D_DATE_SK = SS_SOLD_DATE_SK AND D_MOY = 12 AND D_YEAR = 2001 ) AS TMP , TIME_DIM WHERE SOLD_ITEM_SK = I_ITEM_SK AND I_MANAGER_ID = 1 AND TIME_SK = T_TIME_SK AND ( T_MEAL_TIME = 'breakfast' OR T_MEAL_TIME = 'dinner' ) GROUP BY I_BRAND , I_BRAND_ID , T_HOUR , T_MINUTE ORDER BY EXT_PRICE DESC NULLS LAST , I_BRAND_ID NULLS FIRST LIMIT 21",
            "preview": "\n/*    brand_id              brand  t_hour  t_minute  ext_price\n0    1001002      amalgamalg #2      17        14  322615.59\n1    1001002      amalgamalg #2      19        58  316740.31\n2    1001002      amalgamalg #2      19        57  314298.46\n3    3002002  importoexporti #2      19        28  295730.39\n4    2001002    amalgimporto #2      17        23  291764.55\n5    3002002  importoexporti #2      17        58  289134.72\n6    1001002      amalgamalg #2      19        13  284870.84\n7    3002002  importoexporti #2      17        38  283985.20\n8    2001002    amalgimporto #2      18         3  282338.64\n9    3002002  importoexporti #2      17         9  281742.27\n10   3002002  importoexporti #2      17        56  281588.33\n11   2001002    amalgimporto #2      17        51  281522.43\n12   1001002      amalgamalg #2      19        22  277648.66\n13   3002002  importoexporti #2      17        29  277317.67\n14   3002002  importoexporti #2      19        24  275335.95\n15   3002002  importoexporti #2      17        28  274626.41\n16   3002002  importoexporti #2      17         4  274476.21\n17   1001002      amalgamalg #2      17        42  274068.48\n18   3002002  importoexporti #2      17         2  271519.49\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.435555,
                "execution_time": 0.339566,
                "compile_time": 0.000497,
                "planning_time": 0.072287
            },
            "query_metrics_warm_up": {
                "elapsed_time": 7.317019,
                "execution_time": 0.642605,
                "compile_time": 6.520985,
                "planning_time": 0.15778
            }
        }
    ],
    "preview": "\n/*    brand_id              brand  t_hour  t_minute  ext_price\n0    1001002      amalgamalg #2      17        14  322615.59\n1    1001002      amalgamalg #2      19        58  316740.31\n2    1001002      amalgamalg #2      19        57  314298.46\n3    3002002  importoexporti #2      19        28  295730.39\n4    2001002    amalgimporto #2      17        23  291764.55\n5    3002002  importoexporti #2      17        58  289134.72\n6    1001002      amalgamalg #2      19        13  284870.84\n7    3002002  importoexporti #2      17        38  283985.20\n8    2001002    amalgimporto #2      18         3  282338.64\n9    3002002  importoexporti #2      17         9  281742.27\n10   3002002  importoexporti #2      17        56  281588.33\n11   2001002    amalgimporto #2      17        51  281522.43\n12   1001002      amalgamalg #2      19        22  277648.66\n13   3002002  importoexporti #2      17        29  277317.67\n14   3002002  importoexporti #2      19        24  275335.95\n15   3002002  importoexporti #2      17        28  274626.41\n16   3002002  importoexporti #2      17         4  274476.21\n17   1001002      amalgamalg #2      17        42  274068.48\n18   3002002  importoexporti #2      17         2  271519.49\n...*/"
}