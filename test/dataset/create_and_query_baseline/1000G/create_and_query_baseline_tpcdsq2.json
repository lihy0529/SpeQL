{
    "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n      ,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001+1) z\n where d_week_seq1=d_week_seq2-53\n order by d_week_seq1\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY2.TPL QUERY 84 IN STREAM 0 */ /* TPC-DS QUERY2.TPL 0.84 */ WITH WSCS AS ( SELECT SOLD_DATE_SK , SALES_PRICE FROM ( SELECT WS_SOLD_DATE_SK AS SOLD_DATE_SK , WS_EXT_SALES_PRICE AS SALES_PRICE FROM WEB_SALES UNION ALL SELECT CS_SOLD_DATE_SK AS SOLD_DATE_SK , CS_EXT_SALES_PRICE AS SALES_PRICE FROM CATALOG_SALES ) ) , WSWSCS AS ( SELECT D_WEEK_SEQ , SUM ( CASE WHEN ( D_DAY_NAME = 'Sunday' ) THEN SALES_PRICE ELSE NULL END ) AS SUN_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Monday' ) THEN SALES_PRICE ELSE NULL END ) AS MON_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Tuesday' ) THEN SALES_PRICE ELSE NULL END ) AS TUE_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Wednesday' ) THEN SALES_PRICE ELSE NULL END ) AS WED_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Thursday' ) THEN SALES_PRICE ELSE NULL END ) AS THU_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Friday' ) THEN SALES_PRICE ELSE NULL END ) AS FRI_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Saturday' ) THEN SALES_PRICE ELSE NULL END ) AS SAT_SALES FROM WSCS , DATE_DIM WHERE D_DATE_SK = SOLD_DATE_SK GROUP BY D_WEEK_SEQ ) SELECT D_WEEK_SEQ1 , ROUND ( SUN_SALES1 / SUN_SALES2 , 2 ) , ROUND ( MON_SALES1 / MON_SALES2 , 2 ) , ROUND ( TUE_SALES1 / TUE_SALES2 , 2 ) , ROUND ( WED_SALES1 / WED_SALES2 , 2 ) , ROUND ( THU_SALES1 / THU_SALES2 , 2 ) , ROUND ( FRI_SALES1 / FRI_SALES2 , 2 ) , ROUND ( SAT_SALES1 / SAT_SALES2 , 2 ) FROM ( SELECT WSWSCS.D_WEEK_SEQ AS D_WEEK_SEQ1 , SUN_SALES AS SUN_SALES1 , MON_SALES AS MON_SALES1 , TUE_SALES AS TUE_SALES1 , WED_SALES AS WED_SALES1 , THU_SALES AS THU_SALES1 , FRI_SALES AS FRI_SALES1 , SAT_SALES AS SAT_SALES1 FROM WSWSCS , DATE_DIM WHERE DATE_DIM.D_WEEK_SEQ = WSWSCS.D_WEEK_SEQ AND D_YEAR = 2001 ) AS Y , ( SELECT WSWSCS.D_WEEK_SEQ AS D_WEEK_SEQ2 , SUN_SALES AS SUN_SALES2 , MON_SALES AS MON_SALES2 , TUE_SALES AS TUE_SALES2 , WED_SALES AS WED_SALES2 , THU_SALES AS THU_SALES2 , FRI_SALES AS FRI_SALES2 , SAT_SALES AS SAT_SALES2 FROM WSWSCS , DATE_DIM WHERE DATE_DIM.D_WEEK_SEQ = WSWSCS.D_WEEK_SEQ AND D_YEAR = 2001 + 1 ) AS Z WHERE D_WEEK_SEQ1 = D_WEEK_SEQ2 - 53 ORDER BY D_WEEK_SEQ1 NULLS FIRST LIMIT 21",
            "preview": "\n/*    d_week_seq1  round  round  round  round  round  round  round\n0          5270   3.45   1.81   1.89   1.59   3.47   3.46   3.44\n1          5270   3.45   1.81   1.89   1.59   3.47   3.46   3.44\n2          5270   3.45   1.81   1.89   1.59   3.47   3.46   3.44\n3          5270   3.45   1.81   1.89   1.59   3.47   3.46   3.44\n4          5270   3.45   1.81   1.89   1.59   3.47   3.46   3.44\n5          5270   3.45   1.81   1.89   1.59   3.47   3.46   3.44\n6          5270   3.45   1.81   1.89   1.59   3.47   3.46   3.44\n7          5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n8          5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n9          5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n10         5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n11         5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n12         5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n13         5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n14         5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n15         5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n16         5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n17         5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n18         5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 11.116015,
                "execution_time": 10.929866,
                "compile_time": 0.000577,
                "planning_time": 11.081266
            },
            "query_metrics_warm_up": {
                "elapsed_time": 11.5867,
                "execution_time": 11.285264,
                "compile_time": 0.121092,
                "planning_time": 11.42772
            }
        }
    ],
    "preview": "\n/*    d_week_seq1  round  round  round  round  round  round  round\n0          5270   3.45   1.81   1.89   1.59   3.47   3.46   3.44\n1          5270   3.45   1.81   1.89   1.59   3.47   3.46   3.44\n2          5270   3.45   1.81   1.89   1.59   3.47   3.46   3.44\n3          5270   3.45   1.81   1.89   1.59   3.47   3.46   3.44\n4          5270   3.45   1.81   1.89   1.59   3.47   3.46   3.44\n5          5270   3.45   1.81   1.89   1.59   3.47   3.46   3.44\n6          5270   3.45   1.81   1.89   1.59   3.47   3.46   3.44\n7          5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n8          5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n9          5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n10         5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n11         5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n12         5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n13         5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n14         5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n15         5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n16         5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n17         5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n18         5271   0.99   1.00   1.00   1.00   1.00   1.00   1.00\n...*/"
}