{
    "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null\n             end) between 2.0/3.0 and 3.0/2.0\n order by w_warehouse_name\n         ,i_item_id\n limit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY21.TPL QUERY 14 IN STREAM 0 */ /* TPC-DS QUERY21.TPL 0.14 */ SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN INV_AFTER / INV_BEFORE ELSE NULL END ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0 ORDER BY W_WAREHOUSE_NAME NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
            "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAAAAAACAAA        2008       2751\n1                    AAAAAAAAAACGDAAA        2480       3432\n2                    AAAAAAAAAAEKCAAA        1840       1968\n3                    AAAAAAAAAAFGCAAA        1072       1932\n4                    AAAAAAAAAAGHAAAA        1891       2107\n5                    AAAAAAAAAAHDAAAA        1893       1898\n6                    AAAAAAAAAAILDAAA        2211       2837\n7                    AAAAAAAAAAKNCAAA        1103       2099\n8                    AAAAAAAAAALADAAA        1154       2013\n9                    AAAAAAAAAALHBAAA        1416       2549\n10                   AAAAAAAAAANJDAAA        1676       1754\n11                   AAAAAAAAAANKAAAA        2618       2888\n12                   AAAAAAAAABAGAAAA        1685       1977\n13                   AAAAAAAAABBIEAAA        2084       2084\n14                   AAAAAAAAABCBDAAA        1983       2141\n15                   AAAAAAAAABEECAAA        1259       1874\n16                   AAAAAAAAABEJCAAA        1167       1808\n17                   AAAAAAAAABGBCAAA        1373       2567\n18                   AAAAAAAAABGNCAAA        2045       2464\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.224593,
                "execution_time": 0.160058,
                "compile_time": 0.000294,
                "planning_time": 0.046881
            },
            "query_metrics_warm_up": {
                "elapsed_time": 0.338913,
                "execution_time": 0.272469,
                "compile_time": 0.000285,
                "planning_time": 0.046825
            }
        }
    ],
    "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAAAAAACAAA        2008       2751\n1                    AAAAAAAAAACGDAAA        2480       3432\n2                    AAAAAAAAAAEKCAAA        1840       1968\n3                    AAAAAAAAAAFGCAAA        1072       1932\n4                    AAAAAAAAAAGHAAAA        1891       2107\n5                    AAAAAAAAAAHDAAAA        1893       1898\n6                    AAAAAAAAAAILDAAA        2211       2837\n7                    AAAAAAAAAAKNCAAA        1103       2099\n8                    AAAAAAAAAALADAAA        1154       2013\n9                    AAAAAAAAAALHBAAA        1416       2549\n10                   AAAAAAAAAANJDAAA        1676       1754\n11                   AAAAAAAAAANKAAAA        2618       2888\n12                   AAAAAAAAABAGAAAA        1685       1977\n13                   AAAAAAAAABBIEAAA        2084       2084\n14                   AAAAAAAAABCBDAAA        1983       2141\n15                   AAAAAAAAABEECAAA        1259       1874\n16                   AAAAAAAAABEJCAAA        1167       1808\n17                   AAAAAAAAABGBCAAA        1373       2567\n18                   AAAAAAAAABGNCAAA        2045       2464\n...*/"
}