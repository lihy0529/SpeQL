{
    "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n         and t_w_secyear.dyear = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n         ,t_s_secyear.customer_last_name\n         ,t_s_secyear.customer_email_address\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY11.TPL QUERY 51 IN STREAM 0 */ /* TPC-DS QUERY11.TPL 0.51 */ WITH YEAR_TOTAL AS ( SELECT C_CUSTOMER_ID AS CUSTOMER_ID , C_FIRST_NAME AS CUSTOMER_FIRST_NAME , C_LAST_NAME AS CUSTOMER_LAST_NAME , C_PREFERRED_CUST_FLAG AS CUSTOMER_PREFERRED_CUST_FLAG , C_BIRTH_COUNTRY AS CUSTOMER_BIRTH_COUNTRY , C_LOGIN AS CUSTOMER_LOGIN , C_EMAIL_ADDRESS AS CUSTOMER_EMAIL_ADDRESS , D_YEAR AS DYEAR , SUM ( SS_EXT_LIST_PRICE - SS_EXT_DISCOUNT_AMT ) AS YEAR_TOTAL , 's' AS SALE_TYPE FROM CUSTOMER , STORE_SALES , DATE_DIM WHERE C_CUSTOMER_SK = SS_CUSTOMER_SK AND SS_SOLD_DATE_SK = D_DATE_SK GROUP BY C_CUSTOMER_ID , C_FIRST_NAME , C_LAST_NAME , C_PREFERRED_CUST_FLAG , C_BIRTH_COUNTRY , C_LOGIN , C_EMAIL_ADDRESS , D_YEAR UNION ALL SELECT C_CUSTOMER_ID AS CUSTOMER_ID , C_FIRST_NAME AS CUSTOMER_FIRST_NAME , C_LAST_NAME AS CUSTOMER_LAST_NAME , C_PREFERRED_CUST_FLAG AS CUSTOMER_PREFERRED_CUST_FLAG , C_BIRTH_COUNTRY AS CUSTOMER_BIRTH_COUNTRY , C_LOGIN AS CUSTOMER_LOGIN , C_EMAIL_ADDRESS AS CUSTOMER_EMAIL_ADDRESS , D_YEAR AS DYEAR , SUM ( WS_EXT_LIST_PRICE - WS_EXT_DISCOUNT_AMT ) AS YEAR_TOTAL , 'w' AS SALE_TYPE FROM CUSTOMER , WEB_SALES , DATE_DIM WHERE C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK AND WS_SOLD_DATE_SK = D_DATE_SK GROUP BY C_CUSTOMER_ID , C_FIRST_NAME , C_LAST_NAME , C_PREFERRED_CUST_FLAG , C_BIRTH_COUNTRY , C_LOGIN , C_EMAIL_ADDRESS , D_YEAR ) SELECT T_S_SECYEAR.CUSTOMER_ID , T_S_SECYEAR.CUSTOMER_FIRST_NAME , T_S_SECYEAR.CUSTOMER_LAST_NAME , T_S_SECYEAR.CUSTOMER_EMAIL_ADDRESS FROM YEAR_TOTAL AS T_S_FIRSTYEAR , YEAR_TOTAL AS T_S_SECYEAR , YEAR_TOTAL AS T_W_FIRSTYEAR , YEAR_TOTAL AS T_W_SECYEAR WHERE T_S_SECYEAR.CUSTOMER_ID = T_S_FIRSTYEAR.CUSTOMER_ID AND T_S_FIRSTYEAR.CUSTOMER_ID = T_W_SECYEAR.CUSTOMER_ID AND T_S_FIRSTYEAR.CUSTOMER_ID = T_W_FIRSTYEAR.CUSTOMER_ID AND T_S_FIRSTYEAR.SALE_TYPE = 's' AND T_W_FIRSTYEAR.SALE_TYPE = 'w' AND T_S_SECYEAR.SALE_TYPE = 's' AND T_W_SECYEAR.SALE_TYPE = 'w' AND T_S_FIRSTYEAR.DYEAR = 1998 AND T_S_SECYEAR.DYEAR = 1998 + 1 AND T_W_FIRSTYEAR.DYEAR = 1998 AND T_W_SECYEAR.DYEAR = 1998 + 1 AND T_S_FIRSTYEAR.YEAR_TOTAL > 0 AND T_W_FIRSTYEAR.YEAR_TOTAL > 0 AND CASE WHEN T_W_FIRSTYEAR.YEAR_TOTAL > 0 THEN T_W_SECYEAR.YEAR_TOTAL / T_W_FIRSTYEAR.YEAR_TOTAL ELSE 0.0 END > CASE WHEN T_S_FIRSTYEAR.YEAR_TOTAL > 0 THEN T_S_SECYEAR.YEAR_TOTAL / T_S_FIRSTYEAR.YEAR_TOTAL ELSE 0.0 END ORDER BY T_S_SECYEAR.CUSTOMER_ID NULLS FIRST , T_S_SECYEAR.CUSTOMER_FIRST_NAME NULLS FIRST , T_S_SECYEAR.CUSTOMER_LAST_NAME NULLS FIRST , T_S_SECYEAR.CUSTOMER_EMAIL_ADDRESS NULLS FIRST LIMIT 21",
            "preview": "\n/*         customer_id customer_first_name customer_last_name              customer_email_address\n0   AAAAAAAAAAAAACAA             Dorothy          Gillespie        Dorothy.Gillespie@aDt2Na.edu\n1   AAAAAAAAAAAAAKAA              Joshua            Padgett               Joshua.Padgett@lP.org\n2   AAAAAAAAAAAABBAA           Elizabeth              White  Elizabeth.White@2NyiyqHlYpTUFL.org\n3   AAAAAAAAAAAABCAA               Debra              Wirth       Debra.Wirth@VroihiPVFqNul.edu\n4   AAAAAAAAAAAABFAA              Joseph              Lauer            Joseph.Lauer@0a3SyTs.com\n5   AAAAAAAAAAAACDAA             Allison            Sellers   Allison.Sellers@Gn1UZJyv0s5Ub.org\n6   AAAAAAAAAAAADEAA               Karla             Ritter                  Karla.Ritter@p.edu\n7   AAAAAAAAAAAADKAA             Leonard             Wilson           Leonard.Wilson@MlZ6gz.com\n8   AAAAAAAAAAAAECAA              Harold            Stewart             Harold.Stewart@D5ps.com\n9   AAAAAAAAAAAAFBAA              Rodney           Guerrero    Rodney.Guerrero@I8kbFMLDyMGe.edu\n10  AAAAAAAAAAAAFFAA                Alma        Blankenship            Alma.Blankenship@UuN.com\n11  AAAAAAAAAAAAGKAA             Patrick             Horton                                    \n12  AAAAAAAAAAAAHJAA                Jodi             Miller         Jodi.Miller@SgSBdOk8VC4.org\n13  AAAAAAAAAAAAJEAA              Lillie           Olmstead    Lillie.Olmstead@TOvMNpyXBuib.edu\n14  AAAAAAAAAAAAJIAA            Jennette            Krueger            Jennette.Krueger@D3y.edu\n15  AAAAAAAAAAAAJKAA              Hollis              Lopez        Hollis.Lopez@CeRpBFIVbf3.edu\n16  AAAAAAAAAAAAKBAA                Tina              Brown       Tina.Brown@V83ciRCSUIioQq.edu\n17  AAAAAAAAAAAAKCAA             Charles            Crayton          Charles.Crayton@KmbR8j.com\n18  AAAAAAAAAAAALAAA               Cathy            Salinas     Cathy.Salinas@pcsIkF8IEmlAv.org\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 39.220191,
                "execution_time": 38.962337,
                "compile_time": 0.001751,
                "planning_time": 0.194388
            },
            "query_metrics_warm_up": {
                "elapsed_time": 38.975459,
                "execution_time": 38.664955,
                "compile_time": 0.001866,
                "planning_time": 0.245639
            }
        }
    ],
    "preview": "\n/*         customer_id customer_first_name customer_last_name              customer_email_address\n0   AAAAAAAAAAAAACAA             Dorothy          Gillespie        Dorothy.Gillespie@aDt2Na.edu\n1   AAAAAAAAAAAAAKAA              Joshua            Padgett               Joshua.Padgett@lP.org\n2   AAAAAAAAAAAABBAA           Elizabeth              White  Elizabeth.White@2NyiyqHlYpTUFL.org\n3   AAAAAAAAAAAABCAA               Debra              Wirth       Debra.Wirth@VroihiPVFqNul.edu\n4   AAAAAAAAAAAABFAA              Joseph              Lauer            Joseph.Lauer@0a3SyTs.com\n5   AAAAAAAAAAAACDAA             Allison            Sellers   Allison.Sellers@Gn1UZJyv0s5Ub.org\n6   AAAAAAAAAAAADEAA               Karla             Ritter                  Karla.Ritter@p.edu\n7   AAAAAAAAAAAADKAA             Leonard             Wilson           Leonard.Wilson@MlZ6gz.com\n8   AAAAAAAAAAAAECAA              Harold            Stewart             Harold.Stewart@D5ps.com\n9   AAAAAAAAAAAAFBAA              Rodney           Guerrero    Rodney.Guerrero@I8kbFMLDyMGe.edu\n10  AAAAAAAAAAAAFFAA                Alma        Blankenship            Alma.Blankenship@UuN.com\n11  AAAAAAAAAAAAGKAA             Patrick             Horton                                    \n12  AAAAAAAAAAAAHJAA                Jodi             Miller         Jodi.Miller@SgSBdOk8VC4.org\n13  AAAAAAAAAAAAJEAA              Lillie           Olmstead    Lillie.Olmstead@TOvMNpyXBuib.edu\n14  AAAAAAAAAAAAJIAA            Jennette            Krueger            Jennette.Krueger@D3y.edu\n15  AAAAAAAAAAAAJKAA              Hollis              Lopez        Hollis.Lopez@CeRpBFIVbf3.edu\n16  AAAAAAAAAAAAKBAA                Tina              Brown       Tina.Brown@V83ciRCSUIioQq.edu\n17  AAAAAAAAAAAAKCAA             Charles            Crayton          Charles.Crayton@KmbR8j.com\n18  AAAAAAAAAAAALAAA               Cathy            Salinas     Cathy.Salinas@pcsIkF8IEmlAv.org\n...*/"
}