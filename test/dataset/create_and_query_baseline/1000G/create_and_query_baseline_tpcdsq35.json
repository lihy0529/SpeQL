{
    "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n limit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY35A.TPL QUERY 47 IN STREAM 0 */ /* TPC-DS QUERY35A.TPL 0.47 */ SELECT CA_STATE , CD_GENDER , CD_MARITAL_STATUS , CD_DEP_COUNT , COUNT ( * ) AS CNT1 , MAX ( CD_DEP_COUNT ) , MIN ( CD_DEP_COUNT ) , MAX ( CD_DEP_COUNT ) , CD_DEP_EMPLOYED_COUNT , COUNT ( * ) AS CNT2 , MAX ( CD_DEP_EMPLOYED_COUNT ) , MIN ( CD_DEP_EMPLOYED_COUNT ) , MAX ( CD_DEP_EMPLOYED_COUNT ) , CD_DEP_COLLEGE_COUNT , COUNT ( * ) AS CNT3 , MAX ( CD_DEP_COLLEGE_COUNT ) , MIN ( CD_DEP_COLLEGE_COUNT ) , MAX ( CD_DEP_COLLEGE_COUNT ) FROM CUSTOMER AS C , CUSTOMER_ADDRESS AS CA , CUSTOMER_DEMOGRAPHICS WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK AND EXISTS ( SELECT * FROM STORE_SALES , DATE_DIM WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK AND SS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_QOY < 4 ) AND EXISTS ( SELECT * FROM ( SELECT WS_BILL_CUSTOMER_SK AS CUSTOMSK FROM WEB_SALES , DATE_DIM WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_QOY < 4 UNION ALL SELECT CS_SHIP_CUSTOMER_SK AS CUSTOMSK FROM CATALOG_SALES , DATE_DIM WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 1999 AND D_QOY < 4 ) AS X WHERE X.CUSTOMSK = C.C_CUSTOMER_SK ) GROUP BY CA_STATE , CD_GENDER , CD_MARITAL_STATUS , CD_DEP_COUNT , CD_DEP_EMPLOYED_COUNT , CD_DEP_COLLEGE_COUNT ORDER BY CA_STATE NULLS FIRST , CD_GENDER NULLS FIRST , CD_MARITAL_STATUS NULLS FIRST , CD_DEP_COUNT NULLS FIRST , CD_DEP_EMPLOYED_COUNT NULLS FIRST , CD_DEP_COLLEGE_COUNT NULLS FIRST LIMIT 21",
            "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  max  min  max  cd_dep_employed_count  cnt2  max  min  max  cd_dep_college_count  cnt3  max  min  max\n0                   F                 D             0    79    0    0    0                      0    79    0    0    0                     0    79    0    0    0\n1                   F                 D             0    80    0    0    0                      0    80    0    0    0                     1    80    1    1    1\n2                   F                 D             0    86    0    0    0                      0    86    0    0    0                     2    86    2    2    2\n3                   F                 D             0    92    0    0    0                      0    92    0    0    0                     3    92    3    3    3\n4                   F                 D             0    78    0    0    0                      0    78    0    0    0                     4    78    4    4    4\n5                   F                 D             0    69    0    0    0                      0    69    0    0    0                     5    69    5    5    5\n6                   F                 D             0    88    0    0    0                      0    88    0    0    0                     6    88    6    6    6\n7                   F                 D             0    93    0    0    0                      1    93    1    1    1                     0    93    0    0    0\n8                   F                 D             0    99    0    0    0                      1    99    1    1    1                     1    99    1    1    1\n9                   F                 D             0    76    0    0    0                      1    76    1    1    1                     2    76    2    2    2\n10                  F                 D             0    89    0    0    0                      1    89    1    1    1                     3    89    3    3    3\n11                  F                 D             0    97    0    0    0                      1    97    1    1    1                     4    97    4    4    4\n12                  F                 D             0    82    0    0    0                      1    82    1    1    1                     5    82    5    5    5\n13                  F                 D             0    77    0    0    0                      1    77    1    1    1                     6    77    6    6    6\n14                  F                 D             0    72    0    0    0                      2    72    2    2    2                     0    72    0    0    0\n15                  F                 D             0    76    0    0    0                      2    76    2    2    2                     1    76    1    1    1\n16                  F                 D             0    90    0    0    0                      2    90    2    2    2                     2    90    2    2    2\n17                  F                 D             0    92    0    0    0                      2    92    2    2    2                     3    92    3    3    3\n18                  F                 D             0    67    0    0    0                      2    67    2    2    2                     4    67    4    4    4\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 3.768761,
                "execution_time": 3.621344,
                "compile_time": 0.00076,
                "planning_time": 0.113445
            },
            "query_metrics_warm_up": {
                "elapsed_time": 24.703065,
                "execution_time": 3.91635,
                "compile_time": 20.734141,
                "planning_time": 0.201361
            }
        }
    ],
    "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  max  min  max  cd_dep_employed_count  cnt2  max  min  max  cd_dep_college_count  cnt3  max  min  max\n0                   F                 D             0    79    0    0    0                      0    79    0    0    0                     0    79    0    0    0\n1                   F                 D             0    80    0    0    0                      0    80    0    0    0                     1    80    1    1    1\n2                   F                 D             0    86    0    0    0                      0    86    0    0    0                     2    86    2    2    2\n3                   F                 D             0    92    0    0    0                      0    92    0    0    0                     3    92    3    3    3\n4                   F                 D             0    78    0    0    0                      0    78    0    0    0                     4    78    4    4    4\n5                   F                 D             0    69    0    0    0                      0    69    0    0    0                     5    69    5    5    5\n6                   F                 D             0    88    0    0    0                      0    88    0    0    0                     6    88    6    6    6\n7                   F                 D             0    93    0    0    0                      1    93    1    1    1                     0    93    0    0    0\n8                   F                 D             0    99    0    0    0                      1    99    1    1    1                     1    99    1    1    1\n9                   F                 D             0    76    0    0    0                      1    76    1    1    1                     2    76    2    2    2\n10                  F                 D             0    89    0    0    0                      1    89    1    1    1                     3    89    3    3    3\n11                  F                 D             0    97    0    0    0                      1    97    1    1    1                     4    97    4    4    4\n12                  F                 D             0    82    0    0    0                      1    82    1    1    1                     5    82    5    5    5\n13                  F                 D             0    77    0    0    0                      1    77    1    1    1                     6    77    6    6    6\n14                  F                 D             0    72    0    0    0                      2    72    2    2    2                     0    72    0    0    0\n15                  F                 D             0    76    0    0    0                      2    76    2    2    2                     1    76    1    1    1\n16                  F                 D             0    90    0    0    0                      2    90    2    2    2                     2    90    2    2    2\n17                  F                 D             0    92    0    0    0                      2    92    2    2    2                     3    92    3    3    3\n18                  F                 D             0    67    0    0    0                      2    67    2    2    2                     4    67    4    4    4\n...*/"
}