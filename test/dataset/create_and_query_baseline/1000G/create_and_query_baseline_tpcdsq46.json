{
    "input": "-- start template query46.tpl query 23 in stream 0\nselect /* TPC-DS query46.tpl 0.23 */  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 1)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('New Hope','Hamilton','Georgetown','Hillcrest','Walnut Grove') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY46.TPL QUERY 23 IN STREAM 0 */ /* TPC-DS QUERY46.TPL 0.23 */ SELECT C_LAST_NAME , C_FIRST_NAME , CA_CITY , BOUGHT_CITY , SS_TICKET_NUMBER , AMT , PROFIT FROM ( SELECT SS_TICKET_NUMBER , SS_CUSTOMER_SK , CA_CITY AS BOUGHT_CITY , SUM ( SS_COUPON_AMT ) AS AMT , SUM ( SS_NET_PROFIT ) AS PROFIT FROM STORE_SALES , DATE_DIM , STORE , HOUSEHOLD_DEMOGRAPHICS , CUSTOMER_ADDRESS WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK AND STORE_SALES.SS_ADDR_SK = CUSTOMER_ADDRESS.CA_ADDRESS_SK AND ( HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 9 OR HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT = 1 ) AND DATE_DIM.D_DOW IN ( 6 , 0 ) AND DATE_DIM.D_YEAR IN ( 1998 , 1998 + 1 , 1998 + 2 ) AND STORE.S_CITY IN ( 'New Hope' , 'Hamilton' , 'Georgetown' , 'Hillcrest' , 'Walnut Grove' ) GROUP BY SS_TICKET_NUMBER , SS_CUSTOMER_SK , SS_ADDR_SK , CA_CITY ) AS DN , CUSTOMER , CUSTOMER_ADDRESS AS CURRENT_ADDR WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK AND CUSTOMER.C_CURRENT_ADDR_SK = CURRENT_ADDR.CA_ADDRESS_SK AND CURRENT_ADDR.CA_CITY <> BOUGHT_CITY ORDER BY C_LAST_NAME NULLS FIRST , C_FIRST_NAME NULLS FIRST , CA_CITY NULLS FIRST , BOUGHT_CITY NULLS FIRST , SS_TICKET_NUMBER NULLS FIRST LIMIT 21",
            "preview": "\n/*   c_last_name c_first_name ca_city   bought_city  ss_ticket_number      amt    profit\n0                                         Antioch          13959875    92.07   -337.42\n1                                         Antioch         213202878  2703.95 -10616.54\n2                                        Appleton          77556551  1206.72 -13265.45\n3                                       Arlington          35541249  1463.43  -9076.00\n4                                         Ashland         151313043   205.44  -8391.06\n5                                         Ashland         199009029  4301.19  -8429.33\n6                                          Ashley          29164987  2030.50  -5497.35\n7                                          Ashley         214816627  1348.91  -9807.54\n8                                           Avoca         232947907  6480.07  -6314.55\n9                                           Berea         219253521    12.36  -8345.97\n10                                         Bethel          13151478     0.00  -3681.56\n11                                         Bethel         171485752   887.40  -3437.57\n12                                         Bethel         228907816  2075.31  -5360.73\n13                                   Blue Springs          21881423  3012.12  -9118.25\n14                                      Brentwood          74614839     0.00  -2779.74\n15                                      Brentwood         192891963  1386.16  -5357.00\n16                                     Bridgeport          36457879     0.00 -12965.87\n17                                     Bridgeport          52746415   205.90 -14433.27\n18                                     Bridgeport          71639252  1598.11  -6170.74\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 26.417813,
                "execution_time": 26.331799,
                "compile_time": 0.000473,
                "planning_time": 0.063839
            },
            "query_metrics_warm_up": {
                "elapsed_time": 36.289002,
                "execution_time": 25.777688,
                "compile_time": 10.608168,
                "planning_time": 0.144243
            }
        }
    ],
    "preview": "\n/*   c_last_name c_first_name ca_city   bought_city  ss_ticket_number      amt    profit\n0                                         Antioch          13959875    92.07   -337.42\n1                                         Antioch         213202878  2703.95 -10616.54\n2                                        Appleton          77556551  1206.72 -13265.45\n3                                       Arlington          35541249  1463.43  -9076.00\n4                                         Ashland         151313043   205.44  -8391.06\n5                                         Ashland         199009029  4301.19  -8429.33\n6                                          Ashley          29164987  2030.50  -5497.35\n7                                          Ashley         214816627  1348.91  -9807.54\n8                                           Avoca         232947907  6480.07  -6314.55\n9                                           Berea         219253521    12.36  -8345.97\n10                                         Bethel          13151478     0.00  -3681.56\n11                                         Bethel         171485752   887.40  -3437.57\n12                                         Bethel         228907816  2075.31  -5360.73\n13                                   Blue Springs          21881423  3012.12  -9118.25\n14                                      Brentwood          74614839     0.00  -2779.74\n15                                      Brentwood         192891963  1386.16  -5357.00\n16                                     Bridgeport          36457879     0.00 -12965.87\n17                                     Bridgeport          52746415   205.90 -14433.27\n18                                     Bridgeport          71639252  1598.11  -6170.74\n...*/"
}