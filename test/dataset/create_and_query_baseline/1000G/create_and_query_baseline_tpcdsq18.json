{
    "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id\n\tunion all\n\tselect NULL AS i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n ) foo\n order by ca_country, ca_state, ca_county, i_item_id\n limit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY18A.TPL QUERY 90 IN STREAM 0 */ /* TPC-DS QUERY18A.TPL 0.90 */ WITH RESULTS AS ( SELECT I_ITEM_ID , CA_COUNTRY , CA_STATE , CA_COUNTY , CAST ( CS_QUANTITY AS DECIMAL ( 12 , 2 ) ) AS AGG1 , CAST ( CS_LIST_PRICE AS DECIMAL ( 12 , 2 ) ) AS AGG2 , CAST ( CS_COUPON_AMT AS DECIMAL ( 12 , 2 ) ) AS AGG3 , CAST ( CS_SALES_PRICE AS DECIMAL ( 12 , 2 ) ) AS AGG4 , CAST ( CS_NET_PROFIT AS DECIMAL ( 12 , 2 ) ) AS AGG5 , CAST ( C_BIRTH_YEAR AS DECIMAL ( 12 , 2 ) ) AS AGG6 , CAST ( CD1.CD_DEP_COUNT AS DECIMAL ( 12 , 2 ) ) AS AGG7 FROM CATALOG_SALES , CUSTOMER_DEMOGRAPHICS AS CD1 , CUSTOMER_DEMOGRAPHICS AS CD2 , CUSTOMER , CUSTOMER_ADDRESS , DATE_DIM , ITEM WHERE CS_SOLD_DATE_SK = D_DATE_SK AND CS_ITEM_SK = I_ITEM_SK AND CS_BILL_CDEMO_SK = CD1.CD_DEMO_SK AND CS_BILL_CUSTOMER_SK = C_CUSTOMER_SK AND CD1.CD_GENDER = 'M' AND CD1.CD_EDUCATION_STATUS = 'Primary' AND C_CURRENT_CDEMO_SK = CD2.CD_DEMO_SK AND C_CURRENT_ADDR_SK = CA_ADDRESS_SK AND C_BIRTH_MONTH IN ( 9 , 5 , 1 , 2 , 3 , 8 ) AND D_YEAR = 1999 AND CA_STATE IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) SELECT I_ITEM_ID , CA_COUNTRY , CA_STATE , CA_COUNTY , AGG1 , AGG2 , AGG3 , AGG4 , AGG5 , AGG6 , AGG7 FROM ( SELECT I_ITEM_ID , CA_COUNTRY , CA_STATE , CA_COUNTY , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 , AVG ( AGG5 ) AS AGG5 , AVG ( AGG6 ) AS AGG6 , AVG ( AGG7 ) AS AGG7 FROM RESULTS GROUP BY I_ITEM_ID , CA_COUNTRY , CA_STATE , CA_COUNTY UNION ALL SELECT I_ITEM_ID , CA_COUNTRY , CA_STATE , NULL AS COUNTY , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 , AVG ( AGG5 ) AS AGG5 , AVG ( AGG6 ) AS AGG6 , AVG ( AGG7 ) AS AGG7 FROM RESULTS GROUP BY I_ITEM_ID , CA_COUNTRY , CA_STATE UNION ALL SELECT I_ITEM_ID , CA_COUNTRY , NULL AS CA_STATE , NULL AS COUNTY , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 , AVG ( AGG5 ) AS AGG5 , AVG ( AGG6 ) AS AGG6 , AVG ( AGG7 ) AS AGG7 FROM RESULTS GROUP BY I_ITEM_ID , CA_COUNTRY UNION ALL SELECT I_ITEM_ID , NULL AS CA_COUNTRY , NULL AS CA_STATE , NULL AS COUNTY , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 , AVG ( AGG5 ) AS AGG5 , AVG ( AGG6 ) AS AGG6 , AVG ( AGG7 ) AS AGG7 FROM RESULTS GROUP BY I_ITEM_ID UNION ALL SELECT NULL AS I_ITEM_ID , NULL AS CA_COUNTRY , NULL AS CA_STATE , NULL AS COUNTY , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 , AVG ( AGG5 ) AS AGG5 , AVG ( AGG6 ) AS AGG6 , AVG ( AGG7 ) AS AGG7 FROM RESULTS ) AS FOO ORDER BY CA_COUNTRY NULLS FIRST , CA_STATE NULLS FIRST , CA_COUNTY NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
            "preview": "\n/*           i_item_id ca_country ca_state ca_county   agg1    agg2     agg3   agg4     agg5     agg6  agg7\n0               None       None     None      None  50.45  100.85   255.72  50.36  -259.73  1958.01  3.00\n1   AAAAAAAAAAAABAAA       None     None      None  35.70  110.77   130.31  57.47   108.86  1957.30  3.40\n2   AAAAAAAAAAAACAAA       None     None      None  67.69  134.79  1130.62  85.06   454.19  1961.23  3.00\n3   AAAAAAAAAAAAEAAA       None     None      None  49.83  114.83    15.69  48.21   293.61  1962.33  2.83\n4   AAAAAAAAAAABAAAA       None     None      None  45.68   91.89   214.26  46.59  -567.95  1957.78  3.31\n5   AAAAAAAAAAABBAAA       None     None      None  44.75  114.88     0.00  59.42  -406.22  1959.37  2.50\n6   AAAAAAAAAAABDAAA       None     None      None  28.55   98.62   348.88  61.85   292.31  1954.55  3.33\n7   AAAAAAAAAAABEAAA       None     None      None  43.66  114.52   490.64  83.43   905.82  1953.06  2.80\n8   AAAAAAAAAAACAAAA       None     None      None  44.61  109.25     2.43  42.90 -1091.48  1954.46  4.23\n9   AAAAAAAAAAACCAAA       None     None      None  53.54   74.82     0.00  22.53  -818.61  1962.54  4.18\n10  AAAAAAAAAAACDAAA       None     None      None  60.54   97.89   692.06  59.22   400.11  1954.00  3.81\n11  AAAAAAAAAAADBAAA       None     None      None  37.22   88.40    67.21  36.51  -403.50  1957.66  2.00\n12  AAAAAAAAAAADCAAA       None     None      None  66.16  110.25    54.92  36.42 -1005.78  1962.00  2.50\n13  AAAAAAAAAAADEAAA       None     None      None  55.10  118.90    33.86  61.25 -1136.37  1957.80  1.90\n14  AAAAAAAAAAAEAAAA       None     None      None  42.14   96.93   174.85  51.52    20.28  1958.76  3.28\n15  AAAAAAAAAAAEBAAA       None     None      None  52.16  106.38   503.44  63.50   181.79  1951.50  2.16\n16  AAAAAAAAAAAEDAAA       None     None      None  48.00   82.61   482.22  40.09  -488.30  1959.66  2.30\n17  AAAAAAAAAAAEEAAA       None     None      None  52.11  123.35   795.89  66.15   950.35  1943.77  2.88\n18  AAAAAAAAAAAFAAAA       None     None      None  54.50  105.54  1448.83  75.22  1043.90  1949.12  2.87\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 4.650832,
                "execution_time": 4.280086,
                "compile_time": 0.003066,
                "planning_time": 0.245275
            },
            "query_metrics_warm_up": {
                "elapsed_time": 61.521348,
                "execution_time": 10.218168,
                "compile_time": 50.834024,
                "planning_time": 0.330269
            }
        }
    ],
    "preview": "\n/*           i_item_id ca_country ca_state ca_county   agg1    agg2     agg3   agg4     agg5     agg6  agg7\n0               None       None     None      None  50.45  100.85   255.72  50.36  -259.73  1958.01  3.00\n1   AAAAAAAAAAAABAAA       None     None      None  35.70  110.77   130.31  57.47   108.86  1957.30  3.40\n2   AAAAAAAAAAAACAAA       None     None      None  67.69  134.79  1130.62  85.06   454.19  1961.23  3.00\n3   AAAAAAAAAAAAEAAA       None     None      None  49.83  114.83    15.69  48.21   293.61  1962.33  2.83\n4   AAAAAAAAAAABAAAA       None     None      None  45.68   91.89   214.26  46.59  -567.95  1957.78  3.31\n5   AAAAAAAAAAABBAAA       None     None      None  44.75  114.88     0.00  59.42  -406.22  1959.37  2.50\n6   AAAAAAAAAAABDAAA       None     None      None  28.55   98.62   348.88  61.85   292.31  1954.55  3.33\n7   AAAAAAAAAAABEAAA       None     None      None  43.66  114.52   490.64  83.43   905.82  1953.06  2.80\n8   AAAAAAAAAAACAAAA       None     None      None  44.61  109.25     2.43  42.90 -1091.48  1954.46  4.23\n9   AAAAAAAAAAACCAAA       None     None      None  53.54   74.82     0.00  22.53  -818.61  1962.54  4.18\n10  AAAAAAAAAAACDAAA       None     None      None  60.54   97.89   692.06  59.22   400.11  1954.00  3.81\n11  AAAAAAAAAAADBAAA       None     None      None  37.22   88.40    67.21  36.51  -403.50  1957.66  2.00\n12  AAAAAAAAAAADCAAA       None     None      None  66.16  110.25    54.92  36.42 -1005.78  1962.00  2.50\n13  AAAAAAAAAAADEAAA       None     None      None  55.10  118.90    33.86  61.25 -1136.37  1957.80  1.90\n14  AAAAAAAAAAAEAAAA       None     None      None  42.14   96.93   174.85  51.52    20.28  1958.76  3.28\n15  AAAAAAAAAAAEBAAA       None     None      None  52.16  106.38   503.44  63.50   181.79  1951.50  2.16\n16  AAAAAAAAAAAEDAAA       None     None      None  48.00   82.61   482.22  40.09  -488.30  1959.66  2.30\n17  AAAAAAAAAAAEEAAA       None     None      None  52.11  123.35   795.89  66.15   950.35  1943.77  2.88\n18  AAAAAAAAAAAFAAAA       None     None      None  54.50  105.54  1448.83  75.22  1043.90  1949.12  2.87\n...*/"
}