{
    "input": "-- start template query56.tpl query 83 in stream 0\nwith /* TPC-DS query56.tpl 0.83 */ ss as (\n select i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where i_item_id in (select\n     i_item_id\nfrom item\nwhere i_color in ('lavender','rose','beige'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 2000\n and     d_moy                   = 4\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\n cs as (\n select i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom item\nwhere i_color in ('lavender','rose','beige'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 2000\n and     d_moy                   = 4\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6 \n group by i_item_id),\n ws as (\n select i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom item\nwhere i_color in ('lavender','rose','beige'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 2000\n and     d_moy                   = 4\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -6\n group by i_item_id)\n  select  i_item_id ,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by total_sales,\n          i_item_id\n limit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY56.TPL QUERY 83 IN STREAM 0 */ /* TPC-DS QUERY56.TPL 0.83 */ WITH SS AS ( SELECT I_ITEM_ID , SUM ( SS_EXT_SALES_PRICE ) AS TOTAL_SALES FROM STORE_SALES , DATE_DIM , CUSTOMER_ADDRESS , ITEM WHERE I_ITEM_ID IN ( SELECT I_ITEM_ID FROM ITEM WHERE I_COLOR IN ( 'lavender' , 'rose' , 'beige' ) ) AND SS_ITEM_SK = I_ITEM_SK AND SS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 2000 AND D_MOY = 4 AND SS_ADDR_SK = CA_ADDRESS_SK AND CA_GMT_OFFSET = -6 GROUP BY I_ITEM_ID ) , CS AS ( SELECT I_ITEM_ID , SUM ( CS_EXT_SALES_PRICE ) AS TOTAL_SALES FROM CATALOG_SALES , DATE_DIM , CUSTOMER_ADDRESS , ITEM WHERE I_ITEM_ID IN ( SELECT I_ITEM_ID FROM ITEM WHERE I_COLOR IN ( 'lavender' , 'rose' , 'beige' ) ) AND CS_ITEM_SK = I_ITEM_SK AND CS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 2000 AND D_MOY = 4 AND CS_BILL_ADDR_SK = CA_ADDRESS_SK AND CA_GMT_OFFSET = -6 GROUP BY I_ITEM_ID ) , WS AS ( SELECT I_ITEM_ID , SUM ( WS_EXT_SALES_PRICE ) AS TOTAL_SALES FROM WEB_SALES , DATE_DIM , CUSTOMER_ADDRESS , ITEM WHERE I_ITEM_ID IN ( SELECT I_ITEM_ID FROM ITEM WHERE I_COLOR IN ( 'lavender' , 'rose' , 'beige' ) ) AND WS_ITEM_SK = I_ITEM_SK AND WS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 2000 AND D_MOY = 4 AND WS_BILL_ADDR_SK = CA_ADDRESS_SK AND CA_GMT_OFFSET = -6 GROUP BY I_ITEM_ID ) SELECT I_ITEM_ID , SUM ( TOTAL_SALES ) AS TOTAL_SALES FROM ( SELECT * FROM SS UNION ALL SELECT * FROM CS UNION ALL SELECT * FROM WS ) AS TMP1 GROUP BY I_ITEM_ID ORDER BY TOTAL_SALES NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
            "preview": "\n/*           i_item_id  total_sales\n0   AAAAAAAAGOCJAAAA    169382.97\n1   AAAAAAAAECICEAAA    173611.43\n2   AAAAAAAAIIOIAAAA    176157.10\n3   AAAAAAAAGANGEAAA    176274.82\n4   AAAAAAAAGDGEEAAA    177116.45\n5   AAAAAAAACAHOCAAA    177189.43\n6   AAAAAAAAANHADAAA    181717.24\n7   AAAAAAAAMLBJBAAA    181724.86\n8   AAAAAAAAIFJMDAAA    182228.16\n9   AAAAAAAACGOEAAAA    183087.44\n10  AAAAAAAANJODBAAA    183170.22\n11  AAAAAAAAGGNMDAAA    184196.24\n12  AAAAAAAAPBEIDAAA    184624.26\n13  AAAAAAAAAHBCAAAA    185390.07\n14  AAAAAAAAMLOECAAA    186194.77\n15  AAAAAAAAIEHBDAAA    186468.91\n16  AAAAAAAAALNICAAA    186826.05\n17  AAAAAAAAEAJMBAAA    187353.78\n18  AAAAAAAAEHHOCAAA    188622.16\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.661894,
                "execution_time": 0.440561,
                "compile_time": 0.037542,
                "planning_time": 0.215559
            },
            "query_metrics_warm_up": {
                "elapsed_time": 20.239574,
                "execution_time": 3.08362,
                "compile_time": 16.94197,
                "planning_time": 3.615897
            }
        }
    ],
    "preview": "\n/*           i_item_id  total_sales\n0   AAAAAAAAGOCJAAAA    169382.97\n1   AAAAAAAAECICEAAA    173611.43\n2   AAAAAAAAIIOIAAAA    176157.10\n3   AAAAAAAAGANGEAAA    176274.82\n4   AAAAAAAAGDGEEAAA    177116.45\n5   AAAAAAAACAHOCAAA    177189.43\n6   AAAAAAAAANHADAAA    181717.24\n7   AAAAAAAAMLBJBAAA    181724.86\n8   AAAAAAAAIFJMDAAA    182228.16\n9   AAAAAAAACGOEAAAA    183087.44\n10  AAAAAAAANJODBAAA    183170.22\n11  AAAAAAAAGGNMDAAA    184196.24\n12  AAAAAAAAPBEIDAAA    184624.26\n13  AAAAAAAAAHBCAAAA    185390.07\n14  AAAAAAAAMLOECAAA    186194.77\n15  AAAAAAAAIEHBDAAA    186468.91\n16  AAAAAAAAALNICAAA    186826.05\n17  AAAAAAAAEAJMBAAA    187353.78\n18  AAAAAAAAEHHOCAAA    188622.16\n...*/"
}