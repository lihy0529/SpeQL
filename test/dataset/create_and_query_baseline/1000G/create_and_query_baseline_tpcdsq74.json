{
    "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n         and t_w_secyear.year = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n order by 2,3,1\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY74.TPL QUERY 76 IN STREAM 0 */ /* TPC-DS QUERY74.TPL 0.76 */ WITH YEAR_TOTAL AS ( SELECT C_CUSTOMER_ID AS CUSTOMER_ID , C_FIRST_NAME AS CUSTOMER_FIRST_NAME , C_LAST_NAME AS CUSTOMER_LAST_NAME , D_YEAR AS YEAR , MAX ( SS_NET_PAID ) AS YEAR_TOTAL , 's' AS SALE_TYPE FROM CUSTOMER , STORE_SALES , DATE_DIM WHERE C_CUSTOMER_SK = SS_CUSTOMER_SK AND SS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR IN ( 1998 , 1998 + 1 ) GROUP BY C_CUSTOMER_ID , C_FIRST_NAME , C_LAST_NAME , D_YEAR UNION ALL SELECT C_CUSTOMER_ID AS CUSTOMER_ID , C_FIRST_NAME AS CUSTOMER_FIRST_NAME , C_LAST_NAME AS CUSTOMER_LAST_NAME , D_YEAR AS YEAR , MAX ( WS_NET_PAID ) AS YEAR_TOTAL , 'w' AS SALE_TYPE FROM CUSTOMER , WEB_SALES , DATE_DIM WHERE C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK AND WS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR IN ( 1998 , 1998 + 1 ) GROUP BY C_CUSTOMER_ID , C_FIRST_NAME , C_LAST_NAME , D_YEAR ) SELECT T_S_SECYEAR.CUSTOMER_ID , T_S_SECYEAR.CUSTOMER_FIRST_NAME , T_S_SECYEAR.CUSTOMER_LAST_NAME FROM YEAR_TOTAL AS T_S_FIRSTYEAR , YEAR_TOTAL AS T_S_SECYEAR , YEAR_TOTAL AS T_W_FIRSTYEAR , YEAR_TOTAL AS T_W_SECYEAR WHERE T_S_SECYEAR.CUSTOMER_ID = T_S_FIRSTYEAR.CUSTOMER_ID AND T_S_FIRSTYEAR.CUSTOMER_ID = T_W_SECYEAR.CUSTOMER_ID AND T_S_FIRSTYEAR.CUSTOMER_ID = T_W_FIRSTYEAR.CUSTOMER_ID AND T_S_FIRSTYEAR.SALE_TYPE = 's' AND T_W_FIRSTYEAR.SALE_TYPE = 'w' AND T_S_SECYEAR.SALE_TYPE = 's' AND T_W_SECYEAR.SALE_TYPE = 'w' AND T_S_FIRSTYEAR.YEAR = 1998 AND T_S_SECYEAR.YEAR = 1998 + 1 AND T_W_FIRSTYEAR.YEAR = 1998 AND T_W_SECYEAR.YEAR = 1998 + 1 AND T_S_FIRSTYEAR.YEAR_TOTAL > 0 AND T_W_FIRSTYEAR.YEAR_TOTAL > 0 AND CASE WHEN T_W_FIRSTYEAR.YEAR_TOTAL > 0 THEN T_W_SECYEAR.YEAR_TOTAL / T_W_FIRSTYEAR.YEAR_TOTAL ELSE NULL END > CASE WHEN T_S_FIRSTYEAR.YEAR_TOTAL > 0 THEN T_S_SECYEAR.YEAR_TOTAL / T_S_FIRSTYEAR.YEAR_TOTAL ELSE NULL END ORDER BY 2 NULLS FIRST , 3 NULLS FIRST , 1 NULLS FIRST LIMIT 21",
            "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAAAACNAAA                                       \n1   AAAAAAAAAAAEABAA                                       \n2   AAAAAAAAAAAEAHAA                                       \n3   AAAAAAAAAAAGBKAA                                       \n4   AAAAAAAAAAAHLHAA                                       \n5   AAAAAAAAAAANKJAA                                       \n6   AAAAAAAAAAAOPAAA                                       \n7   AAAAAAAAAAAPOBAA                                       \n8   AAAAAAAAAAAPPBAA                                       \n9   AAAAAAAAAABBFBAA                                       \n10  AAAAAAAAAABBJHAA                                       \n11  AAAAAAAAAABBMFAA                                       \n12  AAAAAAAAAABBNJAA                                       \n13  AAAAAAAAAABCNIAA                                       \n14  AAAAAAAAAABEHGAA                                       \n15  AAAAAAAAAABLKEAA                                       \n16  AAAAAAAAAABLMCAA                                       \n17  AAAAAAAAAABMEGAA                                       \n18  AAAAAAAAAACADIAA                                       \n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 26.608714,
                "execution_time": 26.387451,
                "compile_time": 0.001566,
                "planning_time": 0.163716
            },
            "query_metrics_warm_up": {
                "elapsed_time": 52.784044,
                "execution_time": 26.542289,
                "compile_time": 26.468939,
                "planning_time": 0.242011
            }
        }
    ],
    "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAAAACNAAA                                       \n1   AAAAAAAAAAAEABAA                                       \n2   AAAAAAAAAAAEAHAA                                       \n3   AAAAAAAAAAAGBKAA                                       \n4   AAAAAAAAAAAHLHAA                                       \n5   AAAAAAAAAAANKJAA                                       \n6   AAAAAAAAAAAOPAAA                                       \n7   AAAAAAAAAAAPOBAA                                       \n8   AAAAAAAAAAAPPBAA                                       \n9   AAAAAAAAAABBFBAA                                       \n10  AAAAAAAAAABBJHAA                                       \n11  AAAAAAAAAABBMFAA                                       \n12  AAAAAAAAAABBNJAA                                       \n13  AAAAAAAAAABCNIAA                                       \n14  AAAAAAAAAABEHGAA                                       \n15  AAAAAAAAAABLKEAA                                       \n16  AAAAAAAAAABLMCAA                                       \n17  AAAAAAAAAABMEGAA                                       \n18  AAAAAAAAAACADIAA                                       \n...*/"
}