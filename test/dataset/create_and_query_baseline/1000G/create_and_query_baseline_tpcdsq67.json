{
    "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n        ,s_store_id\n        ,sumsales\n        ,rk\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY67A.TPL QUERY 35 IN STREAM 0 */ /* TPC-DS QUERY67A.TPL 0.35 */ WITH RESULTS AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUM ( COALESCE ( SS_SALES_PRICE * SS_QUANTITY , 0 ) ) AS SUMSALES FROM STORE_SALES , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1219 AND 1219 + 11 GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID ) , RESULTS_ROLLUP AS ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES FROM RESULTS UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME UNION ALL SELECT I_CATEGORY , I_CLASS , I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS , I_BRAND UNION ALL SELECT I_CATEGORY , I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY , I_CLASS UNION ALL SELECT I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS GROUP BY I_CATEGORY UNION ALL SELECT NULL AS I_CATEGORY , NULL AS I_CLASS , NULL AS I_BRAND , NULL AS I_PRODUCT_NAME , NULL AS D_YEAR , NULL AS D_QOY , NULL AS D_MOY , NULL AS S_STORE_ID , SUM ( SUMSALES ) AS SUMSALES FROM RESULTS ) SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , I_PRODUCT_NAME , D_YEAR , D_QOY , D_MOY , S_STORE_ID , SUMSALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY ORDER BY SUMSALES DESC NULLS LAST ) AS RK FROM RESULTS_ROLLUP ) AS DW2 WHERE RK <= 100 ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_BRAND NULLS FIRST , I_PRODUCT_NAME NULLS FIRST , D_YEAR NULLS FIRST , D_QOY NULLS FIRST , D_MOY NULLS FIRST , S_STORE_ID NULLS FIRST , SUMSALES NULLS FIRST , RK NULLS FIRST LIMIT 21",
            "preview": "\n/*   i_category i_class i_brand i_product_name  d_year  d_qoy  d_moy s_store_id      sumsales  rk\n0        None    None    None           None     NaN    NaN    NaN       None  1.008865e+12   1\n1                None    None           None     NaN    NaN    NaN       None  2.458211e+09   1\n2                        None           None     NaN    NaN    NaN       None  1.266935e+09   2\n3                                       None     NaN    NaN    NaN       None  6.464834e+08   3\n4                                                NaN    NaN    NaN       None  3.476400e+08   4\n5                                             2001.0    NaN    NaN       None  2.382185e+08   5\n6                                             2001.0    3.0    NaN       None  8.000812e+07   8\n7                                             2001.0    3.0    8.0       None  3.919845e+07  23\n8                                             2001.0    3.0    9.0       None  3.948175e+07  21\n9                                             2001.0    4.0    NaN       None  1.582104e+08   6\n10                                            2001.0    4.0   10.0       None  3.943181e+07  22\n11                                            2001.0    4.0   11.0       None  5.742051e+07  10\n12                                            2001.0    4.0   12.0       None  6.135803e+07   9\n13                                            2002.0    NaN    NaN       None  1.094216e+08   7\n14                                            2002.0    1.0    NaN       None  4.751884e+07  12\n15                                            2002.0    1.0    1.0       None  1.829335e+07  63\n16                                            2002.0    1.0    2.0       None  1.427523e+07  93\n17                                            2002.0    1.0    3.0       None  1.440033e+07  92\n18                                            2002.0    2.0    NaN       None  4.669927e+07  14\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 505.866642,
                "execution_time": 505.406857,
                "compile_time": 0.00268,
                "planning_time": 0.36124
            },
            "query_metrics_warm_up": {
                "elapsed_time": 525.711213,
                "execution_time": 500.278238,
                "compile_time": 25.232892,
                "planning_time": 0.377425
            }
        }
    ],
    "preview": "\n/*   i_category i_class i_brand i_product_name  d_year  d_qoy  d_moy s_store_id      sumsales  rk\n0        None    None    None           None     NaN    NaN    NaN       None  1.008865e+12   1\n1                None    None           None     NaN    NaN    NaN       None  2.458211e+09   1\n2                        None           None     NaN    NaN    NaN       None  1.266935e+09   2\n3                                       None     NaN    NaN    NaN       None  6.464834e+08   3\n4                                                NaN    NaN    NaN       None  3.476400e+08   4\n5                                             2001.0    NaN    NaN       None  2.382185e+08   5\n6                                             2001.0    3.0    NaN       None  8.000812e+07   8\n7                                             2001.0    3.0    8.0       None  3.919845e+07  23\n8                                             2001.0    3.0    9.0       None  3.948175e+07  21\n9                                             2001.0    4.0    NaN       None  1.582104e+08   6\n10                                            2001.0    4.0   10.0       None  3.943181e+07  22\n11                                            2001.0    4.0   11.0       None  5.742051e+07  10\n12                                            2001.0    4.0   12.0       None  6.135803e+07   9\n13                                            2002.0    NaN    NaN       None  1.094216e+08   7\n14                                            2002.0    1.0    NaN       None  4.751884e+07  12\n15                                            2002.0    1.0    1.0       None  1.829335e+07  63\n16                                            2002.0    1.0    2.0       None  1.427523e+07  93\n17                                            2002.0    1.0    3.0       None  1.440033e+07  92\n18                                            2002.0    2.0    NaN       None  4.669927e+07  14\n...*/"
}