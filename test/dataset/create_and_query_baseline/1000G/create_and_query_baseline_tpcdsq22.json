{
    "input": "-- start template query22a.tpl query 55 in stream 0\nwith /* TPC-DS query22a.tpl 0.55 */ results as \n(select  i_product_name\n             ,i_brand\n             ,i_class\n             ,i_category\n             ,avg(inv_quantity_on_hand) qoh\n       from inventory\n           ,date_dim\n           ,item\n--         ,warehouse\n       where  inv_date_sk=d_date_sk\n              and inv_item_sk=i_item_sk\n--            and inv_warehouse_sk = w_warehouse_sk\n              and d_month_seq between 1183 and 1183 + 11\n       group by i_product_name,i_brand,i_class,i_category),\nresults_rollup as \n(select i_product_name, i_brand, i_class, i_category,avg(qoh) qoh \nfrom results \ngroup by i_product_name,i_brand,i_class,i_category\nunion all \nselect i_product_name, i_brand, i_class, null i_category,avg(qoh) qoh \nfrom results\ngroup by i_product_name,i_brand,i_class\nunion all \nselect i_product_name, i_brand, null i_class, null i_category,avg(qoh) qoh \nfrom results\ngroup by i_product_name,i_brand\nunion all \nselect i_product_name, null i_brand, null i_class, null i_category,avg(qoh)  qoh \nfrom results\ngroup by i_product_name\nunion all \nselect null i_product_name, null i_brand, null i_class, null i_category,avg(qoh) qoh \nfrom results)\n select  i_product_name, i_brand, i_class, i_category,qoh\n      from results_rollup\n      order by qoh, i_product_name, i_brand, i_class, i_category\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY22A.TPL QUERY 55 IN STREAM 0 */ /* TPC-DS QUERY22A.TPL 0.55 */ WITH RESULTS AS ( SELECT I_PRODUCT_NAME , I_BRAND , I_CLASS , I_CATEGORY , AVG ( INV_QUANTITY_ON_HAND ) AS QOH FROM INVENTORY , DATE_DIM , ITEM /* , WAREHOUSE */ WHERE INV_DATE_SK = D_DATE_SK AND INV_ITEM_SK = I_ITEM_SK AND /* AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK */ D_MONTH_SEQ BETWEEN 1183 AND 1183 + 11 GROUP BY I_PRODUCT_NAME , I_BRAND , I_CLASS , I_CATEGORY ) , RESULTS_ROLLUP AS ( SELECT I_PRODUCT_NAME , I_BRAND , I_CLASS , I_CATEGORY , AVG ( QOH ) AS QOH FROM RESULTS GROUP BY I_PRODUCT_NAME , I_BRAND , I_CLASS , I_CATEGORY UNION ALL SELECT I_PRODUCT_NAME , I_BRAND , I_CLASS , NULL AS I_CATEGORY , AVG ( QOH ) AS QOH FROM RESULTS GROUP BY I_PRODUCT_NAME , I_BRAND , I_CLASS UNION ALL SELECT I_PRODUCT_NAME , I_BRAND , NULL AS I_CLASS , NULL AS I_CATEGORY , AVG ( QOH ) AS QOH FROM RESULTS GROUP BY I_PRODUCT_NAME , I_BRAND UNION ALL SELECT I_PRODUCT_NAME , NULL AS I_BRAND , NULL AS I_CLASS , NULL AS I_CATEGORY , AVG ( QOH ) AS QOH FROM RESULTS GROUP BY I_PRODUCT_NAME UNION ALL SELECT NULL AS I_PRODUCT_NAME , NULL AS I_BRAND , NULL AS I_CLASS , NULL AS I_CATEGORY , AVG ( QOH ) AS QOH FROM RESULTS ) SELECT I_PRODUCT_NAME , I_BRAND , I_CLASS , I_CATEGORY , QOH FROM RESULTS_ROLLUP ORDER BY QOH NULLS FIRST , I_PRODUCT_NAME NULLS FIRST , I_BRAND NULLS FIRST , I_CLASS NULLS FIRST , I_CATEGORY NULLS FIRST LIMIT 21",
            "preview": "\n/*                    i_product_name            i_brand        i_class   i_category  qoh\n0                     antin steing               None           None         None  456\n1                     antin steing        maxicorp #8           None         None  456\n2                     antin steing        maxicorp #8   womens watch         None  456\n3                     antin steing        maxicorp #8   womens watch      Jewelry  456\n4           antibarbarn stn stable               None           None         None  460\n5           antibarbarn stn stable  importoimporto #2           None         None  460\n6           antibarbarn stn stable  importoimporto #2         shirts         None  460\n7           antibarbarn stn stable  importoimporto #2         shirts          Men  460\n8   oughtationoughtcallycallyought               None           None         None  462\n9   oughtationoughtcallycallyought      amalgbrand #4           None         None  462\n10  oughtationoughtcallycallyought      amalgbrand #4  semi-precious         None  462\n11  oughtationoughtcallycallyought      amalgbrand #4  semi-precious      Jewelry  462\n12            prieingpribarbarable               None           None         None  462\n13            prieingpribarbarable   amalgedu pack #2           None         None  462\n14            prieingpribarbarable   amalgedu pack #2         womens         None  462\n15            prieingpribarbarable   amalgedu pack #2         womens        Shoes  462\n16                 antieingprin st               None           None         None  463\n17                 antieingprin st   maxiunivamalg #2           None         None  463\n18                 antieingprin st   maxiunivamalg #2    televisions         None  463\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 3.925701,
                "execution_time": 3.488321,
                "compile_time": 0.001075,
                "planning_time": 3.819981
            },
            "query_metrics_warm_up": {
                "elapsed_time": 4.102154,
                "execution_time": 3.601469,
                "compile_time": 0.001077,
                "planning_time": 3.989473
            }
        }
    ],
    "preview": "\n/*                    i_product_name            i_brand        i_class   i_category  qoh\n0                     antin steing               None           None         None  456\n1                     antin steing        maxicorp #8           None         None  456\n2                     antin steing        maxicorp #8   womens watch         None  456\n3                     antin steing        maxicorp #8   womens watch      Jewelry  456\n4           antibarbarn stn stable               None           None         None  460\n5           antibarbarn stn stable  importoimporto #2           None         None  460\n6           antibarbarn stn stable  importoimporto #2         shirts         None  460\n7           antibarbarn stn stable  importoimporto #2         shirts          Men  460\n8   oughtationoughtcallycallyought               None           None         None  462\n9   oughtationoughtcallycallyought      amalgbrand #4           None         None  462\n10  oughtationoughtcallycallyought      amalgbrand #4  semi-precious         None  462\n11  oughtationoughtcallycallyought      amalgbrand #4  semi-precious      Jewelry  462\n12            prieingpribarbarable               None           None         None  462\n13            prieingpribarbarable   amalgedu pack #2           None         None  462\n14            prieingpribarbarable   amalgedu pack #2         womens         None  462\n15            prieingpribarbarable   amalgedu pack #2         womens        Shoes  462\n16                 antieingprin st               None           None         None  463\n17                 antieingprin st   maxiunivamalg #2           None         None  463\n18                 antieingprin st   maxiunivamalg #2    televisions         None  463\n...*/"
}