{
    "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name)\n         avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n      or (i_category in ('Electronics','Women','Jewelry') and\n          i_class in ('portable','fragrances','diamonds') \n        ))\ngroup by i_category, i_class, i_brand,\n         s_store_name, s_company_name, d_moy) tmp1\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\norder by sum_sales - avg_monthly_sales, s_store_name\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY89.TPL QUERY 56 IN STREAM 0 */ /* TPC-DS QUERY89.TPL 0.56 */ SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , S_STORE_NAME , S_COMPANY_NAME , D_MOY , SUM ( SS_SALES_PRICE ) AS SUM_SALES , AVG ( SUM ( SS_SALES_PRICE ) ) OVER ( PARTITION BY I_CATEGORY , I_BRAND , S_STORE_NAME , S_COMPANY_NAME ) AS AVG_MONTHLY_SALES FROM ITEM , STORE_SALES , DATE_DIM , STORE WHERE SS_ITEM_SK = I_ITEM_SK AND SS_SOLD_DATE_SK = D_DATE_SK AND SS_STORE_SK = S_STORE_SK AND D_YEAR IN ( 1999 ) AND ( ( I_CATEGORY IN ( 'Shoes' , 'Men' , 'Music' ) AND I_CLASS IN ( 'kids' , 'sports-apparel' , 'classical' ) ) OR ( I_CATEGORY IN ( 'Electronics' , 'Women' , 'Jewelry' ) AND I_CLASS IN ( 'portable' , 'fragrances' , 'diamonds' ) ) ) GROUP BY I_CATEGORY , I_CLASS , I_BRAND , S_STORE_NAME , S_COMPANY_NAME , D_MOY ) AS TMP1 WHERE CASE WHEN ( AVG_MONTHLY_SALES <> 0 ) THEN ( ABS ( SUM_SALES - AVG_MONTHLY_SALES ) / AVG_MONTHLY_SALES ) ELSE NULL END > 0.1 ORDER BY SUM_SALES - AVG_MONTHLY_SALES NULLS FIRST , S_STORE_NAME NULLS FIRST LIMIT 21",
            "preview": "\n/*   i_category         i_class             i_brand s_store_name s_company_name  d_moy   sum_sales  avg_monthly_sales\n0       Music       classical  edu packscholar #1         able        Unknown      2  2058294.36         3890660.59\n1       Music       classical  edu packscholar #1          bar        Unknown      2  2076058.73         3881122.27\n2       Music       classical  edu packscholar #1          ese        Unknown      2  2038213.02         3833234.94\n3       Music       classical  edu packscholar #1         eing        Unknown      2  2048173.89         3831352.46\n4         Men  sports-apparel  edu packimporto #1          bar        Unknown      2  2036208.17         3817307.68\n5         Men  sports-apparel  edu packimporto #1         eing        Unknown      2  1985449.20         3753273.19\n6         Men  sports-apparel  edu packimporto #1         able        Unknown      2  2050388.50         3814980.35\n7         Men  sports-apparel  edu packimporto #1          ese        Unknown      2  2010097.26         3757070.09\n8       Shoes            kids  exportiedu pack #1          bar        Unknown      2  1984272.08         3722655.28\n9       Music       classical  edu packscholar #1        cally        Unknown      2  1938972.05         3658000.82\n10      Women      fragrances     importoamalg #1          bar        Unknown      2  1936044.41         3654999.73\n11      Shoes            kids  exportiedu pack #1         able        Unknown      2  2000040.65         3713817.41\n12      Shoes            kids  exportiedu pack #1         eing        Unknown      2  1951864.11         3663424.17\n13      Women      fragrances     importoamalg #1         able        Unknown      2  1944084.81         3654999.28\n14      Shoes            kids  exportiedu pack #1          ese        Unknown      2  1950826.65         3657184.33\n15      Music       classical  edu packscholar #1          bar        Unknown      6  2197079.39         3881122.27\n16      Music       classical  edu packscholar #1         able        Unknown      6  2206909.43         3890660.59\n17      Women      fragrances     importoamalg #1          ese        Unknown      2  1915323.92         3598582.96\n18      Women      fragrances     importoamalg #1         eing        Unknown      2  1912262.54         3594748.40\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 4.1772,
                "execution_time": 4.091683,
                "compile_time": 0.000446,
                "planning_time": 0.063681
            },
            "query_metrics_warm_up": {
                "elapsed_time": 8.995293,
                "execution_time": 4.143033,
                "compile_time": 8.770787,
                "planning_time": 0.166378
            }
        }
    ],
    "preview": "\n/*   i_category         i_class             i_brand s_store_name s_company_name  d_moy   sum_sales  avg_monthly_sales\n0       Music       classical  edu packscholar #1         able        Unknown      2  2058294.36         3890660.59\n1       Music       classical  edu packscholar #1          bar        Unknown      2  2076058.73         3881122.27\n2       Music       classical  edu packscholar #1          ese        Unknown      2  2038213.02         3833234.94\n3       Music       classical  edu packscholar #1         eing        Unknown      2  2048173.89         3831352.46\n4         Men  sports-apparel  edu packimporto #1          bar        Unknown      2  2036208.17         3817307.68\n5         Men  sports-apparel  edu packimporto #1         eing        Unknown      2  1985449.20         3753273.19\n6         Men  sports-apparel  edu packimporto #1         able        Unknown      2  2050388.50         3814980.35\n7         Men  sports-apparel  edu packimporto #1          ese        Unknown      2  2010097.26         3757070.09\n8       Shoes            kids  exportiedu pack #1          bar        Unknown      2  1984272.08         3722655.28\n9       Music       classical  edu packscholar #1        cally        Unknown      2  1938972.05         3658000.82\n10      Women      fragrances     importoamalg #1          bar        Unknown      2  1936044.41         3654999.73\n11      Shoes            kids  exportiedu pack #1         able        Unknown      2  2000040.65         3713817.41\n12      Shoes            kids  exportiedu pack #1         eing        Unknown      2  1951864.11         3663424.17\n13      Women      fragrances     importoamalg #1         able        Unknown      2  1944084.81         3654999.28\n14      Shoes            kids  exportiedu pack #1          ese        Unknown      2  1950826.65         3657184.33\n15      Music       classical  edu packscholar #1          bar        Unknown      6  2197079.39         3881122.27\n16      Music       classical  edu packscholar #1         able        Unknown      6  2206909.43         3890660.59\n17      Women      fragrances     importoamalg #1          ese        Unknown      2  1915323.92         3598582.96\n18      Women      fragrances     importoamalg #1         eing        Unknown      2  1912262.54         3594748.40\n...*/"
}