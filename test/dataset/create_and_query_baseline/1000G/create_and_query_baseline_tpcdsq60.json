{
    "input": "-- start template query60.tpl query 29 in stream 0\nwith /* TPC-DS query60.tpl 0.29 */ ss as (\n select\n          i_item_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Music'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 2001\n and     d_moy                   = 8\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -5 \n group by i_item_id),\n cs as (\n select\n          i_item_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Music'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 2001\n and     d_moy                   = 8\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -5 \n group by i_item_id),\n ws as (\n select\n          i_item_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_item_id               in (select\n  i_item_id\nfrom\n item\nwhere i_category in ('Music'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 2001\n and     d_moy                   = 8\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -5\n group by i_item_id)\n  select   \n  i_item_id\n,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_item_id\n order by i_item_id\n      ,total_sales\n limit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY60.TPL QUERY 29 IN STREAM 0 */ /* TPC-DS QUERY60.TPL 0.29 */ WITH SS AS ( SELECT I_ITEM_ID , SUM ( SS_EXT_SALES_PRICE ) AS TOTAL_SALES FROM STORE_SALES , DATE_DIM , CUSTOMER_ADDRESS , ITEM WHERE I_ITEM_ID IN ( SELECT I_ITEM_ID FROM ITEM WHERE I_CATEGORY IN ( 'Music' ) ) AND SS_ITEM_SK = I_ITEM_SK AND SS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 2001 AND D_MOY = 8 AND SS_ADDR_SK = CA_ADDRESS_SK AND CA_GMT_OFFSET = -5 GROUP BY I_ITEM_ID ) , CS AS ( SELECT I_ITEM_ID , SUM ( CS_EXT_SALES_PRICE ) AS TOTAL_SALES FROM CATALOG_SALES , DATE_DIM , CUSTOMER_ADDRESS , ITEM WHERE I_ITEM_ID IN ( SELECT I_ITEM_ID FROM ITEM WHERE I_CATEGORY IN ( 'Music' ) ) AND CS_ITEM_SK = I_ITEM_SK AND CS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 2001 AND D_MOY = 8 AND CS_BILL_ADDR_SK = CA_ADDRESS_SK AND CA_GMT_OFFSET = -5 GROUP BY I_ITEM_ID ) , WS AS ( SELECT I_ITEM_ID , SUM ( WS_EXT_SALES_PRICE ) AS TOTAL_SALES FROM WEB_SALES , DATE_DIM , CUSTOMER_ADDRESS , ITEM WHERE I_ITEM_ID IN ( SELECT I_ITEM_ID FROM ITEM WHERE I_CATEGORY IN ( 'Music' ) ) AND WS_ITEM_SK = I_ITEM_SK AND WS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 2001 AND D_MOY = 8 AND WS_BILL_ADDR_SK = CA_ADDRESS_SK AND CA_GMT_OFFSET = -5 GROUP BY I_ITEM_ID ) SELECT I_ITEM_ID , SUM ( TOTAL_SALES ) AS TOTAL_SALES FROM ( SELECT * FROM SS UNION ALL SELECT * FROM CS UNION ALL SELECT * FROM WS ) AS TMP1 GROUP BY I_ITEM_ID ORDER BY I_ITEM_ID NULLS FIRST , TOTAL_SALES NULLS FIRST LIMIT 21",
            "preview": "\n/*           i_item_id  total_sales\n0   AAAAAAAAAAACCAAA    559512.09\n1   AAAAAAAAAAAEDAAA    593684.52\n2   AAAAAAAAAAAGEAAA    575824.55\n3   AAAAAAAAAAAHBAAA    587841.61\n4   AAAAAAAAAAAJBAAA    526428.89\n5   AAAAAAAAAAAOCAAA    528709.46\n6   AAAAAAAAAAAPBAAA    519331.37\n7   AAAAAAAAAABBAAAA    613119.37\n8   AAAAAAAAAABEAAAA    620645.89\n9   AAAAAAAAAABGEAAA    509015.11\n10  AAAAAAAAAABHCAAA    560906.77\n11  AAAAAAAAAABHDAAA    557899.98\n12  AAAAAAAAAABJAAAA    454266.47\n13  AAAAAAAAAABKDAAA    601333.87\n14  AAAAAAAAAABMBAAA    535351.51\n15  AAAAAAAAAABMDAAA    522238.52\n16  AAAAAAAAAABPAAAA    560018.68\n17  AAAAAAAAAABPBAAA    608377.65\n18  AAAAAAAAAACADAAA    472788.11\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.918706,
                "execution_time": 0.728762,
                "compile_time": 0.001367,
                "planning_time": 0.184209
            },
            "query_metrics_warm_up": {
                "elapsed_time": 6.042225,
                "execution_time": 3.36826,
                "compile_time": 3.753421,
                "planning_time": 0.281375
            }
        }
    ],
    "preview": "\n/*           i_item_id  total_sales\n0   AAAAAAAAAAACCAAA    559512.09\n1   AAAAAAAAAAAEDAAA    593684.52\n2   AAAAAAAAAAAGEAAA    575824.55\n3   AAAAAAAAAAAHBAAA    587841.61\n4   AAAAAAAAAAAJBAAA    526428.89\n5   AAAAAAAAAAAOCAAA    528709.46\n6   AAAAAAAAAAAPBAAA    519331.37\n7   AAAAAAAAAABBAAAA    613119.37\n8   AAAAAAAAAABEAAAA    620645.89\n9   AAAAAAAAAABGEAAA    509015.11\n10  AAAAAAAAAABHCAAA    560906.77\n11  AAAAAAAAAABHDAAA    557899.98\n12  AAAAAAAAAABJAAAA    454266.47\n13  AAAAAAAAAABKDAAA    601333.87\n14  AAAAAAAAAABMBAAA    535351.51\n15  AAAAAAAAAABMDAAA    522238.52\n16  AAAAAAAAAABPAAAA    560018.68\n17  AAAAAAAAAABPBAAA    608377.65\n18  AAAAAAAAAACADAAA    472788.11\n...*/"
}