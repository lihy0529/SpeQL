{
    "input": "-- start template query51.tpl query 46 in stream 0\nWITH /* TPC-DS query51.tpl 0.46 */ web_v1 as (\nselect\n  ws_item_sk item_sk, d_date,\n  sum(sum(ws_sales_price))\n      over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\nfrom web_sales\n    ,date_dim\nwhere ws_sold_date_sk=d_date_sk\n  and d_month_seq between 1181 and 1181+11\n  and ws_item_sk is not NULL\ngroup by ws_item_sk, d_date),\nstore_v1 as (\nselect\n  ss_item_sk item_sk, d_date,\n  sum(sum(ss_sales_price))\n      over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\nfrom store_sales\n    ,date_dim\nwhere ss_sold_date_sk=d_date_sk\n  and d_month_seq between 1181 and 1181+11\n  and ss_item_sk is not NULL\ngroup by ss_item_sk, d_date)\n select  *\nfrom (select item_sk\n     ,d_date\n     ,web_sales\n     ,store_sales\n     ,max(web_sales)\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative\n     ,max(store_sales)\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative\n     from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk\n                 ,case when web.d_date is not null then web.d_date else store.d_date end d_date\n                 ,web.cume_sales web_sales\n                 ,store.cume_sales store_sales\n           from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk\n                                                          and web.d_date = store.d_date)\n          )x )y\nwhere web_cumulative > store_cumulative\norder by item_sk\n        ,d_date\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY51.TPL QUERY 46 IN STREAM 0 */ /* TPC-DS QUERY51.TPL 0.46 */ WITH WEB_V1 AS ( SELECT WS_ITEM_SK AS ITEM_SK , D_DATE , SUM ( SUM ( WS_SALES_PRICE ) ) OVER ( PARTITION BY WS_ITEM_SK ORDER BY D_DATE NULLS FIRST ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW ) AS CUME_SALES FROM WEB_SALES , DATE_DIM WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_MONTH_SEQ BETWEEN 1181 AND 1181 + 11 AND NOT WS_ITEM_SK IS NULL GROUP BY WS_ITEM_SK , D_DATE ) , STORE_V1 AS ( SELECT SS_ITEM_SK AS ITEM_SK , D_DATE , SUM ( SUM ( SS_SALES_PRICE ) ) OVER ( PARTITION BY SS_ITEM_SK ORDER BY D_DATE NULLS FIRST ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW ) AS CUME_SALES FROM STORE_SALES , DATE_DIM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_MONTH_SEQ BETWEEN 1181 AND 1181 + 11 AND NOT SS_ITEM_SK IS NULL GROUP BY SS_ITEM_SK , D_DATE ) SELECT * FROM ( SELECT ITEM_SK , D_DATE , WEB_SALES , STORE_SALES , MAX ( WEB_SALES ) OVER ( PARTITION BY ITEM_SK ORDER BY D_DATE NULLS FIRST ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW ) AS WEB_CUMULATIVE , MAX ( STORE_SALES ) OVER ( PARTITION BY ITEM_SK ORDER BY D_DATE NULLS FIRST ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW ) AS STORE_CUMULATIVE FROM ( SELECT CASE WHEN NOT WEB.ITEM_SK IS NULL THEN WEB.ITEM_SK ELSE STORE.ITEM_SK END AS ITEM_SK , CASE WHEN NOT WEB.D_DATE IS NULL THEN WEB.D_DATE ELSE STORE.D_DATE END AS D_DATE , WEB.CUME_SALES AS WEB_SALES , STORE.CUME_SALES AS STORE_SALES FROM WEB_V1 AS WEB FULL OUTER JOIN STORE_V1 AS STORE ON ( WEB.ITEM_SK = STORE.ITEM_SK AND WEB.D_DATE = STORE.D_DATE ) ) AS X ) AS Y WHERE WEB_CUMULATIVE > STORE_CUMULATIVE ORDER BY ITEM_SK NULLS FIRST , D_DATE NULLS FIRST LIMIT 21",
            "preview": "\n/*    item_sk    d_date  web_sales  store_sales  web_cumulative  store_cumulative\n0         1  19980607     836.93       745.66          836.93            745.66\n1         8  19980602     367.79       257.31          367.79            257.31\n2         8  19980603     668.38       503.16          668.38            503.16\n3         8  19980604     744.48       720.05          744.48            720.05\n4        14  19980601     196.38        89.09          196.38             89.09\n5        37  19980601      80.19        39.01           80.19             39.01\n6        49  19980601     202.87         1.52          202.87              1.52\n7        49  19980602     295.97       249.80          295.97            249.80\n8        49  19980603     405.00       374.81          405.00            374.81\n9        56  19980602     391.43       147.82          391.43            147.82\n10       56  19980603     509.65       189.98          509.65            189.98\n11       56  19980604        NaN       224.15          509.65            224.15\n12       56  19980605     540.04       321.51          540.04            321.51\n13       64  19980601     147.17        65.62          147.17             65.62\n14       64  19980602     323.83       182.42          323.83            182.42\n15       86  19980601     283.76       149.26          283.76            149.26\n16       88  19980602     316.61       312.20          316.61            312.20\n17       98  19980601     193.80        10.28          193.80             10.28\n18       98  19980602        NaN        42.31          193.80             42.31\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 21.215942,
                "execution_time": 21.129606,
                "compile_time": 0.000515,
                "planning_time": 0.06105
            },
            "query_metrics_warm_up": {
                "elapsed_time": 27.238062,
                "execution_time": 21.385227,
                "compile_time": 8.213516,
                "planning_time": 0.139997
            }
        }
    ],
    "preview": "\n/*    item_sk    d_date  web_sales  store_sales  web_cumulative  store_cumulative\n0         1  19980607     836.93       745.66          836.93            745.66\n1         8  19980602     367.79       257.31          367.79            257.31\n2         8  19980603     668.38       503.16          668.38            503.16\n3         8  19980604     744.48       720.05          744.48            720.05\n4        14  19980601     196.38        89.09          196.38             89.09\n5        37  19980601      80.19        39.01           80.19             39.01\n6        49  19980601     202.87         1.52          202.87              1.52\n7        49  19980602     295.97       249.80          295.97            249.80\n8        49  19980603     405.00       374.81          405.00            374.81\n9        56  19980602     391.43       147.82          391.43            147.82\n10       56  19980603     509.65       189.98          509.65            189.98\n11       56  19980604        NaN       224.15          509.65            224.15\n12       56  19980605     540.04       321.51          540.04            321.51\n13       64  19980601     147.17        65.62          147.17             65.62\n14       64  19980602     323.83       182.42          323.83            182.42\n15       86  19980601     283.76       149.26          283.76            149.26\n16       88  19980602     316.61       312.20          316.61            312.20\n17       98  19980601     193.80        10.28          193.80             10.28\n18       98  19980602        NaN        42.31          193.80             42.31\n...*/"
}