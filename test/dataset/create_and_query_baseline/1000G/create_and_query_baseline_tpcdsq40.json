{
    "input": "-- start template query40.tpl query 86 in stream 0\nselect /* TPC-DS query40.tpl 0.86 */  \n   w_state\n  ,i_item_id\n  ,sum(case when (cast(d_date as date) < cast ('2001-03-21' as date)) \n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\n  ,sum(case when (cast(d_date as date) >= cast ('2001-03-21' as date)) \n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\n from\n   catalog_sales left outer join catalog_returns on\n       (cs_order_number = cr_order_number \n        and cs_item_sk = cr_item_sk)\n  ,warehouse \n  ,item\n  ,date_dim\n where\n     i_current_price between 0.99 and 1.49\n and i_item_sk          = cs_item_sk\n and cs_warehouse_sk    = w_warehouse_sk \n and cs_sold_date_sk    = d_date_sk\n and d_date between dateadd(day,-30,cast ('2001-03-21' as date))\n                and dateadd(day,30,cast ('2001-03-21' as date))\n group by\n    w_state,i_item_id\n order by w_state,i_item_id\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY40.TPL QUERY 86 IN STREAM 0 */ /* TPC-DS QUERY40.TPL 0.86 */ SELECT W_STATE , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2001-03-21' AS DATE ) ) THEN CS_SALES_PRICE - COALESCE ( CR_REFUNDED_CASH , 0 ) ELSE 0 END ) AS SALES_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2001-03-21' AS DATE ) ) THEN CS_SALES_PRICE - COALESCE ( CR_REFUNDED_CASH , 0 ) ELSE 0 END ) AS SALES_AFTER FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ORDER_NUMBER = CR_ORDER_NUMBER AND CS_ITEM_SK = CR_ITEM_SK ) , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = CS_ITEM_SK AND CS_WAREHOUSE_SK = W_WAREHOUSE_SK AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2001-03-21' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-21' AS DATE ) ) GROUP BY W_STATE , I_ITEM_ID ORDER BY W_STATE NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
            "preview": "\n/*   w_state         i_item_id  sales_before  sales_after\n0       AL  AAAAAAAAAABADAAA        310.48       537.72\n1       AL  AAAAAAAAAABDAAAA        177.83       410.23\n2       AL  AAAAAAAAAABIBAAA        -50.79       600.37\n3       AL  AAAAAAAAAABKDAAA       -380.67       469.58\n4       AL  AAAAAAAAAABMDAAA        144.81       300.13\n5       AL  AAAAAAAAAABPBAAA      -2688.57       831.65\n6       AL  AAAAAAAAAACOAAAA        363.75       458.88\n7       AL  AAAAAAAAAADHAAAA      -4872.99       474.64\n8       AL  AAAAAAAAAADKBAAA       -793.39       195.73\n9       AL  AAAAAAAAAADLCAAA        718.92       302.96\n10      AL  AAAAAAAAAADPBAAA          3.55       210.92\n11      AL  AAAAAAAAAAEDBAAA        300.94     -1275.26\n12      AL  AAAAAAAAAAEGAAAA        153.62       905.04\n13      AL  AAAAAAAAAAEGBAAA        369.50       324.88\n14      AL  AAAAAAAAAAEICAAA        499.93        49.36\n15      AL  AAAAAAAAAAEKCAAA        674.96       170.68\n16      AL  AAAAAAAAAAEPDAAA        606.00       466.32\n17      AL  AAAAAAAAAAFBBAAA       -213.75       153.35\n18      AL  AAAAAAAAAAFGCAAA        237.94        -1.41\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.369341,
                "execution_time": 0.290803,
                "compile_time": 0.000355,
                "planning_time": 0.058532
            },
            "query_metrics_warm_up": {
                "elapsed_time": 0.729382,
                "execution_time": 0.573451,
                "compile_time": 0.000349,
                "planning_time": 0.13431
            }
        }
    ],
    "preview": "\n/*   w_state         i_item_id  sales_before  sales_after\n0       AL  AAAAAAAAAABADAAA        310.48       537.72\n1       AL  AAAAAAAAAABDAAAA        177.83       410.23\n2       AL  AAAAAAAAAABIBAAA        -50.79       600.37\n3       AL  AAAAAAAAAABKDAAA       -380.67       469.58\n4       AL  AAAAAAAAAABMDAAA        144.81       300.13\n5       AL  AAAAAAAAAABPBAAA      -2688.57       831.65\n6       AL  AAAAAAAAAACOAAAA        363.75       458.88\n7       AL  AAAAAAAAAADHAAAA      -4872.99       474.64\n8       AL  AAAAAAAAAADKBAAA       -793.39       195.73\n9       AL  AAAAAAAAAADLCAAA        718.92       302.96\n10      AL  AAAAAAAAAADPBAAA          3.55       210.92\n11      AL  AAAAAAAAAAEDBAAA        300.94     -1275.26\n12      AL  AAAAAAAAAAEGAAAA        153.62       905.04\n13      AL  AAAAAAAAAAEGBAAA        369.50       324.88\n14      AL  AAAAAAAAAAEICAAA        499.93        49.36\n15      AL  AAAAAAAAAAEKCAAA        674.96       170.68\n16      AL  AAAAAAAAAAEPDAAA        606.00       466.32\n17      AL  AAAAAAAAAAFBBAAA       -213.75       153.35\n18      AL  AAAAAAAAAAFGCAAA        237.94        -1.41\n...*/"
}