{
    "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','SD','TX') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY69.TPL QUERY 28 IN STREAM 0 */ /* TPC-DS QUERY69.TPL 0.28 */ SELECT CD_GENDER , CD_MARITAL_STATUS , CD_EDUCATION_STATUS , COUNT ( * ) AS CNT1 , CD_PURCHASE_ESTIMATE , COUNT ( * ) AS CNT2 , CD_CREDIT_RATING , COUNT ( * ) AS CNT3 FROM CUSTOMER AS C , CUSTOMER_ADDRESS AS CA , CUSTOMER_DEMOGRAPHICS WHERE C.C_CURRENT_ADDR_SK = CA.CA_ADDRESS_SK AND CA_STATE IN ( 'CO' , 'SD' , 'TX' ) AND CD_DEMO_SK = C.C_CURRENT_CDEMO_SK AND EXISTS ( SELECT * FROM STORE_SALES , DATE_DIM WHERE C.C_CUSTOMER_SK = SS_CUSTOMER_SK AND SS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 2002 AND D_MOY BETWEEN 1 AND 1 + 2 ) AND ( NOT EXISTS ( SELECT * FROM WEB_SALES , DATE_DIM WHERE C.C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK AND WS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 2002 AND D_MOY BETWEEN 1 AND 1 + 2 ) AND NOT EXISTS ( SELECT * FROM CATALOG_SALES , DATE_DIM WHERE C.C_CUSTOMER_SK = CS_SHIP_CUSTOMER_SK AND CS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 2002 AND D_MOY BETWEEN 1 AND 1 + 2 ) ) GROUP BY CD_GENDER , CD_MARITAL_STATUS , CD_EDUCATION_STATUS , CD_PURCHASE_ESTIMATE , CD_CREDIT_RATING ORDER BY CD_GENDER NULLS FIRST , CD_MARITAL_STATUS NULLS FIRST , CD_EDUCATION_STATUS NULLS FIRST , CD_PURCHASE_ESTIMATE NULLS FIRST , CD_CREDIT_RATING NULLS FIRST LIMIT 21",
            "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D         2 yr Degree    60                   500    60             Good    60\n1          F                 D         2 yr Degree    58                   500    58        High Risk    58\n2          F                 D         2 yr Degree    61                   500    61         Low Risk    61\n3          F                 D         2 yr Degree    65                   500    65          Unknown    65\n4          F                 D         2 yr Degree    59                  1000    59             Good    59\n5          F                 D         2 yr Degree    62                  1000    62        High Risk    62\n6          F                 D         2 yr Degree    74                  1000    74         Low Risk    74\n7          F                 D         2 yr Degree    71                  1000    71          Unknown    71\n8          F                 D         2 yr Degree    59                  1500    59             Good    59\n9          F                 D         2 yr Degree    82                  1500    82        High Risk    82\n10         F                 D         2 yr Degree    54                  1500    54         Low Risk    54\n11         F                 D         2 yr Degree    65                  1500    65          Unknown    65\n12         F                 D         2 yr Degree    72                  2000    72             Good    72\n13         F                 D         2 yr Degree    71                  2000    71        High Risk    71\n14         F                 D         2 yr Degree    64                  2000    64         Low Risk    64\n15         F                 D         2 yr Degree    71                  2000    71          Unknown    71\n16         F                 D         2 yr Degree    84                  2500    84             Good    84\n17         F                 D         2 yr Degree    58                  2500    58        High Risk    58\n18         F                 D         2 yr Degree    58                  2500    58         Low Risk    58\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 5.437132,
                "execution_time": 4.854765,
                "compile_time": 0.002448,
                "planning_time": 3.921548
            },
            "query_metrics_warm_up": {
                "elapsed_time": 49.611049,
                "execution_time": 8.245245,
                "compile_time": 41.06515,
                "planning_time": 22.183605
            }
        }
    ],
    "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D         2 yr Degree    60                   500    60             Good    60\n1          F                 D         2 yr Degree    58                   500    58        High Risk    58\n2          F                 D         2 yr Degree    61                   500    61         Low Risk    61\n3          F                 D         2 yr Degree    65                   500    65          Unknown    65\n4          F                 D         2 yr Degree    59                  1000    59             Good    59\n5          F                 D         2 yr Degree    62                  1000    62        High Risk    62\n6          F                 D         2 yr Degree    74                  1000    74         Low Risk    74\n7          F                 D         2 yr Degree    71                  1000    71          Unknown    71\n8          F                 D         2 yr Degree    59                  1500    59             Good    59\n9          F                 D         2 yr Degree    82                  1500    82        High Risk    82\n10         F                 D         2 yr Degree    54                  1500    54         Low Risk    54\n11         F                 D         2 yr Degree    65                  1500    65          Unknown    65\n12         F                 D         2 yr Degree    72                  2000    72             Good    72\n13         F                 D         2 yr Degree    71                  2000    71        High Risk    71\n14         F                 D         2 yr Degree    64                  2000    64         Low Risk    64\n15         F                 D         2 yr Degree    71                  2000    71          Unknown    71\n16         F                 D         2 yr Degree    84                  2500    84             Good    84\n17         F                 D         2 yr Degree    58                  2500    58        High Risk    58\n18         F                 D         2 yr Degree    58                  2500    58         Low Risk    58\n...*/"
}