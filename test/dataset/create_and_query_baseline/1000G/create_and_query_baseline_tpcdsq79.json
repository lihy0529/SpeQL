{
    "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n    and date_dim.d_year in (1999,1999+1,1999+2) \n    and store.s_number_employees between 200 and 295\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\n    where ss_customer_sk = c_customer_sk\n order by c_last_name,c_first_name,substring(s_city,1,30), profit\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY79.TPL QUERY 89 IN STREAM 0 */ /* TPC-DS QUERY79.TPL 0.89 */ SELECT C_LAST_NAME , C_FIRST_NAME , SUBSTRING ( S_CITY FROM 1 FOR 30 ) , SS_TICKET_NUMBER , AMT , PROFIT FROM ( SELECT SS_TICKET_NUMBER , SS_CUSTOMER_SK , STORE.S_CITY , SUM ( SS_COUPON_AMT ) AS AMT , SUM ( SS_NET_PROFIT ) AS PROFIT FROM STORE_SALES , DATE_DIM , STORE , HOUSEHOLD_DEMOGRAPHICS WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK AND ( HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0 OR HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 2 ) AND DATE_DIM.D_DOW = 1 AND DATE_DIM.D_YEAR IN ( 1999 , 1999 + 1 , 1999 + 2 ) AND STORE.S_NUMBER_EMPLOYEES BETWEEN 200 AND 295 GROUP BY SS_TICKET_NUMBER , SS_CUSTOMER_SK , SS_ADDR_SK , STORE.S_CITY ) AS MS , CUSTOMER WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK ORDER BY C_LAST_NAME NULLS FIRST , C_FIRST_NAME NULLS FIRST , SUBSTRING ( S_CITY FROM 1 FOR 30 ) NULLS FIRST , PROFIT NULLS FIRST LIMIT 21",
            "preview": "\n/*   c_last_name c_first_name substring  ss_ticket_number       amt    profit\n0                                              40412743      0.00       NaN\n1                                               9689686       NaN       NaN\n2                                              39663291   7068.02 -28591.02\n3                                             136605989   4731.18 -28508.03\n4                                              25385243   1929.07 -27588.45\n5                                             114394124   2608.14 -25578.21\n6                                             177736898   3253.67 -24706.84\n7                                             121868125   3830.21 -24571.51\n8                                             186062232   8494.63 -23432.76\n9                                             167117853   4418.60 -22753.57\n10                                            205293111   6269.98 -21322.39\n11                                             53721879     72.23 -21224.00\n12                                            166878408    759.18 -21074.39\n13                                             12937931   2798.27 -21012.09\n14                                             59804875      0.00 -20487.05\n15                                            234538097   8463.48 -20419.21\n16                                            154382989   1165.27 -20109.83\n17                                             27500198  10296.67 -20108.97\n18                                             75661575   6601.32 -19675.99\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 27.525597,
                "execution_time": 27.452744,
                "compile_time": 0.000319,
                "planning_time": 0.054877
            },
            "query_metrics_warm_up": {
                "elapsed_time": 34.243515,
                "execution_time": 28.363426,
                "compile_time": 5.888401,
                "planning_time": 0.190285
            }
        }
    ],
    "preview": "\n/*   c_last_name c_first_name substring  ss_ticket_number       amt    profit\n0                                              40412743      0.00       NaN\n1                                               9689686       NaN       NaN\n2                                              39663291   7068.02 -28591.02\n3                                             136605989   4731.18 -28508.03\n4                                              25385243   1929.07 -27588.45\n5                                             114394124   2608.14 -25578.21\n6                                             177736898   3253.67 -24706.84\n7                                             121868125   3830.21 -24571.51\n8                                             186062232   8494.63 -23432.76\n9                                             167117853   4418.60 -22753.57\n10                                            205293111   6269.98 -21322.39\n11                                             53721879     72.23 -21224.00\n12                                            166878408    759.18 -21074.39\n13                                             12937931   2798.27 -21012.09\n14                                             59804875      0.00 -20487.05\n15                                            234538097   8463.48 -20419.21\n16                                            154382989   1165.27 -20109.83\n17                                             27500198  10296.67 -20108.97\n18                                             75661575   6601.32 -19675.99\n...*/"
}