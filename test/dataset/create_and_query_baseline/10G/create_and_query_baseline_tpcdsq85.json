{
    "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substring(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY85.TPL QUERY 33 IN STREAM 0 */ /* TPC-DS QUERY85.TPL 0.33 */ SELECT SUBSTRING ( R_REASON_DESC FROM 1 FOR 20 ) , AVG ( WS_QUANTITY ) , AVG ( WR_REFUNDED_CASH ) , AVG ( WR_FEE ) FROM WEB_SALES , WEB_RETURNS , WEB_PAGE , CUSTOMER_DEMOGRAPHICS AS CD1 , CUSTOMER_DEMOGRAPHICS AS CD2 , CUSTOMER_ADDRESS , DATE_DIM , REASON WHERE WS_WEB_PAGE_SK = WP_WEB_PAGE_SK AND WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER AND WS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 2000 AND CD1.CD_DEMO_SK = WR_REFUNDED_CDEMO_SK AND CD2.CD_DEMO_SK = WR_RETURNING_CDEMO_SK AND CA_ADDRESS_SK = WR_REFUNDED_ADDR_SK AND R_REASON_SK = WR_REASON_SK AND ( ( CD1.CD_MARITAL_STATUS = 'S' AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS AND CD1.CD_EDUCATION_STATUS = 'Secondary' AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS AND WS_SALES_PRICE BETWEEN 100.00 AND 150.00 ) OR ( CD1.CD_MARITAL_STATUS = 'U' AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS AND CD1.CD_EDUCATION_STATUS = 'Advanced Degree' AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS AND WS_SALES_PRICE BETWEEN 50.00 AND 100.00 ) OR ( CD1.CD_MARITAL_STATUS = 'W' AND CD1.CD_MARITAL_STATUS = CD2.CD_MARITAL_STATUS AND CD1.CD_EDUCATION_STATUS = '4 yr Degree' AND CD1.CD_EDUCATION_STATUS = CD2.CD_EDUCATION_STATUS AND WS_SALES_PRICE BETWEEN 150.00 AND 200.00 ) ) AND ( ( CA_COUNTRY = 'United States' AND CA_STATE IN ( 'VA' , 'MI' , 'ID' ) AND WS_NET_PROFIT BETWEEN 100 AND 200 ) OR ( CA_COUNTRY = 'United States' AND CA_STATE IN ( 'TX' , 'LA' , 'KS' ) AND WS_NET_PROFIT BETWEEN 150 AND 300 ) OR ( CA_COUNTRY = 'United States' AND CA_STATE IN ( 'IA' , 'NY' , 'NM' ) AND WS_NET_PROFIT BETWEEN 50 AND 250 ) ) GROUP BY R_REASON_DESC ORDER BY SUBSTRING ( R_REASON_DESC FROM 1 FOR 20 ) NULLS FIRST , AVG ( WS_QUANTITY ) NULLS FIRST , AVG ( WR_REFUNDED_CASH ) NULLS FIRST , AVG ( WR_FEE ) NULLS FIRST LIMIT 21",
            "preview": "\n/*               substring  avg      avg    avg\n0            Did not fit    6    73.12  35.05\n1   Did not like the col   45   292.80  52.60\n2   Did not like the mak   50  1442.49  43.09\n3   Found a better exten   78  2233.12  41.62\n4   Found a better price   43   464.96  62.28\n5          Gift exchange   52  2528.89  67.12\n6   No service location     7     5.44  53.78\n7   Not working any more    3   128.13  28.67\n8        Stopped working   47   606.29  90.32\n9             Wrong size   35   618.65  74.06\n10             reason 24   24    72.63  11.38\n11             reason 28   35   623.59  91.86\n12             reason 29   19  1282.35  50.00\n13             reason 31   52   564.18  68.63\n14             reason 32   55   501.55  84.70\n15             reason 33   22   400.59  38.96\n16             reason 37   15   917.16  40.89*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.448052,
                "execution_time": 0.281829,
                "compile_time": 0.058894,
                "planning_time": 0.075658
            },
            "query_metrics_warm_up": {
                "elapsed_time": 7.170891,
                "execution_time": 0.35541,
                "compile_time": 6.610835,
                "planning_time": 0.16506
            }
        }
    ],
    "preview": "\n/*               substring  avg      avg    avg\n0            Did not fit    6    73.12  35.05\n1   Did not like the col   45   292.80  52.60\n2   Did not like the mak   50  1442.49  43.09\n3   Found a better exten   78  2233.12  41.62\n4   Found a better price   43   464.96  62.28\n5          Gift exchange   52  2528.89  67.12\n6   No service location     7     5.44  53.78\n7   Not working any more    3   128.13  28.67\n8        Stopped working   47   606.29  90.32\n9             Wrong size   35   618.65  74.06\n10             reason 24   24    72.63  11.38\n11             reason 28   35   623.59  91.86\n12             reason 29   19  1282.35  50.00\n13             reason 31   52   564.18  68.63\n14             reason 32   55   501.55  84.70\n15             reason 33   22   400.59  38.96\n16             reason 37   15   917.16  40.89*/"
}