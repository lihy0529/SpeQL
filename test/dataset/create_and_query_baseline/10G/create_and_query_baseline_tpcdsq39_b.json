{
    "input": "\nwith /* TPC-DS query39.tpl 0.5 part2 */ inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2001\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\n  and inv1.d_moy=1\n  and inv2.d_moy=1+1\n  and inv1.cov > 1.5\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n        ,inv2.d_moy,inv2.mean, inv2.cov\nlimit 100",
    "query": [
        {
            "query": "/* TPC-DS QUERY39.TPL 0.5 PART2 */ WITH INV AS ( SELECT W_WAREHOUSE_NAME , W_WAREHOUSE_SK , I_ITEM_SK , D_MOY , STDEV , MEAN , CASE MEAN WHEN 0 THEN NULL ELSE STDEV / MEAN END AS COV FROM ( SELECT W_WAREHOUSE_NAME , W_WAREHOUSE_SK , I_ITEM_SK , D_MOY , STDDEV_SAMP ( INV_QUANTITY_ON_HAND ) AS STDEV , AVG ( INV_QUANTITY_ON_HAND ) AS MEAN FROM INVENTORY , ITEM , WAREHOUSE , DATE_DIM WHERE INV_ITEM_SK = I_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_YEAR = 2001 GROUP BY W_WAREHOUSE_NAME , W_WAREHOUSE_SK , I_ITEM_SK , D_MOY ) AS FOO WHERE CASE MEAN WHEN 0 THEN 0 ELSE STDEV / MEAN END > 1 ) SELECT INV1.W_WAREHOUSE_SK , INV1.I_ITEM_SK , INV1.D_MOY , INV1.MEAN , INV1.COV , INV2.W_WAREHOUSE_SK , INV2.I_ITEM_SK , INV2.D_MOY , INV2.MEAN , INV2.COV FROM INV AS INV1 , INV AS INV2 WHERE INV1.I_ITEM_SK = INV2.I_ITEM_SK AND INV1.W_WAREHOUSE_SK = INV2.W_WAREHOUSE_SK AND INV1.D_MOY = 1 AND INV2.D_MOY = 1 + 1 AND INV1.COV > 1.5 ORDER BY INV1.W_WAREHOUSE_SK NULLS FIRST , INV1.I_ITEM_SK NULLS FIRST , INV1.D_MOY NULLS FIRST , INV1.MEAN NULLS FIRST , INV1.COV NULLS FIRST , INV2.D_MOY NULLS FIRST , INV2.MEAN NULLS FIRST , INV2.COV NULLS FIRST LIMIT 21",
            "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk  i_item_sk  d_moy  mean       cov\n0                1       5939      1   288  1.601761               1       5939      2    74  1.249446\n1                1      12681      1   268  1.522056               1      12681      2   420  1.090856\n2                1      29461      1   223  1.538687               1      29461      2   327  1.270694\n3                1      33895      1   233  1.515577               1      33895      2   542  1.121978\n4                1      52441      1   245  1.667720               1      52441      2   365  1.040926\n5                1      61967      1   224  1.525547               1      61967      2   241  1.097040\n6                2       5235      1   198  1.560274               2       5235      2   231  1.307906\n7                2      12311      1   251  1.562666               2      12311      2   272  1.323075\n8                2      24991      1   283  1.678854               2      24991      2   319  1.050378\n9                2      55207      1   320  1.581418               2      55207      2   412  1.002101\n10               2      71001      1   221  1.605296               2      71001      2   448  1.059915\n11               2      82553      1   248  1.836997               2      82553      2   460  1.007159\n12               2      85821      1   245  1.648060               2      85821      2   349  1.083960\n13               3       3059      1   275  1.529327               3       3059      2   237  1.056086\n14               3      36149      1   260  1.516777               3      36149      2   237  1.170237\n15               3      51903      1   181  1.562605               3      51903      2   135  1.178511\n16               3      65487      1   292  1.583549               3      65487      2   383  1.308150\n17               3      68137      1   236  1.531833               3      68137      2   359  1.176021\n18               3      71101      1   232  1.862199               3      71101      2   322  1.238282\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.449897,
                "execution_time": 0.340753,
                "compile_time": 0.000628,
                "planning_time": 0.075039
            },
            "query_metrics_warm_up": {
                "elapsed_time": 0.521559,
                "execution_time": 0.337739,
                "compile_time": 0.00066,
                "planning_time": 0.149417
            }
        }
    ],
    "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk  i_item_sk  d_moy  mean       cov\n0                1       5939      1   288  1.601761               1       5939      2    74  1.249446\n1                1      12681      1   268  1.522056               1      12681      2   420  1.090856\n2                1      29461      1   223  1.538687               1      29461      2   327  1.270694\n3                1      33895      1   233  1.515577               1      33895      2   542  1.121978\n4                1      52441      1   245  1.667720               1      52441      2   365  1.040926\n5                1      61967      1   224  1.525547               1      61967      2   241  1.097040\n6                2       5235      1   198  1.560274               2       5235      2   231  1.307906\n7                2      12311      1   251  1.562666               2      12311      2   272  1.323075\n8                2      24991      1   283  1.678854               2      24991      2   319  1.050378\n9                2      55207      1   320  1.581418               2      55207      2   412  1.002101\n10               2      71001      1   221  1.605296               2      71001      2   448  1.059915\n11               2      82553      1   248  1.836997               2      82553      2   460  1.007159\n12               2      85821      1   245  1.648060               2      85821      2   349  1.083960\n13               3       3059      1   275  1.529327               3       3059      2   237  1.056086\n14               3      36149      1   260  1.516777               3      36149      2   237  1.170237\n15               3      51903      1   181  1.562605               3      51903      2   135  1.178511\n16               3      65487      1   292  1.583549               3      65487      2   383  1.308150\n17               3      68137      1   236  1.531833               3      68137      2   359  1.176021\n18               3      71101      1   232  1.862199               3      71101      2   322  1.238282\n...*/"
}