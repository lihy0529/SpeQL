{
    "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182+ 12 and 1182 + 23) x\n where s_store_id1=s_store_id2\n   and d_week_seq1=d_week_seq2-52\n order by s_store_name1,s_store_id1,d_week_seq1\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY59.TPL QUERY 30 IN STREAM 0 */ /* TPC-DS QUERY59.TPL 0.30 */ WITH WSS AS ( SELECT D_WEEK_SEQ , SS_STORE_SK , SUM ( CASE WHEN ( D_DAY_NAME = 'Sunday' ) THEN SS_SALES_PRICE ELSE NULL END ) AS SUN_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Monday' ) THEN SS_SALES_PRICE ELSE NULL END ) AS MON_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Tuesday' ) THEN SS_SALES_PRICE ELSE NULL END ) AS TUE_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Wednesday' ) THEN SS_SALES_PRICE ELSE NULL END ) AS WED_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Thursday' ) THEN SS_SALES_PRICE ELSE NULL END ) AS THU_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Friday' ) THEN SS_SALES_PRICE ELSE NULL END ) AS FRI_SALES , SUM ( CASE WHEN ( D_DAY_NAME = 'Saturday' ) THEN SS_SALES_PRICE ELSE NULL END ) AS SAT_SALES FROM STORE_SALES , DATE_DIM WHERE D_DATE_SK = SS_SOLD_DATE_SK GROUP BY D_WEEK_SEQ , SS_STORE_SK ) SELECT S_STORE_NAME1 , S_STORE_ID1 , D_WEEK_SEQ1 , SUN_SALES1 / SUN_SALES2 , MON_SALES1 / MON_SALES2 , TUE_SALES1 / TUE_SALES2 , WED_SALES1 / WED_SALES2 , THU_SALES1 / THU_SALES2 , FRI_SALES1 / FRI_SALES2 , SAT_SALES1 / SAT_SALES2 FROM ( SELECT S_STORE_NAME AS S_STORE_NAME1 , WSS.D_WEEK_SEQ AS D_WEEK_SEQ1 , S_STORE_ID AS S_STORE_ID1 , SUN_SALES AS SUN_SALES1 , MON_SALES AS MON_SALES1 , TUE_SALES AS TUE_SALES1 , WED_SALES AS WED_SALES1 , THU_SALES AS THU_SALES1 , FRI_SALES AS FRI_SALES1 , SAT_SALES AS SAT_SALES1 FROM WSS , STORE , DATE_DIM AS D WHERE D.D_WEEK_SEQ = WSS.D_WEEK_SEQ AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1182 AND 1182 + 11 ) AS Y , ( SELECT S_STORE_NAME AS S_STORE_NAME2 , WSS.D_WEEK_SEQ AS D_WEEK_SEQ2 , S_STORE_ID AS S_STORE_ID2 , SUN_SALES AS SUN_SALES2 , MON_SALES AS MON_SALES2 , TUE_SALES AS TUE_SALES2 , WED_SALES AS WED_SALES2 , THU_SALES AS THU_SALES2 , FRI_SALES AS FRI_SALES2 , SAT_SALES AS SAT_SALES2 FROM WSS , STORE , DATE_DIM AS D WHERE D.D_WEEK_SEQ = WSS.D_WEEK_SEQ AND SS_STORE_SK = S_STORE_SK AND D_MONTH_SEQ BETWEEN 1182 + 12 AND 1182 + 23 ) AS X WHERE S_STORE_ID1 = S_STORE_ID2 AND D_WEEK_SEQ1 = D_WEEK_SEQ2 - 52 ORDER BY S_STORE_NAME1 NULLS FIRST , S_STORE_ID1 NULLS FIRST , D_WEEK_SEQ1 NULLS FIRST LIMIT 21",
            "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  ?column?  ?column?  ?column?  ?column?  ?column?  ?column?  ?column?\n0           able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n1           able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n2           able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n3           able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n4           able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n5           able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n6           able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n7           able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n8           able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n9           able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n10          able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n11          able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n12          able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n13          able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n14          able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n15          able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n16          able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n17          able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n18          able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.481261,
                "execution_time": 0.252002,
                "compile_time": 0.016085,
                "planning_time": 0.39968
            },
            "query_metrics_warm_up": {
                "elapsed_time": 3.89542,
                "execution_time": 0.264943,
                "compile_time": 3.33911,
                "planning_time": 0.488484
            }
        }
    ],
    "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  ?column?  ?column?  ?column?  ?column?  ?column?  ?column?  ?column?\n0           able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n1           able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n2           able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n3           able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n4           able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n5           able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n6           able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n7           able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n8           able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n9           able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n10          able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n11          able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n12          able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n13          able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n14          able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n15          able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n16          able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n17          able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n18          able  AAAAAAAAACAAAAAA         5140    0.9626    0.8583    0.9358    0.3833    1.2296    1.2884    1.0094\n...*/"
}