{
    "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id\n\tunion all\n\tselect NULL AS i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n ) foo\n order by ca_country, ca_state, ca_county, i_item_id\n limit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY18A.TPL QUERY 90 IN STREAM 0 */ /* TPC-DS QUERY18A.TPL 0.90 */ WITH RESULTS AS ( SELECT I_ITEM_ID , CA_COUNTRY , CA_STATE , CA_COUNTY , CAST ( CS_QUANTITY AS DECIMAL ( 12 , 2 ) ) AS AGG1 , CAST ( CS_LIST_PRICE AS DECIMAL ( 12 , 2 ) ) AS AGG2 , CAST ( CS_COUPON_AMT AS DECIMAL ( 12 , 2 ) ) AS AGG3 , CAST ( CS_SALES_PRICE AS DECIMAL ( 12 , 2 ) ) AS AGG4 , CAST ( CS_NET_PROFIT AS DECIMAL ( 12 , 2 ) ) AS AGG5 , CAST ( C_BIRTH_YEAR AS DECIMAL ( 12 , 2 ) ) AS AGG6 , CAST ( CD1.CD_DEP_COUNT AS DECIMAL ( 12 , 2 ) ) AS AGG7 FROM CATALOG_SALES , CUSTOMER_DEMOGRAPHICS AS CD1 , CUSTOMER_DEMOGRAPHICS AS CD2 , CUSTOMER , CUSTOMER_ADDRESS , DATE_DIM , ITEM WHERE CS_SOLD_DATE_SK = D_DATE_SK AND CS_ITEM_SK = I_ITEM_SK AND CS_BILL_CDEMO_SK = CD1.CD_DEMO_SK AND CS_BILL_CUSTOMER_SK = C_CUSTOMER_SK AND CD1.CD_GENDER = 'M' AND CD1.CD_EDUCATION_STATUS = 'Primary' AND C_CURRENT_CDEMO_SK = CD2.CD_DEMO_SK AND C_CURRENT_ADDR_SK = CA_ADDRESS_SK AND C_BIRTH_MONTH IN ( 9 , 5 , 1 , 2 , 3 , 8 ) AND D_YEAR = 1999 AND CA_STATE IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) SELECT I_ITEM_ID , CA_COUNTRY , CA_STATE , CA_COUNTY , AGG1 , AGG2 , AGG3 , AGG4 , AGG5 , AGG6 , AGG7 FROM ( SELECT I_ITEM_ID , CA_COUNTRY , CA_STATE , CA_COUNTY , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 , AVG ( AGG5 ) AS AGG5 , AVG ( AGG6 ) AS AGG6 , AVG ( AGG7 ) AS AGG7 FROM RESULTS GROUP BY I_ITEM_ID , CA_COUNTRY , CA_STATE , CA_COUNTY UNION ALL SELECT I_ITEM_ID , CA_COUNTRY , CA_STATE , NULL AS COUNTY , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 , AVG ( AGG5 ) AS AGG5 , AVG ( AGG6 ) AS AGG6 , AVG ( AGG7 ) AS AGG7 FROM RESULTS GROUP BY I_ITEM_ID , CA_COUNTRY , CA_STATE UNION ALL SELECT I_ITEM_ID , CA_COUNTRY , NULL AS CA_STATE , NULL AS COUNTY , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 , AVG ( AGG5 ) AS AGG5 , AVG ( AGG6 ) AS AGG6 , AVG ( AGG7 ) AS AGG7 FROM RESULTS GROUP BY I_ITEM_ID , CA_COUNTRY UNION ALL SELECT I_ITEM_ID , NULL AS CA_COUNTRY , NULL AS CA_STATE , NULL AS COUNTY , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 , AVG ( AGG5 ) AS AGG5 , AVG ( AGG6 ) AS AGG6 , AVG ( AGG7 ) AS AGG7 FROM RESULTS GROUP BY I_ITEM_ID UNION ALL SELECT NULL AS I_ITEM_ID , NULL AS CA_COUNTRY , NULL AS CA_STATE , NULL AS COUNTY , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 , AVG ( AGG5 ) AS AGG5 , AVG ( AGG6 ) AS AGG6 , AVG ( AGG7 ) AS AGG7 FROM RESULTS ) AS FOO ORDER BY CA_COUNTRY NULLS FIRST , CA_STATE NULLS FIRST , CA_COUNTY NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
            "preview": "\n/*           i_item_id ca_country ca_state ca_county   agg1    agg2     agg3    agg4     agg5     agg6  agg7\n0               None       None     None      None  50.52  100.54   259.72   50.18  -267.22  1958.18  2.95\n1   AAAAAAAAAAAEBAAA       None     None      None  45.00   32.02    81.56    5.64  -721.61  1956.00  4.00\n2   AAAAAAAAAAAHBAAA       None     None      None  48.50   86.00     0.00   19.20  -828.89  1944.00  3.00\n3   AAAAAAAAAAAIAAAA       None     None      None  59.00  110.82     0.00   16.62 -3591.92  1975.00  6.00\n4   AAAAAAAAAABAAAAA       None     None      None  56.00   49.87     0.00   10.97 -1285.76  1969.00  6.00\n5   AAAAAAAAAABBAAAA       None     None      None  27.00  203.59     0.00   20.35 -1722.06  1981.00  1.00\n6   AAAAAAAAAABGAAAA       None     None      None  47.00    9.38     0.00    6.65   146.17  1943.00  0.00\n7   AAAAAAAAAABHAAAA       None     None      None  70.00   38.75     0.00   17.82   264.60  1987.00  3.00\n8   AAAAAAAAAABJAAAA       None     None      None  36.00   93.54     0.00   17.94 -1520.51  1971.50  2.00\n9   AAAAAAAAAACAAAAA       None     None      None  62.50  145.00     0.00   70.14 -1319.52  1957.00  4.00\n10  AAAAAAAAAACLAAAA       None     None      None  32.00  152.60  2191.41   77.82 -1489.97  1943.00  4.00\n11  AAAAAAAAAACOAAAA       None     None      None  28.00  187.78     0.00    7.51 -2235.24  1948.00  6.00\n12  AAAAAAAAAADDBAAA       None     None      None  37.00  135.69  3883.16  115.33 -1546.98  1977.00  1.00\n13  AAAAAAAAAADHAAAA       None     None      None  84.00  130.97     0.00   41.91  -970.20  1946.00  0.00\n14  AAAAAAAAAADIAAAA       None     None      None  93.00  148.55     0.00   17.82 -3057.84  1956.00  1.00\n15  AAAAAAAAAAEBAAAA       None     None      None  58.00   66.75     0.00   15.35 -2797.34  1940.00  5.00\n16  AAAAAAAAAAECBAAA       None     None      None   4.00  120.44     0.00   65.03    92.84  1946.00  4.00\n17  AAAAAAAAAAEDAAAA       None     None      None  12.00   54.19     0.00   21.13  -377.88  1968.00  4.00\n18  AAAAAAAAAAEFBAAA       None     None      None   5.00   51.25     0.00   30.23    61.85  1978.00  1.00\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.735367,
                "execution_time": 0.371487,
                "compile_time": 0.002742,
                "planning_time": 0.245459
            },
            "query_metrics_warm_up": {
                "elapsed_time": 0.804472,
                "execution_time": 0.354857,
                "compile_time": 0.002836,
                "planning_time": 0.327894
            }
        }
    ],
    "preview": "\n/*           i_item_id ca_country ca_state ca_county   agg1    agg2     agg3    agg4     agg5     agg6  agg7\n0               None       None     None      None  50.52  100.54   259.72   50.18  -267.22  1958.18  2.95\n1   AAAAAAAAAAAEBAAA       None     None      None  45.00   32.02    81.56    5.64  -721.61  1956.00  4.00\n2   AAAAAAAAAAAHBAAA       None     None      None  48.50   86.00     0.00   19.20  -828.89  1944.00  3.00\n3   AAAAAAAAAAAIAAAA       None     None      None  59.00  110.82     0.00   16.62 -3591.92  1975.00  6.00\n4   AAAAAAAAAABAAAAA       None     None      None  56.00   49.87     0.00   10.97 -1285.76  1969.00  6.00\n5   AAAAAAAAAABBAAAA       None     None      None  27.00  203.59     0.00   20.35 -1722.06  1981.00  1.00\n6   AAAAAAAAAABGAAAA       None     None      None  47.00    9.38     0.00    6.65   146.17  1943.00  0.00\n7   AAAAAAAAAABHAAAA       None     None      None  70.00   38.75     0.00   17.82   264.60  1987.00  3.00\n8   AAAAAAAAAABJAAAA       None     None      None  36.00   93.54     0.00   17.94 -1520.51  1971.50  2.00\n9   AAAAAAAAAACAAAAA       None     None      None  62.50  145.00     0.00   70.14 -1319.52  1957.00  4.00\n10  AAAAAAAAAACLAAAA       None     None      None  32.00  152.60  2191.41   77.82 -1489.97  1943.00  4.00\n11  AAAAAAAAAACOAAAA       None     None      None  28.00  187.78     0.00    7.51 -2235.24  1948.00  6.00\n12  AAAAAAAAAADDBAAA       None     None      None  37.00  135.69  3883.16  115.33 -1546.98  1977.00  1.00\n13  AAAAAAAAAADHAAAA       None     None      None  84.00  130.97     0.00   41.91  -970.20  1946.00  0.00\n14  AAAAAAAAAADIAAAA       None     None      None  93.00  148.55     0.00   17.82 -3057.84  1956.00  1.00\n15  AAAAAAAAAAEBAAAA       None     None      None  58.00   66.75     0.00   15.35 -2797.34  1940.00  5.00\n16  AAAAAAAAAAECBAAA       None     None      None   4.00  120.44     0.00   65.03    92.84  1946.00  4.00\n17  AAAAAAAAAAEDAAAA       None     None      None  12.00   54.19     0.00   21.13  -377.88  1968.00  4.00\n18  AAAAAAAAAAEFBAAA       None     None      None   5.00   51.25     0.00   30.23    61.85  1978.00  1.00\n...*/"
}