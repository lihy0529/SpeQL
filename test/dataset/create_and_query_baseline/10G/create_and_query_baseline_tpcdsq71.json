{
    "input": "-- start template query71.tpl query 72 in stream 0\nselect /* TPC-DS query71.tpl 0.72 */ i_brand_id brand_id, i_brand brand,t_hour,t_minute,\n \tsum(ext_price) ext_price\n from item, (select ws_ext_sales_price as ext_price, \n                        ws_sold_date_sk as sold_date_sk,\n                        ws_item_sk as sold_item_sk,\n                        ws_sold_time_sk as time_sk  \n                 from web_sales,date_dim\n                 where d_date_sk = ws_sold_date_sk\n                   and d_moy=12\n                   and d_year=2001\n                 union all\n                 select cs_ext_sales_price as ext_price,\n                        cs_sold_date_sk as sold_date_sk,\n                        cs_item_sk as sold_item_sk,\n                        cs_sold_time_sk as time_sk\n                 from catalog_sales,date_dim\n                 where d_date_sk = cs_sold_date_sk\n                   and d_moy=12\n                   and d_year=2001\n                 union all\n                 select ss_ext_sales_price as ext_price,\n                        ss_sold_date_sk as sold_date_sk,\n                        ss_item_sk as sold_item_sk,\n                        ss_sold_time_sk as time_sk\n                 from store_sales,date_dim\n                 where d_date_sk = ss_sold_date_sk\n                   and d_moy=12\n                   and d_year=2001\n                 ) tmp,time_dim\n where\n   sold_item_sk = i_item_sk\n   and i_manager_id=1\n   and time_sk = t_time_sk\n   and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\n group by i_brand, i_brand_id,t_hour,t_minute\n order by ext_price desc, i_brand_id\nlimit 100\n ",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY71.TPL QUERY 72 IN STREAM 0 */ /* TPC-DS QUERY71.TPL 0.72 */ SELECT I_BRAND_ID AS BRAND_ID , I_BRAND AS BRAND , T_HOUR , T_MINUTE , SUM ( EXT_PRICE ) AS EXT_PRICE FROM ITEM , ( SELECT WS_EXT_SALES_PRICE AS EXT_PRICE , WS_SOLD_DATE_SK AS SOLD_DATE_SK , WS_ITEM_SK AS SOLD_ITEM_SK , WS_SOLD_TIME_SK AS TIME_SK FROM WEB_SALES , DATE_DIM WHERE D_DATE_SK = WS_SOLD_DATE_SK AND D_MOY = 12 AND D_YEAR = 2001 UNION ALL SELECT CS_EXT_SALES_PRICE AS EXT_PRICE , CS_SOLD_DATE_SK AS SOLD_DATE_SK , CS_ITEM_SK AS SOLD_ITEM_SK , CS_SOLD_TIME_SK AS TIME_SK FROM CATALOG_SALES , DATE_DIM WHERE D_DATE_SK = CS_SOLD_DATE_SK AND D_MOY = 12 AND D_YEAR = 2001 UNION ALL SELECT SS_EXT_SALES_PRICE AS EXT_PRICE , SS_SOLD_DATE_SK AS SOLD_DATE_SK , SS_ITEM_SK AS SOLD_ITEM_SK , SS_SOLD_TIME_SK AS TIME_SK FROM STORE_SALES , DATE_DIM WHERE D_DATE_SK = SS_SOLD_DATE_SK AND D_MOY = 12 AND D_YEAR = 2001 ) AS TMP , TIME_DIM WHERE SOLD_ITEM_SK = I_ITEM_SK AND I_MANAGER_ID = 1 AND TIME_SK = T_TIME_SK AND ( T_MEAL_TIME = 'breakfast' OR T_MEAL_TIME = 'dinner' ) GROUP BY I_BRAND , I_BRAND_ID , T_HOUR , T_MINUTE ORDER BY EXT_PRICE DESC NULLS LAST , I_BRAND_ID NULLS FIRST LIMIT 21",
            "preview": "\n/*    brand_id                brand  t_hour  t_minute  ext_price\n0    3002002    importoexporti #2      17        11   28533.74\n1    4004002  edu packedu pack #2       8        32   23709.92\n2    9009002          maximaxi #2      19        13   22886.40\n3    3003002    exportiexporti #2      19        19   21944.02\n4    4004002  edu packedu pack #2      18        44   21435.83\n5    1002002      importoamalg #2      18        14   21256.14\n6    3002002    importoexporti #2      17        36   20982.72\n7   10007012   univamalgamalg #13      17        12   20901.75\n8    8003004   exportinameless #4      18        56   19609.95\n9   10013004      amalgscholar #2       7        31   19315.20\n10   2004001        amalgamalg #2      18        53   18953.10\n11   9004003      amalgimporto #2      18        32   18705.10\n12   2004002   edu packimporto #2      18        55   18585.20\n13   9013002  exportiunivamalg #2       9        21   18488.68\n14   6016008         corpbrand #8      17        39   18386.10\n15   6014004     edu packbrand #4       7        11   18290.25\n16   1002002      importoamalg #2      17        43   18159.52\n17  10010004    univamalgamalg #4      18         1   18158.55\n18   2004001          corpmaxi #8       8        13   18014.85\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.147084,
                "execution_time": 0.051723,
                "compile_time": 0.000451,
                "planning_time": 0.073579
            },
            "query_metrics_warm_up": {
                "elapsed_time": 0.248034,
                "execution_time": 0.063059,
                "compile_time": 0.000487,
                "planning_time": 0.161697
            }
        }
    ],
    "preview": "\n/*    brand_id                brand  t_hour  t_minute  ext_price\n0    3002002    importoexporti #2      17        11   28533.74\n1    4004002  edu packedu pack #2       8        32   23709.92\n2    9009002          maximaxi #2      19        13   22886.40\n3    3003002    exportiexporti #2      19        19   21944.02\n4    4004002  edu packedu pack #2      18        44   21435.83\n5    1002002      importoamalg #2      18        14   21256.14\n6    3002002    importoexporti #2      17        36   20982.72\n7   10007012   univamalgamalg #13      17        12   20901.75\n8    8003004   exportinameless #4      18        56   19609.95\n9   10013004      amalgscholar #2       7        31   19315.20\n10   2004001        amalgamalg #2      18        53   18953.10\n11   9004003      amalgimporto #2      18        32   18705.10\n12   2004002   edu packimporto #2      18        55   18585.20\n13   9013002  exportiunivamalg #2       9        21   18488.68\n14   6016008         corpbrand #8      17        39   18386.10\n15   6014004     edu packbrand #4       7        11   18290.25\n16   1002002      importoamalg #2      17        43   18159.52\n17  10010004    univamalgamalg #4      18         1   18158.55\n18   2004001          corpmaxi #8       8        13   18014.85\n...*/"
}