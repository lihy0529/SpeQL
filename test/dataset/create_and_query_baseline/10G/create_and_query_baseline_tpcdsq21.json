{
    "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null\n             end) between 2.0/3.0 and 3.0/2.0\n order by w_warehouse_name\n         ,i_item_id\n limit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY21.TPL QUERY 14 IN STREAM 0 */ /* TPC-DS QUERY21.TPL 0.14 */ SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN INV_AFTER / INV_BEFORE ELSE NULL END ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0 ORDER BY W_WAREHOUSE_NAME NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
            "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAAAAFBBAAA        2385       2507\n1                    AAAAAAAAAAFFBAAA        2720       2904\n2                    AAAAAAAAAAHDAAAA        1722       2552\n3                    AAAAAAAAAAKNAAAA        2126       2484\n4                    AAAAAAAAAALHBAAA        1642       2713\n5                    AAAAAAAAAANKAAAA        1856       2854\n6                    AAAAAAAAAAPBBAAA        2020       2425\n7                    AAAAAAAAABACBAAA        2404       2497\n8                    AAAAAAAAABHFBAAA        2790       3447\n9                    AAAAAAAAABIKAAAA        1425       1449\n10                   AAAAAAAAACEHBAAA        1962       2676\n11                   AAAAAAAAACGFBAAA        1903       2309\n12                   AAAAAAAAACGOAAAA        2007       2290\n13                   AAAAAAAAACGPAAAA        1181       2329\n14                   AAAAAAAAACLNAAAA        1441       1992\n15                   AAAAAAAAACNBBAAA        2222       2448\n16                   AAAAAAAAACOGAAAA        1690       1778\n17                   AAAAAAAAACPDAAAA        1827       3110\n18                   AAAAAAAAADGBAAAA        2305       2379\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.102664,
                "execution_time": 0.037689,
                "compile_time": 0.000298,
                "planning_time": 0.047617
            },
            "query_metrics_warm_up": {
                "elapsed_time": 0.152696,
                "execution_time": 0.086181,
                "compile_time": 0.000288,
                "planning_time": 0.047994
            }
        }
    ],
    "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAAAAFBBAAA        2385       2507\n1                    AAAAAAAAAAFFBAAA        2720       2904\n2                    AAAAAAAAAAHDAAAA        1722       2552\n3                    AAAAAAAAAAKNAAAA        2126       2484\n4                    AAAAAAAAAALHBAAA        1642       2713\n5                    AAAAAAAAAANKAAAA        1856       2854\n6                    AAAAAAAAAAPBBAAA        2020       2425\n7                    AAAAAAAAABACBAAA        2404       2497\n8                    AAAAAAAAABHFBAAA        2790       3447\n9                    AAAAAAAAABIKAAAA        1425       1449\n10                   AAAAAAAAACEHBAAA        1962       2676\n11                   AAAAAAAAACGFBAAA        1903       2309\n12                   AAAAAAAAACGOAAAA        2007       2290\n13                   AAAAAAAAACGPAAAA        1181       2329\n14                   AAAAAAAAACLNAAAA        1441       1992\n15                   AAAAAAAAACNBBAAA        2222       2448\n16                   AAAAAAAAACOGAAAA        1690       1778\n17                   AAAAAAAAACPDAAAA        1827       3110\n18                   AAAAAAAAADGBAAAA        2305       2379\n...*/"
}