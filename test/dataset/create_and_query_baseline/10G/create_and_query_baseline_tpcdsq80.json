{
    "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + INTERVAL '30' day) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr ) x \nGROUP BY rollup (channel, id) \nORDER BY channel , \n         id \nLIMIT 100",
    "query": [
        {
            "query": "/* START QUERY 80 IN STREAM 0 USING TEMPLATE QUERY80.TPL */ WITH SSR AS ( SELECT S_STORE_ID AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + INTERVAL '30 DAY' ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + INTERVAL '30 DAY' ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + INTERVAL '30 DAY' ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WEB_SITE_ID ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS X GROUP BY ROLLUP ( CHANNEL , ID ) ORDER BY CHANNEL NULLS FIRST , ID NULLS FIRST LIMIT 21",
            "preview": "\n/*            channel                            id         sales    returns1       profit\n0              None                          None  1.271110e+08  6424503.27 -36754421.03\n1   catalog channel                          None  4.407953e+07  2398249.89  -5981128.39\n2   catalog channel  catalog_pageAAAAAAAAAADBAAAA  7.283995e+04     5660.98      5209.73\n3   catalog channel  catalog_pageAAAAAAAAABABAAAA  2.018806e+05    12740.66      4269.14\n4   catalog channel  catalog_pageAAAAAAAAABDBAAAA  4.719332e+04     1051.00     -8207.88\n5   catalog channel  catalog_pageAAAAAAAAACABAAAA  1.583202e+05    11940.52    -37165.83\n6   catalog channel  catalog_pageAAAAAAAAACDBAAAA  6.122754e+04     8225.35    -31217.09\n7   catalog channel  catalog_pageAAAAAAAAADABAAAA  2.264666e+05     6000.89    -19111.82\n8   catalog channel  catalog_pageAAAAAAAAADDBAAAA  5.881742e+04     2030.70     -5520.46\n9   catalog channel  catalog_pageAAAAAAAAAEABAAAA  2.297213e+05     6538.01     -2992.13\n10  catalog channel  catalog_pageAAAAAAAAAEDBAAAA  6.244772e+04      530.01     -5267.51\n11  catalog channel  catalog_pageAAAAAAAAAFABAAAA  1.946777e+05    16620.45    -10280.60\n12  catalog channel  catalog_pageAAAAAAAAAFDBAAAA  6.152968e+04     1386.19    -11633.03\n13  catalog channel  catalog_pageAAAAAAAAAGABAAAA  2.455351e+05    13788.68    -22571.30\n14  catalog channel  catalog_pageAAAAAAAAAGDBAAAA  4.320387e+04     2556.91    -10092.64\n15  catalog channel  catalog_pageAAAAAAAAAHABAAAA  2.065281e+05    12688.88    -30074.16\n16  catalog channel  catalog_pageAAAAAAAAAHDBAAAA  5.605339e+04     1553.07     -8907.02\n17  catalog channel  catalog_pageAAAAAAAAAIABAAAA  1.162217e+05     5959.78    -26614.14\n18  catalog channel  catalog_pageAAAAAAAAAIDBAAAA  3.420530e+04     1159.23    -22081.76\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.300893,
                "execution_time": 0.090702,
                "compile_time": 0.001101,
                "planning_time": 0.16168
            },
            "query_metrics_warm_up": {
                "elapsed_time": 0.450742,
                "execution_time": 0.119643,
                "compile_time": 0.001103,
                "planning_time": 0.281523
            }
        }
    ],
    "preview": "\n/*            channel                            id         sales    returns1       profit\n0              None                          None  1.271110e+08  6424503.27 -36754421.03\n1   catalog channel                          None  4.407953e+07  2398249.89  -5981128.39\n2   catalog channel  catalog_pageAAAAAAAAAADBAAAA  7.283995e+04     5660.98      5209.73\n3   catalog channel  catalog_pageAAAAAAAAABABAAAA  2.018806e+05    12740.66      4269.14\n4   catalog channel  catalog_pageAAAAAAAAABDBAAAA  4.719332e+04     1051.00     -8207.88\n5   catalog channel  catalog_pageAAAAAAAAACABAAAA  1.583202e+05    11940.52    -37165.83\n6   catalog channel  catalog_pageAAAAAAAAACDBAAAA  6.122754e+04     8225.35    -31217.09\n7   catalog channel  catalog_pageAAAAAAAAADABAAAA  2.264666e+05     6000.89    -19111.82\n8   catalog channel  catalog_pageAAAAAAAAADDBAAAA  5.881742e+04     2030.70     -5520.46\n9   catalog channel  catalog_pageAAAAAAAAAEABAAAA  2.297213e+05     6538.01     -2992.13\n10  catalog channel  catalog_pageAAAAAAAAAEDBAAAA  6.244772e+04      530.01     -5267.51\n11  catalog channel  catalog_pageAAAAAAAAAFABAAAA  1.946777e+05    16620.45    -10280.60\n12  catalog channel  catalog_pageAAAAAAAAAFDBAAAA  6.152968e+04     1386.19    -11633.03\n13  catalog channel  catalog_pageAAAAAAAAAGABAAAA  2.455351e+05    13788.68    -22571.30\n14  catalog channel  catalog_pageAAAAAAAAAGDBAAAA  4.320387e+04     2556.91    -10092.64\n15  catalog channel  catalog_pageAAAAAAAAAHABAAAA  2.065281e+05    12688.88    -30074.16\n16  catalog channel  catalog_pageAAAAAAAAAHDBAAAA  5.605339e+04     1553.07     -8907.02\n17  catalog channel  catalog_pageAAAAAAAAAIABAAAA  1.162217e+05     5959.78    -26614.14\n18  catalog channel  catalog_pageAAAAAAAAAIDBAAAA  3.420530e+04     1159.23    -22081.76\n...*/"
}