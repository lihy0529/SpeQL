{
    "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name and\n     cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n       ,cs1.store_name\n       ,cs2.cnt\n       ,cs1.s1\n       ,cs2.s1\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY64.TPL QUERY 20 IN STREAM 0 */ /* TPC-DS QUERY64.TPL 0.20 */ WITH CS_UI AS ( SELECT CS_ITEM_SK , SUM ( CS_EXT_LIST_PRICE ) AS SALE , SUM ( CR_REFUNDED_CASH + CR_REVERSED_CHARGE + CR_STORE_CREDIT ) AS REFUND FROM CATALOG_SALES , CATALOG_RETURNS WHERE CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER GROUP BY CS_ITEM_SK HAVING SUM ( CS_EXT_LIST_PRICE ) > 2 * SUM ( CR_REFUNDED_CASH + CR_REVERSED_CHARGE + CR_STORE_CREDIT ) ) , CROSS_SALES AS ( SELECT I_PRODUCT_NAME AS PRODUCT_NAME , I_ITEM_SK AS ITEM_SK , S_STORE_NAME AS STORE_NAME , S_ZIP AS STORE_ZIP , AD1.CA_STREET_NUMBER AS B_STREET_NUMBER , AD1.CA_STREET_NAME AS B_STREET_NAME , AD1.CA_CITY AS B_CITY , AD1.CA_ZIP AS B_ZIP , AD2.CA_STREET_NUMBER AS C_STREET_NUMBER , AD2.CA_STREET_NAME AS C_STREET_NAME , AD2.CA_CITY AS C_CITY , AD2.CA_ZIP AS C_ZIP , D1.D_YEAR AS SYEAR , D2.D_YEAR AS FSYEAR , D3.D_YEAR AS S2YEAR , COUNT ( * ) AS CNT , SUM ( SS_WHOLESALE_COST ) AS S1 , SUM ( SS_LIST_PRICE ) AS S2 , SUM ( SS_COUPON_AMT ) AS S3 FROM STORE_SALES , STORE_RETURNS , CS_UI , DATE_DIM AS D1 , DATE_DIM AS D2 , DATE_DIM AS D3 , STORE , CUSTOMER , CUSTOMER_DEMOGRAPHICS AS CD1 , CUSTOMER_DEMOGRAPHICS AS CD2 , PROMOTION , HOUSEHOLD_DEMOGRAPHICS AS HD1 , HOUSEHOLD_DEMOGRAPHICS AS HD2 , CUSTOMER_ADDRESS AS AD1 , CUSTOMER_ADDRESS AS AD2 , INCOME_BAND AS IB1 , INCOME_BAND AS IB2 , ITEM WHERE SS_STORE_SK = S_STORE_SK AND SS_SOLD_DATE_SK = D1.D_DATE_SK AND SS_CUSTOMER_SK = C_CUSTOMER_SK AND SS_CDEMO_SK = CD1.CD_DEMO_SK AND SS_HDEMO_SK = HD1.HD_DEMO_SK AND SS_ADDR_SK = AD1.CA_ADDRESS_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER AND SS_ITEM_SK = CS_UI.CS_ITEM_SK AND C_CURRENT_CDEMO_SK = CD2.CD_DEMO_SK AND C_CURRENT_HDEMO_SK = HD2.HD_DEMO_SK AND C_CURRENT_ADDR_SK = AD2.CA_ADDRESS_SK AND C_FIRST_SALES_DATE_SK = D2.D_DATE_SK AND C_FIRST_SHIPTO_DATE_SK = D3.D_DATE_SK AND SS_PROMO_SK = P_PROMO_SK AND HD1.HD_INCOME_BAND_SK = IB1.IB_INCOME_BAND_SK AND HD2.HD_INCOME_BAND_SK = IB2.IB_INCOME_BAND_SK AND CD1.CD_MARITAL_STATUS <> CD2.CD_MARITAL_STATUS AND I_COLOR IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND I_CURRENT_PRICE BETWEEN 68 AND 68 + 10 AND I_CURRENT_PRICE BETWEEN 68 + 1 AND 68 + 15 GROUP BY I_PRODUCT_NAME , I_ITEM_SK , S_STORE_NAME , S_ZIP , AD1.CA_STREET_NUMBER , AD1.CA_STREET_NAME , AD1.CA_CITY , AD1.CA_ZIP , AD2.CA_STREET_NUMBER , AD2.CA_STREET_NAME , AD2.CA_CITY , AD2.CA_ZIP , D1.D_YEAR , D2.D_YEAR , D3.D_YEAR ) SELECT CS1.PRODUCT_NAME , CS1.STORE_NAME , CS1.STORE_ZIP , CS1.B_STREET_NUMBER , CS1.B_STREET_NAME , CS1.B_CITY , CS1.B_ZIP , CS1.C_STREET_NUMBER , CS1.C_STREET_NAME , CS1.C_CITY , CS1.C_ZIP , CS1.SYEAR , CS1.CNT , CS1.S1 AS S11 , CS1.S2 AS S21 , CS1.S3 AS S31 , CS2.S1 AS S12 , CS2.S2 AS S22 , CS2.S3 AS S32 , CS2.SYEAR , CS2.CNT FROM CROSS_SALES AS CS1 , CROSS_SALES AS CS2 WHERE CS1.ITEM_SK = CS2.ITEM_SK AND CS1.SYEAR = 2000 AND CS2.SYEAR = 2000 + 1 AND CS2.CNT <= CS1.CNT AND CS1.STORE_NAME = CS2.STORE_NAME AND CS1.STORE_ZIP = CS2.STORE_ZIP ORDER BY CS1.PRODUCT_NAME NULLS FIRST , CS1.STORE_NAME NULLS FIRST , CS2.CNT NULLS FIRST , CS1.S1 NULLS FIRST , CS2.S1 NULLS FIRST LIMIT 21",
            "preview": "\n/*            product_name store_name store_zip b_street_number b_street_name       b_city  b_zip c_street_number   c_street_name          c_city  c_zip  syear  cnt    s11     s21  s31    s12     s22    s32  syear  cnt\n0   antiablen stbarought       anti     33604             545     South Oak    White Oak  66668             266            6th       Bridgeport  75817   2000    1  74.56  131.22  0.0  89.13  156.86   0.00   2001    1\n1    ationeingpribarable       able     36098             756   Sunset 11th    White Oak  76668             588      Main Green      Greenville  71387   2000    1  94.54  138.97  0.0  90.58   90.58   0.00   2001    1\n2  n stoughteingantianti       eing     31904             722         Lake   Bunker Hill  20150             491           Park      Maple Grove  68252   2000    1  60.78   93.60  0.0  26.73   44.10   0.00   2001    1\n3  pricallyantieingcally       able     36098             709      Jackson       Lebanon  12898             763  5th Thirteenth  Pleasant Grove  64136   2000    1  70.30  110.37  0.0  31.71   44.07  16.17   2001    1*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 1.031436,
                "execution_time": 0.478972,
                "compile_time": 0.079931,
                "planning_time": 0.540627
            },
            "query_metrics_warm_up": {
                "elapsed_time": 11.959428,
                "execution_time": 1.570882,
                "compile_time": 9.930131,
                "planning_time": 0.555687
            }
        }
    ],
    "preview": "\n/*            product_name store_name store_zip b_street_number b_street_name       b_city  b_zip c_street_number   c_street_name          c_city  c_zip  syear  cnt    s11     s21  s31    s12     s22    s32  syear  cnt\n0   antiablen stbarought       anti     33604             545     South Oak    White Oak  66668             266            6th       Bridgeport  75817   2000    1  74.56  131.22  0.0  89.13  156.86   0.00   2001    1\n1    ationeingpribarable       able     36098             756   Sunset 11th    White Oak  76668             588      Main Green      Greenville  71387   2000    1  94.54  138.97  0.0  90.58   90.58   0.00   2001    1\n2  n stoughteingantianti       eing     31904             722         Lake   Bunker Hill  20150             491           Park      Maple Grove  68252   2000    1  60.78   93.60  0.0  26.73   44.10   0.00   2001    1\n3  pricallyantieingcally       able     36098             709      Jackson       Lebanon  12898             763  5th Thirteenth  Pleasant Grove  64136   2000    1  70.30  110.37  0.0  31.71   44.07  16.17   2001    1*/"
}