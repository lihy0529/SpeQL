{
    "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name)\n         avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n      or (i_category in ('Electronics','Women','Jewelry') and\n          i_class in ('portable','fragrances','diamonds') \n        ))\ngroup by i_category, i_class, i_brand,\n         s_store_name, s_company_name, d_moy) tmp1\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\norder by sum_sales - avg_monthly_sales, s_store_name\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY89.TPL QUERY 56 IN STREAM 0 */ /* TPC-DS QUERY89.TPL 0.56 */ SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , S_STORE_NAME , S_COMPANY_NAME , D_MOY , SUM ( SS_SALES_PRICE ) AS SUM_SALES , AVG ( SUM ( SS_SALES_PRICE ) ) OVER ( PARTITION BY I_CATEGORY , I_BRAND , S_STORE_NAME , S_COMPANY_NAME ) AS AVG_MONTHLY_SALES FROM ITEM , STORE_SALES , DATE_DIM , STORE WHERE SS_ITEM_SK = I_ITEM_SK AND SS_SOLD_DATE_SK = D_DATE_SK AND SS_STORE_SK = S_STORE_SK AND D_YEAR IN ( 1999 ) AND ( ( I_CATEGORY IN ( 'Shoes' , 'Men' , 'Music' ) AND I_CLASS IN ( 'kids' , 'sports-apparel' , 'classical' ) ) OR ( I_CATEGORY IN ( 'Electronics' , 'Women' , 'Jewelry' ) AND I_CLASS IN ( 'portable' , 'fragrances' , 'diamonds' ) ) ) GROUP BY I_CATEGORY , I_CLASS , I_BRAND , S_STORE_NAME , S_COMPANY_NAME , D_MOY ) AS TMP1 WHERE CASE WHEN ( AVG_MONTHLY_SALES <> 0 ) THEN ( ABS ( SUM_SALES - AVG_MONTHLY_SALES ) / AVG_MONTHLY_SALES ) ELSE NULL END > 0.1 ORDER BY SUM_SALES - AVG_MONTHLY_SALES NULLS FIRST , S_STORE_NAME NULLS FIRST LIMIT 21",
            "preview": "\n/*   i_category         i_class             i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0       Music       classical  edu packscholar #1         able        Unknown      4   20209.93           41126.86\n1       Shoes            kids  exportiedu pack #1         able        Unknown      2   21300.26           41366.93\n2       Women      fragrances     importoamalg #1          ese        Unknown      2   18737.11           38432.73\n3       Music       classical  edu packscholar #1          bar        Unknown      5   21426.81           41105.97\n4       Music       classical  edu packscholar #1          ese        Unknown      2   21159.52           40512.92\n5       Shoes            kids  exportiedu pack #1         eing        Unknown      3   21675.46           40983.42\n6       Shoes            kids  exportiedu pack #1         eing        Unknown      2   21680.49           40983.42\n7       Shoes            kids  exportiedu pack #1          ese        Unknown      2   21706.91           40956.12\n8       Shoes            kids  exportiedu pack #1          bar        Unknown      2   21269.84           40474.83\n9         Men  sports-apparel  edu packimporto #1          bar        Unknown      2   21079.37           40260.00\n10      Music       classical  edu packscholar #1         eing        Unknown      3   21870.89           40961.73\n11      Shoes            kids  exportiedu pack #1          ese        Unknown      4   21980.55           40956.12\n12      Music       classical  edu packscholar #1         able        Unknown      2   22198.23           41126.86\n13      Shoes            kids  exportiedu pack #1         able        Unknown      4   22529.43           41366.93\n14        Men  sports-apparel  edu packimporto #1         able        Unknown      6   22479.12           41293.54\n15      Shoes            kids  exportiedu pack #1          bar        Unknown      7   21701.61           40474.83\n16      Music       classical  edu packscholar #1         eing        Unknown      4   22240.76           40961.73\n17        Men  sports-apparel  edu packimporto #1         able        Unknown      3   22602.90           41293.54\n18        Men  sports-apparel  edu packimporto #1         eing        Unknown      2   22386.85           41008.16\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.138337,
                "execution_time": 0.061697,
                "compile_time": 0.000422,
                "planning_time": 0.056467
            },
            "query_metrics_warm_up": {
                "elapsed_time": 0.210425,
                "execution_time": 0.061591,
                "compile_time": 0.00039,
                "planning_time": 0.127697
            }
        }
    ],
    "preview": "\n/*   i_category         i_class             i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0       Music       classical  edu packscholar #1         able        Unknown      4   20209.93           41126.86\n1       Shoes            kids  exportiedu pack #1         able        Unknown      2   21300.26           41366.93\n2       Women      fragrances     importoamalg #1          ese        Unknown      2   18737.11           38432.73\n3       Music       classical  edu packscholar #1          bar        Unknown      5   21426.81           41105.97\n4       Music       classical  edu packscholar #1          ese        Unknown      2   21159.52           40512.92\n5       Shoes            kids  exportiedu pack #1         eing        Unknown      3   21675.46           40983.42\n6       Shoes            kids  exportiedu pack #1         eing        Unknown      2   21680.49           40983.42\n7       Shoes            kids  exportiedu pack #1          ese        Unknown      2   21706.91           40956.12\n8       Shoes            kids  exportiedu pack #1          bar        Unknown      2   21269.84           40474.83\n9         Men  sports-apparel  edu packimporto #1          bar        Unknown      2   21079.37           40260.00\n10      Music       classical  edu packscholar #1         eing        Unknown      3   21870.89           40961.73\n11      Shoes            kids  exportiedu pack #1          ese        Unknown      4   21980.55           40956.12\n12      Music       classical  edu packscholar #1         able        Unknown      2   22198.23           41126.86\n13      Shoes            kids  exportiedu pack #1         able        Unknown      4   22529.43           41366.93\n14        Men  sports-apparel  edu packimporto #1         able        Unknown      6   22479.12           41293.54\n15      Shoes            kids  exportiedu pack #1          bar        Unknown      7   21701.61           40474.83\n16      Music       classical  edu packscholar #1         eing        Unknown      4   22240.76           40961.73\n17        Men  sports-apparel  edu packimporto #1         able        Unknown      3   22602.90           41293.54\n18        Men  sports-apparel  edu packimporto #1         eing        Unknown      2   22386.85           41008.16\n...*/"
}