{
    "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \n  and d3.d_date > d1.d_date + 5\n  and hd_buy_potential = '1001-5000'\n  and d1.d_year = 2000\n  and cd_marital_status = 'D'\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY72.TPL QUERY 87 IN STREAM 0 */ /* TPC-DS QUERY72.TPL 0.87 */ SELECT I_ITEM_DESC , W_WAREHOUSE_NAME , D1.D_WEEK_SEQ , SUM ( CASE WHEN P_PROMO_SK IS NULL THEN 1 ELSE 0 END ) AS NO_PROMO , SUM ( CASE WHEN NOT P_PROMO_SK IS NULL THEN 1 ELSE 0 END ) AS PROMO , COUNT ( * ) AS TOTAL_CNT FROM CATALOG_SALES JOIN INVENTORY ON ( CS_ITEM_SK = INV_ITEM_SK ) JOIN WAREHOUSE ON ( W_WAREHOUSE_SK = INV_WAREHOUSE_SK ) JOIN ITEM ON ( I_ITEM_SK = CS_ITEM_SK ) JOIN CUSTOMER_DEMOGRAPHICS ON ( CS_BILL_CDEMO_SK = CD_DEMO_SK ) JOIN HOUSEHOLD_DEMOGRAPHICS ON ( CS_BILL_HDEMO_SK = HD_DEMO_SK ) JOIN DATE_DIM AS D1 ON ( CS_SOLD_DATE_SK = D1.D_DATE_SK ) JOIN DATE_DIM AS D2 ON ( INV_DATE_SK = D2.D_DATE_SK ) JOIN DATE_DIM AS D3 ON ( CS_SHIP_DATE_SK = D3.D_DATE_SK ) LEFT OUTER JOIN PROMOTION ON ( CS_PROMO_SK = P_PROMO_SK ) LEFT OUTER JOIN CATALOG_RETURNS ON ( CR_ITEM_SK = CS_ITEM_SK AND CR_ORDER_NUMBER = CS_ORDER_NUMBER ) WHERE D1.D_WEEK_SEQ = D2.D_WEEK_SEQ AND INV_QUANTITY_ON_HAND < CS_QUANTITY AND D3.D_DATE > D1.D_DATE + 5 AND HD_BUY_POTENTIAL = '1001-5000' AND D1.D_YEAR = 2000 AND CD_MARITAL_STATUS = 'D' GROUP BY I_ITEM_DESC , W_WAREHOUSE_NAME , D1.D_WEEK_SEQ ORDER BY TOTAL_CNT DESC NULLS LAST , I_ITEM_DESC NULLS FIRST , W_WAREHOUSE_NAME NULLS FIRST , D_WEEK_SEQ NULLS FIRST LIMIT 21",
            "preview": "\n/*                                                                                                                                                                                            i_item_desc      w_warehouse_name  d_week_seq  no_promo  promo  total_cnt\n0                                                                                                         English weeks say anymore police; together happy traders shall buy strongly english other lad      Plain, reluctant        5264         0      3          3\n1                                                                                                    Just acceptable personnel hear above detailed, open results. Necessary leaders seek general, certa   Conventional childr        5264         0      3          3\n2                                                                                                    Just acceptable personnel hear above detailed, open results. Necessary leaders seek general, certa           Doors canno        5264         0      3          3\n3                                                                                                    Just acceptable personnel hear above detailed, open results. Necessary leaders seek general, certa      Plain, reluctant        5264         0      3          3\n4                                                                                                                               National regulations make minutes. Left sources take easy songs; only s      Plain, reluctant        5264         0      3          3\n5                                                                                                     Soft letters mean then final, grim leads. Strategic, good forms protect straight red, good change      National, comple        5263         0      3          3\n6                                                                                                                                                                                       Users shall ach      Plain, reluctant        5264         0      3          3\n7                                                                                                                                                                                                                                    5270         0      2          2\n8                                                                                                                                                                                                        Bad cards must make.        5253         0      2          2\n9                                                                                                                                                                                                        Bad cards must make.        5263         0      2          2\n10                                                                                                                                                                                                        Conventional childr        5260         0      2          2\n11                                                                                                                                                                                                                Doors canno        5265         0      2          2\n12                                                                                                                                                                                                       Important issues liv        5246         0      2          2\n13                                                                                                                                                                                                       Important issues liv        5255         0      2          2\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 3.210079,
                "execution_time": 2.820333,
                "compile_time": 0.199177,
                "planning_time": 0.159227
            },
            "query_metrics_warm_up": {
                "elapsed_time": 14.080901,
                "execution_time": 3.415771,
                "compile_time": 10.37066,
                "planning_time": 0.253414
            }
        }
    ],
    "preview": "\n/*                                                                                                                                                                                            i_item_desc      w_warehouse_name  d_week_seq  no_promo  promo  total_cnt\n0                                                                                                         English weeks say anymore police; together happy traders shall buy strongly english other lad      Plain, reluctant        5264         0      3          3\n1                                                                                                    Just acceptable personnel hear above detailed, open results. Necessary leaders seek general, certa   Conventional childr        5264         0      3          3\n2                                                                                                    Just acceptable personnel hear above detailed, open results. Necessary leaders seek general, certa           Doors canno        5264         0      3          3\n3                                                                                                    Just acceptable personnel hear above detailed, open results. Necessary leaders seek general, certa      Plain, reluctant        5264         0      3          3\n4                                                                                                                               National regulations make minutes. Left sources take easy songs; only s      Plain, reluctant        5264         0      3          3\n5                                                                                                     Soft letters mean then final, grim leads. Strategic, good forms protect straight red, good change      National, comple        5263         0      3          3\n6                                                                                                                                                                                       Users shall ach      Plain, reluctant        5264         0      3          3\n7                                                                                                                                                                                                                                    5270         0      2          2\n8                                                                                                                                                                                                        Bad cards must make.        5253         0      2          2\n9                                                                                                                                                                                                        Bad cards must make.        5263         0      2          2\n10                                                                                                                                                                                                        Conventional childr        5260         0      2          2\n11                                                                                                                                                                                                                Doors canno        5265         0      2          2\n12                                                                                                                                                                                                       Important issues liv        5246         0      2          2\n13                                                                                                                                                                                                       Important issues liv        5255         0      2          2\n...*/"
}