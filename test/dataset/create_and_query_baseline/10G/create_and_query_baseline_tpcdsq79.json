{
    "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n    and date_dim.d_year in (1999,1999+1,1999+2) \n    and store.s_number_employees between 200 and 295\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\n    where ss_customer_sk = c_customer_sk\n order by c_last_name,c_first_name,substring(s_city,1,30), profit\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY79.TPL QUERY 89 IN STREAM 0 */ /* TPC-DS QUERY79.TPL 0.89 */ SELECT C_LAST_NAME , C_FIRST_NAME , SUBSTRING ( S_CITY FROM 1 FOR 30 ) , SS_TICKET_NUMBER , AMT , PROFIT FROM ( SELECT SS_TICKET_NUMBER , SS_CUSTOMER_SK , STORE.S_CITY , SUM ( SS_COUPON_AMT ) AS AMT , SUM ( SS_NET_PROFIT ) AS PROFIT FROM STORE_SALES , DATE_DIM , STORE , HOUSEHOLD_DEMOGRAPHICS WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK AND ( HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0 OR HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 2 ) AND DATE_DIM.D_DOW = 1 AND DATE_DIM.D_YEAR IN ( 1999 , 1999 + 1 , 1999 + 2 ) AND STORE.S_NUMBER_EMPLOYEES BETWEEN 200 AND 295 GROUP BY SS_TICKET_NUMBER , SS_CUSTOMER_SK , SS_ADDR_SK , STORE.S_CITY ) AS MS , CUSTOMER WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK ORDER BY C_LAST_NAME NULLS FIRST , C_FIRST_NAME NULLS FIRST , SUBSTRING ( S_CITY FROM 1 FOR 30 ) NULLS FIRST , PROFIT NULLS FIRST LIMIT 21",
            "preview": "\n/*   c_last_name c_first_name substring  ss_ticket_number       amt    profit\n0                            Fairview             57522       NaN       NaN\n1                            Fairview           2198207       NaN       NaN\n2                            Fairview           2319087       NaN       NaN\n3                            Fairview           1698620       NaN       NaN\n4                            Fairview           1693357      0.00       NaN\n5                            Fairview            442007       NaN       NaN\n6                            Fairview            721206       NaN       NaN\n7                            Fairview           2209724   8523.05 -26023.68\n8                            Fairview           1906624  10628.76 -25909.25\n9                            Fairview            651014   2427.27 -25287.40\n10                           Fairview            281061   4949.35 -24874.06\n11                           Fairview           1090412   8231.22 -24829.64\n12                           Fairview           2184148   2658.50 -24663.93\n13                           Fairview           1148501   2961.78 -23940.19\n14                           Fairview           2368307   3787.01 -23255.19\n15                           Fairview           1171035    519.37 -22496.69\n16                           Fairview              9966   4707.65 -22119.71\n17                           Fairview            122732   8490.39 -21279.11\n18                           Fairview           1820418    611.33 -21031.21\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.159678,
                "execution_time": 0.090403,
                "compile_time": 0.000301,
                "planning_time": 0.052182
            },
            "query_metrics_warm_up": {
                "elapsed_time": 0.23177,
                "execution_time": 0.087075,
                "compile_time": 0.000294,
                "planning_time": 0.126146
            }
        }
    ],
    "preview": "\n/*   c_last_name c_first_name substring  ss_ticket_number       amt    profit\n0                            Fairview             57522       NaN       NaN\n1                            Fairview           2198207       NaN       NaN\n2                            Fairview           2319087       NaN       NaN\n3                            Fairview           1698620       NaN       NaN\n4                            Fairview           1693357      0.00       NaN\n5                            Fairview            442007       NaN       NaN\n6                            Fairview            721206       NaN       NaN\n7                            Fairview           2209724   8523.05 -26023.68\n8                            Fairview           1906624  10628.76 -25909.25\n9                            Fairview            651014   2427.27 -25287.40\n10                           Fairview            281061   4949.35 -24874.06\n11                           Fairview           1090412   8231.22 -24829.64\n12                           Fairview           2184148   2658.50 -24663.93\n13                           Fairview           1148501   2961.78 -23940.19\n14                           Fairview           2368307   3787.01 -23255.19\n15                           Fairview           1171035    519.37 -22496.69\n16                           Fairview              9966   4707.65 -22119.71\n17                           Fairview            122732   8490.39 -21279.11\n18                           Fairview           1820418    611.33 -21031.21\n...*/"
}