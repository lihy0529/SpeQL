{
    "input": "-- start template query51.tpl query 46 in stream 0\nWITH /* TPC-DS query51.tpl 0.46 */ web_v1 as (\nselect\n  ws_item_sk item_sk, d_date,\n  sum(sum(ws_sales_price))\n      over (partition by ws_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\nfrom web_sales\n    ,date_dim\nwhere ws_sold_date_sk=d_date_sk\n  and d_month_seq between 1181 and 1181+11\n  and ws_item_sk is not NULL\ngroup by ws_item_sk, d_date),\nstore_v1 as (\nselect\n  ss_item_sk item_sk, d_date,\n  sum(sum(ss_sales_price))\n      over (partition by ss_item_sk order by d_date rows between unbounded preceding and current row) cume_sales\nfrom store_sales\n    ,date_dim\nwhere ss_sold_date_sk=d_date_sk\n  and d_month_seq between 1181 and 1181+11\n  and ss_item_sk is not NULL\ngroup by ss_item_sk, d_date)\n select  *\nfrom (select item_sk\n     ,d_date\n     ,web_sales\n     ,store_sales\n     ,max(web_sales)\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) web_cumulative\n     ,max(store_sales)\n         over (partition by item_sk order by d_date rows between unbounded preceding and current row) store_cumulative\n     from (select case when web.item_sk is not null then web.item_sk else store.item_sk end item_sk\n                 ,case when web.d_date is not null then web.d_date else store.d_date end d_date\n                 ,web.cume_sales web_sales\n                 ,store.cume_sales store_sales\n           from web_v1 web full outer join store_v1 store on (web.item_sk = store.item_sk\n                                                          and web.d_date = store.d_date)\n          )x )y\nwhere web_cumulative > store_cumulative\norder by item_sk\n        ,d_date\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY51.TPL QUERY 46 IN STREAM 0 */ /* TPC-DS QUERY51.TPL 0.46 */ WITH WEB_V1 AS ( SELECT WS_ITEM_SK AS ITEM_SK , D_DATE , SUM ( SUM ( WS_SALES_PRICE ) ) OVER ( PARTITION BY WS_ITEM_SK ORDER BY D_DATE NULLS FIRST ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW ) AS CUME_SALES FROM WEB_SALES , DATE_DIM WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_MONTH_SEQ BETWEEN 1181 AND 1181 + 11 AND NOT WS_ITEM_SK IS NULL GROUP BY WS_ITEM_SK , D_DATE ) , STORE_V1 AS ( SELECT SS_ITEM_SK AS ITEM_SK , D_DATE , SUM ( SUM ( SS_SALES_PRICE ) ) OVER ( PARTITION BY SS_ITEM_SK ORDER BY D_DATE NULLS FIRST ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW ) AS CUME_SALES FROM STORE_SALES , DATE_DIM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_MONTH_SEQ BETWEEN 1181 AND 1181 + 11 AND NOT SS_ITEM_SK IS NULL GROUP BY SS_ITEM_SK , D_DATE ) SELECT * FROM ( SELECT ITEM_SK , D_DATE , WEB_SALES , STORE_SALES , MAX ( WEB_SALES ) OVER ( PARTITION BY ITEM_SK ORDER BY D_DATE NULLS FIRST ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW ) AS WEB_CUMULATIVE , MAX ( STORE_SALES ) OVER ( PARTITION BY ITEM_SK ORDER BY D_DATE NULLS FIRST ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW ) AS STORE_CUMULATIVE FROM ( SELECT CASE WHEN NOT WEB.ITEM_SK IS NULL THEN WEB.ITEM_SK ELSE STORE.ITEM_SK END AS ITEM_SK , CASE WHEN NOT WEB.D_DATE IS NULL THEN WEB.D_DATE ELSE STORE.D_DATE END AS D_DATE , WEB.CUME_SALES AS WEB_SALES , STORE.CUME_SALES AS STORE_SALES FROM WEB_V1 AS WEB FULL OUTER JOIN STORE_V1 AS STORE ON ( WEB.ITEM_SK = STORE.ITEM_SK AND WEB.D_DATE = STORE.D_DATE ) ) AS X ) AS Y WHERE WEB_CUMULATIVE > STORE_CUMULATIVE ORDER BY ITEM_SK NULLS FIRST , D_DATE NULLS FIRST LIMIT 21",
            "preview": "\n/*    item_sk    d_date  web_sales  store_sales  web_cumulative  store_cumulative\n0         1  19980616      58.34          NaN           58.34             56.07\n1         1  19980618     127.15          NaN          127.15             56.07\n2         1  19980622        NaN        71.07          127.15             71.07\n3         1  19980701        NaN        79.25          127.15             79.25\n4        10  19980710     137.95          NaN          137.95            121.96\n5        10  19980711        NaN       130.20          137.95            130.20\n6        10  19980802     166.73          NaN          166.73            130.20\n7        10  19980803     182.39          NaN          182.39            130.20\n8        10  19980806     332.59          NaN          332.59            130.20\n9        10  19980808        NaN       131.38          332.59            131.38\n10       10  19980809        NaN       220.81          332.59            220.81\n11       10  19980811     364.61          NaN          364.61            220.81\n12       10  19980813        NaN       235.82          364.61            235.82\n13       10  19980817        NaN       306.59          364.61            306.59\n14       10  19980903     453.60          NaN          453.60            433.81\n15       10  19980904     521.59       500.18          521.59            500.18\n16       13  19980608      52.98          NaN           52.98             28.44\n17       13  19980618     172.24          NaN          172.24             87.49\n18       13  19980624        NaN       107.67          172.24            107.67\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.619731,
                "execution_time": 0.536939,
                "compile_time": 0.000488,
                "planning_time": 0.058767
            },
            "query_metrics_warm_up": {
                "elapsed_time": 0.655943,
                "execution_time": 0.500902,
                "compile_time": 0.00048,
                "planning_time": 0.127493
            }
        }
    ],
    "preview": "\n/*    item_sk    d_date  web_sales  store_sales  web_cumulative  store_cumulative\n0         1  19980616      58.34          NaN           58.34             56.07\n1         1  19980618     127.15          NaN          127.15             56.07\n2         1  19980622        NaN        71.07          127.15             71.07\n3         1  19980701        NaN        79.25          127.15             79.25\n4        10  19980710     137.95          NaN          137.95            121.96\n5        10  19980711        NaN       130.20          137.95            130.20\n6        10  19980802     166.73          NaN          166.73            130.20\n7        10  19980803     182.39          NaN          182.39            130.20\n8        10  19980806     332.59          NaN          332.59            130.20\n9        10  19980808        NaN       131.38          332.59            131.38\n10       10  19980809        NaN       220.81          332.59            220.81\n11       10  19980811     364.61          NaN          364.61            220.81\n12       10  19980813        NaN       235.82          364.61            235.82\n13       10  19980817        NaN       306.59          364.61            306.59\n14       10  19980903     453.60          NaN          453.60            433.81\n15       10  19980904     521.59       500.18          521.59            500.18\n16       13  19980608      52.98          NaN           52.98             28.44\n17       13  19980618     172.24          NaN          172.24             87.49\n18       13  19980624        NaN       107.67          172.24            107.67\n...*/"
}