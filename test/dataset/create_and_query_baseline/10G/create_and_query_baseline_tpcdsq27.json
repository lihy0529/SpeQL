{
    "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        group by i_item_id\n         union all\n        select NULL AS i_item_id, NULL as s_state, 1 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        ) foo\n  order by i_item_id, s_state\n limit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY27A.TPL QUERY 16 IN STREAM 0 */ /* TPC-DS QUERY27A.TPL 0.16 */ WITH RESULTS AS ( SELECT I_ITEM_ID , S_STATE , 0 AS G_STATE , SS_QUANTITY AS AGG1 , SS_LIST_PRICE AS AGG2 , SS_COUPON_AMT AS AGG3 , SS_SALES_PRICE AS AGG4 FROM STORE_SALES , CUSTOMER_DEMOGRAPHICS , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND SS_CDEMO_SK = CD_DEMO_SK AND CD_GENDER = 'F' AND CD_MARITAL_STATUS = 'S' AND CD_EDUCATION_STATUS = 'Advanced Degree' AND D_YEAR = 1999 AND S_STATE IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) ) SELECT I_ITEM_ID , S_STATE , G_STATE , AGG1 , AGG2 , AGG3 , AGG4 FROM ( SELECT I_ITEM_ID , S_STATE , 0 AS G_STATE , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 FROM RESULTS GROUP BY I_ITEM_ID , S_STATE UNION ALL SELECT I_ITEM_ID , NULL AS S_STATE , 1 AS G_STATE , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 FROM RESULTS GROUP BY I_ITEM_ID UNION ALL SELECT NULL AS I_ITEM_ID , NULL AS S_STATE , 1 AS G_STATE , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 FROM RESULTS ) AS FOO ORDER BY I_ITEM_ID NULLS FIRST , S_STATE NULLS FIRST LIMIT 21",
            "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2    agg3   agg4\n0               None    None        1    50   75.91  188.23  37.80\n1   AAAAAAAAAAABBAAA    None        1    45  137.95    0.00  34.48\n2   AAAAAAAAAAABBAAA      SD        0    45  137.95    0.00  34.48\n3   AAAAAAAAAAAGBAAA    None        1    42   74.64    0.00  34.76\n4   AAAAAAAAAAAGBAAA      SD        0    42   74.64    0.00  34.76\n5   AAAAAAAAAAANAAAA    None        1    90   58.34    0.00  11.08\n6   AAAAAAAAAAANAAAA      SD        0    90   58.34    0.00  11.08\n7   AAAAAAAAAABAAAAA    None        1    29   96.70    0.00  69.62\n8   AAAAAAAAAABAAAAA      SD        0    29   96.70    0.00  69.62\n9   AAAAAAAAAABGBAAA    None        1    78   42.31    0.00  38.50\n10  AAAAAAAAAABGBAAA      SD        0    78   42.31    0.00  38.50\n11  AAAAAAAAAABKAAAA    None        1    26   55.73  894.68  52.94\n12  AAAAAAAAAABKAAAA      SD        0    26   55.73  894.68  52.94\n13  AAAAAAAAAACDAAAA    None        1    94   71.33    0.00  49.73\n14  AAAAAAAAAACDAAAA      SD        0    94   71.33    0.00  49.73\n15  AAAAAAAAAACFAAAA    None        1    76   25.74    0.00  25.22\n16  AAAAAAAAAACFAAAA      SD        0    76   25.74    0.00  25.22\n17  AAAAAAAAAACGAAAA    None        1    63   72.57    0.00  24.67\n18  AAAAAAAAAACGAAAA      SD        0    63   72.57    0.00  24.67\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.322156,
                "execution_time": 0.163909,
                "compile_time": 0.001146,
                "planning_time": 0.113196
            },
            "query_metrics_warm_up": {
                "elapsed_time": 0.407588,
                "execution_time": 0.170864,
                "compile_time": 0.001084,
                "planning_time": 0.190969
            }
        }
    ],
    "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2    agg3   agg4\n0               None    None        1    50   75.91  188.23  37.80\n1   AAAAAAAAAAABBAAA    None        1    45  137.95    0.00  34.48\n2   AAAAAAAAAAABBAAA      SD        0    45  137.95    0.00  34.48\n3   AAAAAAAAAAAGBAAA    None        1    42   74.64    0.00  34.76\n4   AAAAAAAAAAAGBAAA      SD        0    42   74.64    0.00  34.76\n5   AAAAAAAAAAANAAAA    None        1    90   58.34    0.00  11.08\n6   AAAAAAAAAAANAAAA      SD        0    90   58.34    0.00  11.08\n7   AAAAAAAAAABAAAAA    None        1    29   96.70    0.00  69.62\n8   AAAAAAAAAABAAAAA      SD        0    29   96.70    0.00  69.62\n9   AAAAAAAAAABGBAAA    None        1    78   42.31    0.00  38.50\n10  AAAAAAAAAABGBAAA      SD        0    78   42.31    0.00  38.50\n11  AAAAAAAAAABKAAAA    None        1    26   55.73  894.68  52.94\n12  AAAAAAAAAABKAAAA      SD        0    26   55.73  894.68  52.94\n13  AAAAAAAAAACDAAAA    None        1    94   71.33    0.00  49.73\n14  AAAAAAAAAACDAAAA      SD        0    94   71.33    0.00  49.73\n15  AAAAAAAAAACFAAAA    None        1    76   25.74    0.00  25.22\n16  AAAAAAAAAACFAAAA      SD        0    76   25.74    0.00  25.22\n17  AAAAAAAAAACGAAAA    None        1    63   72.57    0.00  24.67\n18  AAAAAAAAAACGAAAA      SD        0    63   72.57    0.00  24.67\n...*/"
}