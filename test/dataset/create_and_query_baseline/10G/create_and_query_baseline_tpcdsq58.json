{
    "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n order by item_id\n         ,ss_item_rev\n limit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY58.TPL QUERY 19 IN STREAM 0 */ /* TPC-DS QUERY58.TPL 0.19 */ WITH SS_ITEMS AS ( SELECT I_ITEM_ID AS ITEM_ID , SUM ( SS_EXT_SALES_PRICE ) AS SS_ITEM_REV FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND D_DATE IN ( SELECT D_DATE FROM DATE_DIM WHERE D_WEEK_SEQ = ( SELECT D_WEEK_SEQ FROM DATE_DIM WHERE D_DATE = '1998-04-13' ) ) AND SS_SOLD_DATE_SK = D_DATE_SK GROUP BY I_ITEM_ID ) , CS_ITEMS AS ( SELECT I_ITEM_ID AS ITEM_ID , SUM ( CS_EXT_SALES_PRICE ) AS CS_ITEM_REV FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND D_DATE IN ( SELECT D_DATE FROM DATE_DIM WHERE D_WEEK_SEQ = ( SELECT D_WEEK_SEQ FROM DATE_DIM WHERE D_DATE = '1998-04-13' ) ) AND CS_SOLD_DATE_SK = D_DATE_SK GROUP BY I_ITEM_ID ) , WS_ITEMS AS ( SELECT I_ITEM_ID AS ITEM_ID , SUM ( WS_EXT_SALES_PRICE ) AS WS_ITEM_REV FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND D_DATE IN ( SELECT D_DATE FROM DATE_DIM WHERE D_WEEK_SEQ = ( SELECT D_WEEK_SEQ FROM DATE_DIM WHERE D_DATE = '1998-04-13' ) ) AND WS_SOLD_DATE_SK = D_DATE_SK GROUP BY I_ITEM_ID ) SELECT SS_ITEMS.ITEM_ID , SS_ITEM_REV , SS_ITEM_REV / ( ( SS_ITEM_REV + CS_ITEM_REV + WS_ITEM_REV ) / 3 ) * 100 AS SS_DEV , CS_ITEM_REV , CS_ITEM_REV / ( ( SS_ITEM_REV + CS_ITEM_REV + WS_ITEM_REV ) / 3 ) * 100 AS CS_DEV , WS_ITEM_REV , WS_ITEM_REV / ( ( SS_ITEM_REV + CS_ITEM_REV + WS_ITEM_REV ) / 3 ) * 100 AS WS_DEV , ( SS_ITEM_REV + CS_ITEM_REV + WS_ITEM_REV ) / 3 AS AVERAGE FROM SS_ITEMS , CS_ITEMS , WS_ITEMS WHERE SS_ITEMS.ITEM_ID = CS_ITEMS.ITEM_ID AND SS_ITEMS.ITEM_ID = WS_ITEMS.ITEM_ID AND SS_ITEM_REV BETWEEN 0.9 * CS_ITEM_REV AND 1.1 * CS_ITEM_REV AND SS_ITEM_REV BETWEEN 0.9 * WS_ITEM_REV AND 1.1 * WS_ITEM_REV AND CS_ITEM_REV BETWEEN 0.9 * SS_ITEM_REV AND 1.1 * SS_ITEM_REV AND CS_ITEM_REV BETWEEN 0.9 * WS_ITEM_REV AND 1.1 * WS_ITEM_REV AND WS_ITEM_REV BETWEEN 0.9 * SS_ITEM_REV AND 1.1 * SS_ITEM_REV AND WS_ITEM_REV BETWEEN 0.9 * CS_ITEM_REV AND 1.1 * CS_ITEM_REV ORDER BY ITEM_ID NULLS FIRST , SS_ITEM_REV NULLS FIRST LIMIT 21",
            "preview": "\n/*            item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0  AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n1  AAAAAAAAEPICAAAA       792.12   99.63       832.59  104.72       760.32   95.63    795.0100\n2  AAAAAAAAMGHCBAAA       538.93   95.41       575.68  101.91       579.96  102.67    564.8566\n3  AAAAAAAANCCHBAAA      1238.05  104.03      1200.40  100.87      1131.48   95.08   1189.9766\n4  AAAAAAAAPEGCBAAA     11704.13   98.95     12033.82  101.74     11745.74   99.30  11827.8966*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.295327,
                "execution_time": 0.125064,
                "compile_time": 0.001196,
                "planning_time": 0.162141
            },
            "query_metrics_warm_up": {
                "elapsed_time": 0.387581,
                "execution_time": 0.120385,
                "compile_time": 0.001143,
                "planning_time": 0.257818
            }
        }
    ],
    "preview": "\n/*            item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0  AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n1  AAAAAAAAEPICAAAA       792.12   99.63       832.59  104.72       760.32   95.63    795.0100\n2  AAAAAAAAMGHCBAAA       538.93   95.41       575.68  101.91       579.96  102.67    564.8566\n3  AAAAAAAANCCHBAAA      1238.05  104.03      1200.40  100.87      1131.48   95.08   1189.9766\n4  AAAAAAAAPEGCBAAA     11704.13   98.95     12033.82  101.74     11745.74   99.30  11827.8966*/"
}