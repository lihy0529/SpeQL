{
    "input": "-- start template query40.tpl query 86 in stream 0\nselect /* TPC-DS query40.tpl 0.86 */  \n   w_state\n  ,i_item_id\n  ,sum(case when (cast(d_date as date) < cast ('2001-03-21' as date)) \n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\n  ,sum(case when (cast(d_date as date) >= cast ('2001-03-21' as date)) \n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\n from\n   catalog_sales left outer join catalog_returns on\n       (cs_order_number = cr_order_number \n        and cs_item_sk = cr_item_sk)\n  ,warehouse \n  ,item\n  ,date_dim\n where\n     i_current_price between 0.99 and 1.49\n and i_item_sk          = cs_item_sk\n and cs_warehouse_sk    = w_warehouse_sk \n and cs_sold_date_sk    = d_date_sk\n and d_date between dateadd(day,-30,cast ('2001-03-21' as date))\n                and dateadd(day,30,cast ('2001-03-21' as date))\n group by\n    w_state,i_item_id\n order by w_state,i_item_id\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY40.TPL QUERY 86 IN STREAM 0 */ /* TPC-DS QUERY40.TPL 0.86 */ SELECT W_STATE , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2001-03-21' AS DATE ) ) THEN CS_SALES_PRICE - COALESCE ( CR_REFUNDED_CASH , 0 ) ELSE 0 END ) AS SALES_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2001-03-21' AS DATE ) ) THEN CS_SALES_PRICE - COALESCE ( CR_REFUNDED_CASH , 0 ) ELSE 0 END ) AS SALES_AFTER FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ORDER_NUMBER = CR_ORDER_NUMBER AND CS_ITEM_SK = CR_ITEM_SK ) , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = CS_ITEM_SK AND CS_WAREHOUSE_SK = W_WAREHOUSE_SK AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2001-03-21' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-21' AS DATE ) ) GROUP BY W_STATE , I_ITEM_ID ORDER BY W_STATE NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
            "preview": "\n/*   w_state         i_item_id  sales_before  sales_after\n0       AL  AAAAAAAAAABDAAAA         53.44         0.00\n1       AL  AAAAAAAAAACOAAAA          0.00        14.22\n2       AL  AAAAAAAAAADHAAAA         60.41         0.00\n3       AL  AAAAAAAAAAEDBAAA         53.19        23.78\n4       AL  AAAAAAAAAAEGAAAA          0.00       190.18\n5       AL  AAAAAAAAAAEGBAAA          4.75         0.00\n6       AL  AAAAAAAAAAGNAAAA          0.00       156.44\n7       AL  AAAAAAAAAAHGBAAA         61.83       168.82\n8       AL  AAAAAAAAAAIFAAAA         93.39         0.00\n9       AL  AAAAAAAAAAJKAAAA         54.68        64.58\n10      AL  AAAAAAAAAALFBAAA          3.17         0.00\n11      AL  AAAAAAAAAALHBAAA       -104.00         0.00\n12      AL  AAAAAAAAAAOFBAAA          0.00        71.53\n13      AL  AAAAAAAAAAPBBAAA          0.00       100.30\n14      AL  AAAAAAAAAAPGBAAA         44.95        10.51\n15      AL  AAAAAAAAABAABAAA          0.00       113.22\n16      AL  AAAAAAAAABAGAAAA         73.86         0.00\n17      AL  AAAAAAAAABAPAAAA          0.00        52.88\n18      AL  AAAAAAAAABBAAAAA         41.38        45.45\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.1071,
                "execution_time": 0.027729,
                "compile_time": 0.000332,
                "planning_time": 0.061051
            },
            "query_metrics_warm_up": {
                "elapsed_time": 0.30563,
                "execution_time": 0.048243,
                "compile_time": 0.104637,
                "planning_time": 0.132918
            }
        }
    ],
    "preview": "\n/*   w_state         i_item_id  sales_before  sales_after\n0       AL  AAAAAAAAAABDAAAA         53.44         0.00\n1       AL  AAAAAAAAAACOAAAA          0.00        14.22\n2       AL  AAAAAAAAAADHAAAA         60.41         0.00\n3       AL  AAAAAAAAAAEDBAAA         53.19        23.78\n4       AL  AAAAAAAAAAEGAAAA          0.00       190.18\n5       AL  AAAAAAAAAAEGBAAA          4.75         0.00\n6       AL  AAAAAAAAAAGNAAAA          0.00       156.44\n7       AL  AAAAAAAAAAHGBAAA         61.83       168.82\n8       AL  AAAAAAAAAAIFAAAA         93.39         0.00\n9       AL  AAAAAAAAAAJKAAAA         54.68        64.58\n10      AL  AAAAAAAAAALFBAAA          3.17         0.00\n11      AL  AAAAAAAAAALHBAAA       -104.00         0.00\n12      AL  AAAAAAAAAAOFBAAA          0.00        71.53\n13      AL  AAAAAAAAAAPBBAAA          0.00       100.30\n14      AL  AAAAAAAAAAPGBAAA         44.95        10.51\n15      AL  AAAAAAAAABAABAAA          0.00       113.22\n16      AL  AAAAAAAAABAGAAAA         73.86         0.00\n17      AL  AAAAAAAAABAPAAAA          0.00        52.88\n18      AL  AAAAAAAAABBAAAAA         41.38        45.45\n...*/"
}