{
    "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n    and date_dim.d_year in (1999,1999+1,1999+2) \n    and store.s_number_employees between 200 and 295\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\n    where ss_customer_sk = c_customer_sk\n order by c_last_name,c_first_name,substring(s_city,1,30), profit\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY79.TPL QUERY 89 IN STREAM 0 */ /* TPC-DS QUERY79.TPL 0.89 */ SELECT C_LAST_NAME , C_FIRST_NAME , SUBSTRING ( S_CITY FROM 1 FOR 30 ) , SS_TICKET_NUMBER , AMT , PROFIT FROM ( SELECT SS_TICKET_NUMBER , SS_CUSTOMER_SK , STORE.S_CITY , SUM ( SS_COUPON_AMT ) AS AMT , SUM ( SS_NET_PROFIT ) AS PROFIT FROM STORE_SALES , DATE_DIM , STORE , HOUSEHOLD_DEMOGRAPHICS WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK AND ( HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 0 OR HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT > 2 ) AND DATE_DIM.D_DOW = 1 AND DATE_DIM.D_YEAR IN ( 1999 , 1999 + 1 , 1999 + 2 ) AND STORE.S_NUMBER_EMPLOYEES BETWEEN 200 AND 295 GROUP BY SS_TICKET_NUMBER , SS_CUSTOMER_SK , SS_ADDR_SK , STORE.S_CITY ) AS MS , CUSTOMER WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK ORDER BY C_LAST_NAME NULLS FIRST , C_FIRST_NAME NULLS FIRST , SUBSTRING ( S_CITY FROM 1 FOR 30 ) NULLS FIRST , PROFIT NULLS FIRST LIMIT 21",
            "preview": "\n/*   c_last_name c_first_name substring  ss_ticket_number      amt    profit\n0                                              20555581      NaN       NaN\n1                                               3681245  3988.15 -25899.01\n2                                              14967548  7381.82 -22784.12\n3                                              22797904   391.38 -21455.17\n4                                              15743643  6636.76 -21451.14\n5                                              17696835  3219.38 -21165.92\n6                                              20417943   572.97 -19803.21\n7                                               1439863  7778.54 -17798.51\n8                                              18860115  2148.48 -17317.83\n9                                               5514766   624.37 -17211.37\n10                                              3220026  4522.20 -16846.21\n11                                             22755435  2931.56 -15420.54\n12                                             10271259  1961.26 -14463.57\n13                                              4936005   533.72 -14054.81\n14                                             19205573   233.73 -13526.86\n15                                             11099729  3472.33 -12959.88\n16                                             22478272  2015.50 -12695.69\n17                                              5311316  3236.58 -12381.87\n18                                              2788710   143.55 -12205.86\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.704562,
                "execution_time": 0.630896,
                "compile_time": 0.000305,
                "planning_time": 0.05605
            },
            "query_metrics_warm_up": {
                "elapsed_time": 6.708828,
                "execution_time": 0.879297,
                "compile_time": 5.677579,
                "planning_time": 0.130299
            }
        }
    ],
    "preview": "\n/*   c_last_name c_first_name substring  ss_ticket_number      amt    profit\n0                                              20555581      NaN       NaN\n1                                               3681245  3988.15 -25899.01\n2                                              14967548  7381.82 -22784.12\n3                                              22797904   391.38 -21455.17\n4                                              15743643  6636.76 -21451.14\n5                                              17696835  3219.38 -21165.92\n6                                              20417943   572.97 -19803.21\n7                                               1439863  7778.54 -17798.51\n8                                              18860115  2148.48 -17317.83\n9                                               5514766   624.37 -17211.37\n10                                              3220026  4522.20 -16846.21\n11                                             22755435  2931.56 -15420.54\n12                                             10271259  1961.26 -14463.57\n13                                              4936005   533.72 -14054.81\n14                                             19205573   233.73 -13526.86\n15                                             11099729  3472.33 -12959.88\n16                                             22478272  2015.50 -12695.69\n17                                              5311316  3236.58 -12381.87\n18                                              2788710   143.55 -12205.86\n...*/"
}