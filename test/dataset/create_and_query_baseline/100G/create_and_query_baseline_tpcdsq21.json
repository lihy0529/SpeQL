{
    "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null\n             end) between 2.0/3.0 and 3.0/2.0\n order by w_warehouse_name\n         ,i_item_id\n limit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY21.TPL QUERY 14 IN STREAM 0 */ /* TPC-DS QUERY21.TPL 0.14 */ SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN INV_AFTER / INV_BEFORE ELSE NULL END ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0 ORDER BY W_WAREHOUSE_NAME NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
            "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAAAABIBAAA        1240       1814\n1                    AAAAAAAAAACOAAAA        1102       2091\n2                    AAAAAAAAAADHAAAA        1888       2409\n3                    AAAAAAAAAADPBAAA        2596       3737\n4                    AAAAAAAAAAFBBAAA        2040       2193\n5                    AAAAAAAAAAGNAAAA        1438       1959\n6                    AAAAAAAAAAIFAAAA        1664       2856\n7                    AAAAAAAAAALAAAAA        1614       1935\n8                    AAAAAAAAAALADAAA        1860       1995\n9                    AAAAAAAAAAOHCAAA        1829       3155\n10                   AAAAAAAAABBDAAAA        2046       2426\n11                   AAAAAAAAABBNBAAA        1801       2344\n12                   AAAAAAAAABCICAAA        1496       2067\n13                   AAAAAAAAABCKAAAA        2254       2679\n14                   AAAAAAAAABDAAAAA        1673       1815\n15                   AAAAAAAAABDHAAAA        3070       3340\n16                   AAAAAAAAABGBCAAA        1052       1580\n17                   AAAAAAAAABGNAAAA        1405       2751\n18                   AAAAAAAAABMECAAA        2335       2712\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.195017,
                "execution_time": 0.096298,
                "compile_time": 0.000281,
                "planning_time": 0.081087
            },
            "query_metrics_warm_up": {
                "elapsed_time": 5.642848,
                "execution_time": 5.563454,
                "compile_time": 0.000325,
                "planning_time": 0.059577
            }
        }
    ],
    "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAAAABIBAAA        1240       1814\n1                    AAAAAAAAAACOAAAA        1102       2091\n2                    AAAAAAAAAADHAAAA        1888       2409\n3                    AAAAAAAAAADPBAAA        2596       3737\n4                    AAAAAAAAAAFBBAAA        2040       2193\n5                    AAAAAAAAAAGNAAAA        1438       1959\n6                    AAAAAAAAAAIFAAAA        1664       2856\n7                    AAAAAAAAAALAAAAA        1614       1935\n8                    AAAAAAAAAALADAAA        1860       1995\n9                    AAAAAAAAAAOHCAAA        1829       3155\n10                   AAAAAAAAABBDAAAA        2046       2426\n11                   AAAAAAAAABBNBAAA        1801       2344\n12                   AAAAAAAAABCICAAA        1496       2067\n13                   AAAAAAAAABCKAAAA        2254       2679\n14                   AAAAAAAAABDAAAAA        1673       1815\n15                   AAAAAAAAABDHAAAA        3070       3340\n16                   AAAAAAAAABGBCAAA        1052       1580\n17                   AAAAAAAAABGNAAAA        1405       2751\n18                   AAAAAAAAABMECAAA        2335       2712\n...*/"
}