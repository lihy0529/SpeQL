{
    "input": "-- start template query22a.tpl query 55 in stream 0\nwith /* TPC-DS query22a.tpl 0.55 */ results as \n(select  i_product_name\n             ,i_brand\n             ,i_class\n             ,i_category\n             ,avg(inv_quantity_on_hand) qoh\n       from inventory\n           ,date_dim\n           ,item\n--         ,warehouse\n       where  inv_date_sk=d_date_sk\n              and inv_item_sk=i_item_sk\n--            and inv_warehouse_sk = w_warehouse_sk\n              and d_month_seq between 1183 and 1183 + 11\n       group by i_product_name,i_brand,i_class,i_category),\nresults_rollup as \n(select i_product_name, i_brand, i_class, i_category,avg(qoh) qoh \nfrom results \ngroup by i_product_name,i_brand,i_class,i_category\nunion all \nselect i_product_name, i_brand, i_class, null i_category,avg(qoh) qoh \nfrom results\ngroup by i_product_name,i_brand,i_class\nunion all \nselect i_product_name, i_brand, null i_class, null i_category,avg(qoh) qoh \nfrom results\ngroup by i_product_name,i_brand\nunion all \nselect i_product_name, null i_brand, null i_class, null i_category,avg(qoh)  qoh \nfrom results\ngroup by i_product_name\nunion all \nselect null i_product_name, null i_brand, null i_class, null i_category,avg(qoh) qoh \nfrom results)\n select  i_product_name, i_brand, i_class, i_category,qoh\n      from results_rollup\n      order by qoh, i_product_name, i_brand, i_class, i_category\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY22A.TPL QUERY 55 IN STREAM 0 */ /* TPC-DS QUERY22A.TPL 0.55 */ WITH RESULTS AS ( SELECT I_PRODUCT_NAME , I_BRAND , I_CLASS , I_CATEGORY , AVG ( INV_QUANTITY_ON_HAND ) AS QOH FROM INVENTORY , DATE_DIM , ITEM /* , WAREHOUSE */ WHERE INV_DATE_SK = D_DATE_SK AND INV_ITEM_SK = I_ITEM_SK AND /* AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK */ D_MONTH_SEQ BETWEEN 1183 AND 1183 + 11 GROUP BY I_PRODUCT_NAME , I_BRAND , I_CLASS , I_CATEGORY ) , RESULTS_ROLLUP AS ( SELECT I_PRODUCT_NAME , I_BRAND , I_CLASS , I_CATEGORY , AVG ( QOH ) AS QOH FROM RESULTS GROUP BY I_PRODUCT_NAME , I_BRAND , I_CLASS , I_CATEGORY UNION ALL SELECT I_PRODUCT_NAME , I_BRAND , I_CLASS , NULL AS I_CATEGORY , AVG ( QOH ) AS QOH FROM RESULTS GROUP BY I_PRODUCT_NAME , I_BRAND , I_CLASS UNION ALL SELECT I_PRODUCT_NAME , I_BRAND , NULL AS I_CLASS , NULL AS I_CATEGORY , AVG ( QOH ) AS QOH FROM RESULTS GROUP BY I_PRODUCT_NAME , I_BRAND UNION ALL SELECT I_PRODUCT_NAME , NULL AS I_BRAND , NULL AS I_CLASS , NULL AS I_CATEGORY , AVG ( QOH ) AS QOH FROM RESULTS GROUP BY I_PRODUCT_NAME UNION ALL SELECT NULL AS I_PRODUCT_NAME , NULL AS I_BRAND , NULL AS I_CLASS , NULL AS I_CATEGORY , AVG ( QOH ) AS QOH FROM RESULTS ) SELECT I_PRODUCT_NAME , I_BRAND , I_CLASS , I_CATEGORY , QOH FROM RESULTS_ROLLUP ORDER BY QOH NULLS FIRST , I_PRODUCT_NAME NULLS FIRST , I_BRAND NULLS FIRST , I_CLASS NULLS FIRST , I_CATEGORY NULLS FIRST LIMIT 21",
            "preview": "\n/*               i_product_name             i_brand     i_class i_category  qoh\n0    ableesen steingeingought                None        None       None  451\n1    ableesen steingeingought         maximaxi #3        None       None  451\n2    ableesen steingeingought         maximaxi #3     science       None  451\n3    ableesen steingeingought         maximaxi #3     science      Books  451\n4       eingeingantiantically                None        None       None  456\n5       eingeingantiantically     importoamalg #1        None       None  456\n6       eingeingantiantically     importoamalg #1  fragrances       None  456\n7       eingeingantiantically     importoamalg #1  fragrances      Women  456\n8   oughtoughtationcallyation                None        None       None  456\n9   oughtoughtationcallyation   exportiexporti #2        None       None  456\n10  oughtoughtationcallyation   exportiexporti #2    toddlers       None  456\n11  oughtoughtationcallyation   exportiexporti #2    toddlers   Children  456\n12     ableeingeingationcally                None        None       None  457\n13     ableeingeingationcally  importoedu pack #1        None       None  457\n14     ableeingeingationcally  importoedu pack #1        mens       None  457\n15     ableeingeingationcally  importoedu pack #1        mens      Shoes  457\n16         barationn stbarese                None        None       None  457\n17         barationn stbarese     amalgexporti #1        None       None  457\n18         barationn stbarese     amalgexporti #1     newborn       None  457\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 2.191189,
                "execution_time": 1.845125,
                "compile_time": 0.001092,
                "planning_time": 2.092684
            },
            "query_metrics_warm_up": {
                "elapsed_time": 6.418106,
                "execution_time": 5.997814,
                "compile_time": 0.00109,
                "planning_time": 6.317396
            }
        }
    ],
    "preview": "\n/*               i_product_name             i_brand     i_class i_category  qoh\n0    ableesen steingeingought                None        None       None  451\n1    ableesen steingeingought         maximaxi #3        None       None  451\n2    ableesen steingeingought         maximaxi #3     science       None  451\n3    ableesen steingeingought         maximaxi #3     science      Books  451\n4       eingeingantiantically                None        None       None  456\n5       eingeingantiantically     importoamalg #1        None       None  456\n6       eingeingantiantically     importoamalg #1  fragrances       None  456\n7       eingeingantiantically     importoamalg #1  fragrances      Women  456\n8   oughtoughtationcallyation                None        None       None  456\n9   oughtoughtationcallyation   exportiexporti #2        None       None  456\n10  oughtoughtationcallyation   exportiexporti #2    toddlers       None  456\n11  oughtoughtationcallyation   exportiexporti #2    toddlers   Children  456\n12     ableeingeingationcally                None        None       None  457\n13     ableeingeingationcally  importoedu pack #1        None       None  457\n14     ableeingeingationcally  importoedu pack #1        mens       None  457\n15     ableeingeingationcally  importoedu pack #1        mens      Shoes  457\n16         barationn stbarese                None        None       None  457\n17         barationn stbarese     amalgexporti #1        None       None  457\n18         barationn stbarese     amalgexporti #1     newborn       None  457\n...*/"
}