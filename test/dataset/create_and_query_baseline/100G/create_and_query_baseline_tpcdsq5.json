{
    "input": "-- start template query5a.tpl query 98 in stream 0\nwith /* TPC-DS query5a.tpl 0.98 */ ssr as\n (select s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_sold_date_sk  as date_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from store_sales\n    union all\n    select sr_store_sk as store_sk,\n           sr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns\n   ) salesreturns,\n     date_dim,\n     store\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date) \n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and store_sk = s_store_sk\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_sold_date_sk  as date_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from catalog_sales\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns\n   ) salesreturns,\n     date_dim,\n     catalog_page\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_sold_date_sk  as date_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from web_sales\n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           wr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n   ) salesreturns,\n     date_dim,\n     web_site\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and wsr_web_site_sk = web_site_sk\n group by web_site_id)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\n group by channel, id)\n select  channel, id, sales, returns, profit from ( \n  select channel, id, sales, returns, profit from results\n  union\n  select channel, null as id, sum(sales), sum(returns), sum(profit) from results group by channel\n  union\n  select null as channel, null as id, sum(sales), sum(returns), sum(profit) from results) foo\norder by channel, id\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY5A.TPL QUERY 98 IN STREAM 0 */ /* TPC-DS QUERY5A.TPL 0.98 */ WITH SSR AS ( SELECT S_STORE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT SS_STORE_SK AS STORE_SK , SS_SOLD_DATE_SK AS DATE_SK , SS_EXT_SALES_PRICE AS SALES_PRICE , SS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM STORE_SALES UNION ALL SELECT SR_STORE_SK AS STORE_SK , SR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , SR_RETURN_AMT AS RETURN_AMT , SR_NET_LOSS AS NET_LOSS FROM STORE_RETURNS ) AS SALESRETURNS , DATE_DIM , STORE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND STORE_SK = S_STORE_SK GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT CS_CATALOG_PAGE_SK AS PAGE_SK , CS_SOLD_DATE_SK AS DATE_SK , CS_EXT_SALES_PRICE AS SALES_PRICE , CS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM CATALOG_SALES UNION ALL SELECT CR_CATALOG_PAGE_SK AS PAGE_SK , CR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , CR_RETURN_AMOUNT AS RETURN_AMT , CR_NET_LOSS AS NET_LOSS FROM CATALOG_RETURNS ) AS SALESRETURNS , DATE_DIM , CATALOG_PAGE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND PAGE_SK = CP_CATALOG_PAGE_SK GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WS_SOLD_DATE_SK AS DATE_SK , WS_EXT_SALES_PRICE AS SALES_PRICE , WS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM WEB_SALES UNION ALL SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , WR_RETURN_AMT AS RETURN_AMT , WR_NET_LOSS AS NET_LOSS FROM WEB_RETURNS LEFT OUTER JOIN WEB_SALES ON ( WR_ITEM_SK = WS_ITEM_SK AND WR_ORDER_NUMBER = WS_ORDER_NUMBER ) ) AS SALESRETURNS , DATE_DIM , WEB_SITE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND WSR_WEB_SITE_SK = WEB_SITE_SK GROUP BY WEB_SITE_ID ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || S_STORE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CP_CATALOG_PAGE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM WSR ) AS X GROUP BY CHANNEL , ID ) SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM ( SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM RESULTS UNION SELECT CHANNEL , NULL AS ID , SUM ( SALES ) , SUM ( RETURNS ) , SUM ( PROFIT ) FROM RESULTS GROUP BY CHANNEL UNION SELECT NULL AS CHANNEL , NULL AS ID , SUM ( SALES ) , SUM ( RETURNS ) , SUM ( PROFIT ) FROM RESULTS ) AS FOO ORDER BY CHANNEL NULLS FIRST , ID NULLS FIRST LIMIT 21",
            "preview": "\n/*            channel                            id         sales       returns        profit\n0              None                          None  1.139377e+10  2.441517e+08 -3.117214e+09\n1   catalog channel                          None  3.931255e+09  8.139799e+07 -4.441859e+08\n2   catalog channel  catalog_pageAAAAAAAAAABAAAAA  1.035449e+07  9.137224e+04 -1.176622e+06\n3   catalog channel  catalog_pageAAAAAAAAAACAAAAA  4.973426e+06  2.096417e+04 -6.392356e+05\n4   catalog channel  catalog_pageAAAAAAAAAADAAAAA  0.000000e+00  1.442031e+04 -1.020728e+04\n5   catalog channel  catalog_pageAAAAAAAAAAEAAAAA  0.000000e+00  1.743454e+04 -8.560800e+03\n6   catalog channel  catalog_pageAAAAAAAAAAFAAAAA  0.000000e+00  6.021100e+02 -2.875200e+02\n7   catalog channel  catalog_pageAAAAAAAAABAAAAAA  0.000000e+00  3.044959e+05 -1.876899e+05\n8   catalog channel  catalog_pageAAAAAAAAABBAAAAA  1.066971e+07  6.735108e+04 -9.657929e+05\n9   catalog channel  catalog_pageAAAAAAAAABCAAAAA  5.308341e+06  2.648591e+04 -5.023632e+05\n10  catalog channel  catalog_pageAAAAAAAAABDAAAAA  0.000000e+00  2.378763e+04 -1.045046e+04\n11  catalog channel  catalog_pageAAAAAAAAABEAAAAA  0.000000e+00  4.864700e+03 -3.543160e+03\n12  catalog channel  catalog_pageAAAAAAAAABFAAAAA  0.000000e+00  4.370870e+03 -1.519240e+03\n13  catalog channel  catalog_pageAAAAAAAAACAAAAAA  0.000000e+00  3.400083e+05 -1.754601e+05\n14  catalog channel  catalog_pageAAAAAAAAACBAAAAA  1.093475e+07  7.864932e+04 -1.131547e+06\n15  catalog channel  catalog_pageAAAAAAAAACCAAAAA  5.423600e+06  3.198252e+04 -5.055619e+05\n16  catalog channel  catalog_pageAAAAAAAAACDAAAAA  0.000000e+00  2.121324e+04 -1.273482e+04\n17  catalog channel  catalog_pageAAAAAAAAACEAAAAA  0.000000e+00  1.325499e+04 -1.498940e+04\n18  catalog channel  catalog_pageAAAAAAAAACFAAAAA  0.000000e+00  1.067760e+03 -8.108700e+02\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 1.258836,
                "execution_time": 0.65526,
                "compile_time": 0.002349,
                "planning_time": 0.677824
            },
            "query_metrics_warm_up": {
                "elapsed_time": 17.579549,
                "execution_time": 16.960436,
                "compile_time": 0.002375,
                "planning_time": 8.965723
            }
        }
    ],
    "preview": "\n/*            channel                            id         sales       returns        profit\n0              None                          None  1.139377e+10  2.441517e+08 -3.117214e+09\n1   catalog channel                          None  3.931255e+09  8.139799e+07 -4.441859e+08\n2   catalog channel  catalog_pageAAAAAAAAAABAAAAA  1.035449e+07  9.137224e+04 -1.176622e+06\n3   catalog channel  catalog_pageAAAAAAAAAACAAAAA  4.973426e+06  2.096417e+04 -6.392356e+05\n4   catalog channel  catalog_pageAAAAAAAAAADAAAAA  0.000000e+00  1.442031e+04 -1.020728e+04\n5   catalog channel  catalog_pageAAAAAAAAAAEAAAAA  0.000000e+00  1.743454e+04 -8.560800e+03\n6   catalog channel  catalog_pageAAAAAAAAAAFAAAAA  0.000000e+00  6.021100e+02 -2.875200e+02\n7   catalog channel  catalog_pageAAAAAAAAABAAAAAA  0.000000e+00  3.044959e+05 -1.876899e+05\n8   catalog channel  catalog_pageAAAAAAAAABBAAAAA  1.066971e+07  6.735108e+04 -9.657929e+05\n9   catalog channel  catalog_pageAAAAAAAAABCAAAAA  5.308341e+06  2.648591e+04 -5.023632e+05\n10  catalog channel  catalog_pageAAAAAAAAABDAAAAA  0.000000e+00  2.378763e+04 -1.045046e+04\n11  catalog channel  catalog_pageAAAAAAAAABEAAAAA  0.000000e+00  4.864700e+03 -3.543160e+03\n12  catalog channel  catalog_pageAAAAAAAAABFAAAAA  0.000000e+00  4.370870e+03 -1.519240e+03\n13  catalog channel  catalog_pageAAAAAAAAACAAAAAA  0.000000e+00  3.400083e+05 -1.754601e+05\n14  catalog channel  catalog_pageAAAAAAAAACBAAAAA  1.093475e+07  7.864932e+04 -1.131547e+06\n15  catalog channel  catalog_pageAAAAAAAAACCAAAAA  5.423600e+06  3.198252e+04 -5.055619e+05\n16  catalog channel  catalog_pageAAAAAAAAACDAAAAA  0.000000e+00  2.121324e+04 -1.273482e+04\n17  catalog channel  catalog_pageAAAAAAAAACEAAAAA  0.000000e+00  1.325499e+04 -1.498940e+04\n18  catalog channel  catalog_pageAAAAAAAAACFAAAAA  0.000000e+00  1.067760e+03 -8.108700e+02\n...*/"
}