{
    "input": "-- start template query40.tpl query 86 in stream 0\nselect /* TPC-DS query40.tpl 0.86 */  \n   w_state\n  ,i_item_id\n  ,sum(case when (cast(d_date as date) < cast ('2001-03-21' as date)) \n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_before\n  ,sum(case when (cast(d_date as date) >= cast ('2001-03-21' as date)) \n \t\tthen cs_sales_price - coalesce(cr_refunded_cash,0) else 0 end) as sales_after\n from\n   catalog_sales left outer join catalog_returns on\n       (cs_order_number = cr_order_number \n        and cs_item_sk = cr_item_sk)\n  ,warehouse \n  ,item\n  ,date_dim\n where\n     i_current_price between 0.99 and 1.49\n and i_item_sk          = cs_item_sk\n and cs_warehouse_sk    = w_warehouse_sk \n and cs_sold_date_sk    = d_date_sk\n and d_date between dateadd(day,-30,cast ('2001-03-21' as date))\n                and dateadd(day,30,cast ('2001-03-21' as date))\n group by\n    w_state,i_item_id\n order by w_state,i_item_id\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY40.TPL QUERY 86 IN STREAM 0 */ /* TPC-DS QUERY40.TPL 0.86 */ SELECT W_STATE , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2001-03-21' AS DATE ) ) THEN CS_SALES_PRICE - COALESCE ( CR_REFUNDED_CASH , 0 ) ELSE 0 END ) AS SALES_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2001-03-21' AS DATE ) ) THEN CS_SALES_PRICE - COALESCE ( CR_REFUNDED_CASH , 0 ) ELSE 0 END ) AS SALES_AFTER FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ORDER_NUMBER = CR_ORDER_NUMBER AND CS_ITEM_SK = CR_ITEM_SK ) , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = CS_ITEM_SK AND CS_WAREHOUSE_SK = W_WAREHOUSE_SK AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2001-03-21' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-21' AS DATE ) ) GROUP BY W_STATE , I_ITEM_ID ORDER BY W_STATE NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
            "preview": "\n/*   w_state         i_item_id  sales_before  sales_after\n0       AL  AAAAAAAAAABDAAAA        168.64         0.00\n1       AL  AAAAAAAAAACOAAAA        125.97         3.71\n2       AL  AAAAAAAAAADHAAAA          0.00        41.17\n3       AL  AAAAAAAAAADLCAAA          0.00       125.31\n4       AL  AAAAAAAAAAEICAAA          0.00        13.34\n5       AL  AAAAAAAAAAFBBAAA          0.00        16.24\n6       AL  AAAAAAAAAAFHCAAA         37.99         0.00\n7       AL  AAAAAAAAAAGHAAAA        188.93         0.00\n8       AL  AAAAAAAAAAGNAAAA         79.53        24.08\n9       AL  AAAAAAAAAAHDAAAA          0.00        77.90\n10      AL  AAAAAAAAAAHGBAAA        156.61       108.09\n11      AL  AAAAAAAAAAHMAAAA         13.96         0.00\n12      AL  AAAAAAAAAAIFAAAA        207.64         0.00\n13      AL  AAAAAAAAAAILBAAA         11.68         0.00\n14      AL  AAAAAAAAAAKBAAAA        219.30        92.23\n15      AL  AAAAAAAAAAKCBAAA          0.00        83.53\n16      AL  AAAAAAAAAAKICAAA          0.00       216.12\n17      AL  AAAAAAAAAAKNCAAA         42.73      -245.34\n18      AL  AAAAAAAAAALFBAAA          0.00        85.26\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.135846,
                "execution_time": 0.056337,
                "compile_time": 0.000354,
                "planning_time": 0.058457
            },
            "query_metrics_warm_up": {
                "elapsed_time": 3.529525,
                "execution_time": 3.371669,
                "compile_time": 0.001592,
                "planning_time": 0.135174
            }
        }
    ],
    "preview": "\n/*   w_state         i_item_id  sales_before  sales_after\n0       AL  AAAAAAAAAABDAAAA        168.64         0.00\n1       AL  AAAAAAAAAACOAAAA        125.97         3.71\n2       AL  AAAAAAAAAADHAAAA          0.00        41.17\n3       AL  AAAAAAAAAADLCAAA          0.00       125.31\n4       AL  AAAAAAAAAAEICAAA          0.00        13.34\n5       AL  AAAAAAAAAAFBBAAA          0.00        16.24\n6       AL  AAAAAAAAAAFHCAAA         37.99         0.00\n7       AL  AAAAAAAAAAGHAAAA        188.93         0.00\n8       AL  AAAAAAAAAAGNAAAA         79.53        24.08\n9       AL  AAAAAAAAAAHDAAAA          0.00        77.90\n10      AL  AAAAAAAAAAHGBAAA        156.61       108.09\n11      AL  AAAAAAAAAAHMAAAA         13.96         0.00\n12      AL  AAAAAAAAAAIFAAAA        207.64         0.00\n13      AL  AAAAAAAAAAILBAAA         11.68         0.00\n14      AL  AAAAAAAAAAKBAAAA        219.30        92.23\n15      AL  AAAAAAAAAAKCBAAA          0.00        83.53\n16      AL  AAAAAAAAAAKICAAA          0.00       216.12\n17      AL  AAAAAAAAAAKNCAAA         42.73      -245.34\n18      AL  AAAAAAAAAALFBAAA          0.00        85.26\n...*/"
}