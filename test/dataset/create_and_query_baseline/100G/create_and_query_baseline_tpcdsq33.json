{
    "input": "-- start template query33.tpl query 22 in stream 0\nwith /* TPC-DS query33.tpl 0.22 */ ss as (\n select\n          i_manufact_id,sum(ss_ext_sales_price) total_sales\n from\n \tstore_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_manufact_id in (select\n  i_manufact_id\nfrom\n item\nwhere i_category in ('Jewelry'))\n and     ss_item_sk              = i_item_sk\n and     ss_sold_date_sk         = d_date_sk\n and     d_year                  = 2001\n and     d_moy                   = 3\n and     ss_addr_sk              = ca_address_sk\n and     ca_gmt_offset           = -5 \n group by i_manufact_id),\n cs as (\n select\n          i_manufact_id,sum(cs_ext_sales_price) total_sales\n from\n \tcatalog_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_manufact_id               in (select\n  i_manufact_id\nfrom\n item\nwhere i_category in ('Jewelry'))\n and     cs_item_sk              = i_item_sk\n and     cs_sold_date_sk         = d_date_sk\n and     d_year                  = 2001\n and     d_moy                   = 3\n and     cs_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -5 \n group by i_manufact_id),\n ws as (\n select\n          i_manufact_id,sum(ws_ext_sales_price) total_sales\n from\n \tweb_sales,\n \tdate_dim,\n         customer_address,\n         item\n where\n         i_manufact_id               in (select\n  i_manufact_id\nfrom\n item\nwhere i_category in ('Jewelry'))\n and     ws_item_sk              = i_item_sk\n and     ws_sold_date_sk         = d_date_sk\n and     d_year                  = 2001\n and     d_moy                   = 3\n and     ws_bill_addr_sk         = ca_address_sk\n and     ca_gmt_offset           = -5\n group by i_manufact_id)\n  select  i_manufact_id ,sum(total_sales) total_sales\n from  (select * from ss \n        union all\n        select * from cs \n        union all\n        select * from ws) tmp1\n group by i_manufact_id\n order by total_sales\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY33.TPL QUERY 22 IN STREAM 0 */ /* TPC-DS QUERY33.TPL 0.22 */ WITH SS AS ( SELECT I_MANUFACT_ID , SUM ( SS_EXT_SALES_PRICE ) AS TOTAL_SALES FROM STORE_SALES , DATE_DIM , CUSTOMER_ADDRESS , ITEM WHERE I_MANUFACT_ID IN ( SELECT I_MANUFACT_ID FROM ITEM WHERE I_CATEGORY IN ( 'Jewelry' ) ) AND SS_ITEM_SK = I_ITEM_SK AND SS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 2001 AND D_MOY = 3 AND SS_ADDR_SK = CA_ADDRESS_SK AND CA_GMT_OFFSET = -5 GROUP BY I_MANUFACT_ID ) , CS AS ( SELECT I_MANUFACT_ID , SUM ( CS_EXT_SALES_PRICE ) AS TOTAL_SALES FROM CATALOG_SALES , DATE_DIM , CUSTOMER_ADDRESS , ITEM WHERE I_MANUFACT_ID IN ( SELECT I_MANUFACT_ID FROM ITEM WHERE I_CATEGORY IN ( 'Jewelry' ) ) AND CS_ITEM_SK = I_ITEM_SK AND CS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 2001 AND D_MOY = 3 AND CS_BILL_ADDR_SK = CA_ADDRESS_SK AND CA_GMT_OFFSET = -5 GROUP BY I_MANUFACT_ID ) , WS AS ( SELECT I_MANUFACT_ID , SUM ( WS_EXT_SALES_PRICE ) AS TOTAL_SALES FROM WEB_SALES , DATE_DIM , CUSTOMER_ADDRESS , ITEM WHERE I_MANUFACT_ID IN ( SELECT I_MANUFACT_ID FROM ITEM WHERE I_CATEGORY IN ( 'Jewelry' ) ) AND WS_ITEM_SK = I_ITEM_SK AND WS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR = 2001 AND D_MOY = 3 AND WS_BILL_ADDR_SK = CA_ADDRESS_SK AND CA_GMT_OFFSET = -5 GROUP BY I_MANUFACT_ID ) SELECT I_MANUFACT_ID , SUM ( TOTAL_SALES ) AS TOTAL_SALES FROM ( SELECT * FROM SS UNION ALL SELECT * FROM CS UNION ALL SELECT * FROM WS ) AS TMP1 GROUP BY I_MANUFACT_ID ORDER BY TOTAL_SALES NULLS FIRST LIMIT 21",
            "preview": "\n/*    i_manufact_id  total_sales\n0             701    540136.96\n1             901    625263.90\n2             806    653750.18\n3             971    670874.24\n4             943    680776.14\n5             680    681121.06\n6             789    682117.92\n7             950    687832.37\n8             998    697432.66\n9             888    698448.36\n10            678    700949.45\n11            831    704792.06\n12            983    708670.79\n13            773    710257.91\n14            927    713253.42\n15            960    716686.06\n16            685    738681.75\n17            848    741455.45\n18            837    771538.02\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.387576,
                "execution_time": 0.206498,
                "compile_time": 0.001268,
                "planning_time": 0.175153
            },
            "query_metrics_warm_up": {
                "elapsed_time": 7.446241,
                "execution_time": 2.774947,
                "compile_time": 4.389051,
                "planning_time": 0.273346
            }
        }
    ],
    "preview": "\n/*    i_manufact_id  total_sales\n0             701    540136.96\n1             901    625263.90\n2             806    653750.18\n3             971    670874.24\n4             943    680776.14\n5             680    681121.06\n6             789    682117.92\n7             950    687832.37\n8             998    697432.66\n9             888    698448.36\n10            678    700949.45\n11            831    704792.06\n12            983    708670.79\n13            773    710257.91\n14            927    713253.42\n15            960    716686.06\n16            685    738681.75\n17            848    741455.45\n18            837    771538.02\n...*/"
}