{
    "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        group by i_item_id\n         union all\n        select NULL AS i_item_id, NULL as s_state, 1 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        ) foo\n  order by i_item_id, s_state\n limit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY27A.TPL QUERY 16 IN STREAM 0 */ /* TPC-DS QUERY27A.TPL 0.16 */ WITH RESULTS AS ( SELECT I_ITEM_ID , S_STATE , 0 AS G_STATE , SS_QUANTITY AS AGG1 , SS_LIST_PRICE AS AGG2 , SS_COUPON_AMT AS AGG3 , SS_SALES_PRICE AS AGG4 FROM STORE_SALES , CUSTOMER_DEMOGRAPHICS , DATE_DIM , STORE , ITEM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_STORE_SK = S_STORE_SK AND SS_CDEMO_SK = CD_DEMO_SK AND CD_GENDER = 'F' AND CD_MARITAL_STATUS = 'S' AND CD_EDUCATION_STATUS = 'Advanced Degree' AND D_YEAR = 1999 AND S_STATE IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) ) SELECT I_ITEM_ID , S_STATE , G_STATE , AGG1 , AGG2 , AGG3 , AGG4 FROM ( SELECT I_ITEM_ID , S_STATE , 0 AS G_STATE , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 FROM RESULTS GROUP BY I_ITEM_ID , S_STATE UNION ALL SELECT I_ITEM_ID , NULL AS S_STATE , 1 AS G_STATE , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 FROM RESULTS GROUP BY I_ITEM_ID UNION ALL SELECT NULL AS I_ITEM_ID , NULL AS S_STATE , 1 AS G_STATE , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 FROM RESULTS ) AS FOO ORDER BY I_ITEM_ID NULLS FIRST , S_STATE NULLS FIRST LIMIT 21",
            "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0               None    None        1    50   75.84   194.77   37.94\n1   AAAAAAAAAAAABAAA    None        1    24   20.79     0.00   14.75\n2   AAAAAAAAAAAABAAA      MI        0    41   13.88     0.00    9.85\n3   AAAAAAAAAAAABAAA      SD        0     7   27.70     0.00   19.66\n4   AAAAAAAAAAAACAAA    None        1    33   51.61     0.00   28.52\n5   AAAAAAAAAAAACAAA      SD        0    33   51.61     0.00   28.52\n6   AAAAAAAAAAABAAAA    None        1    32   42.70     0.00   21.55\n7   AAAAAAAAAAABAAAA      MI        0    25   51.06     0.00   24.40\n8   AAAAAAAAAAABAAAA      SD        0    46   25.98     0.00   15.84\n9   AAAAAAAAAAABBAAA    None        1    79  128.65     0.00  118.27\n10  AAAAAAAAAAABBAAA      SD        0    79  128.65     0.00  118.27\n11  AAAAAAAAAAACAAAA    None        1    56   73.26     0.00   54.21\n12  AAAAAAAAAAACAAAA      SD        0    56   73.26     0.00   54.21\n13  AAAAAAAAAAACCAAA    None        1    57   75.31   142.59   34.22\n14  AAAAAAAAAAACCAAA      MI        0    72   78.76   285.18   46.30\n15  AAAAAAAAAAACCAAA      SD        0    43   71.87     0.00   22.14\n16  AAAAAAAAAAADBAAA    None        1    78   47.14    18.07   34.70\n17  AAAAAAAAAAADBAAA      MI        0    78   47.14    18.07   34.70\n18  AAAAAAAAAAADCAAA    None        1    32   87.93  1032.95   75.82\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.622073,
                "execution_time": 0.458677,
                "compile_time": 0.001129,
                "planning_time": 0.116483
            },
            "query_metrics_warm_up": {
                "elapsed_time": 2.947827,
                "execution_time": 2.522055,
                "compile_time": 0.175828,
                "planning_time": 0.195708
            }
        }
    ],
    "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0               None    None        1    50   75.84   194.77   37.94\n1   AAAAAAAAAAAABAAA    None        1    24   20.79     0.00   14.75\n2   AAAAAAAAAAAABAAA      MI        0    41   13.88     0.00    9.85\n3   AAAAAAAAAAAABAAA      SD        0     7   27.70     0.00   19.66\n4   AAAAAAAAAAAACAAA    None        1    33   51.61     0.00   28.52\n5   AAAAAAAAAAAACAAA      SD        0    33   51.61     0.00   28.52\n6   AAAAAAAAAAABAAAA    None        1    32   42.70     0.00   21.55\n7   AAAAAAAAAAABAAAA      MI        0    25   51.06     0.00   24.40\n8   AAAAAAAAAAABAAAA      SD        0    46   25.98     0.00   15.84\n9   AAAAAAAAAAABBAAA    None        1    79  128.65     0.00  118.27\n10  AAAAAAAAAAABBAAA      SD        0    79  128.65     0.00  118.27\n11  AAAAAAAAAAACAAAA    None        1    56   73.26     0.00   54.21\n12  AAAAAAAAAAACAAAA      SD        0    56   73.26     0.00   54.21\n13  AAAAAAAAAAACCAAA    None        1    57   75.31   142.59   34.22\n14  AAAAAAAAAAACCAAA      MI        0    72   78.76   285.18   46.30\n15  AAAAAAAAAAACCAAA      SD        0    43   71.87     0.00   22.14\n16  AAAAAAAAAAADBAAA    None        1    78   47.14    18.07   34.70\n17  AAAAAAAAAAADBAAA      MI        0    78   47.14    18.07   34.70\n18  AAAAAAAAAAADCAAA    None        1    32   87.93  1032.95   75.82\n...*/"
}