{
    "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id\n\tunion all\n\tselect NULL AS i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n ) foo\n order by ca_country, ca_state, ca_county, i_item_id\n limit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY18A.TPL QUERY 90 IN STREAM 0 */ /* TPC-DS QUERY18A.TPL 0.90 */ WITH RESULTS AS ( SELECT I_ITEM_ID , CA_COUNTRY , CA_STATE , CA_COUNTY , CAST ( CS_QUANTITY AS DECIMAL ( 12 , 2 ) ) AS AGG1 , CAST ( CS_LIST_PRICE AS DECIMAL ( 12 , 2 ) ) AS AGG2 , CAST ( CS_COUPON_AMT AS DECIMAL ( 12 , 2 ) ) AS AGG3 , CAST ( CS_SALES_PRICE AS DECIMAL ( 12 , 2 ) ) AS AGG4 , CAST ( CS_NET_PROFIT AS DECIMAL ( 12 , 2 ) ) AS AGG5 , CAST ( C_BIRTH_YEAR AS DECIMAL ( 12 , 2 ) ) AS AGG6 , CAST ( CD1.CD_DEP_COUNT AS DECIMAL ( 12 , 2 ) ) AS AGG7 FROM CATALOG_SALES , CUSTOMER_DEMOGRAPHICS AS CD1 , CUSTOMER_DEMOGRAPHICS AS CD2 , CUSTOMER , CUSTOMER_ADDRESS , DATE_DIM , ITEM WHERE CS_SOLD_DATE_SK = D_DATE_SK AND CS_ITEM_SK = I_ITEM_SK AND CS_BILL_CDEMO_SK = CD1.CD_DEMO_SK AND CS_BILL_CUSTOMER_SK = C_CUSTOMER_SK AND CD1.CD_GENDER = 'M' AND CD1.CD_EDUCATION_STATUS = 'Primary' AND C_CURRENT_CDEMO_SK = CD2.CD_DEMO_SK AND C_CURRENT_ADDR_SK = CA_ADDRESS_SK AND C_BIRTH_MONTH IN ( 9 , 5 , 1 , 2 , 3 , 8 ) AND D_YEAR = 1999 AND CA_STATE IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) SELECT I_ITEM_ID , CA_COUNTRY , CA_STATE , CA_COUNTY , AGG1 , AGG2 , AGG3 , AGG4 , AGG5 , AGG6 , AGG7 FROM ( SELECT I_ITEM_ID , CA_COUNTRY , CA_STATE , CA_COUNTY , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 , AVG ( AGG5 ) AS AGG5 , AVG ( AGG6 ) AS AGG6 , AVG ( AGG7 ) AS AGG7 FROM RESULTS GROUP BY I_ITEM_ID , CA_COUNTRY , CA_STATE , CA_COUNTY UNION ALL SELECT I_ITEM_ID , CA_COUNTRY , CA_STATE , NULL AS COUNTY , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 , AVG ( AGG5 ) AS AGG5 , AVG ( AGG6 ) AS AGG6 , AVG ( AGG7 ) AS AGG7 FROM RESULTS GROUP BY I_ITEM_ID , CA_COUNTRY , CA_STATE UNION ALL SELECT I_ITEM_ID , CA_COUNTRY , NULL AS CA_STATE , NULL AS COUNTY , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 , AVG ( AGG5 ) AS AGG5 , AVG ( AGG6 ) AS AGG6 , AVG ( AGG7 ) AS AGG7 FROM RESULTS GROUP BY I_ITEM_ID , CA_COUNTRY UNION ALL SELECT I_ITEM_ID , NULL AS CA_COUNTRY , NULL AS CA_STATE , NULL AS COUNTY , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 , AVG ( AGG5 ) AS AGG5 , AVG ( AGG6 ) AS AGG6 , AVG ( AGG7 ) AS AGG7 FROM RESULTS GROUP BY I_ITEM_ID UNION ALL SELECT NULL AS I_ITEM_ID , NULL AS CA_COUNTRY , NULL AS CA_STATE , NULL AS COUNTY , AVG ( AGG1 ) AS AGG1 , AVG ( AGG2 ) AS AGG2 , AVG ( AGG3 ) AS AGG3 , AVG ( AGG4 ) AS AGG4 , AVG ( AGG5 ) AS AGG5 , AVG ( AGG6 ) AS AGG6 , AVG ( AGG7 ) AS AGG7 FROM RESULTS ) AS FOO ORDER BY CA_COUNTRY NULLS FIRST , CA_STATE NULLS FIRST , CA_COUNTY NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
            "preview": "\n/*           i_item_id ca_country ca_state ca_county   agg1    agg2     agg3   agg4     agg5     agg6  agg7\n0               None       None     None      None  50.34  100.96   254.20  50.47  -247.36  1957.91  3.01\n1   AAAAAAAAAAAABAAA       None     None      None  21.00  126.19   541.11  70.89 -1234.95  1944.50  4.00\n2   AAAAAAAAAAAACAAA       None     None      None  28.00  150.09     0.00  78.04   715.68  1955.00  3.00\n3   AAAAAAAAAAABAAAA       None     None      None  81.50   99.85     0.00  78.74  2545.63  1958.50  1.50\n4   AAAAAAAAAAABBAAA       None     None      None  30.00  134.39     0.00  72.44 -1281.18  1966.00  4.50\n5   AAAAAAAAAAABDAAA       None     None      None  40.00    5.76     0.00   4.26    10.40  1934.00  4.00\n6   AAAAAAAAAAACAAAA       None     None      None  64.00   64.34     0.00   4.50 -2611.84  1950.00  6.00\n7   AAAAAAAAAAADBAAA       None     None      None  60.75   81.54     0.00  27.26  -869.50  1950.00  2.00\n8   AAAAAAAAAAADCAAA       None     None      None  84.50   96.35     0.00   3.62 -3314.22  1941.50  2.50\n9   AAAAAAAAAAAEAAAA       None     None      None  86.00  119.54     0.00  39.44 -1672.70  1983.00  0.00\n10  AAAAAAAAAAAEBAAA       None     None      None  56.00   51.00     0.00   7.24 -1934.58  1943.50  4.50\n11  AAAAAAAAAAAGCAAA       None     None      None  30.00  123.89   321.08  39.64  -769.28  1962.00  6.00\n12  AAAAAAAAAAAHBAAA       None     None      None  36.00   67.61     0.00  45.31   698.58  1960.50  3.00\n13  AAAAAAAAAAAIAAAA       None     None      None  58.50   98.76     0.00  73.50  -143.47  1969.00  3.50\n14  AAAAAAAAAAAICAAA       None     None      None  77.00   74.27     0.00   8.91 -1226.61  1973.00  0.00\n15  AAAAAAAAAAAJBAAA       None     None      None   9.00   62.88    95.15  10.68  -376.31  1955.00  0.00\n16  AAAAAAAAAAAKAAAA       None     None      None  47.00  119.04  2646.82  67.85 -1660.76  1976.00  5.00\n17  AAAAAAAAAAAKBAAA       None     None      None  62.50   85.60   475.35  68.60   827.19  1978.50  4.00\n18  AAAAAAAAAAALAAAA       None     None      None  55.00   75.80     0.00  27.43 -1265.39  1978.00  3.00\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 1.175232,
                "execution_time": 0.80155,
                "compile_time": 0.002891,
                "planning_time": 0.250299
            },
            "query_metrics_warm_up": {
                "elapsed_time": 44.117085,
                "execution_time": 4.902306,
                "compile_time": 38.748473,
                "planning_time": 0.328919
            }
        }
    ],
    "preview": "\n/*           i_item_id ca_country ca_state ca_county   agg1    agg2     agg3   agg4     agg5     agg6  agg7\n0               None       None     None      None  50.34  100.96   254.20  50.47  -247.36  1957.91  3.01\n1   AAAAAAAAAAAABAAA       None     None      None  21.00  126.19   541.11  70.89 -1234.95  1944.50  4.00\n2   AAAAAAAAAAAACAAA       None     None      None  28.00  150.09     0.00  78.04   715.68  1955.00  3.00\n3   AAAAAAAAAAABAAAA       None     None      None  81.50   99.85     0.00  78.74  2545.63  1958.50  1.50\n4   AAAAAAAAAAABBAAA       None     None      None  30.00  134.39     0.00  72.44 -1281.18  1966.00  4.50\n5   AAAAAAAAAAABDAAA       None     None      None  40.00    5.76     0.00   4.26    10.40  1934.00  4.00\n6   AAAAAAAAAAACAAAA       None     None      None  64.00   64.34     0.00   4.50 -2611.84  1950.00  6.00\n7   AAAAAAAAAAADBAAA       None     None      None  60.75   81.54     0.00  27.26  -869.50  1950.00  2.00\n8   AAAAAAAAAAADCAAA       None     None      None  84.50   96.35     0.00   3.62 -3314.22  1941.50  2.50\n9   AAAAAAAAAAAEAAAA       None     None      None  86.00  119.54     0.00  39.44 -1672.70  1983.00  0.00\n10  AAAAAAAAAAAEBAAA       None     None      None  56.00   51.00     0.00   7.24 -1934.58  1943.50  4.50\n11  AAAAAAAAAAAGCAAA       None     None      None  30.00  123.89   321.08  39.64  -769.28  1962.00  6.00\n12  AAAAAAAAAAAHBAAA       None     None      None  36.00   67.61     0.00  45.31   698.58  1960.50  3.00\n13  AAAAAAAAAAAIAAAA       None     None      None  58.50   98.76     0.00  73.50  -143.47  1969.00  3.50\n14  AAAAAAAAAAAICAAA       None     None      None  77.00   74.27     0.00   8.91 -1226.61  1973.00  0.00\n15  AAAAAAAAAAAJBAAA       None     None      None   9.00   62.88    95.15  10.68  -376.31  1955.00  0.00\n16  AAAAAAAAAAAKAAAA       None     None      None  47.00  119.04  2646.82  67.85 -1660.76  1976.00  5.00\n17  AAAAAAAAAAAKBAAA       None     None      None  62.50   85.60   475.35  68.60   827.19  1978.50  4.00\n18  AAAAAAAAAAALAAAA       None     None      None  55.00   75.80     0.00  27.43 -1265.39  1978.00  3.00\n...*/"
}