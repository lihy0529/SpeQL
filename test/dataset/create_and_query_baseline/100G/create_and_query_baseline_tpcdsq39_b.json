{
    "input": "\nwith /* TPC-DS query39.tpl 0.5 part2 */ inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2001\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\n  and inv1.d_moy=1\n  and inv2.d_moy=1+1\n  and inv1.cov > 1.5\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n        ,inv2.d_moy,inv2.mean, inv2.cov\nlimit 100",
    "query": [
        {
            "query": "/* TPC-DS QUERY39.TPL 0.5 PART2 */ WITH INV AS ( SELECT W_WAREHOUSE_NAME , W_WAREHOUSE_SK , I_ITEM_SK , D_MOY , STDEV , MEAN , CASE MEAN WHEN 0 THEN NULL ELSE STDEV / MEAN END AS COV FROM ( SELECT W_WAREHOUSE_NAME , W_WAREHOUSE_SK , I_ITEM_SK , D_MOY , STDDEV_SAMP ( INV_QUANTITY_ON_HAND ) AS STDEV , AVG ( INV_QUANTITY_ON_HAND ) AS MEAN FROM INVENTORY , ITEM , WAREHOUSE , DATE_DIM WHERE INV_ITEM_SK = I_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_YEAR = 2001 GROUP BY W_WAREHOUSE_NAME , W_WAREHOUSE_SK , I_ITEM_SK , D_MOY ) AS FOO WHERE CASE MEAN WHEN 0 THEN 0 ELSE STDEV / MEAN END > 1 ) SELECT INV1.W_WAREHOUSE_SK , INV1.I_ITEM_SK , INV1.D_MOY , INV1.MEAN , INV1.COV , INV2.W_WAREHOUSE_SK , INV2.I_ITEM_SK , INV2.D_MOY , INV2.MEAN , INV2.COV FROM INV AS INV1 , INV AS INV2 WHERE INV1.I_ITEM_SK = INV2.I_ITEM_SK AND INV1.W_WAREHOUSE_SK = INV2.W_WAREHOUSE_SK AND INV1.D_MOY = 1 AND INV2.D_MOY = 1 + 1 AND INV1.COV > 1.5 ORDER BY INV1.W_WAREHOUSE_SK NULLS FIRST , INV1.I_ITEM_SK NULLS FIRST , INV1.D_MOY NULLS FIRST , INV1.MEAN NULLS FIRST , INV1.COV NULLS FIRST , INV2.D_MOY NULLS FIRST , INV2.MEAN NULLS FIRST , INV2.COV NULLS FIRST LIMIT 21",
            "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk  i_item_sk  d_moy  mean       cov\n0                1      50045      1   268  1.570609               1      50045      2   272  1.004968\n1                1      62797      1   243  1.506902               1      62797      2   390  1.045489\n2                1      63029      1   139  1.567304               1      63029      2   396  1.054553\n3                1      75589      1   268  1.701818               1      75589      2   318  1.047934\n4                1      95483      1   272  1.534057               1      95483      2   241  1.005948\n5                1      99191      1   275  1.581249               1      99191      2   352  1.023386\n6                1     109477      1   261  1.586674               1     109477      2   389  1.096491\n7                1     110593      1   305  1.511672               1     110593      2   390  1.057750\n8                1     114471      1   267  1.508656               1     114471      2   345  1.065969\n9                1     117219      1   177  1.556840               1     117219      2   196  1.053341\n10               1     134311      1   275  1.558613               1     134311      2   347  1.039259\n11               1     143359      1   247  1.797086               1     143359      2   431  1.041194\n12               1     158891      1   218  1.537911               1     158891      2   243  1.069170\n13               1     160561      1   230  1.531395               1     160561      2   451  1.054529\n14               1     186045      1   316  1.661770               1     186045      2   369  1.024119\n15               1     190837      1   222  1.512711               1     190837      2   350  1.208531\n16               1     196881      1   263  1.511921               1     196881      2   337  1.009566\n17               2      15007      1   332  1.635537               2      15007      2   367  1.052125\n18               2      19479      1   284  1.548312               2      19479      2   246  1.608760\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 1.122861,
                "execution_time": 1.01182,
                "compile_time": 0.000637,
                "planning_time": 0.076446
            },
            "query_metrics_warm_up": {
                "elapsed_time": 1.313993,
                "execution_time": 1.00268,
                "compile_time": 0.128242,
                "planning_time": 0.148624
            }
        }
    ],
    "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk  i_item_sk  d_moy  mean       cov\n0                1      50045      1   268  1.570609               1      50045      2   272  1.004968\n1                1      62797      1   243  1.506902               1      62797      2   390  1.045489\n2                1      63029      1   139  1.567304               1      63029      2   396  1.054553\n3                1      75589      1   268  1.701818               1      75589      2   318  1.047934\n4                1      95483      1   272  1.534057               1      95483      2   241  1.005948\n5                1      99191      1   275  1.581249               1      99191      2   352  1.023386\n6                1     109477      1   261  1.586674               1     109477      2   389  1.096491\n7                1     110593      1   305  1.511672               1     110593      2   390  1.057750\n8                1     114471      1   267  1.508656               1     114471      2   345  1.065969\n9                1     117219      1   177  1.556840               1     117219      2   196  1.053341\n10               1     134311      1   275  1.558613               1     134311      2   347  1.039259\n11               1     143359      1   247  1.797086               1     143359      2   431  1.041194\n12               1     158891      1   218  1.537911               1     158891      2   243  1.069170\n13               1     160561      1   230  1.531395               1     160561      2   451  1.054529\n14               1     186045      1   316  1.661770               1     186045      2   369  1.024119\n15               1     190837      1   222  1.512711               1     190837      2   350  1.208531\n16               1     196881      1   263  1.511921               1     196881      2   337  1.009566\n17               2      15007      1   332  1.635537               2      15007      2   367  1.052125\n18               2      19479      1   284  1.548312               2      19479      2   246  1.608760\n...*/"
}