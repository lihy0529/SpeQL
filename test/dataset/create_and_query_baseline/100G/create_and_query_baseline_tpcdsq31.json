{
    "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n order by web_q1_q2_increase\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY31.TPL QUERY 50 IN STREAM 0 */ /* TPC-DS QUERY31.TPL 0.50 */ WITH SS AS ( SELECT CA_COUNTY , D_QOY , D_YEAR , SUM ( SS_EXT_SALES_PRICE ) AS STORE_SALES FROM STORE_SALES , DATE_DIM , CUSTOMER_ADDRESS WHERE SS_SOLD_DATE_SK = D_DATE_SK AND SS_ADDR_SK = CA_ADDRESS_SK GROUP BY CA_COUNTY , D_QOY , D_YEAR ) , WS AS ( SELECT CA_COUNTY , D_QOY , D_YEAR , SUM ( WS_EXT_SALES_PRICE ) AS WEB_SALES FROM WEB_SALES , DATE_DIM , CUSTOMER_ADDRESS WHERE WS_SOLD_DATE_SK = D_DATE_SK AND WS_BILL_ADDR_SK = CA_ADDRESS_SK GROUP BY CA_COUNTY , D_QOY , D_YEAR ) SELECT SS1.CA_COUNTY , SS1.D_YEAR , WS2.WEB_SALES / WS1.WEB_SALES AS WEB_Q1_Q2_INCREASE , SS2.STORE_SALES / SS1.STORE_SALES AS STORE_Q1_Q2_INCREASE , WS3.WEB_SALES / WS2.WEB_SALES AS WEB_Q2_Q3_INCREASE , SS3.STORE_SALES / SS2.STORE_SALES AS STORE_Q2_Q3_INCREASE FROM SS AS SS1 , SS AS SS2 , SS AS SS3 , WS AS WS1 , WS AS WS2 , WS AS WS3 WHERE SS1.D_QOY = 1 AND SS1.D_YEAR = 1998 AND SS1.CA_COUNTY = SS2.CA_COUNTY AND SS2.D_QOY = 2 AND SS2.D_YEAR = 1998 AND SS2.CA_COUNTY = SS3.CA_COUNTY AND SS3.D_QOY = 3 AND SS3.D_YEAR = 1998 AND SS1.CA_COUNTY = WS1.CA_COUNTY AND WS1.D_QOY = 1 AND WS1.D_YEAR = 1998 AND WS1.CA_COUNTY = WS2.CA_COUNTY AND WS2.D_QOY = 2 AND WS2.D_YEAR = 1998 AND WS1.CA_COUNTY = WS3.CA_COUNTY AND WS3.D_QOY = 3 AND WS3.D_YEAR = 1998 AND CASE WHEN WS1.WEB_SALES > 0 THEN WS2.WEB_SALES / WS1.WEB_SALES ELSE NULL END > CASE WHEN SS1.STORE_SALES > 0 THEN SS2.STORE_SALES / SS1.STORE_SALES ELSE NULL END AND CASE WHEN WS2.WEB_SALES > 0 THEN WS3.WEB_SALES / WS2.WEB_SALES ELSE NULL END > CASE WHEN SS2.STORE_SALES > 0 THEN SS3.STORE_SALES / SS2.STORE_SALES ELSE NULL END ORDER BY WEB_Q1_Q2_INCREASE NULLS FIRST LIMIT 21",
            "preview": "\n/*                   ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0        Judith Basin County    1998              0.8239                0.8143              2.0735                1.8695\n1            Barnwell County    1998              0.8587                0.8412              2.0388                1.9937\n2      West Feliciana Parish    1998              0.8719                0.8414              2.2849                1.8979\n3        Rappahannock County    1998              0.8764                0.8756              2.2304                1.8380\n4            Sandoval County    1998              0.8775                0.8524              2.0501                2.0048\n5            Burleigh County    1998              0.8783                0.8668              2.2698                1.9636\n6             Amherst County    1998              0.8818                0.8606              1.9185                1.8498\n7               Troup County    1998              0.8932                0.8110              2.0582                1.9360\n8          Rensselaer County    1998              0.8989                0.8459              2.5948                2.1620\n9   Northwest Arctic Borough    1998              0.9041                0.8828              2.0438                1.8802\n10              Anson County    1998              0.9114                0.9055              2.3051                2.0271\n11               Maui County    1998              0.9209                0.9125              2.0039                1.8472\n12            Haywood County    1998              0.9211                0.9125              2.3465                1.9611\n13             Person County    1998              0.9237                0.9143              2.4127                1.9821\n14             Sawyer County    1998              0.9257                0.8605              2.3551                1.9929\n15              Casey County    1998              0.9305                0.9299              2.0736                1.8056\n16           Callaway County    1998              0.9330                0.9312              1.9771                1.7246\n17          El Dorado County    1998              0.9344                0.9011              1.9603                1.9588\n18           Nicollet County    1998              0.9437                0.9315              2.3327                2.0250\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.83446,
                "execution_time": 0.640722,
                "compile_time": 0.001453,
                "planning_time": 0.129073
            },
            "query_metrics_warm_up": {
                "elapsed_time": 6.991757,
                "execution_time": 3.111792,
                "compile_time": 3.600096,
                "planning_time": 0.210355
            }
        }
    ],
    "preview": "\n/*                   ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0        Judith Basin County    1998              0.8239                0.8143              2.0735                1.8695\n1            Barnwell County    1998              0.8587                0.8412              2.0388                1.9937\n2      West Feliciana Parish    1998              0.8719                0.8414              2.2849                1.8979\n3        Rappahannock County    1998              0.8764                0.8756              2.2304                1.8380\n4            Sandoval County    1998              0.8775                0.8524              2.0501                2.0048\n5            Burleigh County    1998              0.8783                0.8668              2.2698                1.9636\n6             Amherst County    1998              0.8818                0.8606              1.9185                1.8498\n7               Troup County    1998              0.8932                0.8110              2.0582                1.9360\n8          Rensselaer County    1998              0.8989                0.8459              2.5948                2.1620\n9   Northwest Arctic Borough    1998              0.9041                0.8828              2.0438                1.8802\n10              Anson County    1998              0.9114                0.9055              2.3051                2.0271\n11               Maui County    1998              0.9209                0.9125              2.0039                1.8472\n12            Haywood County    1998              0.9211                0.9125              2.3465                1.9611\n13             Person County    1998              0.9237                0.9143              2.4127                1.9821\n14             Sawyer County    1998              0.9257                0.8605              2.3551                1.9929\n15              Casey County    1998              0.9305                0.9299              2.0736                1.8056\n16           Callaway County    1998              0.9330                0.9312              1.9771                1.7246\n17          El Dorado County    1998              0.9344                0.9011              1.9603                1.9588\n18           Nicollet County    1998              0.9437                0.9315              2.3327                2.0250\n...*/"
}