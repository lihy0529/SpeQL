{
    "input": "-- start template query46.tpl query 23 in stream 0\nselect /* TPC-DS query46.tpl 0.23 */  c_last_name\n       ,c_first_name\n       ,ca_city\n       ,bought_city\n       ,ss_ticket_number\n       ,amt,profit \n from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,ca_city bought_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics,customer_address \n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_addr_sk = customer_address.ca_address_sk\n    and (household_demographics.hd_dep_count = 9 or\n         household_demographics.hd_vehicle_count= 1)\n    and date_dim.d_dow in (6,0)\n    and date_dim.d_year in (1998,1998+1,1998+2) \n    and store.s_city in ('New Hope','Hamilton','Georgetown','Hillcrest','Walnut Grove') \n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,ca_city) dn,customer,customer_address current_addr\n    where ss_customer_sk = c_customer_sk\n      and customer.c_current_addr_sk = current_addr.ca_address_sk\n      and current_addr.ca_city <> bought_city\n  order by c_last_name\n          ,c_first_name\n          ,ca_city\n          ,bought_city\n          ,ss_ticket_number\n  limit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY46.TPL QUERY 23 IN STREAM 0 */ /* TPC-DS QUERY46.TPL 0.23 */ SELECT C_LAST_NAME , C_FIRST_NAME , CA_CITY , BOUGHT_CITY , SS_TICKET_NUMBER , AMT , PROFIT FROM ( SELECT SS_TICKET_NUMBER , SS_CUSTOMER_SK , CA_CITY AS BOUGHT_CITY , SUM ( SS_COUPON_AMT ) AS AMT , SUM ( SS_NET_PROFIT ) AS PROFIT FROM STORE_SALES , DATE_DIM , STORE , HOUSEHOLD_DEMOGRAPHICS , CUSTOMER_ADDRESS WHERE STORE_SALES.SS_SOLD_DATE_SK = DATE_DIM.D_DATE_SK AND STORE_SALES.SS_STORE_SK = STORE.S_STORE_SK AND STORE_SALES.SS_HDEMO_SK = HOUSEHOLD_DEMOGRAPHICS.HD_DEMO_SK AND STORE_SALES.SS_ADDR_SK = CUSTOMER_ADDRESS.CA_ADDRESS_SK AND ( HOUSEHOLD_DEMOGRAPHICS.HD_DEP_COUNT = 9 OR HOUSEHOLD_DEMOGRAPHICS.HD_VEHICLE_COUNT = 1 ) AND DATE_DIM.D_DOW IN ( 6 , 0 ) AND DATE_DIM.D_YEAR IN ( 1998 , 1998 + 1 , 1998 + 2 ) AND STORE.S_CITY IN ( 'New Hope' , 'Hamilton' , 'Georgetown' , 'Hillcrest' , 'Walnut Grove' ) GROUP BY SS_TICKET_NUMBER , SS_CUSTOMER_SK , SS_ADDR_SK , CA_CITY ) AS DN , CUSTOMER , CUSTOMER_ADDRESS AS CURRENT_ADDR WHERE SS_CUSTOMER_SK = C_CUSTOMER_SK AND CUSTOMER.C_CURRENT_ADDR_SK = CURRENT_ADDR.CA_ADDRESS_SK AND CURRENT_ADDR.CA_CITY <> BOUGHT_CITY ORDER BY C_LAST_NAME NULLS FIRST , C_FIRST_NAME NULLS FIRST , CA_CITY NULLS FIRST , BOUGHT_CITY NULLS FIRST , SS_TICKET_NUMBER NULLS FIRST LIMIT 21",
            "preview": "\n/*   c_last_name c_first_name   ca_city    bought_city  ss_ticket_number       amt    profit\n0                                            Belmont          16483426      0.00   -842.12\n1                                             Bethel          13348117    411.67   4073.79\n2                                         Bridgeport           7565328    131.19  -6941.81\n3                                        Brownsville          19588318      0.42  -3858.27\n4                                        Buena Vista          17955665    105.29 -19349.96\n5                                            Clinton          13851997   4125.88  -8375.09\n6                                         Enterprise          22590904      0.00   1344.39\n7                                         Farmington          20515498    902.82 -14481.31\n8                                         Georgetown          20066135      0.00   2673.79\n9                                      Highland Park           1058819   2134.75 -12279.52\n10                                         Hillcrest           9123704   2932.52  -9462.34\n11                                          Lakeside          20277879   1456.39 -11014.39\n12                                           Lebanon           1775735   3809.31   -395.91\n13                                           Lincoln          14735183   2544.51  -5544.83\n14                                     Mechanicsburg           7754919   1722.14  -7648.74\n15                                           Newport           2135685    364.60  -9384.58\n16                                           Newport          10876715  11286.62 -17249.02\n17                                           Newport          18086604    683.05 -12884.45\n18                                         Plainview           2727153   3418.30 -10842.20\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.749543,
                "execution_time": 0.663636,
                "compile_time": 0.000445,
                "planning_time": 0.063629
            },
            "query_metrics_warm_up": {
                "elapsed_time": 11.808558,
                "execution_time": 4.442441,
                "compile_time": 7.196272,
                "planning_time": 0.143845
            }
        }
    ],
    "preview": "\n/*   c_last_name c_first_name   ca_city    bought_city  ss_ticket_number       amt    profit\n0                                            Belmont          16483426      0.00   -842.12\n1                                             Bethel          13348117    411.67   4073.79\n2                                         Bridgeport           7565328    131.19  -6941.81\n3                                        Brownsville          19588318      0.42  -3858.27\n4                                        Buena Vista          17955665    105.29 -19349.96\n5                                            Clinton          13851997   4125.88  -8375.09\n6                                         Enterprise          22590904      0.00   1344.39\n7                                         Farmington          20515498    902.82 -14481.31\n8                                         Georgetown          20066135      0.00   2673.79\n9                                      Highland Park           1058819   2134.75 -12279.52\n10                                         Hillcrest           9123704   2932.52  -9462.34\n11                                          Lakeside          20277879   1456.39 -11014.39\n12                                           Lebanon           1775735   3809.31   -395.91\n13                                           Lincoln          14735183   2544.51  -5544.83\n14                                     Mechanicsburg           7754919   1722.14  -7648.74\n15                                           Newport           2135685    364.60  -9384.58\n16                                           Newport          10876715  11286.62 -17249.02\n17                                           Newport          18086604    683.05 -12884.45\n18                                         Plainview           2727153   3418.30 -10842.20\n...*/"
}