{
    "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + INTERVAL '30' day) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr ) x \nGROUP BY rollup (channel, id) \nORDER BY channel , \n         id \nLIMIT 100",
    "query": [
        {
            "query": "/* START QUERY 80 IN STREAM 0 USING TEMPLATE QUERY80.TPL */ WITH SSR AS ( SELECT S_STORE_ID AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + INTERVAL '30 DAY' ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + INTERVAL '30 DAY' ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + INTERVAL '30 DAY' ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WEB_SITE_ID ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS X GROUP BY ROLLUP ( CHANNEL , ID ) ORDER BY CHANNEL NULLS FIRST , ID NULLS FIRST LIMIT 21",
            "preview": "\n/*            channel                            id         sales     returns1        profit\n0              None                          None  1.274747e+09  63329373.41 -3.701121e+08\n1   catalog channel                          None  4.408600e+08  22336946.98 -5.736675e+07\n2   catalog channel  catalog_pageAAAAAAAAAAACAAAA  2.249058e+05     16673.20  1.231962e+04\n3   catalog channel  catalog_pageAAAAAAAAAABCAAAA  4.717706e+05     25237.83 -2.021201e+04\n4   catalog channel  catalog_pageAAAAAAAAAAMBAAAA  6.104274e+05     34742.09 -7.798508e+04\n5   catalog channel  catalog_pageAAAAAAAAABACAAAA  1.273724e+05      3664.62 -4.496349e+04\n6   catalog channel  catalog_pageAAAAAAAAABMBAAAA  6.046785e+05     23945.34 -1.295342e+04\n7   catalog channel  catalog_pageAAAAAAAAACACAAAA  2.047344e+05      4468.10 -6.525784e+04\n8   catalog channel  catalog_pageAAAAAAAAACMBAAAA  6.413125e+05     24605.08 -1.738087e+04\n9   catalog channel  catalog_pageAAAAAAAAADACAAAA  2.233748e+05     22726.58 -6.254625e+04\n10  catalog channel  catalog_pageAAAAAAAAADLBAAAA  1.334157e+06     62737.66 -1.539234e+05\n11  catalog channel  catalog_pageAAAAAAAAADMBAAAA  5.390374e+05     26120.81 -1.176998e+05\n12  catalog channel  catalog_pageAAAAAAAAAEACAAAA  1.641498e+05      9462.64 -3.620949e+04\n13  catalog channel  catalog_pageAAAAAAAAAELBAAAA  1.224671e+06     51610.38 -1.369808e+05\n14  catalog channel  catalog_pageAAAAAAAAAEMBAAAA  6.517636e+05     31659.12 -1.595500e+03\n15  catalog channel  catalog_pageAAAAAAAAAFACAAAA  2.895669e+05     14566.65 -4.293003e+04\n16  catalog channel  catalog_pageAAAAAAAAAFLBAAAA  1.186282e+06     75872.93 -1.496598e+05\n17  catalog channel  catalog_pageAAAAAAAAAFMBAAAA  6.239855e+05     46220.03 -5.341498e+04\n18  catalog channel  catalog_pageAAAAAAAAAGACAAAA  4.270055e+05     10357.47 -3.671661e+04\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.395672,
                "execution_time": 0.182788,
                "compile_time": 0.001125,
                "planning_time": 0.163475
            },
            "query_metrics_warm_up": {
                "elapsed_time": 2.88501,
                "execution_time": 2.548529,
                "compile_time": 0.001139,
                "planning_time": 0.282913
            }
        }
    ],
    "preview": "\n/*            channel                            id         sales     returns1        profit\n0              None                          None  1.274747e+09  63329373.41 -3.701121e+08\n1   catalog channel                          None  4.408600e+08  22336946.98 -5.736675e+07\n2   catalog channel  catalog_pageAAAAAAAAAAACAAAA  2.249058e+05     16673.20  1.231962e+04\n3   catalog channel  catalog_pageAAAAAAAAAABCAAAA  4.717706e+05     25237.83 -2.021201e+04\n4   catalog channel  catalog_pageAAAAAAAAAAMBAAAA  6.104274e+05     34742.09 -7.798508e+04\n5   catalog channel  catalog_pageAAAAAAAAABACAAAA  1.273724e+05      3664.62 -4.496349e+04\n6   catalog channel  catalog_pageAAAAAAAAABMBAAAA  6.046785e+05     23945.34 -1.295342e+04\n7   catalog channel  catalog_pageAAAAAAAAACACAAAA  2.047344e+05      4468.10 -6.525784e+04\n8   catalog channel  catalog_pageAAAAAAAAACMBAAAA  6.413125e+05     24605.08 -1.738087e+04\n9   catalog channel  catalog_pageAAAAAAAAADACAAAA  2.233748e+05     22726.58 -6.254625e+04\n10  catalog channel  catalog_pageAAAAAAAAADLBAAAA  1.334157e+06     62737.66 -1.539234e+05\n11  catalog channel  catalog_pageAAAAAAAAADMBAAAA  5.390374e+05     26120.81 -1.176998e+05\n12  catalog channel  catalog_pageAAAAAAAAAEACAAAA  1.641498e+05      9462.64 -3.620949e+04\n13  catalog channel  catalog_pageAAAAAAAAAELBAAAA  1.224671e+06     51610.38 -1.369808e+05\n14  catalog channel  catalog_pageAAAAAAAAAEMBAAAA  6.517636e+05     31659.12 -1.595500e+03\n15  catalog channel  catalog_pageAAAAAAAAAFACAAAA  2.895669e+05     14566.65 -4.293003e+04\n16  catalog channel  catalog_pageAAAAAAAAAFLBAAAA  1.186282e+06     75872.93 -1.496598e+05\n17  catalog channel  catalog_pageAAAAAAAAAFMBAAAA  6.239855e+05     46220.03 -5.341498e+04\n18  catalog channel  catalog_pageAAAAAAAAAGACAAAA  4.270055e+05     10357.47 -3.671661e+04\n...*/"
}