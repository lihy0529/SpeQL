{
    "input": "-- start template query71.tpl query 72 in stream 0\nselect /* TPC-DS query71.tpl 0.72 */ i_brand_id brand_id, i_brand brand,t_hour,t_minute,\n \tsum(ext_price) ext_price\n from item, (select ws_ext_sales_price as ext_price, \n                        ws_sold_date_sk as sold_date_sk,\n                        ws_item_sk as sold_item_sk,\n                        ws_sold_time_sk as time_sk  \n                 from web_sales,date_dim\n                 where d_date_sk = ws_sold_date_sk\n                   and d_moy=12\n                   and d_year=2001\n                 union all\n                 select cs_ext_sales_price as ext_price,\n                        cs_sold_date_sk as sold_date_sk,\n                        cs_item_sk as sold_item_sk,\n                        cs_sold_time_sk as time_sk\n                 from catalog_sales,date_dim\n                 where d_date_sk = cs_sold_date_sk\n                   and d_moy=12\n                   and d_year=2001\n                 union all\n                 select ss_ext_sales_price as ext_price,\n                        ss_sold_date_sk as sold_date_sk,\n                        ss_item_sk as sold_item_sk,\n                        ss_sold_time_sk as time_sk\n                 from store_sales,date_dim\n                 where d_date_sk = ss_sold_date_sk\n                   and d_moy=12\n                   and d_year=2001\n                 ) tmp,time_dim\n where\n   sold_item_sk = i_item_sk\n   and i_manager_id=1\n   and time_sk = t_time_sk\n   and (t_meal_time = 'breakfast' or t_meal_time = 'dinner')\n group by i_brand, i_brand_id,t_hour,t_minute\n order by ext_price desc, i_brand_id\nlimit 100\n ",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY71.TPL QUERY 72 IN STREAM 0 */ /* TPC-DS QUERY71.TPL 0.72 */ SELECT I_BRAND_ID AS BRAND_ID , I_BRAND AS BRAND , T_HOUR , T_MINUTE , SUM ( EXT_PRICE ) AS EXT_PRICE FROM ITEM , ( SELECT WS_EXT_SALES_PRICE AS EXT_PRICE , WS_SOLD_DATE_SK AS SOLD_DATE_SK , WS_ITEM_SK AS SOLD_ITEM_SK , WS_SOLD_TIME_SK AS TIME_SK FROM WEB_SALES , DATE_DIM WHERE D_DATE_SK = WS_SOLD_DATE_SK AND D_MOY = 12 AND D_YEAR = 2001 UNION ALL SELECT CS_EXT_SALES_PRICE AS EXT_PRICE , CS_SOLD_DATE_SK AS SOLD_DATE_SK , CS_ITEM_SK AS SOLD_ITEM_SK , CS_SOLD_TIME_SK AS TIME_SK FROM CATALOG_SALES , DATE_DIM WHERE D_DATE_SK = CS_SOLD_DATE_SK AND D_MOY = 12 AND D_YEAR = 2001 UNION ALL SELECT SS_EXT_SALES_PRICE AS EXT_PRICE , SS_SOLD_DATE_SK AS SOLD_DATE_SK , SS_ITEM_SK AS SOLD_ITEM_SK , SS_SOLD_TIME_SK AS TIME_SK FROM STORE_SALES , DATE_DIM WHERE D_DATE_SK = SS_SOLD_DATE_SK AND D_MOY = 12 AND D_YEAR = 2001 ) AS TMP , TIME_DIM WHERE SOLD_ITEM_SK = I_ITEM_SK AND I_MANAGER_ID = 1 AND TIME_SK = T_TIME_SK AND ( T_MEAL_TIME = 'breakfast' OR T_MEAL_TIME = 'dinner' ) GROUP BY I_BRAND , I_BRAND_ID , T_HOUR , T_MINUTE ORDER BY EXT_PRICE DESC NULLS LAST , I_BRAND_ID NULLS FIRST LIMIT 21",
            "preview": "\n/*    brand_id                brand  t_hour  t_minute  ext_price\n0    3002002    importoexporti #2      19        16   83241.83\n1    4002002   importoedu pack #2      19        49   61993.29\n2    2004002   edu packimporto #2      19        58   61676.21\n3    4002002   importoedu pack #2      19        20   60580.81\n4    3002002    importoexporti #2      19         8   59839.36\n5    4004002  edu packedu pack #2      19        55   59502.11\n6    1001002        amalgamalg #2      17        47   56941.90\n7    1001002        amalgamalg #2      17        10   55989.09\n8    1001002        amalgamalg #2      17        42   54598.21\n9    4002002   importoedu pack #2      19        57   54150.32\n10   4004002  edu packedu pack #2       9        36   52895.54\n11   1001002        amalgamalg #2      17        35   52818.10\n12   2001002      amalgimporto #2      18        59   52593.36\n13   1001002        amalgamalg #2       8        35   52496.93\n14   4002002   importoedu pack #2      17        59   52312.45\n15   1001002        amalgamalg #2      18        28   51636.40\n16   2001002      amalgimporto #2       9        30   51313.15\n17   3002002    importoexporti #2      19        19   50799.80\n18   4002002   importoedu pack #2      19        26   50670.09\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.198027,
                "execution_time": 0.099136,
                "compile_time": 0.000518,
                "planning_time": 0.074602
            },
            "query_metrics_warm_up": {
                "elapsed_time": 2.636915,
                "execution_time": 2.445434,
                "compile_time": 0.000499,
                "planning_time": 0.166235
            }
        }
    ],
    "preview": "\n/*    brand_id                brand  t_hour  t_minute  ext_price\n0    3002002    importoexporti #2      19        16   83241.83\n1    4002002   importoedu pack #2      19        49   61993.29\n2    2004002   edu packimporto #2      19        58   61676.21\n3    4002002   importoedu pack #2      19        20   60580.81\n4    3002002    importoexporti #2      19         8   59839.36\n5    4004002  edu packedu pack #2      19        55   59502.11\n6    1001002        amalgamalg #2      17        47   56941.90\n7    1001002        amalgamalg #2      17        10   55989.09\n8    1001002        amalgamalg #2      17        42   54598.21\n9    4002002   importoedu pack #2      19        57   54150.32\n10   4004002  edu packedu pack #2       9        36   52895.54\n11   1001002        amalgamalg #2      17        35   52818.10\n12   2001002      amalgimporto #2      18        59   52593.36\n13   1001002        amalgamalg #2       8        35   52496.93\n14   4002002   importoedu pack #2      17        59   52312.45\n15   1001002        amalgamalg #2      18        28   51636.40\n16   2001002      amalgimporto #2       9        30   51313.15\n17   3002002    importoexporti #2      19        19   50799.80\n18   4002002   importoedu pack #2      19        26   50670.09\n...*/"
}