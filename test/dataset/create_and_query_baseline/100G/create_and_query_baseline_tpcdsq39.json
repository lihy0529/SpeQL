{
    "input": "-- start template query39.tpl query 5 in stream 0\nwith /* TPC-DS query39.tpl 0.5 */ inv as\n(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n       ,stdev,mean, case mean when 0 then null else stdev/mean end cov\n from(select w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy\n            ,stddev_samp(inv_quantity_on_hand) stdev,avg(inv_quantity_on_hand) mean\n      from inventory\n          ,item\n          ,warehouse\n          ,date_dim\n      where inv_item_sk = i_item_sk\n        and inv_warehouse_sk = w_warehouse_sk\n        and inv_date_sk = d_date_sk\n        and d_year =2001\n      group by w_warehouse_name,w_warehouse_sk,i_item_sk,d_moy) foo\n where case mean when 0 then 0 else stdev/mean end > 1)\nselect inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean, inv1.cov\n        ,inv2.w_warehouse_sk,inv2.i_item_sk,inv2.d_moy,inv2.mean, inv2.cov\nfrom inv inv1,inv inv2\nwhere inv1.i_item_sk = inv2.i_item_sk\n  and inv1.w_warehouse_sk =  inv2.w_warehouse_sk\n  and inv1.d_moy=1\n  and inv2.d_moy=1+1\norder by inv1.w_warehouse_sk,inv1.i_item_sk,inv1.d_moy,inv1.mean,inv1.cov\n        ,inv2.d_moy,inv2.mean, inv2.cov\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY39.TPL QUERY 5 IN STREAM 0 */ /* TPC-DS QUERY39.TPL 0.5 */ WITH INV AS ( SELECT W_WAREHOUSE_NAME , W_WAREHOUSE_SK , I_ITEM_SK , D_MOY , STDEV , MEAN , CASE MEAN WHEN 0 THEN NULL ELSE STDEV / MEAN END AS COV FROM ( SELECT W_WAREHOUSE_NAME , W_WAREHOUSE_SK , I_ITEM_SK , D_MOY , STDDEV_SAMP ( INV_QUANTITY_ON_HAND ) AS STDEV , AVG ( INV_QUANTITY_ON_HAND ) AS MEAN FROM INVENTORY , ITEM , WAREHOUSE , DATE_DIM WHERE INV_ITEM_SK = I_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_YEAR = 2001 GROUP BY W_WAREHOUSE_NAME , W_WAREHOUSE_SK , I_ITEM_SK , D_MOY ) AS FOO WHERE CASE MEAN WHEN 0 THEN 0 ELSE STDEV / MEAN END > 1 ) SELECT INV1.W_WAREHOUSE_SK , INV1.I_ITEM_SK , INV1.D_MOY , INV1.MEAN , INV1.COV , INV2.W_WAREHOUSE_SK , INV2.I_ITEM_SK , INV2.D_MOY , INV2.MEAN , INV2.COV FROM INV AS INV1 , INV AS INV2 WHERE INV1.I_ITEM_SK = INV2.I_ITEM_SK AND INV1.W_WAREHOUSE_SK = INV2.W_WAREHOUSE_SK AND INV1.D_MOY = 1 AND INV2.D_MOY = 1 + 1 ORDER BY INV1.W_WAREHOUSE_SK NULLS FIRST , INV1.I_ITEM_SK NULLS FIRST , INV1.D_MOY NULLS FIRST , INV1.MEAN NULLS FIRST , INV1.COV NULLS FIRST , INV2.D_MOY NULLS FIRST , INV2.MEAN NULLS FIRST , INV2.COV NULLS FIRST LIMIT 21",
            "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk  i_item_sk  d_moy  mean       cov\n0                1        933      1   495  1.195653               1        933      2   333  1.046126\n1                1       1315      1   309  1.253135               1       1315      2   383  1.233566\n2                1       2299      1   361  1.277382               1       2299      2   183  1.536898\n3                1       2961      1   331  1.258912               1       2961      2   373  1.025921\n4                1       3041      1   132  1.214035               1       3041      2   329  1.281221\n5                1       3293      1   355  1.191576               1       3293      2   286  1.225522\n6                1       3295      1   476  1.035751               1       3295      2   336  1.151153\n7                1       3337      1   399  1.052785               1       3337      2   144  1.002511\n8                1       4359      1   216  1.468478               1       4359      2   469  1.015178\n9                1       4483      1   348  1.122032               1       4483      2   293  1.484078\n10               1       5121      1   365  1.115528               1       5121      2   287  1.067425\n11               1       5515      1   336  1.202568               1       5515      2   384  1.060974\n12               1       5727      1   390  1.318089               1       5727      2   354  1.188890\n13               1       6189      1   300  1.276489               1       6189      2   443  1.060819\n14               1       6545      1   212  1.418316               1       6545      2   436  1.006187\n15               1       6907      1   401  1.014288               1       6907      2   262  1.350376\n16               1       7747      1   367  1.147630               1       7747      2   370  1.042820\n17               1       7969      1    92  1.259197               1       7969      2   298  1.040155\n18               1       9005      1   159  1.167329               1       9005      2   205  1.246543\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 1.027708,
                "execution_time": 0.919613,
                "compile_time": 0.000629,
                "planning_time": 0.074959
            },
            "query_metrics_warm_up": {
                "elapsed_time": 5.548915,
                "execution_time": 5.368738,
                "compile_time": 0.000632,
                "planning_time": 0.145379
            }
        }
    ],
    "preview": "\n/*    w_warehouse_sk  i_item_sk  d_moy  mean       cov  w_warehouse_sk  i_item_sk  d_moy  mean       cov\n0                1        933      1   495  1.195653               1        933      2   333  1.046126\n1                1       1315      1   309  1.253135               1       1315      2   383  1.233566\n2                1       2299      1   361  1.277382               1       2299      2   183  1.536898\n3                1       2961      1   331  1.258912               1       2961      2   373  1.025921\n4                1       3041      1   132  1.214035               1       3041      2   329  1.281221\n5                1       3293      1   355  1.191576               1       3293      2   286  1.225522\n6                1       3295      1   476  1.035751               1       3295      2   336  1.151153\n7                1       3337      1   399  1.052785               1       3337      2   144  1.002511\n8                1       4359      1   216  1.468478               1       4359      2   469  1.015178\n9                1       4483      1   348  1.122032               1       4483      2   293  1.484078\n10               1       5121      1   365  1.115528               1       5121      2   287  1.067425\n11               1       5515      1   336  1.202568               1       5515      2   384  1.060974\n12               1       5727      1   390  1.318089               1       5727      2   354  1.188890\n13               1       6189      1   300  1.276489               1       6189      2   443  1.060819\n14               1       6545      1   212  1.418316               1       6545      2   436  1.006187\n15               1       6907      1   401  1.014288               1       6907      2   262  1.350376\n16               1       7747      1   367  1.147630               1       7747      2   370  1.042820\n17               1       7969      1    92  1.259197               1       7969      2   298  1.040155\n18               1       9005      1   159  1.167329               1       9005      2   205  1.246543\n...*/"
}