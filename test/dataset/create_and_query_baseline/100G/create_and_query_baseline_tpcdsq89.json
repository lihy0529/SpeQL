{
    "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name)\n         avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n      or (i_category in ('Electronics','Women','Jewelry') and\n          i_class in ('portable','fragrances','diamonds') \n        ))\ngroup by i_category, i_class, i_brand,\n         s_store_name, s_company_name, d_moy) tmp1\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\norder by sum_sales - avg_monthly_sales, s_store_name\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY89.TPL QUERY 56 IN STREAM 0 */ /* TPC-DS QUERY89.TPL 0.56 */ SELECT * FROM ( SELECT I_CATEGORY , I_CLASS , I_BRAND , S_STORE_NAME , S_COMPANY_NAME , D_MOY , SUM ( SS_SALES_PRICE ) AS SUM_SALES , AVG ( SUM ( SS_SALES_PRICE ) ) OVER ( PARTITION BY I_CATEGORY , I_BRAND , S_STORE_NAME , S_COMPANY_NAME ) AS AVG_MONTHLY_SALES FROM ITEM , STORE_SALES , DATE_DIM , STORE WHERE SS_ITEM_SK = I_ITEM_SK AND SS_SOLD_DATE_SK = D_DATE_SK AND SS_STORE_SK = S_STORE_SK AND D_YEAR IN ( 1999 ) AND ( ( I_CATEGORY IN ( 'Shoes' , 'Men' , 'Music' ) AND I_CLASS IN ( 'kids' , 'sports-apparel' , 'classical' ) ) OR ( I_CATEGORY IN ( 'Electronics' , 'Women' , 'Jewelry' ) AND I_CLASS IN ( 'portable' , 'fragrances' , 'diamonds' ) ) ) GROUP BY I_CATEGORY , I_CLASS , I_BRAND , S_STORE_NAME , S_COMPANY_NAME , D_MOY ) AS TMP1 WHERE CASE WHEN ( AVG_MONTHLY_SALES <> 0 ) THEN ( ABS ( SUM_SALES - AVG_MONTHLY_SALES ) / AVG_MONTHLY_SALES ) ELSE NULL END > 0.1 ORDER BY SUM_SALES - AVG_MONTHLY_SALES NULLS FIRST , S_STORE_NAME NULLS FIRST LIMIT 21",
            "preview": "\n/*   i_category         i_class             i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0         Men  sports-apparel  edu packimporto #1         able        Unknown      2  203690.25          396323.84\n1         Men  sports-apparel  edu packimporto #1          bar        Unknown      2  207880.41          393627.36\n2         Men  sports-apparel  edu packimporto #1         eing        Unknown      2  209794.77          395370.62\n3       Music       classical  edu packscholar #1          bar        Unknown      2  203682.09          388055.45\n4       Music       classical  edu packscholar #1         able        Unknown      2  206488.73          389536.17\n5         Men  sports-apparel  edu packimporto #1          ese        Unknown      2  199809.74          380322.71\n6       Music       classical  edu packscholar #1         eing        Unknown      2  207608.95          387154.89\n7         Men  sports-apparel  edu packimporto #1         able        Unknown      4  217377.01          396323.84\n8       Shoes            kids  exportiedu pack #1          bar        Unknown      2  194763.31          372716.70\n9         Men  sports-apparel  edu packimporto #1         able        Unknown      3  220197.10          396323.84\n10      Music       classical  edu packscholar #1          ese        Unknown      2  197745.50          372728.29\n11        Men  sports-apparel  edu packimporto #1          bar        Unknown      6  219661.05          393627.36\n12        Men  sports-apparel  edu packimporto #1         eing        Unknown      4  221502.38          395370.62\n13      Shoes            kids  exportiedu pack #1         eing        Unknown      2  196479.71          370333.44\n14        Men  sports-apparel  edu packimporto #1          bar        Unknown      3  219782.29          393627.36\n15        Men  sports-apparel  edu packimporto #1        cally        Unknown      2  194806.67          367480.72\n16      Music       classical  edu packscholar #1         eing        Unknown      3  214651.90          387154.89\n17      Women      fragrances     importoamalg #1         eing        Unknown      2  189615.77          362094.10\n18      Shoes            kids  exportiedu pack #1         able        Unknown      2  200774.46          373237.76\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 0.392908,
                "execution_time": 0.312921,
                "compile_time": 0.000442,
                "planning_time": 0.059708
            },
            "query_metrics_warm_up": {
                "elapsed_time": 0.469113,
                "execution_time": 0.318049,
                "compile_time": 0.000443,
                "planning_time": 0.128833
            }
        }
    ],
    "preview": "\n/*   i_category         i_class             i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0         Men  sports-apparel  edu packimporto #1         able        Unknown      2  203690.25          396323.84\n1         Men  sports-apparel  edu packimporto #1          bar        Unknown      2  207880.41          393627.36\n2         Men  sports-apparel  edu packimporto #1         eing        Unknown      2  209794.77          395370.62\n3       Music       classical  edu packscholar #1          bar        Unknown      2  203682.09          388055.45\n4       Music       classical  edu packscholar #1         able        Unknown      2  206488.73          389536.17\n5         Men  sports-apparel  edu packimporto #1          ese        Unknown      2  199809.74          380322.71\n6       Music       classical  edu packscholar #1         eing        Unknown      2  207608.95          387154.89\n7         Men  sports-apparel  edu packimporto #1         able        Unknown      4  217377.01          396323.84\n8       Shoes            kids  exportiedu pack #1          bar        Unknown      2  194763.31          372716.70\n9         Men  sports-apparel  edu packimporto #1         able        Unknown      3  220197.10          396323.84\n10      Music       classical  edu packscholar #1          ese        Unknown      2  197745.50          372728.29\n11        Men  sports-apparel  edu packimporto #1          bar        Unknown      6  219661.05          393627.36\n12        Men  sports-apparel  edu packimporto #1         eing        Unknown      4  221502.38          395370.62\n13      Shoes            kids  exportiedu pack #1         eing        Unknown      2  196479.71          370333.44\n14        Men  sports-apparel  edu packimporto #1          bar        Unknown      3  219782.29          393627.36\n15        Men  sports-apparel  edu packimporto #1        cally        Unknown      2  194806.67          367480.72\n16      Music       classical  edu packscholar #1         eing        Unknown      3  214651.90          387154.89\n17      Women      fragrances     importoamalg #1         eing        Unknown      2  189615.77          362094.10\n18      Shoes            kids  exportiedu pack #1         able        Unknown      2  200774.46          373237.76\n...*/"
}