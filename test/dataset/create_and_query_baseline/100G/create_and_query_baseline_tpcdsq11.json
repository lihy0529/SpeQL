{
    "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n         and t_w_secyear.dyear = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n         ,t_s_secyear.customer_last_name\n         ,t_s_secyear.customer_email_address\nlimit 100",
    "query": [
        {
            "query": "/* START TEMPLATE QUERY11.TPL QUERY 51 IN STREAM 0 */ /* TPC-DS QUERY11.TPL 0.51 */ WITH YEAR_TOTAL AS ( SELECT C_CUSTOMER_ID AS CUSTOMER_ID , C_FIRST_NAME AS CUSTOMER_FIRST_NAME , C_LAST_NAME AS CUSTOMER_LAST_NAME , C_PREFERRED_CUST_FLAG AS CUSTOMER_PREFERRED_CUST_FLAG , C_BIRTH_COUNTRY AS CUSTOMER_BIRTH_COUNTRY , C_LOGIN AS CUSTOMER_LOGIN , C_EMAIL_ADDRESS AS CUSTOMER_EMAIL_ADDRESS , D_YEAR AS DYEAR , SUM ( SS_EXT_LIST_PRICE - SS_EXT_DISCOUNT_AMT ) AS YEAR_TOTAL , 's' AS SALE_TYPE FROM CUSTOMER , STORE_SALES , DATE_DIM WHERE C_CUSTOMER_SK = SS_CUSTOMER_SK AND SS_SOLD_DATE_SK = D_DATE_SK GROUP BY C_CUSTOMER_ID , C_FIRST_NAME , C_LAST_NAME , C_PREFERRED_CUST_FLAG , C_BIRTH_COUNTRY , C_LOGIN , C_EMAIL_ADDRESS , D_YEAR UNION ALL SELECT C_CUSTOMER_ID AS CUSTOMER_ID , C_FIRST_NAME AS CUSTOMER_FIRST_NAME , C_LAST_NAME AS CUSTOMER_LAST_NAME , C_PREFERRED_CUST_FLAG AS CUSTOMER_PREFERRED_CUST_FLAG , C_BIRTH_COUNTRY AS CUSTOMER_BIRTH_COUNTRY , C_LOGIN AS CUSTOMER_LOGIN , C_EMAIL_ADDRESS AS CUSTOMER_EMAIL_ADDRESS , D_YEAR AS DYEAR , SUM ( WS_EXT_LIST_PRICE - WS_EXT_DISCOUNT_AMT ) AS YEAR_TOTAL , 'w' AS SALE_TYPE FROM CUSTOMER , WEB_SALES , DATE_DIM WHERE C_CUSTOMER_SK = WS_BILL_CUSTOMER_SK AND WS_SOLD_DATE_SK = D_DATE_SK GROUP BY C_CUSTOMER_ID , C_FIRST_NAME , C_LAST_NAME , C_PREFERRED_CUST_FLAG , C_BIRTH_COUNTRY , C_LOGIN , C_EMAIL_ADDRESS , D_YEAR ) SELECT T_S_SECYEAR.CUSTOMER_ID , T_S_SECYEAR.CUSTOMER_FIRST_NAME , T_S_SECYEAR.CUSTOMER_LAST_NAME , T_S_SECYEAR.CUSTOMER_EMAIL_ADDRESS FROM YEAR_TOTAL AS T_S_FIRSTYEAR , YEAR_TOTAL AS T_S_SECYEAR , YEAR_TOTAL AS T_W_FIRSTYEAR , YEAR_TOTAL AS T_W_SECYEAR WHERE T_S_SECYEAR.CUSTOMER_ID = T_S_FIRSTYEAR.CUSTOMER_ID AND T_S_FIRSTYEAR.CUSTOMER_ID = T_W_SECYEAR.CUSTOMER_ID AND T_S_FIRSTYEAR.CUSTOMER_ID = T_W_FIRSTYEAR.CUSTOMER_ID AND T_S_FIRSTYEAR.SALE_TYPE = 's' AND T_W_FIRSTYEAR.SALE_TYPE = 'w' AND T_S_SECYEAR.SALE_TYPE = 's' AND T_W_SECYEAR.SALE_TYPE = 'w' AND T_S_FIRSTYEAR.DYEAR = 1998 AND T_S_SECYEAR.DYEAR = 1998 + 1 AND T_W_FIRSTYEAR.DYEAR = 1998 AND T_W_SECYEAR.DYEAR = 1998 + 1 AND T_S_FIRSTYEAR.YEAR_TOTAL > 0 AND T_W_FIRSTYEAR.YEAR_TOTAL > 0 AND CASE WHEN T_W_FIRSTYEAR.YEAR_TOTAL > 0 THEN T_W_SECYEAR.YEAR_TOTAL / T_W_FIRSTYEAR.YEAR_TOTAL ELSE 0.0 END > CASE WHEN T_S_FIRSTYEAR.YEAR_TOTAL > 0 THEN T_S_SECYEAR.YEAR_TOTAL / T_S_FIRSTYEAR.YEAR_TOTAL ELSE 0.0 END ORDER BY T_S_SECYEAR.CUSTOMER_ID NULLS FIRST , T_S_SECYEAR.CUSTOMER_FIRST_NAME NULLS FIRST , T_S_SECYEAR.CUSTOMER_LAST_NAME NULLS FIRST , T_S_SECYEAR.CUSTOMER_EMAIL_ADDRESS NULLS FIRST LIMIT 21",
            "preview": "\n/*         customer_id customer_first_name customer_last_name                customer_email_address\n0   AAAAAAAAAAAAIBAA                Anne            Purcell                   Anne.Purcell@kX.com\n1   AAAAAAAAAAAALBAA             Charles              Burke              Charles.Burke@xX8MxV.edu\n2   AAAAAAAAAAABABAA            Cristina            Mcguire   Cristina.Mcguire@pXqzBbMiXdis8i.org\n3   AAAAAAAAAAABBAAA              Donald             Brewer      Donald.Brewer@G3i53520XJvBdB.com\n4   AAAAAAAAAAABJBAA              Albert              Ramey          Albert.Ramey@5MGVmzFXvrG.org\n5   AAAAAAAAAAABOBAA                Enid              Kelly            Enid.Kelly@HkK22K6rGHk.edu\n6   AAAAAAAAAAACPAAA               Marie           Copeland             Marie.Copeland@xCCcTN.com\n7   AAAAAAAAAAADCAAA               Henry            Collazo          Henry.Collazo@a2YAYSRAVB.edu\n8   AAAAAAAAAAADDBAA              Norman               Ness                Norman.Ness@d09i1l.edu\n9   AAAAAAAAAAADFAAA             Darlene            Wheeler  Darlene.Wheeler@XJQTfOd8m1tfKPK9.edu\n10  AAAAAAAAAAADMBAA              George             Adkins    George.Adkins@j2xKzJlaz0I0RYcl.org\n11  AAAAAAAAAAADNBAA               Floyd              Jones      Floyd.Jones@678Z3ZjH3L7Kfba8.org\n12  AAAAAAAAAAADPAAA               Linda              Green                     Linda.Green@x.edu\n13  AAAAAAAAAAAEKBAA              Wesley             Harris          Wesley.Harris@bBtbX4Jdhs.edu\n14  AAAAAAAAAAAEMAAA               Craig             Heflin      Craig.Heflin@Io5EvOvry1KN88G.org\n15  AAAAAAAAAAAEOAAA          Marguerite            Marquez         Marguerite.Marquez@BmKnqD.edu\n16  AAAAAAAAAAAFBBAA               Jimmy             Kruger                 Jimmy.Kruger@29jG.edu\n17  AAAAAAAAAAAFEBAA           Elizabeth             Gordon         Elizabeth.Gordon@zVdmEfsu.edu\n18  AAAAAAAAAAAFFBAA               Edwin                Kim                      Edwin.Kim@K5.com\n...*/",
            "retry_time": 0,
            "query_metrics": {
                "elapsed_time": 4.061769,
                "execution_time": 3.828138,
                "compile_time": 0.001705,
                "planning_time": 0.169822
            },
            "query_metrics_warm_up": {
                "elapsed_time": 20.409666,
                "execution_time": 3.937749,
                "compile_time": 16.158743,
                "planning_time": 0.247738
            }
        }
    ],
    "preview": "\n/*         customer_id customer_first_name customer_last_name                customer_email_address\n0   AAAAAAAAAAAAIBAA                Anne            Purcell                   Anne.Purcell@kX.com\n1   AAAAAAAAAAAALBAA             Charles              Burke              Charles.Burke@xX8MxV.edu\n2   AAAAAAAAAAABABAA            Cristina            Mcguire   Cristina.Mcguire@pXqzBbMiXdis8i.org\n3   AAAAAAAAAAABBAAA              Donald             Brewer      Donald.Brewer@G3i53520XJvBdB.com\n4   AAAAAAAAAAABJBAA              Albert              Ramey          Albert.Ramey@5MGVmzFXvrG.org\n5   AAAAAAAAAAABOBAA                Enid              Kelly            Enid.Kelly@HkK22K6rGHk.edu\n6   AAAAAAAAAAACPAAA               Marie           Copeland             Marie.Copeland@xCCcTN.com\n7   AAAAAAAAAAADCAAA               Henry            Collazo          Henry.Collazo@a2YAYSRAVB.edu\n8   AAAAAAAAAAADDBAA              Norman               Ness                Norman.Ness@d09i1l.edu\n9   AAAAAAAAAAADFAAA             Darlene            Wheeler  Darlene.Wheeler@XJQTfOd8m1tfKPK9.edu\n10  AAAAAAAAAAADMBAA              George             Adkins    George.Adkins@j2xKzJlaz0I0RYcl.org\n11  AAAAAAAAAAADNBAA               Floyd              Jones      Floyd.Jones@678Z3ZjH3L7Kfba8.org\n12  AAAAAAAAAAADPAAA               Linda              Green                     Linda.Green@x.edu\n13  AAAAAAAAAAAEKBAA              Wesley             Harris          Wesley.Harris@bBtbX4Jdhs.edu\n14  AAAAAAAAAAAEMAAA               Craig             Heflin      Craig.Heflin@Io5EvOvry1KN88G.org\n15  AAAAAAAAAAAEOAAA          Marguerite            Marquez         Marguerite.Marquez@BmKnqD.edu\n16  AAAAAAAAAAAFBBAA               Jimmy             Kruger                 Jimmy.Kruger@29jG.edu\n17  AAAAAAAAAAAFEBAA           Elizabeth             Gordon         Elizabeth.Gordon@zVdmEfsu.edu\n18  AAAAAAAAAAAFFBAA               Edwin                Kim                      Edwin.Kim@K5.com\n...*/"
}