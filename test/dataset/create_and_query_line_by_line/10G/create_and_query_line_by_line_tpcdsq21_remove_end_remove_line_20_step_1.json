[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select NULL as w_warehouse_name\n            ,NULL as i_item_id\n            ,sum(case when INV_DATE_SK < 20000519\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when INV_DATE_SK >= 20000519\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n/*CURSOR_IDENTIFIER*/) as subquery",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT NULL AS \"W_WAREHOUSE_NAME\" , NULL AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"INVENTORY\".\"INV_DATE_SK\" < 20000519 THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"INVENTORY\".\"INV_DATE_SK\" >= 20000519 THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" ) SELECT \"SUBQUERY\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SUBQUERY\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SUBQUERY\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"SUBQUERY\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT NULL AS \"W_WAREHOUSE_NAME\" , NULL AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"INVENTORY\".\"INV_DATE_SK\" < 20000519 THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"INVENTORY\".\"INV_DATE_SK\" >= 20000519 THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.161472,
                    "execution_time": 0.108335,
                    "compile_time": 0.000315,
                    "planning_time": 0.026368,
                    "create_size": 7
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.425248,
                    "execution_time": 3.371434,
                    "compile_time": 0.000328,
                    "planning_time": 0.022278,
                    "create_size": 7
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*  w_warehouse_name i_item_id   inv_before  inv_after\n0             None      None  63223996520          0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016394,
                    "execution_time": 0.006927,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003487
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054057,
                    "execution_time": 0.007709,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.03876
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"SPEQLITE_TEMP_TABLE_1\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*  w_warehouse_name i_item_id   inv_before  inv_after\n0             None      None  63223996520          0*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n   group by w_warehouse_name, i_item_id\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"_Q_0\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH _Q_0 AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"_Q_0\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"_Q_0\" AS \"_Q_0\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH _Q_0 AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"_Q_0\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"_Q_0\" AS \"_Q_0\"",
                "rewrite": "WITH _Q_0 AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"_Q_0\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"_Q_0\" AS \"_Q_0\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n   group by w_warehouse_name, i_item_id\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"_Q_0\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.465426,
                    "execution_time": 0.309156,
                    "compile_time": 0.000474,
                    "planning_time": 0.060103,
                    "create_size": 560
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.838188,
                    "execution_time": 1.461569,
                    "compile_time": 0.145359,
                    "planning_time": 0.128495,
                    "create_size": 560
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"SPEQLITE_TEMP_TABLE_2\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0                         AAAAAAAADKLKAAAA       52814      64139\n1                         AAAAAAAACFGPAAAA       47781          0\n2                         AAAAAAAAOBPABAAA       52232          0\n3                         AAAAAAAAEGPABAAA       58750      15503\n4                         AAAAAAAAILPABAAA       62681      62842\n5                         AAAAAAAAAIICBAAA       46946          0\n6                         AAAAAAAAKNICBAAA       51985          0\n7                         AAAAAAAAEHDHBAAA       50033          0\n8                         AAAAAAAAGIMIBAAA       57414      15477\n9                         AAAAAAAAPNMIBAAA       55776      63719\n10  Local, mass universi  AAAAAAAANLGBAAAA       61122      65766\n11  Local, mass universi  AAAAAAAACGHBAAAA       53930          0\n12  Local, mass universi  AAAAAAAAIFADAAAA       53157          0\n13  Local, mass universi  AAAAAAAADDJEAAAA       56577      66952\n14  Local, mass universi  AAAAAAAAIFJEAAAA       55225      14396\n15  Local, mass universi  AAAAAAAAMKBGAAAA       61843      70307\n16  Local, mass universi  AAAAAAAAKECGAAAA       49625          0\n17  Local, mass universi  AAAAAAAAMEEJAAAA       53383      17929\n18  Local, mass universi  AAAAAAAANKFMAAAA       57565      65422\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017169,
                    "execution_time": 0.007759,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003427
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056289,
                    "execution_time": 0.00793,
                    "compile_time": 5e-05,
                    "planning_time": 0.039128
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"SPEQLITE_TEMP_TABLE_2\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"SPEQLITE_TEMP_TABLE_2\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0                         AAAAAAAADKLKAAAA       52814      64139\n1                         AAAAAAAACFGPAAAA       47781          0\n2                         AAAAAAAAOBPABAAA       52232          0\n3                         AAAAAAAAEGPABAAA       58750      15503\n4                         AAAAAAAAILPABAAA       62681      62842\n5                         AAAAAAAAAIICBAAA       46946          0\n6                         AAAAAAAAKNICBAAA       51985          0\n7                         AAAAAAAAEHDHBAAA       50033          0\n8                         AAAAAAAAGIMIBAAA       57414      15477\n9                         AAAAAAAAPNMIBAAA       55776      63719\n10  Local, mass universi  AAAAAAAANLGBAAAA       61122      65766\n11  Local, mass universi  AAAAAAAACGHBAAAA       53930          0\n12  Local, mass universi  AAAAAAAAIFADAAAA       53157          0\n13  Local, mass universi  AAAAAAAADDJEAAAA       56577      66952\n14  Local, mass universi  AAAAAAAAIFJEAAAA       55225      14396\n15  Local, mass universi  AAAAAAAAMKBGAAAA       61843      70307\n16  Local, mass universi  AAAAAAAAKECGAAAA       49625          0\n17  Local, mass universi  AAAAAAAAMEEJAAAA       53383      17929\n18  Local, mass universi  AAAAAAAANKFMAAAA       57565      65422\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date)) and cast ('2000-05-19' as date)\n   group by w_warehouse_name, i_item_id\n/*CURSOR_IDENTIFIER*/\n   )",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-05-19' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"_Q_0\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND CAST ( '2000-05-19' AS DATE ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) LIMIT 21",
                "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0    Conventional childr  AAAAAAAAOHJFAAAA        2350          0\n1    Conventional childr  AAAAAAAAONLIAAAA        2774          0\n2    Conventional childr  AAAAAAAAKOLIAAAA        4087          0\n3    Conventional childr  AAAAAAAAIAMIAAAA        2438          0\n4    Conventional childr  AAAAAAAAHHEKAAAA        1707          0\n5    Conventional childr  AAAAAAAAKKEKAAAA        2190          0\n6    Conventional childr  AAAAAAAAEBFKAAAA        2739          0\n7    Conventional childr  AAAAAAAABJNLAAAA        2024          0\n8    Conventional childr  AAAAAAAABFGNAAAA        2360          0\n9    Conventional childr  AAAAAAAABOGNAAAA        2820          0\n10   Conventional childr  AAAAAAAAHPDFBAAA        1976          0\n11  Important issues liv  AAAAAAAABDCEAAAA        3855          0\n12  Important issues liv  AAAAAAAAABLFAAAA        2662          0\n13  Important issues liv  AAAAAAAAKPOLAAAA        1469          0\n14  Important issues liv  AAAAAAAAIGINAAAA        3446          0\n15  Important issues liv  AAAAAAAAIFBPAAAA        2005          0\n16  Important issues liv  AAAAAAAAIIBPAAAA        3109          0\n17  Important issues liv  AAAAAAAAAOCCBAAA        2290          0\n18  Important issues liv  AAAAAAAAKBDCBAAA        2206          0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.093221,
                    "execution_time": 0.028913,
                    "compile_time": 0.000255,
                    "planning_time": 0.04831
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.167307,
                    "execution_time": 0.029305,
                    "compile_time": 0.000261,
                    "planning_time": 0.119145
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0    Conventional childr  AAAAAAAAOHJFAAAA        2350          0\n1    Conventional childr  AAAAAAAAONLIAAAA        2774          0\n2    Conventional childr  AAAAAAAAKOLIAAAA        4087          0\n3    Conventional childr  AAAAAAAAIAMIAAAA        2438          0\n4    Conventional childr  AAAAAAAAHHEKAAAA        1707          0\n5    Conventional childr  AAAAAAAAKKEKAAAA        2190          0\n6    Conventional childr  AAAAAAAAEBFKAAAA        2739          0\n7    Conventional childr  AAAAAAAABJNLAAAA        2024          0\n8    Conventional childr  AAAAAAAABFGNAAAA        2360          0\n9    Conventional childr  AAAAAAAABOGNAAAA        2820          0\n10   Conventional childr  AAAAAAAAHPDFBAAA        1976          0\n11  Important issues liv  AAAAAAAABDCEAAAA        3855          0\n12  Important issues liv  AAAAAAAAABLFAAAA        2662          0\n13  Important issues liv  AAAAAAAAKPOLAAAA        1469          0\n14  Important issues liv  AAAAAAAAIGINAAAA        3446          0\n15  Important issues liv  AAAAAAAAIFBPAAAA        2005          0\n16  Important issues liv  AAAAAAAAIIBPAAAA        3109          0\n17  Important issues liv  AAAAAAAAAOCCBAAA        2290          0\n18  Important issues liv  AAAAAAAAKBDCBAAA        2206          0\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"_Q_0\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) LIMIT 21",
                "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0    Conventional childr  AAAAAAAABAPDAAAA        3204       1169\n1    Conventional childr  AAAAAAAACHOOAAAA        1462       1593\n2    Conventional childr  AAAAAAAAABACBAAA        2115       2087\n3    Conventional childr  AAAAAAAALACFBAAA        2859       2512\n4    Conventional childr  AAAAAAAAGFLGBAAA        2955       1551\n5    Conventional childr  AAAAAAAAMEEIBAAA        3447       2223\n6   Important issues liv  AAAAAAAAEAPAAAAA        1629       1686\n7   Important issues liv  AAAAAAAAEPHCAAAA        2154       1241\n8   Important issues liv  AAAAAAAAOGJFAAAA        2879       2629\n9   Important issues liv  AAAAAAAAOHJFAAAA        1895       1804\n10  Important issues liv  AAAAAAAABILIAAAA        3131       2261\n11  Important issues liv  AAAAAAAAKKEKAAAA        1820       1061\n12  Important issues liv  AAAAAAAABJNLAAAA        2774       2288\n13  Important issues liv  AAAAAAAACPNLAAAA        3505       1910\n14  Important issues liv  AAAAAAAAIPNLAAAA        2114       3093\n15  Important issues liv  AAAAAAAACFGNAAAA        1284        436\n16  Important issues liv  AAAAAAAADOPOAAAA        2033       2178\n17  Important issues liv  AAAAAAAADAJABAAA        2838       1477\n18  Important issues liv  AAAAAAAADPBCBAAA        2679       3540\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.094703,
                    "execution_time": 0.031377,
                    "compile_time": 0.00026,
                    "planning_time": 0.047392
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.163132,
                    "execution_time": 0.030806,
                    "compile_time": 0.000255,
                    "planning_time": 0.113508
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0    Conventional childr  AAAAAAAABAPDAAAA        3204       1169\n1    Conventional childr  AAAAAAAACHOOAAAA        1462       1593\n2    Conventional childr  AAAAAAAAABACBAAA        2115       2087\n3    Conventional childr  AAAAAAAALACFBAAA        2859       2512\n4    Conventional childr  AAAAAAAAGFLGBAAA        2955       1551\n5    Conventional childr  AAAAAAAAMEEIBAAA        3447       2223\n6   Important issues liv  AAAAAAAAEAPAAAAA        1629       1686\n7   Important issues liv  AAAAAAAAEPHCAAAA        2154       1241\n8   Important issues liv  AAAAAAAAOGJFAAAA        2879       2629\n9   Important issues liv  AAAAAAAAOHJFAAAA        1895       1804\n10  Important issues liv  AAAAAAAABILIAAAA        3131       2261\n11  Important issues liv  AAAAAAAAKKEKAAAA        1820       1061\n12  Important issues liv  AAAAAAAABJNLAAAA        2774       2288\n13  Important issues liv  AAAAAAAACPNLAAAA        3505       1910\n14  Important issues liv  AAAAAAAAIPNLAAAA        2114       3093\n15  Important issues liv  AAAAAAAACFGNAAAA        1284        436\n16  Important issues liv  AAAAAAAADOPOAAAA        2033       2178\n17  Important issues liv  AAAAAAAADAJABAAA        2838       1477\n18  Important issues liv  AAAAAAAADPBCBAAA        2679       3540\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X LIMIT 21",
                "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0    Conventional childr  AAAAAAAAHCIFAAAA        1838       2158\n1    Conventional childr  AAAAAAAAIEIFAAAA        1479       1533\n2    Conventional childr  AAAAAAAAECMLAAAA        1756       1085\n3    Conventional childr  AAAAAAAADFMLAAAA        2019       1732\n4    Conventional childr  AAAAAAAANDFNAAAA         976       1929\n5    Conventional childr  AAAAAAAAEFOOAAAA        3441       2252\n6    Conventional childr  AAAAAAAAGOPBBAAA        2759       1779\n7    Conventional childr  AAAAAAAAHMIDBAAA        2654       2136\n8    Conventional childr  AAAAAAAACMKGBAAA        3466       1190\n9    Conventional childr  AAAAAAAAHIEIBAAA        1372       2186\n10  Important issues liv  AAAAAAAANFAEAAAA        3325       1857\n11  Important issues liv  AAAAAAAAHKJFAAAA        2591        963\n12  Important issues liv  AAAAAAAAHILIAAAA        2801       1283\n13  Important issues liv  AAAAAAAAGMEKAAAA        2900       1223\n14  Important issues liv  AAAAAAAAJNNLAAAA        2742       2498\n15  Important issues liv  AAAAAAAANFBCBAAA        1552       1382\n16  Important issues liv  AAAAAAAAOHKDBAAA        3019       1433\n17  Important issues liv  AAAAAAAANAGIBAAA        2627       2527\n18           Doors canno  AAAAAAAANBJCAAAA        2440       2559\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.095719,
                    "execution_time": 0.033844,
                    "compile_time": 0.000258,
                    "planning_time": 0.045765
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.15981,
                    "execution_time": 0.029091,
                    "compile_time": 0.000251,
                    "planning_time": 0.114782
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0    Conventional childr  AAAAAAAAHCIFAAAA        1838       2158\n1    Conventional childr  AAAAAAAAIEIFAAAA        1479       1533\n2    Conventional childr  AAAAAAAAECMLAAAA        1756       1085\n3    Conventional childr  AAAAAAAADFMLAAAA        2019       1732\n4    Conventional childr  AAAAAAAANDFNAAAA         976       1929\n5    Conventional childr  AAAAAAAAEFOOAAAA        3441       2252\n6    Conventional childr  AAAAAAAAGOPBBAAA        2759       1779\n7    Conventional childr  AAAAAAAAHMIDBAAA        2654       2136\n8    Conventional childr  AAAAAAAACMKGBAAA        3466       1190\n9    Conventional childr  AAAAAAAAHIEIBAAA        1372       2186\n10  Important issues liv  AAAAAAAANFAEAAAA        3325       1857\n11  Important issues liv  AAAAAAAAHKJFAAAA        2591        963\n12  Important issues liv  AAAAAAAAHILIAAAA        2801       1283\n13  Important issues liv  AAAAAAAAGMEKAAAA        2900       1223\n14  Important issues liv  AAAAAAAAJNNLAAAA        2742       2498\n15  Important issues liv  AAAAAAAANFBCBAAA        1552       1382\n16  Important issues liv  AAAAAAAAOHKDBAAA        3019       1433\n17  Important issues liv  AAAAAAAANAGIBAAA        2627       2527\n18           Doors canno  AAAAAAAANBJCAAAA        2440       2559\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 then 1 else 0 end) = 1\n\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\" WHERE CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN 1 ELSE 0 END = 1"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN 1 ELSE 0 END ) = 1 LIMIT 21",
                "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0    Conventional childr  AAAAAAAALKMBAAAA        1744       2113\n1    Conventional childr  AAAAAAAABOMBAAAA        2545       2146\n2    Conventional childr  AAAAAAAAOBNBAAAA        2250       2534\n3    Conventional childr  AAAAAAAALNHGAAAA        3078        598\n4    Conventional childr  AAAAAAAAIGEOAAAA        2709       1893\n5    Conventional childr  AAAAAAAAHMEOAAAA        2259       1960\n6    Conventional childr  AAAAAAAAPMNPAAAA        2391       1416\n7    Conventional childr  AAAAAAAAIKIEBAAA        2153       2269\n8    Conventional childr  AAAAAAAAECJEBAAA        2661       2006\n9    Conventional childr  AAAAAAAAAALHBAAA        2738       2390\n10  Important issues liv  AAAAAAAACBFAAAAA        2796       2704\n11  Important issues liv  AAAAAAAAEFFAAAAA        2630       1540\n12  Important issues liv  AAAAAAAAFJFAAAAA        2218       1106\n13  Important issues liv  AAAAAAAAICHDAAAA        1419        887\n14  Important issues liv  AAAAAAAACFHDAAAA        2950       1209\n15  Important issues liv  AAAAAAAAADAFAAAA        2127       1679\n16  Important issues liv  AAAAAAAAGAGOAAAA        2216       1338\n17  Important issues liv  AAAAAAAAGGGOAAAA        3435       2264\n18  Important issues liv  AAAAAAAAEPHBBAAA        1443       1545\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.097126,
                    "execution_time": 0.033057,
                    "compile_time": 0.000253,
                    "planning_time": 0.047756
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.167273,
                    "execution_time": 0.032228,
                    "compile_time": 0.000291,
                    "planning_time": 0.117631
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0    Conventional childr  AAAAAAAALKMBAAAA        1744       2113\n1    Conventional childr  AAAAAAAABOMBAAAA        2545       2146\n2    Conventional childr  AAAAAAAAOBNBAAAA        2250       2534\n3    Conventional childr  AAAAAAAALNHGAAAA        3078        598\n4    Conventional childr  AAAAAAAAIGEOAAAA        2709       1893\n5    Conventional childr  AAAAAAAAHMEOAAAA        2259       1960\n6    Conventional childr  AAAAAAAAPMNPAAAA        2391       1416\n7    Conventional childr  AAAAAAAAIKIEBAAA        2153       2269\n8    Conventional childr  AAAAAAAAECJEBAAA        2661       2006\n9    Conventional childr  AAAAAAAAAALHBAAA        2738       2390\n10  Important issues liv  AAAAAAAACBFAAAAA        2796       2704\n11  Important issues liv  AAAAAAAAEFFAAAAA        2630       1540\n12  Important issues liv  AAAAAAAAFJFAAAAA        2218       1106\n13  Important issues liv  AAAAAAAAICHDAAAA        1419        887\n14  Important issues liv  AAAAAAAACFHDAAAA        2950       1209\n15  Important issues liv  AAAAAAAAADAFAAAA        2127       1679\n16  Important issues liv  AAAAAAAAGAGOAAAA        2216       1338\n17  Important issues liv  AAAAAAAAGGGOAAAA        3435       2264\n18  Important issues liv  AAAAAAAAEPHBBAAA        1443       1545\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null end) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\" WHERE CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END <> 0"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN INV_AFTER / INV_BEFORE ELSE NULL END ) LIMIT 21",
                "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0    Conventional childr  AAAAAAAACHOOAAAA        1462       1593\n1   Important issues liv  AAAAAAAAEAPAAAAA        1629       1686\n2   Important issues liv  AAAAAAAAIPNLAAAA        2114       3093\n3   Important issues liv  AAAAAAAADOPOAAAA        2033       2178\n4   Important issues liv  AAAAAAAADPBCBAAA        2679       3540\n5            Doors canno  AAAAAAAAEJABAAAA        1807       2328\n6            Doors canno  AAAAAAAALAPLAAAA        1598       1825\n7            Doors canno  AAAAAAAAAOCCBAAA        2277       2350\n8            Doors canno  AAAAAAAAAEOGBAAA        1835       2082\n9   Bad cards must make.  AAAAAAAAJALCAAAA        2319       2799\n10  Bad cards must make.  AAAAAAAAAAGHAAAA        1916       1942\n11  Bad cards must make.  AAAAAAAAEAGHAAAA         610        703\n12  Bad cards must make.  AAAAAAAABNHKAAAA        1888       2792\n13  Bad cards must make.  AAAAAAAACNHKAAAA        2240       2313\n14  Bad cards must make.  AAAAAAAAEDBMAAAA        2493       2559\n15  Bad cards must make.  AAAAAAAAFAKNAAAA        1237       1265\n16  Bad cards must make.  AAAAAAAACBMABAAA        1577       2488\n17  Bad cards must make.  AAAAAAAAGKECBAAA        1939       2063\n18  Bad cards must make.  AAAAAAAACCHFBAAA        2177       2212\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.101743,
                    "execution_time": 0.034877,
                    "compile_time": 0.00027,
                    "planning_time": 0.049555
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.169964,
                    "execution_time": 0.034309,
                    "compile_time": 0.000271,
                    "planning_time": 0.118066
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0    Conventional childr  AAAAAAAACHOOAAAA        1462       1593\n1   Important issues liv  AAAAAAAAEAPAAAAA        1629       1686\n2   Important issues liv  AAAAAAAAIPNLAAAA        2114       3093\n3   Important issues liv  AAAAAAAADOPOAAAA        2033       2178\n4   Important issues liv  AAAAAAAADPBCBAAA        2679       3540\n5            Doors canno  AAAAAAAAEJABAAAA        1807       2328\n6            Doors canno  AAAAAAAALAPLAAAA        1598       1825\n7            Doors canno  AAAAAAAAAOCCBAAA        2277       2350\n8            Doors canno  AAAAAAAAAEOGBAAA        1835       2082\n9   Bad cards must make.  AAAAAAAAJALCAAAA        2319       2799\n10  Bad cards must make.  AAAAAAAAAAGHAAAA        1916       1942\n11  Bad cards must make.  AAAAAAAAEAGHAAAA         610        703\n12  Bad cards must make.  AAAAAAAABNHKAAAA        1888       2792\n13  Bad cards must make.  AAAAAAAACNHKAAAA        2240       2313\n14  Bad cards must make.  AAAAAAAAEDBMAAAA        2493       2559\n15  Bad cards must make.  AAAAAAAAFAKNAAAA        1237       1265\n16  Bad cards must make.  AAAAAAAACBMABAAA        1577       2488\n17  Bad cards must make.  AAAAAAAAGKECBAAA        1939       2063\n18  Bad cards must make.  AAAAAAAACCHFBAAA        2177       2212\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null end) > 0\n\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\" WHERE CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END > 0"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN INV_AFTER / INV_BEFORE ELSE NULL END ) > 0 LIMIT 21",
                "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0    Conventional childr  AAAAAAAACHOOAAAA        1462       1593\n1   Important issues liv  AAAAAAAAEAPAAAAA        1629       1686\n2   Important issues liv  AAAAAAAAIPNLAAAA        2114       3093\n3   Important issues liv  AAAAAAAADOPOAAAA        2033       2178\n4   Important issues liv  AAAAAAAADPBCBAAA        2679       3540\n5            Doors canno  AAAAAAAAEJABAAAA        1807       2328\n6            Doors canno  AAAAAAAALAPLAAAA        1598       1825\n7            Doors canno  AAAAAAAAAOCCBAAA        2277       2350\n8            Doors canno  AAAAAAAAAEOGBAAA        1835       2082\n9   Bad cards must make.  AAAAAAAAJALCAAAA        2319       2799\n10  Bad cards must make.  AAAAAAAAAAGHAAAA        1916       1942\n11  Bad cards must make.  AAAAAAAAEAGHAAAA         610        703\n12  Bad cards must make.  AAAAAAAABNHKAAAA        1888       2792\n13  Bad cards must make.  AAAAAAAACNHKAAAA        2240       2313\n14  Bad cards must make.  AAAAAAAAEDBMAAAA        2493       2559\n15  Bad cards must make.  AAAAAAAAFAKNAAAA        1237       1265\n16  Bad cards must make.  AAAAAAAACBMABAAA        1577       2488\n17  Bad cards must make.  AAAAAAAAGKECBAAA        1939       2063\n18  Bad cards must make.  AAAAAAAACCHFBAAA        2177       2212\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.100647,
                    "execution_time": 0.034423,
                    "compile_time": 0.000276,
                    "planning_time": 0.048834
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.168935,
                    "execution_time": 0.035555,
                    "compile_time": 0.000263,
                    "planning_time": 0.116353
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0    Conventional childr  AAAAAAAACHOOAAAA        1462       1593\n1   Important issues liv  AAAAAAAAEAPAAAAA        1629       1686\n2   Important issues liv  AAAAAAAAIPNLAAAA        2114       3093\n3   Important issues liv  AAAAAAAADOPOAAAA        2033       2178\n4   Important issues liv  AAAAAAAADPBCBAAA        2679       3540\n5            Doors canno  AAAAAAAAEJABAAAA        1807       2328\n6            Doors canno  AAAAAAAALAPLAAAA        1598       1825\n7            Doors canno  AAAAAAAAAOCCBAAA        2277       2350\n8            Doors canno  AAAAAAAAAEOGBAAA        1835       2082\n9   Bad cards must make.  AAAAAAAAJALCAAAA        2319       2799\n10  Bad cards must make.  AAAAAAAAAAGHAAAA        1916       1942\n11  Bad cards must make.  AAAAAAAAEAGHAAAA         610        703\n12  Bad cards must make.  AAAAAAAABNHKAAAA        1888       2792\n13  Bad cards must make.  AAAAAAAACNHKAAAA        2240       2313\n14  Bad cards must make.  AAAAAAAAEDBMAAAA        2493       2559\n15  Bad cards must make.  AAAAAAAAFAKNAAAA        1237       1265\n16  Bad cards must make.  AAAAAAAACBMABAAA        1577       2488\n17  Bad cards must make.  AAAAAAAAGKECBAAA        1939       2063\n18  Bad cards must make.  AAAAAAAACCHFBAAA        2177       2212\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null\n             end) between 2.0/3.0 and 3.0/2.0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\" WHERE CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END <= 1.5 AND CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END >= 0.6666666666666666666666666667"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN INV_AFTER / INV_BEFORE ELSE NULL END ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0 LIMIT 21",
                "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0    Conventional childr  AAAAAAAAHCIFAAAA        1838       2158\n1    Conventional childr  AAAAAAAAIEIFAAAA        1479       1533\n2    Conventional childr  AAAAAAAANDFNAAAA         976       1929\n3    Conventional childr  AAAAAAAAHIEIBAAA        1372       2186\n4            Doors canno  AAAAAAAANBJCAAAA        2440       2559\n5            Doors canno  AAAAAAAAABLFAAAA        1904       2119\n6            Doors canno  AAAAAAAAFBGKAAAA        2238       3205\n7            Doors canno  AAAAAAAAKBINAAAA        1729       2336\n8   Bad cards must make.  AAAAAAAALMHKAAAA        1742       2341\n9   Bad cards must make.  AAAAAAAAHPAMAAAA        1183       1539\n10  Bad cards must make.  AAAAAAAAIKJNAAAA        2271       2379\n11  Bad cards must make.  AAAAAAAACAAHBAAA        1394       1714\n12  Bad cards must make.  AAAAAAAAGCAHBAAA        2628       2952\n13                        AAAAAAAALLLNAAAA        1007       2009\n14                        AAAAAAAAGMPDBAAA        2080       2608\n15                        AAAAAAAAJEBHBAAA        1916       2933\n16  Local, mass universi  AAAAAAAAAOIHAAAA        2310       2775\n17  Local, mass universi  AAAAAAAAJAJHAAAA        2602       2682\n18        Quite effectiv  AAAAAAAAOICEBAAA        1538       2074\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.10159,
                    "execution_time": 0.033035,
                    "compile_time": 0.000268,
                    "planning_time": 0.050687
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.171437,
                    "execution_time": 0.03472,
                    "compile_time": 0.000273,
                    "planning_time": 0.118747
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*        w_warehouse_name         i_item_id  inv_before  inv_after\n0    Conventional childr  AAAAAAAAHCIFAAAA        1838       2158\n1    Conventional childr  AAAAAAAAIEIFAAAA        1479       1533\n2    Conventional childr  AAAAAAAANDFNAAAA         976       1929\n3    Conventional childr  AAAAAAAAHIEIBAAA        1372       2186\n4            Doors canno  AAAAAAAANBJCAAAA        2440       2559\n5            Doors canno  AAAAAAAAABLFAAAA        1904       2119\n6            Doors canno  AAAAAAAAFBGKAAAA        2238       3205\n7            Doors canno  AAAAAAAAKBINAAAA        1729       2336\n8   Bad cards must make.  AAAAAAAALMHKAAAA        1742       2341\n9   Bad cards must make.  AAAAAAAAHPAMAAAA        1183       1539\n10  Bad cards must make.  AAAAAAAAIKJNAAAA        2271       2379\n11  Bad cards must make.  AAAAAAAACAAHBAAA        1394       1714\n12  Bad cards must make.  AAAAAAAAGCAHBAAA        2628       2952\n13                        AAAAAAAALLLNAAAA        1007       2009\n14                        AAAAAAAAGMPDBAAA        2080       2608\n15                        AAAAAAAAJEBHBAAA        1916       2933\n16  Local, mass universi  AAAAAAAAAOIHAAAA        2310       2775\n17  Local, mass universi  AAAAAAAAJAJHAAAA        2602       2682\n18        Quite effectiv  AAAAAAAAOICEBAAA        1538       2074\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null\n             end) between 2.0/3.0 and 3.0/2.0\n order by w_warehouse_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\" WHERE CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END <= 1.5 AND CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END >= 0.6666666666666666666666666667 ORDER BY \"X\".\"W_WAREHOUSE_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN INV_AFTER / INV_BEFORE ELSE NULL END ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0 ORDER BY W_WAREHOUSE_NAME NULLS FIRST LIMIT 21",
                "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAANGPGAAAA        1893       3060\n1                    AAAAAAAAJPCCAAAA        1801       2558\n2                    AAAAAAAAIFKIAAAA        1701       2024\n3                    AAAAAAAAKECNAAAA        1968       2039\n4                    AAAAAAAACDLGAAAA        2482       2782\n5                    AAAAAAAAJEDJAAAA        2114       2221\n6                    AAAAAAAAOONBBAAA        1394       2064\n7                    AAAAAAAAILCEBAAA        2047       2522\n8                    AAAAAAAAOHGCAAAA        2477       2652\n9                    AAAAAAAAFNILAAAA        1436       2188\n10                   AAAAAAAADAIFAAAA        1490       1881\n11                   AAAAAAAAHNBNAAAA        2246       2741\n12                   AAAAAAAAOHHPAAAA        1808       2147\n13                   AAAAAAAAKOOFAAAA        1350       1374\n14                   AAAAAAAANJGAAAAA        2329       2819\n15                   AAAAAAAACNPCAAAA        2065       2738\n16                   AAAAAAAANIKAAAAA        2176       2647\n17                   AAAAAAAAHHFMAAAA        2188       2831\n18                   AAAAAAAAECBKAAAA        2434       2654\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.10878,
                    "execution_time": 0.041345,
                    "compile_time": 0.000293,
                    "planning_time": 0.049826
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.181702,
                    "execution_time": 0.042648,
                    "compile_time": 0.000314,
                    "planning_time": 0.120148
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAANGPGAAAA        1893       3060\n1                    AAAAAAAAJPCCAAAA        1801       2558\n2                    AAAAAAAAIFKIAAAA        1701       2024\n3                    AAAAAAAAKECNAAAA        1968       2039\n4                    AAAAAAAACDLGAAAA        2482       2782\n5                    AAAAAAAAJEDJAAAA        2114       2221\n6                    AAAAAAAAOONBBAAA        1394       2064\n7                    AAAAAAAAILCEBAAA        2047       2522\n8                    AAAAAAAAOHGCAAAA        2477       2652\n9                    AAAAAAAAFNILAAAA        1436       2188\n10                   AAAAAAAADAIFAAAA        1490       1881\n11                   AAAAAAAAHNBNAAAA        2246       2741\n12                   AAAAAAAAOHHPAAAA        1808       2147\n13                   AAAAAAAAKOOFAAAA        1350       1374\n14                   AAAAAAAANJGAAAAA        2329       2819\n15                   AAAAAAAACNPCAAAA        2065       2738\n16                   AAAAAAAANIKAAAAA        2176       2647\n17                   AAAAAAAAHHFMAAAA        2188       2831\n18                   AAAAAAAAECBKAAAA        2434       2654\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null\n             end) between 2.0/3.0 and 3.0/2.0\n order by w_warehouse_name\n         ,i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\" WHERE CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END <= 1.5 AND CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END >= 0.6666666666666666666666666667 ORDER BY \"X\".\"W_WAREHOUSE_NAME\" NULLS LAST , \"X\".\"I_ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN INV_AFTER / INV_BEFORE ELSE NULL END ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0 ORDER BY W_WAREHOUSE_NAME NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
                "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAAAAFBBAAA        2385       2507\n1                    AAAAAAAAAAFFBAAA        2720       2904\n2                    AAAAAAAAAAHDAAAA        1722       2552\n3                    AAAAAAAAAAKNAAAA        2126       2484\n4                    AAAAAAAAAALHBAAA        1642       2713\n5                    AAAAAAAAAANKAAAA        1856       2854\n6                    AAAAAAAAAAPBBAAA        2020       2425\n7                    AAAAAAAAABACBAAA        2404       2497\n8                    AAAAAAAAABHFBAAA        2790       3447\n9                    AAAAAAAAABIKAAAA        1425       1449\n10                   AAAAAAAAACEHBAAA        1962       2676\n11                   AAAAAAAAACGFBAAA        1903       2309\n12                   AAAAAAAAACGOAAAA        2007       2290\n13                   AAAAAAAAACGPAAAA        1181       2329\n14                   AAAAAAAAACLNAAAA        1441       1992\n15                   AAAAAAAAACNBBAAA        2222       2448\n16                   AAAAAAAAACOGAAAA        1690       1778\n17                   AAAAAAAAACPDAAAA        1827       3110\n18                   AAAAAAAAADGBAAAA        2305       2379\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.111486,
                    "execution_time": 0.040311,
                    "compile_time": 0.000338,
                    "planning_time": 0.052055
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.179424,
                    "execution_time": 0.041692,
                    "compile_time": 0.000298,
                    "planning_time": 0.118538
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAAAAFBBAAA        2385       2507\n1                    AAAAAAAAAAFFBAAA        2720       2904\n2                    AAAAAAAAAAHDAAAA        1722       2552\n3                    AAAAAAAAAAKNAAAA        2126       2484\n4                    AAAAAAAAAALHBAAA        1642       2713\n5                    AAAAAAAAAANKAAAA        1856       2854\n6                    AAAAAAAAAAPBBAAA        2020       2425\n7                    AAAAAAAAABACBAAA        2404       2497\n8                    AAAAAAAAABHFBAAA        2790       3447\n9                    AAAAAAAAABIKAAAA        1425       1449\n10                   AAAAAAAAACEHBAAA        1962       2676\n11                   AAAAAAAAACGFBAAA        1903       2309\n12                   AAAAAAAAACGOAAAA        2007       2290\n13                   AAAAAAAAACGPAAAA        1181       2329\n14                   AAAAAAAAACLNAAAA        1441       1992\n15                   AAAAAAAAACNBBAAA        2222       2448\n16                   AAAAAAAAACOGAAAA        1690       1778\n17                   AAAAAAAAACPDAAAA        1827       3110\n18                   AAAAAAAAADGBAAAA        2305       2379\n...*/"
    },
    {
        "input": "-- start template query21.tpl query 14 in stream 0\nselect /* TPC-DS query21.tpl 0.14 */  *\n from(select w_warehouse_name\n            ,i_item_id\n            ,sum(case when (cast(d_date as date) < cast ('2000-05-19' as date))\n\t                then inv_quantity_on_hand \n                      else 0 end) as inv_before\n            ,sum(case when (cast(d_date as date) >= cast ('2000-05-19' as date))\n                      then inv_quantity_on_hand \n                      else 0 end) as inv_after\n   from inventory\n       ,warehouse\n       ,item\n       ,date_dim\n   where i_current_price between 0.99 and 1.49\n     and i_item_sk          = inv_item_sk\n     and inv_warehouse_sk   = w_warehouse_sk\n     and inv_date_sk    = d_date_sk\n     and d_date between dateadd(day,-30,cast ('2000-05-19' as date))\n                    and dateadd(day,30,cast ('2000-05-19' as date))\n   group by w_warehouse_name, i_item_id) x\n where (case when inv_before > 0 \n             then inv_after / inv_before \n             else null\n             end) between 2.0/3.0 and 3.0/2.0\n order by w_warehouse_name\n         ,i_item_id\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"X\" AS ( SELECT \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" < CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_BEFORE\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-05-19' AS DATE ) THEN \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" ELSE 0 END ) AS \"INV_AFTER\" FROM \"INVENTORY\" AS \"INVENTORY\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"INVENTORY\".\"INV_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CURRENT_PRICE\" <= 1.49 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 0.99 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"ITEM\".\"I_ITEM_ID\" ) SELECT \"X\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"X\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"X\".\"INV_BEFORE\" AS \"INV_BEFORE\" , \"X\".\"INV_AFTER\" AS \"INV_AFTER\" FROM \"X\" AS \"X\" WHERE CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END <= 1.5 AND CASE WHEN \"X\".\"INV_BEFORE\" > 0 THEN CAST ( \"X\".\"INV_AFTER\" / \"X\".\"INV_BEFORE\" AS BIGINT ) ELSE NULL END >= 0.6666666666666666666666666667 ORDER BY \"X\".\"W_WAREHOUSE_NAME\" NULLS LAST , \"X\".\"I_ITEM_ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT * FROM ( SELECT W_WAREHOUSE_NAME , I_ITEM_ID , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) < CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_BEFORE , SUM ( CASE WHEN ( CAST ( D_DATE AS DATE ) >= CAST ( '2000-05-19' AS DATE ) ) THEN INV_QUANTITY_ON_HAND ELSE 0 END ) AS INV_AFTER FROM INVENTORY , WAREHOUSE , ITEM , DATE_DIM WHERE I_CURRENT_PRICE BETWEEN 0.99 AND 1.49 AND I_ITEM_SK = INV_ITEM_SK AND INV_WAREHOUSE_SK = W_WAREHOUSE_SK AND INV_DATE_SK = D_DATE_SK AND D_DATE BETWEEN DATEADD ( DAY , -30 , CAST ( '2000-05-19' AS DATE ) ) AND DATEADD ( DAY , 30 , CAST ( '2000-05-19' AS DATE ) ) GROUP BY W_WAREHOUSE_NAME , I_ITEM_ID ) AS X WHERE ( CASE WHEN INV_BEFORE > 0 THEN INV_AFTER / INV_BEFORE ELSE NULL END ) BETWEEN 2.0 / 3.0 AND 3.0 / 2.0 ORDER BY W_WAREHOUSE_NAME NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
                "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAAAAFBBAAA        2385       2507\n1                    AAAAAAAAAAFFBAAA        2720       2904\n2                    AAAAAAAAAAHDAAAA        1722       2552\n3                    AAAAAAAAAAKNAAAA        2126       2484\n4                    AAAAAAAAAALHBAAA        1642       2713\n5                    AAAAAAAAAANKAAAA        1856       2854\n6                    AAAAAAAAAAPBBAAA        2020       2425\n7                    AAAAAAAAABACBAAA        2404       2497\n8                    AAAAAAAAABHFBAAA        2790       3447\n9                    AAAAAAAAABIKAAAA        1425       1449\n10                   AAAAAAAAACEHBAAA        1962       2676\n11                   AAAAAAAAACGFBAAA        1903       2309\n12                   AAAAAAAAACGOAAAA        2007       2290\n13                   AAAAAAAAACGPAAAA        1181       2329\n14                   AAAAAAAAACLNAAAA        1441       1992\n15                   AAAAAAAAACNBBAAA        2222       2448\n16                   AAAAAAAAACOGAAAA        1690       1778\n17                   AAAAAAAAACPDAAAA        1827       3110\n18                   AAAAAAAAADGBAAAA        2305       2379\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.110061,
                    "execution_time": 0.041107,
                    "compile_time": 0.000292,
                    "planning_time": 0.051366
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.111568,
                    "execution_time": 0.045198,
                    "compile_time": 0.000292,
                    "planning_time": 0.048804
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   w_warehouse_name         i_item_id  inv_before  inv_after\n0                    AAAAAAAAAAFBBAAA        2385       2507\n1                    AAAAAAAAAAFFBAAA        2720       2904\n2                    AAAAAAAAAAHDAAAA        1722       2552\n3                    AAAAAAAAAAKNAAAA        2126       2484\n4                    AAAAAAAAAALHBAAA        1642       2713\n5                    AAAAAAAAAANKAAAA        1856       2854\n6                    AAAAAAAAAAPBBAAA        2020       2425\n7                    AAAAAAAAABACBAAA        2404       2497\n8                    AAAAAAAAABHFBAAA        2790       3447\n9                    AAAAAAAAABIKAAAA        1425       1449\n10                   AAAAAAAAACEHBAAA        1962       2676\n11                   AAAAAAAAACGFBAAA        1903       2309\n12                   AAAAAAAAACGOAAAA        2007       2290\n13                   AAAAAAAAACGPAAAA        1181       2329\n14                   AAAAAAAAACLNAAAA        1441       1992\n15                   AAAAAAAAACNBBAAA        2222       2448\n16                   AAAAAAAAACOGAAAA        1690       1778\n17                   AAAAAAAAACPDAAAA        1827       3110\n18                   AAAAAAAAADGBAAAA        2305       2379\n...*/"
    }
]