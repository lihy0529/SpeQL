[
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_firstyear.customer_id, t_s_firstyear.customer_first_name, t_s_firstyear.customer_last_name\n from year_total t_s_firstyear\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.577796,
                    "execution_time": 0.215159,
                    "compile_time": 0.000252,
                    "planning_time": 0.025372,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.634272,
                    "execution_time": 0.220138,
                    "compile_time": 0.000259,
                    "planning_time": 0.083623,
                    "create_size": 896
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.080386,
                    "execution_time": 0.031185,
                    "compile_time": 0.00023,
                    "planning_time": 0.025825,
                    "create_size": 20
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.148867,
                    "execution_time": 0.031841,
                    "compile_time": 0.000232,
                    "planning_time": 0.091234,
                    "create_size": 20
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.897881,
                    "execution_time": 0.542998,
                    "compile_time": 0.000713,
                    "planning_time": 0.053489,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.542898,
                    "execution_time": 0.548954,
                    "compile_time": 7.756525,
                    "planning_time": 0.126759,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAOIGIGAAA               Pedro               Owen\n1   AAAAAAAAGAALAAAA               Keith             Harper\n2   AAAAAAAANAENCAAA              Willie            Jackson\n3   AAAAAAAANMNDBAAA              Dexter             Cutler\n4   AAAAAAAAADLHFAAA              Donald               Hale\n5   AAAAAAAADJCMBAAA                                       \n6   AAAAAAAAHHIGCAAA                Cleo             Shuman\n7   AAAAAAAAPFMEAAAA         Christopher               Howe\n8   AAAAAAAAPMNHCAAA             Tiffany              Lopez\n9   AAAAAAAACAFCAAAA           Elizabeth              Hayes\n10  AAAAAAAAAEFFAAAA                Ruth            Johnson\n11  AAAAAAAANFFFDAAA              Jerome             Hoover\n12  AAAAAAAALOIKFAAA              Sherry             Hoover\n13  AAAAAAAAPBHIAAAA              Louann            Roberts\n14  AAAAAAAAILEBFAAA                Emil               Soto\n15  AAAAAAAAJNDJBAAA              Nichol            Higgins\n16  AAAAAAAADBLLGAAA                Carl          Champagne\n17  AAAAAAAAFLBKGAAA             Melissa            Nichols\n18  AAAAAAAAHHADAAAA                Adam              Crane\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016498,
                    "execution_time": 0.007474,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003204
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055728,
                    "execution_time": 0.007946,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.03866
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\"",
                "rewrite": "SELECT \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_FIRSTYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAOIGIGAAA               Pedro               Owen\n1   AAAAAAAAGAALAAAA               Keith             Harper\n2   AAAAAAAANAENCAAA              Willie            Jackson\n3   AAAAAAAANMNDBAAA              Dexter             Cutler\n4   AAAAAAAAADLHFAAA              Donald               Hale\n5   AAAAAAAADJCMBAAA                                       \n6   AAAAAAAAHHIGCAAA                Cleo             Shuman\n7   AAAAAAAAPFMEAAAA         Christopher               Howe\n8   AAAAAAAAPMNHCAAA             Tiffany              Lopez\n9   AAAAAAAACAFCAAAA           Elizabeth              Hayes\n10  AAAAAAAAAEFFAAAA                Ruth            Johnson\n11  AAAAAAAANFFFDAAA              Jerome             Hoover\n12  AAAAAAAALOIKFAAA              Sherry             Hoover\n13  AAAAAAAAPBHIAAAA              Louann            Roberts\n14  AAAAAAAAILEBFAAA                Emil               Soto\n15  AAAAAAAAJNDJBAAA              Nichol            Higgins\n16  AAAAAAAADBLLGAAA                Carl          Champagne\n17  AAAAAAAAFLBKGAAA             Melissa            Nichols\n18  AAAAAAAAHHADAAAA                Adam              Crane\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAKGBPDAAA              Shawna             Glaser\n1   AAAAAAAAKGBPDAAA              Shawna             Glaser\n2   AAAAAAAAKGBPDAAA              Shawna             Glaser\n3   AAAAAAAAKGBPDAAA              Shawna             Glaser\n4   AAAAAAAAKGBPDAAA              Shawna             Glaser\n5   AAAAAAAAKGBPDAAA              Shawna             Glaser\n6   AAAAAAAAKGBPDAAA              Shawna             Glaser\n7   AAAAAAAAKGBPDAAA              Shawna             Glaser\n8   AAAAAAAAKGBPDAAA              Shawna             Glaser\n9   AAAAAAAAKGBPDAAA              Shawna             Glaser\n10  AAAAAAAAKGBPDAAA              Shawna             Glaser\n11  AAAAAAAAKGBPDAAA              Shawna             Glaser\n12  AAAAAAAAKGBPDAAA              Shawna             Glaser\n13  AAAAAAAAKGBPDAAA              Shawna             Glaser\n14  AAAAAAAAKGBPDAAA              Shawna             Glaser\n15  AAAAAAAAKGBPDAAA              Shawna             Glaser\n16  AAAAAAAAKGBPDAAA              Shawna             Glaser\n17  AAAAAAAAKGBPDAAA              Shawna             Glaser\n18  AAAAAAAAKGBPDAAA              Shawna             Glaser\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.028144,
                    "execution_time": 0.016959,
                    "compile_time": 8.3e-05,
                    "planning_time": 0.004237
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.066278,
                    "execution_time": 0.017592,
                    "compile_time": 9.2e-05,
                    "planning_time": 0.039804
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAKGBPDAAA              Shawna             Glaser\n1   AAAAAAAAKGBPDAAA              Shawna             Glaser\n2   AAAAAAAAKGBPDAAA              Shawna             Glaser\n3   AAAAAAAAKGBPDAAA              Shawna             Glaser\n4   AAAAAAAAKGBPDAAA              Shawna             Glaser\n5   AAAAAAAAKGBPDAAA              Shawna             Glaser\n6   AAAAAAAAKGBPDAAA              Shawna             Glaser\n7   AAAAAAAAKGBPDAAA              Shawna             Glaser\n8   AAAAAAAAKGBPDAAA              Shawna             Glaser\n9   AAAAAAAAKGBPDAAA              Shawna             Glaser\n10  AAAAAAAAKGBPDAAA              Shawna             Glaser\n11  AAAAAAAAKGBPDAAA              Shawna             Glaser\n12  AAAAAAAAKGBPDAAA              Shawna             Glaser\n13  AAAAAAAAKGBPDAAA              Shawna             Glaser\n14  AAAAAAAAKGBPDAAA              Shawna             Glaser\n15  AAAAAAAAKGBPDAAA              Shawna             Glaser\n16  AAAAAAAAKGBPDAAA              Shawna             Glaser\n17  AAAAAAAAKGBPDAAA              Shawna             Glaser\n18  AAAAAAAAKGBPDAAA              Shawna             Glaser\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAOIGIGAAA               Pedro               Owen\n1   AAAAAAAAOIGIGAAA               Pedro               Owen\n2   AAAAAAAAOIGIGAAA               Pedro               Owen\n3   AAAAAAAAOIGIGAAA               Pedro               Owen\n4   AAAAAAAAOIGIGAAA               Pedro               Owen\n5   AAAAAAAAOIGIGAAA               Pedro               Owen\n6   AAAAAAAAOIGIGAAA               Pedro               Owen\n7   AAAAAAAAOIGIGAAA               Pedro               Owen\n8   AAAAAAAAOIGIGAAA               Pedro               Owen\n9   AAAAAAAAOIGIGAAA               Pedro               Owen\n10  AAAAAAAAOIGIGAAA               Pedro               Owen\n11  AAAAAAAAOIGIGAAA               Pedro               Owen\n12  AAAAAAAAOIGIGAAA               Pedro               Owen\n13  AAAAAAAAOIGIGAAA               Pedro               Owen\n14  AAAAAAAAOIGIGAAA               Pedro               Owen\n15  AAAAAAAAOIGIGAAA               Pedro               Owen\n16  AAAAAAAAOIGIGAAA               Pedro               Owen\n17  AAAAAAAAOIGIGAAA               Pedro               Owen\n18  AAAAAAAAOIGIGAAA               Pedro               Owen\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.040516,
                    "execution_time": 0.027615,
                    "compile_time": 0.000124,
                    "planning_time": 0.005022
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.081591,
                    "execution_time": 0.028565,
                    "compile_time": 0.000125,
                    "planning_time": 0.040466
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAOIGIGAAA               Pedro               Owen\n1   AAAAAAAAOIGIGAAA               Pedro               Owen\n2   AAAAAAAAOIGIGAAA               Pedro               Owen\n3   AAAAAAAAOIGIGAAA               Pedro               Owen\n4   AAAAAAAAOIGIGAAA               Pedro               Owen\n5   AAAAAAAAOIGIGAAA               Pedro               Owen\n6   AAAAAAAAOIGIGAAA               Pedro               Owen\n7   AAAAAAAAOIGIGAAA               Pedro               Owen\n8   AAAAAAAAOIGIGAAA               Pedro               Owen\n9   AAAAAAAAOIGIGAAA               Pedro               Owen\n10  AAAAAAAAOIGIGAAA               Pedro               Owen\n11  AAAAAAAAOIGIGAAA               Pedro               Owen\n12  AAAAAAAAOIGIGAAA               Pedro               Owen\n13  AAAAAAAAOIGIGAAA               Pedro               Owen\n14  AAAAAAAAOIGIGAAA               Pedro               Owen\n15  AAAAAAAAOIGIGAAA               Pedro               Owen\n16  AAAAAAAAOIGIGAAA               Pedro               Owen\n17  AAAAAAAAOIGIGAAA               Pedro               Owen\n18  AAAAAAAAOIGIGAAA               Pedro               Owen\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAKGBPDAAA              Shawna             Glaser\n1   AAAAAAAAKGBPDAAA              Shawna             Glaser\n2   AAAAAAAAKGBPDAAA              Shawna             Glaser\n3   AAAAAAAAKGBPDAAA              Shawna             Glaser\n4   AAAAAAAAKGBPDAAA              Shawna             Glaser\n5   AAAAAAAAKGBPDAAA              Shawna             Glaser\n6   AAAAAAAAKGBPDAAA              Shawna             Glaser\n7   AAAAAAAAKGBPDAAA              Shawna             Glaser\n8   AAAAAAAAKGBPDAAA              Shawna             Glaser\n9   AAAAAAAAKGBPDAAA              Shawna             Glaser\n10  AAAAAAAAKGBPDAAA              Shawna             Glaser\n11  AAAAAAAAKGBPDAAA              Shawna             Glaser\n12  AAAAAAAAKGBPDAAA              Shawna             Glaser\n13  AAAAAAAAKGBPDAAA              Shawna             Glaser\n14  AAAAAAAAKGBPDAAA              Shawna             Glaser\n15  AAAAAAAAKGBPDAAA              Shawna             Glaser\n16  AAAAAAAAKGBPDAAA              Shawna             Glaser\n17  AAAAAAAAKGBPDAAA              Shawna             Glaser\n18  AAAAAAAAKGBPDAAA              Shawna             Glaser\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.052489,
                    "execution_time": 0.037679,
                    "compile_time": 0.00017,
                    "planning_time": 0.005931
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.090591,
                    "execution_time": 0.038082,
                    "compile_time": 0.000188,
                    "planning_time": 0.0417
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAKGBPDAAA              Shawna             Glaser\n1   AAAAAAAAKGBPDAAA              Shawna             Glaser\n2   AAAAAAAAKGBPDAAA              Shawna             Glaser\n3   AAAAAAAAKGBPDAAA              Shawna             Glaser\n4   AAAAAAAAKGBPDAAA              Shawna             Glaser\n5   AAAAAAAAKGBPDAAA              Shawna             Glaser\n6   AAAAAAAAKGBPDAAA              Shawna             Glaser\n7   AAAAAAAAKGBPDAAA              Shawna             Glaser\n8   AAAAAAAAKGBPDAAA              Shawna             Glaser\n9   AAAAAAAAKGBPDAAA              Shawna             Glaser\n10  AAAAAAAAKGBPDAAA              Shawna             Glaser\n11  AAAAAAAAKGBPDAAA              Shawna             Glaser\n12  AAAAAAAAKGBPDAAA              Shawna             Glaser\n13  AAAAAAAAKGBPDAAA              Shawna             Glaser\n14  AAAAAAAAKGBPDAAA              Shawna             Glaser\n15  AAAAAAAAKGBPDAAA              Shawna             Glaser\n16  AAAAAAAAKGBPDAAA              Shawna             Glaser\n17  AAAAAAAAKGBPDAAA              Shawna             Glaser\n18  AAAAAAAAKGBPDAAA              Shawna             Glaser\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.836392,
                    "execution_time": 0.547465,
                    "compile_time": 0.000416,
                    "planning_time": 0.007449,
                    "create_size": 902
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.920136,
                    "execution_time": 0.567839,
                    "compile_time": 0.001543,
                    "planning_time": 0.064235,
                    "create_size": 902
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAKJOBGAAA             Delbert             Bryant\n1   AAAAAAAAKJOBGAAA             Delbert             Bryant\n2   AAAAAAAAKJOBGAAA             Delbert             Bryant\n3   AAAAAAAAKJOBGAAA             Delbert             Bryant\n4   AAAAAAAAKJOBGAAA             Delbert             Bryant\n5   AAAAAAAAKJOBGAAA             Delbert             Bryant\n6   AAAAAAAAKJOBGAAA             Delbert             Bryant\n7   AAAAAAAAKJOBGAAA             Delbert             Bryant\n8   AAAAAAAANMBNGAAA              Joshua            Griffin\n9   AAAAAAAAEOOKDAAA               James             Ransom\n10  AAAAAAAAEOOKDAAA               James             Ransom\n11  AAAAAAAAEOOKDAAA               James             Ransom\n12  AAAAAAAAEOOKDAAA               James             Ransom\n13  AAAAAAAAEOOKDAAA               James             Ransom\n14  AAAAAAAAEOOKDAAA               James             Ransom\n15  AAAAAAAAEOOKDAAA               James             Ransom\n16  AAAAAAAAEOOKDAAA               James             Ransom\n17  AAAAAAAAEOOKDAAA               James             Ransom\n18  AAAAAAAAEOOKDAAA               James             Ransom\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017423,
                    "execution_time": 0.008129,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003323
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054499,
                    "execution_time": 0.008233,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038573
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAKJOBGAAA             Delbert             Bryant\n1   AAAAAAAAKJOBGAAA             Delbert             Bryant\n2   AAAAAAAAKJOBGAAA             Delbert             Bryant\n3   AAAAAAAAKJOBGAAA             Delbert             Bryant\n4   AAAAAAAAKJOBGAAA             Delbert             Bryant\n5   AAAAAAAAKJOBGAAA             Delbert             Bryant\n6   AAAAAAAAKJOBGAAA             Delbert             Bryant\n7   AAAAAAAAKJOBGAAA             Delbert             Bryant\n8   AAAAAAAANMBNGAAA              Joshua            Griffin\n9   AAAAAAAAEOOKDAAA               James             Ransom\n10  AAAAAAAAEOOKDAAA               James             Ransom\n11  AAAAAAAAEOOKDAAA               James             Ransom\n12  AAAAAAAAEOOKDAAA               James             Ransom\n13  AAAAAAAAEOOKDAAA               James             Ransom\n14  AAAAAAAAEOOKDAAA               James             Ransom\n15  AAAAAAAAEOOKDAAA               James             Ransom\n16  AAAAAAAAEOOKDAAA               James             Ransom\n17  AAAAAAAAEOOKDAAA               James             Ransom\n18  AAAAAAAAEOOKDAAA               James             Ransom\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.971851,
                    "execution_time": 0.581749,
                    "compile_time": 0.000716,
                    "planning_time": 0.043738,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 35.837098,
                    "execution_time": 0.610355,
                    "compile_time": 0.000756,
                    "planning_time": 34.871576,
                    "create_size": 896
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.832684,
                    "execution_time": 0.499895,
                    "compile_time": 0.037287,
                    "planning_time": 0.008591,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.938528,
                    "execution_time": 0.482542,
                    "compile_time": 3.095365,
                    "planning_time": 0.065998,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAICOHBAAA              Ericka           Richmond\n1   AAAAAAAAPBPOCAAA               Carla              Moore\n2   AAAAAAAAPBPOCAAA               Carla              Moore\n3   AAAAAAAAPBPOCAAA               Carla              Moore\n4   AAAAAAAAPBPOCAAA               Carla              Moore\n5   AAAAAAAAPBPOCAAA               Carla              Moore\n6   AAAAAAAAPBPOCAAA               Carla              Moore\n7   AAAAAAAAPBPOCAAA               Carla              Moore\n8   AAAAAAAAPBPOCAAA               Carla              Moore\n9   AAAAAAAAOCLLBAAA                                  Jones\n10  AAAAAAAAOCLLBAAA                                  Jones\n11  AAAAAAAAOCLLBAAA                                  Jones\n12  AAAAAAAAOCLLBAAA                                  Jones\n13  AAAAAAAAOCLLBAAA                                  Jones\n14  AAAAAAAAOCLLBAAA                                  Jones\n15  AAAAAAAAOCLLBAAA                                  Jones\n16  AAAAAAAAOCLLBAAA                                  Jones\n17  AAAAAAAALIONFAAA             Georgia              Ohara\n18  AAAAAAAALIONFAAA             Georgia              Ohara\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017081,
                    "execution_time": 0.007542,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003428
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056073,
                    "execution_time": 0.007775,
                    "compile_time": 5e-05,
                    "planning_time": 0.038979
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAICOHBAAA              Ericka           Richmond\n1   AAAAAAAAPBPOCAAA               Carla              Moore\n2   AAAAAAAAPBPOCAAA               Carla              Moore\n3   AAAAAAAAPBPOCAAA               Carla              Moore\n4   AAAAAAAAPBPOCAAA               Carla              Moore\n5   AAAAAAAAPBPOCAAA               Carla              Moore\n6   AAAAAAAAPBPOCAAA               Carla              Moore\n7   AAAAAAAAPBPOCAAA               Carla              Moore\n8   AAAAAAAAPBPOCAAA               Carla              Moore\n9   AAAAAAAAOCLLBAAA                                  Jones\n10  AAAAAAAAOCLLBAAA                                  Jones\n11  AAAAAAAAOCLLBAAA                                  Jones\n12  AAAAAAAAOCLLBAAA                                  Jones\n13  AAAAAAAAOCLLBAAA                                  Jones\n14  AAAAAAAAOCLLBAAA                                  Jones\n15  AAAAAAAAOCLLBAAA                                  Jones\n16  AAAAAAAAOCLLBAAA                                  Jones\n17  AAAAAAAALIONFAAA             Georgia              Ohara\n18  AAAAAAAALIONFAAA             Georgia              Ohara\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAKCEOBAAA               Olene           Richards\n1   AAAAAAAAKCEOBAAA               Olene           Richards\n2   AAAAAAAAKCEOBAAA               Olene           Richards\n3   AAAAAAAAKCEOBAAA               Olene           Richards\n4   AAAAAAAAKCEOBAAA               Olene           Richards\n5   AAAAAAAAKCEOBAAA               Olene           Richards\n6   AAAAAAAAKCEOBAAA               Olene           Richards\n7   AAAAAAAAKCEOBAAA               Olene           Richards\n8   AAAAAAAAKCEOBAAA               Olene           Richards\n9   AAAAAAAAKCEOBAAA               Olene           Richards\n10  AAAAAAAAKCEOBAAA               Olene           Richards\n11  AAAAAAAAKCEOBAAA               Olene           Richards\n12  AAAAAAAAKCEOBAAA               Olene           Richards\n13  AAAAAAAAKCEOBAAA               Olene           Richards\n14  AAAAAAAAKCEOBAAA               Olene           Richards\n15  AAAAAAAAKCEOBAAA               Olene           Richards\n16  AAAAAAAAKCEOBAAA               Olene           Richards\n17  AAAAAAAAKCEOBAAA               Olene           Richards\n18  AAAAAAAAKCEOBAAA               Olene           Richards\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.028346,
                    "execution_time": 0.01615,
                    "compile_time": 8.7e-05,
                    "planning_time": 0.004943
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.068096,
                    "execution_time": 0.016774,
                    "compile_time": 9e-05,
                    "planning_time": 0.040502
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w'"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAKCEOBAAA               Olene           Richards\n1   AAAAAAAAKCEOBAAA               Olene           Richards\n2   AAAAAAAAKCEOBAAA               Olene           Richards\n3   AAAAAAAAKCEOBAAA               Olene           Richards\n4   AAAAAAAAKCEOBAAA               Olene           Richards\n5   AAAAAAAAKCEOBAAA               Olene           Richards\n6   AAAAAAAAKCEOBAAA               Olene           Richards\n7   AAAAAAAAKCEOBAAA               Olene           Richards\n8   AAAAAAAAKCEOBAAA               Olene           Richards\n9   AAAAAAAAKCEOBAAA               Olene           Richards\n10  AAAAAAAAKCEOBAAA               Olene           Richards\n11  AAAAAAAAKCEOBAAA               Olene           Richards\n12  AAAAAAAAKCEOBAAA               Olene           Richards\n13  AAAAAAAAKCEOBAAA               Olene           Richards\n14  AAAAAAAAKCEOBAAA               Olene           Richards\n15  AAAAAAAAKCEOBAAA               Olene           Richards\n16  AAAAAAAAKCEOBAAA               Olene           Richards\n17  AAAAAAAAKCEOBAAA               Olene           Richards\n18  AAAAAAAAKCEOBAAA               Olene           Richards\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAANGAACAAA                 Roy            English\n1   AAAAAAAANGAACAAA                 Roy            English\n2   AAAAAAAANGAACAAA                 Roy            English\n3   AAAAAAAANGAACAAA                 Roy            English\n4   AAAAAAAANGAACAAA                 Roy            English\n5   AAAAAAAANGAACAAA                 Roy            English\n6   AAAAAAAANGAACAAA                 Roy            English\n7   AAAAAAAANGAACAAA                 Roy            English\n8   AAAAAAAANGAACAAA                 Roy            English\n9   AAAAAAAANGAACAAA                 Roy            English\n10  AAAAAAAANGAACAAA                 Roy            English\n11  AAAAAAAANGAACAAA                 Roy            English\n12  AAAAAAAANGAACAAA                 Roy            English\n13  AAAAAAAANGAACAAA                 Roy            English\n14  AAAAAAAANGAACAAA                 Roy            English\n15  AAAAAAAANGAACAAA                 Roy            English\n16  AAAAAAAANGAACAAA                 Roy            English\n17  AAAAAAAANGAACAAA                 Roy            English\n18  AAAAAAAADNEPDAAA               Molly             Lester\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.413127,
                    "execution_time": 0.398309,
                    "compile_time": 0.000149,
                    "planning_time": 0.006205
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.450664,
                    "execution_time": 0.396361,
                    "compile_time": 0.000164,
                    "planning_time": 0.042157
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w'"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAANGAACAAA                 Roy            English\n1   AAAAAAAANGAACAAA                 Roy            English\n2   AAAAAAAANGAACAAA                 Roy            English\n3   AAAAAAAANGAACAAA                 Roy            English\n4   AAAAAAAANGAACAAA                 Roy            English\n5   AAAAAAAANGAACAAA                 Roy            English\n6   AAAAAAAANGAACAAA                 Roy            English\n7   AAAAAAAANGAACAAA                 Roy            English\n8   AAAAAAAANGAACAAA                 Roy            English\n9   AAAAAAAANGAACAAA                 Roy            English\n10  AAAAAAAANGAACAAA                 Roy            English\n11  AAAAAAAANGAACAAA                 Roy            English\n12  AAAAAAAANGAACAAA                 Roy            English\n13  AAAAAAAANGAACAAA                 Roy            English\n14  AAAAAAAANGAACAAA                 Roy            English\n15  AAAAAAAANGAACAAA                 Roy            English\n16  AAAAAAAANGAACAAA                 Roy            English\n17  AAAAAAAANGAACAAA                 Roy            English\n18  AAAAAAAADNEPDAAA               Molly             Lester\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAANGAACAAA                 Roy            English\n1   AAAAAAAANGAACAAA                 Roy            English\n2   AAAAAAAANGAACAAA                 Roy            English\n3   AAAAAAAANGAACAAA                 Roy            English\n4   AAAAAAAANGAACAAA                 Roy            English\n5   AAAAAAAANGAACAAA                 Roy            English\n6   AAAAAAAANGAACAAA                 Roy            English\n7   AAAAAAAANGAACAAA                 Roy            English\n8   AAAAAAAANGAACAAA                 Roy            English\n9   AAAAAAAANGAACAAA                 Roy            English\n10  AAAAAAAANGAACAAA                 Roy            English\n11  AAAAAAAANGAACAAA                 Roy            English\n12  AAAAAAAANGAACAAA                 Roy            English\n13  AAAAAAAANGAACAAA                 Roy            English\n14  AAAAAAAANGAACAAA                 Roy            English\n15  AAAAAAAANGAACAAA                 Roy            English\n16  AAAAAAAANGAACAAA                 Roy            English\n17  AAAAAAAANGAACAAA                 Roy            English\n18  AAAAAAAADNEPDAAA               Molly             Lester\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.47403,
                    "execution_time": 0.457171,
                    "compile_time": 0.000209,
                    "planning_time": 0.007276
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.477354,
                    "execution_time": 0.415662,
                    "compile_time": 0.001057,
                    "planning_time": 0.043641
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w'"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAANGAACAAA                 Roy            English\n1   AAAAAAAANGAACAAA                 Roy            English\n2   AAAAAAAANGAACAAA                 Roy            English\n3   AAAAAAAANGAACAAA                 Roy            English\n4   AAAAAAAANGAACAAA                 Roy            English\n5   AAAAAAAANGAACAAA                 Roy            English\n6   AAAAAAAANGAACAAA                 Roy            English\n7   AAAAAAAANGAACAAA                 Roy            English\n8   AAAAAAAANGAACAAA                 Roy            English\n9   AAAAAAAANGAACAAA                 Roy            English\n10  AAAAAAAANGAACAAA                 Roy            English\n11  AAAAAAAANGAACAAA                 Roy            English\n12  AAAAAAAANGAACAAA                 Roy            English\n13  AAAAAAAANGAACAAA                 Roy            English\n14  AAAAAAAANGAACAAA                 Roy            English\n15  AAAAAAAANGAACAAA                 Roy            English\n16  AAAAAAAANGAACAAA                 Roy            English\n17  AAAAAAAANGAACAAA                 Roy            English\n18  AAAAAAAADNEPDAAA               Molly             Lester\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.141041,
                    "execution_time": 0.719534,
                    "compile_time": 0.000835,
                    "planning_time": 0.043376,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.246083,
                    "execution_time": 0.737923,
                    "compile_time": 0.000846,
                    "planning_time": 0.128544,
                    "create_size": 1024
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.430447,
                    "execution_time": 0.132194,
                    "compile_time": 0.000461,
                    "planning_time": 0.010964,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.496352,
                    "execution_time": 0.131814,
                    "compile_time": 0.002553,
                    "planning_time": 0.071739,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAGAEGDAAA               Diana              Lewis\n1   AAAAAAAAJAIEHAAA              Freddy              Moore\n2   AAAAAAAACGIOAAAA             Melinda              Brown\n3   AAAAAAAAAKIEFAAA            Katheryn            Carbone\n4   AAAAAAAALLOCEAAA                Hugh             Palmer\n5   AAAAAAAAMAEBEAAA               Renee                   \n6   AAAAAAAAPLCHBAAA                Joey          Stevenson\n7   AAAAAAAANPMEGAAA             Zachary             Wilcox\n8   AAAAAAAAPMAGCAAA              Selena          Henderson\n9   AAAAAAAAMLOJBAAA               Shawn              Coley\n10  AAAAAAAAIAECAAAA               Alvin             Medina\n11  AAAAAAAACCHJGAAA             Eleanor            Luckett\n12  AAAAAAAANIMKCAAA            Lawrence           Delarosa\n13  AAAAAAAAMCIAEAAA                                  Walsh\n14  AAAAAAAAOCBBEAAA             Loretta          Fernandez\n15  AAAAAAAAHAKHHAAA                Opal           Mckinney\n16  AAAAAAAAHJHNEAAA             Richard             Kinard\n17  AAAAAAAAMGDAHAAA              Alysha             Reiter\n18  AAAAAAAAEIKHDAAA                Teri          Clevenger\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016588,
                    "execution_time": 0.007199,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.00353
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05598,
                    "execution_time": 0.007779,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.038944
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAGAEGDAAA               Diana              Lewis\n1   AAAAAAAAJAIEHAAA              Freddy              Moore\n2   AAAAAAAACGIOAAAA             Melinda              Brown\n3   AAAAAAAAAKIEFAAA            Katheryn            Carbone\n4   AAAAAAAALLOCEAAA                Hugh             Palmer\n5   AAAAAAAAMAEBEAAA               Renee                   \n6   AAAAAAAAPLCHBAAA                Joey          Stevenson\n7   AAAAAAAANPMEGAAA             Zachary             Wilcox\n8   AAAAAAAAPMAGCAAA              Selena          Henderson\n9   AAAAAAAAMLOJBAAA               Shawn              Coley\n10  AAAAAAAAIAECAAAA               Alvin             Medina\n11  AAAAAAAACCHJGAAA             Eleanor            Luckett\n12  AAAAAAAANIMKCAAA            Lawrence           Delarosa\n13  AAAAAAAAMCIAEAAA                                  Walsh\n14  AAAAAAAAOCBBEAAA             Loretta          Fernandez\n15  AAAAAAAAHAKHHAAA                Opal           Mckinney\n16  AAAAAAAAHJHNEAAA             Richard             Kinard\n17  AAAAAAAAMGDAHAAA              Alysha             Reiter\n18  AAAAAAAAEIKHDAAA                Teri          Clevenger\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAABMEHBAAA                Carl            Jackson\n1   AAAAAAAAGNEOBAAA              Robert          Velazquez\n2   AAAAAAAABBJEDAAA                                       \n3   AAAAAAAAEKDHCAAA                John         Richardson\n4   AAAAAAAAEKDHCAAA                John         Richardson\n5   AAAAAAAAEKDHCAAA                John         Richardson\n6   AAAAAAAAEKDHCAAA                John         Richardson\n7   AAAAAAAAFECJGAAA             Patrick             Miller\n8   AAAAAAAAFEIBHAAA               Mitzi            Edwards\n9   AAAAAAAAIEICGAAA               Betty           Moreland\n10  AAAAAAAANHEGCAAA             Charles                Han\n11  AAAAAAAAFNKKGAAA              Manuel             Miller\n12  AAAAAAAAKJNFAAAA                John              Brown\n13  AAAAAAAADENOEAAA               Kathy             Crouse\n14  AAAAAAAAGGJBHAAA              Johnny            Paulson\n15  AAAAAAAANGCODAAA           Guadalupe             Nelson\n16  AAAAAAAANBLLAAAA               Brian               Love\n17  AAAAAAAANBLLAAAA               Brian               Love\n18  AAAAAAAANBLLAAAA               Brian               Love\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.04271,
                    "execution_time": 0.028458,
                    "compile_time": 9.3e-05,
                    "planning_time": 0.005085
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.177975,
                    "execution_time": 0.029816,
                    "compile_time": 0.118146,
                    "planning_time": 0.040639
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAABMEHBAAA                Carl            Jackson\n1   AAAAAAAAGNEOBAAA              Robert          Velazquez\n2   AAAAAAAABBJEDAAA                                       \n3   AAAAAAAAEKDHCAAA                John         Richardson\n4   AAAAAAAAEKDHCAAA                John         Richardson\n5   AAAAAAAAEKDHCAAA                John         Richardson\n6   AAAAAAAAEKDHCAAA                John         Richardson\n7   AAAAAAAAFECJGAAA             Patrick             Miller\n8   AAAAAAAAFEIBHAAA               Mitzi            Edwards\n9   AAAAAAAAIEICGAAA               Betty           Moreland\n10  AAAAAAAANHEGCAAA             Charles                Han\n11  AAAAAAAAFNKKGAAA              Manuel             Miller\n12  AAAAAAAAKJNFAAAA                John              Brown\n13  AAAAAAAADENOEAAA               Kathy             Crouse\n14  AAAAAAAAGGJBHAAA              Johnny            Paulson\n15  AAAAAAAANGCODAAA           Guadalupe             Nelson\n16  AAAAAAAANBLLAAAA               Brian               Love\n17  AAAAAAAANBLLAAAA               Brian               Love\n18  AAAAAAAANBLLAAAA               Brian               Love\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAJOKAGAAA               James              Comer\n1   AAAAAAAAJOKAGAAA               James              Comer\n2   AAAAAAAAJOKAGAAA               James              Comer\n3   AAAAAAAAJOKAGAAA               James              Comer\n4   AAAAAAAAJOKAGAAA               James              Comer\n5   AAAAAAAAJOKAGAAA               James              Comer\n6   AAAAAAAAJOKAGAAA               James              Comer\n7   AAAAAAAAJOKAGAAA               James              Comer\n8   AAAAAAAAJOKAGAAA               James              Comer\n9   AAAAAAAAJOKAGAAA               James              Comer\n10  AAAAAAAAJOKAGAAA               James              Comer\n11  AAAAAAAAJOKAGAAA               James              Comer\n12  AAAAAAAAJOKAGAAA               James              Comer\n13  AAAAAAAAJOKAGAAA               James              Comer\n14  AAAAAAAAJOKAGAAA               James              Comer\n15  AAAAAAAAJOKAGAAA               James              Comer\n16  AAAAAAAAJOKAGAAA               James              Comer\n17  AAAAAAAAJOKAGAAA               James              Comer\n18  AAAAAAAAJOKAGAAA               James              Comer\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.063596,
                    "execution_time": 0.038637,
                    "compile_time": 0.030478,
                    "planning_time": 0.00645
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.3782,
                    "execution_time": 0.037713,
                    "compile_time": 3.304123,
                    "planning_time": 0.04211
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR\" = 1998"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAJOKAGAAA               James              Comer\n1   AAAAAAAAJOKAGAAA               James              Comer\n2   AAAAAAAAJOKAGAAA               James              Comer\n3   AAAAAAAAJOKAGAAA               James              Comer\n4   AAAAAAAAJOKAGAAA               James              Comer\n5   AAAAAAAAJOKAGAAA               James              Comer\n6   AAAAAAAAJOKAGAAA               James              Comer\n7   AAAAAAAAJOKAGAAA               James              Comer\n8   AAAAAAAAJOKAGAAA               James              Comer\n9   AAAAAAAAJOKAGAAA               James              Comer\n10  AAAAAAAAJOKAGAAA               James              Comer\n11  AAAAAAAAJOKAGAAA               James              Comer\n12  AAAAAAAAJOKAGAAA               James              Comer\n13  AAAAAAAAJOKAGAAA               James              Comer\n14  AAAAAAAAJOKAGAAA               James              Comer\n15  AAAAAAAAJOKAGAAA               James              Comer\n16  AAAAAAAAJOKAGAAA               James              Comer\n17  AAAAAAAAJOKAGAAA               James              Comer\n18  AAAAAAAAJOKAGAAA               James              Comer\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n         and t_w_secyear.year = 1998+1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"YEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"YEAR\" = 1999 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAJOKAGAAA               James              Comer\n1   AAAAAAAAJOKAGAAA               James              Comer\n2   AAAAAAAAJOKAGAAA               James              Comer\n3   AAAAAAAAJOKAGAAA               James              Comer\n4   AAAAAAAAJOKAGAAA               James              Comer\n5   AAAAAAAAJOKAGAAA               James              Comer\n6   AAAAAAAAJOKAGAAA               James              Comer\n7   AAAAAAAAJOKAGAAA               James              Comer\n8   AAAAAAAAJOKAGAAA               James              Comer\n9   AAAAAAAAJOKAGAAA               James              Comer\n10  AAAAAAAAJOKAGAAA               James              Comer\n11  AAAAAAAAJOKAGAAA               James              Comer\n12  AAAAAAAAJOKAGAAA               James              Comer\n13  AAAAAAAAJOKAGAAA               James              Comer\n14  AAAAAAAAJOKAGAAA               James              Comer\n15  AAAAAAAAJOKAGAAA               James              Comer\n16  AAAAAAAAJOKAGAAA               James              Comer\n17  AAAAAAAAJOKAGAAA               James              Comer\n18  AAAAAAAAJOKAGAAA               James              Comer\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.118898,
                    "execution_time": 0.056899,
                    "compile_time": 0.042105,
                    "planning_time": 0.008243
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.400873,
                    "execution_time": 0.051904,
                    "compile_time": 3.277114,
                    "planning_time": 0.044309
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"YEAR\" = 1999"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAJOKAGAAA               James              Comer\n1   AAAAAAAAJOKAGAAA               James              Comer\n2   AAAAAAAAJOKAGAAA               James              Comer\n3   AAAAAAAAJOKAGAAA               James              Comer\n4   AAAAAAAAJOKAGAAA               James              Comer\n5   AAAAAAAAJOKAGAAA               James              Comer\n6   AAAAAAAAJOKAGAAA               James              Comer\n7   AAAAAAAAJOKAGAAA               James              Comer\n8   AAAAAAAAJOKAGAAA               James              Comer\n9   AAAAAAAAJOKAGAAA               James              Comer\n10  AAAAAAAAJOKAGAAA               James              Comer\n11  AAAAAAAAJOKAGAAA               James              Comer\n12  AAAAAAAAJOKAGAAA               James              Comer\n13  AAAAAAAAJOKAGAAA               James              Comer\n14  AAAAAAAAJOKAGAAA               James              Comer\n15  AAAAAAAAJOKAGAAA               James              Comer\n16  AAAAAAAAJOKAGAAA               James              Comer\n17  AAAAAAAAJOKAGAAA               James              Comer\n18  AAAAAAAAJOKAGAAA               James              Comer\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n         and t_w_secyear.year = 1998+1\n         and t_s_firstyear.year_total > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.391778,
                    "execution_time": 0.772532,
                    "compile_time": 0.000956,
                    "planning_time": 0.046325,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.480268,
                    "execution_time": 0.770781,
                    "compile_time": 0.000909,
                    "planning_time": 0.131938,
                    "create_size": 1152
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.276571,
                    "execution_time": 0.092742,
                    "compile_time": 0.128308,
                    "planning_time": 0.013174,
                    "create_size": 78
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.530235,
                    "execution_time": 0.108712,
                    "compile_time": 10.30561,
                    "planning_time": 0.07195,
                    "create_size": 78
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAJDMLDAAA                 Jan             Cooper\n1   AAAAAAAAONAHFAAA              Travis           Thompson\n2   AAAAAAAAJLKJGAAA              Bonnie             Hodges\n3   AAAAAAAAHEEDCAAA              Joshua              Brown\n4   AAAAAAAAGMBDFAAA             Marilyn             Rogers\n5   AAAAAAAAMFPHGAAA             Krystle              Hatch\n6   AAAAAAAAJLFLFAAA             Rebecca             Piazza\n7   AAAAAAAAFKGPGAAA            Benjamin              Davis\n8   AAAAAAAAJGJMFAAA                Fred              Parks\n9   AAAAAAAAPIHMBAAA                 Jim                   \n10  AAAAAAAALNNOEAAA            Jeanette            Higgins\n11  AAAAAAAAHJMCGAAA              Bertha            Edwards\n12  AAAAAAAAHGEJHAAA              Teresa             Holder\n13  AAAAAAAALOLCBAAA              Austin               Lowe\n14  AAAAAAAABIPNGAAA                Jose             Martin\n15  AAAAAAAAIBNLAAAA               Nelly             Butler\n16  AAAAAAAAKELOFAAA               Linda            Blalock\n17  AAAAAAAAAADHFAAA                Dave             Horton\n18  AAAAAAAAAJBMGAAA              Donald               Shaw\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016965,
                    "execution_time": 0.007425,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003442
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05381,
                    "execution_time": 0.007136,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.038973
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAJDMLDAAA                 Jan             Cooper\n1   AAAAAAAAONAHFAAA              Travis           Thompson\n2   AAAAAAAAJLKJGAAA              Bonnie             Hodges\n3   AAAAAAAAHEEDCAAA              Joshua              Brown\n4   AAAAAAAAGMBDFAAA             Marilyn             Rogers\n5   AAAAAAAAMFPHGAAA             Krystle              Hatch\n6   AAAAAAAAJLFLFAAA             Rebecca             Piazza\n7   AAAAAAAAFKGPGAAA            Benjamin              Davis\n8   AAAAAAAAJGJMFAAA                Fred              Parks\n9   AAAAAAAAPIHMBAAA                 Jim                   \n10  AAAAAAAALNNOEAAA            Jeanette            Higgins\n11  AAAAAAAAHJMCGAAA              Bertha            Edwards\n12  AAAAAAAAHGEJHAAA              Teresa             Holder\n13  AAAAAAAALOLCBAAA              Austin               Lowe\n14  AAAAAAAABIPNGAAA                Jose             Martin\n15  AAAAAAAAIBNLAAAA               Nelly             Butler\n16  AAAAAAAAKELOFAAA               Linda            Blalock\n17  AAAAAAAAAADHFAAA                Dave             Horton\n18  AAAAAAAAAJBMGAAA              Donald               Shaw\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n         and t_w_secyear.year = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAJCCABAAA               Brian          Stapleton\n1   AAAAAAAABAEHEAAA           Christine               Levy\n2   AAAAAAAAOJMLDAAA                 Lea               Carr\n3   AAAAAAAAHJJDBAAA              Daniel              Hicks\n4   AAAAAAAAOBPFGAAA                 Tim          Hernandez\n5   AAAAAAAAJAAKCAAA                 Amy             Roller\n6   AAAAAAAAIOPECAAA              Joseph               Kane\n7   AAAAAAAADFGFBAAA               Larry              Scott\n8   AAAAAAAAPHCKCAAA                Lisa             Thomas\n9   AAAAAAAACOMLBAAA                Inez             Blanks\n10  AAAAAAAAHDFADAAA                Jose            Dockery\n11  AAAAAAAAAMGHDAAA              Robert           Ingraham\n12  AAAAAAAAFEBCAAAA                Lyle              Ricci\n13  AAAAAAAACJFECAAA                Dana            Salazar\n14  AAAAAAAADONIBAAA               Roger                Gil\n15  AAAAAAAAKAKNAAAA               James            Roberts\n16  AAAAAAAAIMEOGAAA               Bryon          Francisco\n17  AAAAAAAAAAMAGAAA               Hilda             Hanson\n18  AAAAAAAAPBKPBAAA               Linda             Butler\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.02978,
                    "execution_time": 0.014959,
                    "compile_time": 0.000101,
                    "planning_time": 0.006353
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.067201,
                    "execution_time": 0.015425,
                    "compile_time": 9.8e-05,
                    "planning_time": 0.040619
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAJCCABAAA               Brian          Stapleton\n1   AAAAAAAABAEHEAAA           Christine               Levy\n2   AAAAAAAAOJMLDAAA                 Lea               Carr\n3   AAAAAAAAHJJDBAAA              Daniel              Hicks\n4   AAAAAAAAOBPFGAAA                 Tim          Hernandez\n5   AAAAAAAAJAAKCAAA                 Amy             Roller\n6   AAAAAAAAIOPECAAA              Joseph               Kane\n7   AAAAAAAADFGFBAAA               Larry              Scott\n8   AAAAAAAAPHCKCAAA                Lisa             Thomas\n9   AAAAAAAACOMLBAAA                Inez             Blanks\n10  AAAAAAAAHDFADAAA                Jose            Dockery\n11  AAAAAAAAAMGHDAAA              Robert           Ingraham\n12  AAAAAAAAFEBCAAAA                Lyle              Ricci\n13  AAAAAAAACJFECAAA                Dana            Salazar\n14  AAAAAAAADONIBAAA               Roger                Gil\n15  AAAAAAAAKAKNAAAA               James            Roberts\n16  AAAAAAAAIMEOGAAA               Bryon          Francisco\n17  AAAAAAAAAAMAGAAA               Hilda             Hanson\n18  AAAAAAAAPBKPBAAA               Linda             Butler\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n         and t_w_secyear.year = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0 end > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0 END > 0 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0 END > 0 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.269068,
                    "execution_time": 0.089102,
                    "compile_time": 0.120421,
                    "planning_time": 0.014773,
                    "create_size": 78
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.544419,
                    "execution_time": 0.109651,
                    "compile_time": 10.305138,
                    "planning_time": 0.073692,
                    "create_size": 78
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAABFOJCAAA                 Pam            Hundley\n1   AAAAAAAAAKDPEAAA                Ryan           Bertrand\n2   AAAAAAAAGIDCAAAA             Stephen            Sanders\n3   AAAAAAAAOILLCAAA              Shelly              Jones\n4   AAAAAAAAEHEOGAAA             William            Seymour\n5   AAAAAAAACBGCDAAA                Eric             Nelson\n6   AAAAAAAALEGPBAAA              Pamela             Alfaro\n7   AAAAAAAADGJGHAAA           Geraldine          Cavanaugh\n8   AAAAAAAAPEAKCAAA                Jane               Lara\n9   AAAAAAAAOFPHFAAA             Dorothy            Coleman\n10  AAAAAAAADNNEHAAA              Marcie               Bell\n11  AAAAAAAAOHEBEAAA                Ruby           Williams\n12  AAAAAAAABBLPCAAA              Nathan               Wong\n13  AAAAAAAAKLGIEAAA             Cynthia               Owen\n14  AAAAAAAADLKIGAAA                 Tom                   \n15  AAAAAAAACHMIHAAA              Tammie          Hernandez\n16  AAAAAAAALCOAFAAA                Paul              Gamez\n17  AAAAAAAAFKGOBAAA                Abby             Gordon\n18  AAAAAAAAJJGAEAAA              Jayson            Navarro\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016439,
                    "execution_time": 0.006849,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003489
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053057,
                    "execution_time": 0.007014,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038836
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0 END > 0 WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAABFOJCAAA                 Pam            Hundley\n1   AAAAAAAAAKDPEAAA                Ryan           Bertrand\n2   AAAAAAAAGIDCAAAA             Stephen            Sanders\n3   AAAAAAAAOILLCAAA              Shelly              Jones\n4   AAAAAAAAEHEOGAAA             William            Seymour\n5   AAAAAAAACBGCDAAA                Eric             Nelson\n6   AAAAAAAALEGPBAAA              Pamela             Alfaro\n7   AAAAAAAADGJGHAAA           Geraldine          Cavanaugh\n8   AAAAAAAAPEAKCAAA                Jane               Lara\n9   AAAAAAAAOFPHFAAA             Dorothy            Coleman\n10  AAAAAAAADNNEHAAA              Marcie               Bell\n11  AAAAAAAAOHEBEAAA                Ruby           Williams\n12  AAAAAAAABBLPCAAA              Nathan               Wong\n13  AAAAAAAAKLGIEAAA             Cynthia               Owen\n14  AAAAAAAADLKIGAAA                 Tom                   \n15  AAAAAAAACHMIHAAA              Tammie          Hernandez\n16  AAAAAAAALCOAFAAA                Paul              Gamez\n17  AAAAAAAAFKGOBAAA                Abby             Gordon\n18  AAAAAAAAJJGAEAAA              Jayson            Navarro\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n         and t_w_secyear.year = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.27088,
                    "execution_time": 0.09237,
                    "compile_time": 0.123503,
                    "planning_time": 0.015828,
                    "create_size": 48
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 13.216195,
                    "execution_time": 0.110943,
                    "compile_time": 12.985841,
                    "planning_time": 0.076778,
                    "create_size": 48
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAABPLKDAAA               Irene               Cook\n1   AAAAAAAALMDIDAAA               Susan              Brown\n2   AAAAAAAAEGAIFAAA                Lucy           Arellano\n3   AAAAAAAALDBNCAAA             Celeste             Barnes\n4   AAAAAAAAOKMMCAAA                Earl               Cain\n5   AAAAAAAACLLDDAAA                 Roy           Lawrence\n6   AAAAAAAAALPACAAA               Nicol              Davis\n7   AAAAAAAAIBGGBAAA              Carlos             Prince\n8   AAAAAAAAJOPCFAAA              Justin               Bray\n9   AAAAAAAALMBNEAAA                Ruth           Gonzalez\n10  AAAAAAAAJPNHDAAA              Laurie          Rodrigues\n11  AAAAAAAAEKNBDAAA                Fred            Roberts\n12  AAAAAAAAIFAOAAAA                 Ray             Morgan\n13  AAAAAAAABFLMAAAA           Elizabeth               Fine\n14  AAAAAAAABFNCGAAA            Benjamin          Rodriquez\n15  AAAAAAAAHKDPBAAA               David             Wilson\n16  AAAAAAAAHLHFCAAA               Joyce              Ricci\n17  AAAAAAAABLCCBAAA          Bernadette            Wiggins\n18  AAAAAAAAKNNEEAAA            Jonathan            Clawson\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017299,
                    "execution_time": 0.007592,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003446
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054962,
                    "execution_time": 0.007003,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.03916
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAABPLKDAAA               Irene               Cook\n1   AAAAAAAALMDIDAAA               Susan              Brown\n2   AAAAAAAAEGAIFAAA                Lucy           Arellano\n3   AAAAAAAALDBNCAAA             Celeste             Barnes\n4   AAAAAAAAOKMMCAAA                Earl               Cain\n5   AAAAAAAACLLDDAAA                 Roy           Lawrence\n6   AAAAAAAAALPACAAA               Nicol              Davis\n7   AAAAAAAAIBGGBAAA              Carlos             Prince\n8   AAAAAAAAJOPCFAAA              Justin               Bray\n9   AAAAAAAALMBNEAAA                Ruth           Gonzalez\n10  AAAAAAAAJPNHDAAA              Laurie          Rodrigues\n11  AAAAAAAAEKNBDAAA                Fred            Roberts\n12  AAAAAAAAIFAOAAAA                 Ray             Morgan\n13  AAAAAAAABFLMAAAA           Elizabeth               Fine\n14  AAAAAAAABFNCGAAA            Benjamin          Rodriquez\n15  AAAAAAAAHKDPBAAA               David             Wilson\n16  AAAAAAAAHLHFCAAA               Joyce              Ricci\n17  AAAAAAAABLCCBAAA          Bernadette            Wiggins\n18  AAAAAAAAKNNEEAAA            Jonathan            Clawson\n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n         and t_w_secyear.year = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n order by 2,3,1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"CUSTOMER_FIRST_NAME\" NULLS LAST , \"CUSTOMER_LAST_NAME\" NULLS LAST , \"CUSTOMER_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER_LAST_NAME\" , \"CUSTOMER_ID\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAAAHNDAAA                                       \n1   AAAAAAAAABIABAAA                                       \n2   AAAAAAAAAEAMBAAA                                       \n3   AAAAAAAAAGMHBAAA                                       \n4   AAAAAAAAAKIJFAAA                                       \n5   AAAAAAAAAOGCAAAA                                       \n6   AAAAAAAAAPGDHAAA                                       \n7   AAAAAAAABDMMEAAA                                       \n8   AAAAAAAABEONFAAA                                       \n9   AAAAAAAABKNHGAAA                                       \n10  AAAAAAAABOPJFAAA                                       \n11  AAAAAAAABPLEFAAA                                       \n12  AAAAAAAACAAPBAAA                                       \n13  AAAAAAAACILIBAAA                                       \n14  AAAAAAAADBEDFAAA                                       \n15  AAAAAAAADFPNFAAA                                       \n16  AAAAAAAADLAPAAAA                                       \n17  AAAAAAAADMNDFAAA                                       \n18  AAAAAAAADOLIGAAA                                       \n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019877,
                    "execution_time": 0.009743,
                    "compile_time": 8.1e-05,
                    "planning_time": 0.003851
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056313,
                    "execution_time": 0.009195,
                    "compile_time": 7.6e-05,
                    "planning_time": 0.039151
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"CUSTOMER_FIRST_NAME\" NULLS LAST , \"CUSTOMER_LAST_NAME\" NULLS LAST , \"CUSTOMER_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"CUSTOMER_FIRST_NAME\" NULLS LAST , \"CUSTOMER_LAST_NAME\" NULLS LAST , \"CUSTOMER_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAAAHNDAAA                                       \n1   AAAAAAAAABIABAAA                                       \n2   AAAAAAAAAEAMBAAA                                       \n3   AAAAAAAAAGMHBAAA                                       \n4   AAAAAAAAAKIJFAAA                                       \n5   AAAAAAAAAOGCAAAA                                       \n6   AAAAAAAAAPGDHAAA                                       \n7   AAAAAAAABDMMEAAA                                       \n8   AAAAAAAABEONFAAA                                       \n9   AAAAAAAABKNHGAAA                                       \n10  AAAAAAAABOPJFAAA                                       \n11  AAAAAAAABPLEFAAA                                       \n12  AAAAAAAACAAPBAAA                                       \n13  AAAAAAAACILIBAAA                                       \n14  AAAAAAAADBEDFAAA                                       \n15  AAAAAAAADFPNFAAA                                       \n16  AAAAAAAADLAPAAAA                                       \n17  AAAAAAAADMNDFAAA                                       \n18  AAAAAAAADOLIGAAA                                       \n...*/"
    },
    {
        "input": "-- start template query74.tpl query 76 in stream 0\nwith /* TPC-DS query74.tpl 0.76 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ss_net_paid) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,d_year as year\n       ,max(ws_net_paid) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n   and d_year in (1998,1998+1)\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,d_year\n         )\n  select \n        t_s_secyear.customer_id, t_s_secyear.customer_first_name, t_s_secyear.customer_last_name\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.year = 1998\n         and t_s_secyear.year = 1998+1\n         and t_w_firstyear.year = 1998\n         and t_w_secyear.year = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n order by 2,3,1\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" IN ( 1998 , 1999 ) ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"YEAR\" , MAX ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"CUSTOMER_FIRST_NAME\" NULLS LAST , \"CUSTOMER_LAST_NAME\" NULLS LAST , \"CUSTOMER_ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER_LAST_NAME\" , \"CUSTOMER_ID\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAAAHNDAAA                                       \n1   AAAAAAAAABIABAAA                                       \n2   AAAAAAAAAEAMBAAA                                       \n3   AAAAAAAAAGMHBAAA                                       \n4   AAAAAAAAAKIJFAAA                                       \n5   AAAAAAAAAOGCAAAA                                       \n6   AAAAAAAAAPGDHAAA                                       \n7   AAAAAAAABDMMEAAA                                       \n8   AAAAAAAABEONFAAA                                       \n9   AAAAAAAABKNHGAAA                                       \n10  AAAAAAAABOPJFAAA                                       \n11  AAAAAAAABPLEFAAA                                       \n12  AAAAAAAACAAPBAAA                                       \n13  AAAAAAAACILIBAAA                                       \n14  AAAAAAAADBEDFAAA                                       \n15  AAAAAAAADFPNFAAA                                       \n16  AAAAAAAADLAPAAAA                                       \n17  AAAAAAAADMNDFAAA                                       \n18  AAAAAAAADOLIGAAA                                       \n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017502,
                    "execution_time": 0.00765,
                    "compile_time": 7.1e-05,
                    "planning_time": 0.003772
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.0187,
                    "execution_time": 0.00877,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.003757
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_SECYEAR\".\"YEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_SECYEAR\".\"YEAR\" = 1999 AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"CUSTOMER_FIRST_NAME\" NULLS LAST , \"CUSTOMER_LAST_NAME\" NULLS LAST , \"CUSTOMER_ID\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"CUSTOMER_FIRST_NAME\" NULLS LAST , \"CUSTOMER_LAST_NAME\" NULLS LAST , \"CUSTOMER_ID\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name\n0   AAAAAAAAAAHNDAAA                                       \n1   AAAAAAAAABIABAAA                                       \n2   AAAAAAAAAEAMBAAA                                       \n3   AAAAAAAAAGMHBAAA                                       \n4   AAAAAAAAAKIJFAAA                                       \n5   AAAAAAAAAOGCAAAA                                       \n6   AAAAAAAAAPGDHAAA                                       \n7   AAAAAAAABDMMEAAA                                       \n8   AAAAAAAABEONFAAA                                       \n9   AAAAAAAABKNHGAAA                                       \n10  AAAAAAAABOPJFAAA                                       \n11  AAAAAAAABPLEFAAA                                       \n12  AAAAAAAACAAPBAAA                                       \n13  AAAAAAAACILIBAAA                                       \n14  AAAAAAAADBEDFAAA                                       \n15  AAAAAAAADFPNFAAA                                       \n16  AAAAAAAADLAPAAAA                                       \n17  AAAAAAAADMNDFAAA                                       \n18  AAAAAAAADOLIGAAA                                       \n...*/"
    }
]