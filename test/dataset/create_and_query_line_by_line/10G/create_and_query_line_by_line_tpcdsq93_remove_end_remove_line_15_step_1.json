[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*SS_SALES_PRICE\n                                                            else (ss_quantity*SS_SALES_PRICE) end act_sales\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n            ) /*CURSOR_IDENTIFIER*/\n      ) as sales\n      group by ss_customer_sk",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END AS \"ACT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END AS \"ACT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END AS \"ACT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LIMIT 21",
                "preview": "\n/*    ss_item_sk  ss_ticket_number  ss_customer_sk  act_sales\n0        56500            832613           55148    2224.80\n1        56500            832613           55148    2391.66\n2        56500            832613           55148    2113.56\n3        56500            832613           55148    2280.42\n4        56500            832613           55148     862.11\n5        56500            832613           55148    2475.09\n6        56500            832613           55148    2002.32\n7        56500            832613           55148    2224.80\n8        56500            832613           55148    1307.07\n9        56500            832613           55148    2224.80\n10       56500            832613           55148    2641.95\n11       56500            832613           55148    2502.90\n12       56500            832613           55148    1612.98\n13       56500            832613           55148    2336.04\n14       56500            832613           55148    2558.52\n15       56500            832613           55148    2502.90\n16       56500            832613           55148     556.20\n17       56500            832613           55148    1696.41\n18       56500            832613           55148    2363.85\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.356307,
                    "execution_time": 0.310541,
                    "compile_time": 0.000127,
                    "planning_time": 0.035258
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.448026,
                    "execution_time": 0.336916,
                    "compile_time": 0.001046,
                    "planning_time": 0.094913
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\", \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\", \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END AS \"ACT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\"",
                "rewrite": "SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END AS \"ACT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\""
            }
        ],
        "preview": "\n/*    ss_item_sk  ss_ticket_number  ss_customer_sk  act_sales\n0        56500            832613           55148    2224.80\n1        56500            832613           55148    2391.66\n2        56500            832613           55148    2113.56\n3        56500            832613           55148    2280.42\n4        56500            832613           55148     862.11\n5        56500            832613           55148    2475.09\n6        56500            832613           55148    2002.32\n7        56500            832613           55148    2224.80\n8        56500            832613           55148    1307.07\n9        56500            832613           55148    2224.80\n10       56500            832613           55148    2641.95\n11       56500            832613           55148    2502.90\n12       56500            832613           55148    1612.98\n13       56500            832613           55148    2336.04\n14       56500            832613           55148    2558.52\n15       56500            832613           55148    2502.90\n16       56500            832613           55148     556.20\n17       56500            832613           55148    1696.41\n18       56500            832613           55148    2363.85\n...*/"
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*SS_SALES_PRICE\n                                                            else (ss_quantity*SS_SALES_PRICE) end act_sales\n            from store_sales left outer join store_returns on (SR_ITEM_SK = ss_item_sk\n                                                               and sr_ticket_number = ss_ticket_number)\n           ) derived_table1\n      group by ss_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.843798,
                    "execution_time": 0.585593,
                    "compile_time": 0.00035,
                    "planning_time": 0.036052,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.919359,
                    "execution_time": 0.588908,
                    "compile_time": 0.001408,
                    "planning_time": 0.102457,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ss_customer_sk      sumsales\n0              NaN  5.889968e+08\n1         344737.0  1.421123e+05\n2          53417.0  6.669264e+04\n3         137569.0  4.502718e+04\n4         263604.0  7.768781e+04\n5         249324.0  7.395503e+04\n6         385466.0  1.064814e+05\n7         152201.0  9.747001e+04\n8         150123.0  5.258149e+04\n9         271662.0  1.491060e+05\n10        328762.0  9.544363e+04\n11        417918.0  1.479115e+05\n12        381225.0  7.486618e+04\n13         35834.0  1.160373e+05\n14        417932.0  1.088049e+05\n15          6486.0  1.681514e+05\n16        296604.0  7.011590e+04\n17        288045.0  1.489800e+05\n18        235796.0  1.319201e+05\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016364,
                    "execution_time": 0.006963,
                    "compile_time": 5e-05,
                    "planning_time": 0.003348
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053089,
                    "execution_time": 0.007425,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.038317
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", SUM(CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ss_customer_sk      sumsales\n0              NaN  5.889968e+08\n1         344737.0  1.421123e+05\n2          53417.0  6.669264e+04\n3         137569.0  4.502718e+04\n4         263604.0  7.768781e+04\n5         249324.0  7.395503e+04\n6         385466.0  1.064814e+05\n7         152201.0  9.747001e+04\n8         150123.0  5.258149e+04\n9         271662.0  1.491060e+05\n10        328762.0  9.544363e+04\n11        417918.0  1.479115e+05\n12        381225.0  7.486618e+04\n13         35834.0  1.160373e+05\n14        417932.0  1.088049e+05\n15          6486.0  1.681514e+05\n16        296604.0  7.011590e+04\n17        288045.0  1.489800e+05\n18        235796.0  1.319201e+05\n...*/"
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,ss_quantity\n                  ,ss_sales_price\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n                                                            else (ss_quantity*ss_sales_price) end act_sales\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n                                                               and sr_ticket_number = ss_ticket_number)\n            ) as sales_data\n      group by ss_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ss_customer_sk   sumsales\n0           293242   67479.30\n1              877  141715.67\n2           127482  170489.90\n3           251705   87377.24\n4           384806  155650.67\n5           119446  100965.81\n6           267938   80201.48\n7           212741   83437.65\n8            26807  161330.23\n9           322448  133666.24\n10          121402  107203.38\n11           77308  152767.75\n12           17342  104283.68\n13          117774  157575.47\n14          393128  134595.50\n15          454207  185685.88\n16           91578   73258.18\n17          483824   81409.36\n18           72171  210696.38\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017091,
                    "execution_time": 0.007909,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.003261
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051368,
                    "execution_time": 0.007593,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.037982
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", SUM(CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", \"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ss_customer_sk   sumsales\n0           293242   67479.30\n1              877  141715.67\n2           127482  170489.90\n3           251705   87377.24\n4           384806  155650.67\n5           119446  100965.81\n6           267938   80201.48\n7           212741   83437.65\n8            26807  161330.23\n9           322448  133666.24\n10          121402  107203.38\n11           77308  152767.75\n12           17342  104283.68\n13          117774  157575.47\n14          393128  134595.50\n15          454207  185685.88\n16           91578   73258.18\n17          483824   81409.36\n18           72171  210696.38\n...*/"
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n                                                            else (ss_quantity*ss_sales_price) end act_sales\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n                                                               and sr_ticket_number = ss_ticket_number)\n                ,reason\n            where sr_reason_sk = r_reason_sk\n/*CURSOR_IDENTIFIER*/\n            ) as sales_data\n      group by ss_customer_sk\n",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"REASON\" AS \"REASON\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"REASON\" AS \"REASON\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.737553,
                    "execution_time": 0.471364,
                    "compile_time": 0.00041,
                    "planning_time": 0.042528,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.372833,
                    "execution_time": 1.027467,
                    "compile_time": 0.002552,
                    "planning_time": 0.112244,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    ss_customer_sk     sumsales\n0              NaN  30317053.66\n1          68876.0      3480.88\n2          51725.0       212.24\n3         453705.0      9757.17\n4         351080.0     19391.11\n5         466117.0     18629.22\n6          54741.0      5754.03\n7         409275.0     14215.80\n8          98018.0      3790.85\n9         490651.0      3433.58\n10         71271.0      9603.91\n11        398528.0      3220.07\n12        287546.0      1165.46\n13        377419.0      5907.42\n14        182179.0       832.70\n15        312753.0      1389.79\n16        180961.0     10036.23\n17         79448.0      7649.00\n18        252402.0      1356.30\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016398,
                    "execution_time": 0.007052,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.003316
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053789,
                    "execution_time": 0.007601,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038626
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", SUM(CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"REASON\" AS \"REASON\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    ss_customer_sk     sumsales\n0              NaN  30317053.66\n1          68876.0      3480.88\n2          51725.0       212.24\n3         453705.0      9757.17\n4         351080.0     19391.11\n5         466117.0     18629.22\n6          54741.0      5754.03\n7         409275.0     14215.80\n8          98018.0      3790.85\n9         490651.0      3433.58\n10         71271.0      9603.91\n11        398528.0      3220.07\n12        287546.0      1165.46\n13        377419.0      5907.42\n14        182179.0       832.70\n15        312753.0      1389.79\n16        180961.0     10036.23\n17         79448.0      7649.00\n18        252402.0      1356.30\n...*/"
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n                                                            else (ss_quantity*ss_sales_price) end act_sales\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n                                                               and sr_ticket_number = ss_ticket_number)\n                ,reason\n            where sr_reason_sk = r_reason_sk\n              and r_reason_desc = 'No service location in my area') t\ngroup by ss_customer_sk /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.206496,
                    "execution_time": 0.089447,
                    "compile_time": 0.000393,
                    "planning_time": 0.04302,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.404707,
                    "execution_time": 0.09006,
                    "compile_time": 0.123527,
                    "planning_time": 0.112626,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*    ss_customer_sk  sumsales\n0           117774   2178.32\n1           474221    326.00\n2           486993    173.44\n3           386134     31.32\n4           326561   2403.00\n5           205797   1591.32\n6           260084     39.32\n7           464633    408.00\n8           303583      0.00\n9            11914     40.74\n10          294456    424.05\n11            1096      9.18\n12          311205    158.34\n13          325680    635.00\n14          264942    243.00\n15          100476    132.98\n16          318662    358.70\n17          396102    253.11\n18          427937    407.36\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016537,
                    "execution_time": 0.007102,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003372
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054473,
                    "execution_time": 0.007951,
                    "compile_time": 5e-05,
                    "planning_time": 0.038729
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", SUM(CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*    ss_customer_sk  sumsales\n0           117774   2178.32\n1           474221    326.00\n2           486993    173.44\n3           386134     31.32\n4           326561   2403.00\n5           205797   1591.32\n6           260084     39.32\n7           464633    408.00\n8           303583      0.00\n9            11914     40.74\n10          294456    424.05\n11            1096      9.18\n12          311205    158.34\n13          325680    635.00\n14          264942    243.00\n15          100476    132.98\n16          318662    358.70\n17          396102    253.11\n18          427937    407.36\n...*/"
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n                                                            else (ss_quantity*ss_sales_price) end act_sales\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n                                                               and sr_ticket_number = ss_ticket_number)\n                ,reason\n            where sr_reason_sk = r_reason_sk\n              and r_reason_desc = 'No service location in my area') t\n      group by ss_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*    ss_customer_sk  sumsales\n0           385824     23.10\n1              580      0.00\n2            60361    576.75\n3            16922   2405.47\n4           404659    462.91\n5           101885   5099.40\n6           384509    318.57\n7           296287      0.00\n8           146668    413.80\n9           455258    111.78\n10          107572    330.40\n11          207731       NaN\n12           37643    112.80\n13          290417   2386.86\n14          235506   4004.64\n15          345437   3771.54\n16          289035    683.10\n17          493398    178.20\n18          221600    146.61\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017174,
                    "execution_time": 0.007864,
                    "compile_time": 5e-05,
                    "planning_time": 0.003284
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051367,
                    "execution_time": 0.00703,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038356
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", SUM(CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", \"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*    ss_customer_sk  sumsales\n0           385824     23.10\n1              580      0.00\n2            60361    576.75\n3            16922   2405.47\n4           404659    462.91\n5           101885   5099.40\n6           384509    318.57\n7           296287      0.00\n8           146668    413.80\n9           455258    111.78\n10          107572    330.40\n11          207731       NaN\n12           37643    112.80\n13          290417   2386.86\n14          235506   4004.64\n15          345437   3771.54\n16          289035    683.10\n17          493398    178.20\n18          221600    146.61\n...*/"
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n                                                            else (ss_quantity*ss_sales_price) end act_sales\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n                                                               and sr_ticket_number = ss_ticket_number)\n                ,reason\n            where sr_reason_sk = r_reason_sk\n              and r_reason_desc = 'No service location in my area') t\n      group by ss_customer_sk\n      order by sumsales, ss_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ORDER BY \"SUMSALES\" NULLS LAST , \"SS_CUSTOMER_SK\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ORDER BY \"SUMSALES\" , \"SS_CUSTOMER_SK\" LIMIT 21",
                "preview": "\n/*    ss_customer_sk  sumsales\n0              259       0.0\n1              529       0.0\n2              580       0.0\n3              598       0.0\n4              619       0.0\n5              771       0.0\n6              776       0.0\n7              795       0.0\n8              844       0.0\n9             1908       0.0\n10            2327       0.0\n11            2608       0.0\n12            2705       0.0\n13            3017       0.0\n14            3202       0.0\n15            3330       0.0\n16            3365       0.0\n17            3408       0.0\n18            3478       0.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018103,
                    "execution_time": 0.008588,
                    "compile_time": 7.1e-05,
                    "planning_time": 0.003619
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055293,
                    "execution_time": 0.008959,
                    "compile_time": 7.6e-05,
                    "planning_time": 0.038703
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", SUM(CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ORDER BY \"SUMSALES\" NULLS LAST, \"SS_CUSTOMER_SK\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ORDER BY \"SUMSALES\" NULLS LAST , \"SS_CUSTOMER_SK\" NULLS LAST"
            }
        ],
        "preview": "\n/*    ss_customer_sk  sumsales\n0              259       0.0\n1              529       0.0\n2              580       0.0\n3              598       0.0\n4              619       0.0\n5              771       0.0\n6              776       0.0\n7              795       0.0\n8              844       0.0\n9             1908       0.0\n10            2327       0.0\n11            2608       0.0\n12            2705       0.0\n13            3017       0.0\n14            3202       0.0\n15            3330       0.0\n16            3365       0.0\n17            3408       0.0\n18            3478       0.0\n...*/"
    },
    {
        "input": "-- start template query93.tpl query 52 in stream 0\nselect /* TPC-DS query93.tpl 0.52 */  ss_customer_sk\n            ,sum(act_sales) sumsales\n      from (select ss_item_sk\n                  ,ss_ticket_number\n                  ,ss_customer_sk\n                  ,case when sr_return_quantity is not null then (ss_quantity-sr_return_quantity)*ss_sales_price\n                                                            else (ss_quantity*ss_sales_price) end act_sales\n            from store_sales left outer join store_returns on (sr_item_sk = ss_item_sk\n                                                               and sr_ticket_number = ss_ticket_number)\n                ,reason\n            where sr_reason_sk = r_reason_sk\n              and r_reason_desc = 'No service location in my area') t\n      group by ss_customer_sk\n      order by sumsales, ss_customer_sk\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , SUM ( CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN ( \"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\" ) END ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ORDER BY \"SUMSALES\" NULLS LAST , \"SS_CUSTOMER_SK\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ORDER BY \"SUMSALES\" , \"SS_CUSTOMER_SK\" LIMIT 21",
                "preview": "\n/*    ss_customer_sk  sumsales\n0              259       0.0\n1              529       0.0\n2              580       0.0\n3              598       0.0\n4              619       0.0\n5              771       0.0\n6              776       0.0\n7              795       0.0\n8              844       0.0\n9             1908       0.0\n10            2327       0.0\n11            2608       0.0\n12            2705       0.0\n13            3017       0.0\n14            3202       0.0\n15            3330       0.0\n16            3365       0.0\n17            3408       0.0\n18            3478       0.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01762,
                    "execution_time": 0.008208,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.003557
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018733,
                    "execution_time": 0.009169,
                    "compile_time": 7.1e-05,
                    "planning_time": 0.003606
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\", SUM(CASE WHEN NOT \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" IS NULL THEN (\"STORE_SALES\".\"SS_QUANTITY\" - \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\") * \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE (\"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_SALES_PRICE\") END) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_DESC\" = 'No service location in my area' LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" WHERE \"REASON\".\"R_REASON_SK\" = \"STORE_RETURNS\".\"SR_REASON_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ORDER BY \"SUMSALES\" NULLS LAST, \"SS_CUSTOMER_SK\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ORDER BY \"SUMSALES\" NULLS LAST , \"SS_CUSTOMER_SK\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*    ss_customer_sk  sumsales\n0              259       0.0\n1              529       0.0\n2              580       0.0\n3              598       0.0\n4              619       0.0\n5              771       0.0\n6              776       0.0\n7              795       0.0\n8              844       0.0\n9             1908       0.0\n10            2327       0.0\n11            2608       0.0\n12            2705       0.0\n13            3017       0.0\n14            3202       0.0\n15            3330       0.0\n16            3365       0.0\n17            3408       0.0\n18            3478       0.0\n...*/"
    }
]