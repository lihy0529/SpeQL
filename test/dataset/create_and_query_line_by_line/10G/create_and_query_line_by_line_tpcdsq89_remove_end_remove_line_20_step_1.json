[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) as sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name) as avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk \ngroup by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy\n) subquery\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"SUBQUERY\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SUBQUERY\".\"I_CLASS\" AS \"I_CLASS\" , \"SUBQUERY\".\"I_BRAND\" AS \"I_BRAND\" , \"SUBQUERY\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SUBQUERY\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SUBQUERY\".\"D_MOY\" AS \"D_MOY\" , \"SUBQUERY\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SUBQUERY\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SUBQUERY AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"SUBQUERY\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SUBQUERY\".\"I_CLASS\" AS \"I_CLASS\" , \"SUBQUERY\".\"I_BRAND\" AS \"I_BRAND\" , \"SUBQUERY\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SUBQUERY\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SUBQUERY\".\"D_MOY\" AS \"D_MOY\" , \"SUBQUERY\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SUBQUERY\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SUBQUERY\" AS \"SUBQUERY\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH SUBQUERY AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"SUBQUERY\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SUBQUERY\".\"I_CLASS\" AS \"I_CLASS\" , \"SUBQUERY\".\"I_BRAND\" AS \"I_BRAND\" , \"SUBQUERY\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SUBQUERY\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SUBQUERY\".\"D_MOY\" AS \"D_MOY\" , \"SUBQUERY\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SUBQUERY\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SUBQUERY\" AS \"SUBQUERY\"",
                "rewrite": "WITH SUBQUERY AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"SUBQUERY\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SUBQUERY\".\"I_CLASS\" AS \"I_CLASS\" , \"SUBQUERY\".\"I_BRAND\" AS \"I_BRAND\" , \"SUBQUERY\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SUBQUERY\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SUBQUERY\".\"D_MOY\" AS \"D_MOY\" , \"SUBQUERY\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SUBQUERY\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name) as avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk\n/*CURSOR_IDENTIFIER*/\ngroup by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy\n)",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.549728,
                    "execution_time": 1.113947,
                    "compile_time": 0.0007,
                    "planning_time": 0.058319,
                    "create_size": 1408
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.620462,
                    "execution_time": 1.102694,
                    "compile_time": 0.000687,
                    "planning_time": 0.131094,
                    "create_size": 1408
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   i_category          i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0                       womens                 able        Unknown      6     130.14             364.79\n1                     baseball                 able        Unknown      9     333.01             364.79\n2                   fragrances                 able        Unknown      4     119.12             364.79\n3              curtains/drapes                 able        Unknown      5     108.65             364.79\n4               sports-apparel                 able        Unknown      3     127.75             364.79\n5                   camcorders                 able        Unknown      9      85.40             364.79\n6                       tennis                 able        Unknown      5     112.91             364.79\n7                     diamonds                 able        Unknown     11     175.71             364.79\n8                      country                 able        Unknown     10      84.77             364.79\n9                     portable                 able        Unknown     11     197.57             364.79\n10                    portable                 able        Unknown      1      14.59             364.79\n11                     fitness                 able        Unknown      7     207.84             364.79\n12                  mattresses                 able        Unknown     12     379.23             364.79\n13                  mattresses                 able        Unknown      1      88.66             364.79\n14                  fragrances                 able        Unknown     12     245.68             364.79\n15                        mens                 able        Unknown      2      68.78             364.79\n16                      optics                 able        Unknown      4     101.78             364.79\n17                     newborn                 able        Unknown      6      22.27             364.79\n18                 disk drives                 able        Unknown      6       1.37             364.79\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018589,
                    "execution_time": 0.0076,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004466
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05858,
                    "execution_time": 0.008706,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.040115
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   i_category          i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0                       womens                 able        Unknown      6     130.14             364.79\n1                     baseball                 able        Unknown      9     333.01             364.79\n2                   fragrances                 able        Unknown      4     119.12             364.79\n3              curtains/drapes                 able        Unknown      5     108.65             364.79\n4               sports-apparel                 able        Unknown      3     127.75             364.79\n5                   camcorders                 able        Unknown      9      85.40             364.79\n6                       tennis                 able        Unknown      5     112.91             364.79\n7                     diamonds                 able        Unknown     11     175.71             364.79\n8                      country                 able        Unknown     10      84.77             364.79\n9                     portable                 able        Unknown     11     197.57             364.79\n10                    portable                 able        Unknown      1      14.59             364.79\n11                     fitness                 able        Unknown      7     207.84             364.79\n12                  mattresses                 able        Unknown     12     379.23             364.79\n13                  mattresses                 able        Unknown      1      88.66             364.79\n14                  fragrances                 able        Unknown     12     245.68             364.79\n15                        mens                 able        Unknown      2      68.78             364.79\n16                      optics                 able        Unknown      4     101.78             364.79\n17                     newborn                 able        Unknown      6      22.27             364.79\n18                 disk drives                 able        Unknown      6       1.37             364.79\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) as sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name) as avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) \ngroup by i_category, i_class, i_brand,\n         s_store_name, s_company_name, d_moy\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.743081,
                    "execution_time": 0.346975,
                    "compile_time": 0.035839,
                    "planning_time": 0.053237,
                    "create_size": 1408
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.084561,
                    "execution_time": 0.344041,
                    "compile_time": 3.293055,
                    "planning_time": 0.131644,
                    "create_size": 1408
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*   i_category          i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0              dvd/vcr players                ation        Unknown      1       4.02             102.64\n1              dvd/vcr players                ation        Unknown      9      31.73             102.64\n2                         rugs                ation        Unknown      7     105.89             102.64\n3                     athletic                ation        Unknown      5      81.02             102.64\n4                     athletic                ation        Unknown      1      58.20             102.64\n5                     flatware                ation        Unknown      8      40.01             102.64\n6                         rugs                ation        Unknown     11      49.44             102.64\n7                         rugs                ation        Unknown      8     151.00             102.64\n8                         rock                ation        Unknown     10      55.52             102.64\n9                      fitness                ation        Unknown     12     319.97             102.64\n10              sports-apparel                ation        Unknown      1     113.52             102.64\n11                        arts                ation        Unknown      9      29.34             102.64\n12              sports-apparel                ation        Unknown     12      99.78             102.64\n13                     country                ation        Unknown     10      66.50             102.64\n14                      memory                ation        Unknown      6      27.92             102.64\n15                    swimwear                ation        Unknown      7      43.09             102.64\n16                    flatware                ation        Unknown     12     103.65             102.64\n17                      womens                ation        Unknown      8      96.30             102.64\n18                     camping                ation        Unknown      9      34.34             102.64\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017833,
                    "execution_time": 0.007427,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004106
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058402,
                    "execution_time": 0.008422,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.040121
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*   i_category          i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0              dvd/vcr players                ation        Unknown      1       4.02             102.64\n1              dvd/vcr players                ation        Unknown      9      31.73             102.64\n2                         rugs                ation        Unknown      7     105.89             102.64\n3                     athletic                ation        Unknown      5      81.02             102.64\n4                     athletic                ation        Unknown      1      58.20             102.64\n5                     flatware                ation        Unknown      8      40.01             102.64\n6                         rugs                ation        Unknown     11      49.44             102.64\n7                         rugs                ation        Unknown      8     151.00             102.64\n8                         rock                ation        Unknown     10      55.52             102.64\n9                      fitness                ation        Unknown     12     319.97             102.64\n10              sports-apparel                ation        Unknown      1     113.52             102.64\n11                        arts                ation        Unknown      9      29.34             102.64\n12              sports-apparel                ation        Unknown     12      99.78             102.64\n13                     country                ation        Unknown     10      66.50             102.64\n14                      memory                ation        Unknown      6      27.92             102.64\n15                    swimwear                ation        Unknown      7      43.09             102.64\n16                    flatware                ation        Unknown     12     103.65             102.64\n17                      womens                ation        Unknown      8      96.30             102.64\n18                     camping                ation        Unknown      9      34.34             102.64\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name) avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n      i_category in ('Shoes','Men','Music')\ngroup by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.194129,
                    "execution_time": 0.105271,
                    "compile_time": 0.000545,
                    "planning_time": 0.054358,
                    "create_size": 88
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.435181,
                    "execution_time": 0.107459,
                    "compile_time": 0.120183,
                    "planning_time": 0.167546,
                    "create_size": 88
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*   i_category         i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0         Men          shirts                 able        Unknown     12      59.92             119.75\n1         Men  sports-apparel                 able        Unknown      7      76.62             119.75\n2         Men                                 able        Unknown     11     134.76             119.75\n3         Men  sports-apparel                 able        Unknown     11     262.36             119.75\n4         Men  sports-apparel                 able        Unknown      4     334.15             119.75\n5         Men          shirts                 able        Unknown      8      47.53             119.75\n6         Men          shirts                 able        Unknown      6      70.02             119.75\n7         Men  sports-apparel                 able        Unknown      6      39.34             119.75\n8         Men  sports-apparel                 able        Unknown      3     168.42             119.75\n9         Men                                 able        Unknown      8      50.69             119.75\n10        Men  sports-apparel                 able        Unknown      1      47.39             119.75\n11        Men          shirts                 able        Unknown      4     194.87             119.75\n12        Men          shirts                 able        Unknown      9     100.53             119.75\n13        Men                                 able        Unknown      5     119.32             119.75\n14        Men  sports-apparel                 able        Unknown      9      20.11             119.75\n15        Men                                 able        Unknown      3      59.56             119.75\n16        Men  sports-apparel                 able        Unknown     12     419.55             119.75\n17        Men          shirts                 able        Unknown      3     154.99             119.75\n18        Men  sports-apparel                 able        Unknown      5      76.21             119.75\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017996,
                    "execution_time": 0.007323,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004261
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057887,
                    "execution_time": 0.007893,
                    "compile_time": 5e-05,
                    "planning_time": 0.040194
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*   i_category         i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0         Men          shirts                 able        Unknown     12      59.92             119.75\n1         Men  sports-apparel                 able        Unknown      7      76.62             119.75\n2         Men                                 able        Unknown     11     134.76             119.75\n3         Men  sports-apparel                 able        Unknown     11     262.36             119.75\n4         Men  sports-apparel                 able        Unknown      4     334.15             119.75\n5         Men          shirts                 able        Unknown      8      47.53             119.75\n6         Men          shirts                 able        Unknown      6      70.02             119.75\n7         Men  sports-apparel                 able        Unknown      6      39.34             119.75\n8         Men  sports-apparel                 able        Unknown      3     168.42             119.75\n9         Men                                 able        Unknown      8      50.69             119.75\n10        Men  sports-apparel                 able        Unknown      1      47.39             119.75\n11        Men          shirts                 able        Unknown      4     194.87             119.75\n12        Men          shirts                 able        Unknown      9     100.53             119.75\n13        Men                                 able        Unknown      5     119.32             119.75\n14        Men  sports-apparel                 able        Unknown      9      20.11             119.75\n15        Men                                 able        Unknown      3      59.56             119.75\n16        Men  sports-apparel                 able        Unknown     12     419.55             119.75\n17        Men          shirts                 able        Unknown      3     154.99             119.75\n18        Men  sports-apparel                 able        Unknown      5      76.21             119.75\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) as sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name) as avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical'))\n          )\ngroup by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy\n) /* Added the missing closing parenthesis and GROUP BY clause for the outer select subquery */\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) AND \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) AND \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.167316,
                    "execution_time": 0.081081,
                    "compile_time": 0.000538,
                    "planning_time": 0.057744,
                    "create_size": 88
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.250419,
                    "execution_time": 0.080397,
                    "compile_time": 0.00053,
                    "planning_time": 0.136103,
                    "create_size": 88
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*   i_category         i_class             i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0         Men  sports-apparel                             able        Unknown      1      47.39             151.74\n1         Men  sports-apparel                             able        Unknown      4     334.15             151.74\n2         Men  sports-apparel                             able        Unknown     11     262.36             151.74\n3         Men  sports-apparel                             able        Unknown      3     168.42             151.74\n4         Men  sports-apparel                             able        Unknown      6      39.34             151.74\n5         Men  sports-apparel                             able        Unknown      9      20.11             151.74\n6         Men  sports-apparel                             able        Unknown      7      76.62             151.74\n7         Men  sports-apparel                             able        Unknown      5      76.21             151.74\n8         Men  sports-apparel                             able        Unknown     12     419.55             151.74\n9         Men  sports-apparel                             able        Unknown     10      42.35             151.74\n10        Men  sports-apparel                             able        Unknown      8     182.68             151.74\n11        Men  sports-apparel                             anti        Unknown      7      56.57              84.01\n12        Men  sports-apparel                             anti        Unknown      9      52.72              84.01\n13        Men  sports-apparel                             anti        Unknown      5      39.72              84.01\n14        Men  sports-apparel                             anti        Unknown     11      11.13              84.01\n15        Men  sports-apparel                             anti        Unknown      4      26.42              84.01\n16        Men  sports-apparel                             anti        Unknown      8     132.93              84.01\n17        Men  sports-apparel                             anti        Unknown     12     151.08              84.01\n18        Men  sports-apparel                             anti        Unknown      3     160.36              84.01\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018575,
                    "execution_time": 0.007781,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004278
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057342,
                    "execution_time": 0.007847,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.03982
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*   i_category         i_class             i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0         Men  sports-apparel                             able        Unknown      1      47.39             151.74\n1         Men  sports-apparel                             able        Unknown      4     334.15             151.74\n2         Men  sports-apparel                             able        Unknown     11     262.36             151.74\n3         Men  sports-apparel                             able        Unknown      3     168.42             151.74\n4         Men  sports-apparel                             able        Unknown      6      39.34             151.74\n5         Men  sports-apparel                             able        Unknown      9      20.11             151.74\n6         Men  sports-apparel                             able        Unknown      7      76.62             151.74\n7         Men  sports-apparel                             able        Unknown      5      76.21             151.74\n8         Men  sports-apparel                             able        Unknown     12     419.55             151.74\n9         Men  sports-apparel                             able        Unknown     10      42.35             151.74\n10        Men  sports-apparel                             able        Unknown      8     182.68             151.74\n11        Men  sports-apparel                             anti        Unknown      7      56.57              84.01\n12        Men  sports-apparel                             anti        Unknown      9      52.72              84.01\n13        Men  sports-apparel                             anti        Unknown      5      39.72              84.01\n14        Men  sports-apparel                             anti        Unknown     11      11.13              84.01\n15        Men  sports-apparel                             anti        Unknown      4      26.42              84.01\n16        Men  sports-apparel                             anti        Unknown      8     132.93              84.01\n17        Men  sports-apparel                             anti        Unknown     12     151.08              84.01\n18        Men  sports-apparel                             anti        Unknown      3     160.36              84.01\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name)\n         avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n) /* Added closing parenthesis for the inner subquery */\ngroup by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy\n\n) /* Removed redundant parentheses and fixed grouping position */\n/*CURSOR_IDENTIFIER*/\n",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) AND \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*   i_category         i_class             i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0         Men  sports-apparel  edu packimporto #1         able        Unknown     12   85826.17           41293.54\n1         Men  sports-apparel  edu packimporto #1         able        Unknown      3   22602.90           41293.54\n2         Men  sports-apparel  edu packimporto #1         able        Unknown     10   56655.30           41293.54\n3         Men  sports-apparel  edu packimporto #1         able        Unknown      7   24837.68           41293.54\n4         Men  sports-apparel  edu packimporto #1         able        Unknown      9   49431.22           41293.54\n5         Men  sports-apparel  edu packimporto #1         able        Unknown      1   29428.72           41293.54\n6         Men  sports-apparel  edu packimporto #1         able        Unknown      4   23203.46           41293.54\n7         Men  sports-apparel  edu packimporto #1         able        Unknown      6   22479.12           41293.54\n8         Men  sports-apparel  edu packimporto #1         able        Unknown      8   55694.48           41293.54\n9         Men  sports-apparel  edu packimporto #1         able        Unknown     11   78800.87           41293.54\n10        Men  sports-apparel  edu packimporto #1         able        Unknown      5   23140.12           41293.54\n11        Men  sports-apparel  edu packimporto #1         able        Unknown      2   23422.51           41293.54\n12        Men  sports-apparel  edu packimporto #2        ation        Unknown      8   14546.12           10464.35\n13        Men  sports-apparel  edu packimporto #2        ation        Unknown      6    5720.91           10464.35\n14        Men  sports-apparel  edu packimporto #2        ation        Unknown      3    6186.79           10464.35\n15        Men  sports-apparel  edu packimporto #2        ation        Unknown      4    4970.84           10464.35\n16        Men  sports-apparel  edu packimporto #2        ation        Unknown      2    7192.08           10464.35\n17        Men  sports-apparel  edu packimporto #2        ation        Unknown      5    6517.09           10464.35\n18        Men  sports-apparel  edu packimporto #2        ation        Unknown     11   21522.62           10464.35\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017831,
                    "execution_time": 0.007275,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.004147
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018882,
                    "execution_time": 0.007887,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004382
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*   i_category         i_class             i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0         Men  sports-apparel  edu packimporto #1         able        Unknown     12   85826.17           41293.54\n1         Men  sports-apparel  edu packimporto #1         able        Unknown      3   22602.90           41293.54\n2         Men  sports-apparel  edu packimporto #1         able        Unknown     10   56655.30           41293.54\n3         Men  sports-apparel  edu packimporto #1         able        Unknown      7   24837.68           41293.54\n4         Men  sports-apparel  edu packimporto #1         able        Unknown      9   49431.22           41293.54\n5         Men  sports-apparel  edu packimporto #1         able        Unknown      1   29428.72           41293.54\n6         Men  sports-apparel  edu packimporto #1         able        Unknown      4   23203.46           41293.54\n7         Men  sports-apparel  edu packimporto #1         able        Unknown      6   22479.12           41293.54\n8         Men  sports-apparel  edu packimporto #1         able        Unknown      8   55694.48           41293.54\n9         Men  sports-apparel  edu packimporto #1         able        Unknown     11   78800.87           41293.54\n10        Men  sports-apparel  edu packimporto #1         able        Unknown      5   23140.12           41293.54\n11        Men  sports-apparel  edu packimporto #1         able        Unknown      2   23422.51           41293.54\n12        Men  sports-apparel  edu packimporto #2        ation        Unknown      8   14546.12           10464.35\n13        Men  sports-apparel  edu packimporto #2        ation        Unknown      6    5720.91           10464.35\n14        Men  sports-apparel  edu packimporto #2        ation        Unknown      3    6186.79           10464.35\n15        Men  sports-apparel  edu packimporto #2        ation        Unknown      4    4970.84           10464.35\n16        Men  sports-apparel  edu packimporto #2        ation        Unknown      2    7192.08           10464.35\n17        Men  sports-apparel  edu packimporto #2        ation        Unknown      5    6517.09           10464.35\n18        Men  sports-apparel  edu packimporto #2        ation        Unknown     11   21522.62           10464.35\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\ns_store_name, s_company_name, d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name) as avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n      or (i_category in ('Electronics','Women','Jewelry') and\n          i_class in ('portable','fragrances','diamonds') \n        ))\n/*CURSOR_IDENTIFIER*/\ngroup by i_category, i_class, i_brand,\ns_store_name, s_company_name, d_moy\n)",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.420004,
                    "execution_time": 0.177398,
                    "compile_time": 0.041359,
                    "planning_time": 0.059097,
                    "create_size": 726
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.747006,
                    "execution_time": 0.177207,
                    "compile_time": 3.27978,
                    "planning_time": 0.14009,
                    "create_size": 726
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*     i_category      i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics                              eing        Unknown      3      62.74             126.02\n1   Electronics  televisions                 eing        Unknown      1      11.40             126.02\n2   Electronics                              eing        Unknown      5     122.51             126.02\n3   Electronics  televisions                 eing        Unknown      3      57.12             126.02\n4   Electronics                              eing        Unknown     10      62.95             126.02\n5   Electronics     scanners                 eing        Unknown     10     161.93             126.02\n6   Electronics                              eing        Unknown      9     402.70             126.02\n7   Electronics  televisions                 eing        Unknown      7       3.38             126.02\n8   Electronics                              eing        Unknown      4     149.42             126.02\n9   Electronics                              eing        Unknown      7      70.01             126.02\n10  Electronics     scanners                 eing        Unknown     12      73.94             126.02\n11  Electronics                              eing        Unknown      1      78.68             126.02\n12  Electronics                              eing        Unknown      8     183.79             126.02\n13  Electronics  televisions                 eing        Unknown      8      71.32             126.02\n14  Electronics                              eing        Unknown     12     442.37             126.02\n15  Electronics  televisions                 eing        Unknown     11      89.71             126.02\n16  Electronics  televisions                 eing        Unknown      5      46.12             126.02\n17  Electronics     scanners                 eing        Unknown      2       4.04             126.02\n18  Electronics  televisions                 eing        Unknown     10     323.93             126.02\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017818,
                    "execution_time": 0.007402,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.00409
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057262,
                    "execution_time": 0.007645,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.039881
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*     i_category      i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics                              eing        Unknown      3      62.74             126.02\n1   Electronics  televisions                 eing        Unknown      1      11.40             126.02\n2   Electronics                              eing        Unknown      5     122.51             126.02\n3   Electronics  televisions                 eing        Unknown      3      57.12             126.02\n4   Electronics                              eing        Unknown     10      62.95             126.02\n5   Electronics     scanners                 eing        Unknown     10     161.93             126.02\n6   Electronics                              eing        Unknown      9     402.70             126.02\n7   Electronics  televisions                 eing        Unknown      7       3.38             126.02\n8   Electronics                              eing        Unknown      4     149.42             126.02\n9   Electronics                              eing        Unknown      7      70.01             126.02\n10  Electronics     scanners                 eing        Unknown     12      73.94             126.02\n11  Electronics                              eing        Unknown      1      78.68             126.02\n12  Electronics                              eing        Unknown      8     183.79             126.02\n13  Electronics  televisions                 eing        Unknown      8      71.32             126.02\n14  Electronics                              eing        Unknown     12     442.37             126.02\n15  Electronics  televisions                 eing        Unknown     11      89.71             126.02\n16  Electronics  televisions                 eing        Unknown      5      46.12             126.02\n17  Electronics     scanners                 eing        Unknown      2       4.04             126.02\n18  Electronics  televisions                 eing        Unknown     10     323.93             126.02\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name) as avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n      or (i_category in ('Electronics','Women','Jewelry') and\n          i_class in ('portable','fragrances','diamonds') \n        ))\ngroup by i_category, i_class, i_brand, s_store_name, s_company_name, d_moy\n)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"_Q_0\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"_Q_0\".\"I_CLASS\" AS \"I_CLASS\" , \"_Q_0\".\"I_BRAND\" AS \"I_BRAND\" , \"_Q_0\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"_Q_0\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"_Q_0\".\"D_MOY\" AS \"D_MOY\" , \"_Q_0\".\"SUM_SALES\" AS \"SUM_SALES\" , \"_Q_0\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*     i_category      i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics                              eing        Unknown      3      62.74             126.02\n1   Electronics  televisions                 eing        Unknown      1      11.40             126.02\n2   Electronics                              eing        Unknown      5     122.51             126.02\n3   Electronics  televisions                 eing        Unknown      3      57.12             126.02\n4   Electronics                              eing        Unknown     10      62.95             126.02\n5   Electronics     scanners                 eing        Unknown     10     161.93             126.02\n6   Electronics                              eing        Unknown      9     402.70             126.02\n7   Electronics  televisions                 eing        Unknown      7       3.38             126.02\n8   Electronics                              eing        Unknown      4     149.42             126.02\n9   Electronics                              eing        Unknown      7      70.01             126.02\n10  Electronics     scanners                 eing        Unknown     12      73.94             126.02\n11  Electronics                              eing        Unknown      1      78.68             126.02\n12  Electronics                              eing        Unknown      8     183.79             126.02\n13  Electronics  televisions                 eing        Unknown      8      71.32             126.02\n14  Electronics                              eing        Unknown     12     442.37             126.02\n15  Electronics  televisions                 eing        Unknown     11      89.71             126.02\n16  Electronics  televisions                 eing        Unknown      5      46.12             126.02\n17  Electronics     scanners                 eing        Unknown      2       4.04             126.02\n18  Electronics  televisions                 eing        Unknown     10     323.93             126.02\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017721,
                    "execution_time": 0.007315,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.004096
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018217,
                    "execution_time": 0.007416,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004311
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*     i_category      i_class i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics                              eing        Unknown      3      62.74             126.02\n1   Electronics  televisions                 eing        Unknown      1      11.40             126.02\n2   Electronics                              eing        Unknown      5     122.51             126.02\n3   Electronics  televisions                 eing        Unknown      3      57.12             126.02\n4   Electronics                              eing        Unknown     10      62.95             126.02\n5   Electronics     scanners                 eing        Unknown     10     161.93             126.02\n6   Electronics                              eing        Unknown      9     402.70             126.02\n7   Electronics  televisions                 eing        Unknown      7       3.38             126.02\n8   Electronics                              eing        Unknown      4     149.42             126.02\n9   Electronics                              eing        Unknown      7      70.01             126.02\n10  Electronics     scanners                 eing        Unknown     12      73.94             126.02\n11  Electronics                              eing        Unknown      1      78.68             126.02\n12  Electronics                              eing        Unknown      8     183.79             126.02\n13  Electronics  televisions                 eing        Unknown      8      71.32             126.02\n14  Electronics                              eing        Unknown     12     442.37             126.02\n15  Electronics  televisions                 eing        Unknown     11      89.71             126.02\n16  Electronics  televisions                 eing        Unknown      5      46.12             126.02\n17  Electronics     scanners                 eing        Unknown      2       4.04             126.02\n18  Electronics  televisions                 eing        Unknown     10     323.93             126.02\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name)\n         avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n      or (i_category in ('Electronics','Women','Jewelry') and\n          i_class in ('portable','fragrances','diamonds') \n        ))\ngroup by i_category, i_class, i_brand,\n         s_store_name, s_company_name, d_moy) tmp1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"TMP1\".\"I_CLASS\" AS \"I_CLASS\" , \"TMP1\".\"I_BRAND\" AS \"I_BRAND\" , \"TMP1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"TMP1\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"TMP1\".\"D_MOY\" AS \"D_MOY\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*     i_category      i_class             i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics  disk drives  amalgamalgamalg #5          ese        Unknown     10    1864.69            1053.91\n1   Electronics  disk drives  amalgamalgamalg #5          ese        Unknown      4     819.69            1053.91\n2   Electronics  disk drives  amalgamalgamalg #5          ese        Unknown     12    1840.68            1053.91\n3   Electronics  disk drives  amalgamalgamalg #5          ese        Unknown      9     978.69            1053.91\n4   Electronics  disk drives  amalgamalgamalg #5        ought        Unknown      4     379.68             680.04\n5   Electronics  disk drives  amalgamalgamalg #5        ought        Unknown      3     346.83             680.04\n6   Electronics  disk drives  amalgamalgamalg #5        ought        Unknown      1     459.17             680.04\n7   Electronics  disk drives  amalgamalgamalg #5        ought        Unknown     11    1478.17             680.04\n8   Electronics  disk drives  amalgamalgamalg #5        ought        Unknown      7     364.10             680.04\n9   Electronics  disk drives  amalgamalgamalg #5        ought        Unknown      8    1114.31             680.04\n10  Electronics  disk drives  amalgamalgamalg #5        ought        Unknown      2     357.30             680.04\n11  Electronics  disk drives  amalgamalgamalg #5        ought        Unknown     10     791.57             680.04\n12  Electronics  disk drives  amalgamalgamalg #5        ought        Unknown      9     861.35             680.04\n13  Electronics  disk drives  amalgamalgamalg #5        ought        Unknown     12    1765.99             680.04\n14  Electronics  disk drives  amalgamalgamalg #5        ought        Unknown      5      70.95             680.04\n15  Electronics  disk drives  amalgamalgamalg #5        ought        Unknown      6     171.17             680.04\n16  Electronics  disk drives  amalgamalgamalg #6         n st        Unknown      1     219.59             394.33\n17  Electronics  disk drives  amalgamalgamalg #6         n st        Unknown      3      96.56             394.33\n18  Electronics  disk drives  amalgamalgamalg #6         n st        Unknown      7     476.36             394.33\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018683,
                    "execution_time": 0.007556,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004264
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018645,
                    "execution_time": 0.007568,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004407
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*     i_category      i_class             i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics  disk drives  amalgamalgamalg #5          ese        Unknown     10    1864.69            1053.91\n1   Electronics  disk drives  amalgamalgamalg #5          ese        Unknown      4     819.69            1053.91\n2   Electronics  disk drives  amalgamalgamalg #5          ese        Unknown     12    1840.68            1053.91\n3   Electronics  disk drives  amalgamalgamalg #5          ese        Unknown      9     978.69            1053.91\n4   Electronics  disk drives  amalgamalgamalg #5        ought        Unknown      4     379.68             680.04\n5   Electronics  disk drives  amalgamalgamalg #5        ought        Unknown      3     346.83             680.04\n6   Electronics  disk drives  amalgamalgamalg #5        ought        Unknown      1     459.17             680.04\n7   Electronics  disk drives  amalgamalgamalg #5        ought        Unknown     11    1478.17             680.04\n8   Electronics  disk drives  amalgamalgamalg #5        ought        Unknown      7     364.10             680.04\n9   Electronics  disk drives  amalgamalgamalg #5        ought        Unknown      8    1114.31             680.04\n10  Electronics  disk drives  amalgamalgamalg #5        ought        Unknown      2     357.30             680.04\n11  Electronics  disk drives  amalgamalgamalg #5        ought        Unknown     10     791.57             680.04\n12  Electronics  disk drives  amalgamalgamalg #5        ought        Unknown      9     861.35             680.04\n13  Electronics  disk drives  amalgamalgamalg #5        ought        Unknown     12    1765.99             680.04\n14  Electronics  disk drives  amalgamalgamalg #5        ought        Unknown      5      70.95             680.04\n15  Electronics  disk drives  amalgamalgamalg #5        ought        Unknown      6     171.17             680.04\n16  Electronics  disk drives  amalgamalgamalg #6         n st        Unknown      1     219.59             394.33\n17  Electronics  disk drives  amalgamalgamalg #6         n st        Unknown      3      96.56             394.33\n18  Electronics  disk drives  amalgamalgamalg #6         n st        Unknown      7     476.36             394.33\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name)\n         avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n      or (i_category in ('Electronics','Women','Jewelry') and\n          i_class in ('portable','fragrances','diamonds') \n        ))\ngroup by i_category, i_class, i_brand,\n         s_store_name, s_company_name, d_moy) tmp1\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"TMP1\".\"I_CLASS\" AS \"I_CLASS\" , \"TMP1\".\"I_BRAND\" AS \"I_BRAND\" , \"TMP1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"TMP1\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"TMP1\".\"D_MOY\" AS \"D_MOY\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" ) / \"TMP1\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.200735,
                    "execution_time": 0.060083,
                    "compile_time": 0.00026,
                    "planning_time": 0.006392,
                    "create_size": 704
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.270272,
                    "execution_time": 0.06432,
                    "compile_time": 0.00028,
                    "planning_time": 0.064077,
                    "create_size": 693
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*     i_category      i_class             i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics  disk drives  amalgamalgamalg #9          pri        Unknown      7      51.41             315.08\n1   Electronics  disk drives  amalgamalgamalg #9          pri        Unknown      9     404.75             315.08\n2   Electronics  disk drives  amalgamalgamalg #9          pri        Unknown      8     362.23             315.08\n3   Electronics  disk drives  amalgamalgamalg #9          pri        Unknown     12     721.89             315.08\n4   Electronics      cameras   amalgunivamalg #1         able        Unknown      1     179.96             314.92\n5   Electronics      cameras   amalgunivamalg #1         able        Unknown      6     124.00             314.92\n6   Electronics      cameras   amalgunivamalg #1         able        Unknown     10     381.00             314.92\n7   Electronics      cameras   amalgunivamalg #1         able        Unknown     11     731.90             314.92\n8   Electronics      cameras   amalgunivamalg #1         able        Unknown      4     218.54             314.92\n9   Electronics      cameras   amalgunivamalg #1         able        Unknown     12     850.01             314.92\n10  Electronics      cameras   amalgunivamalg #1         able        Unknown      8     127.45             314.92\n11  Electronics      cameras   amalgunivamalg #1         able        Unknown      9     533.22             314.92\n12  Electronics      cameras   amalgunivamalg #1         able        Unknown      5     231.48             314.92\n13  Electronics      cameras   amalgunivamalg #1         able        Unknown      3      78.55             314.92\n14  Electronics      cameras   amalgunivamalg #1         able        Unknown      7      35.33             314.92\n15  Electronics      cameras  amalgunivamalg #10        cally        Unknown      1     225.15             519.24\n16  Electronics      cameras  amalgunivamalg #10        cally        Unknown      4     135.21             519.24\n17  Electronics      cameras  amalgunivamalg #10        cally        Unknown      2     332.13             519.24\n18  Electronics      cameras  amalgunivamalg #10        cally        Unknown      6     187.78             519.24\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018971,
                    "execution_time": 0.008116,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004243
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057524,
                    "execution_time": 0.007538,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.039986
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*     i_category      i_class             i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0   Electronics  disk drives  amalgamalgamalg #9          pri        Unknown      7      51.41             315.08\n1   Electronics  disk drives  amalgamalgamalg #9          pri        Unknown      9     404.75             315.08\n2   Electronics  disk drives  amalgamalgamalg #9          pri        Unknown      8     362.23             315.08\n3   Electronics  disk drives  amalgamalgamalg #9          pri        Unknown     12     721.89             315.08\n4   Electronics      cameras   amalgunivamalg #1         able        Unknown      1     179.96             314.92\n5   Electronics      cameras   amalgunivamalg #1         able        Unknown      6     124.00             314.92\n6   Electronics      cameras   amalgunivamalg #1         able        Unknown     10     381.00             314.92\n7   Electronics      cameras   amalgunivamalg #1         able        Unknown     11     731.90             314.92\n8   Electronics      cameras   amalgunivamalg #1         able        Unknown      4     218.54             314.92\n9   Electronics      cameras   amalgunivamalg #1         able        Unknown     12     850.01             314.92\n10  Electronics      cameras   amalgunivamalg #1         able        Unknown      8     127.45             314.92\n11  Electronics      cameras   amalgunivamalg #1         able        Unknown      9     533.22             314.92\n12  Electronics      cameras   amalgunivamalg #1         able        Unknown      5     231.48             314.92\n13  Electronics      cameras   amalgunivamalg #1         able        Unknown      3      78.55             314.92\n14  Electronics      cameras   amalgunivamalg #1         able        Unknown      7      35.33             314.92\n15  Electronics      cameras  amalgunivamalg #10        cally        Unknown      1     225.15             519.24\n16  Electronics      cameras  amalgunivamalg #10        cally        Unknown      4     135.21             519.24\n17  Electronics      cameras  amalgunivamalg #10        cally        Unknown      2     332.13             519.24\n18  Electronics      cameras  amalgunivamalg #10        cally        Unknown      6     187.78             519.24\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name)\n         avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n      or (i_category in ('Electronics','Women','Jewelry') and\n          i_class in ('portable','fragrances','diamonds') \n        ))\ngroup by i_category, i_class, i_brand,\n         s_store_name, s_company_name, d_moy) tmp1\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\norder by sum_sales - avg_monthly_sales, s_store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"TMP1\".\"I_CLASS\" AS \"I_CLASS\" , \"TMP1\".\"I_BRAND\" AS \"I_BRAND\" , \"TMP1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"TMP1\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"TMP1\".\"D_MOY\" AS \"D_MOY\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" ) / \"TMP1\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"TMP1\".\"S_STORE_NAME\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.21475,
                    "execution_time": 0.066343,
                    "compile_time": 0.000277,
                    "planning_time": 0.004345,
                    "create_size": 770
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.2698,
                    "execution_time": 0.066295,
                    "compile_time": 0.000258,
                    "planning_time": 0.060097,
                    "create_size": 737
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.200922,
                    "execution_time": 0.05899,
                    "compile_time": 0.000263,
                    "planning_time": 0.006613,
                    "create_size": 682
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.263152,
                    "execution_time": 0.06382,
                    "compile_time": 0.000276,
                    "planning_time": 0.063409,
                    "create_size": 704
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" LIMIT 21",
                "preview": "\n/*   i_category i_class          i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0       Women          exportiamalg #1         able        Unknown     12      10.99           27003.56\n1       Women          exportiamalg #1         able        Unknown      5      14.16           27003.56\n2       Women          exportiamalg #1         able        Unknown      8     109.86           27003.56\n3       Women          exportiamalg #1         able        Unknown      1     144.83           27003.56\n4       Women          exportiamalg #1         able        Unknown     10     182.82           27003.56\n5       Women          exportiamalg #1         eing        Unknown     12       5.99           24209.24\n6       Women          exportiamalg #1         eing        Unknown     11       7.32           24209.24\n7       Women          exportiamalg #1         eing        Unknown      8       9.83           24209.24\n8       Women          exportiamalg #1         eing        Unknown      9      13.93           24209.24\n9       Women          exportiamalg #1          ese        Unknown      8      20.16           24125.83\n10      Women          exportiamalg #1         eing        Unknown      4     108.20           24209.24\n11      Women          exportiamalg #1          ese        Unknown      1      30.86           24125.83\n12      Women          exportiamalg #1          ese        Unknown      4      32.39           24125.83\n13      Women          exportiamalg #1          ese        Unknown      6      43.63           24125.83\n14      Women          exportiamalg #1         eing        Unknown     10     142.88           24209.24\n15      Women          exportiamalg #1         eing        Unknown      6     146.30           24209.24\n16      Women          exportiamalg #1          ese        Unknown      5     101.58           24125.83\n17      Women          exportiamalg #1          ese        Unknown     12     140.31           24125.83\n18      Women          exportiamalg #1          ese        Unknown     11     175.04           24125.83\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.023878,
                    "execution_time": 0.009684,
                    "compile_time": 8.6e-05,
                    "planning_time": 0.006847
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.065361,
                    "execution_time": 0.011796,
                    "compile_time": 9e-05,
                    "planning_time": 0.042586
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category i_class          i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0       Women          exportiamalg #1         able        Unknown     12      10.99           27003.56\n1       Women          exportiamalg #1         able        Unknown      5      14.16           27003.56\n2       Women          exportiamalg #1         able        Unknown      8     109.86           27003.56\n3       Women          exportiamalg #1         able        Unknown      1     144.83           27003.56\n4       Women          exportiamalg #1         able        Unknown     10     182.82           27003.56\n5       Women          exportiamalg #1         eing        Unknown     12       5.99           24209.24\n6       Women          exportiamalg #1         eing        Unknown     11       7.32           24209.24\n7       Women          exportiamalg #1         eing        Unknown      8       9.83           24209.24\n8       Women          exportiamalg #1         eing        Unknown      9      13.93           24209.24\n9       Women          exportiamalg #1          ese        Unknown      8      20.16           24125.83\n10      Women          exportiamalg #1         eing        Unknown      4     108.20           24209.24\n11      Women          exportiamalg #1          ese        Unknown      1      30.86           24125.83\n12      Women          exportiamalg #1          ese        Unknown      4      32.39           24125.83\n13      Women          exportiamalg #1          ese        Unknown      6      43.63           24125.83\n14      Women          exportiamalg #1         eing        Unknown     10     142.88           24209.24\n15      Women          exportiamalg #1         eing        Unknown      6     146.30           24209.24\n16      Women          exportiamalg #1          ese        Unknown      5     101.58           24125.83\n17      Women          exportiamalg #1          ese        Unknown     12     140.31           24125.83\n18      Women          exportiamalg #1          ese        Unknown     11     175.04           24125.83\n...*/"
    },
    {
        "input": "-- start template query89.tpl query 56 in stream 0\nselect /* TPC-DS query89.tpl 0.56 */  *\nfrom(\nselect i_category, i_class, i_brand,\n       s_store_name, s_company_name,\n       d_moy,\n       sum(ss_sales_price) sum_sales,\n       avg(sum(ss_sales_price)) over\n         (partition by i_category, i_brand, s_store_name, s_company_name)\n         avg_monthly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n      ss_sold_date_sk = d_date_sk and\n      ss_store_sk = s_store_sk and\n      d_year in (1999) and\n        ((i_category in ('Shoes','Men','Music') and\n          i_class in ('kids','sports-apparel','classical')\n         )\n      or (i_category in ('Electronics','Women','Jewelry') and\n          i_class in ('portable','fragrances','diamonds') \n        ))\ngroup by i_category, i_class, i_brand,\n         s_store_name, s_company_name, d_moy) tmp1\nwhere case when (avg_monthly_sales <> 0) then (abs(sum_sales - avg_monthly_sales) / avg_monthly_sales) else null end > 0.1\norder by sum_sales - avg_monthly_sales, s_store_name\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Women' , 'Jewelry' ) OR \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Men' , 'Music' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'kids' , 'sports-apparel' , 'classical' ) OR \"ITEM\".\"I_CLASS\" IN ( 'portable' , 'fragrances' , 'diamonds' ) ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_NAME\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"TMP1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"TMP1\".\"I_CLASS\" AS \"I_CLASS\" , \"TMP1\".\"I_BRAND\" AS \"I_BRAND\" , \"TMP1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"TMP1\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"TMP1\".\"D_MOY\" AS \"D_MOY\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" ) / \"TMP1\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"TMP1\".\"S_STORE_NAME\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" LIMIT 21",
                "preview": "\n/*   i_category i_class          i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0       Women          exportiamalg #1         able        Unknown     12      10.99           27003.56\n1       Women          exportiamalg #1         able        Unknown      5      14.16           27003.56\n2       Women          exportiamalg #1         able        Unknown      8     109.86           27003.56\n3       Women          exportiamalg #1         able        Unknown      1     144.83           27003.56\n4       Women          exportiamalg #1         able        Unknown     10     182.82           27003.56\n5       Women          exportiamalg #1         eing        Unknown     12       5.99           24209.24\n6       Women          exportiamalg #1         eing        Unknown     11       7.32           24209.24\n7       Women          exportiamalg #1         eing        Unknown      8       9.83           24209.24\n8       Women          exportiamalg #1         eing        Unknown      9      13.93           24209.24\n9       Women          exportiamalg #1          ese        Unknown      8      20.16           24125.83\n10      Women          exportiamalg #1         eing        Unknown      4     108.20           24209.24\n11      Women          exportiamalg #1          ese        Unknown      1      30.86           24125.83\n12      Women          exportiamalg #1          ese        Unknown      4      32.39           24125.83\n13      Women          exportiamalg #1          ese        Unknown      6      43.63           24125.83\n14      Women          exportiamalg #1         eing        Unknown     10     142.88           24209.24\n15      Women          exportiamalg #1         eing        Unknown      6     146.30           24209.24\n16      Women          exportiamalg #1          ese        Unknown      5     101.58           24125.83\n17      Women          exportiamalg #1          ese        Unknown     12     140.31           24125.83\n18      Women          exportiamalg #1          ese        Unknown     11     175.04           24125.83\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.024478,
                    "execution_time": 0.009801,
                    "compile_time": 9.1e-05,
                    "planning_time": 0.007106
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.025272,
                    "execution_time": 0.010361,
                    "compile_time": 8.7e-05,
                    "planning_time": 0.007194
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_COMPANY_NAME\" AS \"S_COMPANY_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" <> 0 THEN ( ABS ( \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" ) ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_7\".\"AVG_MONTHLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   i_category i_class          i_brand s_store_name s_company_name  d_moy  sum_sales  avg_monthly_sales\n0       Women          exportiamalg #1         able        Unknown     12      10.99           27003.56\n1       Women          exportiamalg #1         able        Unknown      5      14.16           27003.56\n2       Women          exportiamalg #1         able        Unknown      8     109.86           27003.56\n3       Women          exportiamalg #1         able        Unknown      1     144.83           27003.56\n4       Women          exportiamalg #1         able        Unknown     10     182.82           27003.56\n5       Women          exportiamalg #1         eing        Unknown     12       5.99           24209.24\n6       Women          exportiamalg #1         eing        Unknown     11       7.32           24209.24\n7       Women          exportiamalg #1         eing        Unknown      8       9.83           24209.24\n8       Women          exportiamalg #1         eing        Unknown      9      13.93           24209.24\n9       Women          exportiamalg #1          ese        Unknown      8      20.16           24125.83\n10      Women          exportiamalg #1         eing        Unknown      4     108.20           24209.24\n11      Women          exportiamalg #1          ese        Unknown      1      30.86           24125.83\n12      Women          exportiamalg #1          ese        Unknown      4      32.39           24125.83\n13      Women          exportiamalg #1          ese        Unknown      6      43.63           24125.83\n14      Women          exportiamalg #1         eing        Unknown     10     142.88           24209.24\n15      Women          exportiamalg #1         eing        Unknown      6     146.30           24209.24\n16      Women          exportiamalg #1          ese        Unknown      5     101.58           24125.83\n17      Women          exportiamalg #1          ese        Unknown     12     140.31           24125.83\n18      Women          exportiamalg #1          ese        Unknown     11     175.04           24125.83\n...*/"
    }
]