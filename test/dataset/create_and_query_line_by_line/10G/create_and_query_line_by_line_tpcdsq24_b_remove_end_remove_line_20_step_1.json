[
    {
        "input": "with /* TPC-DS query24.tpl 0.92 part2 */ ssales as\n(select ss_customer_sk  -- Placeholder since customer details are not available in schema\n      ,'unknown' as c_last_name  -- Placeholder value for customer's last name\n      ,'unknown' as c_first_name -- Placeholder value for customer's first name\n      ,'unknown' as s_store_name -- Placeholder value for store name\n      ,'unknown' as ca_state     -- Placeholder value for customer address state\n      ,'unknown' as s_state      -- Placeholder value for store state\n      ,'unknown' as i_color      -- Placeholder value for item color\n      ,0 as i_current_price      -- Placeholder value for item current price\n      ,0 as i_manager_id         -- Placeholder value for item manager ID\n      ,0 as i_units              -- Placeholder value for item units\n      ,0 as i_size               -- Placeholder value for item size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\ngroup by ss_customer_sk)\n/*CURSOR_IDENTIFIER*/ \nselect * from ssales",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , 'unknown' AS \"C_LAST_NAME\" , 'unknown' AS \"C_FIRST_NAME\" , 'unknown' AS \"S_STORE_NAME\" , 'unknown' AS \"CA_STATE\" , 'unknown' AS \"S_STATE\" , 'unknown' AS \"I_COLOR\" , 0 AS \"I_CURRENT_PRICE\" , 0 AS \"I_MANAGER_ID\" , 0 AS \"I_UNITS\" , 0 AS \"I_SIZE\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SSALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SSALES\".\"CA_STATE\" AS \"CA_STATE\" , \"SSALES\".\"S_STATE\" AS \"S_STATE\" , \"SSALES\".\"I_COLOR\" AS \"I_COLOR\" , \"SSALES\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SSALES\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SSALES\".\"I_UNITS\" AS \"I_UNITS\" , \"SSALES\".\"I_SIZE\" AS \"I_SIZE\" , \"SSALES\".\"NETPAID\" AS \"NETPAID\" FROM \"SSALES\" AS \"SSALES\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , 'unknown' AS \"C_LAST_NAME\" , 'unknown' AS \"C_FIRST_NAME\" , 'unknown' AS \"S_STORE_NAME\" , 'unknown' AS \"CA_STATE\" , 'unknown' AS \"S_STATE\" , 'unknown' AS \"I_COLOR\" , 0 AS \"I_CURRENT_PRICE\" , 0 AS \"I_MANAGER_ID\" , 0 AS \"I_UNITS\" , 0 AS \"I_SIZE\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.497567,
                    "execution_time": 0.739356,
                    "compile_time": 0.231022,
                    "planning_time": 0.0233,
                    "create_size": 1920
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.476935,
                    "execution_time": 1.306671,
                    "compile_time": 9.570059,
                    "planning_time": 0.083692,
                    "create_size": 1920
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_COLOR\" AS \"I_COLOR\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_UNITS\" AS \"I_UNITS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_SIZE\" AS \"I_SIZE\" , \"SPEQLITE_TEMP_TABLE_1\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ss_customer_sk c_last_name c_first_name s_store_name ca_state  s_state  i_color  i_current_price  i_manager_id  i_units  i_size  netpaid\n0             1341     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  4677.26\n1           326178     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  3621.94\n2           339680     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  1099.78\n3           133420     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  3925.81\n4            52418     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  2048.03\n5           197435     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  4029.25\n6            32422     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  1272.59\n7            72181     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  2163.32\n8           207865     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  2024.19\n9            92350     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  1968.03\n10          327659     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  2879.31\n11          496412     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  2217.24\n12          433876     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  2312.78\n13          495135     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  1954.24\n14           92444     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  1574.36\n15           12627     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  1211.70\n16          405592     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  3417.52\n17          347787     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  2216.88\n18          130405     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  1691.66\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.084649,
                    "execution_time": 0.008609,
                    "compile_time": 0.064627,
                    "planning_time": 0.004776
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.145469,
                    "execution_time": 0.008452,
                    "compile_time": 3.08849,
                    "planning_time": 0.04002
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_COLOR\" AS \"I_COLOR\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_UNITS\" AS \"I_UNITS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_SIZE\" AS \"I_SIZE\" , \"SPEQLITE_TEMP_TABLE_1\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_COLOR\" AS \"I_COLOR\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_UNITS\" AS \"I_UNITS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_SIZE\" AS \"I_SIZE\" , \"SPEQLITE_TEMP_TABLE_1\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ss_customer_sk c_last_name c_first_name s_store_name ca_state  s_state  i_color  i_current_price  i_manager_id  i_units  i_size  netpaid\n0             1341     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  4677.26\n1           326178     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  3621.94\n2           339680     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  1099.78\n3           133420     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  3925.81\n4            52418     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  2048.03\n5           197435     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  4029.25\n6            32422     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  1272.59\n7            72181     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  2163.32\n8           207865     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  2024.19\n9            92350     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  1968.03\n10          327659     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  2879.31\n11          496412     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  2217.24\n12          433876     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  2312.78\n13          495135     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  1954.24\n14           92444     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  1574.36\n15           12627     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  1211.70\n16          405592     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  3417.52\n17          347787     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  2216.88\n18          130405     unknown      unknown      unknown  unknown  unknown  unknown                0             0        0       0  1691.66\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "with /* TPC-DS query24.tpl 0.92 part2 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_net_paid) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\n  and s_market_id = 5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect * from ssales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" AS \"I_UNITS\" , \"ITEM\".\"I_SIZE\" AS \"I_SIZE\" , SUM ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SSALES\".\"CA_STATE\" AS \"CA_STATE\" , \"SSALES\".\"S_STATE\" AS \"S_STATE\" , \"SSALES\".\"I_COLOR\" AS \"I_COLOR\" , \"SSALES\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SSALES\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SSALES\".\"I_UNITS\" AS \"I_UNITS\" , \"SSALES\".\"I_SIZE\" AS \"I_SIZE\" , \"SSALES\".\"NETPAID\" AS \"NETPAID\" FROM \"SSALES\" AS \"SSALES\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" AS \"I_UNITS\" , \"ITEM\".\"I_SIZE\" AS \"I_SIZE\" , SUM ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SSALES AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" AS \"I_UNITS\" , \"ITEM\".\"I_SIZE\" AS \"I_SIZE\" , SUM ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SSALES\".\"CA_STATE\" AS \"CA_STATE\" , \"SSALES\".\"S_STATE\" AS \"S_STATE\" , \"SSALES\".\"I_COLOR\" AS \"I_COLOR\" , \"SSALES\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SSALES\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SSALES\".\"I_UNITS\" AS \"I_UNITS\" , \"SSALES\".\"I_SIZE\" AS \"I_SIZE\" , \"SSALES\".\"NETPAID\" AS \"NETPAID\" FROM \"SSALES\" AS \"SSALES\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name s_store_name ca_state s_state    i_color  i_current_price  i_manager_id  i_units  i_size  netpaid\n0        Croft         Jeff         anti       FL      AL        hot            83.46            36    Bunch     N/A   985.53\n1        Bliss       Robert         anti       AL      AL     salmon             1.51            31       Oz  medium     0.06\n2       Mowery        James         able       FL      AL       grey             2.41             5      Tsp     N/A   503.73\n3    Patterson       Robert          ese       AL      AL     powder             9.92            10    Pound     N/A   331.30\n4       Burton       Adrian          pri       AL      AL        sky             0.67            29      Tsp     N/A   844.64\n5      Parrish      Phillip          ese       GA      AL      wheat             0.37            33     Dram  petite   345.31\n6       Burton       Adrian          pri       AL      AL      linen             5.75            28      Tbl     N/A   775.92\n7      Parrish      Phillip          ese       GA      AL      wheat             6.21            46    Bunch  petite   167.64\n8    Robertson      Heather         anti       TN      AL      linen            99.99            14   Bundle     N/A   643.84\n9      Ledford    Margarete        ation       TN      TN      sandy             4.27            21    Bunch  petite   904.68\n10       Brink                      eing       MN      SD        sky             5.72            37    Gross  medium  6486.72\n11        Hart         Sara         anti       GA      AL      slate             6.52            46     Each     N/A   198.23\n12       Smith       Joshua         eing       MS      SD       pale             1.28             5     Gram     N/A    18.62\n13       Sloan    Cassandra         eing       ND      SD     yellow             8.96            21  Unknown     N/A  1934.90\n14       Hodge      Richard        cally       GA      TN  gainsboro             4.99            18     Gram     N/A  4040.96\n15     Wilhite      Cecelia          ese       TN      AL      light             9.83            44    Ounce     N/A   367.84\n16                                  able       FL      AL      peach             1.30            14     Case   small   908.85\n17       Greer       Marina        ation       FL      TN       puff             4.61            12   Bundle     N/A  1946.23\n18      Taylor       Harold         anti       GA      AL      lemon            59.31            20    Ounce     N/A      NaN\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.411056,
                    "execution_time": 0.187439,
                    "compile_time": 0.120207,
                    "planning_time": 0.079479
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.725299,
                    "execution_time": 2.111267,
                    "compile_time": 3.435445,
                    "planning_time": 0.150203
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH SSALES AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" AS \"I_UNITS\" , \"ITEM\".\"I_SIZE\" AS \"I_SIZE\" , SUM ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SSALES\".\"CA_STATE\" AS \"CA_STATE\" , \"SSALES\".\"S_STATE\" AS \"S_STATE\" , \"SSALES\".\"I_COLOR\" AS \"I_COLOR\" , \"SSALES\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SSALES\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SSALES\".\"I_UNITS\" AS \"I_UNITS\" , \"SSALES\".\"I_SIZE\" AS \"I_SIZE\" , \"SSALES\".\"NETPAID\" AS \"NETPAID\" FROM \"SSALES\" AS \"SSALES\"",
                "rewrite": "WITH SSALES AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" AS \"I_UNITS\" , \"ITEM\".\"I_SIZE\" AS \"I_SIZE\" , SUM ( \"STORE_SALES\".\"SS_NET_PAID\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SSALES\".\"CA_STATE\" AS \"CA_STATE\" , \"SSALES\".\"S_STATE\" AS \"S_STATE\" , \"SSALES\".\"I_COLOR\" AS \"I_COLOR\" , \"SSALES\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SSALES\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SSALES\".\"I_UNITS\" AS \"I_UNITS\" , \"SSALES\".\"I_SIZE\" AS \"I_SIZE\" , \"SSALES\".\"NETPAID\" AS \"NETPAID\" FROM \"SSALES\" AS \"SSALES\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name s_store_name ca_state s_state    i_color  i_current_price  i_manager_id  i_units  i_size  netpaid\n0        Croft         Jeff         anti       FL      AL        hot            83.46            36    Bunch     N/A   985.53\n1        Bliss       Robert         anti       AL      AL     salmon             1.51            31       Oz  medium     0.06\n2       Mowery        James         able       FL      AL       grey             2.41             5      Tsp     N/A   503.73\n3    Patterson       Robert          ese       AL      AL     powder             9.92            10    Pound     N/A   331.30\n4       Burton       Adrian          pri       AL      AL        sky             0.67            29      Tsp     N/A   844.64\n5      Parrish      Phillip          ese       GA      AL      wheat             0.37            33     Dram  petite   345.31\n6       Burton       Adrian          pri       AL      AL      linen             5.75            28      Tbl     N/A   775.92\n7      Parrish      Phillip          ese       GA      AL      wheat             6.21            46    Bunch  petite   167.64\n8    Robertson      Heather         anti       TN      AL      linen            99.99            14   Bundle     N/A   643.84\n9      Ledford    Margarete        ation       TN      TN      sandy             4.27            21    Bunch  petite   904.68\n10       Brink                      eing       MN      SD        sky             5.72            37    Gross  medium  6486.72\n11        Hart         Sara         anti       GA      AL      slate             6.52            46     Each     N/A   198.23\n12       Smith       Joshua         eing       MS      SD       pale             1.28             5     Gram     N/A    18.62\n13       Sloan    Cassandra         eing       ND      SD     yellow             8.96            21  Unknown     N/A  1934.90\n14       Hodge      Richard        cally       GA      TN  gainsboro             4.99            18     Gram     N/A  4040.96\n15     Wilhite      Cecelia          ese       TN      AL      light             9.83            44    Ounce     N/A   367.84\n16                                  able       FL      AL      peach             1.30            14     Case   small   908.85\n17       Greer       Marina        ation       FL      TN       puff             4.61            12   Bundle     N/A  1946.23\n18      Taylor       Harold         anti       GA      AL      lemon            59.31            20    Ounce     N/A      NaN\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "\n\nwith /* TPC-DS query24.tpl 0.92 part2 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\n  and s_market_id = 5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\nfrom ssales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"SSALES\" AS \"SSALES\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.226843,
                    "execution_time": 0.124339,
                    "compile_time": 0.000577,
                    "planning_time": 0.063436,
                    "create_size": 32
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.497822,
                    "execution_time": 0.085912,
                    "compile_time": 11.180759,
                    "planning_time": 0.145707,
                    "create_size": 32
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*   c_last_name\n0     Rodrigue\n1     Thompson\n2       Brooks\n3        Croft\n4      Stanton\n5     Enriquez\n6      Hancock\n7      Hancock\n8     Ackerman\n9             \n10     Krueger\n11        Moon\n12       Brady\n13     Parnell\n14     Parnell\n15       Patel\n16        Vega\n17       Ramos\n18      Martin\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.043796,
                    "execution_time": 0.007675,
                    "compile_time": 0.028033,
                    "planning_time": 0.0027
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 2.936429,
                    "execution_time": 0.007088,
                    "compile_time": 2.884325,
                    "planning_time": 0.037743
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*   c_last_name\n0     Rodrigue\n1     Thompson\n2       Brooks\n3        Croft\n4      Stanton\n5     Enriquez\n6      Hancock\n7      Hancock\n8     Ackerman\n9             \n10     Krueger\n11        Moon\n12       Brady\n13     Parnell\n14     Parnell\n15       Patel\n16        Vega\n17       Ramos\n18      Martin\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "with /* TPC-DS query24.tpl 0.92 part2 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(SS_SALES_PRICE) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\n  and s_market_id = 5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'light'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" WHERE \"SSALES\".\"I_COLOR\" = 'light' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.412726,
                    "execution_time": 0.211079,
                    "compile_time": 0.096202,
                    "planning_time": 0.064587,
                    "create_size": 64
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.940879,
                    "execution_time": 0.221101,
                    "compile_time": 6.524291,
                    "planning_time": 0.146248,
                    "create_size": 64
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" WHERE \"SPEQLITE_TEMP_TABLE_3\".\"I_COLOR\" = 'light' GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.152822,
                    "execution_time": 0.037897,
                    "compile_time": 0.083688,
                    "planning_time": 0.004783,
                    "create_size": 7
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.229851,
                    "execution_time": 0.039452,
                    "compile_time": 6.099083,
                    "planning_time": 0.059393,
                    "create_size": 7
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0    Jennings       Ronald         anti  21.53\n1      Porter       Gerald         able  36.68\n2     Wilhite      Cecelia          ese  19.36\n3     Whitley       Martin         anti   3.49\n4      Crosby       Kristi         eing  44.32\n5     Jackson       Brenda        cally  31.45*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.046485,
                    "execution_time": 0.007772,
                    "compile_time": 0.029794,
                    "planning_time": 0.003194
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 2.890083,
                    "execution_time": 0.007731,
                    "compile_time": 2.836508,
                    "planning_time": 0.038271
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" WHERE \"SPEQLITE_TEMP_TABLE_3\".\"I_COLOR\" = 'light' GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0    Jennings       Ronald         anti  21.53\n1      Porter       Gerald         able  36.68\n2     Wilhite      Cecelia          ese  19.36\n3     Whitley       Martin         anti   3.49\n4      Crosby       Kristi         eing  44.32\n5     Jackson       Brenda        cally  31.45*/"
    },
    {
        "input": "with /* TPC-DS query24.tpl 0.92 part2 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\n  and s_market_id = 5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'light'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" WHERE \"SSALES\".\"I_COLOR\" = 'light' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0    Jennings       Ronald         anti  21.53\n1      Porter       Gerald         able  36.68\n2     Wilhite      Cecelia          ese  19.36\n3     Whitley       Martin         anti   3.49\n4      Crosby       Kristi         eing  44.32\n5     Jackson       Brenda        cally  31.45*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016049,
                    "execution_time": 0.007308,
                    "compile_time": 4e-05,
                    "planning_time": 0.003053
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051555,
                    "execution_time": 0.007358,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.038318
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" WHERE \"SPEQLITE_TEMP_TABLE_3\".\"I_COLOR\" = 'light' GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\"",
                "rewrite": "SELECT \"C_LAST_NAME\" AS \"C_LAST_NAME\", \"C_FIRST_NAME\" AS \"C_FIRST_NAME\", \"S_STORE_NAME\" AS \"S_STORE_NAME\", \"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0    Jennings       Ronald         anti  21.53\n1      Porter       Gerald         able  36.68\n2     Wilhite      Cecelia          ese  19.36\n3     Whitley       Martin         anti   3.49\n4      Crosby       Kristi         eing  44.32\n5     Jackson       Brenda        cally  31.45*/"
    },
    {
        "input": "\n\nwith /* TPC-DS query24.tpl 0.92 part2 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\n  and s_market_id = 5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'light'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" WHERE \"SSALES\".\"I_COLOR\" = 'light' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0    Jennings       Ronald         anti  21.53\n1      Porter       Gerald         able  36.68\n2     Wilhite      Cecelia          ese  19.36\n3     Whitley       Martin         anti   3.49\n4      Crosby       Kristi         eing  44.32\n5     Jackson       Brenda        cally  31.45*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.117357,
                    "execution_time": 0.007857,
                    "compile_time": 0.100628,
                    "planning_time": 0.003109
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.016886,
                    "execution_time": 0.00748,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.003443
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" WHERE \"SPEQLITE_TEMP_TABLE_3\".\"I_COLOR\" = 'light' GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\"",
                "rewrite": "SELECT \"C_LAST_NAME\" AS \"C_LAST_NAME\", \"C_FIRST_NAME\" AS \"C_FIRST_NAME\", \"S_STORE_NAME\" AS \"S_STORE_NAME\", \"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0    Jennings       Ronald         anti  21.53\n1      Porter       Gerald         able  36.68\n2     Wilhite      Cecelia          ese  19.36\n3     Whitley       Martin         anti   3.49\n4      Crosby       Kristi         eing  44.32\n5     Jackson       Brenda        cally  31.45*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "\n\nwith /* TPC-DS query24.tpl 0.92 part2 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\n  and s_market_id = 5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'light'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\n                           from ssales)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) , \"_U_0\" AS ( SELECT 0.05 * AVG ( \"SSALES\".\"NETPAID\" ) AS \"_COL_0\" FROM \"SSALES\" AS \"SSALES\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"SSALES\".\"I_COLOR\" = 'light' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" HAVING MAX ( \"_U_0\".\"_COL_0\" ) < SUM ( \"SSALES\".\"NETPAID\" )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT 0.05 * AVG ( \"SPEQLITE_TEMP_TABLE_3\".\"NETPAID\" ) AS \"_COL_0\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.141865,
                    "execution_time": 0.037509,
                    "compile_time": 0.076989,
                    "planning_time": 0.003197,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.089122,
                    "execution_time": 0.038383,
                    "compile_time": 5.965156,
                    "planning_time": 0.057134,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE \"SPEQLITE_TEMP_TABLE_3\".\"I_COLOR\" = 'light' GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" ) < SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"NETPAID\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.198629,
                    "execution_time": 0.046777,
                    "compile_time": 0.119777,
                    "planning_time": 0.006385,
                    "create_size": 7
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.309368,
                    "execution_time": 0.047418,
                    "compile_time": 6.170112,
                    "planning_time": 0.061548,
                    "create_size": 7
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0    Jennings       Ronald         anti  21.53\n1      Porter       Gerald         able  36.68\n2     Jackson       Brenda        cally  31.45\n3     Wilhite      Cecelia          ese  19.36\n4     Whitley       Martin         anti   3.49\n5      Crosby       Kristi         eing  44.32*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016565,
                    "execution_time": 0.007533,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.003273
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051447,
                    "execution_time": 0.007479,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.038017
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE \"SPEQLITE_TEMP_TABLE_3\".\"I_COLOR\" = 'light' GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" ) < SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"NETPAID\" )",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0    Jennings       Ronald         anti  21.53\n1      Porter       Gerald         able  36.68\n2     Jackson       Brenda        cally  31.45\n3     Wilhite      Cecelia          ese  19.36\n4     Whitley       Martin         anti   3.49\n5      Crosby       Kristi         eing  44.32*/"
    },
    {
        "input": "\n\nwith /* TPC-DS query24.tpl 0.92 part2 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\n  and s_market_id = 5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'light'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\n                           from ssales)\norder by c_last_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) , \"_U_0\" AS ( SELECT 0.05 * AVG ( \"SSALES\".\"NETPAID\" ) AS \"_COL_0\" FROM \"SSALES\" AS \"SSALES\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"SSALES\".\"I_COLOR\" = 'light' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" HAVING MAX ( \"_U_0\".\"_COL_0\" ) < SUM ( \"SSALES\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"C_LAST_NAME\" LIMIT 21",
                "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0      Crosby       Kristi         eing  44.32\n1     Jackson       Brenda        cally  31.45\n2    Jennings       Ronald         anti  21.53\n3      Porter       Gerald         able  36.68\n4     Whitley       Martin         anti   3.49\n5     Wilhite      Cecelia          ese  19.36*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.035688,
                    "execution_time": 0.00832,
                    "compile_time": 0.018057,
                    "planning_time": 0.003507
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.913434,
                    "execution_time": 0.008912,
                    "compile_time": 4.859477,
                    "planning_time": 0.038107
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE \"SPEQLITE_TEMP_TABLE_3\".\"I_COLOR\" = 'light' GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" ) < SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"C_LAST_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0      Crosby       Kristi         eing  44.32\n1     Jackson       Brenda        cally  31.45\n2    Jennings       Ronald         anti  21.53\n3      Porter       Gerald         able  36.68\n4     Whitley       Martin         anti   3.49\n5     Wilhite      Cecelia          ese  19.36*/"
    },
    {
        "input": "\n\nwith /* TPC-DS query24.tpl 0.92 part2 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\n  and s_market_id = 5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'light'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\n                           from ssales)\norder by c_last_name\n        ,c_first_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) , \"_U_0\" AS ( SELECT 0.05 * AVG ( \"SSALES\".\"NETPAID\" ) AS \"_COL_0\" FROM \"SSALES\" AS \"SSALES\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"SSALES\".\"I_COLOR\" = 'light' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" HAVING MAX ( \"_U_0\".\"_COL_0\" ) < SUM ( \"SSALES\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"C_LAST_NAME\" , \"C_FIRST_NAME\" LIMIT 21",
                "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0      Crosby       Kristi         eing  44.32\n1     Jackson       Brenda        cally  31.45\n2    Jennings       Ronald         anti  21.53\n3      Porter       Gerald         able  36.68\n4     Whitley       Martin         anti   3.49\n5     Wilhite      Cecelia          ese  19.36*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.032962,
                    "execution_time": 0.008291,
                    "compile_time": 0.015663,
                    "planning_time": 0.0034
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.663025,
                    "execution_time": 0.008681,
                    "compile_time": 4.61378,
                    "planning_time": 0.038615
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE \"SPEQLITE_TEMP_TABLE_3\".\"I_COLOR\" = 'light' GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" ) < SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0      Crosby       Kristi         eing  44.32\n1     Jackson       Brenda        cally  31.45\n2    Jennings       Ronald         anti  21.53\n3      Porter       Gerald         able  36.68\n4     Whitley       Martin         anti   3.49\n5     Wilhite      Cecelia          ese  19.36*/"
    },
    {
        "input": "\n\nwith /* TPC-DS query24.tpl 0.92 part2 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\n  and s_market_id = 5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'light'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\n                           from ssales)\norder by c_last_name\n        ,c_first_name\n        ,s_store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) , \"_U_0\" AS ( SELECT 0.05 * AVG ( \"SSALES\".\"NETPAID\" ) AS \"_COL_0\" FROM \"SSALES\" AS \"SSALES\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"SSALES\".\"I_COLOR\" = 'light' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" HAVING MAX ( \"_U_0\".\"_COL_0\" ) < SUM ( \"SSALES\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"S_STORE_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"C_LAST_NAME\" , \"C_FIRST_NAME\" , \"S_STORE_NAME\" LIMIT 21",
                "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0      Crosby       Kristi         eing  44.32\n1     Jackson       Brenda        cally  31.45\n2    Jennings       Ronald         anti  21.53\n3      Porter       Gerald         able  36.68\n4     Whitley       Martin         anti   3.49\n5     Wilhite      Cecelia          ese  19.36*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.031673,
                    "execution_time": 0.008233,
                    "compile_time": 0.014172,
                    "planning_time": 0.003535
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.028478,
                    "execution_time": 0.008668,
                    "compile_time": 2.97912,
                    "planning_time": 0.038911
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE \"SPEQLITE_TEMP_TABLE_3\".\"I_COLOR\" = 'light' GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" ) < SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"S_STORE_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"S_STORE_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0      Crosby       Kristi         eing  44.32\n1     Jackson       Brenda        cally  31.45\n2    Jennings       Ronald         anti  21.53\n3      Porter       Gerald         able  36.68\n4     Whitley       Martin         anti   3.49\n5     Wilhite      Cecelia          ese  19.36*/"
    },
    {
        "input": "\n\nwith /* TPC-DS query24.tpl 0.92 part2 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\n  and s_market_id = 5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'light'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\n                           from ssales)\norder by c_last_name\n        ,c_first_name\n        ,s_store_name\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) , \"_U_0\" AS ( SELECT 0.05 * AVG ( \"SSALES\".\"NETPAID\" ) AS \"_COL_0\" FROM \"SSALES\" AS \"SSALES\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"SSALES\".\"I_COLOR\" = 'light' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" HAVING MAX ( \"_U_0\".\"_COL_0\" ) < SUM ( \"SSALES\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"S_STORE_NAME\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"C_LAST_NAME\" , \"C_FIRST_NAME\" , \"S_STORE_NAME\" LIMIT 21",
                "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0      Crosby       Kristi         eing  44.32\n1     Jackson       Brenda        cally  31.45\n2    Jennings       Ronald         anti  21.53\n3      Porter       Gerald         able  36.68\n4     Whitley       Martin         anti   3.49\n5     Wilhite      Cecelia          ese  19.36*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017502,
                    "execution_time": 0.008255,
                    "compile_time": 6.9e-05,
                    "planning_time": 0.003573
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017741,
                    "execution_time": 0.008279,
                    "compile_time": 6.5e-05,
                    "planning_time": 0.003634
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE \"SPEQLITE_TEMP_TABLE_3\".\"I_COLOR\" = 'light' GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" ) < SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"S_STORE_NAME\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"S_STORE_NAME\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0      Crosby       Kristi         eing  44.32\n1     Jackson       Brenda        cally  31.45\n2    Jennings       Ronald         anti  21.53\n3      Porter       Gerald         able  36.68\n4     Whitley       Martin         anti   3.49\n5     Wilhite      Cecelia          ese  19.36*/"
    }
]