[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "with /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk as customer_sk\n      ,ss_item_sk as item_sk\nfrom store_sales \n)\nselect * from ssci\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LIMIT 21",
                "preview": "\n/*    customer_sk  item_sk\n0        170787    46690\n1        170787    18379\n2        170787    21746\n3        170787    65575\n4        170787    76352\n5        170787    26173\n6        170787    46490\n7        170787    22412\n8        170787    32746\n9         55148    56500\n10        55148    52033\n11        55148    80089\n12        55148    47221\n13        55148    32629\n14        55148    59738\n15        55148    51200\n16        55148    55094\n17        55148    81062\n18        55148    70714\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.03484,
                    "execution_time": 0.0041,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.024507
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.099266,
                    "execution_time": 0.003977,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.080907
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\", \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\"",
                "rewrite": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\", \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\""
            }
        ],
        "preview": "\n/*    customer_sk  item_sk\n0        170787    46690\n1        170787    18379\n2        170787    21746\n3        170787    65575\n4        170787    76352\n5        170787    26173\n6        170787    46490\n7        170787    22412\n8        170787    32746\n9         55148    56500\n10        55148    52033\n11        55148    80089\n12        55148    47221\n13        55148    32629\n14        55148    59738\n15        55148    51200\n16        55148    55094\n17        55148    81062\n18        55148    70714\n...*/"
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk as customer_sk\n      ,ss_item_sk as item_sk\nfrom store_sales, date_dim\nwhere ss_sold_date_sk = d_date_sk\n)\nselect * from ssci\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.662577,
                    "execution_time": 0.510121,
                    "compile_time": 0.000287,
                    "planning_time": 0.031867,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.744545,
                    "execution_time": 0.517904,
                    "compile_time": 0.000293,
                    "planning_time": 0.099149,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    customer_sk  item_sk\n0        470794     7141\n1        470794    90370\n2        470794    34108\n3        475047    77581\n4        475047    95692\n5        475047    83560\n6        475047    38084\n7        475047    88274\n8        475047    61202\n9        475047    88729\n10       475047    69703\n11       475047    83104\n12       475047    90596\n13       475047    83642\n14       149133    24280\n15       149133    22852\n16       149133    30358\n17       149133    66616\n18       149133    23390\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016759,
                    "execution_time": 0.007807,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003237
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055033,
                    "execution_time": 0.00754,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.038404
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\", \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    customer_sk  item_sk\n0        470794     7141\n1        470794    90370\n2        470794    34108\n3        475047    77581\n4        475047    95692\n5        475047    83560\n6        475047    38084\n7        475047    88274\n8        475047    61202\n9        475047    88729\n10       475047    69703\n11       475047    83104\n12       475047    90596\n13       475047    83642\n14       149133    24280\n15       149133    22852\n16       149133    30358\n17       149133    66616\n18       149133    23390\n...*/"
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\n)\nselect * from ssci\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 LIMIT 21",
                "preview": "\n/*    customer_sk  item_sk\n0         59339    47474\n1         59339    47474\n2         59339    47474\n3         59339    47474\n4         59339    47474\n5         59339    47474\n6         59339    47474\n7         59339    47474\n8         59339    47474\n9         59339    47474\n10        59339    47474\n11        59339    47474\n12        59339    47474\n13        59339    47474\n14        59339    47474\n15        59339    47474\n16        59339    47474\n17        59339    47474\n18        59339    47474\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.050346,
                    "execution_time": 0.009918,
                    "compile_time": 9.9e-05,
                    "planning_time": 0.032818
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.103992,
                    "execution_time": 0.010758,
                    "compile_time": 9e-05,
                    "planning_time": 0.082191
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\", \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180"
            }
        ],
        "preview": "\n/*    customer_sk  item_sk\n0         59339    47474\n1         59339    47474\n2         59339    47474\n3         59339    47474\n4         59339    47474\n5         59339    47474\n6         59339    47474\n7         59339    47474\n8         59339    47474\n9         59339    47474\n10        59339    47474\n11        59339    47474\n12        59339    47474\n13        59339    47474\n14        59339    47474\n15        59339    47474\n16        59339    47474\n17        59339    47474\n18        59339    47474\n...*/"
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk, ss_item_sk\n)\nselect * from ssci\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) SELECT \"SSCI\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SSCI\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SSCI\" AS \"SSCI\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.505353,
                    "execution_time": 0.335926,
                    "compile_time": 0.000355,
                    "planning_time": 0.045205,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.557503,
                    "execution_time": 0.328205,
                    "compile_time": 0.00035,
                    "planning_time": 0.101541,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    customer_sk  item_sk\n0        283021    67813\n1        283021    66902\n2        283021     5752\n3        245840    29215\n4        245840    98788\n5        303186    51104\n6        303186    43483\n7        303186    65366\n8        301224    54097\n9        318457    23828\n10       318457    30064\n11       318457    14650\n12       160836    43886\n13       280629    63718\n14        10029    40285\n15        10029    38884\n16       457949    80578\n17       457949    22576\n18       356592    52190\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016362,
                    "execution_time": 0.007281,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003201
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053569,
                    "execution_time": 0.00741,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038669
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    customer_sk  item_sk\n0        283021    67813\n1        283021    66902\n2        283021     5752\n3        245840    29215\n4        245840    98788\n5        303186    51104\n6        303186    43483\n7        303186    65366\n8        301224    54097\n9        318457    23828\n10       318457    30064\n11       318457    14650\n12       160836    43886\n13       280629    63718\n14        10029    40285\n15        10029    38884\n16       457949    80578\n17       457949    22576\n18       356592    52190\n...*/"
    },
    {
        "input": "with /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales, date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk\n)\n/*CURSOR_IDENTIFIER*/\nSELECT * FROM ssci; -- Placeholder continuation query",
        "optimize": [
            "WITH \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) SELECT \"SSCI\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SSCI\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SSCI\" AS \"SSCI\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    customer_sk  item_sk\n0        294416    65605\n1        294416    76054\n2        164350    63352\n3           264    18607\n4           264    34222\n5           264    75691\n6        227185    92036\n7        227185    31630\n8        227185    66181\n9        366170    10772\n10       432167    59254\n11       432167    92182\n12       167887    89452\n13       308778    79574\n14       308778    60974\n15       308778    61604\n16       308778    96586\n17        69313    17188\n18        69313    51932\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016735,
                    "execution_time": 0.007716,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003105
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.016619,
                    "execution_time": 0.00747,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003215
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    customer_sk  item_sk\n0        294416    65605\n1        294416    76054\n2        164350    63352\n3           264    18607\n4           264    34222\n5           264    75691\n6        227185    92036\n7        227185    31630\n8        227185    66181\n9        366170    10772\n10       432167    59254\n11       432167    92182\n12       167887    89452\n13       308778    79574\n14       308778    60974\n15       308778    61604\n16       308778    96586\n17        69313    17188\n18        69313    51932\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n      ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by cs_bill_customer_sk\n        ,cs_item_sk)\n/*CURSOR_IDENTIFIER*/ select * from ssci, csci",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 ) , \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"CSCI\" AS ( SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT \"SSCI\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SSCI\".\"ITEM_SK\" AS \"ITEM_SK\" , \"CSCI\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"CSCI\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SSCI\" AS \"SSCI\" CROSS JOIN \"CSCI\" AS \"CSCI\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.081367,
                    "execution_time": 0.031263,
                    "compile_time": 0.000265,
                    "planning_time": 0.025348,
                    "create_size": 20
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.149288,
                    "execution_time": 0.032045,
                    "compile_time": 0.00027,
                    "planning_time": 0.091716,
                    "create_size": 20
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.483943,
                    "execution_time": 0.333075,
                    "compile_time": 0.000358,
                    "planning_time": 0.026576,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.542113,
                    "execution_time": 0.326519,
                    "compile_time": 0.000366,
                    "planning_time": 0.090797,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.434321,
                    "execution_time": 0.278378,
                    "compile_time": 0.000407,
                    "planning_time": 0.028952,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.513231,
                    "execution_time": 0.293095,
                    "compile_time": 0.000359,
                    "planning_time": 0.092463,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_4\".\"ITEM_SK\" AS \"ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK_COL_2\" , \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_SK\" AS \"ITEM_SK_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_4\".\"ITEM_SK\" AS \"ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK_COL_2\" , \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_SK\" AS \"ITEM_SK_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*    customer_sk  item_sk  customer_sk_col_2  item_sk_col_3\n0         98044    93331             347305          39790\n1         98044    93331             104119           1016\n2         98044    93331             201279          41498\n3         98044    93331             128556          89972\n4         98044    93331             128556          87055\n5         98044    93331             447305          95272\n6         98044    93331             447305          19603\n7         98044    93331             447305          93763\n8         98044    93331             206754            565\n9         98044    93331             452290          45544\n10        98044    93331             452290          28744\n11        98044    93331             229100          66146\n12        98044    93331             229100          81997\n13        98044    93331             229100          26038\n14        98044    93331              17951          12814\n15        98044    93331             493936          72193\n16        98044    93331             493936          45331\n17        98044    93331             305888          56872\n18        98044    93331             386579          97330\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.063499,
                    "execution_time": 0.051657,
                    "compile_time": 8.8e-05,
                    "planning_time": 0.004587
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.11403,
                    "execution_time": 0.052033,
                    "compile_time": 9.8e-05,
                    "planning_time": 0.040702
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_4\".\"ITEM_SK\" AS \"ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_SK\" AS \"ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_4\".\"ITEM_SK\" AS \"ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK_COL_2\" , \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_SK\" AS \"ITEM_SK_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*    customer_sk  item_sk  customer_sk_col_2  item_sk_col_3\n0         98044    93331             347305          39790\n1         98044    93331             104119           1016\n2         98044    93331             201279          41498\n3         98044    93331             128556          89972\n4         98044    93331             128556          87055\n5         98044    93331             447305          95272\n6         98044    93331             447305          19603\n7         98044    93331             447305          93763\n8         98044    93331             206754            565\n9         98044    93331             452290          45544\n10        98044    93331             452290          28744\n11        98044    93331             229100          66146\n12        98044    93331             229100          81997\n13        98044    93331             229100          26038\n14        98044    93331              17951          12814\n15        98044    93331             493936          72193\n16        98044    93331             493936          45331\n17        98044    93331             305888          56872\n18        98044    93331             386579          97330\n...*/"
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n      ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by cs_bill_customer_sk\n        ,cs_item_sk)\n select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only from ssci, csci\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 ) , \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"CSCI\" AS ( SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( CASE WHEN \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" FROM \"SSCI\" AS \"SSCI\" CROSS JOIN \"CSCI\" AS \"CSCI\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.316207,
                    "execution_time": 0.238149,
                    "compile_time": 0.000265,
                    "planning_time": 0.003126,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.401931,
                    "execution_time": 0.262934,
                    "compile_time": 0.000256,
                    "planning_time": 0.060647,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.29236,
                    "execution_time": 0.216573,
                    "compile_time": 0.000251,
                    "planning_time": 0.003004,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.343502,
                    "execution_time": 0.20692,
                    "compile_time": 0.000256,
                    "planning_time": 0.060002,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\"",
                "rewrite": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n      ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by cs_bill_customer_sk\n        ,cs_item_sk)\n select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\nfrom (select * from ssci) as ssci left join (select * from csci) as csci on ssci.customer_sk = csci.customer_sk /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 ) , \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"CSCI\" AS ( SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( CASE WHEN \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" FROM \"SSCI\" AS \"SSCI\" LEFT JOIN \"CSCI\" AS \"CSCI\" ON \"CSCI\".\"CUSTOMER_SK\" = \"SSCI\".\"CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.233273,
                    "execution_time": 0.195743,
                    "compile_time": 0.000386,
                    "planning_time": 0.007487,
                    "create_size": 5
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.284496,
                    "execution_time": 0.187324,
                    "compile_time": 0.001328,
                    "planning_time": 0.062863,
                    "create_size": 5
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"STORE_ONLY\" AS \"STORE_ONLY\" , \"SPEQLITE_TEMP_TABLE_8\".\"CATALOG_ONLY\" AS \"CATALOG_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*   store_only  catalog_only\n0     2852554             0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015915,
                    "execution_time": 0.006845,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003246
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051733,
                    "execution_time": 0.007208,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.03864
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"STORE_ONLY\" AS \"STORE_ONLY\" , \"SPEQLITE_TEMP_TABLE_8\".\"CATALOG_ONLY\" AS \"CATALOG_ONLY\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*   store_only  catalog_only\n0     2852554             0*/"
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales join date_dim on ss_sold_date_sk = d_date_sk\n\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n      ,cs_item_sk item_sk\nfrom catalog_sales join date_dim on cs_sold_date_sk = d_date_sk\n\n  and d_month_seq between 1180 and 1180 + 11\ngroup by cs_bill_customer_sk\n        ,cs_item_sk)\n select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\nfrom ssci full outer join csci on ssci.customer_sk = csci.customer_sk /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 ) , \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"CSCI\" AS ( SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( CASE WHEN \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SSCI\" AS \"SSCI\" FULL JOIN \"CSCI\" AS \"CSCI\" ON \"CSCI\".\"CUSTOMER_SK\" = \"SSCI\".\"CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.208184,
                    "execution_time": 0.169658,
                    "compile_time": 0.00038,
                    "planning_time": 0.007816,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.474477,
                    "execution_time": 0.175818,
                    "compile_time": 0.190427,
                    "planning_time": 0.072729,
                    "create_size": 6
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"STORE_ONLY\" AS \"STORE_ONLY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CATALOG_ONLY\" AS \"CATALOG_ONLY\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_AND_CATALOG\" AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*   store_only  catalog_only  store_and_catalog\n0     2852554       1084505           30552714*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015968,
                    "execution_time": 0.006761,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.00336
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053419,
                    "execution_time": 0.007529,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.038456
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"STORE_ONLY\" AS \"STORE_ONLY\" , \"SPEQLITE_TEMP_TABLE_9\".\"CATALOG_ONLY\" AS \"CATALOG_ONLY\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_AND_CATALOG\" AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*   store_only  catalog_only  store_and_catalog\n0     2852554       1084505           30552714*/"
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n      ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by cs_bill_customer_sk\n        ,cs_item_sk)\n select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 ) , \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"CSCI\" AS ( SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( CASE WHEN \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SSCI\" AS \"SSCI\" FULL JOIN \"CSCI\" AS \"CSCI\" ON \"CSCI\".\"CUSTOMER_SK\" = \"SSCI\".\"CUSTOMER_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"STORE_ONLY\" AS \"STORE_ONLY\" , \"CATALOG_ONLY\" AS \"CATALOG_ONLY\" , \"STORE_AND_CATALOG\" AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*   store_only  catalog_only  store_and_catalog\n0     2852554       1084505           30552714*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016422,
                    "execution_time": 0.007031,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.00343
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052321,
                    "execution_time": 0.007712,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.038573
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_SK\"",
                "rewrite": "SELECT \"STORE_ONLY\" AS \"STORE_ONLY\", \"CATALOG_ONLY\" AS \"CATALOG_ONLY\", \"STORE_AND_CATALOG\" AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*   store_only  catalog_only  store_and_catalog\n0     2852554       1084505           30552714*/"
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n      ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by cs_bill_customer_sk\n        ,cs_item_sk)\n select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\n                               and ssci.item_sk = csci.item_sk)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 ) , \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"CSCI\" AS ( SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( CASE WHEN \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SSCI\" AS \"SSCI\" FULL JOIN \"CSCI\" AS \"CSCI\" ON \"CSCI\".\"CUSTOMER_SK\" = \"SSCI\".\"CUSTOMER_SK\" AND \"CSCI\".\"ITEM_SK\" = \"SSCI\".\"ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" FULL JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.153416,
                    "execution_time": 0.111482,
                    "compile_time": 0.000414,
                    "planning_time": 0.008579,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.214356,
                    "execution_time": 0.114449,
                    "compile_time": 0.001319,
                    "planning_time": 0.066319,
                    "create_size": 6
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"STORE_ONLY\" AS \"STORE_ONLY\" , \"SPEQLITE_TEMP_TABLE_10\".\"CATALOG_ONLY\" AS \"CATALOG_ONLY\" , \"SPEQLITE_TEMP_TABLE_10\".\"STORE_AND_CATALOG\" AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*   store_only  catalog_only  store_and_catalog\n0     5380967       2842360                614*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016282,
                    "execution_time": 0.007016,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003378
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05278,
                    "execution_time": 0.00721,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.039128
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" FULL JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"ITEM_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"STORE_ONLY\" AS \"STORE_ONLY\" , \"SPEQLITE_TEMP_TABLE_10\".\"CATALOG_ONLY\" AS \"CATALOG_ONLY\" , \"SPEQLITE_TEMP_TABLE_10\".\"STORE_AND_CATALOG\" AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*   store_only  catalog_only  store_and_catalog\n0     5380967       2842360                614*/"
    },
    {
        "input": "-- start template query97.tpl query 38 in stream 0\nwith /* TPC-DS query97.tpl 0.38 */ ssci as (\nselect ss_customer_sk customer_sk\n      ,ss_item_sk item_sk\nfrom store_sales,date_dim\nwhere ss_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by ss_customer_sk\n        ,ss_item_sk),\ncsci as(\n select cs_bill_customer_sk customer_sk\n      ,cs_item_sk item_sk\nfrom catalog_sales,date_dim\nwhere cs_sold_date_sk = d_date_sk\n  and d_month_seq between 1180 and 1180 + 11\ngroup by cs_bill_customer_sk\n        ,cs_item_sk)\n select  sum(case when ssci.customer_sk is not null and csci.customer_sk is null then 1 else 0 end) store_only\n      ,sum(case when ssci.customer_sk is null and csci.customer_sk is not null then 1 else 0 end) catalog_only\n      ,sum(case when ssci.customer_sk is not null and csci.customer_sk is not null then 1 else 0 end) store_and_catalog\nfrom ssci full outer join csci on (ssci.customer_sk=csci.customer_sk\n                               and ssci.item_sk = csci.item_sk)\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1191 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1180 ) , \"SSCI\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"CSCI\" AS ( SELECT \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( CASE WHEN \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"CSCI\".\"CUSTOMER_SK\" IS NULL AND NOT \"SSCI\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SSCI\" AS \"SSCI\" FULL JOIN \"CSCI\" AS \"CSCI\" ON \"CSCI\".\"CUSTOMER_SK\" = \"SSCI\".\"CUSTOMER_SK\" AND \"CSCI\".\"ITEM_SK\" = \"SSCI\".\"ITEM_SK\" LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"STORE_ONLY\" AS \"STORE_ONLY\" , \"SPEQLITE_TEMP_TABLE_10\".\"CATALOG_ONLY\" AS \"CATALOG_ONLY\" , \"SPEQLITE_TEMP_TABLE_10\".\"STORE_AND_CATALOG\" AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*   store_only  catalog_only  store_and_catalog\n0     5380967       2842360                614*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.0162,
                    "execution_time": 0.006768,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003463
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.021646,
                    "execution_time": 0.007179,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.003477
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_ONLY\" , SUM ( CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"CATALOG_ONLY\" , SUM ( CASE WHEN NOT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" FULL JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_SK\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"ITEM_SK\" LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"STORE_ONLY\" AS \"STORE_ONLY\" , \"SPEQLITE_TEMP_TABLE_10\".\"CATALOG_ONLY\" AS \"CATALOG_ONLY\" , \"SPEQLITE_TEMP_TABLE_10\".\"STORE_AND_CATALOG\" AS \"STORE_AND_CATALOG\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 100"
            }
        ],
        "preview": "\n/*   store_only  catalog_only  store_and_catalog\n0     5380967       2842360                614*/"
    }
]