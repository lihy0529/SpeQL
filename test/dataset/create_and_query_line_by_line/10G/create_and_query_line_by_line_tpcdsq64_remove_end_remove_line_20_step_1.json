[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" CROSS JOIN \"CROSS_SALES\" AS \"CS2\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.255231,
                    "execution_time": 0.167417,
                    "compile_time": 0.000336,
                    "planning_time": 0.036636,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.494055,
                    "execution_time": 1.327325,
                    "compile_time": 0.002456,
                    "planning_time": 0.109001,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" CROSS JOIN \"CROSS_SALES\" AS \"CS2\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" CROSS JOIN \"CROSS_SALES\" AS \"CS2\"",
                "rewrite": "WITH CROSS_SALES AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" CROSS JOIN \"CROSS_SALES\" AS \"CS2\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\ncs1.store_zip = cs2.store_zip\n/*CURSOR_IDENTIFIER*/\n",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" AND \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" AND \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 7.508495,
                    "execution_time": 0.207583,
                    "compile_time": 0.001381,
                    "planning_time": 7.221175,
                    "create_size": 160
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 14.416719,
                    "execution_time": 2.504212,
                    "compile_time": 4.536448,
                    "planning_time": 7.289958,
                    "create_size": 160
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR_COL_19\" , \"CS2\".\"CNT\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.169512,
                    "execution_time": 0.050508,
                    "compile_time": 0.06367,
                    "planning_time": 0.009929,
                    "create_size": 120
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.553673,
                    "execution_time": 0.050331,
                    "compile_time": 6.37833,
                    "planning_time": 0.069053,
                    "create_size": 96
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_3\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_3\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_3\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_3\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_3\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_3\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_3\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_3\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_3\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_3\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*                   product_name store_name store_zip b_street_number b_street_name      b_city  b_zip c_street_number     c_street_name         c_city  c_zip  syear  cnt      s11      s21       s31      s12      s22       s32  syear_col_19  cnt_col_20\n0           ationeingpribarable       able     39231             933  Sunset Sixth   Riverside  49231             642              5th         Whitney  88339   2000  400  13392.0  15400.0       0.0  13392.0  15400.0       0.0          2000         400\n1         pricallyantieingcally       anti     36098             360      Dogwood   Mount Zion  68054             875    Forest Lincoln       Lakewood  18877   2002  400    832.0   1328.0    6940.0  12908.0  15488.0       0.0          1999         400\n2         pricallyantieingcally       anti     36098             360      Dogwood   Mount Zion  68054             875    Forest Lincoln       Lakewood  18877   2002  400    832.0   1328.0    6940.0  12684.0  17628.0    6468.0          2001         400\n3         pricallyantieingcally       anti     36098             360      Dogwood   Mount Zion  68054             875    Forest Lincoln       Lakewood  18877   2002  400    832.0   1328.0    6940.0  24656.0  38216.0  551628.0          2002         400\n4         pricallyantieingcally       anti     36098             360      Dogwood   Mount Zion  68054             875    Forest Lincoln       Lakewood  18877   2002  400    832.0   1328.0    6940.0  28120.0  44148.0       0.0          2000         400\n5         pricallyantieingcally       anti     36098             360      Dogwood   Mount Zion  68054             875    Forest Lincoln       Lakewood  18877   2002  400    832.0   1328.0    6940.0    832.0   1328.0    6940.0          2002         400\n6           esen stesecallyeing        ese     58370             612     River Lee    Florence  73394             632             West   Pleasant Hill  73604   1999  400   9568.0  15404.0       0.0   7132.0  13336.0       0.0          1999         400\n7           esen stesecallyeing        ese     58370             612     River Lee    Florence  73394             632             West   Pleasant Hill  73604   1999  400   9568.0  15404.0       0.0  29428.0  38256.0       0.0          1998         400\n8           esen stesecallyeing        ese     58370             612     River Lee    Florence  73394             632             West   Pleasant Hill  73604   1999  400   9568.0  15404.0       0.0   9568.0  15404.0       0.0          1999         400\n9          ablebareingationable      ought     33604             725       Walnut   Unionville  81711             306     Walnut Cherry      Oak Grove  68370   1999  400  13920.0  14752.0       0.0   3804.0   5704.0       0.0          1999         400\n10         ablebareingationable      ought     33604             725       Walnut   Unionville  81711             306     Walnut Cherry      Oak Grove  68370   1999  400  13920.0  14752.0       0.0  32672.0  35284.0   30708.0          1999         400\n11         ablebareingationable      ought     33604             725       Walnut   Unionville  81711             306     Walnut Cherry      Oak Grove  68370   1999  400  13920.0  14752.0       0.0  16264.0  21956.0       0.0          1999         400\n12         ablebareingationable      ought     33604             725       Walnut   Unionville  81711             306     Walnut Cherry      Oak Grove  68370   1999  400  13920.0  14752.0       0.0  13920.0  14752.0       0.0          1999         400\n13         ablebareingationable      ought     33604             725       Walnut   Unionville  81711             306     Walnut Cherry      Oak Grove  68370   1999  400  13920.0  14752.0       0.0  17632.0  23800.0       0.0          1998         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022128,
                    "execution_time": 0.007821,
                    "compile_time": 6.5e-05,
                    "planning_time": 0.006405
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.063763,
                    "execution_time": 0.008394,
                    "compile_time": 0.001296,
                    "planning_time": 0.043011
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_3\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_3\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_3\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_3\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_3\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_3\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_3\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_3\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_3\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_3\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_3\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*                   product_name store_name store_zip b_street_number b_street_name      b_city  b_zip c_street_number     c_street_name         c_city  c_zip  syear  cnt      s11      s21       s31      s12      s22       s32  syear_col_19  cnt_col_20\n0           ationeingpribarable       able     39231             933  Sunset Sixth   Riverside  49231             642              5th         Whitney  88339   2000  400  13392.0  15400.0       0.0  13392.0  15400.0       0.0          2000         400\n1         pricallyantieingcally       anti     36098             360      Dogwood   Mount Zion  68054             875    Forest Lincoln       Lakewood  18877   2002  400    832.0   1328.0    6940.0  12908.0  15488.0       0.0          1999         400\n2         pricallyantieingcally       anti     36098             360      Dogwood   Mount Zion  68054             875    Forest Lincoln       Lakewood  18877   2002  400    832.0   1328.0    6940.0  12684.0  17628.0    6468.0          2001         400\n3         pricallyantieingcally       anti     36098             360      Dogwood   Mount Zion  68054             875    Forest Lincoln       Lakewood  18877   2002  400    832.0   1328.0    6940.0  24656.0  38216.0  551628.0          2002         400\n4         pricallyantieingcally       anti     36098             360      Dogwood   Mount Zion  68054             875    Forest Lincoln       Lakewood  18877   2002  400    832.0   1328.0    6940.0  28120.0  44148.0       0.0          2000         400\n5         pricallyantieingcally       anti     36098             360      Dogwood   Mount Zion  68054             875    Forest Lincoln       Lakewood  18877   2002  400    832.0   1328.0    6940.0    832.0   1328.0    6940.0          2002         400\n6           esen stesecallyeing        ese     58370             612     River Lee    Florence  73394             632             West   Pleasant Hill  73604   1999  400   9568.0  15404.0       0.0   7132.0  13336.0       0.0          1999         400\n7           esen stesecallyeing        ese     58370             612     River Lee    Florence  73394             632             West   Pleasant Hill  73604   1999  400   9568.0  15404.0       0.0  29428.0  38256.0       0.0          1998         400\n8           esen stesecallyeing        ese     58370             612     River Lee    Florence  73394             632             West   Pleasant Hill  73604   1999  400   9568.0  15404.0       0.0   9568.0  15404.0       0.0          1999         400\n9          ablebareingationable      ought     33604             725       Walnut   Unionville  81711             306     Walnut Cherry      Oak Grove  68370   1999  400  13920.0  14752.0       0.0   3804.0   5704.0       0.0          1999         400\n10         ablebareingationable      ought     33604             725       Walnut   Unionville  81711             306     Walnut Cherry      Oak Grove  68370   1999  400  13920.0  14752.0       0.0  32672.0  35284.0   30708.0          1999         400\n11         ablebareingationable      ought     33604             725       Walnut   Unionville  81711             306     Walnut Cherry      Oak Grove  68370   1999  400  13920.0  14752.0       0.0  16264.0  21956.0       0.0          1999         400\n12         ablebareingationable      ought     33604             725       Walnut   Unionville  81711             306     Walnut Cherry      Oak Grove  68370   1999  400  13920.0  14752.0       0.0  13920.0  14752.0       0.0          1999         400\n13         ablebareingationable      ought     33604             725       Walnut   Unionville  81711             306     Walnut Cherry      Oak Grove  68370   1999  400  13920.0  14752.0       0.0  17632.0  23800.0       0.0          1998         400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" WHERE \"CS1\".\"SYEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEM_SK\" AS \"ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_2\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_2\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_2\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"S1\" AS \"S1\" , \"SPEQLITE_TEMP_TABLE_2\".\"S2\" AS \"S2\" , \"SPEQLITE_TEMP_TABLE_2\".\"S3\" AS \"S3\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.07742,
                    "execution_time": 0.038348,
                    "compile_time": 0.000298,
                    "planning_time": 0.00573,
                    "create_size": 40
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.349844,
                    "execution_time": 0.037706,
                    "compile_time": 0.213616,
                    "planning_time": 0.062101,
                    "create_size": 60
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR_COL_19\" , \"CS2\".\"CNT\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" WHERE \"CS1\".\"SYEAR\" = 2000",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.110654,
                    "execution_time": 0.04892,
                    "compile_time": 0.00039,
                    "planning_time": 0.011041,
                    "create_size": 96
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.185974,
                    "execution_time": 0.056471,
                    "compile_time": 0.003411,
                    "planning_time": 0.068679,
                    "create_size": 120
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*              product_name store_name store_zip b_street_number   b_street_name       b_city  b_zip c_street_number   c_street_name        c_city  c_zip  syear  cnt      s11      s21       s31      s12      s22      s32  syear_col_19  cnt_col_20\n0   antipriantibarbarought        pri     35709             832    Wilson Cedar  Springfield  69303             998  Center Dogwood       Oakland  59843   2000  400  23280.0  36084.0       0.0  11824.0  20572.0      0.0          2000         400\n1   antipriantibarbarought       able     35709             985       First 5th  Bunker Hill  30150             304            Oak         Empire  84145   2000  400   4220.0   6876.0       0.0  11824.0  20572.0      0.0          2000         400\n2   antipriantibarbarought       eing     33604              41   11th Woodland       Barnes  53788             736          Green         Marion  40399   2000  400  21716.0  36480.0       0.0  11824.0  20572.0      0.0          2000         400\n3   antipriantibarbarought      ation     58370             661           Park    Bridgeport  65817             138           13th    Five Points  56098   2000  400  23636.0  38524.0  145440.0  11824.0  20572.0      0.0          2000         400\n4   antipriantibarbarought       n st     39231             973   Lake Highland     Glendale  73951             525         Locust     Greenville  91387   2000  400    780.0   1192.0       0.0  11824.0  20572.0      0.0          2000         400\n5   antipriantibarbarought        bar     53604             212     Hill Willow    Greenwood  58828             297            3rd       Lakeview  28579   2000  400  11112.0  13220.0       0.0  11824.0  20572.0      0.0          2000         400\n6   antipriantibarbarought       anti     36098             684        9th Park   Enterprise  41757             372           11th       Franklin  29101   2000  400  11824.0  20572.0       0.0  11824.0  20572.0      0.0          2000         400\n7    n stoughteingantianti       able     38370             442       Park Park     Hamilton  62808             925           12th      Brookwood  70965   2000  400  20444.0  31688.0   98944.0  38528.0  72044.0      0.0          2001         400\n8    n stoughteingantianti        ese     35709             783      Cherry Oak  Cedar Grove  20411             324  Sycamore North    Pine Grove  34593   2000  400  19648.0  30844.0       0.0  38528.0  72044.0      0.0          2001         400\n9    n stoughteingantianti       able     36098             466          Cedar       Ashland  54244              60           10th       Woodlawn  44098   2000  400  19516.0  38248.0  534112.0  38528.0  72044.0      0.0          2001         400\n10   n stoughteingantianti       eing     31904             722           Lake   Bunker Hill  20150             491           Park    Maple Grove  68252   2000  400  24312.0  37440.0       0.0  38528.0  72044.0      0.0          2001         400\n11   n stoughteingantianti        pri     53604             871  Lakeview River     Glenwood  73511             637        West 5th       Clinton  68222   2000  400  21236.0  21660.0       0.0  38528.0  72044.0      0.0          2001         400\n12   n stoughteingantianti        bar     58370             861            6th   Five Points  46098             182        Lincoln        Newtown  31749   2000  400   5904.0  10092.0  102012.0  38528.0  72044.0      0.0          2001         400\n13   n stoughteingantianti       anti     33604             299       Lakeview       Red Oak  65018             773   Williams 13th      Red Hill  74338   2000  400  18060.0  31060.0   23012.0  38528.0  72044.0      0.0          2001         400\n14         eingoughteseese        bar     58370             769          River     Sunnyside  71952              41      Locust 4th     Oak Grove  38370   2000  400  36456.0  39736.0       0.0  22112.0  39356.0  32104.0          1999         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.023441,
                    "execution_time": 0.009279,
                    "compile_time": 6.6e-05,
                    "planning_time": 0.006395
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.062201,
                    "execution_time": 0.008428,
                    "compile_time": 6.6e-05,
                    "planning_time": 0.043054
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" WHERE \"CS1\".\"SYEAR\" = 2000",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*              product_name store_name store_zip b_street_number   b_street_name       b_city  b_zip c_street_number   c_street_name        c_city  c_zip  syear  cnt      s11      s21       s31      s12      s22      s32  syear_col_19  cnt_col_20\n0   antipriantibarbarought        pri     35709             832    Wilson Cedar  Springfield  69303             998  Center Dogwood       Oakland  59843   2000  400  23280.0  36084.0       0.0  11824.0  20572.0      0.0          2000         400\n1   antipriantibarbarought       able     35709             985       First 5th  Bunker Hill  30150             304            Oak         Empire  84145   2000  400   4220.0   6876.0       0.0  11824.0  20572.0      0.0          2000         400\n2   antipriantibarbarought       eing     33604              41   11th Woodland       Barnes  53788             736          Green         Marion  40399   2000  400  21716.0  36480.0       0.0  11824.0  20572.0      0.0          2000         400\n3   antipriantibarbarought      ation     58370             661           Park    Bridgeport  65817             138           13th    Five Points  56098   2000  400  23636.0  38524.0  145440.0  11824.0  20572.0      0.0          2000         400\n4   antipriantibarbarought       n st     39231             973   Lake Highland     Glendale  73951             525         Locust     Greenville  91387   2000  400    780.0   1192.0       0.0  11824.0  20572.0      0.0          2000         400\n5   antipriantibarbarought        bar     53604             212     Hill Willow    Greenwood  58828             297            3rd       Lakeview  28579   2000  400  11112.0  13220.0       0.0  11824.0  20572.0      0.0          2000         400\n6   antipriantibarbarought       anti     36098             684        9th Park   Enterprise  41757             372           11th       Franklin  29101   2000  400  11824.0  20572.0       0.0  11824.0  20572.0      0.0          2000         400\n7    n stoughteingantianti       able     38370             442       Park Park     Hamilton  62808             925           12th      Brookwood  70965   2000  400  20444.0  31688.0   98944.0  38528.0  72044.0      0.0          2001         400\n8    n stoughteingantianti        ese     35709             783      Cherry Oak  Cedar Grove  20411             324  Sycamore North    Pine Grove  34593   2000  400  19648.0  30844.0       0.0  38528.0  72044.0      0.0          2001         400\n9    n stoughteingantianti       able     36098             466          Cedar       Ashland  54244              60           10th       Woodlawn  44098   2000  400  19516.0  38248.0  534112.0  38528.0  72044.0      0.0          2001         400\n10   n stoughteingantianti       eing     31904             722           Lake   Bunker Hill  20150             491           Park    Maple Grove  68252   2000  400  24312.0  37440.0       0.0  38528.0  72044.0      0.0          2001         400\n11   n stoughteingantianti        pri     53604             871  Lakeview River     Glenwood  73511             637        West 5th       Clinton  68222   2000  400  21236.0  21660.0       0.0  38528.0  72044.0      0.0          2001         400\n12   n stoughteingantianti        bar     58370             861            6th   Five Points  46098             182        Lincoln        Newtown  31749   2000  400   5904.0  10092.0  102012.0  38528.0  72044.0      0.0          2001         400\n13   n stoughteingantianti       anti     33604             299       Lakeview       Red Oak  65018             773   Williams 13th      Red Hill  74338   2000  400  18060.0  31060.0   23012.0  38528.0  72044.0      0.0          2001         400\n14         eingoughteseese        bar     58370             769          River     Sunnyside  71952              41      Locust 4th     Oak Grove  38370   2000  400  36456.0  39736.0       0.0  22112.0  39356.0  32104.0          1999         400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS2\".\"SYEAR\" = 2001",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.802928,
                    "execution_time": 0.49071,
                    "compile_time": 0.000982,
                    "planning_time": 0.010924,
                    "create_size": 3072
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.89901,
                    "execution_time": 0.510147,
                    "compile_time": 0.006627,
                    "planning_time": 0.069691,
                    "create_size": 3072
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_6\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_6\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_6\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_6\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_6\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_6\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_6\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_6\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_6\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_6\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_6\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*             product_name store_name store_zip b_street_number b_street_name       b_city  b_zip c_street_number c_street_name   c_city  c_zip  syear  cnt     s11     s21       s31      s12      s22  s32  syear_col_19  cnt_col_20\n0   pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n1   pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n2   pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n3   pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n4   pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n5   pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n6   pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n7   pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n8   pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n9   pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n10  pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n11  pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n12  pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n13  pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n14  pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n15  pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022374,
                    "execution_time": 0.008184,
                    "compile_time": 6.6e-05,
                    "planning_time": 0.006466
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060919,
                    "execution_time": 0.008254,
                    "compile_time": 6.8e-05,
                    "planning_time": 0.043152
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_6\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_6\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_6\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_6\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_6\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_6\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_6\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_6\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_6\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_6\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_6\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*             product_name store_name store_zip b_street_number b_street_name       b_city  b_zip c_street_number c_street_name   c_city  c_zip  syear  cnt     s11     s21       s31      s12      s22  s32  syear_col_19  cnt_col_20\n0   pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n1   pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n2   pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n3   pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n4   pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n5   pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n6   pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n7   pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n8   pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n9   pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n10  pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n11  pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n12  pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n13  pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n14  pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n15  pricallyantieingcally       able     55709             913         Park   Buena Vista  75752             413         Pine   Liberty  63451   2000  400  6864.0  9400.0  125912.0  24156.0  42272.0  0.0          2001         400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS2\".\"SYEAR\" = 2001",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.819024,
                    "execution_time": 0.501086,
                    "compile_time": 0.000949,
                    "planning_time": 0.011147,
                    "create_size": 3072
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.874465,
                    "execution_time": 0.485437,
                    "compile_time": 0.002923,
                    "planning_time": 0.069386,
                    "create_size": 3072
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_7\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_7\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_7\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_7\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_7\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_7\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_7\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_7\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*             product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name       c_city  c_zip  syear  cnt      s11      s21       s31      s12      s22  s32  syear_col_19  cnt_col_20\n0   pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n1   pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n2   pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n3   pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n4   pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n5   pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n6   pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n7   pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n8   pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n9   pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n10  pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n11  pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n12  pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n13  pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n14  pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n15  pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022415,
                    "execution_time": 0.008045,
                    "compile_time": 6.5e-05,
                    "planning_time": 0.006443
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058608,
                    "execution_time": 0.008292,
                    "compile_time": 6.4e-05,
                    "planning_time": 0.042681
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_7\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_7\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_7\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_7\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_7\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_7\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_7\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_7\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*             product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name       c_city  c_zip  syear  cnt      s11      s21       s31      s12      s22  s32  syear_col_19  cnt_col_20\n0   pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n1   pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n2   pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n3   pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n4   pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n5   pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n6   pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n7   pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n8   pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n9   pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n10  pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n11  pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n12  pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n13  pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n14  pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n15  pricallyantieingcally        bar     55709             426        Ridge   New Hope  09431             349      Dogwood   Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  24156.0  42272.0  0.0          2001         400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS2\".\"SYEAR\" = 2001",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.323557,
                    "execution_time": 0.077923,
                    "compile_time": 0.000365,
                    "planning_time": 0.0117,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.397075,
                    "execution_time": 0.078537,
                    "compile_time": 0.003059,
                    "planning_time": 0.071117,
                    "create_size": 1128
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_8\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_8\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_8\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_8\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_8\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_8\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_8\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_8\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_8\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_8\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_8\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_8\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*           product_name store_name store_zip b_street_number b_street_name           b_city  b_zip c_street_number     c_street_name       c_city  c_zip  syear  cnt      s11      s21      s31      s12      s22  s32  syear_col_19  cnt_col_20\n0   antin stantin stpri       able     39231             393    7th Sunset            Payne  76134             856           Walnut       Newtown  31749   2000  400  36140.0  48064.0  63840.0  12724.0  15268.0  0.0          1998         400\n1   antin stantin stpri       able     39231             393    7th Sunset            Payne  76134             856           Walnut       Newtown  31749   2000  400  36140.0  48064.0  63840.0  12724.0  15268.0  0.0          1998         400\n2   antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n3   antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n4   antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n5   antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n6   antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n7   antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n8   antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n9   antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n10  antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n11  antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n12  antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n13  antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n14  antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022352,
                    "execution_time": 0.008192,
                    "compile_time": 6.3e-05,
                    "planning_time": 0.006465
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.061957,
                    "execution_time": 0.008086,
                    "compile_time": 6.5e-05,
                    "planning_time": 0.042926
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_8\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_8\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_8\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_8\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_8\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_8\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_8\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_8\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_8\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_8\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_8\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_8\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*           product_name store_name store_zip b_street_number b_street_name           b_city  b_zip c_street_number     c_street_name       c_city  c_zip  syear  cnt      s11      s21      s31      s12      s22  s32  syear_col_19  cnt_col_20\n0   antin stantin stpri       able     39231             393    7th Sunset            Payne  76134             856           Walnut       Newtown  31749   2000  400  36140.0  48064.0  63840.0  12724.0  15268.0  0.0          1998         400\n1   antin stantin stpri       able     39231             393    7th Sunset            Payne  76134             856           Walnut       Newtown  31749   2000  400  36140.0  48064.0  63840.0  12724.0  15268.0  0.0          1998         400\n2   antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n3   antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n4   antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n5   antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n6   antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n7   antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n8   antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n9   antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n10  antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n11  antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n12  antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n13  antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n14  antin stantin stpri       eing     59231             142    12th Sixth         Franklin  79101             774  Jefferson Laurel               56098   2000  400  25528.0  50288.0      0.0  12724.0  15268.0  0.0          1998         400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name and\n     cs1.store_zip = cs2.store_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.142797,
                    "execution_time": 0.055965,
                    "compile_time": 0.000376,
                    "planning_time": 0.011815,
                    "create_size": 288
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.332424,
                    "execution_time": 0.055811,
                    "compile_time": 0.12762,
                    "planning_time": 0.069439,
                    "create_size": 288
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_9\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_9\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_9\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_9\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_9\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_9\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_9\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*             product_name store_name store_zip b_street_number b_street_name      b_city  b_zip c_street_number    c_street_name          c_city  c_zip  syear  cnt      s11      s21       s31      s12      s22       s32  syear_col_19  cnt_col_20\n0   pricallyantieingcally       able     36098             709      Jackson      Lebanon  12898             763   5th Thirteenth  Pleasant Grove  64136   2000  400  28120.0  44148.0       0.0  38360.0  39508.0  216864.0          1998         400\n1   pricallyantieingcally       able     36098             709      Jackson      Lebanon  12898             763   5th Thirteenth  Pleasant Grove  64136   2000  400  28120.0  44148.0       0.0  38360.0  39508.0  216864.0          1998         400\n2   pricallyantieingcally       able     36098             709      Jackson      Lebanon  12898             763   5th Thirteenth  Pleasant Grove  64136   2000  400  28120.0  44148.0       0.0  38360.0  39508.0  216864.0          1998         400\n3   pricallyantieingcally       able     36098             709      Jackson      Lebanon  12898             763   5th Thirteenth  Pleasant Grove  64136   2000  400  28120.0  44148.0       0.0  38360.0  39508.0  216864.0          1998         400\n4   pricallyantieingcally       eing     39231             474       9th 9th  Union Hill  97746             142   Washington Oak          Quincy  33868   2000  400  15372.0  18444.0  306140.0  38360.0  39508.0  216864.0          1998         400\n5   pricallyantieingcally       eing     39231             474       9th 9th  Union Hill  97746             142   Washington Oak          Quincy  33868   2000  400  15372.0  18444.0  306140.0  38360.0  39508.0  216864.0          1998         400\n6   pricallyantieingcally       eing     39231             474       9th 9th  Union Hill  97746             142   Washington Oak          Quincy  33868   2000  400  15372.0  18444.0  306140.0  38360.0  39508.0  216864.0          1998         400\n7   pricallyantieingcally       eing     31904             217    Spring 2nd     Oakdale  59584             398           First       Springdale  58883   2000  400  17840.0  34072.0       0.0  38360.0  39508.0  216864.0          1998         400\n8   pricallyantieingcally       eing     31904             217    Spring 2nd     Oakdale  59584             398           First       Springdale  58883   2000  400  17840.0  34072.0       0.0  38360.0  39508.0  216864.0          1998         400\n9   pricallyantieingcally        bar     55709             426        Ridge     New Hope  09431             349         Dogwood      Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  38360.0  39508.0  216864.0          1998         400\n10  pricallyantieingcally      ation     33604             927   Center West       Blair  95465             297        6th Third         Newport  11521   2000  400   8616.0  13352.0       0.0  38360.0  39508.0  216864.0          1998         400\n11      eseationationable       eing     31904             958          Ash    Oak Grove  88370             787  Franklin Second       Fairfield  36192   2000  400  10968.0  21384.0       0.0  16548.0  28792.0       0.0          1999         400\n12      eseationationable       eing     31904             958          Ash    Oak Grove  88370             787  Franklin Second       Fairfield  36192   2000  400  10968.0  21384.0       0.0  16548.0  28792.0       0.0          1999         400\n13      eseationationable      cally     38370             931      10th 2nd      Ludlow  75566             849       Fifteenth            Jones  32686   2000  400  33468.0  38152.0       0.0  16548.0  28792.0       0.0          1999         400\n14      eseationationable      cally     38370             931      10th 2nd      Ludlow  75566             849       Fifteenth            Jones  32686   2000  400  33468.0  38152.0       0.0  16548.0  28792.0       0.0          1999         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021563,
                    "execution_time": 0.007412,
                    "compile_time": 6.4e-05,
                    "planning_time": 0.006385
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.061724,
                    "execution_time": 0.007892,
                    "compile_time": 6.7e-05,
                    "planning_time": 0.042902
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_9\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_9\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_9\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_9\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_9\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_9\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_9\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_9\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*             product_name store_name store_zip b_street_number b_street_name      b_city  b_zip c_street_number    c_street_name          c_city  c_zip  syear  cnt      s11      s21       s31      s12      s22       s32  syear_col_19  cnt_col_20\n0   pricallyantieingcally       able     36098             709      Jackson      Lebanon  12898             763   5th Thirteenth  Pleasant Grove  64136   2000  400  28120.0  44148.0       0.0  38360.0  39508.0  216864.0          1998         400\n1   pricallyantieingcally       able     36098             709      Jackson      Lebanon  12898             763   5th Thirteenth  Pleasant Grove  64136   2000  400  28120.0  44148.0       0.0  38360.0  39508.0  216864.0          1998         400\n2   pricallyantieingcally       able     36098             709      Jackson      Lebanon  12898             763   5th Thirteenth  Pleasant Grove  64136   2000  400  28120.0  44148.0       0.0  38360.0  39508.0  216864.0          1998         400\n3   pricallyantieingcally       able     36098             709      Jackson      Lebanon  12898             763   5th Thirteenth  Pleasant Grove  64136   2000  400  28120.0  44148.0       0.0  38360.0  39508.0  216864.0          1998         400\n4   pricallyantieingcally       eing     39231             474       9th 9th  Union Hill  97746             142   Washington Oak          Quincy  33868   2000  400  15372.0  18444.0  306140.0  38360.0  39508.0  216864.0          1998         400\n5   pricallyantieingcally       eing     39231             474       9th 9th  Union Hill  97746             142   Washington Oak          Quincy  33868   2000  400  15372.0  18444.0  306140.0  38360.0  39508.0  216864.0          1998         400\n6   pricallyantieingcally       eing     39231             474       9th 9th  Union Hill  97746             142   Washington Oak          Quincy  33868   2000  400  15372.0  18444.0  306140.0  38360.0  39508.0  216864.0          1998         400\n7   pricallyantieingcally       eing     31904             217    Spring 2nd     Oakdale  59584             398           First       Springdale  58883   2000  400  17840.0  34072.0       0.0  38360.0  39508.0  216864.0          1998         400\n8   pricallyantieingcally       eing     31904             217    Spring 2nd     Oakdale  59584             398           First       Springdale  58883   2000  400  17840.0  34072.0       0.0  38360.0  39508.0  216864.0          1998         400\n9   pricallyantieingcally        bar     55709             426        Ridge     New Hope  09431             349         Dogwood      Buena Vista  85752   2000  400  38648.0  62608.0  307288.0  38360.0  39508.0  216864.0          1998         400\n10  pricallyantieingcally      ation     33604             927   Center West       Blair  95465             297        6th Third         Newport  11521   2000  400   8616.0  13352.0       0.0  38360.0  39508.0  216864.0          1998         400\n11      eseationationable       eing     31904             958          Ash    Oak Grove  88370             787  Franklin Second       Fairfield  36192   2000  400  10968.0  21384.0       0.0  16548.0  28792.0       0.0          1999         400\n12      eseationationable       eing     31904             958          Ash    Oak Grove  88370             787  Franklin Second       Fairfield  36192   2000  400  10968.0  21384.0       0.0  16548.0  28792.0       0.0          1999         400\n13      eseationationable      cally     38370             931      10th 2nd      Ludlow  75566             849       Fifteenth            Jones  32686   2000  400  33468.0  38152.0       0.0  16548.0  28792.0       0.0          1999         400\n14      eseationationable      cally     38370             931      10th 2nd      Ludlow  75566             849       Fifteenth            Jones  32686   2000  400  33468.0  38152.0       0.0  16548.0  28792.0       0.0          1999         400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name and\n     cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" LIMIT 21",
                "preview": "\n/*            product_name store_name store_zip b_street_number  b_street_name    b_city  b_zip c_street_number c_street_name    c_city  c_zip  syear  cnt      s11      s21       s31      s12      s22      s32  syear_col_19  cnt_col_20\n0   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0       0.0  21588.0  37560.0  90024.0          1998         400\n1   ableationprieseation        bar     55709             822     Park Smith  Glenwood  63511              43     Franklin    Newtown  71749   2000  400   1068.0   1952.0       0.0  23084.0  33240.0      0.0          1998         400\n2   ableationprieseation        ese     33604             204       View 2nd   Antioch  38605             440         Lake    Cordova  76938   2000  400  30604.0  40700.0  116336.0  39604.0  76828.0      0.0          1998         400\n3   ableationprieseation        ese     33604             204       View 2nd   Antioch  38605             440         Lake    Cordova  76938   2000  400  30604.0  40700.0  116336.0  23084.0  33240.0      0.0          1998         400\n4   ableationprieseation        ese     33604             204       View 2nd   Antioch  38605             440         Lake    Cordova  76938   2000  400  30604.0  40700.0  116336.0  21588.0  37560.0  90024.0          1998         400\n5   ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0       0.0  17024.0  17024.0      0.0          1998         400\n6   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0       0.0  21588.0  37560.0  90024.0          1998         400\n7   ableationprieseation        ese     33604             204       View 2nd   Antioch  38605             440         Lake    Cordova  76938   2000  400  30604.0  40700.0  116336.0  17024.0  17024.0      0.0          1998         400\n8   ableationprieseation        bar     55709             822     Park Smith  Glenwood  63511              43     Franklin    Newtown  71749   2000  400   1068.0   1952.0       0.0  39604.0  76828.0      0.0          1998         400\n9   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0       0.0  17024.0  17024.0      0.0          1998         400\n10  ableationprieseation        ese     33604             204       View 2nd   Antioch  38605             440         Lake    Cordova  76938   2000  400  30604.0  40700.0  116336.0  39604.0  76828.0      0.0          1998         400\n11  ableationprieseation        ese     33604             204       View 2nd   Antioch  38605             440         Lake    Cordova  76938   2000  400  30604.0  40700.0  116336.0  23084.0  33240.0      0.0          1998         400\n12  ableationprieseation        ese     33604             204       View 2nd   Antioch  38605             440         Lake    Cordova  76938   2000  400  30604.0  40700.0  116336.0  21588.0  37560.0  90024.0          1998         400\n13  ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0       0.0  17024.0  17024.0      0.0          1998         400\n14  ableationprieseation        ese     33604             204       View 2nd   Antioch  38605             440         Lake    Cordova  76938   2000  400  30604.0  40700.0  116336.0  21588.0  37560.0  90024.0          1998         400\n15  ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0       0.0  17024.0  17024.0      0.0          1998         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.041916,
                    "execution_time": 0.018049,
                    "compile_time": 0.000187,
                    "planning_time": 0.012126
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.246907,
                    "execution_time": 0.017581,
                    "compile_time": 0.16631,
                    "planning_time": 0.048864
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*            product_name store_name store_zip b_street_number  b_street_name    b_city  b_zip c_street_number c_street_name    c_city  c_zip  syear  cnt      s11      s21       s31      s12      s22      s32  syear_col_19  cnt_col_20\n0   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0       0.0  21588.0  37560.0  90024.0          1998         400\n1   ableationprieseation        bar     55709             822     Park Smith  Glenwood  63511              43     Franklin    Newtown  71749   2000  400   1068.0   1952.0       0.0  23084.0  33240.0      0.0          1998         400\n2   ableationprieseation        ese     33604             204       View 2nd   Antioch  38605             440         Lake    Cordova  76938   2000  400  30604.0  40700.0  116336.0  39604.0  76828.0      0.0          1998         400\n3   ableationprieseation        ese     33604             204       View 2nd   Antioch  38605             440         Lake    Cordova  76938   2000  400  30604.0  40700.0  116336.0  23084.0  33240.0      0.0          1998         400\n4   ableationprieseation        ese     33604             204       View 2nd   Antioch  38605             440         Lake    Cordova  76938   2000  400  30604.0  40700.0  116336.0  21588.0  37560.0  90024.0          1998         400\n5   ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0       0.0  17024.0  17024.0      0.0          1998         400\n6   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0       0.0  21588.0  37560.0  90024.0          1998         400\n7   ableationprieseation        ese     33604             204       View 2nd   Antioch  38605             440         Lake    Cordova  76938   2000  400  30604.0  40700.0  116336.0  17024.0  17024.0      0.0          1998         400\n8   ableationprieseation        bar     55709             822     Park Smith  Glenwood  63511              43     Franklin    Newtown  71749   2000  400   1068.0   1952.0       0.0  39604.0  76828.0      0.0          1998         400\n9   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0       0.0  17024.0  17024.0      0.0          1998         400\n10  ableationprieseation        ese     33604             204       View 2nd   Antioch  38605             440         Lake    Cordova  76938   2000  400  30604.0  40700.0  116336.0  39604.0  76828.0      0.0          1998         400\n11  ableationprieseation        ese     33604             204       View 2nd   Antioch  38605             440         Lake    Cordova  76938   2000  400  30604.0  40700.0  116336.0  23084.0  33240.0      0.0          1998         400\n12  ableationprieseation        ese     33604             204       View 2nd   Antioch  38605             440         Lake    Cordova  76938   2000  400  30604.0  40700.0  116336.0  21588.0  37560.0  90024.0          1998         400\n13  ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0       0.0  17024.0  17024.0      0.0          1998         400\n14  ableationprieseation        ese     33604             204       View 2nd   Antioch  38605             440         Lake    Cordova  76938   2000  400  30604.0  40700.0  116336.0  21588.0  37560.0  90024.0          1998         400\n15  ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0       0.0  17024.0  17024.0      0.0          1998         400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name and\n     cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n       ,cs1.store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" LIMIT 21",
                "preview": "\n/*            product_name store_name store_zip b_street_number  b_street_name    b_city  b_zip c_street_number c_street_name    c_city  c_zip  syear  cnt      s11      s21  s31      s12      s22      s32  syear_col_19  cnt_col_20\n0   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  23620.0  30704.0  40276.0          1998         400\n1   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  30640.0  52088.0      0.0          1998         400\n2   ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0  0.0  12356.0  20756.0      0.0          1999         400\n3   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  30640.0  52088.0      0.0          1998         400\n4   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  12356.0  20756.0      0.0          1999         400\n5   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  13384.0  15120.0      0.0          1999         400\n6   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  23620.0  30704.0  40276.0          1998         400\n7   ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0  0.0  13384.0  15120.0      0.0          1999         400\n8   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  12356.0  20756.0      0.0          1999         400\n9   ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0  0.0  13384.0  15120.0      0.0          1999         400\n10  ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  21588.0  37560.0  90024.0          1998         400\n11  ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  13384.0  15120.0      0.0          1999         400\n12  ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0  0.0  39604.0  76828.0      0.0          1998         400\n13  ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  23084.0  33240.0      0.0          1998         400\n14  ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0  0.0  39604.0  76828.0      0.0          1998         400\n15  ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  23084.0  33240.0      0.0          1998         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.041933,
                    "execution_time": 0.017598,
                    "compile_time": 0.000191,
                    "planning_time": 0.0123
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.18195,
                    "execution_time": 0.017893,
                    "compile_time": 0.103599,
                    "planning_time": 0.048678
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*            product_name store_name store_zip b_street_number  b_street_name    b_city  b_zip c_street_number c_street_name    c_city  c_zip  syear  cnt      s11      s21  s31      s12      s22      s32  syear_col_19  cnt_col_20\n0   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  23620.0  30704.0  40276.0          1998         400\n1   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  30640.0  52088.0      0.0          1998         400\n2   ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0  0.0  12356.0  20756.0      0.0          1999         400\n3   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  30640.0  52088.0      0.0          1998         400\n4   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  12356.0  20756.0      0.0          1999         400\n5   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  13384.0  15120.0      0.0          1999         400\n6   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  23620.0  30704.0  40276.0          1998         400\n7   ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0  0.0  13384.0  15120.0      0.0          1999         400\n8   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  12356.0  20756.0      0.0          1999         400\n9   ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0  0.0  13384.0  15120.0      0.0          1999         400\n10  ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  21588.0  37560.0  90024.0          1998         400\n11  ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  13384.0  15120.0      0.0          1999         400\n12  ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0  0.0  39604.0  76828.0      0.0          1998         400\n13  ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  23084.0  33240.0      0.0          1998         400\n14  ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0  0.0  39604.0  76828.0      0.0          1998         400\n15  ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  23084.0  33240.0      0.0          1998         400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name and\n     cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n       ,cs1.store_name\n       ,cs2.cnt\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" LIMIT 21",
                "preview": "\n/*            product_name store_name store_zip b_street_number  b_street_name    b_city  b_zip c_street_number c_street_name    c_city  c_zip  syear  cnt      s11      s21  s31      s12      s22      s32  syear_col_19  cnt_col_20\n0   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  23620.0  30704.0  40276.0          1998         400\n1   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  30640.0  52088.0      0.0          1998         400\n2   ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0  0.0  12356.0  20756.0      0.0          1999         400\n3   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  30640.0  52088.0      0.0          1998         400\n4   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  12356.0  20756.0      0.0          1999         400\n5   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  13384.0  15120.0      0.0          1999         400\n6   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  23620.0  30704.0  40276.0          1998         400\n7   ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0  0.0  13384.0  15120.0      0.0          1999         400\n8   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  12356.0  20756.0      0.0          1999         400\n9   ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0  0.0  13384.0  15120.0      0.0          1999         400\n10  ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  21588.0  37560.0  90024.0          1998         400\n11  ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  13384.0  15120.0      0.0          1999         400\n12  ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0  0.0  39604.0  76828.0      0.0          1998         400\n13  ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  23084.0  33240.0      0.0          1998         400\n14  ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0  0.0  39604.0  76828.0      0.0          1998         400\n15  ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  23084.0  33240.0      0.0          1998         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.041487,
                    "execution_time": 0.017136,
                    "compile_time": 0.000188,
                    "planning_time": 0.012442
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.16036,
                    "execution_time": 0.017857,
                    "compile_time": 0.0814,
                    "planning_time": 0.049117
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" NULLS LAST"
            }
        ],
        "preview": "\n/*            product_name store_name store_zip b_street_number  b_street_name    b_city  b_zip c_street_number c_street_name    c_city  c_zip  syear  cnt      s11      s21  s31      s12      s22      s32  syear_col_19  cnt_col_20\n0   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  23620.0  30704.0  40276.0          1998         400\n1   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  30640.0  52088.0      0.0          1998         400\n2   ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0  0.0  12356.0  20756.0      0.0          1999         400\n3   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  30640.0  52088.0      0.0          1998         400\n4   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  12356.0  20756.0      0.0          1999         400\n5   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  13384.0  15120.0      0.0          1999         400\n6   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  23620.0  30704.0  40276.0          1998         400\n7   ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0  0.0  13384.0  15120.0      0.0          1999         400\n8   ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  12356.0  20756.0      0.0          1999         400\n9   ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0  0.0  13384.0  15120.0      0.0          1999         400\n10  ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  21588.0  37560.0  90024.0          1998         400\n11  ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  13384.0  15120.0      0.0          1999         400\n12  ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0  0.0  39604.0  76828.0      0.0          1998         400\n13  ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  23084.0  33240.0      0.0          1998         400\n14  ableationprieseation       able     56098             268      Railroad   Glendale  23951             892        Cedar     Shiloh  49275   2000  400  17260.0  19328.0  0.0  39604.0  76828.0      0.0          1998         400\n15  ableationprieseation       able     36098             338  Cherry Fourth     Evans  32284             647       Willow   Millwood  87319   2000  400  36912.0  63488.0  0.0  23084.0  33240.0      0.0          1998         400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name and\n     cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n       ,cs1.store_name\n       ,cs2.cnt\n       ,cs1.s1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST , \"CS1\".\"S1\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" LIMIT 21",
                "preview": "\n/*            product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name  c_city  c_zip  syear  cnt      s11      s21  s31      s12      s22      s32  syear_col_19  cnt_col_20\n0   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  39604.0  76828.0      0.0          1998         400\n1   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  26716.0  49688.0      0.0          2000         400\n2   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  12356.0  20756.0      0.0          1999         400\n3   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  30640.0  52088.0      0.0          1998         400\n4   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  27944.0  42192.0      0.0          1998         400\n5   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   3492.0   3804.0      0.0          1998         400\n6   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   1068.0   1952.0      0.0          2000         400\n7   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  23084.0  33240.0      0.0          1998         400\n8   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  21588.0  37560.0  90024.0          1998         400\n9   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  17024.0  17024.0      0.0          1998         400\n10  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  23620.0  30704.0  40276.0          1998         400\n11  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  30640.0  52088.0      0.0          1998         400\n12  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  23620.0  30704.0  40276.0          1998         400\n13  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  26716.0  49688.0      0.0          2000         400\n14  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  27944.0  42192.0      0.0          1998         400\n15  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   3492.0   3804.0      0.0          1998         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.041051,
                    "execution_time": 0.016916,
                    "compile_time": 0.000183,
                    "planning_time": 0.012432
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.168375,
                    "execution_time": 0.018994,
                    "compile_time": 0.088572,
                    "planning_time": 0.048947
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST , \"CS1\".\"S1\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" NULLS LAST"
            }
        ],
        "preview": "\n/*            product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name  c_city  c_zip  syear  cnt      s11      s21  s31      s12      s22      s32  syear_col_19  cnt_col_20\n0   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  39604.0  76828.0      0.0          1998         400\n1   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  26716.0  49688.0      0.0          2000         400\n2   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  12356.0  20756.0      0.0          1999         400\n3   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  30640.0  52088.0      0.0          1998         400\n4   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  27944.0  42192.0      0.0          1998         400\n5   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   3492.0   3804.0      0.0          1998         400\n6   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   1068.0   1952.0      0.0          2000         400\n7   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  23084.0  33240.0      0.0          1998         400\n8   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  21588.0  37560.0  90024.0          1998         400\n9   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  17024.0  17024.0      0.0          1998         400\n10  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  23620.0  30704.0  40276.0          1998         400\n11  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  30640.0  52088.0      0.0          1998         400\n12  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  23620.0  30704.0  40276.0          1998         400\n13  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  26716.0  49688.0      0.0          2000         400\n14  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  27944.0  42192.0      0.0          1998         400\n15  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   3492.0   3804.0      0.0          1998         400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name and\n     cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n       ,cs1.store_name\n       ,cs2.cnt\n       ,cs1.s1\n       ,cs2.s1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST , \"CS1\".\"S1\" NULLS LAST , \"CS2\".\"S1\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" LIMIT 21",
                "preview": "\n/*            product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name  c_city  c_zip  syear  cnt      s11      s21  s31      s12      s22  s32  syear_col_19  cnt_col_20\n0   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   1068.0   1952.0  0.0          2000         400\n1   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   1068.0   1952.0  0.0          2000         400\n2   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   3492.0   3804.0  0.0          1998         400\n3   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   3492.0   3804.0  0.0          1998         400\n4   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   8844.0  10612.0  0.0          1999         400\n5   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   8844.0  10612.0  0.0          1999         400\n6   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  12356.0  20756.0  0.0          1999         400\n7   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  12356.0  20756.0  0.0          1999         400\n8   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  13384.0  15120.0  0.0          1999         400\n9   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  13384.0  15120.0  0.0          1999         400\n10  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  14292.0  15720.0  0.0          1998         400\n11  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  14292.0  15720.0  0.0          1998         400\n12  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  15604.0  29176.0  0.0          1999         400\n13  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  15604.0  29176.0  0.0          1999         400\n14  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  15708.0  25916.0  0.0          1998         400\n15  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  15708.0  25916.0  0.0          1998         400\n16  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  17024.0  17024.0  0.0          1998         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.041623,
                    "execution_time": 0.017041,
                    "compile_time": 0.000186,
                    "planning_time": 0.012652
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.201247,
                    "execution_time": 0.017975,
                    "compile_time": 0.122199,
                    "planning_time": 0.049074
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST , \"CS1\".\"S1\" NULLS LAST , \"CS2\".\"S1\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" NULLS LAST"
            }
        ],
        "preview": "\n/*            product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name  c_city  c_zip  syear  cnt      s11      s21  s31      s12      s22  s32  syear_col_19  cnt_col_20\n0   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   1068.0   1952.0  0.0          2000         400\n1   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   1068.0   1952.0  0.0          2000         400\n2   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   3492.0   3804.0  0.0          1998         400\n3   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   3492.0   3804.0  0.0          1998         400\n4   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   8844.0  10612.0  0.0          1999         400\n5   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   8844.0  10612.0  0.0          1999         400\n6   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  12356.0  20756.0  0.0          1999         400\n7   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  12356.0  20756.0  0.0          1999         400\n8   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  13384.0  15120.0  0.0          1999         400\n9   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  13384.0  15120.0  0.0          1999         400\n10  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  14292.0  15720.0  0.0          1998         400\n11  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  14292.0  15720.0  0.0          1998         400\n12  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  15604.0  29176.0  0.0          1999         400\n13  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  15604.0  29176.0  0.0          1999         400\n14  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  15708.0  25916.0  0.0          1998         400\n15  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  15708.0  25916.0  0.0          1998         400\n16  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  17024.0  17024.0  0.0          1998         400\n...*/"
    },
    {
        "input": "-- start template query64.tpl query 20 in stream 0\nwith /* TPC-DS query64.tpl 0.20 */ cs_ui as\n (select cs_item_sk\n        ,sum(cs_ext_list_price) as sale,sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit) as refund\n  from catalog_sales\n      ,catalog_returns\n  where cs_item_sk = cr_item_sk\n    and cs_order_number = cr_order_number\n  group by cs_item_sk\n  having sum(cs_ext_list_price)>2*sum(cr_refunded_cash+cr_reversed_charge+cr_store_credit)),\ncross_sales as\n (select i_product_name product_name\n     ,i_item_sk item_sk\n     ,s_store_name store_name\n     ,s_zip store_zip\n     ,ad1.ca_street_number b_street_number\n     ,ad1.ca_street_name b_street_name\n     ,ad1.ca_city b_city\n     ,ad1.ca_zip b_zip\n     ,ad2.ca_street_number c_street_number\n     ,ad2.ca_street_name c_street_name\n     ,ad2.ca_city c_city\n     ,ad2.ca_zip c_zip\n     ,d1.d_year as syear\n     ,d2.d_year as fsyear\n     ,d3.d_year s2year\n     ,count(*) cnt\n     ,sum(ss_wholesale_cost) s1\n     ,sum(ss_list_price) s2\n     ,sum(ss_coupon_amt) s3\n  FROM   store_sales\n        ,store_returns\n        ,cs_ui\n        ,date_dim d1\n        ,date_dim d2\n        ,date_dim d3\n        ,store\n        ,customer\n        ,customer_demographics cd1\n        ,customer_demographics cd2\n        ,promotion\n        ,household_demographics hd1\n        ,household_demographics hd2\n        ,customer_address ad1\n        ,customer_address ad2\n        ,income_band ib1\n        ,income_band ib2\n        ,item\n  WHERE  ss_store_sk = s_store_sk AND\n         ss_sold_date_sk = d1.d_date_sk AND\n         ss_customer_sk = c_customer_sk AND\n         ss_cdemo_sk= cd1.cd_demo_sk AND\n         ss_hdemo_sk = hd1.hd_demo_sk AND\n         ss_addr_sk = ad1.ca_address_sk and\n         ss_item_sk = i_item_sk and\n         ss_item_sk = sr_item_sk and\n         ss_ticket_number = sr_ticket_number and\n         ss_item_sk = cs_ui.cs_item_sk and\n         c_current_cdemo_sk = cd2.cd_demo_sk AND\n         c_current_hdemo_sk = hd2.hd_demo_sk AND\n         c_current_addr_sk = ad2.ca_address_sk and\n         c_first_sales_date_sk = d2.d_date_sk and\n         c_first_shipto_date_sk = d3.d_date_sk and\n         ss_promo_sk = p_promo_sk and\n         hd1.hd_income_band_sk = ib1.ib_income_band_sk and\n         hd2.hd_income_band_sk = ib2.ib_income_band_sk and\n         cd1.cd_marital_status <> cd2.cd_marital_status and\n         i_color in ('coral','drab','orchid','bisque','antique','snow') and\n         i_current_price between 68 and 68 + 10 and\n         i_current_price between 68 + 1 and 68 + 15\ngroup by i_product_name\n       ,i_item_sk\n       ,s_store_name\n       ,s_zip\n       ,ad1.ca_street_number\n       ,ad1.ca_street_name\n       ,ad1.ca_city\n       ,ad1.ca_zip\n       ,ad2.ca_street_number\n       ,ad2.ca_street_name\n       ,ad2.ca_city\n       ,ad2.ca_zip\n       ,d1.d_year\n       ,d2.d_year\n       ,d3.d_year\n)\nselect cs1.product_name\n     ,cs1.store_name\n     ,cs1.store_zip\n     ,cs1.b_street_number\n     ,cs1.b_street_name\n     ,cs1.b_city\n     ,cs1.b_zip\n     ,cs1.c_street_number\n     ,cs1.c_street_name\n     ,cs1.c_city\n     ,cs1.c_zip\n     ,cs1.syear\n     ,cs1.cnt\n     ,cs1.s1 as s11\n     ,cs1.s2 as s21\n     ,cs1.s3 as s31\n     ,cs2.s1 as s12\n     ,cs2.s2 as s22\n     ,cs2.s3 as s32\n     ,cs2.syear\n     ,cs2.cnt\nfrom cross_sales cs1,cross_sales cs2\nwhere cs1.item_sk=cs2.item_sk and\n     cs1.syear = 2000 and\n     cs2.syear = 2000 + 1 and\n     cs2.cnt <= cs1.cnt and\n     cs1.store_name = cs2.store_name and\n     cs1.store_zip = cs2.store_zip\norder by cs1.product_name\n       ,cs1.store_name\n       ,cs2.cnt\n       ,cs1.s1\n       ,cs2.s1\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CS_UI\" AS ( SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" HAVING 2 * SUM ( \"CATALOG_RETURNS\".\"CR_REFUNDED_CASH\" + \"CATALOG_RETURNS\".\"CR_REVERSED_CHARGE\" + \"CATALOG_RETURNS\".\"CR_STORE_CREDIT\" ) < SUM ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" ) ) , \"CROSS_SALES\" AS ( SELECT \"ITEM\".\"I_PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" AS \"ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" AS \"STORE_NAME\" , \"STORE\".\"S_ZIP\" AS \"STORE_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" AS \"B_STREET_NAME\" , \"AD1\".\"CA_CITY\" AS \"B_CITY\" , \"AD1\".\"CA_ZIP\" AS \"B_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" AS \"C_STREET_NAME\" , \"AD2\".\"CA_CITY\" AS \"C_CITY\" , \"AD2\".\"CA_ZIP\" AS \"C_ZIP\" , \"D1\".\"D_YEAR\" AS \"SYEAR\" , COUNT ( * ) AS \"CNT\" , SUM ( \"STORE_SALES\".\"SS_WHOLESALE_COST\" ) AS \"S1\" , SUM ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"S2\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"S3\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD1\" ON \"AD1\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"CS_UI\" AS \"CS_UI\" ON \"CS_UI\".\"CS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD1\" ON \"HD1\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_COLOR\" IN ( 'coral' , 'drab' , 'orchid' , 'bisque' , 'antique' , 'snow' ) AND \"ITEM\".\"I_CURRENT_PRICE\" <= 78 AND \"ITEM\".\"I_CURRENT_PRICE\" >= 69 AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"AD2\" ON \"AD2\".\"CA_ADDRESS_SK\" = \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD1\".\"CD_MARITAL_STATUS\" <> \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CUSTOMER\".\"C_FIRST_SALES_DATE_SK\" = \"D2\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CUSTOMER\".\"C_FIRST_SHIPTO_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HD2\" ON \"CUSTOMER\".\"C_CURRENT_HDEMO_SK\" = \"HD2\".\"HD_DEMO_SK\" JOIN \"INCOME_BAND\" AS \"IB1\" ON \"HD1\".\"HD_INCOME_BAND_SK\" = \"IB1\".\"IB_INCOME_BAND_SK\" JOIN \"INCOME_BAND\" AS \"IB2\" ON \"HD2\".\"HD_INCOME_BAND_SK\" = \"IB2\".\"IB_INCOME_BAND_SK\" GROUP BY \"ITEM\".\"I_PRODUCT_NAME\" , \"ITEM\".\"I_ITEM_SK\" , \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_ZIP\" , \"AD1\".\"CA_STREET_NUMBER\" , \"AD1\".\"CA_STREET_NAME\" , \"AD1\".\"CA_CITY\" , \"AD1\".\"CA_ZIP\" , \"AD2\".\"CA_STREET_NUMBER\" , \"AD2\".\"CA_STREET_NAME\" , \"AD2\".\"CA_CITY\" , \"AD2\".\"CA_ZIP\" , \"D1\".\"D_YEAR\" , \"D2\".\"D_YEAR\" , \"D3\".\"D_YEAR\" ) SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"CROSS_SALES\" AS \"CS1\" JOIN \"CROSS_SALES\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST , \"CS1\".\"S1\" NULLS LAST , \"CS2\".\"S1\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" LIMIT 21",
                "preview": "\n/*            product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name  c_city  c_zip  syear  cnt      s11      s21  s31      s12      s22  s32  syear_col_19  cnt_col_20\n0   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   1068.0   1952.0  0.0          2000         400\n1   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   1068.0   1952.0  0.0          2000         400\n2   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   3492.0   3804.0  0.0          1998         400\n3   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   3492.0   3804.0  0.0          1998         400\n4   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   8844.0  10612.0  0.0          1999         400\n5   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   8844.0  10612.0  0.0          1999         400\n6   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  12356.0  20756.0  0.0          1999         400\n7   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  12356.0  20756.0  0.0          1999         400\n8   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  13384.0  15120.0  0.0          1999         400\n9   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  13384.0  15120.0  0.0          1999         400\n10  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  14292.0  15720.0  0.0          1998         400\n11  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  14292.0  15720.0  0.0          1998         400\n12  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  15604.0  29176.0  0.0          1999         400\n13  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  15604.0  29176.0  0.0          1999         400\n14  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  15708.0  25916.0  0.0          1998         400\n15  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  15708.0  25916.0  0.0          1998         400\n16  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  17024.0  17024.0  0.0          1998         400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.04213,
                    "execution_time": 0.017082,
                    "compile_time": 0.000199,
                    "planning_time": 0.01283
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.042623,
                    "execution_time": 0.01748,
                    "compile_time": 0.000195,
                    "planning_time": 0.012881
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CS1\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"CS1\".\"STORE_NAME\" AS \"STORE_NAME\" , \"CS1\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"CS1\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"CS1\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"CS1\".\"B_CITY\" AS \"B_CITY\" , \"CS1\".\"B_ZIP\" AS \"B_ZIP\" , \"CS1\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"CS1\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"CS1\".\"C_CITY\" AS \"C_CITY\" , \"CS1\".\"C_ZIP\" AS \"C_ZIP\" , \"CS1\".\"SYEAR\" AS \"SYEAR\" , \"CS1\".\"CNT\" AS \"CNT\" , \"CS1\".\"S1\" AS \"S11\" , \"CS1\".\"S2\" AS \"S21\" , \"CS1\".\"S3\" AS \"S31\" , \"CS2\".\"S1\" AS \"S12\" , \"CS2\".\"S2\" AS \"S22\" , \"CS2\".\"S3\" AS \"S32\" , \"CS2\".\"SYEAR\" AS \"SYEAR\" , \"CS2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CS1\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"CS1\".\"CNT\" >= \"CS2\".\"CNT\" AND \"CS1\".\"ITEM_SK\" = \"CS2\".\"ITEM_SK\" AND \"CS1\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"CS1\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 WHERE \"CS1\".\"SYEAR\" = 2000 ORDER BY \"CS1\".\"PRODUCT_NAME\" NULLS LAST , \"CS1\".\"STORE_NAME\" NULLS LAST , \"CS2\".\"CNT\" NULLS LAST , \"CS1\".\"S1\" NULLS LAST , \"CS2\".\"S1\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" AS \"PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" AS \"STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" AS \"STORE_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NUMBER\" AS \"B_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_STREET_NAME\" AS \"B_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_CITY\" AS \"B_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"B_ZIP\" AS \"B_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NUMBER\" AS \"C_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_STREET_NAME\" AS \"C_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_CITY\" AS \"C_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_ZIP\" AS \"C_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR\" AS \"SYEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" AS \"S11\" , \"SPEQLITE_TEMP_TABLE_5\".\"S21\" AS \"S21\" , \"SPEQLITE_TEMP_TABLE_5\".\"S31\" AS \"S31\" , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" AS \"S12\" , \"SPEQLITE_TEMP_TABLE_5\".\"S22\" AS \"S22\" , \"SPEQLITE_TEMP_TABLE_5\".\"S32\" AS \"S32\" , \"SPEQLITE_TEMP_TABLE_5\".\"SYEAR_COL_19\" AS \"SYEAR_COL_19\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" AS \"CNT_COL_20\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"CS2\" ON \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" >= \"CS2\".\"CNT\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" = \"CS2\".\"STORE_NAME\" AND \"SPEQLITE_TEMP_TABLE_5\".\"STORE_ZIP\" = \"CS2\".\"STORE_ZIP\" AND \"CS2\".\"SYEAR\" = 2001 ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"STORE_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"CNT_COL_20\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"S11\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_5\".\"S12\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*            product_name store_name store_zip b_street_number b_street_name    b_city  b_zip c_street_number c_street_name  c_city  c_zip  syear  cnt      s11      s21  s31      s12      s22  s32  syear_col_19  cnt_col_20\n0   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   1068.0   1952.0  0.0          2000         400\n1   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   1068.0   1952.0  0.0          2000         400\n2   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   3492.0   3804.0  0.0          1998         400\n3   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   3492.0   3804.0  0.0          1998         400\n4   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   8844.0  10612.0  0.0          1999         400\n5   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0   8844.0  10612.0  0.0          1999         400\n6   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  12356.0  20756.0  0.0          1999         400\n7   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  12356.0  20756.0  0.0          1999         400\n8   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  13384.0  15120.0  0.0          1999         400\n9   ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  13384.0  15120.0  0.0          1999         400\n10  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  14292.0  15720.0  0.0          1998         400\n11  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  14292.0  15720.0  0.0          1998         400\n12  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  15604.0  29176.0  0.0          1999         400\n13  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  15604.0  29176.0  0.0          1999         400\n14  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  15708.0  25916.0  0.0          1998         400\n15  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  15708.0  25916.0  0.0          1998         400\n16  ableationprieseation       able     56098             268     Railroad   Glendale  23951             892        Cedar   Shiloh  49275   2000  400  17260.0  19328.0  0.0  17024.0  17024.0  0.0          1998         400\n...*/"
    }
]