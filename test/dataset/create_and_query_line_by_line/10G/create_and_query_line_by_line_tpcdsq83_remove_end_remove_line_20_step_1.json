[
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns\n join item on sr_item_sk = i_item_sk\n join date_dim on sr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns\n join item on cr_item_sk = i_item_sk\n join date_dim on cr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns\n join item on wr_item_sk = i_item_sk\n join date_dim on wr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n/*CURSOR_IDENTIFIER*/ \ngroup by i_item_id)\nselect * from sr_items \njoin cr_items on sr_items.item_id = cr_items.item_id\njoin wr_items on cr_items.item_id = wr_items.item_id;",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"CR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"WR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.104745,
                    "execution_time": 0.039694,
                    "compile_time": 0.000244,
                    "planning_time": 0.024021,
                    "create_size": 480
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.167319,
                    "execution_time": 0.03997,
                    "compile_time": 0.000248,
                    "planning_time": 0.085614,
                    "create_size": 480
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.148723,
                    "execution_time": 0.045776,
                    "compile_time": 0.000242,
                    "planning_time": 0.024447,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.213419,
                    "execution_time": 0.046462,
                    "compile_time": 0.000242,
                    "planning_time": 0.086421,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.083055,
                    "execution_time": 0.031722,
                    "compile_time": 0.000256,
                    "planning_time": 0.025731,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.154966,
                    "execution_time": 0.0324,
                    "compile_time": 0.000261,
                    "planning_time": 0.094104,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.098195,
                    "execution_time": 0.041989,
                    "compile_time": 0.000307,
                    "planning_time": 0.029267,
                    "create_size": 72
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.164197,
                    "execution_time": 0.041596,
                    "compile_time": 0.0003,
                    "planning_time": 0.092503,
                    "create_size": 72
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"SPEQLITE_TEMP_TABLE_4\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.152251,
                    "execution_time": 0.071666,
                    "compile_time": 0.000482,
                    "planning_time": 0.038851,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.225292,
                    "execution_time": 0.079828,
                    "compile_time": 0.002552,
                    "planning_time": 0.098418,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.128337,
                    "execution_time": 0.041579,
                    "compile_time": 0.000302,
                    "planning_time": 0.05999,
                    "create_size": 72
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.160005,
                    "execution_time": 0.041883,
                    "compile_time": 0.000298,
                    "planning_time": 0.09135,
                    "create_size": 72
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"SPEQLITE_TEMP_TABLE_6\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.142961,
                    "execution_time": 0.07089,
                    "compile_time": 0.00046,
                    "planning_time": 0.035496,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.368137,
                    "execution_time": 0.077126,
                    "compile_time": 0.150002,
                    "planning_time": 0.101482,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.11124,
                    "execution_time": 0.04122,
                    "compile_time": 0.000291,
                    "planning_time": 0.043573,
                    "create_size": 72
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.160096,
                    "execution_time": 0.040204,
                    "compile_time": 0.000297,
                    "planning_time": 0.09346,
                    "create_size": 72
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"SPEQLITE_TEMP_TABLE_8\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.141487,
                    "execution_time": 0.070801,
                    "compile_time": 0.000473,
                    "planning_time": 0.036267,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.223932,
                    "execution_time": 0.077225,
                    "compile_time": 0.000444,
                    "planning_time": 0.10973,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" AS \"ITEM_ID_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" AS \"ITEM_ID_COL_4\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.099973,
                    "execution_time": 0.064844,
                    "compile_time": 0.000327,
                    "planning_time": 0.006703,
                    "create_size": 864
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.165528,
                    "execution_time": 0.064443,
                    "compile_time": 0.00263,
                    "planning_time": 0.06442,
                    "create_size": 864
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID_COL_2\" AS \"ITEM_ID_COL_2\" , \"SPEQLITE_TEMP_TABLE_10\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID_COL_4\" AS \"ITEM_ID_COL_4\" , \"SPEQLITE_TEMP_TABLE_10\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty     item_id_col_2  cr_item_qty     item_id_col_4  wr_item_qty\n0   AAAAAAAAKAAABAAA         72.0  AAAAAAAAKAAABAAA            8  AAAAAAAAKAAABAAA            4\n1   AAAAAAAAGBOHAAAA         72.0  AAAAAAAAGBOHAAAA           19  AAAAAAAAGBOHAAAA            7\n2   AAAAAAAAJFLCBAAA         11.0  AAAAAAAAJFLCBAAA            4  AAAAAAAAJFLCBAAA           72\n3   AAAAAAAAGDCMAAAA          3.0  AAAAAAAAGDCMAAAA            5  AAAAAAAAGDCMAAAA            4\n4   AAAAAAAAIFJFBAAA         38.0  AAAAAAAAIFJFBAAA           40  AAAAAAAAIFJFBAAA           46\n5   AAAAAAAAHABOAAAA         47.0  AAAAAAAAHABOAAAA           13  AAAAAAAAHABOAAAA           42\n6   AAAAAAAAOMFABAAA         22.0  AAAAAAAAOMFABAAA           14  AAAAAAAAOMFABAAA            9\n7   AAAAAAAANJGPAAAA         13.0  AAAAAAAANJGPAAAA           17  AAAAAAAANJGPAAAA            1\n8   AAAAAAAAGKPPAAAA         31.0  AAAAAAAAGKPPAAAA           34  AAAAAAAAGKPPAAAA           50\n9   AAAAAAAAICFABAAA         19.0  AAAAAAAAICFABAAA           12  AAAAAAAAICFABAAA           20\n10  AAAAAAAAALJBBAAA         71.0  AAAAAAAAALJBBAAA            1  AAAAAAAAALJBBAAA           28\n11  AAAAAAAAAPIHBAAA          4.0  AAAAAAAAAPIHBAAA           17  AAAAAAAAAPIHBAAA           38\n12  AAAAAAAAMDPGBAAA         20.0  AAAAAAAAMDPGBAAA            9  AAAAAAAAMDPGBAAA           90\n13  AAAAAAAAGJJHBAAA          NaN  AAAAAAAAGJJHBAAA           23  AAAAAAAAGJJHBAAA           45\n14  AAAAAAAAHMIKAAAA         67.0  AAAAAAAAHMIKAAAA          114  AAAAAAAAHMIKAAAA            5\n15  AAAAAAAAIDMEBAAA         29.0  AAAAAAAAIDMEBAAA            9  AAAAAAAAIDMEBAAA           78\n16  AAAAAAAAOKPEBAAA         75.0  AAAAAAAAOKPEBAAA           10  AAAAAAAAOKPEBAAA           74\n17  AAAAAAAAHOIIAAAA         10.0  AAAAAAAAHOIIAAAA           83  AAAAAAAAHOIIAAAA            1\n18  AAAAAAAACLONAAAA         58.0  AAAAAAAACLONAAAA           28  AAAAAAAACLONAAAA           78\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01848,
                    "execution_time": 0.008103,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.003986
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057699,
                    "execution_time": 0.008484,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039856
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID_COL_2\" AS \"ITEM_ID_COL_2\" , \"SPEQLITE_TEMP_TABLE_10\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID_COL_4\" AS \"ITEM_ID_COL_4\" , \"SPEQLITE_TEMP_TABLE_10\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty     item_id_col_2  cr_item_qty     item_id_col_4  wr_item_qty\n0   AAAAAAAAKAAABAAA         72.0  AAAAAAAAKAAABAAA            8  AAAAAAAAKAAABAAA            4\n1   AAAAAAAAGBOHAAAA         72.0  AAAAAAAAGBOHAAAA           19  AAAAAAAAGBOHAAAA            7\n2   AAAAAAAAJFLCBAAA         11.0  AAAAAAAAJFLCBAAA            4  AAAAAAAAJFLCBAAA           72\n3   AAAAAAAAGDCMAAAA          3.0  AAAAAAAAGDCMAAAA            5  AAAAAAAAGDCMAAAA            4\n4   AAAAAAAAIFJFBAAA         38.0  AAAAAAAAIFJFBAAA           40  AAAAAAAAIFJFBAAA           46\n5   AAAAAAAAHABOAAAA         47.0  AAAAAAAAHABOAAAA           13  AAAAAAAAHABOAAAA           42\n6   AAAAAAAAOMFABAAA         22.0  AAAAAAAAOMFABAAA           14  AAAAAAAAOMFABAAA            9\n7   AAAAAAAANJGPAAAA         13.0  AAAAAAAANJGPAAAA           17  AAAAAAAANJGPAAAA            1\n8   AAAAAAAAGKPPAAAA         31.0  AAAAAAAAGKPPAAAA           34  AAAAAAAAGKPPAAAA           50\n9   AAAAAAAAICFABAAA         19.0  AAAAAAAAICFABAAA           12  AAAAAAAAICFABAAA           20\n10  AAAAAAAAALJBBAAA         71.0  AAAAAAAAALJBBAAA            1  AAAAAAAAALJBBAAA           28\n11  AAAAAAAAAPIHBAAA          4.0  AAAAAAAAAPIHBAAA           17  AAAAAAAAAPIHBAAA           38\n12  AAAAAAAAMDPGBAAA         20.0  AAAAAAAAMDPGBAAA            9  AAAAAAAAMDPGBAAA           90\n13  AAAAAAAAGJJHBAAA          NaN  AAAAAAAAGJJHBAAA           23  AAAAAAAAGJJHBAAA           45\n14  AAAAAAAAHMIKAAAA         67.0  AAAAAAAAHMIKAAAA          114  AAAAAAAAHMIKAAAA            5\n15  AAAAAAAAIDMEBAAA         29.0  AAAAAAAAIDMEBAAA            9  AAAAAAAAIDMEBAAA           78\n16  AAAAAAAAOKPEBAAA         75.0  AAAAAAAAOKPEBAAA           10  AAAAAAAAOKPEBAAA           74\n17  AAAAAAAAHOIIAAAA         10.0  AAAAAAAAHOIIAAAA           83  AAAAAAAAHOIIAAAA            1\n18  AAAAAAAACLONAAAA         58.0  AAAAAAAACLONAAAA           28  AAAAAAAACLONAAAA           78\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\nselect *\nfrom sr_items\njoin cr_items on sr_items.item_id = cr_items.item_id\njoin wr_items on sr_items.item_id = wr_items.item_id;\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"CR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"WR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" AS \"ITEM_ID_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" AS \"ITEM_ID_COL_4\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.103601,
                    "execution_time": 0.065036,
                    "compile_time": 0.000305,
                    "planning_time": 0.006481,
                    "create_size": 864
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.156134,
                    "execution_time": 0.064238,
                    "compile_time": 0.000327,
                    "planning_time": 0.063641,
                    "create_size": 864
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID_COL_2\" AS \"ITEM_ID_COL_2\" , \"SPEQLITE_TEMP_TABLE_11\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID_COL_4\" AS \"ITEM_ID_COL_4\" , \"SPEQLITE_TEMP_TABLE_11\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty     item_id_col_2  cr_item_qty     item_id_col_4  wr_item_qty\n0   AAAAAAAAGDCMAAAA          3.0  AAAAAAAAGDCMAAAA            5  AAAAAAAAGDCMAAAA            4\n1   AAAAAAAAIFJFBAAA         38.0  AAAAAAAAIFJFBAAA           40  AAAAAAAAIFJFBAAA           46\n2   AAAAAAAAHABOAAAA         47.0  AAAAAAAAHABOAAAA           13  AAAAAAAAHABOAAAA           42\n3   AAAAAAAAKAAABAAA         72.0  AAAAAAAAKAAABAAA            8  AAAAAAAAKAAABAAA            4\n4   AAAAAAAAGPOMAAAA         52.0  AAAAAAAAGPOMAAAA           24  AAAAAAAAGPOMAAAA            4\n5   AAAAAAAAOMFABAAA         22.0  AAAAAAAAOMFABAAA           14  AAAAAAAAOMFABAAA            9\n6   AAAAAAAANJGPAAAA         13.0  AAAAAAAANJGPAAAA           17  AAAAAAAANJGPAAAA            1\n7   AAAAAAAAGKPPAAAA         31.0  AAAAAAAAGKPPAAAA           34  AAAAAAAAGKPPAAAA           50\n8   AAAAAAAAICFABAAA         19.0  AAAAAAAAICFABAAA           12  AAAAAAAAICFABAAA           20\n9   AAAAAAAAALJBBAAA         71.0  AAAAAAAAALJBBAAA            1  AAAAAAAAALJBBAAA           28\n10  AAAAAAAAAPIHBAAA          4.0  AAAAAAAAAPIHBAAA           17  AAAAAAAAAPIHBAAA           38\n11  AAAAAAAAIPIFBAAA         52.0  AAAAAAAAIPIFBAAA           34  AAAAAAAAIPIFBAAA            5\n12  AAAAAAAAGBADBAAA          5.0  AAAAAAAAGBADBAAA           96  AAAAAAAAGBADBAAA           23\n13  AAAAAAAAOIMDAAAA         14.0  AAAAAAAAOIMDAAAA           20  AAAAAAAAOIMDAAAA           11\n14  AAAAAAAAFFHHBAAA          3.0  AAAAAAAAFFHHBAAA            4  AAAAAAAAFFHHBAAA            8\n15  AAAAAAAANMDIBAAA         15.0  AAAAAAAANMDIBAAA           36  AAAAAAAANMDIBAAA            4\n16  AAAAAAAAGBOHAAAA         72.0  AAAAAAAAGBOHAAAA           19  AAAAAAAAGBOHAAAA            7\n17  AAAAAAAAJFLCBAAA         11.0  AAAAAAAAJFLCBAAA            4  AAAAAAAAJFLCBAAA           72\n18  AAAAAAAADOCIBAAA          NaN  AAAAAAAADOCIBAAA           49  AAAAAAAADOCIBAAA           26\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018688,
                    "execution_time": 0.008419,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.003945
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054803,
                    "execution_time": 0.008635,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.039671
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID_COL_2\" AS \"ITEM_ID_COL_2\" , \"SPEQLITE_TEMP_TABLE_11\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID_COL_4\" AS \"ITEM_ID_COL_4\" , \"SPEQLITE_TEMP_TABLE_11\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty     item_id_col_2  cr_item_qty     item_id_col_4  wr_item_qty\n0   AAAAAAAAGDCMAAAA          3.0  AAAAAAAAGDCMAAAA            5  AAAAAAAAGDCMAAAA            4\n1   AAAAAAAAIFJFBAAA         38.0  AAAAAAAAIFJFBAAA           40  AAAAAAAAIFJFBAAA           46\n2   AAAAAAAAHABOAAAA         47.0  AAAAAAAAHABOAAAA           13  AAAAAAAAHABOAAAA           42\n3   AAAAAAAAKAAABAAA         72.0  AAAAAAAAKAAABAAA            8  AAAAAAAAKAAABAAA            4\n4   AAAAAAAAGPOMAAAA         52.0  AAAAAAAAGPOMAAAA           24  AAAAAAAAGPOMAAAA            4\n5   AAAAAAAAOMFABAAA         22.0  AAAAAAAAOMFABAAA           14  AAAAAAAAOMFABAAA            9\n6   AAAAAAAANJGPAAAA         13.0  AAAAAAAANJGPAAAA           17  AAAAAAAANJGPAAAA            1\n7   AAAAAAAAGKPPAAAA         31.0  AAAAAAAAGKPPAAAA           34  AAAAAAAAGKPPAAAA           50\n8   AAAAAAAAICFABAAA         19.0  AAAAAAAAICFABAAA           12  AAAAAAAAICFABAAA           20\n9   AAAAAAAAALJBBAAA         71.0  AAAAAAAAALJBBAAA            1  AAAAAAAAALJBBAAA           28\n10  AAAAAAAAAPIHBAAA          4.0  AAAAAAAAAPIHBAAA           17  AAAAAAAAAPIHBAAA           38\n11  AAAAAAAAIPIFBAAA         52.0  AAAAAAAAIPIFBAAA           34  AAAAAAAAIPIFBAAA            5\n12  AAAAAAAAGBADBAAA          5.0  AAAAAAAAGBADBAAA           96  AAAAAAAAGBADBAAA           23\n13  AAAAAAAAOIMDAAAA         14.0  AAAAAAAAOIMDAAAA           20  AAAAAAAAOIMDAAAA           11\n14  AAAAAAAAFFHHBAAA          3.0  AAAAAAAAFFHHBAAA            4  AAAAAAAAFFHHBAAA            8\n15  AAAAAAAANMDIBAAA         15.0  AAAAAAAANMDIBAAA           36  AAAAAAAANMDIBAAA            4\n16  AAAAAAAAGBOHAAAA         72.0  AAAAAAAAGBOHAAAA           19  AAAAAAAAGBOHAAAA            7\n17  AAAAAAAAJFLCBAAA         11.0  AAAAAAAAJFLCBAAA            4  AAAAAAAAJFLCBAAA           72\n18  AAAAAAAADOCIBAAA          NaN  AAAAAAAADOCIBAAA           49  AAAAAAAADOCIBAAA           26\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns\n join item on sr_item_sk = i_item_sk\n join date_dim on sr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns\n join item on cr_item_sk = i_item_sk\n join date_dim on cr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns\n join item on wr_item_sk = i_item_sk\n join date_dim on wr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n/*CURSOR_IDENTIFIER*/\n group by i_item_id)\nselect sr_items.item_id, sr_item_qty, cr_item_qty, wr_item_qty\nfrom sr_items\nfull outer join cr_items on sr_items.item_id = cr_items.item_id\nfull outer join wr_items on sr_items.item_id = wr_items.item_id",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" FULL JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" FULL JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.073652,
                    "execution_time": 0.045957,
                    "compile_time": 0.000227,
                    "planning_time": 0.003607,
                    "create_size": 672
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.135653,
                    "execution_time": 0.046526,
                    "compile_time": 0.000232,
                    "planning_time": 0.059742,
                    "create_size": 672
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_12\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_12\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  cr_item_qty  wr_item_qty\n0   AAAAAAAAGEEEBAAA           49            6           12\n1   AAAAAAAAJMPEAAAA           23           57           19\n2   AAAAAAAADEJJAAAA           86            5           27\n3   AAAAAAAABLKIBAAA            8           21           17\n4   AAAAAAAAGNLABAAA           18            2           55\n5   AAAAAAAAFNNCBAAA           11            9           32\n6   AAAAAAAACBIEBAAA           74           45           33\n7   AAAAAAAACAAFAAAA           74           37            1\n8   AAAAAAAAEBDIAAAA           20            5           14\n9   AAAAAAAAKBIHAAAA           50           44           26\n10  AAAAAAAAJEEIAAAA           34           79            2\n11  AAAAAAAADIJIAAAA           51           24           47\n12  AAAAAAAAANMNAAAA           47            8            3\n13  AAAAAAAAJHMAAAAA           11           78            2\n14  AAAAAAAAIJFDAAAA           42           21           86\n15  AAAAAAAAOCEEBAAA           13           44           31\n16  AAAAAAAAIHHGBAAA           48            1           79\n17  AAAAAAAAIPGFBAAA           35            5           71\n18  AAAAAAAAOFMGAAAA           63           88            2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017285,
                    "execution_time": 0.007595,
                    "compile_time": 5e-05,
                    "planning_time": 0.003574
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056763,
                    "execution_time": 0.00824,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039305
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" FULL JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_12\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_12\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  cr_item_qty  wr_item_qty\n0   AAAAAAAAGEEEBAAA           49            6           12\n1   AAAAAAAAJMPEAAAA           23           57           19\n2   AAAAAAAADEJJAAAA           86            5           27\n3   AAAAAAAABLKIBAAA            8           21           17\n4   AAAAAAAAGNLABAAA           18            2           55\n5   AAAAAAAAFNNCBAAA           11            9           32\n6   AAAAAAAACBIEBAAA           74           45           33\n7   AAAAAAAACAAFAAAA           74           37            1\n8   AAAAAAAAEBDIAAAA           20            5           14\n9   AAAAAAAAKBIHAAAA           50           44           26\n10  AAAAAAAAJEEIAAAA           34           79            2\n11  AAAAAAAADIJIAAAA           51           24           47\n12  AAAAAAAAANMNAAAA           47            8            3\n13  AAAAAAAAJHMAAAAA           11           78            2\n14  AAAAAAAAIJFDAAAA           42           21           86\n15  AAAAAAAAOCEEBAAA           13           44           31\n16  AAAAAAAAIHHGBAAA           48            1           79\n17  AAAAAAAAIPGFBAAA           35            5           71\n18  AAAAAAAAOFMGAAAA           63           88            2\n...*/"
    },
    {
        "input": "with /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\nselect \n    coalesce(sr_items.item_id, cr_items.item_id, wr_items.item_id) as item_id,\n    coalesce(sr_item_qty, 0) as sr_item_qty, \n    coalesce(cr_item_qty, 0) as cr_item_qty, \n    coalesce(wr_item_qty, 0) as wr_item_qty\nfrom sr_items\nfull outer join cr_items on sr_items.item_id = cr_items.item_id\nfull outer join wr_items on coalesce(sr_items.item_id, cr_items.item_id) = wr_items.item_id;\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT COALESCE ( \"SR_ITEMS\".\"ITEM_ID\" , \"CR_ITEMS\".\"ITEM_ID\" , \"WR_ITEMS\".\"ITEM_ID\" ) AS \"ITEM_ID\" , COALESCE ( \"SR_ITEMS\".\"SR_ITEM_QTY\" , 0 ) AS \"SR_ITEM_QTY\" , COALESCE ( \"CR_ITEMS\".\"CR_ITEM_QTY\" , 0 ) AS \"CR_ITEM_QTY\" , COALESCE ( \"WR_ITEMS\".\"WR_ITEM_QTY\" , 0 ) AS \"WR_ITEM_QTY\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" FULL JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" FULL JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"WR_ITEMS\".\"ITEM_ID\" = COALESCE ( \"SR_ITEMS\".\"ITEM_ID\" , \"CR_ITEMS\".\"ITEM_ID\" )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" ) AS \"ITEM_ID\" , COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" , 0 ) AS \"SR_ITEM_QTY\" , COALESCE ( \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" , 0 ) AS \"CR_ITEM_QTY\" , COALESCE ( \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" , 0 ) AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" FULL JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" = COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.120177,
                    "execution_time": 0.061064,
                    "compile_time": 0.000375,
                    "planning_time": 0.007923,
                    "create_size": 238
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.189199,
                    "execution_time": 0.067134,
                    "compile_time": 0.000366,
                    "planning_time": 0.065457,
                    "create_size": 238
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_13\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_13\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  cr_item_qty  wr_item_qty\n0   AAAAAAAACGIKAAAA           19            0            0\n1   AAAAAAAALMHBAAAA           25            0            0\n2   AAAAAAAAMPPIAAAA           21            0            0\n3   AAAAAAAAIIJKAAAA           74            0            0\n4   AAAAAAAAABFEBAAA           52           49            0\n5   AAAAAAAAKAEJAAAA           33            0            0\n6   AAAAAAAAOGMIAAAA           51            0            0\n7   AAAAAAAAFFHHBAAA            3            4            8\n8   AAAAAAAAHBPHBAAA            8            0            0\n9   AAAAAAAAMGOJAAAA           35            0            0\n10  AAAAAAAAMPOOAAAA            4            0            0\n11  AAAAAAAANMDIBAAA           15           36            4\n12  AAAAAAAABAJDAAAA           32            0            0\n13  AAAAAAAADICGAAAA           16            0            0\n14  AAAAAAAANKENAAAA           33            0            0\n15  AAAAAAAAIJCEAAAA           24            0            0\n16  AAAAAAAAEOOLAAAA            3            0            0\n17  AAAAAAAAPCOAAAAA           38            9            0\n18  AAAAAAAAAFAJAAAA           51            0           64\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017304,
                    "execution_time": 0.007544,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003579
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055735,
                    "execution_time": 0.007235,
                    "compile_time": 5e-05,
                    "planning_time": 0.039142
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" ) AS \"ITEM_ID\" , COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" , 0 ) AS \"SR_ITEM_QTY\" , COALESCE ( \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" , 0 ) AS \"CR_ITEM_QTY\" , COALESCE ( \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" , 0 ) AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" FULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" FULL JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" = COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" )",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_13\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_13\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  cr_item_qty  wr_item_qty\n0   AAAAAAAACGIKAAAA           19            0            0\n1   AAAAAAAALMHBAAAA           25            0            0\n2   AAAAAAAAMPPIAAAA           21            0            0\n3   AAAAAAAAIIJKAAAA           74            0            0\n4   AAAAAAAAABFEBAAA           52           49            0\n5   AAAAAAAAKAEJAAAA           33            0            0\n6   AAAAAAAAOGMIAAAA           51            0            0\n7   AAAAAAAAFFHHBAAA            3            4            8\n8   AAAAAAAAHBPHBAAA            8            0            0\n9   AAAAAAAAMGOJAAAA           35            0            0\n10  AAAAAAAAMPOOAAAA            4            0            0\n11  AAAAAAAANMDIBAAA           15           36            4\n12  AAAAAAAABAJDAAAA           32            0            0\n13  AAAAAAAADICGAAAA           16            0            0\n14  AAAAAAAANKENAAAA           33            0            0\n15  AAAAAAAAIJCEAAAA           24            0            0\n16  AAAAAAAAEOOLAAAA            3            0            0\n17  AAAAAAAAPCOAAAAA           38            9            0\n18  AAAAAAAAAFAJAAAA           51            0           64\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns\n      join item on sr_item_sk = i_item_sk\n      join date_dim on sr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns\n      join item on cr_item_sk = i_item_sk\n      join date_dim on cr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns\n      join item on wr_item_sk = i_item_sk\n      join date_dim on wr_returned_date_sk = d_date_sk\n where d_date in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n group by i_item_id)\nselect sr_items.item_id, sr_items.sr_item_qty, cr_items.cr_item_qty, wr_items.wr_item_qty\nfrom sr_items\nleft join cr_items on sr_items.item_id = cr_items.item_id\nleft join wr_items on sr_items.item_id = wr_items.item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" LEFT JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  cr_item_qty  wr_item_qty\n0   AAAAAAAAGEEEBAAA           49            6           12\n1   AAAAAAAACBIEBAAA           74           45           33\n2   AAAAAAAACAAFAAAA           74           37            1\n3   AAAAAAAAEBDIAAAA           20            5           14\n4   AAAAAAAAKBIHAAAA           50           44           26\n5   AAAAAAAAJEEIAAAA           34           79            2\n6   AAAAAAAADIJIAAAA           51           24           47\n7   AAAAAAAAANMNAAAA           47            8            3\n8   AAAAAAAAJHMAAAAA           11           78            2\n9   AAAAAAAAIJFDAAAA           42           21           86\n10  AAAAAAAAOCEEBAAA           13           44           31\n11  AAAAAAAACJIPAAAA           13           11           11\n12  AAAAAAAACPGIAAAA            5           46            3\n13  AAAAAAAAGMGHAAAA          104           38           18\n14  AAAAAAAAALNDBAAA           48            2            7\n15  AAAAAAAADPCLAAAA            1            8           59\n16  AAAAAAAAMEKDAAAA           44          103           16\n17  AAAAAAAAEKCHAAAA           20           10           31\n18  AAAAAAAALKDNAAAA            5            7           78\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017569,
                    "execution_time": 0.00776,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003597
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05341,
                    "execution_time": 0.00803,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.038887
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "rewrite": "SELECT \"ITEM_ID\" AS \"ITEM_ID\", \"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\", \"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\", \"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  cr_item_qty  wr_item_qty\n0   AAAAAAAAGEEEBAAA           49            6           12\n1   AAAAAAAACBIEBAAA           74           45           33\n2   AAAAAAAACAAFAAAA           74           37            1\n3   AAAAAAAAEBDIAAAA           20            5           14\n4   AAAAAAAAKBIHAAAA           50           44           26\n5   AAAAAAAAJEEIAAAA           34           79            2\n6   AAAAAAAADIJIAAAA           51           24           47\n7   AAAAAAAAANMNAAAA           47            8            3\n8   AAAAAAAAJHMAAAAA           11           78            2\n9   AAAAAAAAIJFDAAAA           42           21           86\n10  AAAAAAAAOCEEBAAA           13           44           31\n11  AAAAAAAACJIPAAAA           13           11           11\n12  AAAAAAAACPGIAAAA            5           46            3\n13  AAAAAAAAGMGHAAAA          104           38           18\n14  AAAAAAAAALNDBAAA           48            2            7\n15  AAAAAAAADPCLAAAA            1            8           59\n16  AAAAAAAAMEKDAAAA           44          103           16\n17  AAAAAAAAEKCHAAAA           20           10           31\n18  AAAAAAAALKDNAAAA            5            7           78\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(coalesce(sr_item_qty, 0)+coalesce(cr_item_qty, 0)+coalesce(wr_item_qty, 0))/3.0 * 100 as sr_dev\nfrom sr_items\nleft join cr_items on sr_items.item_id = cr_items.item_id\nleft join wr_items on sr_items.item_id = wr_items.item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( COALESCE ( \"SR_ITEMS\".\"SR_ITEM_QTY\" , 0 ) + COALESCE ( \"CR_ITEMS\".\"CR_ITEM_QTY\" , 0 ) + COALESCE ( \"WR_ITEMS\".\"WR_ITEM_QTY\" , 0 ) ) / 3.0 * 100 AS \"SR_DEV\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" LEFT JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" , 0 ) + COALESCE ( \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" , 0 ) + COALESCE ( \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" , 0 ) ) / 3.0 * 100 AS \"SR_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.111376,
                    "execution_time": 0.062146,
                    "compile_time": 0.000295,
                    "planning_time": 0.008404,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.178579,
                    "execution_time": 0.063322,
                    "compile_time": 0.00031,
                    "planning_time": 0.06745,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_14\".\"SR_DEV\" AS \"SR_DEV\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev\n0   AAAAAAAACGNBBAAA           47   33.33\n1   AAAAAAAAEOIFBAAA            6   33.33\n2   AAAAAAAAHDLABAAA           24   33.33\n3   AAAAAAAAANBEBAAA           70    0.00\n4   AAAAAAAAAAJEBAAA           16   33.33\n5   AAAAAAAAJIOGAAAA           13   33.33\n6   AAAAAAAAPBDJAAAA           64   33.33\n7   AAAAAAAAFBNFBAAA          117   33.33\n8   AAAAAAAAECKGBAAA            4   33.33\n9   AAAAAAAACGINAAAA           14    0.00\n10  AAAAAAAANIBDAAAA           30    0.00\n11  AAAAAAAAGGDBAAAA           75   33.33\n12  AAAAAAAACNFFAAAA           58    0.00\n13  AAAAAAAABOFIAAAA           52    0.00\n14  AAAAAAAAADBCBAAA           23   33.33\n15  AAAAAAAAKHLPAAAA           35   33.33\n16  AAAAAAAAJLACAAAA           14   33.33\n17  AAAAAAAAKHJBBAAA           15   33.33\n18  AAAAAAAAKIPBAAAA           19   33.33\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01687,
                    "execution_time": 0.007375,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.003406
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056831,
                    "execution_time": 0.008405,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.03916
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( COALESCE ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" , 0 ) + COALESCE ( \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" , 0 ) + COALESCE ( \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" , 0 ) ) / 3.0 * 100 AS \"SR_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_14\".\"SR_DEV\" AS \"SR_DEV\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev\n0   AAAAAAAACGNBBAAA           47   33.33\n1   AAAAAAAAEOIFBAAA            6   33.33\n2   AAAAAAAAHDLABAAA           24   33.33\n3   AAAAAAAAANBEBAAA           70    0.00\n4   AAAAAAAAAAJEBAAA           16   33.33\n5   AAAAAAAAJIOGAAAA           13   33.33\n6   AAAAAAAAPBDJAAAA           64   33.33\n7   AAAAAAAAFBNFBAAA          117   33.33\n8   AAAAAAAAECKGBAAA            4   33.33\n9   AAAAAAAACGINAAAA           14    0.00\n10  AAAAAAAANIBDAAAA           30    0.00\n11  AAAAAAAAGGDBAAAA           75   33.33\n12  AAAAAAAACNFFAAAA           58    0.00\n13  AAAAAAAABOFIAAAA           52    0.00\n14  AAAAAAAAADBCBAAA           23   33.33\n15  AAAAAAAAKHLPAAAA           35   33.33\n16  AAAAAAAAJLACAAAA           14   33.33\n17  AAAAAAAAKHJBBAAA           15   33.33\n18  AAAAAAAAKIPBAAAA           19   33.33\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_items.sr_item_qty\n       ,sr_items.sr_item_qty/(sr_items.sr_item_qty+cr_items.cr_item_qty+wr_items.wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_items.cr_item_qty\n       ,cr_items.cr_item_qty/(sr_items.sr_item_qty+cr_items.cr_item_qty+wr_items.wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_items.wr_item_qty\n       ,wr_items.wr_item_qty/(sr_items.sr_item_qty+cr_items.cr_item_qty+wr_items.wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_items.sr_item_qty+cr_items.cr_item_qty+wr_items.wr_item_qty)/3.0 average\n from sr_items\n      , cr_items\n      , wr_items\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" CROSS JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" CROSS JOIN \"WR_ITEMS\" AS \"WR_ITEMS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.065064,
                    "execution_time": 0.036548,
                    "compile_time": 0.000232,
                    "planning_time": 0.002942,
                    "create_size": 52
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.150203,
                    "execution_time": 0.036884,
                    "compile_time": 0.000245,
                    "planning_time": 0.081151,
                    "create_size": 52
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.063057,
                    "execution_time": 0.035368,
                    "compile_time": 0.000233,
                    "planning_time": 0.002984,
                    "create_size": 28
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.12677,
                    "execution_time": 0.036198,
                    "compile_time": 0.000238,
                    "planning_time": 0.059351,
                    "create_size": 28
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAACGNBBAAA           47     0.0            6     0.0           19     0.0  24.0000\n1   AAAAAAAAEOIFBAAA            6     0.0            6     0.0           19     0.0  10.3333\n2   AAAAAAAAHDLABAAA           24     0.0            6     0.0           19     0.0  16.3333\n3   AAAAAAAAANBEBAAA           70     0.0            6     0.0           19     0.0  31.6666\n4   AAAAAAAAAAJEBAAA           16     0.0            6     0.0           19     0.0  13.6666\n5   AAAAAAAAJIOGAAAA           13     0.0            6     0.0           19     0.0  12.6666\n6   AAAAAAAAPBDJAAAA           64     0.0            6     0.0           19     0.0  29.6666\n7   AAAAAAAAFBNFBAAA          117     0.0            6     0.0           19     0.0  47.3333\n8   AAAAAAAAECKGBAAA            4     0.0            6     0.0           19     0.0   9.6666\n9   AAAAAAAACGINAAAA           14     0.0            6     0.0           19     0.0  13.0000\n10  AAAAAAAANIBDAAAA           30     0.0            6     0.0           19     0.0  18.3333\n11  AAAAAAAAGGDBAAAA           75     0.0            6     0.0           19     0.0  33.3333\n12  AAAAAAAACNFFAAAA           58     0.0            6     0.0           19     0.0  27.6666\n13  AAAAAAAABOFIAAAA           52     0.0            6     0.0           19     0.0  25.6666\n14  AAAAAAAAADBCBAAA           23     0.0            6     0.0           19     0.0  16.0000\n15  AAAAAAAAKHLPAAAA           35     0.0            6     0.0           19     0.0  20.0000\n16  AAAAAAAAJLACAAAA           14     0.0            6     0.0           19     0.0  13.0000\n17  AAAAAAAAKHJBBAAA           15     0.0            6     0.0           19     0.0  13.3333\n18  AAAAAAAAKIPBAAAA           19     0.0            6     0.0           19     0.0  14.6666\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.040158,
                    "execution_time": 0.022245,
                    "compile_time": 0.000146,
                    "planning_time": 0.008758
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.08013,
                    "execution_time": 0.022785,
                    "compile_time": 0.004466,
                    "planning_time": 0.044987
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAACGNBBAAA           47     0.0            6     0.0           19     0.0  24.0000\n1   AAAAAAAAEOIFBAAA            6     0.0            6     0.0           19     0.0  10.3333\n2   AAAAAAAAHDLABAAA           24     0.0            6     0.0           19     0.0  16.3333\n3   AAAAAAAAANBEBAAA           70     0.0            6     0.0           19     0.0  31.6666\n4   AAAAAAAAAAJEBAAA           16     0.0            6     0.0           19     0.0  13.6666\n5   AAAAAAAAJIOGAAAA           13     0.0            6     0.0           19     0.0  12.6666\n6   AAAAAAAAPBDJAAAA           64     0.0            6     0.0           19     0.0  29.6666\n7   AAAAAAAAFBNFBAAA          117     0.0            6     0.0           19     0.0  47.3333\n8   AAAAAAAAECKGBAAA            4     0.0            6     0.0           19     0.0   9.6666\n9   AAAAAAAACGINAAAA           14     0.0            6     0.0           19     0.0  13.0000\n10  AAAAAAAANIBDAAAA           30     0.0            6     0.0           19     0.0  18.3333\n11  AAAAAAAAGGDBAAAA           75     0.0            6     0.0           19     0.0  33.3333\n12  AAAAAAAACNFFAAAA           58     0.0            6     0.0           19     0.0  27.6666\n13  AAAAAAAABOFIAAAA           52     0.0            6     0.0           19     0.0  25.6666\n14  AAAAAAAAADBCBAAA           23     0.0            6     0.0           19     0.0  16.0000\n15  AAAAAAAAKHLPAAAA           35     0.0            6     0.0           19     0.0  20.0000\n16  AAAAAAAAJLACAAAA           14     0.0            6     0.0           19     0.0  13.0000\n17  AAAAAAAAKHJBBAAA           15     0.0            6     0.0           19     0.0  13.3333\n18  AAAAAAAAKIPBAAAA           19     0.0            6     0.0           19     0.0  14.6666\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" CROSS JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" CROSS JOIN \"WR_ITEMS\" AS \"WR_ITEMS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAAJAFCAAAA          147     0.0            6     0.0           19     0.0  57.3333\n1   AAAAAAAAPKAIBAAA           33     0.0            6     0.0           19     0.0  19.3333\n2   AAAAAAAAAKNGAAAA           70     0.0            6     0.0           19     0.0  31.6666\n3   AAAAAAAAIIJPAAAA           35     0.0            6     0.0           19     0.0  20.0000\n4   AAAAAAAAINBAAAAA            3     0.0            6     0.0           19     0.0   9.3333\n5   AAAAAAAAMGECBAAA           25     0.0            6     0.0           19     0.0  16.6666\n6   AAAAAAAACIEHBAAA            8     0.0            6     0.0           19     0.0  11.0000\n7   AAAAAAAAGHHHBAAA           44     0.0            6     0.0           19     0.0  23.0000\n8   AAAAAAAAKCOOAAAA           47     0.0            6     0.0           19     0.0  24.0000\n9   AAAAAAAAGLOKAAAA            9     0.0            6     0.0           19     0.0  11.3333\n10  AAAAAAAAKACBBAAA           12     0.0            6     0.0           19     0.0  12.3333\n11  AAAAAAAAAIBBBAAA           62     0.0            6     0.0           19     0.0  29.0000\n12  AAAAAAAAKBMIBAAA           65     0.0            6     0.0           19     0.0  30.0000\n13  AAAAAAAAFCBHBAAA           83     0.0            6     0.0           19     0.0  36.0000\n14  AAAAAAAAKIDHAAAA           42     0.0            6     0.0           19     0.0  22.3333\n15  AAAAAAAANNJEBAAA           25     0.0            6     0.0           19     0.0  16.6666\n16  AAAAAAAAGAOAAAAA           46     0.0            6     0.0           19     0.0  23.6666\n17  AAAAAAAAOMKCAAAA           55     0.0            6     0.0           19     0.0  26.6666\n18  AAAAAAAAGDBABAAA           79     0.0            6     0.0           19     0.0  34.6666\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.04067,
                    "execution_time": 0.022678,
                    "compile_time": 0.00015,
                    "planning_time": 0.008763
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051784,
                    "execution_time": 0.02253,
                    "compile_time": 0.000159,
                    "planning_time": 0.008865
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAAJAFCAAAA          147     0.0            6     0.0           19     0.0  57.3333\n1   AAAAAAAAPKAIBAAA           33     0.0            6     0.0           19     0.0  19.3333\n2   AAAAAAAAAKNGAAAA           70     0.0            6     0.0           19     0.0  31.6666\n3   AAAAAAAAIIJPAAAA           35     0.0            6     0.0           19     0.0  20.0000\n4   AAAAAAAAINBAAAAA            3     0.0            6     0.0           19     0.0   9.3333\n5   AAAAAAAAMGECBAAA           25     0.0            6     0.0           19     0.0  16.6666\n6   AAAAAAAACIEHBAAA            8     0.0            6     0.0           19     0.0  11.0000\n7   AAAAAAAAGHHHBAAA           44     0.0            6     0.0           19     0.0  23.0000\n8   AAAAAAAAKCOOAAAA           47     0.0            6     0.0           19     0.0  24.0000\n9   AAAAAAAAGLOKAAAA            9     0.0            6     0.0           19     0.0  11.3333\n10  AAAAAAAAKACBBAAA           12     0.0            6     0.0           19     0.0  12.3333\n11  AAAAAAAAAIBBBAAA           62     0.0            6     0.0           19     0.0  29.0000\n12  AAAAAAAAKBMIBAAA           65     0.0            6     0.0           19     0.0  30.0000\n13  AAAAAAAAFCBHBAAA           83     0.0            6     0.0           19     0.0  36.0000\n14  AAAAAAAAKIDHAAAA           42     0.0            6     0.0           19     0.0  22.3333\n15  AAAAAAAANNJEBAAA           25     0.0            6     0.0           19     0.0  16.6666\n16  AAAAAAAAGAOAAAAA           46     0.0            6     0.0           19     0.0  23.6666\n17  AAAAAAAAOMKCAAAA           55     0.0            6     0.0           19     0.0  26.6666\n18  AAAAAAAAGDBABAAA           79     0.0            6     0.0           19     0.0  34.6666\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" CROSS JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" CROSS JOIN \"WR_ITEMS\" AS \"WR_ITEMS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAAHNKBAAAA            5     0.0            4     0.0           48     0.0  19.0000\n1   AAAAAAAAKDHIBAAA            3     0.0            4     0.0           48     0.0  18.3333\n2   AAAAAAAAEFOJAAAA           15     0.0            4     0.0           48     0.0  22.3333\n3   AAAAAAAAKEPGAAAA           29     0.0            4     0.0           48     0.0  27.0000\n4   AAAAAAAAOJDHBAAA            4     0.0            4     0.0           48     0.0  18.6666\n5   AAAAAAAAIECIAAAA           81     0.0            4     0.0           48     0.0  44.3333\n6   AAAAAAAAJMCCAAAA            6     0.0            4     0.0           48     0.0  19.3333\n7   AAAAAAAAIMABBAAA           26     0.0            4     0.0           48     0.0  26.0000\n8   AAAAAAAAMPPHAAAA           19     0.0            4     0.0           48     0.0  23.6666\n9   AAAAAAAALDJBBAAA            9     0.0            4     0.0           48     0.0  20.3333\n10  AAAAAAAAOBMEBAAA           25     0.0            4     0.0           48     0.0  25.6666\n11  AAAAAAAADGCIAAAA           24     0.0            4     0.0           48     0.0  25.3333\n12  AAAAAAAAOIJGBAAA            9     0.0            4     0.0           48     0.0  20.3333\n13  AAAAAAAALPGLAAAA           34     0.0            4     0.0           48     0.0  28.6666\n14  AAAAAAAAGCKABAAA           31     0.0            4     0.0           48     0.0  27.6666\n15  AAAAAAAAAFIDBAAA           20     0.0            4     0.0           48     0.0  24.0000\n16  AAAAAAAAJPJBAAAA           88     0.0            4     0.0           48     0.0  46.6666\n17  AAAAAAAAJHGFBAAA           62     0.0            4     0.0           48     0.0  38.0000\n18  AAAAAAAAHAFHAAAA            5     0.0            4     0.0           48     0.0  19.0000\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.040602,
                    "execution_time": 0.022822,
                    "compile_time": 0.000143,
                    "planning_time": 0.008751
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.040703,
                    "execution_time": 0.022593,
                    "compile_time": 0.000148,
                    "planning_time": 0.008869
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_15\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAAHNKBAAAA            5     0.0            4     0.0           48     0.0  19.0000\n1   AAAAAAAAKDHIBAAA            3     0.0            4     0.0           48     0.0  18.3333\n2   AAAAAAAAEFOJAAAA           15     0.0            4     0.0           48     0.0  22.3333\n3   AAAAAAAAKEPGAAAA           29     0.0            4     0.0           48     0.0  27.0000\n4   AAAAAAAAOJDHBAAA            4     0.0            4     0.0           48     0.0  18.6666\n5   AAAAAAAAIECIAAAA           81     0.0            4     0.0           48     0.0  44.3333\n6   AAAAAAAAJMCCAAAA            6     0.0            4     0.0           48     0.0  19.3333\n7   AAAAAAAAIMABBAAA           26     0.0            4     0.0           48     0.0  26.0000\n8   AAAAAAAAMPPHAAAA           19     0.0            4     0.0           48     0.0  23.6666\n9   AAAAAAAALDJBBAAA            9     0.0            4     0.0           48     0.0  20.3333\n10  AAAAAAAAOBMEBAAA           25     0.0            4     0.0           48     0.0  25.6666\n11  AAAAAAAADGCIAAAA           24     0.0            4     0.0           48     0.0  25.3333\n12  AAAAAAAAOIJGBAAA            9     0.0            4     0.0           48     0.0  20.3333\n13  AAAAAAAALPGLAAAA           34     0.0            4     0.0           48     0.0  28.6666\n14  AAAAAAAAGCKABAAA           31     0.0            4     0.0           48     0.0  27.6666\n15  AAAAAAAAAFIDBAAA           20     0.0            4     0.0           48     0.0  24.0000\n16  AAAAAAAAJPJBAAAA           88     0.0            4     0.0           48     0.0  46.6666\n17  AAAAAAAAJHGFBAAA           62     0.0            4     0.0           48     0.0  38.0000\n18  AAAAAAAAHAFHAAAA            5     0.0            4     0.0           48     0.0  19.0000\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n where sr_items.item_id=cr_items.item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" CROSS JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.41056,
                    "execution_time": 0.878913,
                    "compile_time": 0.071133,
                    "planning_time": 0.009446,
                    "create_size": 1987
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.336208,
                    "execution_time": 1.421702,
                    "compile_time": 3.379615,
                    "planning_time": 0.073197,
                    "create_size": 1987
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAANIBDAAAA           30     0.0           36     0.0         14.0     0.0  26.6666\n1   AAAAAAAANIBDAAAA           30     0.0           36     0.0         35.0     0.0  33.6666\n2   AAAAAAAANIBDAAAA           30     0.0           36     0.0          1.0     0.0  22.3333\n3   AAAAAAAANIBDAAAA           30     0.0           36     0.0         28.0     0.0  31.3333\n4   AAAAAAAANIBDAAAA           30     0.0           36     0.0         64.0     0.0  43.3333\n5   AAAAAAAANIBDAAAA           30     0.0           36     0.0         53.0     0.0  39.6666\n6   AAAAAAAANIBDAAAA           30     0.0           36     0.0         40.0     0.0  35.3333\n7   AAAAAAAANIBDAAAA           30     NaN           36     NaN          NaN     NaN      NaN\n8   AAAAAAAANIBDAAAA           30     0.0           36     0.0         20.0     0.0  28.6666\n9   AAAAAAAANIBDAAAA           30     0.0           36     0.0          3.0     0.0  23.0000\n10  AAAAAAAANIBDAAAA           30     0.0           36     0.0         48.0     0.0  38.0000\n11  AAAAAAAANIBDAAAA           30     0.0           36     0.0          4.0     0.0  23.3333\n12  AAAAAAAANIBDAAAA           30     0.0           36     0.0         31.0     0.0  32.3333\n13  AAAAAAAANIBDAAAA           30     0.0           36     0.0          1.0     0.0  22.3333\n14  AAAAAAAANIBDAAAA           30     0.0           36     0.0         21.0     0.0  29.0000\n15  AAAAAAAANIBDAAAA           30     0.0           36     0.0         10.0     0.0  25.3333\n16  AAAAAAAANIBDAAAA           30     0.0           36     0.0          7.0     0.0  24.3333\n17  AAAAAAAANIBDAAAA           30     0.0           36     0.0          9.0     0.0  25.0000\n18  AAAAAAAANIBDAAAA           30     0.0           36     0.0          9.0     0.0  25.0000\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01858,
                    "execution_time": 0.007645,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004294
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.059307,
                    "execution_time": 0.008597,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.040787
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_16\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_17\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAANIBDAAAA           30     0.0           36     0.0         14.0     0.0  26.6666\n1   AAAAAAAANIBDAAAA           30     0.0           36     0.0         35.0     0.0  33.6666\n2   AAAAAAAANIBDAAAA           30     0.0           36     0.0          1.0     0.0  22.3333\n3   AAAAAAAANIBDAAAA           30     0.0           36     0.0         28.0     0.0  31.3333\n4   AAAAAAAANIBDAAAA           30     0.0           36     0.0         64.0     0.0  43.3333\n5   AAAAAAAANIBDAAAA           30     0.0           36     0.0         53.0     0.0  39.6666\n6   AAAAAAAANIBDAAAA           30     0.0           36     0.0         40.0     0.0  35.3333\n7   AAAAAAAANIBDAAAA           30     NaN           36     NaN          NaN     NaN      NaN\n8   AAAAAAAANIBDAAAA           30     0.0           36     0.0         20.0     0.0  28.6666\n9   AAAAAAAANIBDAAAA           30     0.0           36     0.0          3.0     0.0  23.0000\n10  AAAAAAAANIBDAAAA           30     0.0           36     0.0         48.0     0.0  38.0000\n11  AAAAAAAANIBDAAAA           30     0.0           36     0.0          4.0     0.0  23.3333\n12  AAAAAAAANIBDAAAA           30     0.0           36     0.0         31.0     0.0  32.3333\n13  AAAAAAAANIBDAAAA           30     0.0           36     0.0          1.0     0.0  22.3333\n14  AAAAAAAANIBDAAAA           30     0.0           36     0.0         21.0     0.0  29.0000\n15  AAAAAAAANIBDAAAA           30     0.0           36     0.0         10.0     0.0  25.3333\n16  AAAAAAAANIBDAAAA           30     0.0           36     0.0          7.0     0.0  24.3333\n17  AAAAAAAANIBDAAAA           30     0.0           36     0.0          9.0     0.0  25.0000\n18  AAAAAAAANIBDAAAA           30     0.0           36     0.0          9.0     0.0  25.0000\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n where sr_items.item_id=cr_items.item_id\n   and sr_items.item_id=wr_items.item_id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.106608,
                    "execution_time": 0.0675,
                    "compile_time": 0.000318,
                    "planning_time": 0.00951,
                    "create_size": 1056
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.394963,
                    "execution_time": 0.068488,
                    "compile_time": 0.225062,
                    "planning_time": 0.067239,
                    "create_size": 1056
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_18\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_18\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAAKAAABAAA         72.0     0.0            8     0.0            4     0.0  28.0000\n1   AAAAAAAAGDCMAAAA          3.0     0.0            5     0.0            4     0.0   4.0000\n2   AAAAAAAAIFJFBAAA         38.0     0.0           40     0.0           46     0.0  41.3333\n3   AAAAAAAAHABOAAAA         47.0     0.0           13     0.0           42     0.0  34.0000\n4   AAAAAAAAGPOMAAAA         52.0     0.0           24     0.0            4     0.0  26.6666\n5   AAAAAAAAOMFABAAA         22.0     0.0           14     0.0            9     0.0  15.0000\n6   AAAAAAAANJGPAAAA         13.0     0.0           17     0.0            1     0.0  10.3333\n7   AAAAAAAAGKPPAAAA         31.0     0.0           34     0.0           50     0.0  38.3333\n8   AAAAAAAAICFABAAA         19.0     0.0           12     0.0           20     0.0  17.0000\n9   AAAAAAAAALJBBAAA         71.0     0.0            1     0.0           28     0.0  33.3333\n10  AAAAAAAAAPIHBAAA          4.0     0.0           17     0.0           38     0.0  19.6666\n11  AAAAAAAAOIMDAAAA         14.0     0.0           20     0.0           11     0.0  15.0000\n12  AAAAAAAAFFHHBAAA          3.0     0.0            4     0.0            8     0.0   5.0000\n13  AAAAAAAANMDIBAAA         15.0     0.0           36     0.0            4     0.0  18.3333\n14  AAAAAAAAMDPGBAAA         20.0     0.0            9     0.0           90     0.0  39.6666\n15  AAAAAAAAGJJHBAAA          NaN     NaN           23     NaN           45     NaN      NaN\n16  AAAAAAAADOCIBAAA          NaN     NaN           49     NaN           26     NaN      NaN\n17  AAAAAAAAGGOCAAAA         87.0     0.0            4     0.0           70     0.0  53.6666\n18  AAAAAAAABBCGAAAA         65.0     0.0           26     0.0           60     0.0  50.3333\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019676,
                    "execution_time": 0.008754,
                    "compile_time": 7e-05,
                    "planning_time": 0.004288
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057125,
                    "execution_time": 0.008865,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.040114
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_18\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_18\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\""
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAAKAAABAAA         72.0     0.0            8     0.0            4     0.0  28.0000\n1   AAAAAAAAGDCMAAAA          3.0     0.0            5     0.0            4     0.0   4.0000\n2   AAAAAAAAIFJFBAAA         38.0     0.0           40     0.0           46     0.0  41.3333\n3   AAAAAAAAHABOAAAA         47.0     0.0           13     0.0           42     0.0  34.0000\n4   AAAAAAAAGPOMAAAA         52.0     0.0           24     0.0            4     0.0  26.6666\n5   AAAAAAAAOMFABAAA         22.0     0.0           14     0.0            9     0.0  15.0000\n6   AAAAAAAANJGPAAAA         13.0     0.0           17     0.0            1     0.0  10.3333\n7   AAAAAAAAGKPPAAAA         31.0     0.0           34     0.0           50     0.0  38.3333\n8   AAAAAAAAICFABAAA         19.0     0.0           12     0.0           20     0.0  17.0000\n9   AAAAAAAAALJBBAAA         71.0     0.0            1     0.0           28     0.0  33.3333\n10  AAAAAAAAAPIHBAAA          4.0     0.0           17     0.0           38     0.0  19.6666\n11  AAAAAAAAOIMDAAAA         14.0     0.0           20     0.0           11     0.0  15.0000\n12  AAAAAAAAFFHHBAAA          3.0     0.0            4     0.0            8     0.0   5.0000\n13  AAAAAAAANMDIBAAA         15.0     0.0           36     0.0            4     0.0  18.3333\n14  AAAAAAAAMDPGBAAA         20.0     0.0            9     0.0           90     0.0  39.6666\n15  AAAAAAAAGJJHBAAA          NaN     NaN           23     NaN           45     NaN      NaN\n16  AAAAAAAADOCIBAAA          NaN     NaN           49     NaN           26     NaN      NaN\n17  AAAAAAAAGGOCAAAA         87.0     0.0            4     0.0           70     0.0  53.6666\n18  AAAAAAAABBCGAAAA         65.0     0.0           26     0.0           60     0.0  50.3333\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n where sr_items.item_id=cr_items.item_id\n   and sr_items.item_id=wr_items.item_id \n order by sr_items.item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\" ORDER BY \"SR_ITEMS\".\"ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_18\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_18\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ORDER BY \"SPEQLITE_TEMP_TABLE_18\".\"ITEM_ID\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAAAAIBBAAA            1     0.0         11.0     0.0           25     0.0  12.3333\n1   AAAAAAAAABIIAAAA           23     0.0          1.0     0.0           11     0.0  11.6666\n2   AAAAAAAAACFPAAAA           17     0.0         49.0     0.0           38     0.0  34.6666\n3   AAAAAAAAACHABAAA            2     0.0          8.0     0.0           73     0.0  27.6666\n4   AAAAAAAAACMIAAAA           84     0.0         52.0     0.0           59     0.0  65.0000\n5   AAAAAAAAACOKAAAA            1     0.0         28.0     0.0            1     0.0  10.0000\n6   AAAAAAAAAFLEAAAA           68     0.0         43.0     0.0            6     0.0  39.0000\n7   AAAAAAAAAGJDBAAA           52     0.0         47.0     0.0           36     0.0  45.0000\n8   AAAAAAAAAHLGBAAA           21     0.0         74.0     0.0           15     0.0  36.6666\n9   AAAAAAAAAJDGBAAA           64     0.0         53.0     0.0           53     0.0  56.6666\n10  AAAAAAAAAKCHBAAA           16     0.0         65.0     0.0           51     0.0  44.0000\n11  AAAAAAAAALJBBAAA           71     0.0          1.0     0.0           28     0.0  33.3333\n12  AAAAAAAAALNDBAAA           48     0.0          2.0     0.0            7     0.0  19.0000\n13  AAAAAAAAANMNAAAA           47     0.0          8.0     0.0            3     0.0  19.3333\n14  AAAAAAAAAPIHBAAA            4     0.0         17.0     0.0           38     0.0  19.6666\n15  AAAAAAAABALHAAAA           38     NaN          NaN     NaN            5     NaN      NaN\n16  AAAAAAAABBCGAAAA           65     0.0         26.0     0.0           60     0.0  50.3333\n17  AAAAAAAABDGDAAAA            8     0.0         41.0     0.0            5     0.0  18.0000\n18  AAAAAAAABDGJAAAA            6     0.0         13.0     0.0           41     0.0  20.0000\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019943,
                    "execution_time": 0.00941,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.004133
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058042,
                    "execution_time": 0.010116,
                    "compile_time": 7.7e-05,
                    "planning_time": 0.039889
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_18\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_18\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ORDER BY \"SPEQLITE_TEMP_TABLE_18\".\"ITEM_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAAAAIBBAAA            1     0.0         11.0     0.0           25     0.0  12.3333\n1   AAAAAAAAABIIAAAA           23     0.0          1.0     0.0           11     0.0  11.6666\n2   AAAAAAAAACFPAAAA           17     0.0         49.0     0.0           38     0.0  34.6666\n3   AAAAAAAAACHABAAA            2     0.0          8.0     0.0           73     0.0  27.6666\n4   AAAAAAAAACMIAAAA           84     0.0         52.0     0.0           59     0.0  65.0000\n5   AAAAAAAAACOKAAAA            1     0.0         28.0     0.0            1     0.0  10.0000\n6   AAAAAAAAAFLEAAAA           68     0.0         43.0     0.0            6     0.0  39.0000\n7   AAAAAAAAAGJDBAAA           52     0.0         47.0     0.0           36     0.0  45.0000\n8   AAAAAAAAAHLGBAAA           21     0.0         74.0     0.0           15     0.0  36.6666\n9   AAAAAAAAAJDGBAAA           64     0.0         53.0     0.0           53     0.0  56.6666\n10  AAAAAAAAAKCHBAAA           16     0.0         65.0     0.0           51     0.0  44.0000\n11  AAAAAAAAALJBBAAA           71     0.0          1.0     0.0           28     0.0  33.3333\n12  AAAAAAAAALNDBAAA           48     0.0          2.0     0.0            7     0.0  19.0000\n13  AAAAAAAAANMNAAAA           47     0.0          8.0     0.0            3     0.0  19.3333\n14  AAAAAAAAAPIHBAAA            4     0.0         17.0     0.0           38     0.0  19.6666\n15  AAAAAAAABALHAAAA           38     NaN          NaN     NaN            5     NaN      NaN\n16  AAAAAAAABBCGAAAA           65     0.0         26.0     0.0           60     0.0  50.3333\n17  AAAAAAAABDGDAAAA            8     0.0         41.0     0.0            5     0.0  18.0000\n18  AAAAAAAABDGJAAAA            6     0.0         13.0     0.0           41     0.0  20.0000\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n where sr_items.item_id=cr_items.item_id\n   and sr_items.item_id=wr_items.item_id \n order by sr_items.item_id\n         ,sr_item_qty\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\" ORDER BY \"SR_ITEMS\".\"ITEM_ID\" NULLS LAST , \"SR_ITEM_QTY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_18\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_18\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ORDER BY \"SPEQLITE_TEMP_TABLE_18\".\"ITEM_ID\" , \"SR_ITEM_QTY\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAAAAIBBAAA            1     0.0         11.0     0.0           25     0.0  12.3333\n1   AAAAAAAAABIIAAAA           23     0.0          1.0     0.0           11     0.0  11.6666\n2   AAAAAAAAACFPAAAA           17     0.0         49.0     0.0           38     0.0  34.6666\n3   AAAAAAAAACHABAAA            2     0.0          8.0     0.0           73     0.0  27.6666\n4   AAAAAAAAACMIAAAA           84     0.0         52.0     0.0           59     0.0  65.0000\n5   AAAAAAAAACOKAAAA            1     0.0         28.0     0.0            1     0.0  10.0000\n6   AAAAAAAAAFLEAAAA           68     0.0         43.0     0.0            6     0.0  39.0000\n7   AAAAAAAAAGJDBAAA           52     0.0         47.0     0.0           36     0.0  45.0000\n8   AAAAAAAAAHLGBAAA           21     0.0         74.0     0.0           15     0.0  36.6666\n9   AAAAAAAAAJDGBAAA           64     0.0         53.0     0.0           53     0.0  56.6666\n10  AAAAAAAAAKCHBAAA           16     0.0         65.0     0.0           51     0.0  44.0000\n11  AAAAAAAAALJBBAAA           71     0.0          1.0     0.0           28     0.0  33.3333\n12  AAAAAAAAALNDBAAA           48     0.0          2.0     0.0            7     0.0  19.0000\n13  AAAAAAAAANMNAAAA           47     0.0          8.0     0.0            3     0.0  19.3333\n14  AAAAAAAAAPIHBAAA            4     0.0         17.0     0.0           38     0.0  19.6666\n15  AAAAAAAABALHAAAA           38     NaN          NaN     NaN            5     NaN      NaN\n16  AAAAAAAABBCGAAAA           65     0.0         26.0     0.0           60     0.0  50.3333\n17  AAAAAAAABDGDAAAA            8     0.0         41.0     0.0            5     0.0  18.0000\n18  AAAAAAAABDGJAAAA            6     0.0         13.0     0.0           41     0.0  20.0000\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020308,
                    "execution_time": 0.009288,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.004562
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056319,
                    "execution_time": 0.009679,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.040105
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" NULLS LAST , \"SR_ITEM_QTY\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_18\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_18\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ORDER BY \"SPEQLITE_TEMP_TABLE_18\".\"ITEM_ID\" NULLS LAST , \"SR_ITEM_QTY\" NULLS LAST"
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAAAAIBBAAA            1     0.0         11.0     0.0           25     0.0  12.3333\n1   AAAAAAAAABIIAAAA           23     0.0          1.0     0.0           11     0.0  11.6666\n2   AAAAAAAAACFPAAAA           17     0.0         49.0     0.0           38     0.0  34.6666\n3   AAAAAAAAACHABAAA            2     0.0          8.0     0.0           73     0.0  27.6666\n4   AAAAAAAAACMIAAAA           84     0.0         52.0     0.0           59     0.0  65.0000\n5   AAAAAAAAACOKAAAA            1     0.0         28.0     0.0            1     0.0  10.0000\n6   AAAAAAAAAFLEAAAA           68     0.0         43.0     0.0            6     0.0  39.0000\n7   AAAAAAAAAGJDBAAA           52     0.0         47.0     0.0           36     0.0  45.0000\n8   AAAAAAAAAHLGBAAA           21     0.0         74.0     0.0           15     0.0  36.6666\n9   AAAAAAAAAJDGBAAA           64     0.0         53.0     0.0           53     0.0  56.6666\n10  AAAAAAAAAKCHBAAA           16     0.0         65.0     0.0           51     0.0  44.0000\n11  AAAAAAAAALJBBAAA           71     0.0          1.0     0.0           28     0.0  33.3333\n12  AAAAAAAAALNDBAAA           48     0.0          2.0     0.0            7     0.0  19.0000\n13  AAAAAAAAANMNAAAA           47     0.0          8.0     0.0            3     0.0  19.3333\n14  AAAAAAAAAPIHBAAA            4     0.0         17.0     0.0           38     0.0  19.6666\n15  AAAAAAAABALHAAAA           38     NaN          NaN     NaN            5     NaN      NaN\n16  AAAAAAAABBCGAAAA           65     0.0         26.0     0.0           60     0.0  50.3333\n17  AAAAAAAABDGDAAAA            8     0.0         41.0     0.0            5     0.0  18.0000\n18  AAAAAAAABDGJAAAA            6     0.0         13.0     0.0           41     0.0  20.0000\n...*/"
    },
    {
        "input": "-- start template query83.tpl query 96 in stream 0\nwith /* TPC-DS query83.tpl 0.96 */ sr_items as\n (select i_item_id item_id,\n        sum(sr_return_quantity) sr_item_qty\n from store_returns,\n      item,\n      date_dim\n where sr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   sr_returned_date_sk   = d_date_sk\n group by i_item_id),\n cr_items as\n (select i_item_id item_id,\n        sum(cr_return_quantity) cr_item_qty\n from catalog_returns,\n      item,\n      date_dim\n where cr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t  where d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   cr_returned_date_sk   = d_date_sk\n group by i_item_id),\n wr_items as\n (select i_item_id item_id,\n        sum(wr_return_quantity) wr_item_qty\n from web_returns,\n      item,\n      date_dim\n where wr_item_sk = i_item_sk\n and   d_date    in \n\t(select d_date\n\tfrom date_dim\n\twhere d_week_seq in \n\t\t(select d_week_seq\n\t\tfrom date_dim\n\t\twhere d_date in ('1998-06-09','1998-08-05','1998-11-11')))\n and   wr_returned_date_sk   = d_date_sk\n group by i_item_id)\n  select  sr_items.item_id\n       ,sr_item_qty\n       ,sr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 sr_dev\n       ,cr_item_qty\n       ,cr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 cr_dev\n       ,wr_item_qty\n       ,wr_item_qty/(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 * 100 wr_dev\n       ,(sr_item_qty+cr_item_qty+wr_item_qty)/3.0 average\n from sr_items\n     ,cr_items\n     ,wr_items\n where sr_items.item_id=cr_items.item_id\n   and sr_items.item_id=wr_items.item_id \n order by sr_items.item_id\n         ,sr_item_qty\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" IN ( '1998-06-09' , '1998-08-05' , '1998-11-11' ) GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" ) AS \"SR_ITEM_QTY\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_RETURNS\".\"SR_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_2\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" ) AS \"CR_ITEM_QTY\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_4\".\"D_WEEK_SEQ\" IS NULL GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WR_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" ) AS \"WR_ITEM_QTY\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_RETURNS\".\"WR_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SR_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SR_ITEMS\".\"SR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"CR_ITEMS\".\"CR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"WR_ITEMS\".\"WR_ITEM_QTY\" / ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SR_ITEMS\".\"SR_ITEM_QTY\" + \"CR_ITEMS\".\"CR_ITEM_QTY\" + \"WR_ITEMS\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SR_ITEMS\" AS \"SR_ITEMS\" JOIN \"CR_ITEMS\" AS \"CR_ITEMS\" ON \"CR_ITEMS\".\"ITEM_ID\" = \"SR_ITEMS\".\"ITEM_ID\" JOIN \"WR_ITEMS\" AS \"WR_ITEMS\" ON \"SR_ITEMS\".\"ITEM_ID\" = \"WR_ITEMS\".\"ITEM_ID\" ORDER BY \"SR_ITEMS\".\"ITEM_ID\" NULLS LAST , \"SR_ITEM_QTY\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_18\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_18\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ORDER BY \"SPEQLITE_TEMP_TABLE_18\".\"ITEM_ID\" , \"SR_ITEM_QTY\" LIMIT 21",
                "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAAAAIBBAAA            1     0.0         11.0     0.0           25     0.0  12.3333\n1   AAAAAAAAABIIAAAA           23     0.0          1.0     0.0           11     0.0  11.6666\n2   AAAAAAAAACFPAAAA           17     0.0         49.0     0.0           38     0.0  34.6666\n3   AAAAAAAAACHABAAA            2     0.0          8.0     0.0           73     0.0  27.6666\n4   AAAAAAAAACMIAAAA           84     0.0         52.0     0.0           59     0.0  65.0000\n5   AAAAAAAAACOKAAAA            1     0.0         28.0     0.0            1     0.0  10.0000\n6   AAAAAAAAAFLEAAAA           68     0.0         43.0     0.0            6     0.0  39.0000\n7   AAAAAAAAAGJDBAAA           52     0.0         47.0     0.0           36     0.0  45.0000\n8   AAAAAAAAAHLGBAAA           21     0.0         74.0     0.0           15     0.0  36.6666\n9   AAAAAAAAAJDGBAAA           64     0.0         53.0     0.0           53     0.0  56.6666\n10  AAAAAAAAAKCHBAAA           16     0.0         65.0     0.0           51     0.0  44.0000\n11  AAAAAAAAALJBBAAA           71     0.0          1.0     0.0           28     0.0  33.3333\n12  AAAAAAAAALNDBAAA           48     0.0          2.0     0.0            7     0.0  19.0000\n13  AAAAAAAAANMNAAAA           47     0.0          8.0     0.0            3     0.0  19.3333\n14  AAAAAAAAAPIHBAAA            4     0.0         17.0     0.0           38     0.0  19.6666\n15  AAAAAAAABALHAAAA           38     NaN          NaN     NaN            5     NaN      NaN\n16  AAAAAAAABBCGAAAA           65     0.0         26.0     0.0           60     0.0  50.3333\n17  AAAAAAAABDGDAAAA            8     0.0         41.0     0.0            5     0.0  18.0000\n18  AAAAAAAABDGJAAAA            6     0.0         13.0     0.0           41     0.0  20.0000\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020288,
                    "execution_time": 0.009497,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.004452
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020915,
                    "execution_time": 0.009947,
                    "compile_time": 7.6e-05,
                    "planning_time": 0.00443
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" / ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 * 100 AS \"WR_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_7\".\"CR_ITEM_QTY\" + \"SPEQLITE_TEMP_TABLE_9\".\"WR_ITEM_QTY\" ) / 3.0 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" NULLS LAST , \"SR_ITEM_QTY\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_18\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_18\".\"SR_ITEM_QTY\" AS \"SR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"SR_DEV\" AS \"SR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"CR_ITEM_QTY\" AS \"CR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"CR_DEV\" AS \"CR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"WR_ITEM_QTY\" AS \"WR_ITEM_QTY\" , \"SPEQLITE_TEMP_TABLE_18\".\"WR_DEV\" AS \"WR_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ORDER BY \"SPEQLITE_TEMP_TABLE_18\".\"ITEM_ID\" NULLS LAST , \"SR_ITEM_QTY\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*             item_id  sr_item_qty  sr_dev  cr_item_qty  cr_dev  wr_item_qty  wr_dev  average\n0   AAAAAAAAAAIBBAAA            1     0.0         11.0     0.0           25     0.0  12.3333\n1   AAAAAAAAABIIAAAA           23     0.0          1.0     0.0           11     0.0  11.6666\n2   AAAAAAAAACFPAAAA           17     0.0         49.0     0.0           38     0.0  34.6666\n3   AAAAAAAAACHABAAA            2     0.0          8.0     0.0           73     0.0  27.6666\n4   AAAAAAAAACMIAAAA           84     0.0         52.0     0.0           59     0.0  65.0000\n5   AAAAAAAAACOKAAAA            1     0.0         28.0     0.0            1     0.0  10.0000\n6   AAAAAAAAAFLEAAAA           68     0.0         43.0     0.0            6     0.0  39.0000\n7   AAAAAAAAAGJDBAAA           52     0.0         47.0     0.0           36     0.0  45.0000\n8   AAAAAAAAAHLGBAAA           21     0.0         74.0     0.0           15     0.0  36.6666\n9   AAAAAAAAAJDGBAAA           64     0.0         53.0     0.0           53     0.0  56.6666\n10  AAAAAAAAAKCHBAAA           16     0.0         65.0     0.0           51     0.0  44.0000\n11  AAAAAAAAALJBBAAA           71     0.0          1.0     0.0           28     0.0  33.3333\n12  AAAAAAAAALNDBAAA           48     0.0          2.0     0.0            7     0.0  19.0000\n13  AAAAAAAAANMNAAAA           47     0.0          8.0     0.0            3     0.0  19.3333\n14  AAAAAAAAAPIHBAAA            4     0.0         17.0     0.0           38     0.0  19.6666\n15  AAAAAAAABALHAAAA           38     NaN          NaN     NaN            5     NaN      NaN\n16  AAAAAAAABBCGAAAA           65     0.0         26.0     0.0           60     0.0  50.3333\n17  AAAAAAAABDGDAAAA            8     0.0         41.0     0.0            5     0.0  18.0000\n18  AAAAAAAABDGJAAAA            6     0.0         13.0     0.0           41     0.0  20.0000\n...*/"
    }
]