[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query57.tpl query 70 in stream 0\nwith /* TPC-DS query57.tpl 0.70 */ v1 as(\n select i_category, i_brand,\n        cc_name,\n        d_year, d_moy,\n        sum(cs_sales_price) as sum_sales,\n        avg(sum(cs_sales_price)) over\n          (partition by i_category, i_brand,\n                     cc_name, d_year) as avg_monthly_sales,\n        rank() over\n          (partition by i_category, i_brand,\n                     cc_name\n           order by d_year, d_moy) as rn\n from item, catalog_sales, date_dim, call_center\n where cs_item_sk = i_item_sk and\n       cs_sold_date_sk = d_date_sk and\n       cc_call_center_sk= cs_call_center_sk and\n       (\n         d_year = 2001 or\n         ( d_year = 2001-1 and d_moy =12) or\n         ( d_year = 2001+1 and d_moy =1)\n       )\n group by i_category, i_brand,\n          cc_name , d_year, d_moy),\n v2 as(\n select v1.cc_name\n        ,v1.d_year, v1.d_moy\n        ,v1.avg_monthly_sales\n        ,v1.sum_sales, v1_lag.sum_sales as psum, v1_lead.sum_sales as nsum\n from v1\n left join v1 as v1_lag on v1.rn = v1_lag.rn + 1\n left join v1 as v1_lead on v1.rn = v1_lead.rn - 1\n where v1.i_category = v1_lag.i_category and\n       v1.i_category = v1_lead.i_category \n/*CURSOR_IDENTIFIER*/)\nselect * from v2;",
        "optimize": [
            "WITH \"V1\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"CATALOG_SALES\".\"CS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"CATALOG_SALES\".\"CS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"CALL_CENTER\".\"CC_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) AS \"AVG_MONTHLY_SALES\" , RANK ( ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"CALL_CENTER\".\"CC_NAME\" ORDER BY \"DATE_DIM\".\"D_YEAR\" NULLS LAST , \"DATE_DIM\".\"D_MOY\" NULLS LAST ) AS \"RN\" FROM \"ITEM\" AS \"ITEM\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND ( \"DATE_DIM\".\"D_MOY\" = 1 OR \"DATE_DIM\".\"D_MOY\" = 12 OR \"DATE_DIM\".\"D_YEAR\" = 2001 ) AND ( \"DATE_DIM\".\"D_MOY\" = 1 OR \"DATE_DIM\".\"D_YEAR\" = 2000 OR \"DATE_DIM\".\"D_YEAR\" = 2001 ) AND ( \"DATE_DIM\".\"D_MOY\" = 12 OR \"DATE_DIM\".\"D_YEAR\" = 2001 OR \"DATE_DIM\".\"D_YEAR\" = 2002 ) AND ( \"DATE_DIM\".\"D_YEAR\" = 2000 OR \"DATE_DIM\".\"D_YEAR\" = 2001 OR \"DATE_DIM\".\"D_YEAR\" = 2002 ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"CALL_CENTER\".\"CC_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"V1\".\"CC_NAME\" AS \"CC_NAME\" , \"V1\".\"D_YEAR\" AS \"D_YEAR\" , \"V1\".\"D_MOY\" AS \"D_MOY\" , \"V1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" , \"V1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"V1_LAG\".\"SUM_SALES\" AS \"PSUM\" , \"V1_LEAD\".\"SUM_SALES\" AS \"NSUM\" FROM \"V1\" AS \"V1\" LEFT JOIN \"V1\" AS \"V1_LAG\" ON \"V1\".\"RN\" = \"V1_LAG\".\"RN\" + 1 LEFT JOIN \"V1\" AS \"V1_LEAD\" ON \"V1\".\"RN\" = \"V1_LEAD\".\"RN\" - 1 WHERE \"V1\".\"I_CATEGORY\" = \"V1_LAG\".\"I_CATEGORY\" AND \"V1\".\"I_CATEGORY\" = \"V1_LEAD\".\"I_CATEGORY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"CATALOG_SALES\".\"CS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"CATALOG_SALES\".\"CS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"CALL_CENTER\".\"CC_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) AS \"AVG_MONTHLY_SALES\" , RANK ( ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"CALL_CENTER\".\"CC_NAME\" ORDER BY \"DATE_DIM\".\"D_YEAR\" NULLS LAST , \"DATE_DIM\".\"D_MOY\" NULLS LAST ) AS \"RN\" FROM \"ITEM\" AS \"ITEM\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND ( \"DATE_DIM\".\"D_MOY\" = 1 OR \"DATE_DIM\".\"D_MOY\" = 12 OR \"DATE_DIM\".\"D_YEAR\" = 2001 ) AND ( \"DATE_DIM\".\"D_MOY\" = 1 OR \"DATE_DIM\".\"D_YEAR\" = 2000 OR \"DATE_DIM\".\"D_YEAR\" = 2001 ) AND ( \"DATE_DIM\".\"D_MOY\" = 12 OR \"DATE_DIM\".\"D_YEAR\" = 2001 OR \"DATE_DIM\".\"D_YEAR\" = 2002 ) AND ( \"DATE_DIM\".\"D_YEAR\" = 2000 OR \"DATE_DIM\".\"D_YEAR\" = 2001 OR \"DATE_DIM\".\"D_YEAR\" = 2002 ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"CALL_CENTER\".\"CC_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.675037,
                    "execution_time": 0.284016,
                    "compile_time": 0.062418,
                    "planning_time": 0.061355,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.45465,
                    "execution_time": 0.793104,
                    "compile_time": 3.321262,
                    "planning_time": 0.060245,
                    "create_size": 1280
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"V1_LAG\".\"SUM_SALES\" AS \"PSUM\" , \"V1_LEAD\".\"SUM_SALES\" AS \"NSUM\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"V1_LAG\" ON \"SPEQLITE_TEMP_TABLE_1\".\"RN\" = \"V1_LAG\".\"RN\" + 1 LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"V1_LEAD\" ON \"SPEQLITE_TEMP_TABLE_1\".\"RN\" = \"V1_LEAD\".\"RN\" - 1 WHERE \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" = \"V1_LAG\".\"I_CATEGORY\" AND \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" = \"V1_LEAD\".\"I_CATEGORY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"V1_LAG\".\"SUM_SALES\" AS \"PSUM\" , \"V1_LEAD\".\"SUM_SALES\" AS \"NSUM\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"V1_LAG\" ON \"SPEQLITE_TEMP_TABLE_1\".\"RN\" = \"V1_LAG\".\"RN\" + 1 LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"V1_LEAD\" ON \"SPEQLITE_TEMP_TABLE_1\".\"RN\" = \"V1_LEAD\".\"RN\" - 1 WHERE \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" = \"V1_LAG\".\"I_CATEGORY\" AND \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" = \"V1_LEAD\".\"I_CATEGORY\" LIMIT 21",
                "preview": "\n/*              cc_name  d_year  d_moy  avg_monthly_sales  sum_sales     psum    nsum\n0     Hawaii/Alaska_1    2001      3              71.64      17.33  2729.52  135.41\n1       Hawaii/Alaska    2001      9              46.33      56.61  2729.52  135.41\n2     North Midwest_1    2001      4              69.44      28.89  2729.52  135.41\n3          NY Metro_1    2001     11              52.69      80.24  2729.52  135.41\n4   Pacific Northwest    2001     10              90.83     133.72  2729.52  135.41\n5     North Midwest_1    2001      3              46.78       6.10  2729.52  135.41\n6     Hawaii/Alaska_1    2001     12              14.17       9.66  2729.52  135.41\n7          California    2001      4             113.43      98.17  2729.52  135.41\n8   Pacific Northwest    2001      8              72.23      60.83  2729.52  135.41\n9          NY Metro_1    2001      8              67.54      12.03  2729.52  135.41\n10         NY Metro_1    2001      4              71.64     172.24  2729.52  135.41\n11     Mid Atlantic_1    2001      1              58.75      21.13  2729.52  135.41\n12       Mid Atlantic    2001      4             140.57      24.12  2729.52  135.41\n13      Hawaii/Alaska    2001      1               0.71       0.71  2729.52  135.41\n14  Pacific Northwest    2001      4             134.88      42.57  2729.52  135.41\n15         NY Metro_1    2001     10              81.28      81.28  2729.52  135.41\n16     Mid Atlantic_1    2001      3              44.57      63.36  2729.52  135.41\n17      Hawaii/Alaska    2001     11              37.72      63.03  2729.52  135.41\n18    North Midwest_1    2001      2              26.28      11.18  2729.52  135.41\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 5.275964,
                    "execution_time": 5.251763,
                    "compile_time": 0.000193,
                    "planning_time": 0.01148
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 5.244638,
                    "execution_time": 5.180854,
                    "compile_time": 0.000202,
                    "planning_time": 0.047834
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"V1_LAG\".\"SUM_SALES\" AS \"PSUM\" , \"V1_LEAD\".\"SUM_SALES\" AS \"NSUM\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"V1_LAG\" ON \"SPEQLITE_TEMP_TABLE_1\".\"RN\" = \"V1_LAG\".\"RN\" + 1 LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"V1_LEAD\" ON \"SPEQLITE_TEMP_TABLE_1\".\"RN\" = \"V1_LEAD\".\"RN\" - 1 WHERE \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" = \"V1_LAG\".\"I_CATEGORY\" AND \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" = \"V1_LEAD\".\"I_CATEGORY\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"V1_LAG\".\"SUM_SALES\" AS \"PSUM\" , \"V1_LEAD\".\"SUM_SALES\" AS \"NSUM\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"V1_LAG\" ON \"SPEQLITE_TEMP_TABLE_1\".\"RN\" = \"V1_LAG\".\"RN\" + 1 LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"V1_LEAD\" ON \"SPEQLITE_TEMP_TABLE_1\".\"RN\" = \"V1_LEAD\".\"RN\" - 1 WHERE \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" = \"V1_LAG\".\"I_CATEGORY\" AND \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" = \"V1_LEAD\".\"I_CATEGORY\""
            }
        ],
        "preview": "\n/*              cc_name  d_year  d_moy  avg_monthly_sales  sum_sales     psum    nsum\n0     Hawaii/Alaska_1    2001      3              71.64      17.33  2729.52  135.41\n1       Hawaii/Alaska    2001      9              46.33      56.61  2729.52  135.41\n2     North Midwest_1    2001      4              69.44      28.89  2729.52  135.41\n3          NY Metro_1    2001     11              52.69      80.24  2729.52  135.41\n4   Pacific Northwest    2001     10              90.83     133.72  2729.52  135.41\n5     North Midwest_1    2001      3              46.78       6.10  2729.52  135.41\n6     Hawaii/Alaska_1    2001     12              14.17       9.66  2729.52  135.41\n7          California    2001      4             113.43      98.17  2729.52  135.41\n8   Pacific Northwest    2001      8              72.23      60.83  2729.52  135.41\n9          NY Metro_1    2001      8              67.54      12.03  2729.52  135.41\n10         NY Metro_1    2001      4              71.64     172.24  2729.52  135.41\n11     Mid Atlantic_1    2001      1              58.75      21.13  2729.52  135.41\n12       Mid Atlantic    2001      4             140.57      24.12  2729.52  135.41\n13      Hawaii/Alaska    2001      1               0.71       0.71  2729.52  135.41\n14  Pacific Northwest    2001      4             134.88      42.57  2729.52  135.41\n15         NY Metro_1    2001     10              81.28      81.28  2729.52  135.41\n16     Mid Atlantic_1    2001      3              44.57      63.36  2729.52  135.41\n17      Hawaii/Alaska    2001     11              37.72      63.03  2729.52  135.41\n18    North Midwest_1    2001      2              26.28      11.18  2729.52  135.41\n...*/"
    },
    {
        "input": "-- start template query57.tpl query 70 in stream 0\nwith /* TPC-DS query57.tpl 0.70 */ v1 as(\n select i_category, i_brand,\n        cc_name,\n        d_year, d_moy,\n        sum(cs_sales_price) as sum_sales,\n        avg(sum(cs_sales_price)) over\n          (partition by i_category, i_brand,\n                     cc_name, d_year) as avg_monthly_sales,\n        rank() over\n          (partition by i_category, i_brand,\n                     cc_name\n           order by d_year, d_moy) as rn\n from item, catalog_sales, date_dim, call_center\n where cs_item_sk = i_item_sk and\n       cs_sold_date_sk = d_date_sk and\n       cc_call_center_sk = cs_call_center_sk and\n       (\n         d_year = 2001 or\n         ( d_year = 2000 and d_moy = 12) or\n         ( d_year = 2002 and d_moy = 1)\n       )\n group by i_category, i_brand,\n          cc_name, d_year, d_moy),\n v2 as(\n select v1.cc_name,\n        v1.d_year, v1.d_moy,\n        v1.avg_monthly_sales,\n        v1.sum_sales,\n        lag(v1.sum_sales) over (partition by v1.i_category, v1.i_brand, v1.cc_name order by v1.d_year, v1.d_moy) as psum,\n        lead(v1.sum_sales) over (partition by v1.i_category, v1.i_brand, v1.cc_name order by v1.d_year, v1.d_moy) as nsum\n from v1\n)\nselect * from v2\nwhere /*CURSOR_IDENTIFIER*/ 1 = 1",
        "optimize": [
            "WITH \"V1\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"CATALOG_SALES\".\"CS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"CATALOG_SALES\".\"CS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"CALL_CENTER\".\"CC_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND ( \"DATE_DIM\".\"D_MOY\" = 1 OR \"DATE_DIM\".\"D_MOY\" = 12 OR \"DATE_DIM\".\"D_YEAR\" = 2001 ) AND ( \"DATE_DIM\".\"D_MOY\" = 1 OR \"DATE_DIM\".\"D_YEAR\" = 2000 OR \"DATE_DIM\".\"D_YEAR\" = 2001 ) AND ( \"DATE_DIM\".\"D_MOY\" = 12 OR \"DATE_DIM\".\"D_YEAR\" = 2001 OR \"DATE_DIM\".\"D_YEAR\" = 2002 ) AND ( \"DATE_DIM\".\"D_YEAR\" = 2000 OR \"DATE_DIM\".\"D_YEAR\" = 2001 OR \"DATE_DIM\".\"D_YEAR\" = 2002 ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"CALL_CENTER\".\"CC_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_MOY\" ) , \"V2\" AS ( SELECT \"V1\".\"CC_NAME\" AS \"CC_NAME\" , \"V1\".\"D_YEAR\" AS \"D_YEAR\" , \"V1\".\"D_MOY\" AS \"D_MOY\" , \"V1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" , \"V1\".\"SUM_SALES\" AS \"SUM_SALES\" , LAG ( \"V1\".\"SUM_SALES\" ) OVER ( PARTITION BY \"V1\".\"I_CATEGORY\" , \"V1\".\"I_BRAND\" , \"V1\".\"CC_NAME\" ORDER BY \"V1\".\"D_YEAR\" NULLS LAST , \"V1\".\"D_MOY\" NULLS LAST ) AS \"PSUM\" , LEAD ( \"V1\".\"SUM_SALES\" ) OVER ( PARTITION BY \"V1\".\"I_CATEGORY\" , \"V1\".\"I_BRAND\" , \"V1\".\"CC_NAME\" ORDER BY \"V1\".\"D_YEAR\" NULLS LAST , \"V1\".\"D_MOY\" NULLS LAST ) AS \"NSUM\" FROM \"V1\" AS \"V1\" ) SELECT \"V2\".\"CC_NAME\" AS \"CC_NAME\" , \"V2\".\"D_YEAR\" AS \"D_YEAR\" , \"V2\".\"D_MOY\" AS \"D_MOY\" , \"V2\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" , \"V2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"V2\".\"PSUM\" AS \"PSUM\" , \"V2\".\"NSUM\" AS \"NSUM\" FROM \"V2\" AS \"V2\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"CATALOG_SALES\".\"CS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"CATALOG_SALES\".\"CS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"CALL_CENTER\".\"CC_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND ( \"DATE_DIM\".\"D_MOY\" = 1 OR \"DATE_DIM\".\"D_MOY\" = 12 OR \"DATE_DIM\".\"D_YEAR\" = 2001 ) AND ( \"DATE_DIM\".\"D_MOY\" = 1 OR \"DATE_DIM\".\"D_YEAR\" = 2000 OR \"DATE_DIM\".\"D_YEAR\" = 2001 ) AND ( \"DATE_DIM\".\"D_MOY\" = 12 OR \"DATE_DIM\".\"D_YEAR\" = 2001 OR \"DATE_DIM\".\"D_YEAR\" = 2002 ) AND ( \"DATE_DIM\".\"D_YEAR\" = 2000 OR \"DATE_DIM\".\"D_YEAR\" = 2001 OR \"DATE_DIM\".\"D_YEAR\" = 2002 ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"CALL_CENTER\".\"CC_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_MOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.606339,
                    "execution_time": 0.268808,
                    "compile_time": 0.000537,
                    "planning_time": 0.060403,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.839337,
                    "execution_time": 0.272849,
                    "compile_time": 0.130156,
                    "planning_time": 0.152713,
                    "create_size": 1280
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , LAG ( \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"CC_NAME\" ORDER BY \"SPEQLITE_TEMP_TABLE_2\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" NULLS LAST ) AS \"PSUM\" , LEAD ( \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"CC_NAME\" ORDER BY \"SPEQLITE_TEMP_TABLE_2\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" NULLS LAST ) AS \"NSUM\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.442449,
                    "execution_time": 0.09601,
                    "compile_time": 0.000398,
                    "planning_time": 0.005733,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.527751,
                    "execution_time": 0.099463,
                    "compile_time": 0.000378,
                    "planning_time": 0.083017,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"PSUM\" AS \"PSUM\" , \"SPEQLITE_TEMP_TABLE_3\".\"NSUM\" AS \"NSUM\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*            cc_name  d_year  d_moy  avg_monthly_sales  sum_sales    psum    nsum\n0        NY Metro_1    2001     12             300.27     595.70  391.40   19.49\n1        NY Metro_1    2002      1              19.49      19.49  595.70     NaN\n2      California_1    2000     12             681.85     681.85     NaN   67.38\n3      California_1    2001      1             167.15      67.38  681.85   96.51\n4      California_1    2001      2             167.15      96.51   67.38  166.47\n5      California_1    2001      3             167.15     166.47   96.51    5.04\n6      California_1    2001      4             167.15       5.04  166.47   23.88\n7      California_1    2001      5             167.15      23.88    5.04  157.31\n8      California_1    2001      6             167.15     157.31   23.88  320.63\n9      California_1    2001      7             167.15     320.63  157.31  241.20\n10     California_1    2001      8             167.15     241.20  320.63  139.15\n11     California_1    2001      9             167.15     139.15  241.20  321.57\n12     California_1    2001     10             167.15     321.57  139.15   91.43\n13     California_1    2001     11             167.15      91.43  321.57  375.27\n14     California_1    2001     12             167.15     375.27   91.43  194.09\n15     California_1    2002      1             194.09     194.09  375.27     NaN\n16  Hawaii/Alaska_1    2000     12             680.10     680.10     NaN  118.42\n17  Hawaii/Alaska_1    2001      1             230.22     118.42  680.10   38.08\n18  Hawaii/Alaska_1    2001      2             230.22      38.08  118.42  174.75\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017926,
                    "execution_time": 0.007589,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004064
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056913,
                    "execution_time": 0.008211,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.039378
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"PSUM\" AS \"PSUM\" , \"SPEQLITE_TEMP_TABLE_3\".\"NSUM\" AS \"NSUM\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"PSUM\" AS \"PSUM\" , \"SPEQLITE_TEMP_TABLE_3\".\"NSUM\" AS \"NSUM\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*            cc_name  d_year  d_moy  avg_monthly_sales  sum_sales    psum    nsum\n0        NY Metro_1    2001     12             300.27     595.70  391.40   19.49\n1        NY Metro_1    2002      1              19.49      19.49  595.70     NaN\n2      California_1    2000     12             681.85     681.85     NaN   67.38\n3      California_1    2001      1             167.15      67.38  681.85   96.51\n4      California_1    2001      2             167.15      96.51   67.38  166.47\n5      California_1    2001      3             167.15     166.47   96.51    5.04\n6      California_1    2001      4             167.15       5.04  166.47   23.88\n7      California_1    2001      5             167.15      23.88    5.04  157.31\n8      California_1    2001      6             167.15     157.31   23.88  320.63\n9      California_1    2001      7             167.15     320.63  157.31  241.20\n10     California_1    2001      8             167.15     241.20  320.63  139.15\n11     California_1    2001      9             167.15     139.15  241.20  321.57\n12     California_1    2001     10             167.15     321.57  139.15   91.43\n13     California_1    2001     11             167.15      91.43  321.57  375.27\n14     California_1    2001     12             167.15     375.27   91.43  194.09\n15     California_1    2002      1             194.09     194.09  375.27     NaN\n16  Hawaii/Alaska_1    2000     12             680.10     680.10     NaN  118.42\n17  Hawaii/Alaska_1    2001      1             230.22     118.42  680.10   38.08\n18  Hawaii/Alaska_1    2001      2             230.22      38.08  118.42  174.75\n...*/"
    },
    {
        "input": "with /* TPC-DS query57.tpl 0.70 */ v1 as(\n select i_category, i_brand,\n        cc_name,\n        d_year, d_moy,\n        sum(cs_sales_price) as sum_sales,\n        avg(sum(cs_sales_price)) over\n          (partition by i_category, i_brand,\n                     cc_name, d_year) as avg_monthly_sales,\n        rank() over\n          (partition by i_category, i_brand,\n                     cc_name\n           order by d_year, d_moy) as rn\n from item, catalog_sales, date_dim, call_center\n where cs_item_sk = i_item_sk and\n       cs_sold_date_sk = d_date_sk and\n       cc_call_center_sk = cs_call_center_sk and\n       (\n         d_year = 2001 or\n         ( d_year = 2000 and d_moy = 12) or\n         ( d_year = 2002 and d_moy = 1)\n       )\n group by i_category, i_brand,\n          cc_name , d_year, d_moy),\n v2 as(\n select v1.cc_name,\n        v1.d_year, v1.d_moy,\n        v1.avg_monthly_sales,\n        v1.sum_sales, v1_lag.sum_sales as psum, v1_lead.sum_sales as nsum\n from v1\n left join v1 as v1_lag\n on v1.i_category = v1_lag.i_category\n and v1.i_brand = v1_lag.i_brand\n and v1.d_year = v1_lag.d_year\n and v1.d_moy = v1_lag.d_moy + 1\n left join v1 as v1_lead\n on v1.i_category = v1_lead.i_category\n and v1.i_brand = v1_lead.i_brand\n and v1.d_year = v1_lead.d_year\n and v1.d_moy = v1_lead.d_moy - 1\n/*CURSOR_IDENTIFIER*/\n)\nselect *\nfrom v2\nwhere (psum is null or sum_sales > psum)\nand (nsum is null or sum_sales > nsum);",
        "optimize": [
            "WITH \"V1\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , SUM ( \"CATALOG_SALES\".\"CS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"CATALOG_SALES\".\"CS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"CALL_CENTER\".\"CC_NAME\" , \"DATE_DIM\".\"D_YEAR\" ) AS \"AVG_MONTHLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND ( \"DATE_DIM\".\"D_MOY\" = 1 OR \"DATE_DIM\".\"D_MOY\" = 12 OR \"DATE_DIM\".\"D_YEAR\" = 2001 ) AND ( \"DATE_DIM\".\"D_MOY\" = 1 OR \"DATE_DIM\".\"D_YEAR\" = 2000 OR \"DATE_DIM\".\"D_YEAR\" = 2001 ) AND ( \"DATE_DIM\".\"D_MOY\" = 12 OR \"DATE_DIM\".\"D_YEAR\" = 2001 OR \"DATE_DIM\".\"D_YEAR\" = 2002 ) AND ( \"DATE_DIM\".\"D_YEAR\" = 2000 OR \"DATE_DIM\".\"D_YEAR\" = 2001 OR \"DATE_DIM\".\"D_YEAR\" = 2002 ) GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_BRAND\" , \"CALL_CENTER\".\"CC_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_MOY\" ) SELECT \"V1\".\"CC_NAME\" AS \"CC_NAME\" , \"V1\".\"D_YEAR\" AS \"D_YEAR\" , \"V1\".\"D_MOY\" AS \"D_MOY\" , \"V1\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" , \"V1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"V1_LAG\".\"SUM_SALES\" AS \"PSUM\" , \"V1_LEAD\".\"SUM_SALES\" AS \"NSUM\" FROM \"V1\" AS \"V1\" LEFT JOIN \"V1\" AS \"V1_LAG\" ON \"V1\".\"D_MOY\" = \"V1_LAG\".\"D_MOY\" + 1 AND \"V1\".\"D_YEAR\" = \"V1_LAG\".\"D_YEAR\" AND \"V1\".\"I_BRAND\" = \"V1_LAG\".\"I_BRAND\" AND \"V1\".\"I_CATEGORY\" = \"V1_LAG\".\"I_CATEGORY\" LEFT JOIN \"V1\" AS \"V1_LEAD\" ON \"V1\".\"D_MOY\" = \"V1_LEAD\".\"D_MOY\" - 1 AND \"V1\".\"D_YEAR\" = \"V1_LEAD\".\"D_YEAR\" AND \"V1\".\"I_BRAND\" = \"V1_LEAD\".\"I_BRAND\" AND \"V1\".\"I_CATEGORY\" = \"V1_LEAD\".\"I_CATEGORY\" WHERE ( \"V1\".\"SUM_SALES\" > \"V1_LAG\".\"SUM_SALES\" OR \"V1_LAG\".\"SUM_SALES\" IS NULL ) AND ( \"V1\".\"SUM_SALES\" > \"V1_LEAD\".\"SUM_SALES\" OR \"V1_LEAD\".\"SUM_SALES\" IS NULL )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"V1_LAG\".\"SUM_SALES\" AS \"PSUM\" , \"V1_LEAD\".\"SUM_SALES\" AS \"NSUM\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"V1_LAG\" ON \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" = \"V1_LAG\".\"D_MOY\" + 1 AND \"SPEQLITE_TEMP_TABLE_2\".\"D_YEAR\" = \"V1_LAG\".\"D_YEAR\" AND \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" = \"V1_LAG\".\"I_BRAND\" AND \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" = \"V1_LAG\".\"I_CATEGORY\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"V1_LEAD\" ON \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" = \"V1_LEAD\".\"D_MOY\" - 1 AND \"SPEQLITE_TEMP_TABLE_2\".\"D_YEAR\" = \"V1_LEAD\".\"D_YEAR\" AND \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" = \"V1_LEAD\".\"I_BRAND\" AND \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" = \"V1_LEAD\".\"I_CATEGORY\" WHERE ( \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" > \"V1_LAG\".\"SUM_SALES\" OR \"V1_LAG\".\"SUM_SALES\" IS NULL ) AND ( \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" > \"V1_LEAD\".\"SUM_SALES\" OR \"V1_LEAD\".\"SUM_SALES\" IS NULL )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.212769,
                    "execution_time": 0.551325,
                    "compile_time": 0.000535,
                    "planning_time": 0.01414,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.301003,
                    "execution_time": 0.565201,
                    "compile_time": 0.00056,
                    "planning_time": 0.072076,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"PSUM\" AS \"PSUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"NSUM\" AS \"NSUM\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*       cc_name  d_year  d_moy  avg_monthly_sales  sum_sales    psum    nsum\n0   California    2001      4            1021.87     462.04  402.22  400.13\n1   California    2001      4            1021.87     462.04  402.22  214.26\n2   California    2001      4            1021.87     462.04  402.22  294.44\n3   California    2001      4            1021.87     462.04  402.22  340.34\n4   California    2001      4            1021.87     462.04  411.62  159.20\n5   California    2001      4            1021.87     462.04  411.62  397.90\n6   California    2001      4            1021.87     462.04  411.62  400.13\n7   California    2001      4            1021.87     462.04  411.62  214.26\n8   California    2001      4            1021.87     462.04  411.62  294.44\n9   California    2001      4            1021.87     462.04  411.62  340.34\n10  California    2001      6            1021.87     635.85  214.26  321.41\n11  California    2001      6            1021.87     635.85  214.26  395.45\n12  California    2001      6            1021.87     635.85  214.26  489.67\n13  California    2001      6            1021.87     635.85  214.26  606.84\n14  California    2001      6            1021.87     635.85  214.26  609.82\n15  California    2001      6            1021.87     635.85  214.26  365.10\n16  California    2001      6            1021.87     635.85  214.26  531.58\n17  California    2001      6            1021.87     635.85  214.26  300.63\n18  California    2001      6            1021.87     635.85  159.20  321.41\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018086,
                    "execution_time": 0.007706,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.004038
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057791,
                    "execution_time": 0.008395,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.039819
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"V1_LAG\".\"SUM_SALES\" AS \"PSUM\" , \"V1_LEAD\".\"SUM_SALES\" AS \"NSUM\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"V1_LAG\" ON \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" = \"V1_LAG\".\"D_MOY\" + 1 AND \"SPEQLITE_TEMP_TABLE_2\".\"D_YEAR\" = \"V1_LAG\".\"D_YEAR\" AND \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" = \"V1_LAG\".\"I_BRAND\" AND \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" = \"V1_LAG\".\"I_CATEGORY\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"V1_LEAD\" ON \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" = \"V1_LEAD\".\"D_MOY\" - 1 AND \"SPEQLITE_TEMP_TABLE_2\".\"D_YEAR\" = \"V1_LEAD\".\"D_YEAR\" AND \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" = \"V1_LEAD\".\"I_BRAND\" AND \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" = \"V1_LEAD\".\"I_CATEGORY\" WHERE ( \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" > \"V1_LAG\".\"SUM_SALES\" OR \"V1_LAG\".\"SUM_SALES\" IS NULL ) AND ( \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" > \"V1_LEAD\".\"SUM_SALES\" OR \"V1_LEAD\".\"SUM_SALES\" IS NULL )",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_MONTHLY_SALES\" AS \"AVG_MONTHLY_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"PSUM\" AS \"PSUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"NSUM\" AS \"NSUM\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*       cc_name  d_year  d_moy  avg_monthly_sales  sum_sales    psum    nsum\n0   California    2001      4            1021.87     462.04  402.22  400.13\n1   California    2001      4            1021.87     462.04  402.22  214.26\n2   California    2001      4            1021.87     462.04  402.22  294.44\n3   California    2001      4            1021.87     462.04  402.22  340.34\n4   California    2001      4            1021.87     462.04  411.62  159.20\n5   California    2001      4            1021.87     462.04  411.62  397.90\n6   California    2001      4            1021.87     462.04  411.62  400.13\n7   California    2001      4            1021.87     462.04  411.62  214.26\n8   California    2001      4            1021.87     462.04  411.62  294.44\n9   California    2001      4            1021.87     462.04  411.62  340.34\n10  California    2001      6            1021.87     635.85  214.26  321.41\n11  California    2001      6            1021.87     635.85  214.26  395.45\n12  California    2001      6            1021.87     635.85  214.26  489.67\n13  California    2001      6            1021.87     635.85  214.26  606.84\n14  California    2001      6            1021.87     635.85  214.26  609.82\n15  California    2001      6            1021.87     635.85  214.26  365.10\n16  California    2001      6            1021.87     635.85  214.26  531.58\n17  California    2001      6            1021.87     635.85  214.26  300.63\n18  California    2001      6            1021.87     635.85  159.20  321.41\n...*/"
    },
    {
        "input": "-- start template query57.tpl query 70 in stream 0\nwith /* TPC-DS query57.tpl 0.70 */ v1 as(\n select i_category, i_brand,\n        cc_name,\n        d_year, d_moy,\n        sum(cs_sales_price) as sum_sales,\n        avg(sum(cs_sales_price)) over\n          (partition by i_category, i_brand,\n                     cc_name, d_year) as avg_monthly_sales,\n        rank() over\n          (partition by i_category, i_brand,\n                     cc_name\n           order by d_year, d_moy) as rn\n from item, catalog_sales, date_dim, call_center\n where cs_item_sk = i_item_sk and\n       cs_sold_date_sk = d_date_sk and\n       cc_call_center_sk= cs_call_center_sk and\n       (\n         d_year = 2001 or\n         ( d_year = 2001-1 and d_moy =12) or\n         ( d_year = 2001+1 and d_moy =1)\n       )\n group by i_category, i_brand,\n          cc_name , d_year, d_moy),\n v2 as(\n select v1.cc_name\n        ,v1.d_year, v1.d_moy\n        ,v1.avg_monthly_sales\n        ,v1.sum_sales, v1_lag.sum_sales as psum, v1_lead.sum_sales as nsum\n from v1, v1 as v1_lag, v1 as v1_lead\n where v1.i_category = v1_lag.i_category and\n       v1.i_category = v1_lead.i_category and\n       v1.i_brand = v1_lag.i_brand and\n       v1.i_brand = v1_lead.i_brand and\n       v1.cc_name = v1_lag.cc_name and\n       v1.cc_name = v1_lead.cc_name and\n       v1.d_year = v1_lag.d_year + 1 and\n       v1.d_year = v1_lead.d_year - 1\n/*CURSOR_IDENTIFIER*/\n)\nselect * from v2;",
        "optimize": null,
        "create": null,
        "query": [
            {
                "query": "WITH V1 AS ( SELECT I_CATEGORY , I_BRAND , CC_NAME , D_YEAR , D_MOY , SUM ( CS_SALES_PRICE ) AS SUM_SALES , AVG ( SUM ( CS_SALES_PRICE ) ) OVER ( PARTITION BY I_CATEGORY , I_BRAND , CC_NAME , D_YEAR ) AS AVG_MONTHLY_SALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY , I_BRAND , CC_NAME ORDER BY D_YEAR NULLS FIRST , D_MOY NULLS FIRST ) AS RN FROM ITEM , CATALOG_SALES , DATE_DIM , CALL_CENTER WHERE CS_ITEM_SK = I_ITEM_SK AND CS_SOLD_DATE_SK = D_DATE_SK AND CC_CALL_CENTER_SK = CS_CALL_CENTER_SK AND ( D_YEAR = 2001 OR ( D_YEAR = 2001 - 1 AND D_MOY = 12 ) OR ( D_YEAR = 2001 + 1 AND D_MOY = 1 ) ) GROUP BY I_CATEGORY , I_BRAND , CC_NAME , D_YEAR , D_MOY ) , V2 AS ( SELECT V1.CC_NAME , V1.D_YEAR , V1.D_MOY , V1.AVG_MONTHLY_SALES , V1.SUM_SALES , V1_LAG.SUM_SALES AS PSUM , V1_LEAD.SUM_SALES AS NSUM FROM V1 , V1 AS V1_LAG , V1 AS V1_LEAD WHERE V1.I_CATEGORY = V1_LAG.I_CATEGORY AND V1.I_CATEGORY = V1_LEAD.I_CATEGORY AND V1.I_BRAND = V1_LAG.I_BRAND AND V1.I_BRAND = V1_LEAD.I_BRAND AND V1.CC_NAME = V1_LAG.CC_NAME AND V1.CC_NAME = V1_LEAD.CC_NAME AND V1.D_YEAR = V1_LAG.D_YEAR + 1 AND V1.D_YEAR = V1_LEAD.D_YEAR - 1 ) SELECT * FROM V2 LIMIT 21",
                "preview": "\n/*         cc_name  d_year  d_moy  avg_monthly_sales  sum_sales     psum    nsum\n0   California_1    2001      1             928.86     729.99  2144.85  508.72\n1   California_1    2001      3             928.86     378.66  2144.85  508.72\n2   California_1    2001      5             928.86     486.53  2144.85  508.72\n3   California_1    2001      7             928.86     767.81  2144.85  508.72\n4   California_1    2001      8             928.86    1225.03  2144.85  508.72\n5   California_1    2001      6             928.86     399.48  2144.85  508.72\n6   California_1    2001      2             928.86     157.57  2144.85  508.72\n7   California_1    2001      9             928.86    1314.33  2144.85  508.72\n8   California_1    2001     10             928.86    1147.64  2144.85  508.72\n9   California_1    2001     11             928.86    2399.59  2144.85  508.72\n10  California_1    2001     12             928.86    1761.97  2144.85  508.72\n11  California_1    2001      4             928.86     377.77  2144.85  508.72\n12  Mid Atlantic    2001      4             893.45     534.74  1949.11  577.37\n13  Mid Atlantic    2001      3             893.45     667.65  1949.11  577.37\n14  Mid Atlantic    2001      8             893.45    1808.16  1949.11  577.37\n15  Mid Atlantic    2001      1             893.45     398.93  1949.11  577.37\n16  Mid Atlantic    2001     11             893.45    2108.28  1949.11  577.37\n17  Mid Atlantic    2001      7             893.45     290.21  1949.11  577.37\n18  Mid Atlantic    2001      6             893.45     175.99  1949.11  577.37\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.281707,
                    "execution_time": 1.834773,
                    "compile_time": 0.053382,
                    "planning_time": 1.286026
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 8.846119,
                    "execution_time": 1.833111,
                    "compile_time": 6.529757,
                    "planning_time": 4.610533
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*         cc_name  d_year  d_moy  avg_monthly_sales  sum_sales     psum    nsum\n0   California_1    2001      1             928.86     729.99  2144.85  508.72\n1   California_1    2001      3             928.86     378.66  2144.85  508.72\n2   California_1    2001      5             928.86     486.53  2144.85  508.72\n3   California_1    2001      7             928.86     767.81  2144.85  508.72\n4   California_1    2001      8             928.86    1225.03  2144.85  508.72\n5   California_1    2001      6             928.86     399.48  2144.85  508.72\n6   California_1    2001      2             928.86     157.57  2144.85  508.72\n7   California_1    2001      9             928.86    1314.33  2144.85  508.72\n8   California_1    2001     10             928.86    1147.64  2144.85  508.72\n9   California_1    2001     11             928.86    2399.59  2144.85  508.72\n10  California_1    2001     12             928.86    1761.97  2144.85  508.72\n11  California_1    2001      4             928.86     377.77  2144.85  508.72\n12  Mid Atlantic    2001      4             893.45     534.74  1949.11  577.37\n13  Mid Atlantic    2001      3             893.45     667.65  1949.11  577.37\n14  Mid Atlantic    2001      8             893.45    1808.16  1949.11  577.37\n15  Mid Atlantic    2001      1             893.45     398.93  1949.11  577.37\n16  Mid Atlantic    2001     11             893.45    2108.28  1949.11  577.37\n17  Mid Atlantic    2001      7             893.45     290.21  1949.11  577.37\n18  Mid Atlantic    2001      6             893.45     175.99  1949.11  577.37\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query57.tpl query 70 in stream 0\nwith /* TPC-DS query57.tpl 0.70 */ v1 as(\n select i_category, i_brand,\n        cc_name,\n        d_year, d_moy,\n        sum(cs_sales_price) sum_sales,\n        avg(sum(cs_sales_price)) over\n          (partition by i_category, i_brand,\n                     cc_name, d_year)\n          avg_monthly_sales,\n        rank() over\n          (partition by i_category, i_brand,\n                     cc_name\n           order by d_year, d_moy) rn\n from item, catalog_sales, date_dim, call_center\n where cs_item_sk = i_item_sk and\n       cs_sold_date_sk = d_date_sk and\n       cc_call_center_sk= cs_call_center_sk and\n       (\n         d_year = 2001 or\n         ( d_year = 2001-1 and d_moy =12) or\n         ( d_year = 2001+1 and d_moy =1)\n       )\n group by i_category, i_brand,\n          cc_name , d_year, d_moy),\n v2 as(\n select v1.cc_name\n        ,v1.d_year, v1.d_moy\n        ,v1.avg_monthly_sales\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n       v1.i_category = v1_lead.i_category and\n       v1.i_brand = v1_lag.i_brand and\n       v1.i_brand = v1_lead.i_brand and\n       v1. cc_name = v1_lag. cc_name and\n       v1. cc_name = v1_lead. cc_name and\n       v1.rn = v1_lag.rn + 1 and\n       v1.rn = v1_lead.rn - 1)\n/*CURSOR_IDENTIFIER*/\nselect *\nfrom v2",
        "optimize": null,
        "create": null,
        "query": [
            {
                "query": "WITH V1 AS ( SELECT I_CATEGORY , I_BRAND , CC_NAME , D_YEAR , D_MOY , SUM ( CS_SALES_PRICE ) AS SUM_SALES , AVG ( SUM ( CS_SALES_PRICE ) ) OVER ( PARTITION BY I_CATEGORY , I_BRAND , CC_NAME , D_YEAR ) AS AVG_MONTHLY_SALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY , I_BRAND , CC_NAME ORDER BY D_YEAR NULLS FIRST , D_MOY NULLS FIRST ) AS RN FROM ITEM , CATALOG_SALES , DATE_DIM , CALL_CENTER WHERE CS_ITEM_SK = I_ITEM_SK AND CS_SOLD_DATE_SK = D_DATE_SK AND CC_CALL_CENTER_SK = CS_CALL_CENTER_SK AND ( D_YEAR = 2001 OR ( D_YEAR = 2001 - 1 AND D_MOY = 12 ) OR ( D_YEAR = 2001 + 1 AND D_MOY = 1 ) ) GROUP BY I_CATEGORY , I_BRAND , CC_NAME , D_YEAR , D_MOY ) , V2 AS ( SELECT V1.CC_NAME , V1.D_YEAR , V1.D_MOY , V1.AVG_MONTHLY_SALES , V1.SUM_SALES , V1_LAG.SUM_SALES AS PSUM , V1_LEAD.SUM_SALES AS NSUM FROM V1 , V1 AS V1_LAG , V1 AS V1_LEAD WHERE V1.I_CATEGORY = V1_LAG.I_CATEGORY AND V1.I_CATEGORY = V1_LEAD.I_CATEGORY AND V1.I_BRAND = V1_LAG.I_BRAND AND V1.I_BRAND = V1_LEAD.I_BRAND AND V1.CC_NAME = V1_LAG.CC_NAME AND V1.CC_NAME = V1_LEAD.CC_NAME AND V1.RN = V1_LAG.RN + 1 AND V1.RN = V1_LEAD.RN - 1 ) SELECT * FROM V2 LIMIT 21",
                "preview": "\n/*         cc_name  d_year  d_moy  avg_monthly_sales  sum_sales     psum     nsum\n0     California    2001      1             867.23    1228.82  2319.53   396.70\n1     California    2001      2             867.23     396.70  1228.82   234.88\n2     California    2001      3             867.23     234.88   396.70   148.40\n3     California    2001      4             867.23     148.40   234.88   349.67\n4     California    2001      5             867.23     349.67   148.40   450.21\n5     California    2001      6             867.23     450.21   349.67   663.65\n6     California    2001      7             867.23     663.65   450.21   617.46\n7     California    2001      8             867.23     617.46   663.65   762.95\n8     California    2001      9             867.23     762.95   617.46  1844.40\n9     California    2001     10             867.23    1844.40   762.95  2120.28\n10    California    2001     11             867.23    2120.28  1844.40  1589.45\n11    California    2001     12             867.23    1589.45  2120.28   627.93\n12  California_1    2001      1             928.86     729.99  2144.85   157.57\n13  California_1    2001      2             928.86     157.57   729.99   378.66\n14  California_1    2001      3             928.86     378.66   157.57   377.77\n15  California_1    2001      4             928.86     377.77   378.66   486.53\n16  California_1    2001      5             928.86     486.53   377.77   399.48\n17  California_1    2001      6             928.86     399.48   486.53   767.81\n18  California_1    2001      7             928.86     767.81   399.48  1225.03\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.514062,
                    "execution_time": 1.138222,
                    "compile_time": 0.015578,
                    "planning_time": 1.237893
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.919781,
                    "execution_time": 1.131988,
                    "compile_time": 3.352,
                    "planning_time": 4.580779
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*         cc_name  d_year  d_moy  avg_monthly_sales  sum_sales     psum     nsum\n0     California    2001      1             867.23    1228.82  2319.53   396.70\n1     California    2001      2             867.23     396.70  1228.82   234.88\n2     California    2001      3             867.23     234.88   396.70   148.40\n3     California    2001      4             867.23     148.40   234.88   349.67\n4     California    2001      5             867.23     349.67   148.40   450.21\n5     California    2001      6             867.23     450.21   349.67   663.65\n6     California    2001      7             867.23     663.65   450.21   617.46\n7     California    2001      8             867.23     617.46   663.65   762.95\n8     California    2001      9             867.23     762.95   617.46  1844.40\n9     California    2001     10             867.23    1844.40   762.95  2120.28\n10    California    2001     11             867.23    2120.28  1844.40  1589.45\n11    California    2001     12             867.23    1589.45  2120.28   627.93\n12  California_1    2001      1             928.86     729.99  2144.85   157.57\n13  California_1    2001      2             928.86     157.57   729.99   378.66\n14  California_1    2001      3             928.86     378.66   157.57   377.77\n15  California_1    2001      4             928.86     377.77   378.66   486.53\n16  California_1    2001      5             928.86     486.53   377.77   399.48\n17  California_1    2001      6             928.86     399.48   486.53   767.81\n18  California_1    2001      7             928.86     767.81   399.48  1225.03\n...*/"
    },
    {
        "input": "-- start template query57.tpl query 70 in stream 0\nwith /* TPC-DS query57.tpl 0.70 */ v1 as(\n select i_category, i_brand,\n        cc_name,\n        d_year, d_moy,\n        sum(cs_sales_price) sum_sales,\n        avg(sum(cs_sales_price)) over\n          (partition by i_category, i_brand,\n                     cc_name, d_year)\n          avg_monthly_sales,\n        rank() over\n          (partition by i_category, i_brand,\n                     cc_name\n           order by d_year, d_moy) rn\n from item, catalog_sales, date_dim, call_center\n where cs_item_sk = i_item_sk and\n       cs_sold_date_sk = d_date_sk and\n       cc_call_center_sk= cs_call_center_sk and\n       (\n         d_year = 2001 or\n         ( d_year = 2001-1 and d_moy =12) or\n         ( d_year = 2001+1 and d_moy =1)\n       )\n group by i_category, i_brand,\n          cc_name , d_year, d_moy),\n v2 as(\n select v1.cc_name\n        ,v1.d_year, v1.d_moy\n        ,v1.avg_monthly_sales\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n       v1.i_category = v1_lead.i_category and\n       v1.i_brand = v1_lag.i_brand and\n       v1.i_brand = v1_lead.i_brand and\n       v1. cc_name = v1_lag. cc_name and\n       v1. cc_name = v1_lead. cc_name and\n       v1.rn = v1_lag.rn + 1 and\n       v1.rn = v1_lead.rn - 1)\n  select  * from v2\n/*CURSOR_IDENTIFIER*/",
        "optimize": null,
        "create": null,
        "query": [
            {
                "query": "WITH V1 AS ( SELECT I_CATEGORY , I_BRAND , CC_NAME , D_YEAR , D_MOY , SUM ( CS_SALES_PRICE ) AS SUM_SALES , AVG ( SUM ( CS_SALES_PRICE ) ) OVER ( PARTITION BY I_CATEGORY , I_BRAND , CC_NAME , D_YEAR ) AS AVG_MONTHLY_SALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY , I_BRAND , CC_NAME ORDER BY D_YEAR NULLS FIRST , D_MOY NULLS FIRST ) AS RN FROM ITEM , CATALOG_SALES , DATE_DIM , CALL_CENTER WHERE CS_ITEM_SK = I_ITEM_SK AND CS_SOLD_DATE_SK = D_DATE_SK AND CC_CALL_CENTER_SK = CS_CALL_CENTER_SK AND ( D_YEAR = 2001 OR ( D_YEAR = 2001 - 1 AND D_MOY = 12 ) OR ( D_YEAR = 2001 + 1 AND D_MOY = 1 ) ) GROUP BY I_CATEGORY , I_BRAND , CC_NAME , D_YEAR , D_MOY ) , V2 AS ( SELECT V1.CC_NAME , V1.D_YEAR , V1.D_MOY , V1.AVG_MONTHLY_SALES , V1.SUM_SALES , V1_LAG.SUM_SALES AS PSUM , V1_LEAD.SUM_SALES AS NSUM FROM V1 , V1 AS V1_LAG , V1 AS V1_LEAD WHERE V1.I_CATEGORY = V1_LAG.I_CATEGORY AND V1.I_CATEGORY = V1_LEAD.I_CATEGORY AND V1.I_BRAND = V1_LAG.I_BRAND AND V1.I_BRAND = V1_LEAD.I_BRAND AND V1.CC_NAME = V1_LAG.CC_NAME AND V1.CC_NAME = V1_LEAD.CC_NAME AND V1.RN = V1_LAG.RN + 1 AND V1.RN = V1_LEAD.RN - 1 ) SELECT * FROM V2 LIMIT 21",
                "preview": "\n/*         cc_name  d_year  d_moy  avg_monthly_sales  sum_sales     psum     nsum\n0     California    2001      1             867.23    1228.82  2319.53   396.70\n1     California    2001      2             867.23     396.70  1228.82   234.88\n2     California    2001      3             867.23     234.88   396.70   148.40\n3     California    2001      4             867.23     148.40   234.88   349.67\n4     California    2001      5             867.23     349.67   148.40   450.21\n5     California    2001      6             867.23     450.21   349.67   663.65\n6     California    2001      7             867.23     663.65   450.21   617.46\n7     California    2001      8             867.23     617.46   663.65   762.95\n8     California    2001      9             867.23     762.95   617.46  1844.40\n9     California    2001     10             867.23    1844.40   762.95  2120.28\n10    California    2001     11             867.23    2120.28  1844.40  1589.45\n11    California    2001     12             867.23    1589.45  2120.28   627.93\n12  California_1    2001      1             928.86     729.99  2144.85   157.57\n13  California_1    2001      2             928.86     157.57   729.99   378.66\n14  California_1    2001      3             928.86     378.66   157.57   377.77\n15  California_1    2001      4             928.86     377.77   378.66   486.53\n16  California_1    2001      5             928.86     486.53   377.77   399.48\n17  California_1    2001      6             928.86     399.48   486.53   767.81\n18  California_1    2001      7             928.86     767.81   399.48  1225.03\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.872334,
                    "execution_time": 0.473333,
                    "compile_time": 0.043809,
                    "planning_time": 0.593855
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.505871,
                    "execution_time": 1.146255,
                    "compile_time": 0.001061,
                    "planning_time": 1.237768
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*         cc_name  d_year  d_moy  avg_monthly_sales  sum_sales     psum     nsum\n0     California    2001      1             867.23    1228.82  2319.53   396.70\n1     California    2001      2             867.23     396.70  1228.82   234.88\n2     California    2001      3             867.23     234.88   396.70   148.40\n3     California    2001      4             867.23     148.40   234.88   349.67\n4     California    2001      5             867.23     349.67   148.40   450.21\n5     California    2001      6             867.23     450.21   349.67   663.65\n6     California    2001      7             867.23     663.65   450.21   617.46\n7     California    2001      8             867.23     617.46   663.65   762.95\n8     California    2001      9             867.23     762.95   617.46  1844.40\n9     California    2001     10             867.23    1844.40   762.95  2120.28\n10    California    2001     11             867.23    2120.28  1844.40  1589.45\n11    California    2001     12             867.23    1589.45  2120.28   627.93\n12  California_1    2001      1             928.86     729.99  2144.85   157.57\n13  California_1    2001      2             928.86     157.57   729.99   378.66\n14  California_1    2001      3             928.86     378.66   157.57   377.77\n15  California_1    2001      4             928.86     377.77   378.66   486.53\n16  California_1    2001      5             928.86     486.53   377.77   399.48\n17  California_1    2001      6             928.86     399.48   486.53   767.81\n18  California_1    2001      7             928.86     767.81   399.48  1225.03\n...*/"
    },
    {
        "input": "-- start template query57.tpl query 70 in stream 0\nwith /* TPC-DS query57.tpl 0.70 */ v1 as(\n select i_category, i_brand,\n        cc_name,\n        d_year, d_moy,\n        sum(cs_sales_price) sum_sales,\n        avg(sum(cs_sales_price)) over\n          (partition by i_category, i_brand,\n                     cc_name, d_year)\n          avg_monthly_sales,\n        rank() over\n          (partition by i_category, i_brand,\n                     cc_name\n           order by d_year, d_moy) rn\n from item, catalog_sales, date_dim, call_center\n where cs_item_sk = i_item_sk and\n       cs_sold_date_sk = d_date_sk and\n       cc_call_center_sk= cs_call_center_sk and\n       (\n         d_year = 2001 or\n         ( d_year = 2001-1 and d_moy =12) or\n         ( d_year = 2001+1 and d_moy =1)\n       )\n group by i_category, i_brand,\n          cc_name , d_year, d_moy),\n v2 as(\n select v1.cc_name\n        ,v1.d_year, v1.d_moy\n        ,v1.avg_monthly_sales\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n       v1.i_category = v1_lead.i_category and\n       v1.i_brand = v1_lag.i_brand and\n       v1.i_brand = v1_lead.i_brand and\n       v1. cc_name = v1_lag. cc_name and\n       v1. cc_name = v1_lead. cc_name and\n       v1.rn = v1_lag.rn + 1 and\n       v1.rn = v1_lead.rn - 1)\n  select  *\n from v2\n/*CURSOR_IDENTIFIER*/",
        "optimize": null,
        "create": null,
        "query": [
            {
                "query": "WITH V1 AS ( SELECT I_CATEGORY , I_BRAND , CC_NAME , D_YEAR , D_MOY , SUM ( CS_SALES_PRICE ) AS SUM_SALES , AVG ( SUM ( CS_SALES_PRICE ) ) OVER ( PARTITION BY I_CATEGORY , I_BRAND , CC_NAME , D_YEAR ) AS AVG_MONTHLY_SALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY , I_BRAND , CC_NAME ORDER BY D_YEAR NULLS FIRST , D_MOY NULLS FIRST ) AS RN FROM ITEM , CATALOG_SALES , DATE_DIM , CALL_CENTER WHERE CS_ITEM_SK = I_ITEM_SK AND CS_SOLD_DATE_SK = D_DATE_SK AND CC_CALL_CENTER_SK = CS_CALL_CENTER_SK AND ( D_YEAR = 2001 OR ( D_YEAR = 2001 - 1 AND D_MOY = 12 ) OR ( D_YEAR = 2001 + 1 AND D_MOY = 1 ) ) GROUP BY I_CATEGORY , I_BRAND , CC_NAME , D_YEAR , D_MOY ) , V2 AS ( SELECT V1.CC_NAME , V1.D_YEAR , V1.D_MOY , V1.AVG_MONTHLY_SALES , V1.SUM_SALES , V1_LAG.SUM_SALES AS PSUM , V1_LEAD.SUM_SALES AS NSUM FROM V1 , V1 AS V1_LAG , V1 AS V1_LEAD WHERE V1.I_CATEGORY = V1_LAG.I_CATEGORY AND V1.I_CATEGORY = V1_LEAD.I_CATEGORY AND V1.I_BRAND = V1_LAG.I_BRAND AND V1.I_BRAND = V1_LEAD.I_BRAND AND V1.CC_NAME = V1_LAG.CC_NAME AND V1.CC_NAME = V1_LEAD.CC_NAME AND V1.RN = V1_LAG.RN + 1 AND V1.RN = V1_LEAD.RN - 1 ) SELECT * FROM V2 LIMIT 21",
                "preview": "\n/*            cc_name  d_year  d_moy  avg_monthly_sales  sum_sales     psum     nsum\n0   Hawaii/Alaska_1    2001      1             824.22     593.36  2729.52   586.22\n1   Hawaii/Alaska_1    2001      2             824.22     586.22   593.36   502.72\n2   Hawaii/Alaska_1    2001      3             824.22     502.72   586.22   401.18\n3   Hawaii/Alaska_1    2001      4             824.22     401.18   502.72   424.23\n4   Hawaii/Alaska_1    2001      5             824.22     424.23   401.18   711.34\n5   Hawaii/Alaska_1    2001      6             824.22     711.34   424.23   717.41\n6   Hawaii/Alaska_1    2001      7             824.22     717.41   711.34   904.92\n7   Hawaii/Alaska_1    2001      8             824.22     904.92   717.41   499.43\n8   Hawaii/Alaska_1    2001      9             824.22     499.43   904.92   986.56\n9   Hawaii/Alaska_1    2001     10             824.22     986.56   499.43  1802.17\n10  Hawaii/Alaska_1    2001     11             824.22    1802.17   986.56  1761.18\n11  Hawaii/Alaska_1    2001     12             824.22    1761.18  1802.17   624.92\n12    North Midwest    2001      1             876.81     459.13  2570.58   459.84\n13    North Midwest    2001      2             876.81     459.84   459.13   392.33\n14    North Midwest    2001      3             876.81     392.33   459.84   323.26\n15    North Midwest    2001      4             876.81     323.26   392.33   273.93\n16    North Midwest    2001      5             876.81     273.93   323.26   781.15\n17    North Midwest    2001      6             876.81     781.15   273.93   198.95\n18    North Midwest    2001      7             876.81     198.95   781.15  1224.09\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.827699,
                    "execution_time": 0.468482,
                    "compile_time": 0.001044,
                    "planning_time": 0.558627
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.824807,
                    "execution_time": 0.466181,
                    "compile_time": 0.001012,
                    "planning_time": 0.555517
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            cc_name  d_year  d_moy  avg_monthly_sales  sum_sales     psum     nsum\n0   Hawaii/Alaska_1    2001      1             824.22     593.36  2729.52   586.22\n1   Hawaii/Alaska_1    2001      2             824.22     586.22   593.36   502.72\n2   Hawaii/Alaska_1    2001      3             824.22     502.72   586.22   401.18\n3   Hawaii/Alaska_1    2001      4             824.22     401.18   502.72   424.23\n4   Hawaii/Alaska_1    2001      5             824.22     424.23   401.18   711.34\n5   Hawaii/Alaska_1    2001      6             824.22     711.34   424.23   717.41\n6   Hawaii/Alaska_1    2001      7             824.22     717.41   711.34   904.92\n7   Hawaii/Alaska_1    2001      8             824.22     904.92   717.41   499.43\n8   Hawaii/Alaska_1    2001      9             824.22     499.43   904.92   986.56\n9   Hawaii/Alaska_1    2001     10             824.22     986.56   499.43  1802.17\n10  Hawaii/Alaska_1    2001     11             824.22    1802.17   986.56  1761.18\n11  Hawaii/Alaska_1    2001     12             824.22    1761.18  1802.17   624.92\n12    North Midwest    2001      1             876.81     459.13  2570.58   459.84\n13    North Midwest    2001      2             876.81     459.84   459.13   392.33\n14    North Midwest    2001      3             876.81     392.33   459.84   323.26\n15    North Midwest    2001      4             876.81     323.26   392.33   273.93\n16    North Midwest    2001      5             876.81     273.93   323.26   781.15\n17    North Midwest    2001      6             876.81     781.15   273.93   198.95\n18    North Midwest    2001      7             876.81     198.95   781.15  1224.09\n...*/"
    },
    {
        "input": "-- start template query57.tpl query 70 in stream 0\nwith /* TPC-DS query57.tpl 0.70 */ v1 as(\n select i_category, i_brand,\n        cc_name,\n        d_year, d_moy,\n        sum(cs_sales_price) sum_sales,\n        avg(sum(cs_sales_price)) over\n          (partition by i_category, i_brand,\n                     cc_name, d_year)\n          avg_monthly_sales,\n        rank() over\n          (partition by i_category, i_brand,\n                     cc_name\n           order by d_year, d_moy) rn\n from item, catalog_sales, date_dim, call_center\n where cs_item_sk = i_item_sk and\n       cs_sold_date_sk = d_date_sk and\n       cc_call_center_sk= cs_call_center_sk and\n       (\n         d_year = 2001 or\n         ( d_year = 2001-1 and d_moy =12) or\n         ( d_year = 2001+1 and d_moy =1)\n       )\n group by i_category, i_brand,\n          cc_name , d_year, d_moy),\n v2 as(\n select v1.cc_name\n        ,v1.d_year, v1.d_moy\n        ,v1.avg_monthly_sales\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n       v1.i_category = v1_lead.i_category and\n       v1.i_brand = v1_lag.i_brand and\n       v1.i_brand = v1_lead.i_brand and\n       v1. cc_name = v1_lag. cc_name and\n       v1. cc_name = v1_lead. cc_name and\n       v1.rn = v1_lag.rn + 1 and\n       v1.rn = v1_lead.rn - 1)\n  select  *\n from v2\n where  d_year = 2001\n/*CURSOR_IDENTIFIER*/",
        "optimize": null,
        "create": null,
        "query": [
            {
                "query": "WITH V1 AS ( SELECT I_CATEGORY , I_BRAND , CC_NAME , D_YEAR , D_MOY , SUM ( CS_SALES_PRICE ) AS SUM_SALES , AVG ( SUM ( CS_SALES_PRICE ) ) OVER ( PARTITION BY I_CATEGORY , I_BRAND , CC_NAME , D_YEAR ) AS AVG_MONTHLY_SALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY , I_BRAND , CC_NAME ORDER BY D_YEAR NULLS FIRST , D_MOY NULLS FIRST ) AS RN FROM ITEM , CATALOG_SALES , DATE_DIM , CALL_CENTER WHERE CS_ITEM_SK = I_ITEM_SK AND CS_SOLD_DATE_SK = D_DATE_SK AND CC_CALL_CENTER_SK = CS_CALL_CENTER_SK AND ( D_YEAR = 2001 OR ( D_YEAR = 2001 - 1 AND D_MOY = 12 ) OR ( D_YEAR = 2001 + 1 AND D_MOY = 1 ) ) GROUP BY I_CATEGORY , I_BRAND , CC_NAME , D_YEAR , D_MOY ) , V2 AS ( SELECT V1.CC_NAME , V1.D_YEAR , V1.D_MOY , V1.AVG_MONTHLY_SALES , V1.SUM_SALES , V1_LAG.SUM_SALES AS PSUM , V1_LEAD.SUM_SALES AS NSUM FROM V1 , V1 AS V1_LAG , V1 AS V1_LEAD WHERE V1.I_CATEGORY = V1_LAG.I_CATEGORY AND V1.I_CATEGORY = V1_LEAD.I_CATEGORY AND V1.I_BRAND = V1_LAG.I_BRAND AND V1.I_BRAND = V1_LEAD.I_BRAND AND V1.CC_NAME = V1_LAG.CC_NAME AND V1.CC_NAME = V1_LEAD.CC_NAME AND V1.RN = V1_LAG.RN + 1 AND V1.RN = V1_LEAD.RN - 1 ) SELECT * FROM V2 WHERE D_YEAR = 2001 LIMIT 21",
                "preview": "\n/*                cc_name  d_year  d_moy  avg_monthly_sales  sum_sales     psum    nsum\n0        Mid Atlantic_1    2001      1             213.66     111.59   175.66  511.10\n1        Mid Atlantic_1    2001      2             213.66     511.10   111.59  222.07\n2        Mid Atlantic_1    2001      3             213.66     222.07   511.10  155.85\n3        Mid Atlantic_1    2001      4             213.66     155.85   222.07   42.19\n4        Mid Atlantic_1    2001      5             213.66      42.19   155.85  172.96\n5        Mid Atlantic_1    2001      6             213.66     172.96    42.19   96.28\n6        Mid Atlantic_1    2001      7             213.66      96.28   172.96   71.50\n7        Mid Atlantic_1    2001      8             213.66      71.50    96.28  137.98\n8        Mid Atlantic_1    2001      9             213.66     137.98    71.50  266.45\n9        Mid Atlantic_1    2001     10             213.66     266.45   137.98  377.68\n10       Mid Atlantic_1    2001     11             213.66     377.68   266.45  398.35\n11       Mid Atlantic_1    2001     12             213.66     398.35   377.68  264.12\n12  Pacific Northwest_1    2001      1             222.73     107.72   186.75   21.51\n13  Pacific Northwest_1    2001      2             222.73      21.51   107.72  117.70\n14  Pacific Northwest_1    2001      3             222.73     117.70    21.51  221.65\n15  Pacific Northwest_1    2001      4             222.73     221.65   117.70   44.07\n16  Pacific Northwest_1    2001      5             222.73      44.07   221.65  311.50\n17  Pacific Northwest_1    2001      6             222.73     311.50    44.07   95.93\n18  Pacific Northwest_1    2001      7             222.73      95.93   311.50  428.99\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.925565,
                    "execution_time": 0.501153,
                    "compile_time": 0.055009,
                    "planning_time": 0.585179
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 7.1337,
                    "execution_time": 0.492714,
                    "compile_time": 6.199239,
                    "planning_time": 0.632503
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*                cc_name  d_year  d_moy  avg_monthly_sales  sum_sales     psum    nsum\n0        Mid Atlantic_1    2001      1             213.66     111.59   175.66  511.10\n1        Mid Atlantic_1    2001      2             213.66     511.10   111.59  222.07\n2        Mid Atlantic_1    2001      3             213.66     222.07   511.10  155.85\n3        Mid Atlantic_1    2001      4             213.66     155.85   222.07   42.19\n4        Mid Atlantic_1    2001      5             213.66      42.19   155.85  172.96\n5        Mid Atlantic_1    2001      6             213.66     172.96    42.19   96.28\n6        Mid Atlantic_1    2001      7             213.66      96.28   172.96   71.50\n7        Mid Atlantic_1    2001      8             213.66      71.50    96.28  137.98\n8        Mid Atlantic_1    2001      9             213.66     137.98    71.50  266.45\n9        Mid Atlantic_1    2001     10             213.66     266.45   137.98  377.68\n10       Mid Atlantic_1    2001     11             213.66     377.68   266.45  398.35\n11       Mid Atlantic_1    2001     12             213.66     398.35   377.68  264.12\n12  Pacific Northwest_1    2001      1             222.73     107.72   186.75   21.51\n13  Pacific Northwest_1    2001      2             222.73      21.51   107.72  117.70\n14  Pacific Northwest_1    2001      3             222.73     117.70    21.51  221.65\n15  Pacific Northwest_1    2001      4             222.73     221.65   117.70   44.07\n16  Pacific Northwest_1    2001      5             222.73      44.07   221.65  311.50\n17  Pacific Northwest_1    2001      6             222.73     311.50    44.07   95.93\n18  Pacific Northwest_1    2001      7             222.73      95.93   311.50  428.99\n...*/"
    },
    {
        "input": "-- start template query57.tpl query 70 in stream 0\nwith /* TPC-DS query57.tpl 0.70 */ v1 as(\n select i_category, i_brand,\n        cc_name,\n        d_year, d_moy,\n        sum(cs_sales_price) sum_sales,\n        avg(sum(cs_sales_price)) over\n          (partition by i_category, i_brand,\n                     cc_name, d_year)\n          avg_monthly_sales,\n        rank() over\n          (partition by i_category, i_brand,\n                     cc_name\n           order by d_year, d_moy) rn\n from item, catalog_sales, date_dim, call_center\n where cs_item_sk = i_item_sk and\n       cs_sold_date_sk = d_date_sk and\n       cc_call_center_sk= cs_call_center_sk and\n       (\n         d_year = 2001 or\n         ( d_year = 2001-1 and d_moy =12) or\n         ( d_year = 2001+1 and d_moy =1)\n       )\n group by i_category, i_brand,\n          cc_name , d_year, d_moy),\n v2 as(\n select v1.cc_name\n        ,v1.d_year, v1.d_moy\n        ,v1.avg_monthly_sales\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n       v1.i_category = v1_lead.i_category and\n       v1.i_brand = v1_lag.i_brand and\n       v1.i_brand = v1_lead.i_brand and\n       v1. cc_name = v1_lag. cc_name and\n       v1. cc_name = v1_lead. cc_name and\n       v1.rn = v1_lag.rn + 1 and\n       v1.rn = v1_lead.rn - 1)\n  select  *\n from v2\n where  d_year = 2001 and\n        avg_monthly_sales > 0 /*CURSOR_IDENTIFIER*/\n",
        "optimize": null,
        "create": null,
        "query": [
            {
                "query": "WITH V1 AS ( SELECT I_CATEGORY , I_BRAND , CC_NAME , D_YEAR , D_MOY , SUM ( CS_SALES_PRICE ) AS SUM_SALES , AVG ( SUM ( CS_SALES_PRICE ) ) OVER ( PARTITION BY I_CATEGORY , I_BRAND , CC_NAME , D_YEAR ) AS AVG_MONTHLY_SALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY , I_BRAND , CC_NAME ORDER BY D_YEAR NULLS FIRST , D_MOY NULLS FIRST ) AS RN FROM ITEM , CATALOG_SALES , DATE_DIM , CALL_CENTER WHERE CS_ITEM_SK = I_ITEM_SK AND CS_SOLD_DATE_SK = D_DATE_SK AND CC_CALL_CENTER_SK = CS_CALL_CENTER_SK AND ( D_YEAR = 2001 OR ( D_YEAR = 2001 - 1 AND D_MOY = 12 ) OR ( D_YEAR = 2001 + 1 AND D_MOY = 1 ) ) GROUP BY I_CATEGORY , I_BRAND , CC_NAME , D_YEAR , D_MOY ) , V2 AS ( SELECT V1.CC_NAME , V1.D_YEAR , V1.D_MOY , V1.AVG_MONTHLY_SALES , V1.SUM_SALES , V1_LAG.SUM_SALES AS PSUM , V1_LEAD.SUM_SALES AS NSUM FROM V1 , V1 AS V1_LAG , V1 AS V1_LEAD WHERE V1.I_CATEGORY = V1_LAG.I_CATEGORY AND V1.I_CATEGORY = V1_LEAD.I_CATEGORY AND V1.I_BRAND = V1_LAG.I_BRAND AND V1.I_BRAND = V1_LEAD.I_BRAND AND V1.CC_NAME = V1_LAG.CC_NAME AND V1.CC_NAME = V1_LEAD.CC_NAME AND V1.RN = V1_LAG.RN + 1 AND V1.RN = V1_LEAD.RN - 1 ) SELECT * FROM V2 WHERE D_YEAR = 2001 AND AVG_MONTHLY_SALES > 0 LIMIT 21",
                "preview": "\n/*                cc_name  d_year  d_moy  avg_monthly_sales  sum_sales     psum     nsum\n0        Mid Atlantic_1    2001      1             993.29     541.22  2151.78   922.35\n1         North Midwest    2001      8             180.10      75.19    78.60   386.53\n2   Pacific Northwest_1    2001      6              46.30     212.68    40.38     0.61\n3   Pacific Northwest_1    2001      8              46.30       0.61   212.68    37.96\n4   Pacific Northwest_1    2001      9              46.30      37.96     0.61    16.67\n5   Pacific Northwest_1    2001     10              46.30      16.67    37.96     9.88\n6   Pacific Northwest_1    2001     11              46.30       9.88    16.67     0.00\n7        Mid Atlantic_1    2001      2              92.88     111.12   108.25     4.14\n8        Mid Atlantic_1    2001      3              92.88       4.14   111.12   122.18\n9        Mid Atlantic_1    2001      8              92.88     122.18     4.14   148.04\n10       Mid Atlantic_1    2001      9              92.88     148.04   122.18    21.59\n11       Mid Atlantic_1    2001     10              92.88      21.59   148.04   134.90\n12             NY Metro    2001      3              75.39       8.86   134.77    42.76\n13             NY Metro    2001      4              75.39      42.76     8.86    38.20\n14             NY Metro    2001      7              75.39      38.20    42.76   136.68\n15             NY Metro    2001      8              75.39     136.68    38.20     6.67\n16             NY Metro    2001      9              75.39       6.67   136.68   219.17\n17      North Midwest_1    2001      1            1330.21     712.24  2579.69   719.28\n18      North Midwest_1    2001      2            1330.21     719.28   712.24   888.41\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.870032,
                    "execution_time": 0.464932,
                    "compile_time": 0.045479,
                    "planning_time": 0.560642
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.959124,
                    "execution_time": 0.524511,
                    "compile_time": 0.001188,
                    "planning_time": 0.647254
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*                cc_name  d_year  d_moy  avg_monthly_sales  sum_sales     psum     nsum\n0        Mid Atlantic_1    2001      1             993.29     541.22  2151.78   922.35\n1         North Midwest    2001      8             180.10      75.19    78.60   386.53\n2   Pacific Northwest_1    2001      6              46.30     212.68    40.38     0.61\n3   Pacific Northwest_1    2001      8              46.30       0.61   212.68    37.96\n4   Pacific Northwest_1    2001      9              46.30      37.96     0.61    16.67\n5   Pacific Northwest_1    2001     10              46.30      16.67    37.96     9.88\n6   Pacific Northwest_1    2001     11              46.30       9.88    16.67     0.00\n7        Mid Atlantic_1    2001      2              92.88     111.12   108.25     4.14\n8        Mid Atlantic_1    2001      3              92.88       4.14   111.12   122.18\n9        Mid Atlantic_1    2001      8              92.88     122.18     4.14   148.04\n10       Mid Atlantic_1    2001      9              92.88     148.04   122.18    21.59\n11       Mid Atlantic_1    2001     10              92.88      21.59   148.04   134.90\n12             NY Metro    2001      3              75.39       8.86   134.77    42.76\n13             NY Metro    2001      4              75.39      42.76     8.86    38.20\n14             NY Metro    2001      7              75.39      38.20    42.76   136.68\n15             NY Metro    2001      8              75.39     136.68    38.20     6.67\n16             NY Metro    2001      9              75.39       6.67   136.68   219.17\n17      North Midwest_1    2001      1            1330.21     712.24  2579.69   719.28\n18      North Midwest_1    2001      2            1330.21     719.28   712.24   888.41\n...*/"
    },
    {
        "input": "-- start template query57.tpl query 70 in stream 0\nwith /* TPC-DS query57.tpl 0.70 */ v1 as(\n select i_category, i_brand,\n        cc_name,\n        d_year, d_moy,\n        sum(cs_sales_price) sum_sales,\n        avg(sum(cs_sales_price)) over\n          (partition by i_category, i_brand,\n                     cc_name, d_year)\n          avg_monthly_sales,\n        rank() over\n          (partition by i_category, i_brand,\n                     cc_name\n           order by d_year, d_moy) rn\n from item, catalog_sales, date_dim, call_center\n where cs_item_sk = i_item_sk and\n       cs_sold_date_sk = d_date_sk and\n       cc_call_center_sk= cs_call_center_sk and\n       (\n         d_year = 2001 or\n         ( d_year = 2001-1 and d_moy =12) or\n         ( d_year = 2001+1 and d_moy =1)\n       )\n group by i_category, i_brand,\n          cc_name , d_year, d_moy),\n v2 as(\n select v1.cc_name\n        ,v1.d_year, v1.d_moy\n        ,v1.avg_monthly_sales\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n       v1.i_category = v1_lead.i_category and\n       v1.i_brand = v1_lag.i_brand and\n       v1.i_brand = v1_lead.i_brand and\n       v1. cc_name = v1_lag. cc_name and\n       v1. cc_name = v1_lead. cc_name and\n       v1.rn = v1_lag.rn + 1 and\n       v1.rn = v1_lead.rn - 1)\n  select  *\n from v2\n where  d_year = 2001 and\n        avg_monthly_sales > 0 and\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\n/*CURSOR_IDENTIFIER*/",
        "optimize": null,
        "create": null,
        "query": [
            {
                "query": "WITH V1 AS ( SELECT I_CATEGORY , I_BRAND , CC_NAME , D_YEAR , D_MOY , SUM ( CS_SALES_PRICE ) AS SUM_SALES , AVG ( SUM ( CS_SALES_PRICE ) ) OVER ( PARTITION BY I_CATEGORY , I_BRAND , CC_NAME , D_YEAR ) AS AVG_MONTHLY_SALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY , I_BRAND , CC_NAME ORDER BY D_YEAR NULLS FIRST , D_MOY NULLS FIRST ) AS RN FROM ITEM , CATALOG_SALES , DATE_DIM , CALL_CENTER WHERE CS_ITEM_SK = I_ITEM_SK AND CS_SOLD_DATE_SK = D_DATE_SK AND CC_CALL_CENTER_SK = CS_CALL_CENTER_SK AND ( D_YEAR = 2001 OR ( D_YEAR = 2001 - 1 AND D_MOY = 12 ) OR ( D_YEAR = 2001 + 1 AND D_MOY = 1 ) ) GROUP BY I_CATEGORY , I_BRAND , CC_NAME , D_YEAR , D_MOY ) , V2 AS ( SELECT V1.CC_NAME , V1.D_YEAR , V1.D_MOY , V1.AVG_MONTHLY_SALES , V1.SUM_SALES , V1_LAG.SUM_SALES AS PSUM , V1_LEAD.SUM_SALES AS NSUM FROM V1 , V1 AS V1_LAG , V1 AS V1_LEAD WHERE V1.I_CATEGORY = V1_LAG.I_CATEGORY AND V1.I_CATEGORY = V1_LEAD.I_CATEGORY AND V1.I_BRAND = V1_LAG.I_BRAND AND V1.I_BRAND = V1_LEAD.I_BRAND AND V1.CC_NAME = V1_LAG.CC_NAME AND V1.CC_NAME = V1_LEAD.CC_NAME AND V1.RN = V1_LAG.RN + 1 AND V1.RN = V1_LEAD.RN - 1 ) SELECT * FROM V2 WHERE D_YEAR = 2001 AND AVG_MONTHLY_SALES > 0 AND CASE WHEN AVG_MONTHLY_SALES > 0 THEN ABS ( SUM_SALES - AVG_MONTHLY_SALES ) / AVG_MONTHLY_SALES ELSE NULL END > 0.1 LIMIT 21",
                "preview": "\n/*            cc_name  d_year  d_moy  avg_monthly_sales  sum_sales     psum     nsum\n0   Hawaii/Alaska_1    2001      1             824.22     593.36  2729.52   586.22\n1   Hawaii/Alaska_1    2001      2             824.22     586.22   593.36   502.72\n2   Hawaii/Alaska_1    2001      3             824.22     502.72   586.22   401.18\n3   Hawaii/Alaska_1    2001      4             824.22     401.18   502.72   424.23\n4   Hawaii/Alaska_1    2001      5             824.22     424.23   401.18   711.34\n5   Hawaii/Alaska_1    2001      6             824.22     711.34   424.23   717.41\n6   Hawaii/Alaska_1    2001      7             824.22     717.41   711.34   904.92\n7   Hawaii/Alaska_1    2001      9             824.22     499.43   904.92   986.56\n8   Hawaii/Alaska_1    2001     10             824.22     986.56   499.43  1802.17\n9   Hawaii/Alaska_1    2001     11             824.22    1802.17   986.56  1761.18\n10  Hawaii/Alaska_1    2001     12             824.22    1761.18  1802.17   624.92\n11    North Midwest    2001      1             876.81     459.13  2570.58   459.84\n12    North Midwest    2001      2             876.81     459.84   459.13   392.33\n13    North Midwest    2001      3             876.81     392.33   459.84   323.26\n14    North Midwest    2001      4             876.81     323.26   392.33   273.93\n15    North Midwest    2001      5             876.81     273.93   323.26   781.15\n16    North Midwest    2001      6             876.81     781.15   273.93   198.95\n17    North Midwest    2001      7             876.81     198.95   781.15  1224.09\n18    North Midwest    2001      8             876.81    1224.09   198.95   891.32\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.831296,
                    "execution_time": 0.46547,
                    "compile_time": 0.001148,
                    "planning_time": 0.562535
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.903672,
                    "execution_time": 0.464039,
                    "compile_time": 0.001146,
                    "planning_time": 0.632767
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            cc_name  d_year  d_moy  avg_monthly_sales  sum_sales     psum     nsum\n0   Hawaii/Alaska_1    2001      1             824.22     593.36  2729.52   586.22\n1   Hawaii/Alaska_1    2001      2             824.22     586.22   593.36   502.72\n2   Hawaii/Alaska_1    2001      3             824.22     502.72   586.22   401.18\n3   Hawaii/Alaska_1    2001      4             824.22     401.18   502.72   424.23\n4   Hawaii/Alaska_1    2001      5             824.22     424.23   401.18   711.34\n5   Hawaii/Alaska_1    2001      6             824.22     711.34   424.23   717.41\n6   Hawaii/Alaska_1    2001      7             824.22     717.41   711.34   904.92\n7   Hawaii/Alaska_1    2001      9             824.22     499.43   904.92   986.56\n8   Hawaii/Alaska_1    2001     10             824.22     986.56   499.43  1802.17\n9   Hawaii/Alaska_1    2001     11             824.22    1802.17   986.56  1761.18\n10  Hawaii/Alaska_1    2001     12             824.22    1761.18  1802.17   624.92\n11    North Midwest    2001      1             876.81     459.13  2570.58   459.84\n12    North Midwest    2001      2             876.81     459.84   459.13   392.33\n13    North Midwest    2001      3             876.81     392.33   459.84   323.26\n14    North Midwest    2001      4             876.81     323.26   392.33   273.93\n15    North Midwest    2001      5             876.81     273.93   323.26   781.15\n16    North Midwest    2001      6             876.81     781.15   273.93   198.95\n17    North Midwest    2001      7             876.81     198.95   781.15  1224.09\n18    North Midwest    2001      8             876.81    1224.09   198.95   891.32\n...*/"
    },
    {
        "input": "-- start template query57.tpl query 70 in stream 0\nwith /* TPC-DS query57.tpl 0.70 */ v1 as(\n select i_category, i_brand,\n        cc_name,\n        d_year, d_moy,\n        sum(cs_sales_price) sum_sales,\n        avg(sum(cs_sales_price)) over\n          (partition by i_category, i_brand,\n                     cc_name, d_year)\n          avg_monthly_sales,\n        rank() over\n          (partition by i_category, i_brand,\n                     cc_name\n           order by d_year, d_moy) rn\n from item, catalog_sales, date_dim, call_center\n where cs_item_sk = i_item_sk and\n       cs_sold_date_sk = d_date_sk and\n       cc_call_center_sk= cs_call_center_sk and\n       (\n         d_year = 2001 or\n         ( d_year = 2001-1 and d_moy =12) or\n         ( d_year = 2001+1 and d_moy =1)\n       )\n group by i_category, i_brand,\n          cc_name , d_year, d_moy),\n v2 as(\n select v1.cc_name\n        ,v1.d_year, v1.d_moy\n        ,v1.avg_monthly_sales\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n       v1.i_category = v1_lead.i_category and\n       v1.i_brand = v1_lag.i_brand and\n       v1.i_brand = v1_lead.i_brand and\n       v1. cc_name = v1_lag. cc_name and\n       v1. cc_name = v1_lead. cc_name and\n       v1.rn = v1_lag.rn + 1 and\n       v1.rn = v1_lead.rn - 1)\n  select  *\n from v2\n where  d_year = 2001 and\n        avg_monthly_sales > 0 and\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\n order by sum_sales - avg_monthly_sales, psum\n/*CURSOR_IDENTIFIER*/",
        "optimize": null,
        "create": null,
        "query": [
            {
                "query": "WITH V1 AS ( SELECT I_CATEGORY , I_BRAND , CC_NAME , D_YEAR , D_MOY , SUM ( CS_SALES_PRICE ) AS SUM_SALES , AVG ( SUM ( CS_SALES_PRICE ) ) OVER ( PARTITION BY I_CATEGORY , I_BRAND , CC_NAME , D_YEAR ) AS AVG_MONTHLY_SALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY , I_BRAND , CC_NAME ORDER BY D_YEAR NULLS FIRST , D_MOY NULLS FIRST ) AS RN FROM ITEM , CATALOG_SALES , DATE_DIM , CALL_CENTER WHERE CS_ITEM_SK = I_ITEM_SK AND CS_SOLD_DATE_SK = D_DATE_SK AND CC_CALL_CENTER_SK = CS_CALL_CENTER_SK AND ( D_YEAR = 2001 OR ( D_YEAR = 2001 - 1 AND D_MOY = 12 ) OR ( D_YEAR = 2001 + 1 AND D_MOY = 1 ) ) GROUP BY I_CATEGORY , I_BRAND , CC_NAME , D_YEAR , D_MOY ) , V2 AS ( SELECT V1.CC_NAME , V1.D_YEAR , V1.D_MOY , V1.AVG_MONTHLY_SALES , V1.SUM_SALES , V1_LAG.SUM_SALES AS PSUM , V1_LEAD.SUM_SALES AS NSUM FROM V1 , V1 AS V1_LAG , V1 AS V1_LEAD WHERE V1.I_CATEGORY = V1_LAG.I_CATEGORY AND V1.I_CATEGORY = V1_LEAD.I_CATEGORY AND V1.I_BRAND = V1_LAG.I_BRAND AND V1.I_BRAND = V1_LEAD.I_BRAND AND V1.CC_NAME = V1_LAG.CC_NAME AND V1.CC_NAME = V1_LEAD.CC_NAME AND V1.RN = V1_LAG.RN + 1 AND V1.RN = V1_LEAD.RN - 1 ) SELECT * FROM V2 WHERE D_YEAR = 2001 AND AVG_MONTHLY_SALES > 0 AND CASE WHEN AVG_MONTHLY_SALES > 0 THEN ABS ( SUM_SALES - AVG_MONTHLY_SALES ) / AVG_MONTHLY_SALES ELSE NULL END > 0.1 ORDER BY SUM_SALES - AVG_MONTHLY_SALES NULLS FIRST , PSUM NULLS FIRST LIMIT 21",
                "preview": "\n/*                cc_name  d_year  d_moy  avg_monthly_sales  sum_sales      psum      nsum\n0   Pacific Northwest_1    2001      2           25259.96   10434.50  16096.33  13484.44\n1              NY Metro    2001      2           25266.92   10556.63  14101.64  14596.04\n2         Hawaii/Alaska    2001      2           25123.31   10829.65  12625.99  15337.63\n3              NY Metro    2001      2           25118.78   10909.48  17620.17  12931.98\n4          California_1    2001      2           25277.88   11127.66  16528.07  13900.22\n5          Mid Atlantic    2001      2           25811.84   11846.32  12927.10  15369.77\n6       Hawaii/Alaska_1    2001      2           25168.96   11209.84  16383.61  14103.43\n7              NY Metro    2001      6           25295.40   11352.19  15895.04  16771.04\n8         North Midwest    2001      2           26101.42   12188.28  16005.68  14477.36\n9         North Midwest    2001      2           25637.94   11782.14  17576.24  16663.63\n10        North Midwest    2001      6           26468.08   12621.24  17134.39  17134.83\n11           NY Metro_1    2001      3           24565.31   10826.63  12508.26  14486.59\n12             NY Metro    2001      2           24754.52   11020.46  14399.95  13956.11\n13      North Midwest_1    2001      2           24753.03   11020.75  14442.65  13147.17\n14         Mid Atlantic    2001      2           25148.92   11474.23  13839.98  13575.60\n15           NY Metro_1    2001      2           26374.98   12724.62  14004.87  13867.23\n16      Hawaii/Alaska_1    2001      2           24980.73   11374.35  16186.64  13963.43\n17        North Midwest    2001      4           25286.96   11744.59  15754.92  17107.14\n18       Mid Atlantic_1    2001      2           24846.57   11321.21  15871.26  14731.95\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.879646,
                    "execution_time": 0.511823,
                    "compile_time": 0.001094,
                    "planning_time": 0.576924
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.954397,
                    "execution_time": 0.509243,
                    "compile_time": 0.001103,
                    "planning_time": 0.64328
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*                cc_name  d_year  d_moy  avg_monthly_sales  sum_sales      psum      nsum\n0   Pacific Northwest_1    2001      2           25259.96   10434.50  16096.33  13484.44\n1              NY Metro    2001      2           25266.92   10556.63  14101.64  14596.04\n2         Hawaii/Alaska    2001      2           25123.31   10829.65  12625.99  15337.63\n3              NY Metro    2001      2           25118.78   10909.48  17620.17  12931.98\n4          California_1    2001      2           25277.88   11127.66  16528.07  13900.22\n5          Mid Atlantic    2001      2           25811.84   11846.32  12927.10  15369.77\n6       Hawaii/Alaska_1    2001      2           25168.96   11209.84  16383.61  14103.43\n7              NY Metro    2001      6           25295.40   11352.19  15895.04  16771.04\n8         North Midwest    2001      2           26101.42   12188.28  16005.68  14477.36\n9         North Midwest    2001      2           25637.94   11782.14  17576.24  16663.63\n10        North Midwest    2001      6           26468.08   12621.24  17134.39  17134.83\n11           NY Metro_1    2001      3           24565.31   10826.63  12508.26  14486.59\n12             NY Metro    2001      2           24754.52   11020.46  14399.95  13956.11\n13      North Midwest_1    2001      2           24753.03   11020.75  14442.65  13147.17\n14         Mid Atlantic    2001      2           25148.92   11474.23  13839.98  13575.60\n15           NY Metro_1    2001      2           26374.98   12724.62  14004.87  13867.23\n16      Hawaii/Alaska_1    2001      2           24980.73   11374.35  16186.64  13963.43\n17        North Midwest    2001      4           25286.96   11744.59  15754.92  17107.14\n18       Mid Atlantic_1    2001      2           24846.57   11321.21  15871.26  14731.95\n...*/"
    },
    {
        "input": "-- start template query57.tpl query 70 in stream 0\nwith /* TPC-DS query57.tpl 0.70 */ v1 as(\n select i_category, i_brand,\n        cc_name,\n        d_year, d_moy,\n        sum(cs_sales_price) sum_sales,\n        avg(sum(cs_sales_price)) over\n          (partition by i_category, i_brand,\n                     cc_name, d_year)\n          avg_monthly_sales,\n        rank() over\n          (partition by i_category, i_brand,\n                     cc_name\n           order by d_year, d_moy) rn\n from item, catalog_sales, date_dim, call_center\n where cs_item_sk = i_item_sk and\n       cs_sold_date_sk = d_date_sk and\n       cc_call_center_sk= cs_call_center_sk and\n       (\n         d_year = 2001 or\n         ( d_year = 2001-1 and d_moy =12) or\n         ( d_year = 2001+1 and d_moy =1)\n       )\n group by i_category, i_brand,\n          cc_name , d_year, d_moy),\n v2 as(\n select v1.cc_name\n        ,v1.d_year, v1.d_moy\n        ,v1.avg_monthly_sales\n        ,v1.sum_sales, v1_lag.sum_sales psum, v1_lead.sum_sales nsum\n from v1, v1 v1_lag, v1 v1_lead\n where v1.i_category = v1_lag.i_category and\n       v1.i_category = v1_lead.i_category and\n       v1.i_brand = v1_lag.i_brand and\n       v1.i_brand = v1_lead.i_brand and\n       v1. cc_name = v1_lag. cc_name and\n       v1. cc_name = v1_lead. cc_name and\n       v1.rn = v1_lag.rn + 1 and\n       v1.rn = v1_lead.rn - 1)\n  select  *\n from v2\n where  d_year = 2001 and\n        avg_monthly_sales > 0 and\n        case when avg_monthly_sales > 0 then abs(sum_sales - avg_monthly_sales) / avg_monthly_sales else null end > 0.1\n order by sum_sales - avg_monthly_sales, psum\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": null,
        "create": null,
        "query": [
            {
                "query": "WITH V1 AS ( SELECT I_CATEGORY , I_BRAND , CC_NAME , D_YEAR , D_MOY , SUM ( CS_SALES_PRICE ) AS SUM_SALES , AVG ( SUM ( CS_SALES_PRICE ) ) OVER ( PARTITION BY I_CATEGORY , I_BRAND , CC_NAME , D_YEAR ) AS AVG_MONTHLY_SALES , RANK ( ) OVER ( PARTITION BY I_CATEGORY , I_BRAND , CC_NAME ORDER BY D_YEAR NULLS FIRST , D_MOY NULLS FIRST ) AS RN FROM ITEM , CATALOG_SALES , DATE_DIM , CALL_CENTER WHERE CS_ITEM_SK = I_ITEM_SK AND CS_SOLD_DATE_SK = D_DATE_SK AND CC_CALL_CENTER_SK = CS_CALL_CENTER_SK AND ( D_YEAR = 2001 OR ( D_YEAR = 2001 - 1 AND D_MOY = 12 ) OR ( D_YEAR = 2001 + 1 AND D_MOY = 1 ) ) GROUP BY I_CATEGORY , I_BRAND , CC_NAME , D_YEAR , D_MOY ) , V2 AS ( SELECT V1.CC_NAME , V1.D_YEAR , V1.D_MOY , V1.AVG_MONTHLY_SALES , V1.SUM_SALES , V1_LAG.SUM_SALES AS PSUM , V1_LEAD.SUM_SALES AS NSUM FROM V1 , V1 AS V1_LAG , V1 AS V1_LEAD WHERE V1.I_CATEGORY = V1_LAG.I_CATEGORY AND V1.I_CATEGORY = V1_LEAD.I_CATEGORY AND V1.I_BRAND = V1_LAG.I_BRAND AND V1.I_BRAND = V1_LEAD.I_BRAND AND V1.CC_NAME = V1_LAG.CC_NAME AND V1.CC_NAME = V1_LEAD.CC_NAME AND V1.RN = V1_LAG.RN + 1 AND V1.RN = V1_LEAD.RN - 1 ) SELECT * FROM V2 WHERE D_YEAR = 2001 AND AVG_MONTHLY_SALES > 0 AND CASE WHEN AVG_MONTHLY_SALES > 0 THEN ABS ( SUM_SALES - AVG_MONTHLY_SALES ) / AVG_MONTHLY_SALES ELSE NULL END > 0.1 ORDER BY SUM_SALES - AVG_MONTHLY_SALES NULLS FIRST , PSUM NULLS FIRST LIMIT 21",
                "preview": "\n/*                cc_name  d_year  d_moy  avg_monthly_sales  sum_sales      psum      nsum\n0   Pacific Northwest_1    2001      2           25259.96   10434.50  16096.33  13484.44\n1              NY Metro    2001      2           25266.92   10556.63  14101.64  14596.04\n2         Hawaii/Alaska    2001      2           25123.31   10829.65  12625.99  15337.63\n3              NY Metro    2001      2           25118.78   10909.48  17620.17  12931.98\n4          California_1    2001      2           25277.88   11127.66  16528.07  13900.22\n5          Mid Atlantic    2001      2           25811.84   11846.32  12927.10  15369.77\n6       Hawaii/Alaska_1    2001      2           25168.96   11209.84  16383.61  14103.43\n7              NY Metro    2001      6           25295.40   11352.19  15895.04  16771.04\n8         North Midwest    2001      2           26101.42   12188.28  16005.68  14477.36\n9         North Midwest    2001      2           25637.94   11782.14  17576.24  16663.63\n10        North Midwest    2001      6           26468.08   12621.24  17134.39  17134.83\n11           NY Metro_1    2001      3           24565.31   10826.63  12508.26  14486.59\n12             NY Metro    2001      2           24754.52   11020.46  14399.95  13956.11\n13      North Midwest_1    2001      2           24753.03   11020.75  14442.65  13147.17\n14         Mid Atlantic    2001      2           25148.92   11474.23  13839.98  13575.60\n15           NY Metro_1    2001      2           26374.98   12724.62  14004.87  13867.23\n16      Hawaii/Alaska_1    2001      2           24980.73   11374.35  16186.64  13963.43\n17        North Midwest    2001      4           25286.96   11744.59  15754.92  17107.14\n18       Mid Atlantic_1    2001      2           24846.57   11321.21  15871.26  14731.95\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.867213,
                    "execution_time": 0.499227,
                    "compile_time": 0.001116,
                    "planning_time": 0.581549
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.863751,
                    "execution_time": 0.496705,
                    "compile_time": 0.001119,
                    "planning_time": 0.58209
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*                cc_name  d_year  d_moy  avg_monthly_sales  sum_sales      psum      nsum\n0   Pacific Northwest_1    2001      2           25259.96   10434.50  16096.33  13484.44\n1              NY Metro    2001      2           25266.92   10556.63  14101.64  14596.04\n2         Hawaii/Alaska    2001      2           25123.31   10829.65  12625.99  15337.63\n3              NY Metro    2001      2           25118.78   10909.48  17620.17  12931.98\n4          California_1    2001      2           25277.88   11127.66  16528.07  13900.22\n5          Mid Atlantic    2001      2           25811.84   11846.32  12927.10  15369.77\n6       Hawaii/Alaska_1    2001      2           25168.96   11209.84  16383.61  14103.43\n7              NY Metro    2001      6           25295.40   11352.19  15895.04  16771.04\n8         North Midwest    2001      2           26101.42   12188.28  16005.68  14477.36\n9         North Midwest    2001      2           25637.94   11782.14  17576.24  16663.63\n10        North Midwest    2001      6           26468.08   12621.24  17134.39  17134.83\n11           NY Metro_1    2001      3           24565.31   10826.63  12508.26  14486.59\n12             NY Metro    2001      2           24754.52   11020.46  14399.95  13956.11\n13      North Midwest_1    2001      2           24753.03   11020.75  14442.65  13147.17\n14         Mid Atlantic    2001      2           25148.92   11474.23  13839.98  13575.60\n15           NY Metro_1    2001      2           26374.98   12724.62  14004.87  13867.23\n16      Hawaii/Alaska_1    2001      2           24980.73   11374.35  16186.64  13963.43\n17        North Midwest    2001      4           25286.96   11744.59  15754.92  17107.14\n18       Mid Atlantic_1    2001      2           24846.57   11321.21  15871.26  14731.95\n...*/"
    }
]