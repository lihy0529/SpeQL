[
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name, s_company_id, s_street_number, s_street_name, s_street_type, s_suite_number, s_city, s_county, s_state, s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.194991,
                    "execution_time": 1.045792,
                    "compile_time": 0.033314,
                    "planning_time": 0.07046,
                    "create_size": 144
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.590895,
                    "execution_time": 1.796406,
                    "compile_time": 3.59027,
                    "planning_time": 0.152668,
                    "create_size": 144
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0           ese             1             408   Washington 1st        Circle      Suite 390      Oak Grove     Ziebach County      SD  58370       82          63          67           61          145\n1          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n2           pri             1             889     River Wilson        Avenue      Suite 210       Fairview      Walker County      AL  35709       94          81          64           57          135\n3          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n4         ought             1             767          Spring             Wy      Suite 250  Pleasant Hill     Ziebach County      SD  53604       87          64          70           55          118\n5         cally             1             606     Lake Lincoln     Boulevard        Suite S  Pleasant Hill  Williamson County      TN  33604       87          58          74           69          111\n6           ese             1             302          Spruce          Court        Suite L       Fairview      Walker County      AL  35709       99          70          66           75          137\n7          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n8         ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n9           ese             1             313            East          Court      Suite 300    Five Points      Walker County      AL  36098       77          77          68           59          151\n10         able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n11          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n12         able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n13          pri             1              84           First           Cir.      Suite 180  Pleasant Hill     Ziebach County      SD  53604       83          64          75           73          129\n14         eing             1             317       Poplar 9th          Pkwy        Suite P         Midway      Walker County      AL  31904       90          76          79           58          140\n15        cally             1             496             3rd            Ct.        Suite E       Fairview  Williamson County      TN  35709       85          63          78           63          169\n16         eing             1             303       Fifteenth             RD      Suite 340  Pleasant Hill  Williamson County      TN  33604      108          59          73           62          136\n17        cally             1             392            15th            Dr.        Suite W      Oak Grove      Walker County      AL  38370      100          47          61           43          135\n18         n st             1             638          Cherry            Dr.        Suite T      Riverside      Walker County      AL  39231      109          67          59           62          128\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019957,
                    "execution_time": 0.007221,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.005629
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060551,
                    "execution_time": 0.007524,
                    "compile_time": 6.1e-05,
                    "planning_time": 0.042149
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0           ese             1             408   Washington 1st        Circle      Suite 390      Oak Grove     Ziebach County      SD  58370       82          63          67           61          145\n1          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n2           pri             1             889     River Wilson        Avenue      Suite 210       Fairview      Walker County      AL  35709       94          81          64           57          135\n3          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n4         ought             1             767          Spring             Wy      Suite 250  Pleasant Hill     Ziebach County      SD  53604       87          64          70           55          118\n5         cally             1             606     Lake Lincoln     Boulevard        Suite S  Pleasant Hill  Williamson County      TN  33604       87          58          74           69          111\n6           ese             1             302          Spruce          Court        Suite L       Fairview      Walker County      AL  35709       99          70          66           75          137\n7          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n8         ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n9           ese             1             313            East          Court      Suite 300    Five Points      Walker County      AL  36098       77          77          68           59          151\n10         able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n11          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n12         able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n13          pri             1              84           First           Cir.      Suite 180  Pleasant Hill     Ziebach County      SD  53604       83          64          75           73          129\n14         eing             1             317       Poplar 9th          Pkwy        Suite P         Midway      Walker County      AL  31904       90          76          79           58          140\n15        cally             1             496             3rd            Ct.        Suite E       Fairview  Williamson County      TN  35709       85          63          78           63          169\n16         eing             1             303       Fifteenth             RD      Suite 340  Pleasant Hill  Williamson County      TN  33604      108          59          73           62          136\n17        cally             1             392            15th            Dr.        Suite W      Oak Grove      Walker County      AL  38370      100          47          61           43          135\n18         n st             1             638          Cherry            Dr.        Suite T      Riverside      Walker County      AL  39231      109          67          59           62          128\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"S_CITY\" AS \"S_CITY\" , \"S_COUNTY\" AS \"S_COUNTY\" , \"S_STATE\" AS \"S_STATE\" , \"S_ZIP\" AS \"S_ZIP\" , \"30 DAYS\" AS \"30 DAYS\" , \"31-60 DAYS\" AS \"31-60 DAYS\" , \"61-90 DAYS\" AS \"61-90 DAYS\" , \"91-120 DAYS\" AS \"91-120 DAYS\" , \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          anti           1.0             735         Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n1          eing           1.0             317     Ridge Green          Lane        Suite A         Midway  Williamson County      TN  31904       91          62          69           61          126\n2          eing           1.0             656     Washington            Dr.       Suite 50  Pleasant Hill  Williamson County      TN  33604       95          58          73           62          155\n3           bar           1.0             200           Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n4          able           1.0             479      Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5         ation           1.0             213            8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n6          eing           1.0             226           12th           Lane        Suite D      Riverside      Walker County      AL  39231       77          60          65           55          120\n7         ought           1.0             150  Maple Williams          Lane        Suite D       Fairview  Williamson County      TN  35709      104          62          60           65          120\n8          n st           1.0             240         Willow             RD      Suite 280      Riverside      Walker County      AL  39231       85          62          55           73          133\n9          n st           1.0             495         Valley           Lane        Suite D       Fairview  Williamson County      TN  35709      119          66          56           62          134\n10        cally           1.0             353      Third View         Drive      Suite 380         Midway  Williamson County      TN  31904       89          63          62           70          139\n11         able           1.0             441           11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n12          ese           1.0             521            9th            Ave        Suite Y  Pleasant Hill     Ziebach County      SD  53604       81          72          65           67          131\n13         eing           1.0             687          Ridge           Blvd        Suite P      Riverside     Ziebach County      SD  59231       88          59          72           82          120\n14          bar           1.0             582  Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n15          ese           1.0             669   Locust Spring       Parkway        Suite E       Fairview      Walker County      AL  35709       91          76          65           54          151\n16          bar           1.0             818         1st Elm          Road      Suite 220  Pleasant Hill      Walker County      AL  33604       98          65          65           60          149\n17          bar           1.0             147       Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n18          bar           1.0             175            4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.02049,
                    "execution_time": 0.00792,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.005331
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055638,
                    "execution_time": 0.007778,
                    "compile_time": 6e-05,
                    "planning_time": 0.040759
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT \"S_STORE_NAME\" AS \"S_STORE_NAME\", \"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"S_STREET_NAME\" AS \"S_STREET_NAME\", \"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"S_CITY\" AS \"S_CITY\", \"S_COUNTY\" AS \"S_COUNTY\", \"S_STATE\" AS \"S_STATE\", \"S_ZIP\" AS \"S_ZIP\", \"30 DAYS\" AS \"30 DAYS\", \"31-60 DAYS\" AS \"31-60 DAYS\", \"61-90 DAYS\" AS \"61-90 DAYS\", \"91-120 DAYS\" AS \"91-120 DAYS\", \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          anti           1.0             735         Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n1          eing           1.0             317     Ridge Green          Lane        Suite A         Midway  Williamson County      TN  31904       91          62          69           61          126\n2          eing           1.0             656     Washington            Dr.       Suite 50  Pleasant Hill  Williamson County      TN  33604       95          58          73           62          155\n3           bar           1.0             200           Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n4          able           1.0             479      Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5         ation           1.0             213            8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n6          eing           1.0             226           12th           Lane        Suite D      Riverside      Walker County      AL  39231       77          60          65           55          120\n7         ought           1.0             150  Maple Williams          Lane        Suite D       Fairview  Williamson County      TN  35709      104          62          60           65          120\n8          n st           1.0             240         Willow             RD      Suite 280      Riverside      Walker County      AL  39231       85          62          55           73          133\n9          n st           1.0             495         Valley           Lane        Suite D       Fairview  Williamson County      TN  35709      119          66          56           62          134\n10        cally           1.0             353      Third View         Drive      Suite 380         Midway  Williamson County      TN  31904       89          63          62           70          139\n11         able           1.0             441           11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n12          ese           1.0             521            9th            Ave        Suite Y  Pleasant Hill     Ziebach County      SD  53604       81          72          65           67          131\n13         eing           1.0             687          Ridge           Blvd        Suite P      Riverside     Ziebach County      SD  59231       88          59          72           82          120\n14          bar           1.0             582  Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n15          ese           1.0             669   Locust Spring       Parkway        Suite E       Fairview      Walker County      AL  35709       91          76          65           54          151\n16          bar           1.0             818         1st Elm          Road      Suite 220  Pleasant Hill      Walker County      AL  33604       98          65          65           60          149\n17          bar           1.0             147       Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n18          bar           1.0             175            4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"S_CITY\" AS \"S_CITY\" , \"S_COUNTY\" AS \"S_COUNTY\" , \"S_STATE\" AS \"S_STATE\" , \"S_ZIP\" AS \"S_ZIP\" , \"30 DAYS\" AS \"30 DAYS\" , \"31-60 DAYS\" AS \"31-60 DAYS\" , \"61-90 DAYS\" AS \"61-90 DAYS\" , \"91-120 DAYS\" AS \"91-120 DAYS\" , \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          anti           1.0             735         Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n1          eing           1.0             317     Ridge Green          Lane        Suite A         Midway  Williamson County      TN  31904       91          62          69           61          126\n2          eing           1.0             656     Washington            Dr.       Suite 50  Pleasant Hill  Williamson County      TN  33604       95          58          73           62          155\n3           bar           1.0             200           Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n4          able           1.0             479      Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5         ation           1.0             213            8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n6          eing           1.0             226           12th           Lane        Suite D      Riverside      Walker County      AL  39231       77          60          65           55          120\n7         ought           1.0             150  Maple Williams          Lane        Suite D       Fairview  Williamson County      TN  35709      104          62          60           65          120\n8          n st           1.0             240         Willow             RD      Suite 280      Riverside      Walker County      AL  39231       85          62          55           73          133\n9           ese           1.0             669   Locust Spring       Parkway        Suite E       Fairview      Walker County      AL  35709       91          76          65           54          151\n10          bar           1.0             818         1st Elm          Road      Suite 220  Pleasant Hill      Walker County      AL  33604       98          65          65           60          149\n11          bar           1.0             147       Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n12          bar           1.0             175            4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n13        cally           NaN             688                        Avenue       Suite 50                                        TN              91          61          79           66          137\n14        ation           1.0             421     12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n15          ese           1.0              27           Lake             Ln      Suite 260  Pleasant Hill  Williamson County      TN  33604       70          61          64           54          128\n16        cally           1.0             588       View Mill         Court      Suite 160  Pleasant Hill     Ziebach County      SD  53604       83          65          53           65          120\n17         n st           1.0             495         Valley           Lane        Suite D       Fairview  Williamson County      TN  35709      119          66          56           62          134\n18        cally           1.0             353      Third View         Drive      Suite 380         Midway  Williamson County      TN  31904       89          63          62           70          139\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.0198,
                    "execution_time": 0.007834,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.005181
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.01994,
                    "execution_time": 0.007421,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.005404
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT \"S_STORE_NAME\" AS \"S_STORE_NAME\", \"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"S_STREET_NAME\" AS \"S_STREET_NAME\", \"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"S_CITY\" AS \"S_CITY\", \"S_COUNTY\" AS \"S_COUNTY\", \"S_STATE\" AS \"S_STATE\", \"S_ZIP\" AS \"S_ZIP\", \"30 DAYS\" AS \"30 DAYS\", \"31-60 DAYS\" AS \"31-60 DAYS\", \"61-90 DAYS\" AS \"61-90 DAYS\", \"91-120 DAYS\" AS \"91-120 DAYS\", \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          anti           1.0             735         Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n1          eing           1.0             317     Ridge Green          Lane        Suite A         Midway  Williamson County      TN  31904       91          62          69           61          126\n2          eing           1.0             656     Washington            Dr.       Suite 50  Pleasant Hill  Williamson County      TN  33604       95          58          73           62          155\n3           bar           1.0             200           Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n4          able           1.0             479      Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5         ation           1.0             213            8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n6          eing           1.0             226           12th           Lane        Suite D      Riverside      Walker County      AL  39231       77          60          65           55          120\n7         ought           1.0             150  Maple Williams          Lane        Suite D       Fairview  Williamson County      TN  35709      104          62          60           65          120\n8          n st           1.0             240         Willow             RD      Suite 280      Riverside      Walker County      AL  39231       85          62          55           73          133\n9           ese           1.0             669   Locust Spring       Parkway        Suite E       Fairview      Walker County      AL  35709       91          76          65           54          151\n10          bar           1.0             818         1st Elm          Road      Suite 220  Pleasant Hill      Walker County      AL  33604       98          65          65           60          149\n11          bar           1.0             147       Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n12          bar           1.0             175            4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n13        cally           NaN             688                        Avenue       Suite 50                                        TN              91          61          79           66          137\n14        ation           1.0             421     12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n15          ese           1.0              27           Lake             Ln      Suite 260  Pleasant Hill  Williamson County      TN  33604       70          61          64           54          128\n16        cally           1.0             588       View Mill         Court      Suite 160  Pleasant Hill     Ziebach County      SD  53604       83          65          53           65          120\n17         n st           1.0             495         Valley           Lane        Suite D       Fairview  Williamson County      TN  35709      119          66          56           62          134\n18        cally           1.0             353      Third View         Drive      Suite 380         Midway  Williamson County      TN  31904       89          63          62           70          139\n...*/"
    },
    {
        "input": "select /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"S_CITY\" AS \"S_CITY\" , \"S_COUNTY\" AS \"S_COUNTY\" , \"S_STATE\" AS \"S_STATE\" , \"S_ZIP\" AS \"S_ZIP\" , \"30 DAYS\" AS \"30 DAYS\" , \"31-60 DAYS\" AS \"31-60 DAYS\" , \"61-90 DAYS\" AS \"61-90 DAYS\" , \"91-120 DAYS\" AS \"91-120 DAYS\" , \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0           ese           1.0             669   Locust Spring       Parkway        Suite E       Fairview      Walker County      AL  35709       91          76          65           54          151\n1           bar           1.0             818         1st Elm          Road      Suite 220  Pleasant Hill      Walker County      AL  33604       98          65          65           60          149\n2           bar           1.0             147       Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n3           bar           1.0             175            4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n4         cally           NaN             688                        Avenue       Suite 50                                        TN              91          61          79           66          137\n5         ation           1.0             421     12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n6           ese           1.0              27           Lake             Ln      Suite 260  Pleasant Hill  Williamson County      TN  33604       70          61          64           54          128\n7         cally           1.0             588       View Mill         Court      Suite 160  Pleasant Hill     Ziebach County      SD  53604       83          65          53           65          120\n8          anti           1.0             735         Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          eing           1.0             317     Ridge Green          Lane        Suite A         Midway  Williamson County      TN  31904       91          62          69           61          126\n10         eing           1.0             656     Washington            Dr.       Suite 50  Pleasant Hill  Williamson County      TN  33604       95          58          73           62          155\n11          bar           1.0             200           Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n12         able           1.0             479      Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n13        ation           1.0             213            8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n14         eing           1.0             226           12th           Lane        Suite D      Riverside      Walker County      AL  39231       77          60          65           55          120\n15        ought           1.0             150  Maple Williams          Lane        Suite D       Fairview  Williamson County      TN  35709      104          62          60           65          120\n16         n st           1.0             240         Willow             RD      Suite 280      Riverside      Walker County      AL  39231       85          62          55           73          133\n17         n st           1.0             495         Valley           Lane        Suite D       Fairview  Williamson County      TN  35709      119          66          56           62          134\n18        cally           1.0             353      Third View         Drive      Suite 380         Midway  Williamson County      TN  31904       89          63          62           70          139\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019527,
                    "execution_time": 0.007176,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.005334
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020514,
                    "execution_time": 0.007945,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.005405
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT \"S_STORE_NAME\" AS \"S_STORE_NAME\", \"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"S_STREET_NAME\" AS \"S_STREET_NAME\", \"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"S_CITY\" AS \"S_CITY\", \"S_COUNTY\" AS \"S_COUNTY\", \"S_STATE\" AS \"S_STATE\", \"S_ZIP\" AS \"S_ZIP\", \"30 DAYS\" AS \"30 DAYS\", \"31-60 DAYS\" AS \"31-60 DAYS\", \"61-90 DAYS\" AS \"61-90 DAYS\", \"91-120 DAYS\" AS \"91-120 DAYS\", \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0           ese           1.0             669   Locust Spring       Parkway        Suite E       Fairview      Walker County      AL  35709       91          76          65           54          151\n1           bar           1.0             818         1st Elm          Road      Suite 220  Pleasant Hill      Walker County      AL  33604       98          65          65           60          149\n2           bar           1.0             147       Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n3           bar           1.0             175            4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n4         cally           NaN             688                        Avenue       Suite 50                                        TN              91          61          79           66          137\n5         ation           1.0             421     12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n6           ese           1.0              27           Lake             Ln      Suite 260  Pleasant Hill  Williamson County      TN  33604       70          61          64           54          128\n7         cally           1.0             588       View Mill         Court      Suite 160  Pleasant Hill     Ziebach County      SD  53604       83          65          53           65          120\n8          anti           1.0             735         Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          eing           1.0             317     Ridge Green          Lane        Suite A         Midway  Williamson County      TN  31904       91          62          69           61          126\n10         eing           1.0             656     Washington            Dr.       Suite 50  Pleasant Hill  Williamson County      TN  33604       95          58          73           62          155\n11          bar           1.0             200           Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n12         able           1.0             479      Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n13        ation           1.0             213            8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n14         eing           1.0             226           12th           Lane        Suite D      Riverside      Walker County      AL  39231       77          60          65           55          120\n15        ought           1.0             150  Maple Williams          Lane        Suite D       Fairview  Williamson County      TN  35709      104          62          60           65          120\n16         n st           1.0             240         Willow             RD      Suite 280      Riverside      Walker County      AL  39231       85          62          55           73          133\n17         n st           1.0             495         Valley           Lane        Suite D       Fairview  Williamson County      TN  35709      119          66          56           62          134\n18        cally           1.0             353      Third View         Drive      Suite 380         Midway  Williamson County      TN  31904       89          63          62           70          139\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"S_CITY\" AS \"S_CITY\" , \"S_COUNTY\" AS \"S_COUNTY\" , \"S_STATE\" AS \"S_STATE\" , \"S_ZIP\" AS \"S_ZIP\" , \"30 DAYS\" AS \"30 DAYS\" , \"31-60 DAYS\" AS \"31-60 DAYS\" , \"61-90 DAYS\" AS \"61-90 DAYS\" , \"91-120 DAYS\" AS \"91-120 DAYS\" , \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0           ese           1.0             669   Locust Spring       Parkway        Suite E       Fairview      Walker County      AL  35709       91          76          65           54          151\n1           bar           1.0             818         1st Elm          Road      Suite 220  Pleasant Hill      Walker County      AL  33604       98          65          65           60          149\n2           bar           1.0             147       Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n3           bar           1.0             175            4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n4         cally           NaN             688                        Avenue       Suite 50                                        TN              91          61          79           66          137\n5         ation           1.0             421     12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n6           ese           1.0              27           Lake             Ln      Suite 260  Pleasant Hill  Williamson County      TN  33604       70          61          64           54          128\n7         cally           1.0             588       View Mill         Court      Suite 160  Pleasant Hill     Ziebach County      SD  53604       83          65          53           65          120\n8          anti           1.0             735         Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          eing           1.0             317     Ridge Green          Lane        Suite A         Midway  Williamson County      TN  31904       91          62          69           61          126\n10         eing           1.0             656     Washington            Dr.       Suite 50  Pleasant Hill  Williamson County      TN  33604       95          58          73           62          155\n11          bar           1.0             200           Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n12         able           1.0             479      Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n13        ation           1.0             213            8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n14         eing           1.0             226           12th           Lane        Suite D      Riverside      Walker County      AL  39231       77          60          65           55          120\n15         n st           1.0             495         Valley           Lane        Suite D       Fairview  Williamson County      TN  35709      119          66          56           62          134\n16        cally           1.0             353      Third View         Drive      Suite 380         Midway  Williamson County      TN  31904       89          63          62           70          139\n17         able           1.0             441           11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n18          ese           1.0             521            9th            Ave        Suite Y  Pleasant Hill     Ziebach County      SD  53604       81          72          65           67          131\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019665,
                    "execution_time": 0.007337,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.005266
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020262,
                    "execution_time": 0.007471,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.005594
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT \"S_STORE_NAME\" AS \"S_STORE_NAME\", \"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"S_STREET_NAME\" AS \"S_STREET_NAME\", \"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"S_CITY\" AS \"S_CITY\", \"S_COUNTY\" AS \"S_COUNTY\", \"S_STATE\" AS \"S_STATE\", \"S_ZIP\" AS \"S_ZIP\", \"30 DAYS\" AS \"30 DAYS\", \"31-60 DAYS\" AS \"31-60 DAYS\", \"61-90 DAYS\" AS \"61-90 DAYS\", \"91-120 DAYS\" AS \"91-120 DAYS\", \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0           ese           1.0             669   Locust Spring       Parkway        Suite E       Fairview      Walker County      AL  35709       91          76          65           54          151\n1           bar           1.0             818         1st Elm          Road      Suite 220  Pleasant Hill      Walker County      AL  33604       98          65          65           60          149\n2           bar           1.0             147       Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n3           bar           1.0             175            4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n4         cally           NaN             688                        Avenue       Suite 50                                        TN              91          61          79           66          137\n5         ation           1.0             421     12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n6           ese           1.0              27           Lake             Ln      Suite 260  Pleasant Hill  Williamson County      TN  33604       70          61          64           54          128\n7         cally           1.0             588       View Mill         Court      Suite 160  Pleasant Hill     Ziebach County      SD  53604       83          65          53           65          120\n8          anti           1.0             735         Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          eing           1.0             317     Ridge Green          Lane        Suite A         Midway  Williamson County      TN  31904       91          62          69           61          126\n10         eing           1.0             656     Washington            Dr.       Suite 50  Pleasant Hill  Williamson County      TN  33604       95          58          73           62          155\n11          bar           1.0             200           Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n12         able           1.0             479      Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n13        ation           1.0             213            8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n14         eing           1.0             226           12th           Lane        Suite D      Riverside      Walker County      AL  39231       77          60          65           55          120\n15         n st           1.0             495         Valley           Lane        Suite D       Fairview  Williamson County      TN  35709      119          66          56           62          134\n16        cally           1.0             353      Third View         Drive      Suite 380         Midway  Williamson County      TN  31904       89          63          62           70          139\n17         able           1.0             441           11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n18          ese           1.0             521            9th            Ave        Suite Y  Pleasant Hill     Ziebach County      SD  53604       81          72          65           67          131\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"S_CITY\" AS \"S_CITY\" , \"S_COUNTY\" AS \"S_COUNTY\" , \"S_STATE\" AS \"S_STATE\" , \"S_ZIP\" AS \"S_ZIP\" , \"30 DAYS\" AS \"30 DAYS\" , \"31-60 DAYS\" AS \"31-60 DAYS\" , \"61-90 DAYS\" AS \"61-90 DAYS\" , \"91-120 DAYS\" AS \"91-120 DAYS\" , \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n1         ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n2           ese             1             313            East          Court      Suite 300    Five Points      Walker County      AL  36098       77          77          68           59          151\n3          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n4           bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n5          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n6         cally             1             392            15th            Dr.        Suite W      Oak Grove      Walker County      AL  38370      100          47          61           43          135\n7          n st             1             638          Cherry            Dr.        Suite T      Riverside      Walker County      AL  39231      109          67          59           62          128\n8         ought             1              75          2nd Oak          Pkwy        Suite C      Riverside  Williamson County      TN  39231       82          74          54           61          131\n9          eing             1             293      Center Main          Lane      Suite 200       Fairview     Ziebach County      SD  55709      100          65          71           62          132\n10          pri             1             872      Washington           Pkwy       Suite 70         Midway      Walker County      AL  31904       88          52          67           68          111\n11         anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n12         able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n13          ese             1             462   1st Washington       Parkway      Suite 290    Five Points      Walker County      AL  36098       92          65          67           57          140\n14        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n15          bar             1             903           Sixth          Court        Suite Q    Five Points     Ziebach County      SD  56098       69          47          58           66          112\n16        ought             1             602     Chestnut 5th     Boulevard        Suite C  Pleasant Hill  Williamson County      TN  33604       91          74          62           78          114\n17          ese             1             408   Washington 1st        Circle      Suite 390      Oak Grove     Ziebach County      SD  58370       82          63          67           61          145\n18         anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019855,
                    "execution_time": 0.007327,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.005462
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020562,
                    "execution_time": 0.007849,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.005407
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT \"S_STORE_NAME\" AS \"S_STORE_NAME\", \"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"S_STREET_NAME\" AS \"S_STREET_NAME\", \"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"S_CITY\" AS \"S_CITY\", \"S_COUNTY\" AS \"S_COUNTY\", \"S_STATE\" AS \"S_STATE\", \"S_ZIP\" AS \"S_ZIP\", \"30 DAYS\" AS \"30 DAYS\", \"31-60 DAYS\" AS \"31-60 DAYS\", \"61-90 DAYS\" AS \"61-90 DAYS\", \"91-120 DAYS\" AS \"91-120 DAYS\", \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n1         ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n2           ese             1             313            East          Court      Suite 300    Five Points      Walker County      AL  36098       77          77          68           59          151\n3          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n4           bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n5          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n6         cally             1             392            15th            Dr.        Suite W      Oak Grove      Walker County      AL  38370      100          47          61           43          135\n7          n st             1             638          Cherry            Dr.        Suite T      Riverside      Walker County      AL  39231      109          67          59           62          128\n8         ought             1              75          2nd Oak          Pkwy        Suite C      Riverside  Williamson County      TN  39231       82          74          54           61          131\n9          eing             1             293      Center Main          Lane      Suite 200       Fairview     Ziebach County      SD  55709      100          65          71           62          132\n10          pri             1             872      Washington           Pkwy       Suite 70         Midway      Walker County      AL  31904       88          52          67           68          111\n11         anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n12         able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n13          ese             1             462   1st Washington       Parkway      Suite 290    Five Points      Walker County      AL  36098       92          65          67           57          140\n14        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n15          bar             1             903           Sixth          Court        Suite Q    Five Points     Ziebach County      SD  56098       69          47          58           66          112\n16        ought             1             602     Chestnut 5th     Boulevard        Suite C  Pleasant Hill  Williamson County      TN  33604       91          74          62           78          114\n17          ese             1             408   Washington 1st        Circle      Suite 390      Oak Grove     Ziebach County      SD  58370       82          63          67           61          145\n18         anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"S_CITY\" AS \"S_CITY\" , \"S_COUNTY\" AS \"S_COUNTY\" , \"S_STATE\" AS \"S_STATE\" , \"S_ZIP\" AS \"S_ZIP\" , \"30 DAYS\" AS \"30 DAYS\" , \"31-60 DAYS\" AS \"31-60 DAYS\" , \"61-90 DAYS\" AS \"61-90 DAYS\" , \"91-120 DAYS\" AS \"91-120 DAYS\" , \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          anti           1.0             735         Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n1          eing           1.0             317     Ridge Green          Lane        Suite A         Midway  Williamson County      TN  31904       91          62          69           61          126\n2          eing           1.0             656     Washington            Dr.       Suite 50  Pleasant Hill  Williamson County      TN  33604       95          58          73           62          155\n3           bar           1.0             200           Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n4          able           1.0             479      Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5         ation           1.0             213            8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n6          eing           1.0             226           12th           Lane        Suite D      Riverside      Walker County      AL  39231       77          60          65           55          120\n7          n st           1.0             495         Valley           Lane        Suite D       Fairview  Williamson County      TN  35709      119          66          56           62          134\n8         cally           1.0             353      Third View         Drive      Suite 380         Midway  Williamson County      TN  31904       89          63          62           70          139\n9          able           1.0             441           11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n10          ese           1.0             521            9th            Ave        Suite Y  Pleasant Hill     Ziebach County      SD  53604       81          72          65           67          131\n11         eing           1.0             687          Ridge           Blvd        Suite P      Riverside     Ziebach County      SD  59231       88          59          72           82          120\n12          bar           1.0             582  Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n13          ese           1.0             669   Locust Spring       Parkway        Suite E       Fairview      Walker County      AL  35709       91          76          65           54          151\n14          bar           1.0             818         1st Elm          Road      Suite 220  Pleasant Hill      Walker County      AL  33604       98          65          65           60          149\n15          bar           1.0             147       Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n16          bar           1.0             175            4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n17        cally           NaN             688                        Avenue       Suite 50                                        TN              91          61          79           66          137\n18        ation           1.0             421     12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020046,
                    "execution_time": 0.007266,
                    "compile_time": 6.1e-05,
                    "planning_time": 0.005543
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.0204,
                    "execution_time": 0.007446,
                    "compile_time": 6.3e-05,
                    "planning_time": 0.005635
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT \"S_STORE_NAME\" AS \"S_STORE_NAME\", \"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"S_STREET_NAME\" AS \"S_STREET_NAME\", \"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"S_CITY\" AS \"S_CITY\", \"S_COUNTY\" AS \"S_COUNTY\", \"S_STATE\" AS \"S_STATE\", \"S_ZIP\" AS \"S_ZIP\", \"30 DAYS\" AS \"30 DAYS\", \"31-60 DAYS\" AS \"31-60 DAYS\", \"61-90 DAYS\" AS \"61-90 DAYS\", \"91-120 DAYS\" AS \"91-120 DAYS\", \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          anti           1.0             735         Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n1          eing           1.0             317     Ridge Green          Lane        Suite A         Midway  Williamson County      TN  31904       91          62          69           61          126\n2          eing           1.0             656     Washington            Dr.       Suite 50  Pleasant Hill  Williamson County      TN  33604       95          58          73           62          155\n3           bar           1.0             200           Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n4          able           1.0             479      Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5         ation           1.0             213            8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n6          eing           1.0             226           12th           Lane        Suite D      Riverside      Walker County      AL  39231       77          60          65           55          120\n7          n st           1.0             495         Valley           Lane        Suite D       Fairview  Williamson County      TN  35709      119          66          56           62          134\n8         cally           1.0             353      Third View         Drive      Suite 380         Midway  Williamson County      TN  31904       89          63          62           70          139\n9          able           1.0             441           11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n10          ese           1.0             521            9th            Ave        Suite Y  Pleasant Hill     Ziebach County      SD  53604       81          72          65           67          131\n11         eing           1.0             687          Ridge           Blvd        Suite P      Riverside     Ziebach County      SD  59231       88          59          72           82          120\n12          bar           1.0             582  Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n13          ese           1.0             669   Locust Spring       Parkway        Suite E       Fairview      Walker County      AL  35709       91          76          65           54          151\n14          bar           1.0             818         1st Elm          Road      Suite 220  Pleasant Hill      Walker County      AL  33604       98          65          65           60          149\n15          bar           1.0             147       Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n16          bar           1.0             175            4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n17        cally           NaN             688                        Avenue       Suite 50                                        TN              91          61          79           66          137\n18        ation           1.0             421     12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"S_CITY\" AS \"S_CITY\" , \"S_COUNTY\" AS \"S_COUNTY\" , \"S_STATE\" AS \"S_STATE\" , \"S_ZIP\" AS \"S_ZIP\" , \"30 DAYS\" AS \"30 DAYS\" , \"31-60 DAYS\" AS \"31-60 DAYS\" , \"61-90 DAYS\" AS \"61-90 DAYS\" , \"91-120 DAYS\" AS \"91-120 DAYS\" , \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          n st           1.0             495         Valley           Lane        Suite D       Fairview  Williamson County      TN  35709      119          66          56           62          134\n1         cally           1.0             353      Third View         Drive      Suite 380         Midway  Williamson County      TN  31904       89          63          62           70          139\n2          able           1.0             441           11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n3           ese           1.0             521            9th            Ave        Suite Y  Pleasant Hill     Ziebach County      SD  53604       81          72          65           67          131\n4          eing           1.0             687          Ridge           Blvd        Suite P      Riverside     Ziebach County      SD  59231       88          59          72           82          120\n5           bar           1.0             582  Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n6           ese           1.0             669   Locust Spring       Parkway        Suite E       Fairview      Walker County      AL  35709       91          76          65           54          151\n7           bar           1.0             818         1st Elm          Road      Suite 220  Pleasant Hill      Walker County      AL  33604       98          65          65           60          149\n8           bar           1.0             147       Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n9           bar           1.0             175            4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n10        cally           NaN             688                        Avenue       Suite 50                                        TN              91          61          79           66          137\n11        ation           1.0             421     12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n12          ese           1.0              27           Lake             Ln      Suite 260  Pleasant Hill  Williamson County      TN  33604       70          61          64           54          128\n13        cally           1.0             588       View Mill         Court      Suite 160  Pleasant Hill     Ziebach County      SD  53604       83          65          53           65          120\n14        ought           1.0             150  Maple Williams          Lane        Suite D       Fairview  Williamson County      TN  35709      104          62          60           65          120\n15         n st           1.0             240         Willow             RD      Suite 280      Riverside      Walker County      AL  39231       85          62          55           73          133\n16         anti           1.0             735         Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n17         eing           1.0             317     Ridge Green          Lane        Suite A         Midway  Williamson County      TN  31904       91          62          69           61          126\n18         eing           1.0             656     Washington            Dr.       Suite 50  Pleasant Hill  Williamson County      TN  33604       95          58          73           62          155\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020292,
                    "execution_time": 0.007913,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.005342
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019951,
                    "execution_time": 0.007281,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.005519
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT \"S_STORE_NAME\" AS \"S_STORE_NAME\", \"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"S_STREET_NAME\" AS \"S_STREET_NAME\", \"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"S_CITY\" AS \"S_CITY\", \"S_COUNTY\" AS \"S_COUNTY\", \"S_STATE\" AS \"S_STATE\", \"S_ZIP\" AS \"S_ZIP\", \"30 DAYS\" AS \"30 DAYS\", \"31-60 DAYS\" AS \"31-60 DAYS\", \"61-90 DAYS\" AS \"61-90 DAYS\", \"91-120 DAYS\" AS \"91-120 DAYS\", \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          n st           1.0             495         Valley           Lane        Suite D       Fairview  Williamson County      TN  35709      119          66          56           62          134\n1         cally           1.0             353      Third View         Drive      Suite 380         Midway  Williamson County      TN  31904       89          63          62           70          139\n2          able           1.0             441           11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n3           ese           1.0             521            9th            Ave        Suite Y  Pleasant Hill     Ziebach County      SD  53604       81          72          65           67          131\n4          eing           1.0             687          Ridge           Blvd        Suite P      Riverside     Ziebach County      SD  59231       88          59          72           82          120\n5           bar           1.0             582  Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n6           ese           1.0             669   Locust Spring       Parkway        Suite E       Fairview      Walker County      AL  35709       91          76          65           54          151\n7           bar           1.0             818         1st Elm          Road      Suite 220  Pleasant Hill      Walker County      AL  33604       98          65          65           60          149\n8           bar           1.0             147       Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n9           bar           1.0             175            4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n10        cally           NaN             688                        Avenue       Suite 50                                        TN              91          61          79           66          137\n11        ation           1.0             421     12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n12          ese           1.0              27           Lake             Ln      Suite 260  Pleasant Hill  Williamson County      TN  33604       70          61          64           54          128\n13        cally           1.0             588       View Mill         Court      Suite 160  Pleasant Hill     Ziebach County      SD  53604       83          65          53           65          120\n14        ought           1.0             150  Maple Williams          Lane        Suite D       Fairview  Williamson County      TN  35709      104          62          60           65          120\n15         n st           1.0             240         Willow             RD      Suite 280      Riverside      Walker County      AL  39231       85          62          55           73          133\n16         anti           1.0             735         Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n17         eing           1.0             317     Ridge Green          Lane        Suite A         Midway  Williamson County      TN  31904       91          62          69           61          126\n18         eing           1.0             656     Washington            Dr.       Suite 50  Pleasant Hill  Williamson County      TN  33604       95          58          73           62          155\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"S_CITY\" AS \"S_CITY\" , \"S_COUNTY\" AS \"S_COUNTY\" , \"S_STATE\" AS \"S_STATE\" , \"S_ZIP\" AS \"S_ZIP\" , \"30 DAYS\" AS \"30 DAYS\" , \"31-60 DAYS\" AS \"31-60 DAYS\" , \"61-90 DAYS\" AS \"61-90 DAYS\" , \"91-120 DAYS\" AS \"91-120 DAYS\" , \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0         cally             1             392           15th            Dr.        Suite W      Oak Grove      Walker County      AL  38370      100          47          61           43          135\n1          n st             1             638         Cherry            Dr.        Suite T      Riverside      Walker County      AL  39231      109          67          59           62          128\n2         ought             1              75         2nd Oak          Pkwy        Suite C      Riverside  Williamson County      TN  39231       82          74          54           61          131\n3          eing             1             293     Center Main          Lane      Suite 200       Fairview     Ziebach County      SD  55709      100          65          71           62          132\n4           pri             1             872     Washington           Pkwy       Suite 70         Midway      Walker County      AL  31904       88          52          67           68          111\n5          anti             1             321           11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n6          able             1             302  Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n7           ese             1             462  1st Washington       Parkway      Suite 290    Five Points      Walker County      AL  36098       92          65          67           57          140\n8         ation             1             811            Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n9           bar             1             903          Sixth          Court        Suite Q    Five Points     Ziebach County      SD  56098       69          47          58           66          112\n10        ought             1             602    Chestnut 5th     Boulevard        Suite C  Pleasant Hill  Williamson County      TN  33604       91          74          62           78          114\n11          ese             1             408  Washington 1st        Circle      Suite 390      Oak Grove     Ziebach County      SD  58370       82          63          67           61          145\n12         anti             1             897         Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n13          pri             1             889    River Wilson        Avenue      Suite 210       Fairview      Walker County      AL  35709       94          81          64           57          135\n14         able             1             543        West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n15        ought             1             767         Spring             Wy      Suite 250  Pleasant Hill     Ziebach County      SD  53604       87          64          70           55          118\n16        cally             1             606    Lake Lincoln     Boulevard        Suite S  Pleasant Hill  Williamson County      TN  33604       87          58          74           69          111\n17          ese             1             302         Spruce          Court        Suite L       Fairview      Walker County      AL  35709       99          70          66           75          137\n18          pri             1              84          First           Cir.      Suite 180  Pleasant Hill     Ziebach County      SD  53604       83          64          75           73          129\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021122,
                    "execution_time": 0.007913,
                    "compile_time": 6.4e-05,
                    "planning_time": 0.005726
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020364,
                    "execution_time": 0.007647,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.005516
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT \"S_STORE_NAME\" AS \"S_STORE_NAME\", \"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"S_STREET_NAME\" AS \"S_STREET_NAME\", \"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"S_CITY\" AS \"S_CITY\", \"S_COUNTY\" AS \"S_COUNTY\", \"S_STATE\" AS \"S_STATE\", \"S_ZIP\" AS \"S_ZIP\", \"30 DAYS\" AS \"30 DAYS\", \"31-60 DAYS\" AS \"31-60 DAYS\", \"61-90 DAYS\" AS \"61-90 DAYS\", \"91-120 DAYS\" AS \"91-120 DAYS\", \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0         cally             1             392           15th            Dr.        Suite W      Oak Grove      Walker County      AL  38370      100          47          61           43          135\n1          n st             1             638         Cherry            Dr.        Suite T      Riverside      Walker County      AL  39231      109          67          59           62          128\n2         ought             1              75         2nd Oak          Pkwy        Suite C      Riverside  Williamson County      TN  39231       82          74          54           61          131\n3          eing             1             293     Center Main          Lane      Suite 200       Fairview     Ziebach County      SD  55709      100          65          71           62          132\n4           pri             1             872     Washington           Pkwy       Suite 70         Midway      Walker County      AL  31904       88          52          67           68          111\n5          anti             1             321           11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n6          able             1             302  Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n7           ese             1             462  1st Washington       Parkway      Suite 290    Five Points      Walker County      AL  36098       92          65          67           57          140\n8         ation             1             811            Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n9           bar             1             903          Sixth          Court        Suite Q    Five Points     Ziebach County      SD  56098       69          47          58           66          112\n10        ought             1             602    Chestnut 5th     Boulevard        Suite C  Pleasant Hill  Williamson County      TN  33604       91          74          62           78          114\n11          ese             1             408  Washington 1st        Circle      Suite 390      Oak Grove     Ziebach County      SD  58370       82          63          67           61          145\n12         anti             1             897         Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n13          pri             1             889    River Wilson        Avenue      Suite 210       Fairview      Walker County      AL  35709       94          81          64           57          135\n14         able             1             543        West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n15        ought             1             767         Spring             Wy      Suite 250  Pleasant Hill     Ziebach County      SD  53604       87          64          70           55          118\n16        cally             1             606    Lake Lincoln     Boulevard        Suite S  Pleasant Hill  Williamson County      TN  33604       87          58          74           69          111\n17          ese             1             302         Spruce          Court        Suite L       Fairview      Walker County      AL  35709       99          70          66           75          137\n18          pri             1              84          First           Cir.      Suite 180  Pleasant Hill     Ziebach County      SD  53604       83          64          75           73          129\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"S_CITY\" AS \"S_CITY\" , \"S_COUNTY\" AS \"S_COUNTY\" , \"S_STATE\" AS \"S_STATE\" , \"S_ZIP\" AS \"S_ZIP\" , \"30 DAYS\" AS \"30 DAYS\" , \"31-60 DAYS\" AS \"31-60 DAYS\" , \"61-90 DAYS\" AS \"61-90 DAYS\" , \"91-120 DAYS\" AS \"91-120 DAYS\" , \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          anti           1.0             735         Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n1          eing           1.0             317     Ridge Green          Lane        Suite A         Midway  Williamson County      TN  31904       91          62          69           61          126\n2          eing           1.0             656     Washington            Dr.       Suite 50  Pleasant Hill  Williamson County      TN  33604       95          58          73           62          155\n3           bar           1.0             200           Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n4          able           1.0             479      Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5         ation           1.0             213            8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n6          eing           1.0             226           12th           Lane        Suite D      Riverside      Walker County      AL  39231       77          60          65           55          120\n7           ese           1.0             669   Locust Spring       Parkway        Suite E       Fairview      Walker County      AL  35709       91          76          65           54          151\n8           bar           1.0             818         1st Elm          Road      Suite 220  Pleasant Hill      Walker County      AL  33604       98          65          65           60          149\n9           bar           1.0             147       Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n10          bar           1.0             175            4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n11        cally           NaN             688                        Avenue       Suite 50                                        TN              91          61          79           66          137\n12        ation           1.0             421     12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n13          ese           1.0              27           Lake             Ln      Suite 260  Pleasant Hill  Williamson County      TN  33604       70          61          64           54          128\n14        cally           1.0             588       View Mill         Court      Suite 160  Pleasant Hill     Ziebach County      SD  53604       83          65          53           65          120\n15         n st           1.0             495         Valley           Lane        Suite D       Fairview  Williamson County      TN  35709      119          66          56           62          134\n16        cally           1.0             353      Third View         Drive      Suite 380         Midway  Williamson County      TN  31904       89          63          62           70          139\n17         able           1.0             441           11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n18          ese           1.0             521            9th            Ave        Suite Y  Pleasant Hill     Ziebach County      SD  53604       81          72          65           67          131\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019639,
                    "execution_time": 0.007166,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.005326
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019963,
                    "execution_time": 0.00724,
                    "compile_time": 6e-05,
                    "planning_time": 0.005532
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\"",
                "rewrite": "SELECT \"S_STORE_NAME\" AS \"S_STORE_NAME\", \"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"S_STREET_NAME\" AS \"S_STREET_NAME\", \"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"S_CITY\" AS \"S_CITY\", \"S_COUNTY\" AS \"S_COUNTY\", \"S_STATE\" AS \"S_STATE\", \"S_ZIP\" AS \"S_ZIP\", \"30 DAYS\" AS \"30 DAYS\", \"31-60 DAYS\" AS \"31-60 DAYS\", \"61-90 DAYS\" AS \"61-90 DAYS\", \"91-120 DAYS\" AS \"91-120 DAYS\", \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number   s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          anti           1.0             735         Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n1          eing           1.0             317     Ridge Green          Lane        Suite A         Midway  Williamson County      TN  31904       91          62          69           61          126\n2          eing           1.0             656     Washington            Dr.       Suite 50  Pleasant Hill  Williamson County      TN  33604       95          58          73           62          155\n3           bar           1.0             200           Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n4          able           1.0             479      Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5         ation           1.0             213            8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n6          eing           1.0             226           12th           Lane        Suite D      Riverside      Walker County      AL  39231       77          60          65           55          120\n7           ese           1.0             669   Locust Spring       Parkway        Suite E       Fairview      Walker County      AL  35709       91          76          65           54          151\n8           bar           1.0             818         1st Elm          Road      Suite 220  Pleasant Hill      Walker County      AL  33604       98          65          65           60          149\n9           bar           1.0             147       Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n10          bar           1.0             175            4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n11        cally           NaN             688                        Avenue       Suite 50                                        TN              91          61          79           66          137\n12        ation           1.0             421     12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n13          ese           1.0              27           Lake             Ln      Suite 260  Pleasant Hill  Williamson County      TN  33604       70          61          64           54          128\n14        cally           1.0             588       View Mill         Court      Suite 160  Pleasant Hill     Ziebach County      SD  53604       83          65          53           65          120\n15         n st           1.0             495         Valley           Lane        Suite D       Fairview  Williamson County      TN  35709      119          66          56           62          134\n16        cally           1.0             353      Third View         Drive      Suite 380         Midway  Williamson County      TN  31904       89          63          62           70          139\n17         able           1.0             441           11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n18          ese           1.0             521            9th            Ave        Suite Y  Pleasant Hill     Ziebach County      SD  53604       81          72          65           67          131\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n1          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n2          able             1             441            11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n3          able             1             479       Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n4          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n5          able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n6          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n7          anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n8          anti             1             735          Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n10        ation             1             213             8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n11        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n12        ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n13        ation             1             421      12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n14          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n15          bar             1             175             4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n16          bar             1             200            Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n17          bar             1             903           Sixth          Court        Suite Q    Five Points     Ziebach County      SD  56098       69          47          58           66          112\n18          bar             1             147        Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021503,
                    "execution_time": 0.00833,
                    "compile_time": 9.4e-05,
                    "planning_time": 0.00573
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058826,
                    "execution_time": 0.0085,
                    "compile_time": 9.5e-05,
                    "planning_time": 0.041197
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n1          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n2          able             1             441            11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n3          able             1             479       Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n4          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n5          able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n6          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n7          anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n8          anti             1             735          Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n10        ation             1             213             8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n11        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n12        ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n13        ation             1             421      12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n14          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n15          bar             1             175             4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n16          bar             1             200            Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n17          bar             1             903           Sixth          Court        Suite Q    Five Points     Ziebach County      SD  56098       69          47          58           66          112\n18          bar             1             147        Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n1          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n2          able             1             441            11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n3          able             1             479       Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n4          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n5          able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n6          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n7          anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n8          anti             1             735          Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n10        ation             1             213             8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n11        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n12        ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n13        ation             1             421      12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n14          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n15          bar             1             175             4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n16          bar             1             200            Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n17          bar             1             903           Sixth          Court        Suite Q    Five Points     Ziebach County      SD  56098       69          47          58           66          112\n18          bar             1             147        Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022103,
                    "execution_time": 0.00901,
                    "compile_time": 9.6e-05,
                    "planning_time": 0.00576
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057714,
                    "execution_time": 0.008514,
                    "compile_time": 9.8e-05,
                    "planning_time": 0.041542
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n1          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n2          able             1             441            11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n3          able             1             479       Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n4          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n5          able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n6          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n7          anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n8          anti             1             735          Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n10        ation             1             213             8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n11        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n12        ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n13        ation             1             421      12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n14          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n15          bar             1             175             4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n16          bar             1             200            Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n17          bar             1             903           Sixth          Court        Suite Q    Five Points     Ziebach County      SD  56098       69          47          58           66          112\n18          bar             1             147        Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n1          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n2          able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n3          able             1             441            11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n4          able             1             479       Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n6          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n7          anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n8          anti             1             735          Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n10        ation             1             213             8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n11        ation             1             421      12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n12        ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n13        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n14          bar             1             147        Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n15          bar             1             175             4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n16          bar             1             200            Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n17          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n18          bar             1             582   Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021472,
                    "execution_time": 0.008298,
                    "compile_time": 9.4e-05,
                    "planning_time": 0.005768
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057983,
                    "execution_time": 0.008931,
                    "compile_time": 9.3e-05,
                    "planning_time": 0.041589
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n1          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n2          able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n3          able             1             441            11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n4          able             1             479       Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n6          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n7          anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n8          anti             1             735          Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n10        ation             1             213             8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n11        ation             1             421      12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n12        ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n13        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n14          bar             1             147        Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n15          bar             1             175             4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n16          bar             1             200            Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n17          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n18          bar             1             582   Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n1          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n2          able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n3          able             1             441            11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n4          able             1             479       Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n6          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n7          anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n8          anti             1             735          Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n10        ation             1             213             8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n11        ation             1             421      12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n12        ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n13        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n14          bar             1             147        Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n15          bar             1             175             4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n16          bar             1             200            Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n17          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n18          bar             1             582   Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.02237,
                    "execution_time": 0.008814,
                    "compile_time": 9.6e-05,
                    "planning_time": 0.006044
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057817,
                    "execution_time": 0.008533,
                    "compile_time": 9.8e-05,
                    "planning_time": 0.041648
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n1          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n2          able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n3          able             1             441            11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n4          able             1             479       Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n6          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n7          anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n8          anti             1             735          Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n10        ation             1             213             8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n11        ation             1             421      12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n12        ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n13        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n14          bar             1             147        Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n15          bar             1             175             4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n16          bar             1             200            Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n17          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n18          bar             1             582   Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" , \"S_STREET_TYPE\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n1          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n2          able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n3          able             1             441            11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n4          able             1             479       Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n6          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n7          anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n8          anti             1             735          Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n10        ation             1             213             8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n11        ation             1             421      12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n12        ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n13        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n14          bar             1             147        Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n15          bar             1             175             4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n16          bar             1             200            Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n17          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n18          bar             1             582   Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022689,
                    "execution_time": 0.009063,
                    "compile_time": 9.6e-05,
                    "planning_time": 0.006135
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058216,
                    "execution_time": 0.00857,
                    "compile_time": 9.7e-05,
                    "planning_time": 0.041978
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST, \"S_STREET_TYPE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n1          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n2          able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n3          able             1             441            11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n4          able             1             479       Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n6          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n7          anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n8          anti             1             735          Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n10        ation             1             213             8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n11        ation             1             421      12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n12        ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n13        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n14          bar             1             147        Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n15          bar             1             175             4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n16          bar             1             200            Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n17          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n18          bar             1             582   Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n        ,s_suite_number\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" , \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n1          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n2          able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n3          able             1             441            11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n4          able             1             479       Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n6          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n7          anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n8          anti             1             735          Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n10        ation             1             213             8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n11        ation             1             421      12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n12        ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n13        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n14          bar             1             147        Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n15          bar             1             175             4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n16          bar             1             200            Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n17          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n18          bar             1             582   Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021852,
                    "execution_time": 0.008212,
                    "compile_time": 9.4e-05,
                    "planning_time": 0.006212
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058777,
                    "execution_time": 0.009103,
                    "compile_time": 9.7e-05,
                    "planning_time": 0.042016
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST, \"S_STREET_TYPE\" NULLS LAST, \"S_SUITE_NUMBER\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n1          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n2          able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n3          able             1             441            11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n4          able             1             479       Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n6          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n7          anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n8          anti             1             735          Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n10        ation             1             213             8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n11        ation             1             421      12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n12        ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n13        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n14          bar             1             147        Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n15          bar             1             175             4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n16          bar             1             200            Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n17          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n18          bar             1             582   Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n        ,s_suite_number\n        ,s_city\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" , \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" , \"S_CITY\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n1          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n2          able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n3          able             1             441            11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n4          able             1             479       Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n6          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n7          anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n8          anti             1             735          Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n10        ation             1             213             8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n11        ation             1             421      12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n12        ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n13        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n14          bar             1             147        Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n15          bar             1             175             4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n16          bar             1             200            Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n17          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n18          bar             1             582   Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022786,
                    "execution_time": 0.009013,
                    "compile_time": 9.5e-05,
                    "planning_time": 0.006332
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058809,
                    "execution_time": 0.009028,
                    "compile_time": 9.8e-05,
                    "planning_time": 0.042187
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST, \"S_STREET_TYPE\" NULLS LAST, \"S_SUITE_NUMBER\" NULLS LAST, \"S_CITY\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n1          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n2          able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n3          able             1             441            11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n4          able             1             479       Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n6          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n7          anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n8          anti             1             735          Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n10        ation             1             213             8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n11        ation             1             421      12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n12        ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n13        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n14          bar             1             147        Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n15          bar             1             175             4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n16          bar             1             200            Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n17          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n18          bar             1             582   Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n        ,s_suite_number\n        ,s_city\n        ,s_county\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" , \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" , \"S_CITY\" , \"S_COUNTY\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n1          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n2          able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n3          able             1             441            11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n4          able             1             479       Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n6          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n7          anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n8          anti             1             735          Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n10        ation             1             213             8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n11        ation             1             421      12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n12        ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n13        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n14          bar             1             147        Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n15          bar             1             175             4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n16          bar             1             200            Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n17          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n18          bar             1             582   Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022125,
                    "execution_time": 0.008246,
                    "compile_time": 9.8e-05,
                    "planning_time": 0.006423
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.0591,
                    "execution_time": 0.009295,
                    "compile_time": 9.5e-05,
                    "planning_time": 0.042105
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST, \"S_STREET_TYPE\" NULLS LAST, \"S_SUITE_NUMBER\" NULLS LAST, \"S_CITY\" NULLS LAST, \"S_COUNTY\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n1          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n2          able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n3          able             1             441            11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n4          able             1             479       Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n6          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n7          anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n8          anti             1             735          Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n10        ation             1             213             8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n11        ation             1             421      12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n12        ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n13        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n14          bar             1             147        Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n15          bar             1             175             4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n16          bar             1             200            Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n17          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n18          bar             1             582   Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n        ,s_suite_number\n        ,s_city\n        ,s_county\n        ,s_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST , \"S_STATE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" , \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" , \"S_CITY\" , \"S_COUNTY\" , \"S_STATE\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n1          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n2          able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n3          able             1             441            11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n4          able             1             479       Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n6          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n7          anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n8          anti             1             735          Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n10        ation             1             213             8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n11        ation             1             421      12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n12        ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n13        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n14          bar             1             147        Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n15          bar             1             175             4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n16          bar             1             200            Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n17          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n18          bar             1             582   Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022648,
                    "execution_time": 0.008211,
                    "compile_time": 0.000108,
                    "planning_time": 0.006743
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.059199,
                    "execution_time": 0.00902,
                    "compile_time": 9.8e-05,
                    "planning_time": 0.042473
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST, \"S_STREET_TYPE\" NULLS LAST, \"S_SUITE_NUMBER\" NULLS LAST, \"S_CITY\" NULLS LAST, \"S_COUNTY\" NULLS LAST, \"S_STATE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST , \"S_STATE\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n1          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n2          able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n3          able             1             441            11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n4          able             1             479       Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n6          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n7          anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n8          anti             1             735          Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n10        ation             1             213             8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n11        ation             1             421      12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n12        ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n13        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n14          bar             1             147        Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n15          bar             1             175             4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n16          bar             1             200            Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n17          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n18          bar             1             582   Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n        ,s_suite_number\n        ,s_city\n        ,s_county\n        ,s_state\n        ,s_zip\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST , \"S_STATE\" NULLS LAST , \"S_ZIP\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" , \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" , \"S_CITY\" , \"S_COUNTY\" , \"S_STATE\" , \"S_ZIP\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n1          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n2          able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n3          able             1             441            11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n4          able             1             479       Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n6          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n7          anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n8          anti             1             735          Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n10        ation             1             213             8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n11        ation             1             421      12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n12        ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n13        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n14          bar             1             147        Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n15          bar             1             175             4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n16          bar             1             200            Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n17          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n18          bar             1             582   Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022899,
                    "execution_time": 0.008746,
                    "compile_time": 0.0001,
                    "planning_time": 0.00667
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058649,
                    "execution_time": 0.008423,
                    "compile_time": 0.000101,
                    "planning_time": 0.042373
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST, \"S_STREET_TYPE\" NULLS LAST, \"S_SUITE_NUMBER\" NULLS LAST, \"S_CITY\" NULLS LAST, \"S_COUNTY\" NULLS LAST, \"S_STATE\" NULLS LAST, \"S_ZIP\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST , \"S_STATE\" NULLS LAST , \"S_ZIP\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n1          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n2          able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n3          able             1             441            11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n4          able             1             479       Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n6          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n7          anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n8          anti             1             735          Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n10        ation             1             213             8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n11        ation             1             421      12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n12        ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n13        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n14          bar             1             147        Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n15          bar             1             175             4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n16          bar             1             200            Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n17          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n18          bar             1             582   Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n...*/"
    },
    {
        "input": "-- start template query50.tpl query 60 in stream 0\nselect /* TPC-DS query50.tpl 0.60 */  \n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 30) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 60) and \n                 (sr_returned_date_sk - ss_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk > 90) and\n                 (sr_returned_date_sk - ss_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (sr_returned_date_sk - ss_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   store_sales\n  ,store_returns\n  ,store\n  ,date_dim d1\n  ,date_dim d2\nwhere\n    d2.d_year = 2000\nand d2.d_moy  = 8\nand ss_ticket_number = sr_ticket_number\nand ss_item_sk = sr_item_sk\nand ss_sold_date_sk   = d1.d_date_sk\nand sr_returned_date_sk   = d2.d_date_sk\nand ss_customer_sk = sr_customer_sk\nand ss_store_sk = s_store_sk\ngroup by\n   s_store_name\n  ,s_company_id\n  ,s_street_number\n  ,s_street_name\n  ,s_street_type\n  ,s_suite_number\n  ,s_city\n  ,s_county\n  ,s_state\n  ,s_zip\norder by s_store_name\n        ,s_company_id\n        ,s_street_number\n        ,s_street_name\n        ,s_street_type\n        ,s_suite_number\n        ,s_city\n        ,s_county\n        ,s_state\n        ,s_zip\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE\".\"S_ZIP\" AS \"S_ZIP\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\" , \"STORE\".\"S_COMPANY_ID\" , \"STORE\".\"S_STREET_NUMBER\" , \"STORE\".\"S_STREET_NAME\" , \"STORE\".\"S_STREET_TYPE\" , \"STORE\".\"S_SUITE_NUMBER\" , \"STORE\".\"S_CITY\" , \"STORE\".\"S_COUNTY\" , \"STORE\".\"S_STATE\" , \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST , \"S_STATE\" NULLS LAST , \"S_ZIP\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" , \"S_COMPANY_ID\" , \"S_STREET_NUMBER\" , \"S_STREET_NAME\" , \"S_STREET_TYPE\" , \"S_SUITE_NUMBER\" , \"S_CITY\" , \"S_COUNTY\" , \"S_STATE\" , \"S_ZIP\" LIMIT 21",
                "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n1          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n2          able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n3          able             1             441            11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n4          able             1             479       Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n6          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n7          anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n8          anti             1             735          Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n10        ation             1             213             8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n11        ation             1             421      12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n12        ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n13        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n14          bar             1             147        Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n15          bar             1             175             4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n16          bar             1             200            Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n17          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n18          bar             1             582   Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.02251,
                    "execution_time": 0.008253,
                    "compile_time": 0.0001,
                    "planning_time": 0.00666
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.023663,
                    "execution_time": 0.009133,
                    "compile_time": 9.7e-05,
                    "planning_time": 0.006768
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\" AS \"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\" AS \"S_CITY\", \"STORE\".\"S_COUNTY\" AS \"S_COUNTY\", \"STORE\".\"S_STATE\" AS \"S_STATE\", \"STORE\".\"S_ZIP\" AS \"S_ZIP\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 60 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 90 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" <= 120 AND \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" - \"STORE_SALES\".\"SS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" AND \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"D2\".\"D_MOY\" = 8 AND \"D2\".\"D_YEAR\" = 2000 GROUP BY \"STORE\".\"S_STORE_NAME\", \"STORE\".\"S_COMPANY_ID\", \"STORE\".\"S_STREET_NUMBER\", \"STORE\".\"S_STREET_NAME\", \"STORE\".\"S_STREET_TYPE\", \"STORE\".\"S_SUITE_NUMBER\", \"STORE\".\"S_CITY\", \"STORE\".\"S_COUNTY\", \"STORE\".\"S_STATE\", \"STORE\".\"S_ZIP\" ORDER BY \"S_STORE_NAME\" NULLS LAST, \"S_COMPANY_ID\" NULLS LAST, \"S_STREET_NUMBER\" NULLS LAST, \"S_STREET_NAME\" NULLS LAST, \"S_STREET_TYPE\" NULLS LAST, \"S_SUITE_NUMBER\" NULLS LAST, \"S_CITY\" NULLS LAST, \"S_COUNTY\" NULLS LAST, \"S_STATE\" NULLS LAST, \"S_ZIP\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COMPANY_ID\" AS \"S_COMPANY_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NUMBER\" AS \"S_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_NAME\" AS \"S_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STREET_TYPE\" AS \"S_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_SUITE_NUMBER\" AS \"S_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" AS \"S_CITY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_COUNTY\" AS \"S_COUNTY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_ZIP\" AS \"S_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"S_COMPANY_ID\" NULLS LAST , \"S_STREET_NUMBER\" NULLS LAST , \"S_STREET_NAME\" NULLS LAST , \"S_STREET_TYPE\" NULLS LAST , \"S_SUITE_NUMBER\" NULLS LAST , \"S_CITY\" NULLS LAST , \"S_COUNTY\" NULLS LAST , \"S_STATE\" NULLS LAST , \"S_ZIP\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   s_store_name  s_company_id s_street_number    s_street_name s_street_type s_suite_number         s_city           s_county s_state  s_zip  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          able             1             228          Cherry         Avenue        Suite G       Fairview      Walker County      AL  35709       96          56          76           61          113\n1          able             1             255        Sycamore            Dr.      Suite 410         Midway     Ziebach County      SD  51904       96          61          63           73          138\n2          able             1             302   Walnut Madison            Wy        Suite T       Fairview     Ziebach County      SD  55709       97          53          59           64          140\n3          able             1             441            11th             ST        Suite H      Riverside  Williamson County      TN  39231      104          75          56           60          142\n4          able             1             479       Park First          Lane       Suite 20      Oak Grove      Walker County      AL  38370      109          64          74           68          103\n5          able             1             543         West Elm            Ln        Suite A    Five Points      Walker County      AL  36098       97          59          67           50          128\n6          able             1             722  Railroad Spring           Ct.        Suite M    Five Points     Ziebach County      SD  56098       79          68          66           79          129\n7          anti             1             321            11th        Parkway        Suite G  Pleasant Hill      Walker County      AL  33604      103          55          78           56          122\n8          anti             1             735          Walnut           Blvd      Suite 360    Five Points      Walker County      AL  36098       92          64          63           48          139\n9          anti             1             897          Ash Oak        Circle        Suite T      Oak Grove  Williamson County      TN  38370      112          72          62           65          110\n10        ation             1             213             8th           Road      Suite 490  Pleasant Hill  Williamson County      TN  33604       91          63          69           81          126\n11        ation             1             421      12th Center        Avenue        Suite J      Riverside  Williamson County      TN  39231       88          68          60           63          116\n12        ation             1               8      Cedar Maple            ST      Suite 320      Oak Grove  Williamson County      TN  38370       81          63          67           50          134\n13        ation             1             811             Lee         Circle        Suite T      Oak Grove     Ziebach County      SD  58370       96          57          63           55          132\n14          bar             1             147        Highland             Ln      Suite 270       Fairview     Ziebach County      SD  55709       87          57          57           59          136\n15          bar             1             175             4th          Court        Suite C      Oak Grove  Williamson County      TN  38370       84          51          72           58          156\n16          bar             1             200            Lake             RD      Suite 320  Pleasant Hill     Ziebach County      SD  53604       90          67          63           57          133\n17          bar             1             543         Twelfth         Avenue        Suite L      Oak Grove     Ziebach County      SD  58370       93          71          65           60          123\n18          bar             1             582   Oak Washington         Drive        Suite S  Pleasant Hill      Walker County      AL  33604      100          61          82           53          122\n...*/"
    }
]