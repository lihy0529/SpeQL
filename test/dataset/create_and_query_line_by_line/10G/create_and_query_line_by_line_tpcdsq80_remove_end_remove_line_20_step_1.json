[
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + INTERVAL '30' day) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n/*CURSOR_IDENTIFIER*/\n                ) AS sales_data\nGROUP BY channel, id",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-09-25' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , SUM ( \"SSR\".\"SALES\" ) AS \"SALES\" , SUM ( \"SSR\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SSR\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" GROUP BY 'store channel' , 'store' || \"SSR\".\"STORE_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-09-25' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.084822,
                    "execution_time": 0.030799,
                    "compile_time": 0.00027,
                    "planning_time": 0.028151,
                    "create_size": 5
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.1468,
                    "execution_time": 0.031471,
                    "compile_time": 0.000242,
                    "planning_time": 0.088999,
                    "create_size": 5
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.093784,
                    "execution_time": 0.042685,
                    "compile_time": 0.000243,
                    "planning_time": 0.024598,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.165665,
                    "execution_time": 0.04772,
                    "compile_time": 0.000244,
                    "planning_time": 0.088675,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.08425,
                    "execution_time": 0.032036,
                    "compile_time": 0.000234,
                    "planning_time": 0.028877,
                    "create_size": 20
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.162662,
                    "execution_time": 0.035028,
                    "compile_time": 0.000234,
                    "planning_time": 0.100417,
                    "create_size": 20
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.270317,
                    "execution_time": 0.152869,
                    "compile_time": 0.017399,
                    "planning_time": 0.063395,
                    "create_size": 301
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.840116,
                    "execution_time": 0.159483,
                    "compile_time": 3.510089,
                    "planning_time": 0.128102,
                    "create_size": 301
                }
            }
        ],
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + INTERVAL '30 DAY' ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + INTERVAL '30 DAY' ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + INTERVAL '30 DAY' ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WEB_SITE_ID ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR ) AS SALES_DATA GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*          channel                     id       sales  returns1     profit\n0   store channel  storeAAAAAAAADBAAAAAA  1301751.99  90905.15 -574603.57\n1   store channel  storeAAAAAAAAJBAAAAAA  1232648.37  51876.68 -545371.94\n2   store channel  storeAAAAAAAAKAAAAAAA  1264178.38  45521.19 -537927.04\n3   store channel  storeAAAAAAAAODAAAAAA  1075207.75  60305.13 -459002.22\n4   store channel  storeAAAAAAAAACAAAAAA  1269655.79  61355.26 -557579.95\n5   store channel  storeAAAAAAAAEBAAAAAA  1186682.21  61319.67 -630666.46\n6   store channel  storeAAAAAAAAGBAAAAAA  1214955.29  42824.52 -568094.43\n7   store channel  storeAAAAAAAAMCAAAAAA  1207122.50  56279.46 -527775.44\n8   store channel  storeAAAAAAAABGAAAAAA  1360666.43  64307.99 -548539.65\n9   store channel  storeAAAAAAAAPEAAAAAA  1111995.13  37108.14 -556932.08\n10  store channel  storeAAAAAAAACFAAAAAA  1086978.13  64679.26 -608931.08\n11  store channel  storeAAAAAAAAFCAAAAAA  1260112.61  56953.69 -523780.79\n12  store channel  storeAAAAAAAANAAAAAAA  1341224.47  49914.83 -624562.78\n13  store channel  storeAAAAAAAAIAAAAAAA  1311588.36  54764.64 -482303.96\n14  store channel  storeAAAAAAAAFFAAAAAA  1338779.88  77005.02 -662091.96\n15  store channel  storeAAAAAAAAGFAAAAAA  1206356.47  56820.60 -614631.56\n16  store channel  storeAAAAAAAANDAAAAAA  1196198.71  64899.13 -583528.69\n17  store channel  storeAAAAAAAAMBAAAAAA  1162860.28  64812.18 -541825.15\n18  store channel  storeAAAAAAAALFAAAAAA  1063431.50  32178.01 -535105.76\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.14459,
                    "execution_time": 0.034844,
                    "compile_time": 0.000386,
                    "planning_time": 0.086758
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.138674,
                    "execution_time": 0.036399,
                    "compile_time": 0.000396,
                    "planning_time": 0.075867
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SPEQLITE_TEMP_TABLE_4\".\"STORE_ID\" AS \"ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"SALES\" ) AS \"SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY 'store channel' , 'store' || \"SPEQLITE_TEMP_TABLE_4\".\"STORE_ID\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*          channel                     id       sales  returns1     profit\n0   store channel  storeAAAAAAAADBAAAAAA  1301751.99  90905.15 -574603.57\n1   store channel  storeAAAAAAAAJBAAAAAA  1232648.37  51876.68 -545371.94\n2   store channel  storeAAAAAAAAKAAAAAAA  1264178.38  45521.19 -537927.04\n3   store channel  storeAAAAAAAAODAAAAAA  1075207.75  60305.13 -459002.22\n4   store channel  storeAAAAAAAAACAAAAAA  1269655.79  61355.26 -557579.95\n5   store channel  storeAAAAAAAAEBAAAAAA  1186682.21  61319.67 -630666.46\n6   store channel  storeAAAAAAAAGBAAAAAA  1214955.29  42824.52 -568094.43\n7   store channel  storeAAAAAAAAMCAAAAAA  1207122.50  56279.46 -527775.44\n8   store channel  storeAAAAAAAABGAAAAAA  1360666.43  64307.99 -548539.65\n9   store channel  storeAAAAAAAAPEAAAAAA  1111995.13  37108.14 -556932.08\n10  store channel  storeAAAAAAAACFAAAAAA  1086978.13  64679.26 -608931.08\n11  store channel  storeAAAAAAAAFCAAAAAA  1260112.61  56953.69 -523780.79\n12  store channel  storeAAAAAAAANAAAAAAA  1341224.47  49914.83 -624562.78\n13  store channel  storeAAAAAAAAIAAAAAAA  1311588.36  54764.64 -482303.96\n14  store channel  storeAAAAAAAAFFAAAAAA  1338779.88  77005.02 -662091.96\n15  store channel  storeAAAAAAAAGFAAAAAA  1206356.47  56820.60 -614631.56\n16  store channel  storeAAAAAAAANDAAAAAA  1196198.71  64899.13 -583528.69\n17  store channel  storeAAAAAAAAMBAAAAAA  1162860.28  64812.18 -541825.15\n18  store channel  storeAAAAAAAALFAAAAAA  1063431.50  32178.01 -535105.76\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s.s_store_sk                                  AS store_id, \n                                Sum(ss.ss_ext_sales_price)                    AS sales, \n                                Sum(COALESCE(sr.sr_return_amt, 0))            AS returns1, \n                                Sum(ss.ss_net_profit - COALESCE(sr.sr_net_loss, 0)) AS profit \n                FROM            store_sales ss \n                LEFT OUTER JOIN store_returns sr \n                ON              ( \n                                                ss.ss_item_sk = sr.sr_item_sk \n                                AND             ss.ss_ticket_number = sr.sr_ticket_number)\n                JOIN            date_dim d ON ss.ss_sold_date_sk = d.d_date_sk\n                JOIN            store s ON ss.ss_store_sk = s.s_store_sk\n                JOIN            item i ON ss.ss_item_sk = i.i_item_sk\n                JOIN            promotion p ON ss.ss_promo_sk = p.p_promo_sk \n                WHERE           d.d_date BETWEEN Cast('2000-08-26' AS DATE) AND DATEADD(day, 30, Cast('2000-08-26' AS DATE))\n                AND             i.i_current_price > 50 \n                AND             p.p_channel_tv = 'N' \n                GROUP BY        s.s_store_sk) , csr AS \n( \n                SELECT          cp.cp_catalog_page_id                         AS catalog_page_id, \n                                sum(cs.cs_ext_sales_price)                    AS sales, \n                                sum(COALESCE(cr.cr_return_amount, 0))         AS returns1, \n                                sum(cs.cs_net_profit - COALESCE(cr.cr_net_loss, 0)) AS profit \n                FROM            catalog_sales cs \n                LEFT OUTER JOIN catalog_returns cr \n                ON              ( \n                                                cs.cs_item_sk = cr.cr_item_sk \n                                AND             cs.cs_order_number = cr.cr_order_number)\n                JOIN            date_dim d ON cs.cs_sold_date_sk = d.d_date_sk\n                JOIN            catalog_page cp ON cs.cs_catalog_page_sk = cp.cp_catalog_page_sk\n                JOIN            item i ON cs.cs_item_sk = i.i_item_sk\n                JOIN            promotion p ON cs.cs_promo_sk = p.p_promo_sk \n                WHERE           d.d_date BETWEEN cast('2000-08-26' AS date) AND DATEADD(day, 30, Cast('2000-08-26' AS DATE)) \n                AND             i.i_current_price > 50 \n                AND             p.p_channel_tv = 'N' \n                GROUP BY        cp.cp_catalog_page_id) , wsr AS \n( \n                SELECT          ws1.web_site_sk AS web_site_id, \n                                sum(ws.ws_ext_sales_price)                    AS sales, \n                                sum(COALESCE(wr.wr_return_amt, 0))            AS returns1, \n                                sum(ws.ws_net_profit - COALESCE(wr.wr_net_loss, 0)) AS profit \n                FROM            web_sales ws \n                LEFT OUTER JOIN web_returns wr \n                ON              ( \n                                                ws.ws_item_sk = wr.wr_item_sk \n                                AND             ws.ws_order_number = wr.wr_order_number)\n                JOIN            date_dim d ON ws.ws_sold_date_sk = d.d_date_sk\n                JOIN            web_site ws1 ON ws.ws_web_site_sk = ws1.web_site_sk\n                JOIN            item i ON ws.ws_item_sk = i.i_item_sk\n                JOIN            promotion p ON ws.ws_promo_sk = p.p_promo_sk \n                WHERE           d.d_date BETWEEN cast('2000-08-26' AS date) AND DATEADD(day, 30, Cast('2000-08-26' AS DATE)) \n                AND             i.i_current_price > 50 \n                AND             p.p_channel_tv = 'N' \n                GROUP BY        ws1.web_site_sk) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel,\n                       'catalog' || catalog_page_id AS id,\n                       sales,\n                       returns1,\n                       profit\n                FROM   csr \n                UNION ALL\n                SELECT 'web channel' AS channel,\n                       'web' || web_site_id AS id,\n                       sales,\n                       returns1,\n                       profit\n                FROM   wsr \n         ) AS combined_results\nGROUP BY channel, id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"D\" AS ( SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"D\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"I\" AS ( SELECT \"I\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"I\" WHERE \"I\".\"I_CURRENT_PRICE\" > 50 ) , \"P\" AS ( SELECT \"P\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"P\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"P\" WHERE \"P\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"S\".\"S_STORE_SK\" AS \"STORE_ID\" , SUM ( \"SS\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"SR\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"SS\".\"SS_NET_PROFIT\" - COALESCE ( \"SR\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" JOIN \"I\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"SS\".\"SS_ITEM_SK\" JOIN \"P\" AS \"P\" ON \"P\".\"P_PROMO_SK\" = \"SS\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"S\" ON \"S\".\"S_STORE_SK\" = \"SS\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"SR\" ON \"SR\".\"SR_ITEM_SK\" = \"SS\".\"SS_ITEM_SK\" AND \"SR\".\"SR_TICKET_NUMBER\" = \"SS\".\"SS_TICKET_NUMBER\" GROUP BY \"S\".\"S_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CP\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CR\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CS\".\"CS_NET_PROFIT\" - COALESCE ( \"CR\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"CATALOG_PAGE\" AS \"CP\" ON \"CP\".\"CP_CATALOG_PAGE_SK\" = \"CS\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CR\" ON \"CR\".\"CR_ITEM_SK\" = \"CS\".\"CS_ITEM_SK\" AND \"CR\".\"CR_ORDER_NUMBER\" = \"CS\".\"CS_ORDER_NUMBER\" JOIN \"D\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\" JOIN \"I\" AS \"I\" ON \"CS\".\"CS_ITEM_SK\" = \"I\".\"I_ITEM_SK\" JOIN \"P\" AS \"P\" ON \"CS\".\"CS_PROMO_SK\" = \"P\".\"P_PROMO_SK\" GROUP BY \"CP\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WS1\".\"WEB_SITE_SK\" AS \"WEB_SITE_ID\" , SUM ( \"WS\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WR\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WS\".\"WS_NET_PROFIT\" - COALESCE ( \"WR\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" JOIN \"I\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"WS\".\"WS_ITEM_SK\" JOIN \"P\" AS \"P\" ON \"P\".\"P_PROMO_SK\" = \"WS\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WR\" ON \"WR\".\"WR_ITEM_SK\" = \"WS\".\"WS_ITEM_SK\" AND \"WR\".\"WR_ORDER_NUMBER\" = \"WS\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WS1\" ON \"WS\".\"WS_WEB_SITE_SK\" = \"WS1\".\"WEB_SITE_SK\" GROUP BY \"WS1\".\"WEB_SITE_SK\" ) , \"COMBINED_RESULTS\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"COMBINED_RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\" AS \"ID\" , SUM ( \"COMBINED_RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"COMBINED_RESULTS\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"COMBINED_RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"COMBINED_RESULTS\" AS \"COMBINED_RESULTS\" GROUP BY \"COMBINED_RESULTS\".\"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S.S_STORE_SK AS STORE_ID , SUM ( SS.SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR.SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS.SS_NET_PROFIT - COALESCE ( SR.SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES AS SS LEFT OUTER JOIN STORE_RETURNS AS SR ON ( SS.SS_ITEM_SK = SR.SR_ITEM_SK AND SS.SS_TICKET_NUMBER = SR.SR_TICKET_NUMBER ) JOIN DATE_DIM AS D ON SS.SS_SOLD_DATE_SK = D.D_DATE_SK JOIN STORE AS S ON SS.SS_STORE_SK = S.S_STORE_SK JOIN ITEM AS I ON SS.SS_ITEM_SK = I.I_ITEM_SK JOIN PROMOTION AS P ON SS.SS_PROMO_SK = P.P_PROMO_SK WHERE D.D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND I.I_CURRENT_PRICE > 50 AND P.P_CHANNEL_TV = 'N' GROUP BY S.S_STORE_SK ) , CSR AS ( SELECT CP.CP_CATALOG_PAGE_ID AS CATALOG_PAGE_ID , SUM ( CS.CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR.CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS.CS_NET_PROFIT - COALESCE ( CR.CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES AS CS LEFT OUTER JOIN CATALOG_RETURNS AS CR ON ( CS.CS_ITEM_SK = CR.CR_ITEM_SK AND CS.CS_ORDER_NUMBER = CR.CR_ORDER_NUMBER ) JOIN DATE_DIM AS D ON CS.CS_SOLD_DATE_SK = D.D_DATE_SK JOIN CATALOG_PAGE AS CP ON CS.CS_CATALOG_PAGE_SK = CP.CP_CATALOG_PAGE_SK JOIN ITEM AS I ON CS.CS_ITEM_SK = I.I_ITEM_SK JOIN PROMOTION AS P ON CS.CS_PROMO_SK = P.P_PROMO_SK WHERE D.D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND I.I_CURRENT_PRICE > 50 AND P.P_CHANNEL_TV = 'N' GROUP BY CP.CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WS1.WEB_SITE_SK AS WEB_SITE_ID , SUM ( WS.WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR.WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS.WS_NET_PROFIT - COALESCE ( WR.WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES AS WS LEFT OUTER JOIN WEB_RETURNS AS WR ON ( WS.WS_ITEM_SK = WR.WR_ITEM_SK AND WS.WS_ORDER_NUMBER = WR.WR_ORDER_NUMBER ) JOIN DATE_DIM AS D ON WS.WS_SOLD_DATE_SK = D.D_DATE_SK JOIN WEB_SITE AS WS1 ON WS.WS_WEB_SITE_SK = WS1.WEB_SITE_SK JOIN ITEM AS I ON WS.WS_ITEM_SK = I.I_ITEM_SK JOIN PROMOTION AS P ON WS.WS_PROMO_SK = P.P_PROMO_SK WHERE D.D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND I.I_CURRENT_PRICE > 50 AND P.P_CHANNEL_TV = 'N' GROUP BY WS1.WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS COMBINED_RESULTS GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                       id       sales  returns1     profit\n0     store channel                  store55  1226455.55  67870.18 -551178.96\n1   catalog channel  catalogAAAAAAAAEBABAAAA   283878.55   6789.53   15643.78\n2   catalog channel  catalogAAAAAAAACBABAAAA   203427.41  26959.06  -43274.61\n3   catalog channel  catalogAAAAAAAALNABAAAA   111586.81   9945.52  -11726.60\n4   catalog channel  catalogAAAAAAAAHDABAAAA   234734.26  11407.55   16973.79\n5   catalog channel  catalogAAAAAAAAEKABAAAA    86559.85   3380.48  -16828.31\n6   catalog channel  catalogAAAAAAAADJABAAAA   125678.82  10761.84   15024.63\n7   catalog channel  catalogAAAAAAAAFBABAAAA   204302.77  38649.58    1376.40\n8   catalog channel  catalogAAAAAAAAPKCBAAAA     8963.16      0.00   -8674.65\n9   catalog channel  catalogAAAAAAAAKNCBAAAA    28174.92     71.76  -26212.80\n10  catalog channel  catalogAAAAAAAAELCBAAAA    35430.74      0.00   -8449.24\n11    store channel                   store4  1157927.77  59461.70 -490195.74\n12  catalog channel  catalogAAAAAAAAKIABAAAA    83484.69  13527.06  -11523.81\n13  catalog channel  catalogAAAAAAAAKMABAAAA   125134.40   8218.48  -27600.08\n14  catalog channel  catalogAAAAAAAALEABAAAA   158087.42   1403.81  -44956.17\n15  catalog channel  catalogAAAAAAAAMBABAAAA   199704.67  13385.34  -28106.33\n16  catalog channel  catalogAAAAAAAAOGABAAAA   193508.03  10804.12  -17005.32\n17  catalog channel  catalogAAAAAAAAJPCBAAAA    42081.41  12923.19    -514.76\n18  catalog channel  catalogAAAAAAAAILABAAAA   123385.75  18626.48   -1719.78\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.349515,
                    "execution_time": 0.092939,
                    "compile_time": 0.001097,
                    "planning_time": 0.205859
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.167107,
                    "execution_time": 0.673125,
                    "compile_time": 0.104061,
                    "planning_time": 0.338948
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                       id       sales  returns1     profit\n0     store channel                  store55  1226455.55  67870.18 -551178.96\n1   catalog channel  catalogAAAAAAAAEBABAAAA   283878.55   6789.53   15643.78\n2   catalog channel  catalogAAAAAAAACBABAAAA   203427.41  26959.06  -43274.61\n3   catalog channel  catalogAAAAAAAALNABAAAA   111586.81   9945.52  -11726.60\n4   catalog channel  catalogAAAAAAAAHDABAAAA   234734.26  11407.55   16973.79\n5   catalog channel  catalogAAAAAAAAEKABAAAA    86559.85   3380.48  -16828.31\n6   catalog channel  catalogAAAAAAAADJABAAAA   125678.82  10761.84   15024.63\n7   catalog channel  catalogAAAAAAAAFBABAAAA   204302.77  38649.58    1376.40\n8   catalog channel  catalogAAAAAAAAPKCBAAAA     8963.16      0.00   -8674.65\n9   catalog channel  catalogAAAAAAAAKNCBAAAA    28174.92     71.76  -26212.80\n10  catalog channel  catalogAAAAAAAAELCBAAAA    35430.74      0.00   -8449.24\n11    store channel                   store4  1157927.77  59461.70 -490195.74\n12  catalog channel  catalogAAAAAAAAKIABAAAA    83484.69  13527.06  -11523.81\n13  catalog channel  catalogAAAAAAAAKMABAAAA   125134.40   8218.48  -27600.08\n14  catalog channel  catalogAAAAAAAALEABAAAA   158087.42   1403.81  -44956.17\n15  catalog channel  catalogAAAAAAAAMBABAAAA   199704.67  13385.34  -28106.33\n16  catalog channel  catalogAAAAAAAAOGABAAAA   193508.03  10804.12  -17005.32\n17  catalog channel  catalogAAAAAAAAJPCBAAAA    42081.41  12923.19    -514.76\n18  catalog channel  catalogAAAAAAAAILABAAAA   123385.75  18626.48   -1719.78\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_sk                                    AS store_id, \n                                Sum(SS_EXT_SALES_PRICE)                       AS sales, \n                                Sum(COALESCE(SR_RETURN_AMT, 0))               AS returns1, \n                                Sum(SS_NET_PROFIT - COALESCE(SR_NET_LOSS, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_sk) , csr AS \n( \n                SELECT          cp_catalog_page_sk                            AS catalog_page_id, \n                                sum(CS_EXT_SALES_PRICE)                       AS sales, \n                                sum(COALESCE(CR_RETURN_AMOUNT, 0))            AS returns1, \n                                sum(CS_NET_PROFIT - COALESCE(CR_NET_LOSS, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_sk) , wsr AS \n( \n                SELECT          ws_web_site_sk AS web_site_id, \n                                sum(WS_EXT_SALES_PRICE)                       AS sales, \n                                sum(COALESCE(WR_RETURN_AMT, 0))               AS returns1, \n                                sum(WS_NET_PROFIT - COALESCE(WR_NET_LOSS, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ws_web_site_sk) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                'catalog' || catalog_page_id AS id , \n                sales , \n                returns1 , \n                profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                'web' || web_site_id AS id , \n                sales , \n                returns1 , \n                profit \n                FROM   wsr \n) AS data\nGROUP BY channel, id\nORDER BY channel, id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" ) , \"WSR\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SALES\".\"WS_WEB_SITE_SK\" ) , \"DATA\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"DATA\".\"CHANNEL\" AS \"CHANNEL\" , \"DATA\".\"ID\" AS \"ID\" , SUM ( \"DATA\".\"SALES\" ) AS \"SALES\" , SUM ( \"DATA\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"DATA\".\"PROFIT\" ) AS \"PROFIT\" FROM \"DATA\" AS \"DATA\" GROUP BY \"DATA\".\"CHANNEL\" , \"DATA\".\"ID\" ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_SK AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_SK ) , CSR AS ( SELECT CP_CATALOG_PAGE_SK AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_SK ) , WSR AS ( SELECT WS_WEB_SITE_SK AS WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WS_WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS DATA GROUP BY CHANNEL , ID ORDER BY CHANNEL NULLS FIRST , ID NULLS FIRST LIMIT 21",
                "preview": "\n/*            channel           id     sales  returns1    profit\n0   catalog channel  catalog4108   4747.47      0.00   1870.72\n1   catalog channel  catalog4109  11569.41      0.00  -2487.20\n2   catalog channel  catalog4110   5141.61      0.00   -230.78\n3   catalog channel  catalog4111   4361.64   2938.59  -8209.67\n4   catalog channel  catalog4113   3702.73      0.00  -4420.74\n5   catalog channel  catalog4114  24315.44  12808.25  12089.58\n6   catalog channel  catalog4115  14602.89    430.40 -15810.71\n7   catalog channel  catalog4116  10349.03      0.00  -1007.96\n8   catalog channel  catalog4117   4621.50      0.00  -1779.82\n9   catalog channel  catalog4118   7604.50      0.00   4118.00\n10  catalog channel  catalog4119   8098.18      0.00  -7732.88\n11  catalog channel  catalog4120  10747.38      0.00   2409.00\n12  catalog channel  catalog4121   3449.22      0.00  -6178.29\n13  catalog channel  catalog4122   1211.38      0.00     48.10\n14  catalog channel  catalog4123   6806.05    433.44   2264.76\n15  catalog channel  catalog4124  11453.54      0.00  -1239.08\n16  catalog channel  catalog4125   5995.80      0.00  -2829.08\n17  catalog channel  catalog4126   1428.55      0.00  -1974.95\n18  catalog channel  catalog4127  12125.18      0.00  -6407.35\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.314352,
                    "execution_time": 0.096908,
                    "compile_time": 0.001127,
                    "planning_time": 0.166911
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.447735,
                    "execution_time": 0.101956,
                    "compile_time": 0.002218,
                    "planning_time": 0.292816
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel           id     sales  returns1    profit\n0   catalog channel  catalog4108   4747.47      0.00   1870.72\n1   catalog channel  catalog4109  11569.41      0.00  -2487.20\n2   catalog channel  catalog4110   5141.61      0.00   -230.78\n3   catalog channel  catalog4111   4361.64   2938.59  -8209.67\n4   catalog channel  catalog4113   3702.73      0.00  -4420.74\n5   catalog channel  catalog4114  24315.44  12808.25  12089.58\n6   catalog channel  catalog4115  14602.89    430.40 -15810.71\n7   catalog channel  catalog4116  10349.03      0.00  -1007.96\n8   catalog channel  catalog4117   4621.50      0.00  -1779.82\n9   catalog channel  catalog4118   7604.50      0.00   4118.00\n10  catalog channel  catalog4119   8098.18      0.00  -7732.88\n11  catalog channel  catalog4120  10747.38      0.00   2409.00\n12  catalog channel  catalog4121   3449.22      0.00  -6178.29\n13  catalog channel  catalog4122   1211.38      0.00     48.10\n14  catalog channel  catalog4123   6806.05    433.44   2264.76\n15  catalog channel  catalog4124  11453.54      0.00  -1239.08\n16  catalog channel  catalog4125   5995.80      0.00  -2829.08\n17  catalog channel  catalog4126   1428.55      0.00  -1974.95\n18  catalog channel  catalog4127  12125.18      0.00  -6407.35\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                       || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n) AS combined_results\nGROUP BY channel, id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"COMBINED_RESULTS\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" ) SELECT \"COMBINED_RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\" AS \"ID\" , SUM ( \"COMBINED_RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"COMBINED_RESULTS\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"COMBINED_RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"COMBINED_RESULTS\" AS \"COMBINED_RESULTS\" GROUP BY \"COMBINED_RESULTS\".\"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WEB_SITE_ID ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR ) AS COMBINED_RESULTS GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                            id     sales  returns1    profit\n0   catalog channel  catalog_pageAAAAAAAAAJABAAAA   9644.47     11.24    200.47\n1   catalog channel  catalog_pageAAAAAAAAIMCBAAAA   7502.37      0.00  -1832.52\n2   catalog channel  catalog_pageAAAAAAAAONABAAAA   1159.41      0.00  -2092.41\n3   catalog channel  catalog_pageAAAAAAAANJABAAAA   8084.11   3158.75    492.82\n4   catalog channel  catalog_pageAAAAAAAALGABAAAA   4926.19      0.00   1141.31\n5   catalog channel  catalog_pageAAAAAAAAEFABAAAA   9640.75      0.00   1418.45\n6   catalog channel  catalog_pageAAAAAAAABKABAAAA   8675.16      0.00   1308.06\n7   catalog channel  catalog_pageAAAAAAAAMMCBAAAA   8808.11      0.00   3515.81\n8     store channel         storeAAAAAAAABAAAAAAA  25641.11   1793.92 -20183.95\n9   catalog channel  catalog_pageAAAAAAAAFBABAAAA   4621.50      0.00  -1779.82\n10  catalog channel  catalog_pageAAAAAAAAKNCBAAAA   4478.62      0.00  -4400.67\n11  catalog channel  catalog_pageAAAAAAAALPCBAAAA     39.12      0.00    -69.64\n12  catalog channel  catalog_pageAAAAAAAAELCBAAAA   6896.05      0.00   2419.10\n13    store channel         storeAAAAAAAAMEAAAAAA  33013.22      0.00 -10436.21\n14  catalog channel  catalog_pageAAAAAAAAJPCBAAAA   5004.21      0.00  -1228.46\n15  catalog channel  catalog_pageAAAAAAAACEABAAAA  19686.88      0.00  11152.57\n16  catalog channel  catalog_pageAAAAAAAAIFABAAAA   1231.68    769.80    247.21\n17  catalog channel  catalog_pageAAAAAAAAPHABAAAA  19510.34      0.00   7868.93\n18  catalog channel  catalog_pageAAAAAAAAMLCBAAAA   1206.81      0.00    457.20\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.22417,
                    "execution_time": 0.067552,
                    "compile_time": 0.000747,
                    "planning_time": 0.121583
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.349411,
                    "execution_time": 0.065594,
                    "compile_time": 0.00079,
                    "planning_time": 0.245292
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id     sales  returns1    profit\n0   catalog channel  catalog_pageAAAAAAAAAJABAAAA   9644.47     11.24    200.47\n1   catalog channel  catalog_pageAAAAAAAAIMCBAAAA   7502.37      0.00  -1832.52\n2   catalog channel  catalog_pageAAAAAAAAONABAAAA   1159.41      0.00  -2092.41\n3   catalog channel  catalog_pageAAAAAAAANJABAAAA   8084.11   3158.75    492.82\n4   catalog channel  catalog_pageAAAAAAAALGABAAAA   4926.19      0.00   1141.31\n5   catalog channel  catalog_pageAAAAAAAAEFABAAAA   9640.75      0.00   1418.45\n6   catalog channel  catalog_pageAAAAAAAABKABAAAA   8675.16      0.00   1308.06\n7   catalog channel  catalog_pageAAAAAAAAMMCBAAAA   8808.11      0.00   3515.81\n8     store channel         storeAAAAAAAABAAAAAAA  25641.11   1793.92 -20183.95\n9   catalog channel  catalog_pageAAAAAAAAFBABAAAA   4621.50      0.00  -1779.82\n10  catalog channel  catalog_pageAAAAAAAAKNCBAAAA   4478.62      0.00  -4400.67\n11  catalog channel  catalog_pageAAAAAAAALPCBAAAA     39.12      0.00    -69.64\n12  catalog channel  catalog_pageAAAAAAAAELCBAAAA   6896.05      0.00   2419.10\n13    store channel         storeAAAAAAAAMEAAAAAA  33013.22      0.00 -10436.21\n14  catalog channel  catalog_pageAAAAAAAAJPCBAAAA   5004.21      0.00  -1228.46\n15  catalog channel  catalog_pageAAAAAAAACEABAAAA  19686.88      0.00  11152.57\n16  catalog channel  catalog_pageAAAAAAAAIFABAAAA   1231.68    769.80    247.21\n17  catalog channel  catalog_pageAAAAAAAAPHABAAAA  19510.34      0.00   7868.93\n18  catalog channel  catalog_pageAAAAAAAAMLCBAAAA   1206.81      0.00    457.20\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_sk                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(DAY, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_sk) , csr AS \n( \n                SELECT          cp_catalog_page_sk                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(DAY, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_sk) , wsr AS \n( \n                SELECT          ws_web_site_sk AS web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(DAY, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ws_web_site_sk) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr\n                UNION ALL\n                SELECT 'web channel' AS channel,\n                       'web_site' \n                              || web_site_id AS id,\n                       sales,\n                       returns1,\n                       profit\n                FROM   wsr\n) AS combined\nGROUP BY channel, id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" ) , \"WSR\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SALES\".\"WS_WEB_SITE_SK\" ) , \"COMBINED\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"COMBINED\".\"CHANNEL\" AS \"CHANNEL\" , \"COMBINED\".\"ID\" AS \"ID\" , SUM ( \"COMBINED\".\"SALES\" ) AS \"SALES\" , SUM ( \"COMBINED\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"COMBINED\".\"PROFIT\" ) AS \"PROFIT\" FROM \"COMBINED\" AS \"COMBINED\" GROUP BY \"COMBINED\".\"CHANNEL\" , \"COMBINED\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_SK AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_SK ) , CSR AS ( SELECT CP_CATALOG_PAGE_SK AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_SK ) , WSR AS ( SELECT WS_WEB_SITE_SK AS WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WS_WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS COMBINED GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                id     sales  returns1    profit\n0   catalog channel  catalog_page4123   6806.05    433.44   2264.76\n1   catalog channel  catalog_page4134  16601.85      0.00   8786.38\n2   catalog channel  catalog_page4186  11156.17      0.00  -7401.76\n3   catalog channel  catalog_page4826   4478.62      0.00  -4400.67\n4       web channel        web_site11  38132.15    995.85   6923.87\n5     store channel           store38  41461.61   1445.72 -28250.53\n6   catalog channel  catalog_page4775    355.62      0.00     92.94\n7   catalog channel  catalog_page4283      0.00      0.00  -8042.93\n8   catalog channel  catalog_page4819   3518.82   2992.20    556.60\n9   catalog channel  catalog_page4117   4621.50      0.00  -1779.82\n10  catalog channel  catalog_page4224    430.70      0.00  -5115.11\n11  catalog channel  catalog_page4314   1456.66      0.00    361.48\n12  catalog channel  catalog_page4284     26.94      0.00    -96.46\n13  catalog channel  catalog_page4863   4035.96      0.00  -2099.38\n14  catalog channel  catalog_page4789  10339.20      0.00 -10771.68\n15  catalog channel  catalog_page4237   1206.97      0.00  -2709.60\n16  catalog channel  catalog_page4319    823.69      0.00   -591.43\n17  catalog channel  catalog_page4285  14692.00   3305.70   6405.82\n18  catalog channel  catalog_page4322   4807.67    873.18  -1990.16\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.320757,
                    "execution_time": 0.098686,
                    "compile_time": 0.001092,
                    "planning_time": 0.172352
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.446821,
                    "execution_time": 0.100305,
                    "compile_time": 0.001152,
                    "planning_time": 0.29427
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                id     sales  returns1    profit\n0   catalog channel  catalog_page4123   6806.05    433.44   2264.76\n1   catalog channel  catalog_page4134  16601.85      0.00   8786.38\n2   catalog channel  catalog_page4186  11156.17      0.00  -7401.76\n3   catalog channel  catalog_page4826   4478.62      0.00  -4400.67\n4       web channel        web_site11  38132.15    995.85   6923.87\n5     store channel           store38  41461.61   1445.72 -28250.53\n6   catalog channel  catalog_page4775    355.62      0.00     92.94\n7   catalog channel  catalog_page4283      0.00      0.00  -8042.93\n8   catalog channel  catalog_page4819   3518.82   2992.20    556.60\n9   catalog channel  catalog_page4117   4621.50      0.00  -1779.82\n10  catalog channel  catalog_page4224    430.70      0.00  -5115.11\n11  catalog channel  catalog_page4314   1456.66      0.00    361.48\n12  catalog channel  catalog_page4284     26.94      0.00    -96.46\n13  catalog channel  catalog_page4863   4035.96      0.00  -2099.38\n14  catalog channel  catalog_page4789  10339.20      0.00 -10771.68\n15  catalog channel  catalog_page4237   1206.97      0.00  -2709.60\n16  catalog channel  catalog_page4319    823.69      0.00   -591.43\n17  catalog channel  catalog_page4285  14692.00   3305.70   6405.82\n18  catalog channel  catalog_page4322   4807.67    873.18  -1990.16\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr \n) AS combined_results \nGROUP BY channel, id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"COMBINED_RESULTS\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"COMBINED_RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\" AS \"ID\" , SUM ( \"COMBINED_RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"COMBINED_RESULTS\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"COMBINED_RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"COMBINED_RESULTS\" AS \"COMBINED_RESULTS\" GROUP BY \"COMBINED_RESULTS\".\"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WEB_SITE_ID ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS COMBINED_RESULTS GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                            id     sales  returns1    profit\n0   catalog channel  catalog_pageAAAAAAAAONABAAAA   1159.41      0.00  -2092.41\n1   catalog channel  catalog_pageAAAAAAAANJABAAAA   8084.11   3158.75    492.82\n2   catalog channel  catalog_pageAAAAAAAAIMCBAAAA   7502.37      0.00  -1832.52\n3   catalog channel  catalog_pageAAAAAAAAAJABAAAA   9644.47     11.24    200.47\n4     store channel         storeAAAAAAAALCAAAAAA  32968.31   5982.66  -7444.36\n5     store channel         storeAAAAAAAAIDAAAAAA  72876.64   5791.10 -39490.10\n6   catalog channel  catalog_pageAAAAAAAAMIABAAAA  13622.90      0.00    519.96\n7   catalog channel  catalog_pageAAAAAAAAICABAAAA   7262.49      0.00  -2486.79\n8   catalog channel  catalog_pageAAAAAAAAAIABAAAA    430.70      0.00  -5115.11\n9   catalog channel  catalog_pageAAAAAAAAANCBAAAA  25108.54      0.00   -180.38\n10  catalog channel  catalog_pageAAAAAAAAEMABAAAA   6246.92      0.00   1411.74\n11      web channel           webAAAAAAAAEAAAAAAA  36704.43   1237.49  -7825.69\n12  catalog channel  catalog_pageAAAAAAAAEFABAAAA   9640.75      0.00   1418.45\n13  catalog channel  catalog_pageAAAAAAAALGABAAAA   4926.19      0.00   1141.31\n14  catalog channel  catalog_pageAAAAAAAABKABAAAA   8675.16      0.00   1308.06\n15  catalog channel  catalog_pageAAAAAAAAMMCBAAAA   8808.11      0.00   3515.81\n16  catalog channel  catalog_pageAAAAAAAALJABAAAA    498.75    159.60  -1293.94\n17  catalog channel  catalog_pageAAAAAAAALMABAAAA     22.80      7.60     -7.85\n18  catalog channel  catalog_pageAAAAAAAAACABAAAA    180.00      0.00   -207.90\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.30586,
                    "execution_time": 0.093404,
                    "compile_time": 0.001058,
                    "planning_time": 0.164377
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.439015,
                    "execution_time": 0.096421,
                    "compile_time": 0.00109,
                    "planning_time": 0.291401
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id     sales  returns1    profit\n0   catalog channel  catalog_pageAAAAAAAAONABAAAA   1159.41      0.00  -2092.41\n1   catalog channel  catalog_pageAAAAAAAANJABAAAA   8084.11   3158.75    492.82\n2   catalog channel  catalog_pageAAAAAAAAIMCBAAAA   7502.37      0.00  -1832.52\n3   catalog channel  catalog_pageAAAAAAAAAJABAAAA   9644.47     11.24    200.47\n4     store channel         storeAAAAAAAALCAAAAAA  32968.31   5982.66  -7444.36\n5     store channel         storeAAAAAAAAIDAAAAAA  72876.64   5791.10 -39490.10\n6   catalog channel  catalog_pageAAAAAAAAMIABAAAA  13622.90      0.00    519.96\n7   catalog channel  catalog_pageAAAAAAAAICABAAAA   7262.49      0.00  -2486.79\n8   catalog channel  catalog_pageAAAAAAAAAIABAAAA    430.70      0.00  -5115.11\n9   catalog channel  catalog_pageAAAAAAAAANCBAAAA  25108.54      0.00   -180.38\n10  catalog channel  catalog_pageAAAAAAAAEMABAAAA   6246.92      0.00   1411.74\n11      web channel           webAAAAAAAAEAAAAAAA  36704.43   1237.49  -7825.69\n12  catalog channel  catalog_pageAAAAAAAAEFABAAAA   9640.75      0.00   1418.45\n13  catalog channel  catalog_pageAAAAAAAALGABAAAA   4926.19      0.00   1141.31\n14  catalog channel  catalog_pageAAAAAAAABKABAAAA   8675.16      0.00   1308.06\n15  catalog channel  catalog_pageAAAAAAAAMMCBAAAA   8808.11      0.00   3515.81\n16  catalog channel  catalog_pageAAAAAAAALJABAAAA    498.75    159.60  -1293.94\n17  catalog channel  catalog_pageAAAAAAAALMABAAAA     22.80      7.60     -7.85\n18  catalog channel  catalog_pageAAAAAAAAACABAAAA    180.00      0.00   -207.90\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number) \n                , date_dim, \n                store, \n                item, \n                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number) \n                , date_dim, \n                catalog_page, \n                item, \n                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number) \n                , date_dim, \n                web_site, \n                item, \n                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr \n) AS final_summary \nGROUP BY channel, id \nORDER BY channel, id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"FINAL_SUMMARY\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"FINAL_SUMMARY\".\"CHANNEL\" AS \"CHANNEL\" , \"FINAL_SUMMARY\".\"ID\" AS \"ID\" , SUM ( \"FINAL_SUMMARY\".\"SALES\" ) AS \"SALES\" , SUM ( \"FINAL_SUMMARY\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"FINAL_SUMMARY\".\"PROFIT\" ) AS \"PROFIT\" FROM \"FINAL_SUMMARY\" AS \"FINAL_SUMMARY\" GROUP BY \"FINAL_SUMMARY\".\"CHANNEL\" , \"FINAL_SUMMARY\".\"ID\" ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WEB_SITE_ID ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS FINAL_SUMMARY GROUP BY CHANNEL , ID ORDER BY CHANNEL NULLS FIRST , ID NULLS FIRST LIMIT 21",
                "preview": "\n/*            channel                            id     sales  returns1   profit\n0   catalog channel  catalog_pageAAAAAAAAAADBAAAA   6987.68      0.00  4313.12\n1   catalog channel  catalog_pageAAAAAAAAABDBAAAA   5152.05      0.00 -1679.10\n2   catalog channel  catalog_pageAAAAAAAAACABAAAA    180.00      0.00  -207.90\n3   catalog channel  catalog_pageAAAAAAAAADABAAAA   4845.78      1.20 -1358.51\n4   catalog channel  catalog_pageAAAAAAAAAEABAAAA   2406.45      0.00  -715.71\n5   catalog channel  catalog_pageAAAAAAAAAFABAAAA   3612.08      0.00  -567.88\n6   catalog channel  catalog_pageAAAAAAAAAGABAAAA   7507.10      0.00  1878.05\n7   catalog channel  catalog_pageAAAAAAAAAHABAAAA  14203.80   1021.68  3299.30\n8   catalog channel  catalog_pageAAAAAAAAAIABAAAA    430.70      0.00 -5115.11\n9   catalog channel  catalog_pageAAAAAAAAAJABAAAA   9644.47     11.24   200.47\n10  catalog channel  catalog_pageAAAAAAAAAMABAAAA   3879.34      0.00  1634.56\n11  catalog channel  catalog_pageAAAAAAAAANCBAAAA  25108.54      0.00  -180.38\n12  catalog channel  catalog_pageAAAAAAAAAOABAAAA   5649.92      0.00 -6293.90\n13  catalog channel  catalog_pageAAAAAAAAAPCBAAAA   6047.99      0.00  -608.83\n14  catalog channel  catalog_pageAAAAAAAABBABAAAA   3702.73      0.00 -4420.74\n15  catalog channel  catalog_pageAAAAAAAABBDBAAAA   3519.33      0.00 -3089.91\n16  catalog channel  catalog_pageAAAAAAAABCABAAAA   2730.36   1018.98 -1771.13\n17  catalog channel  catalog_pageAAAAAAAABDABAAAA  13814.04      0.00 -2858.02\n18  catalog channel  catalog_pageAAAAAAAABEABAAAA   1782.72      0.00 -1588.53\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.312779,
                    "execution_time": 0.099074,
                    "compile_time": 0.001074,
                    "planning_time": 0.165798
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.45715,
                    "execution_time": 0.101412,
                    "compile_time": 0.00129,
                    "planning_time": 0.301271
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id     sales  returns1   profit\n0   catalog channel  catalog_pageAAAAAAAAAADBAAAA   6987.68      0.00  4313.12\n1   catalog channel  catalog_pageAAAAAAAAABDBAAAA   5152.05      0.00 -1679.10\n2   catalog channel  catalog_pageAAAAAAAAACABAAAA    180.00      0.00  -207.90\n3   catalog channel  catalog_pageAAAAAAAAADABAAAA   4845.78      1.20 -1358.51\n4   catalog channel  catalog_pageAAAAAAAAAEABAAAA   2406.45      0.00  -715.71\n5   catalog channel  catalog_pageAAAAAAAAAFABAAAA   3612.08      0.00  -567.88\n6   catalog channel  catalog_pageAAAAAAAAAGABAAAA   7507.10      0.00  1878.05\n7   catalog channel  catalog_pageAAAAAAAAAHABAAAA  14203.80   1021.68  3299.30\n8   catalog channel  catalog_pageAAAAAAAAAIABAAAA    430.70      0.00 -5115.11\n9   catalog channel  catalog_pageAAAAAAAAAJABAAAA   9644.47     11.24   200.47\n10  catalog channel  catalog_pageAAAAAAAAAMABAAAA   3879.34      0.00  1634.56\n11  catalog channel  catalog_pageAAAAAAAAANCBAAAA  25108.54      0.00  -180.38\n12  catalog channel  catalog_pageAAAAAAAAAOABAAAA   5649.92      0.00 -6293.90\n13  catalog channel  catalog_pageAAAAAAAAAPCBAAAA   6047.99      0.00  -608.83\n14  catalog channel  catalog_pageAAAAAAAABBABAAAA   3702.73      0.00 -4420.74\n15  catalog channel  catalog_pageAAAAAAAABBDBAAAA   3519.33      0.00 -3089.91\n16  catalog channel  catalog_pageAAAAAAAABCABAAAA   2730.36   1018.98 -1771.13\n17  catalog channel  catalog_pageAAAAAAAABDABAAAA  13814.04      0.00 -2858.02\n18  catalog channel  catalog_pageAAAAAAAABEABAAAA   1782.72      0.00 -1588.53\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n    SELECT          ss_store_sk AS store_id, \n                    Sum(ss_ext_sales_price) AS sales, \n                    Sum(COALESCE(sr_return_amt, 0)) AS returns1, \n                    Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n    FROM            store_sales \n    LEFT OUTER JOIN store_returns \n    ON              ( \n                         ss_item_sk = sr_item_sk \n                AND     ss_ticket_number = sr_ticket_number), \n                    date_dim, \n                    store, \n                    item, \n                    promotion \n    WHERE           ss_sold_date_sk = d_date_sk \n    AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND DATEADD(day, 30, Cast('2000-08-26' AS DATE)) \n    AND             ss_store_sk = s_store_sk \n    AND             ss_item_sk = i_item_sk \n    AND             i_current_price > 50 \n    AND             ss_promo_sk = p_promo_sk \n    AND             P_CHANNEL_TV = 'N' \n    GROUP BY        ss_store_sk) , csr AS \n( \n    SELECT          cs_catalog_page_sk AS catalog_page_id, \n                    sum(cs_ext_sales_price) AS sales, \n                    sum(COALESCE(cr_return_amount, 0)) AS returns1, \n                    sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n    FROM            catalog_sales \n    LEFT OUTER JOIN catalog_returns \n    ON              ( \n                         cs_item_sk = cr_item_sk \n                AND     cs_order_number = cr_order_number), \n                    date_dim, \n                    catalog_page, \n                    item, \n                    promotion \n    WHERE           cs_sold_date_sk = d_date_sk \n    AND             d_date BETWEEN cast('2000-08-26' AS date) AND DATEADD(day, 30, cast('2000-08-26' AS date)) \n    AND             cs_catalog_page_sk = cp_catalog_page_sk \n    AND             cs_item_sk = i_item_sk \n    AND             i_current_price > 50 \n    AND             cs_promo_sk = p_promo_sk \n    AND             P_CHANNEL_TV = 'N' \n    GROUP BY        cs_catalog_page_sk) , wsr AS \n( \n    SELECT          ws_web_site_sk AS web_site_id, \n                    sum(ws_ext_sales_price) AS sales, \n                    sum(COALESCE(wr_return_amt, 0)) AS returns1, \n                    sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n    FROM            web_sales \n    LEFT OUTER JOIN web_returns \n    ON              ( \n                         ws_item_sk = wr_item_sk \n                AND     ws_order_number = wr_order_number), \n                    date_dim, \n                    web_site, \n                    item, \n                    promotion \n    WHERE           ws_sold_date_sk = d_date_sk \n    AND             d_date BETWEEN cast('2000-08-26' AS date) AND DATEADD(day, 30, cast('2000-08-26' AS date)) \n    AND             ws_web_site_sk = web_site_sk \n    AND             ws_item_sk = i_item_sk \n    AND             i_current_price > 50 \n    AND             ws_promo_sk = p_promo_sk \n    AND             P_CHANNEL_TV = 'N' \n    GROUP BY        ws_web_site_sk) \nSELECT\n     channel , \n     id , \n     sum(sales) AS sales , \n     sum(returns1) AS returns1 , \n     sum(profit) AS profit \nFROM     ( \n            SELECT 'store channel' AS channel , \n                   'store' || store_id AS id , \n                   sales , \n                   returns1 , \n                   profit \n            FROM   ssr \n            UNION ALL \n            SELECT 'catalog channel' AS channel , \n                   'catalog_page' || catalog_page_id AS id , \n                   sales , \n                   returns1 , \n                   profit \n            FROM   csr \n            UNION ALL\n            SELECT 'web channel' AS channel,\n                   'web' || web_site_id AS id,\n                   sales,\n                   returns1,\n                   profit\n            FROM   wsr\n         ) sub\nGROUP BY channel, id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" ) , \"WSR\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SALES\".\"WS_WEB_SITE_SK\" ) , \"SUB\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"SUB\".\"CHANNEL\" AS \"CHANNEL\" , \"SUB\".\"ID\" AS \"ID\" , SUM ( \"SUB\".\"SALES\" ) AS \"SALES\" , SUM ( \"SUB\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SUB\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SUB\" AS \"SUB\" GROUP BY \"SUB\".\"CHANNEL\" , \"SUB\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT SS_STORE_SK AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY SS_STORE_SK ) , CSR AS ( SELECT CS_CATALOG_PAGE_SK AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CS_CATALOG_PAGE_SK ) , WSR AS ( SELECT WS_WEB_SITE_SK AS WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WS_WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS SUB GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                id       sales  returns1     profit\n0     store channel           store85  1338779.88  77005.02 -662091.96\n1   catalog channel  catalog_page4109   219249.43   8245.49  -16338.93\n2   catalog channel  catalog_page4258    73469.11   8188.91  -17785.49\n3   catalog channel  catalog_page4970    62012.00   9883.12  -29247.39\n4   catalog channel  catalog_page4813    72728.80   6627.50    4663.06\n5   catalog channel  catalog_page4295   115412.70   5837.89   -5280.40\n6   catalog channel  catalog_page4313   113322.30   2800.69  -14019.12\n7   catalog channel  catalog_page4930    52909.37   2046.80    1555.99\n8   catalog channel  catalog_page4994    90797.53  11225.32   11906.32\n9   catalog channel  catalog_page4842    24451.18   4732.65    -159.21\n10      web channel              web5   989778.85  56785.44 -148731.36\n11    store channel           store32  1269655.79  61355.26 -557579.95\n12    store channel           store34  1158111.88  40735.88 -531993.52\n13  catalog channel  catalog_page4936    74367.77  11584.08   -8167.03\n14  catalog channel  catalog_page4221   121373.42  10408.07    4796.44\n15  catalog channel  catalog_page4967    51363.05   7513.51   -1873.98\n16  catalog channel  catalog_page4933    50222.81    133.54  -12028.27\n17  catalog channel  catalog_page4250   105670.88    898.76    2562.97\n18  catalog channel  catalog_page4310   132903.66  10605.38  -13812.27\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.313332,
                    "execution_time": 0.088857,
                    "compile_time": 0.001047,
                    "planning_time": 0.177219
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.435767,
                    "execution_time": 0.090788,
                    "compile_time": 0.00343,
                    "planning_time": 0.290946
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                id       sales  returns1     profit\n0     store channel           store85  1338779.88  77005.02 -662091.96\n1   catalog channel  catalog_page4109   219249.43   8245.49  -16338.93\n2   catalog channel  catalog_page4258    73469.11   8188.91  -17785.49\n3   catalog channel  catalog_page4970    62012.00   9883.12  -29247.39\n4   catalog channel  catalog_page4813    72728.80   6627.50    4663.06\n5   catalog channel  catalog_page4295   115412.70   5837.89   -5280.40\n6   catalog channel  catalog_page4313   113322.30   2800.69  -14019.12\n7   catalog channel  catalog_page4930    52909.37   2046.80    1555.99\n8   catalog channel  catalog_page4994    90797.53  11225.32   11906.32\n9   catalog channel  catalog_page4842    24451.18   4732.65    -159.21\n10      web channel              web5   989778.85  56785.44 -148731.36\n11    store channel           store32  1269655.79  61355.26 -557579.95\n12    store channel           store34  1158111.88  40735.88 -531993.52\n13  catalog channel  catalog_page4936    74367.77  11584.08   -8167.03\n14  catalog channel  catalog_page4221   121373.42  10408.07    4796.44\n15  catalog channel  catalog_page4967    51363.05   7513.51   -1873.98\n16  catalog channel  catalog_page4933    50222.81    133.54  -12028.27\n17  catalog channel  catalog_page4250   105670.88    898.76    2562.97\n18  catalog channel  catalog_page4310   132903.66  10605.38  -13812.27\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          ss_store_sk                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ss_store_sk) , csr AS \n( \n                SELECT          cs_catalog_page_sk                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cs_catalog_page_sk) , wsr AS \n( \n                SELECT          ws_web_site_sk, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = ws_web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ws_web_site_sk) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || ws_web_site_sk AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr) AS combined\nGROUP BY channel, id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" ) , \"WSR\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WS_WEB_SITE_SK\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"WEB_SITE\" AS \"WEB_SITE\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" WHERE \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SALES\".\"WS_WEB_SITE_SK\" GROUP BY \"WEB_SALES\".\"WS_WEB_SITE_SK\" ) , \"COMBINED\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WS_WEB_SITE_SK\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"COMBINED\".\"CHANNEL\" AS \"CHANNEL\" , \"COMBINED\".\"ID\" AS \"ID\" , SUM ( \"COMBINED\".\"SALES\" ) AS \"SALES\" , SUM ( \"COMBINED\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"COMBINED\".\"PROFIT\" ) AS \"PROFIT\" FROM \"COMBINED\" AS \"COMBINED\" GROUP BY \"COMBINED\".\"CHANNEL\" , \"COMBINED\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT SS_STORE_SK AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY SS_STORE_SK ) , CSR AS ( SELECT CS_CATALOG_PAGE_SK AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CS_CATALOG_PAGE_SK ) , WSR AS ( SELECT WS_WEB_SITE_SK , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WS_WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WS_WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WS_WEB_SITE_SK AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS COMBINED GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                id     sales  returns1    profit\n0     store channel           store85  44833.67      0.00 -18894.45\n1   catalog channel  catalog_page4109  11569.41      0.00  -2487.20\n2   catalog channel  catalog_page4813   5841.52   5725.26  -2550.59\n3   catalog channel  catalog_page4258   3079.10    113.40  -3739.93\n4   catalog channel  catalog_page4295   1984.50      0.00    634.95\n5   catalog channel  catalog_page4794   2816.80      0.00   -938.00\n6   catalog channel  catalog_page4116  10349.03      0.00  -1007.96\n7   catalog channel  catalog_page4843   1993.74      0.00    650.16\n8   catalog channel  catalog_page4178   2461.10      0.00   -412.60\n9   catalog channel  catalog_page4782   1973.31      0.00      9.59\n10  catalog channel  catalog_page4279    295.78      0.00  -2563.58\n11  catalog channel  catalog_page4176   3612.08      0.00   -567.88\n12  catalog channel  catalog_page4260     15.70      0.00    -56.68\n13  catalog channel  catalog_page4812   8808.11      0.00   3515.81\n14  catalog channel  catalog_page4177   5043.36      0.00    712.71\n15    store channel           store32  44109.88      0.00  -6563.80\n16    store channel           store34  34083.22      0.00 -24851.29\n17  catalog channel  catalog_page4781    703.08      0.00  -4627.68\n18  catalog channel  catalog_page4310    616.42      0.00  -1923.76\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.307119,
                    "execution_time": 0.094577,
                    "compile_time": 0.001054,
                    "planning_time": 0.165271
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.443557,
                    "execution_time": 0.103594,
                    "compile_time": 0.001101,
                    "planning_time": 0.2883
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                id     sales  returns1    profit\n0     store channel           store85  44833.67      0.00 -18894.45\n1   catalog channel  catalog_page4109  11569.41      0.00  -2487.20\n2   catalog channel  catalog_page4813   5841.52   5725.26  -2550.59\n3   catalog channel  catalog_page4258   3079.10    113.40  -3739.93\n4   catalog channel  catalog_page4295   1984.50      0.00    634.95\n5   catalog channel  catalog_page4794   2816.80      0.00   -938.00\n6   catalog channel  catalog_page4116  10349.03      0.00  -1007.96\n7   catalog channel  catalog_page4843   1993.74      0.00    650.16\n8   catalog channel  catalog_page4178   2461.10      0.00   -412.60\n9   catalog channel  catalog_page4782   1973.31      0.00      9.59\n10  catalog channel  catalog_page4279    295.78      0.00  -2563.58\n11  catalog channel  catalog_page4176   3612.08      0.00   -567.88\n12  catalog channel  catalog_page4260     15.70      0.00    -56.68\n13  catalog channel  catalog_page4812   8808.11      0.00   3515.81\n14  catalog channel  catalog_page4177   5043.36      0.00    712.71\n15    store channel           store32  44109.88      0.00  -6563.80\n16    store channel           store34  34083.22      0.00 -24851.29\n17  catalog channel  catalog_page4781    703.08      0.00  -4627.68\n18  catalog channel  catalog_page4310    616.42      0.00  -1923.76\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + INTERVAL '30' day) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n/*CURSOR_IDENTIFIER*/ SELECT 'web channel' AS channel , 'web' || web_site_id AS id , sales , returns1 , profit FROM wsr) GROUP BY channel, id",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-09-25' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"_Q_0\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"ID\" AS \"ID\" , SUM ( \"_Q_0\".\"SALES\" ) AS \"SALES\" , SUM ( \"_Q_0\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"_Q_0\".\"PROFIT\" ) AS \"PROFIT\" FROM \"_Q_0\" AS \"_Q_0\" GROUP BY \"_Q_0\".\"CHANNEL\" , \"_Q_0\".\"ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.195856,
                    "execution_time": 0.099791,
                    "compile_time": 0.000634,
                    "planning_time": 0.056455,
                    "create_size": 875
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.27924,
                    "execution_time": 0.103567,
                    "compile_time": 0.000554,
                    "planning_time": 0.135395,
                    "create_size": 875
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.178724,
                    "execution_time": 0.08567,
                    "compile_time": 0.000542,
                    "planning_time": 0.056989,
                    "create_size": 140
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.263819,
                    "execution_time": 0.084971,
                    "compile_time": 0.001687,
                    "planning_time": 0.138122,
                    "create_size": 140
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SPEQLITE_TEMP_TABLE_4\".\"STORE_ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_4\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"SPEQLITE_TEMP_TABLE_5\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_5\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web' || \"SPEQLITE_TEMP_TABLE_6\".\"WEB_SITE_ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_6\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.090474,
                    "execution_time": 0.048158,
                    "compile_time": 0.000298,
                    "planning_time": 0.009482,
                    "create_size": 8
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.13348,
                    "execution_time": 0.047727,
                    "compile_time": 0.000287,
                    "planning_time": 0.05222,
                    "create_size": 8
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_7\".\"ID\" AS \"ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"SALES\" ) AS \"SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" GROUP BY \"SPEQLITE_TEMP_TABLE_7\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_7\".\"ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.071832,
                    "execution_time": 0.038299,
                    "compile_time": 0.000288,
                    "planning_time": 0.004816,
                    "create_size": 8
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.131968,
                    "execution_time": 0.038607,
                    "compile_time": 0.000295,
                    "planning_time": 0.060971,
                    "create_size": 8
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_8\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*            channel                            id       sales  returns1     profit\n0     store channel         storeAAAAAAAAIFAAAAAA  1160168.48  74585.13 -499272.94\n1   catalog channel  catalog_pageAAAAAAAAGKABAAAA   116963.76   3333.38  -21640.36\n2   catalog channel  catalog_pageAAAAAAAAELABAAAA    94455.23  18184.53   -6100.78\n3   catalog channel  catalog_pageAAAAAAAANMABAAAA    88252.09   1442.76    1786.09\n4   catalog channel  catalog_pageAAAAAAAAMNCBAAAA    28088.43      0.00  -11921.45\n5   catalog channel  catalog_pageAAAAAAAABIDBAAAA    86733.99   2898.37    2734.75\n6   catalog channel  catalog_pageAAAAAAAANNABAAAA    83620.70    848.62  -29728.09\n7   catalog channel  catalog_pageAAAAAAAADHDBAAAA    48312.60   4054.59  -17061.80\n8   catalog channel  catalog_pageAAAAAAAABDABAAAA   238124.92   3019.78    -252.41\n9   catalog channel  catalog_pageAAAAAAAABHDBAAAA    61726.53   2846.50  -18130.53\n10  catalog channel  catalog_pageAAAAAAAABHABAAAA   166458.31  18709.11  -65320.26\n11  catalog channel  catalog_pageAAAAAAAAINABAAAA    80057.88   8993.86   -5533.85\n12  catalog channel  catalog_pageAAAAAAAAKCDBAAAA    72439.71   2072.45   -2178.92\n13  catalog channel  catalog_pageAAAAAAAABMCBAAAA    14123.72   1461.92    -444.40\n14  catalog channel  catalog_pageAAAAAAAAKHABAAAA   154466.15   5357.01  -25238.53\n15  catalog channel  catalog_pageAAAAAAAAIADBAAAA    40576.80  12434.99   -2188.70\n16  catalog channel  catalog_pageAAAAAAAAAEDBAAAA    62447.72    530.01   -5267.51\n17  catalog channel  catalog_pageAAAAAAAAFNABAAAA    88169.77  11633.39    2298.38\n18  catalog channel  catalog_pageAAAAAAAALLCBAAAA    69088.29   1803.14  -12533.17\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018133,
                    "execution_time": 0.007795,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003923
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056492,
                    "execution_time": 0.007759,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039339
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_7\".\"ID\" AS \"ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"SALES\" ) AS \"SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" GROUP BY \"SPEQLITE_TEMP_TABLE_7\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_7\".\"ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_8\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*            channel                            id       sales  returns1     profit\n0     store channel         storeAAAAAAAAIFAAAAAA  1160168.48  74585.13 -499272.94\n1   catalog channel  catalog_pageAAAAAAAAGKABAAAA   116963.76   3333.38  -21640.36\n2   catalog channel  catalog_pageAAAAAAAAELABAAAA    94455.23  18184.53   -6100.78\n3   catalog channel  catalog_pageAAAAAAAANMABAAAA    88252.09   1442.76    1786.09\n4   catalog channel  catalog_pageAAAAAAAAMNCBAAAA    28088.43      0.00  -11921.45\n5   catalog channel  catalog_pageAAAAAAAABIDBAAAA    86733.99   2898.37    2734.75\n6   catalog channel  catalog_pageAAAAAAAANNABAAAA    83620.70    848.62  -29728.09\n7   catalog channel  catalog_pageAAAAAAAADHDBAAAA    48312.60   4054.59  -17061.80\n8   catalog channel  catalog_pageAAAAAAAABDABAAAA   238124.92   3019.78    -252.41\n9   catalog channel  catalog_pageAAAAAAAABHDBAAAA    61726.53   2846.50  -18130.53\n10  catalog channel  catalog_pageAAAAAAAABHABAAAA   166458.31  18709.11  -65320.26\n11  catalog channel  catalog_pageAAAAAAAAINABAAAA    80057.88   8993.86   -5533.85\n12  catalog channel  catalog_pageAAAAAAAAKCDBAAAA    72439.71   2072.45   -2178.92\n13  catalog channel  catalog_pageAAAAAAAABMCBAAAA    14123.72   1461.92    -444.40\n14  catalog channel  catalog_pageAAAAAAAAKHABAAAA   154466.15   5357.01  -25238.53\n15  catalog channel  catalog_pageAAAAAAAAIADBAAAA    40576.80  12434.99   -2188.70\n16  catalog channel  catalog_pageAAAAAAAAAEDBAAAA    62447.72    530.01   -5267.51\n17  catalog channel  catalog_pageAAAAAAAAFNABAAAA    88169.77  11633.39    2298.38\n18  catalog channel  catalog_pageAAAAAAAALLCBAAAA    69088.29   1803.14  -12533.17\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          ss_store_sk                                    AS store_id, \n                                SUM(SS_EXT_SALES_PRICE)                       AS sales, \n                                SUM(COALESCE(SR_RETURN_AMT, 0))               AS returns1, \n                                SUM(SS_NET_PROFIT - COALESCE(SR_NET_LOSS, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number) \n                , date_dim, \n                store, \n                item, \n                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN CAST('2000-08-26' AS DATE) AND DATEADD(day, 30, CAST('2000-08-26' AS DATE))\n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ss_store_sk) , csr AS \n( \n                SELECT          cp_catalog_page_sk                            AS catalog_page_id, \n                                SUM(CS_EXT_SALES_PRICE)                       AS sales, \n                                SUM(COALESCE(CR_RETURN_AMOUNT, 0))            AS returns1, \n                                SUM(CS_NET_PROFIT - COALESCE(CR_NET_LOSS, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number) \n                , date_dim, \n                catalog_page, \n                item, \n                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN CAST('2000-08-26' AS DATE) AND DATEADD(day, 30, CAST('2000-08-26' AS DATE))\n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_sk) , wsr AS \n( \n                SELECT          ws_web_site_sk AS web_site_id, \n                                SUM(WS_EXT_SALES_PRICE)                       AS sales, \n                                SUM(COALESCE(WR_RETURN_AMT, 0))               AS returns1, \n                                SUM(WS_NET_PROFIT - COALESCE(WR_NET_LOSS, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number) \n                , date_dim, \n                web_site, \n                item, \n                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN CAST('2000-08-26' AS DATE) AND DATEADD(day, 30, CAST('2000-08-26' AS DATE))\n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ws_web_site_sk) \nSELECT\n         channel , \n         id , \n         SUM(sales)   AS sales , \n         SUM(returns1) AS returns1 , \n         SUM(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site'\n                              || web_site_id AS id ,\n                       sales ,\n                       returns1 ,\n                       profit \n                FROM   wsr \n/*CURSOR_IDENTIFIER*/ ) \nGROUP BY channel , id \nORDER BY channel , id;",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" FROM \"ITEM\" AS \"ITEM\" ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" ) , \"WSR\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SALES\".\"WS_WEB_SITE_SK\" ) , \"_Q_0\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"ID\" AS \"ID\" , SUM ( \"_Q_0\".\"SALES\" ) AS \"SALES\" , SUM ( \"_Q_0\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"_Q_0\".\"PROFIT\" ) AS \"PROFIT\" FROM \"_Q_0\" AS \"_Q_0\" GROUP BY \"_Q_0\".\"CHANNEL\" , \"_Q_0\".\"ID\" ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT SS_STORE_SK AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY SS_STORE_SK ) , CSR AS ( SELECT CP_CATALOG_PAGE_SK AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_SK ) , WSR AS ( SELECT WS_WEB_SITE_SK AS WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2000-08-26' AS DATE ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WS_WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) GROUP BY CHANNEL , ID ORDER BY CHANNEL NULLS FIRST , ID NULLS FIRST LIMIT 21",
                "preview": "\n/*            channel                id       sales   returns1     profit\n0   catalog channel  catalog_page4108  3469473.18  164991.52 -559306.46\n1   catalog channel  catalog_page4109  3603005.22  228858.19 -510231.98\n2   catalog channel  catalog_page4110  3326905.13  166297.25 -393492.39\n3   catalog channel  catalog_page4111  3506637.05  174618.60 -552212.92\n4   catalog channel  catalog_page4112  3478775.75  176880.58 -451092.29\n5   catalog channel  catalog_page4113  3614760.16  211801.81 -518538.51\n6   catalog channel  catalog_page4114  3420168.33  166465.40 -405144.45\n7   catalog channel  catalog_page4115  3734787.74  195374.60 -499674.84\n8   catalog channel  catalog_page4116  3548811.28  150705.56 -358770.73\n9   catalog channel  catalog_page4117  3506194.03  186592.72 -350196.50\n10  catalog channel  catalog_page4118  3765417.88  144003.71 -416245.16\n11  catalog channel  catalog_page4119  3581480.77  142716.66 -323688.77\n12  catalog channel  catalog_page4120  3711828.39  151857.64 -284912.17\n13  catalog channel  catalog_page4121  3734764.02  219916.03 -265254.86\n14  catalog channel  catalog_page4122  3760313.95  193439.78 -373378.96\n15  catalog channel  catalog_page4123  3519570.92  181730.17 -579271.73\n16  catalog channel  catalog_page4124  3704594.39  222336.94 -457234.96\n17  catalog channel  catalog_page4125  3637293.90  187286.64 -409966.29\n18  catalog channel  catalog_page4126  3640348.17  200553.24 -445601.04\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.389527,
                    "execution_time": 0.128564,
                    "compile_time": 0.045348,
                    "planning_time": 0.165666
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.816907,
                    "execution_time": 0.134521,
                    "compile_time": 3.323323,
                    "planning_time": 0.303771
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                id       sales   returns1     profit\n0   catalog channel  catalog_page4108  3469473.18  164991.52 -559306.46\n1   catalog channel  catalog_page4109  3603005.22  228858.19 -510231.98\n2   catalog channel  catalog_page4110  3326905.13  166297.25 -393492.39\n3   catalog channel  catalog_page4111  3506637.05  174618.60 -552212.92\n4   catalog channel  catalog_page4112  3478775.75  176880.58 -451092.29\n5   catalog channel  catalog_page4113  3614760.16  211801.81 -518538.51\n6   catalog channel  catalog_page4114  3420168.33  166465.40 -405144.45\n7   catalog channel  catalog_page4115  3734787.74  195374.60 -499674.84\n8   catalog channel  catalog_page4116  3548811.28  150705.56 -358770.73\n9   catalog channel  catalog_page4117  3506194.03  186592.72 -350196.50\n10  catalog channel  catalog_page4118  3765417.88  144003.71 -416245.16\n11  catalog channel  catalog_page4119  3581480.77  142716.66 -323688.77\n12  catalog channel  catalog_page4120  3711828.39  151857.64 -284912.17\n13  catalog channel  catalog_page4121  3734764.02  219916.03 -265254.86\n14  catalog channel  catalog_page4122  3760313.95  193439.78 -373378.96\n15  catalog channel  catalog_page4123  3519570.92  181730.17 -579271.73\n16  catalog channel  catalog_page4124  3704594.39  222336.94 -457234.96\n17  catalog channel  catalog_page4125  3637293.90  187286.64 -409966.29\n18  catalog channel  catalog_page4126  3640348.17  200553.24 -445601.04\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr \n) AS combined \nGROUP BY channel, id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"COMBINED\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"COMBINED\".\"CHANNEL\" AS \"CHANNEL\" , \"COMBINED\".\"ID\" AS \"ID\" , SUM ( \"COMBINED\".\"SALES\" ) AS \"SALES\" , SUM ( \"COMBINED\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"COMBINED\".\"PROFIT\" ) AS \"PROFIT\" FROM \"COMBINED\" AS \"COMBINED\" GROUP BY \"COMBINED\".\"CHANNEL\" , \"COMBINED\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WEB_SITE_ID ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS COMBINED GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                            id     sales  returns1    profit\n0   catalog channel  catalog_pageAAAAAAAANAABAAAA  11569.41      0.00  -2487.20\n1   catalog channel  catalog_pageAAAAAAAAJCABAAAA  17256.77      0.00  -2884.33\n2   catalog channel  catalog_pageAAAAAAAAPAABAAAA   4361.64   2938.59  -8209.67\n3   catalog channel  catalog_pageAAAAAAAAPJABAAAA   4568.47      0.00  -2436.04\n4   catalog channel  catalog_pageAAAAAAAAFCABAAAA   5418.59      0.00  -2924.89\n5   catalog channel  catalog_pageAAAAAAAAFFABAAAA   1293.93      0.00    320.76\n6   catalog channel  catalog_pageAAAAAAAANLABAAAA  14692.00   3305.70   6405.82\n7   catalog channel  catalog_pageAAAAAAAAFHABAAAA     27.61      0.00    -59.95\n8     store channel         storeAAAAAAAAFFAAAAAA  44833.67      0.00 -18894.45\n9     store channel         storeAAAAAAAAIAAAAAAA  54093.60      0.00 -14280.10\n10    store channel         storeAAAAAAAAGFAAAAAA  43957.06    413.35 -25380.01\n11  catalog channel  catalog_pageAAAAAAAANKCBAAAA    703.08      0.00  -4627.68\n12  catalog channel  catalog_pageAAAAAAAAKEABAAAA    755.09      0.00   -101.20\n13      web channel      web_siteAAAAAAAAOAAAAAAA  13958.71    349.18  -7346.70\n14    store channel         storeAAAAAAAANAAAAAAA  30861.35      0.00 -33083.01\n15  catalog channel  catalog_pageAAAAAAAACOABAAAA   4807.67    873.18  -1990.16\n16      web channel      web_siteAAAAAAAAHAAAAAAA  51873.76      0.00    704.70\n17      web channel      web_siteAAAAAAAAKBAAAAAA  55886.56   2293.16 -13136.42\n18    store channel         storeAAAAAAAACFAAAAAA  20239.48      5.25  -9987.38\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.314989,
                    "execution_time": 0.097307,
                    "compile_time": 0.001092,
                    "planning_time": 0.167529
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.437025,
                    "execution_time": 0.096715,
                    "compile_time": 0.001044,
                    "planning_time": 0.292788
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id     sales  returns1    profit\n0   catalog channel  catalog_pageAAAAAAAANAABAAAA  11569.41      0.00  -2487.20\n1   catalog channel  catalog_pageAAAAAAAAJCABAAAA  17256.77      0.00  -2884.33\n2   catalog channel  catalog_pageAAAAAAAAPAABAAAA   4361.64   2938.59  -8209.67\n3   catalog channel  catalog_pageAAAAAAAAPJABAAAA   4568.47      0.00  -2436.04\n4   catalog channel  catalog_pageAAAAAAAAFCABAAAA   5418.59      0.00  -2924.89\n5   catalog channel  catalog_pageAAAAAAAAFFABAAAA   1293.93      0.00    320.76\n6   catalog channel  catalog_pageAAAAAAAANLABAAAA  14692.00   3305.70   6405.82\n7   catalog channel  catalog_pageAAAAAAAAFHABAAAA     27.61      0.00    -59.95\n8     store channel         storeAAAAAAAAFFAAAAAA  44833.67      0.00 -18894.45\n9     store channel         storeAAAAAAAAIAAAAAAA  54093.60      0.00 -14280.10\n10    store channel         storeAAAAAAAAGFAAAAAA  43957.06    413.35 -25380.01\n11  catalog channel  catalog_pageAAAAAAAANKCBAAAA    703.08      0.00  -4627.68\n12  catalog channel  catalog_pageAAAAAAAAKEABAAAA    755.09      0.00   -101.20\n13      web channel      web_siteAAAAAAAAOAAAAAAA  13958.71    349.18  -7346.70\n14    store channel         storeAAAAAAAANAAAAAAA  30861.35      0.00 -33083.01\n15  catalog channel  catalog_pageAAAAAAAACOABAAAA   4807.67    873.18  -1990.16\n16      web channel      web_siteAAAAAAAAHAAAAAAA  51873.76      0.00    704.70\n17      web channel      web_siteAAAAAAAAKBAAAAAA  55886.56   2293.16 -13136.42\n18    store channel         storeAAAAAAAACFAAAAAA  20239.48      5.25  -9987.38\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_sk                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_sk) , csr AS \n( \n                SELECT          cp_catalog_page_sk                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_sk) , wsr AS \n( \n                SELECT          ws_web_site_sk AS web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ws_web_site_sk) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr \n) AS combined_results \nGROUP BY channel, id \nORDER BY channel, id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" ) , \"WSR\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SALES\".\"WS_WEB_SITE_SK\" ) , \"COMBINED_RESULTS\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"COMBINED_RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\" AS \"ID\" , SUM ( \"COMBINED_RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"COMBINED_RESULTS\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"COMBINED_RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"COMBINED_RESULTS\" AS \"COMBINED_RESULTS\" GROUP BY \"COMBINED_RESULTS\".\"CHANNEL\" , \"COMBINED_RESULTS\".\"ID\" ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_SK AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_SK ) , CSR AS ( SELECT CP_CATALOG_PAGE_SK AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_SK ) , WSR AS ( SELECT WS_WEB_SITE_SK AS WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WS_WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS COMBINED_RESULTS GROUP BY CHANNEL , ID ORDER BY CHANNEL NULLS FIRST , ID NULLS FIRST LIMIT 21",
                "preview": "\n/*            channel                id     sales  returns1    profit\n0   catalog channel  catalog_page4108   4747.47      0.00   1870.72\n1   catalog channel  catalog_page4109  11569.41      0.00  -2487.20\n2   catalog channel  catalog_page4110   5141.61      0.00   -230.78\n3   catalog channel  catalog_page4111   4361.64   2938.59  -8209.67\n4   catalog channel  catalog_page4113   3702.73      0.00  -4420.74\n5   catalog channel  catalog_page4114  24315.44  12808.25  12089.58\n6   catalog channel  catalog_page4115  14602.89    430.40 -15810.71\n7   catalog channel  catalog_page4116  10349.03      0.00  -1007.96\n8   catalog channel  catalog_page4117   4621.50      0.00  -1779.82\n9   catalog channel  catalog_page4118   7604.50      0.00   4118.00\n10  catalog channel  catalog_page4119   8098.18      0.00  -7732.88\n11  catalog channel  catalog_page4120  10747.38      0.00   2409.00\n12  catalog channel  catalog_page4121   3449.22      0.00  -6178.29\n13  catalog channel  catalog_page4122   1211.38      0.00     48.10\n14  catalog channel  catalog_page4123   6806.05    433.44   2264.76\n15  catalog channel  catalog_page4124  11453.54      0.00  -1239.08\n16  catalog channel  catalog_page4125   5995.80      0.00  -2829.08\n17  catalog channel  catalog_page4126   1428.55      0.00  -1974.95\n18  catalog channel  catalog_page4127  12125.18      0.00  -6407.35\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.308571,
                    "execution_time": 0.096388,
                    "compile_time": 0.00106,
                    "planning_time": 0.164618
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.444813,
                    "execution_time": 0.103475,
                    "compile_time": 0.0011,
                    "planning_time": 0.291578
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                id     sales  returns1    profit\n0   catalog channel  catalog_page4108   4747.47      0.00   1870.72\n1   catalog channel  catalog_page4109  11569.41      0.00  -2487.20\n2   catalog channel  catalog_page4110   5141.61      0.00   -230.78\n3   catalog channel  catalog_page4111   4361.64   2938.59  -8209.67\n4   catalog channel  catalog_page4113   3702.73      0.00  -4420.74\n5   catalog channel  catalog_page4114  24315.44  12808.25  12089.58\n6   catalog channel  catalog_page4115  14602.89    430.40 -15810.71\n7   catalog channel  catalog_page4116  10349.03      0.00  -1007.96\n8   catalog channel  catalog_page4117   4621.50      0.00  -1779.82\n9   catalog channel  catalog_page4118   7604.50      0.00   4118.00\n10  catalog channel  catalog_page4119   8098.18      0.00  -7732.88\n11  catalog channel  catalog_page4120  10747.38      0.00   2409.00\n12  catalog channel  catalog_page4121   3449.22      0.00  -6178.29\n13  catalog channel  catalog_page4122   1211.38      0.00     48.10\n14  catalog channel  catalog_page4123   6806.05    433.44   2264.76\n15  catalog channel  catalog_page4124  11453.54      0.00  -1239.08\n16  catalog channel  catalog_page4125   5995.80      0.00  -2829.08\n17  catalog channel  catalog_page4126   1428.55      0.00  -1974.95\n18  catalog channel  catalog_page4127  12125.18      0.00  -6407.35\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_sk                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number) \n                , date_dim, \n                store, \n                item, \n                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + DATEADD(day, 30, '2000-08-26')) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_sk) , csr AS \n( \n                SELECT          cp_catalog_page_sk                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number) \n                , date_dim, \n                catalog_page, \n                item, \n                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_sk) , wsr AS \n( \n                SELECT          ws_web_site_sk AS web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number) \n                , date_dim, \n                web_site, \n                item, \n                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + DATEADD(day, 30, '2000-08-26')) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        ws_web_site_sk) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr ) x \nGROUP BY channel, id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= ( CAST ( '2000-08-26' AS DATE ) + TS_OR_DS_ADD ( 'DAY' , 30 , 1966 , TIMESTAMP ) ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_SK\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_SK\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" ) , \"WSR\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SALES\".\"WS_WEB_SITE_SK\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_SK AS STORE_ID , SUM ( SS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( SR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( SS_NET_PROFIT - COALESCE ( SR_NET_LOSS , 0 ) ) AS PROFIT FROM STORE_SALES LEFT OUTER JOIN STORE_RETURNS ON ( SS_ITEM_SK = SR_ITEM_SK AND SS_TICKET_NUMBER = SR_TICKET_NUMBER ) , DATE_DIM , STORE , ITEM , PROMOTION WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND SS_STORE_SK = S_STORE_SK AND SS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND SS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY S_STORE_SK ) , CSR AS ( SELECT CP_CATALOG_PAGE_SK AS CATALOG_PAGE_ID , SUM ( CS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( CR_RETURN_AMOUNT , 0 ) ) AS RETURNS1 , SUM ( CS_NET_PROFIT - COALESCE ( CR_NET_LOSS , 0 ) ) AS PROFIT FROM CATALOG_SALES LEFT OUTER JOIN CATALOG_RETURNS ON ( CS_ITEM_SK = CR_ITEM_SK AND CS_ORDER_NUMBER = CR_ORDER_NUMBER ) , DATE_DIM , CATALOG_PAGE , ITEM , PROMOTION WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND CS_CATALOG_PAGE_SK = CP_CATALOG_PAGE_SK AND CS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND CS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY CP_CATALOG_PAGE_SK ) , WSR AS ( SELECT WS_WEB_SITE_SK AS WEB_SITE_ID , SUM ( WS_EXT_SALES_PRICE ) AS SALES , SUM ( COALESCE ( WR_RETURN_AMT , 0 ) ) AS RETURNS1 , SUM ( WS_NET_PROFIT - COALESCE ( WR_NET_LOSS , 0 ) ) AS PROFIT FROM WEB_SALES LEFT OUTER JOIN WEB_RETURNS ON ( WS_ITEM_SK = WR_ITEM_SK AND WS_ORDER_NUMBER = WR_ORDER_NUMBER ) , DATE_DIM , WEB_SITE , ITEM , PROMOTION WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2000-08-26' AS DATE ) AND ( CAST ( '2000-08-26' AS DATE ) + DATEADD ( DAY , 30 , '2000-08-26' ) ) AND WS_WEB_SITE_SK = WEB_SITE_SK AND WS_ITEM_SK = I_ITEM_SK AND I_CURRENT_PRICE > 50 AND WS_PROMO_SK = P_PROMO_SK AND P_CHANNEL_TV = 'N' GROUP BY WS_WEB_SITE_SK ) SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS1 ) AS RETURNS1 , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || STORE_ID AS ID , SALES , RETURNS1 , PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CATALOG_PAGE_ID AS ID , SALES , RETURNS1 , PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS1 , PROFIT FROM WSR ) AS X GROUP BY CHANNEL , ID LIMIT 21",
                "preview": "\n/*            channel                id     sales  returns1    profit\n0   catalog channel  catalog_page4123   6806.05    433.44   2264.76\n1   catalog channel  catalog_page4186  11156.17      0.00  -7401.76\n2   catalog channel  catalog_page4134  16601.85      0.00   8786.38\n3   catalog channel  catalog_page4789  10339.20      0.00 -10771.68\n4   catalog channel  catalog_page4237   1206.97      0.00  -2709.60\n5   catalog channel  catalog_page4319    823.69      0.00   -591.43\n6   catalog channel  catalog_page4259   6214.32      0.00  -2922.52\n7   catalog channel  catalog_page4315   1774.25      0.00   -491.62\n8   catalog channel  catalog_page4285  14692.00   3305.70   6405.82\n9   catalog channel  catalog_page4322   4807.67    873.18  -1990.16\n10  catalog channel  catalog_page4874   5608.85      0.00    709.80\n11      web channel        web_site35  27059.47    710.44 -11712.93\n12  catalog channel  catalog_page4826   4478.62      0.00  -4400.67\n13      web channel        web_site11  38132.15    995.85   6923.87\n14    store channel           store50  29440.66   6011.42 -16986.60\n15  catalog channel  catalog_page4205   6412.18      0.00    605.22\n16  catalog channel  catalog_page4799   6305.25      0.00   2654.25\n17  catalog channel  catalog_page4836   2809.45      0.00   -880.96\n18  catalog channel  catalog_page4129   2730.36   1018.98  -1771.13\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.31101,
                    "execution_time": 0.093328,
                    "compile_time": 0.00107,
                    "planning_time": 0.169439
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.439768,
                    "execution_time": 0.094063,
                    "compile_time": 0.001092,
                    "planning_time": 0.29717
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                id     sales  returns1    profit\n0   catalog channel  catalog_page4123   6806.05    433.44   2264.76\n1   catalog channel  catalog_page4186  11156.17      0.00  -7401.76\n2   catalog channel  catalog_page4134  16601.85      0.00   8786.38\n3   catalog channel  catalog_page4789  10339.20      0.00 -10771.68\n4   catalog channel  catalog_page4237   1206.97      0.00  -2709.60\n5   catalog channel  catalog_page4319    823.69      0.00   -591.43\n6   catalog channel  catalog_page4259   6214.32      0.00  -2922.52\n7   catalog channel  catalog_page4315   1774.25      0.00   -491.62\n8   catalog channel  catalog_page4285  14692.00   3305.70   6405.82\n9   catalog channel  catalog_page4322   4807.67    873.18  -1990.16\n10  catalog channel  catalog_page4874   5608.85      0.00    709.80\n11      web channel        web_site35  27059.47    710.44 -11712.93\n12  catalog channel  catalog_page4826   4478.62      0.00  -4400.67\n13      web channel        web_site11  38132.15    995.85   6923.87\n14    store channel           store50  29440.66   6011.42 -16986.60\n15  catalog channel  catalog_page4205   6412.18      0.00    605.22\n16  catalog channel  catalog_page4799   6305.25      0.00   2654.25\n17  catalog channel  catalog_page4836   2809.45      0.00   -880.96\n18  catalog channel  catalog_page4129   2730.36   1018.98  -1771.13\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + INTERVAL '30' day) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr ) x \nGROUP BY rollup (channel, id) \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-09-25' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY ROLLUP ( \"X\".\"CHANNEL\" , \"X\".\"ID\" )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SPEQLITE_TEMP_TABLE_4\".\"STORE_ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_4\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"SPEQLITE_TEMP_TABLE_5\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_5\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"SPEQLITE_TEMP_TABLE_6\".\"WEB_SITE_ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_6\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.087165,
                    "execution_time": 0.046888,
                    "compile_time": 0.000292,
                    "planning_time": 0.009697,
                    "create_size": 8
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.132492,
                    "execution_time": 0.048796,
                    "compile_time": 0.000286,
                    "planning_time": 0.052732,
                    "create_size": 8
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" AS \"ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SALES\" ) AS \"SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" GROUP BY ROLLUP ( \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.077439,
                    "execution_time": 0.040951,
                    "compile_time": 0.000327,
                    "planning_time": 0.005895,
                    "create_size": 8
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.137981,
                    "execution_time": 0.039806,
                    "compile_time": 0.000328,
                    "planning_time": 0.064791,
                    "create_size": 8
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_10\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_10\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*            channel                            id       sales  returns1     profit\n0     store channel         storeAAAAAAAAIFAAAAAA  1160168.48  74585.13 -499272.94\n1   catalog channel  catalog_pageAAAAAAAAGKABAAAA   116963.76   3333.38  -21640.36\n2   catalog channel  catalog_pageAAAAAAAAELABAAAA    94455.23  18184.53   -6100.78\n3   catalog channel  catalog_pageAAAAAAAANMABAAAA    88252.09   1442.76    1786.09\n4   catalog channel  catalog_pageAAAAAAAAMNCBAAAA    28088.43      0.00  -11921.45\n5   catalog channel  catalog_pageAAAAAAAABIDBAAAA    86733.99   2898.37    2734.75\n6   catalog channel  catalog_pageAAAAAAAANNABAAAA    83620.70    848.62  -29728.09\n7   catalog channel  catalog_pageAAAAAAAADHDBAAAA    48312.60   4054.59  -17061.80\n8       web channel      web_siteAAAAAAAAKAAAAAAA  1098367.94  31506.08 -115446.21\n9     store channel         storeAAAAAAAAEEAAAAAA  1082431.95  43331.38 -552425.06\n10  catalog channel  catalog_pageAAAAAAAAHDABAAAA   234734.26  11407.55   16973.79\n11  catalog channel  catalog_pageAAAAAAAAJOABAAAA    82876.21   5078.63   -2524.19\n12  catalog channel  catalog_pageAAAAAAAAPKCBAAAA     8963.16      0.00   -8674.65\n13  catalog channel  catalog_pageAAAAAAAAHEABAAAA   227053.25   6652.34  -33520.42\n14  catalog channel  catalog_pageAAAAAAAAGGABAAAA   185627.66   3269.09   13630.23\n15    store channel         storeAAAAAAAAHAAAAAAA  1295104.20  63821.39 -613509.79\n16    store channel         storeAAAAAAAAOCAAAAAA  1115012.42  61626.10 -502913.15\n17  catalog channel  catalog_pageAAAAAAAAPFABAAAA   209143.49   3960.22   20596.78\n18  catalog channel  catalog_pageAAAAAAAAMGDBAAAA    44988.35    700.40  -23543.22\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016842,
                    "execution_time": 0.006917,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003737
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055302,
                    "execution_time": 0.007856,
                    "compile_time": 6.1e-05,
                    "planning_time": 0.03951
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" AS \"ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SALES\" ) AS \"SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" GROUP BY ROLLUP ( \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" )",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_10\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_10\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*            channel                            id       sales  returns1     profit\n0     store channel         storeAAAAAAAAIFAAAAAA  1160168.48  74585.13 -499272.94\n1   catalog channel  catalog_pageAAAAAAAAGKABAAAA   116963.76   3333.38  -21640.36\n2   catalog channel  catalog_pageAAAAAAAAELABAAAA    94455.23  18184.53   -6100.78\n3   catalog channel  catalog_pageAAAAAAAANMABAAAA    88252.09   1442.76    1786.09\n4   catalog channel  catalog_pageAAAAAAAAMNCBAAAA    28088.43      0.00  -11921.45\n5   catalog channel  catalog_pageAAAAAAAABIDBAAAA    86733.99   2898.37    2734.75\n6   catalog channel  catalog_pageAAAAAAAANNABAAAA    83620.70    848.62  -29728.09\n7   catalog channel  catalog_pageAAAAAAAADHDBAAAA    48312.60   4054.59  -17061.80\n8       web channel      web_siteAAAAAAAAKAAAAAAA  1098367.94  31506.08 -115446.21\n9     store channel         storeAAAAAAAAEEAAAAAA  1082431.95  43331.38 -552425.06\n10  catalog channel  catalog_pageAAAAAAAAHDABAAAA   234734.26  11407.55   16973.79\n11  catalog channel  catalog_pageAAAAAAAAJOABAAAA    82876.21   5078.63   -2524.19\n12  catalog channel  catalog_pageAAAAAAAAPKCBAAAA     8963.16      0.00   -8674.65\n13  catalog channel  catalog_pageAAAAAAAAHEABAAAA   227053.25   6652.34  -33520.42\n14  catalog channel  catalog_pageAAAAAAAAGGABAAAA   185627.66   3269.09   13630.23\n15    store channel         storeAAAAAAAAHAAAAAAA  1295104.20  63821.39 -613509.79\n16    store channel         storeAAAAAAAAOCAAAAAA  1115012.42  61626.10 -502913.15\n17  catalog channel  catalog_pageAAAAAAAAPFABAAAA   209143.49   3960.22   20596.78\n18  catalog channel  catalog_pageAAAAAAAAMGDBAAAA    44988.35    700.40  -23543.22\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + INTERVAL '30' day) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr ) x \nGROUP BY rollup (channel, id) \nORDER BY channel , \n         id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-09-25' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY ROLLUP ( \"X\".\"CHANNEL\" , \"X\".\"ID\" ) ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_10\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_10\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ORDER BY \"CHANNEL\" , \"ID\" LIMIT 21",
                "preview": "\n/*            channel                            id      sales  returns1    profit\n0   catalog channel  catalog_pageAAAAAAAAAADBAAAA   72839.95   5660.98   5209.73\n1   catalog channel  catalog_pageAAAAAAAAABABAAAA  201880.59  12740.66   4269.14\n2   catalog channel  catalog_pageAAAAAAAAABDBAAAA   47193.32   1051.00  -8207.88\n3   catalog channel  catalog_pageAAAAAAAAACABAAAA  158320.18  11940.52 -37165.83\n4   catalog channel  catalog_pageAAAAAAAAACDBAAAA   61227.54   8225.35 -31217.09\n5   catalog channel  catalog_pageAAAAAAAAADABAAAA  226466.64   6000.89 -19111.82\n6   catalog channel  catalog_pageAAAAAAAAADDBAAAA   58817.42   2030.70  -5520.46\n7   catalog channel  catalog_pageAAAAAAAAAEABAAAA  229721.31   6538.01  -2992.13\n8   catalog channel  catalog_pageAAAAAAAAAEDBAAAA   62447.72    530.01  -5267.51\n9   catalog channel  catalog_pageAAAAAAAAAFABAAAA  194677.71  16620.45 -10280.60\n10  catalog channel  catalog_pageAAAAAAAAAFDBAAAA   61529.68   1386.19 -11633.03\n11  catalog channel  catalog_pageAAAAAAAAAGABAAAA  245535.13  13788.68 -22571.30\n12  catalog channel  catalog_pageAAAAAAAAAGDBAAAA   43203.87   2556.91 -10092.64\n13  catalog channel  catalog_pageAAAAAAAAAHABAAAA  206528.09  12688.88 -30074.16\n14  catalog channel  catalog_pageAAAAAAAAAHDBAAAA   56053.39   1553.07  -8907.02\n15  catalog channel  catalog_pageAAAAAAAAAIABAAAA  116221.71   5959.78 -26614.14\n16  catalog channel  catalog_pageAAAAAAAAAIDBAAAA   34205.30   1159.23 -22081.76\n17  catalog channel  catalog_pageAAAAAAAAAJABAAAA  124614.05   2855.05  -6506.35\n18  catalog channel  catalog_pageAAAAAAAAAKABAAAA  144829.21   3540.52  -4256.89\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019092,
                    "execution_time": 0.008288,
                    "compile_time": 8.7e-05,
                    "planning_time": 0.003985
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056657,
                    "execution_time": 0.009623,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.03933
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" AS \"ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SALES\" ) AS \"SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" GROUP BY ROLLUP ( \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" ) ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_10\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_10\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*            channel                            id      sales  returns1    profit\n0   catalog channel  catalog_pageAAAAAAAAAADBAAAA   72839.95   5660.98   5209.73\n1   catalog channel  catalog_pageAAAAAAAAABABAAAA  201880.59  12740.66   4269.14\n2   catalog channel  catalog_pageAAAAAAAAABDBAAAA   47193.32   1051.00  -8207.88\n3   catalog channel  catalog_pageAAAAAAAAACABAAAA  158320.18  11940.52 -37165.83\n4   catalog channel  catalog_pageAAAAAAAAACDBAAAA   61227.54   8225.35 -31217.09\n5   catalog channel  catalog_pageAAAAAAAAADABAAAA  226466.64   6000.89 -19111.82\n6   catalog channel  catalog_pageAAAAAAAAADDBAAAA   58817.42   2030.70  -5520.46\n7   catalog channel  catalog_pageAAAAAAAAAEABAAAA  229721.31   6538.01  -2992.13\n8   catalog channel  catalog_pageAAAAAAAAAEDBAAAA   62447.72    530.01  -5267.51\n9   catalog channel  catalog_pageAAAAAAAAAFABAAAA  194677.71  16620.45 -10280.60\n10  catalog channel  catalog_pageAAAAAAAAAFDBAAAA   61529.68   1386.19 -11633.03\n11  catalog channel  catalog_pageAAAAAAAAAGABAAAA  245535.13  13788.68 -22571.30\n12  catalog channel  catalog_pageAAAAAAAAAGDBAAAA   43203.87   2556.91 -10092.64\n13  catalog channel  catalog_pageAAAAAAAAAHABAAAA  206528.09  12688.88 -30074.16\n14  catalog channel  catalog_pageAAAAAAAAAHDBAAAA   56053.39   1553.07  -8907.02\n15  catalog channel  catalog_pageAAAAAAAAAIABAAAA  116221.71   5959.78 -26614.14\n16  catalog channel  catalog_pageAAAAAAAAAIDBAAAA   34205.30   1159.23 -22081.76\n17  catalog channel  catalog_pageAAAAAAAAAJABAAAA  124614.05   2855.05  -6506.35\n18  catalog channel  catalog_pageAAAAAAAAAKABAAAA  144829.21   3540.52  -4256.89\n...*/"
    },
    {
        "input": "-- start query 80 in stream 0 using template query80.tpl \nWITH ssr AS \n( \n                SELECT          s_store_id                                    AS store_id, \n                                Sum(ss_ext_sales_price)                       AS sales, \n                                Sum(COALESCE(sr_return_amt, 0))               AS returns1, \n                                Sum(ss_net_profit - COALESCE(sr_net_loss, 0)) AS profit \n                FROM            store_sales \n                LEFT OUTER JOIN store_returns \n                ON              ( \n                                                ss_item_sk = sr_item_sk \n                                AND             ss_ticket_number = sr_ticket_number), \n                                date_dim, \n                                store, \n                                item, \n                                promotion \n                WHERE           ss_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN Cast('2000-08-26' AS DATE) AND             ( \n                                                Cast('2000-08-26' AS DATE) + INTERVAL '30' day) \n                AND             ss_store_sk = s_store_sk \n                AND             ss_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ss_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        s_store_id) , csr AS \n( \n                SELECT          cp_catalog_page_id                            AS catalog_page_id, \n                                sum(cs_ext_sales_price)                       AS sales, \n                                sum(COALESCE(cr_return_amount, 0))            AS returns1, \n                                sum(cs_net_profit - COALESCE(cr_net_loss, 0)) AS profit \n                FROM            catalog_sales \n                LEFT OUTER JOIN catalog_returns \n                ON              ( \n                                                cs_item_sk = cr_item_sk \n                                AND             cs_order_number = cr_order_number), \n                                date_dim, \n                                catalog_page, \n                                item, \n                                promotion \n                WHERE           cs_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             cs_catalog_page_sk = cp_catalog_page_sk \n                AND             cs_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             cs_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        cp_catalog_page_id) , wsr AS \n( \n                SELECT          web_site_id, \n                                sum(ws_ext_sales_price)                       AS sales, \n                                sum(COALESCE(wr_return_amt, 0))               AS returns1, \n                                sum(ws_net_profit - COALESCE(wr_net_loss, 0)) AS profit \n                FROM            web_sales \n                LEFT OUTER JOIN web_returns \n                ON              ( \n                                                ws_item_sk = wr_item_sk \n                                AND             ws_order_number = wr_order_number), \n                                date_dim, \n                                web_site, \n                                item, \n                                promotion \n                WHERE           ws_sold_date_sk = d_date_sk \n                AND             d_date BETWEEN cast('2000-08-26' AS date) AND             ( \n                                                cast('2000-08-26' AS date) + INTERVAL '30' day) \n                AND             ws_web_site_sk = web_site_sk \n                AND             ws_item_sk = i_item_sk \n                AND             i_current_price > 50 \n                AND             ws_promo_sk = p_promo_sk \n                AND             p_channel_tv = 'N' \n                GROUP BY        web_site_id) \nSELECT\n         channel , \n         id , \n         sum(sales)   AS sales , \n         sum(returns1) AS returns1 , \n         sum(profit)  AS profit \nFROM     ( \n                SELECT 'store channel' AS channel , \n                       'store' \n                              || store_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   ssr \n                UNION ALL \n                SELECT 'catalog channel' AS channel , \n                       'catalog_page' \n                              || catalog_page_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   csr \n                UNION ALL \n                SELECT 'web channel' AS channel , \n                       'web_site' \n                              || web_site_id AS id , \n                       sales , \n                       returns1 , \n                       profit \n                FROM   wsr ) x \nGROUP BY rollup (channel, id) \nORDER BY channel , \n         id \nLIMIT 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= CAST ( '2000-09-25' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2000-08-26' AS DATE ) ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CURRENT_PRICE\" > 50 ) , \"PROMOTION_2\" AS ( SELECT \"PROMOTION\".\"P_PROMO_SK\" AS \"P_PROMO_SK\" , \"PROMOTION\".\"P_CHANNEL_TV\" AS \"P_CHANNEL_TV\" FROM \"PROMOTION\" AS \"PROMOTION\" WHERE \"PROMOTION\".\"P_CHANNEL_TV\" = 'N' ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"STORE_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" - COALESCE ( \"STORE_RETURNS\".\"SR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CATALOG_PAGE_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"CATALOG_SALES\".\"CS_NET_PROFIT\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"SALES\" , SUM ( COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) ) AS \"RETURNS1\" , SUM ( \"WEB_SALES\".\"WS_NET_PROFIT\" - COALESCE ( \"WEB_RETURNS\".\"WR_NET_LOSS\" , 0 ) ) AS \"PROFIT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"PROMOTION_2\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"WEB_SALES\".\"WS_PROMO_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"WEB_SALES\".\"WS_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS1\" AS \"RETURNS1\" , \"SSR\".\"PROFIT\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS1\" AS \"RETURNS1\" , \"CSR\".\"PROFIT\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS1\" AS \"RETURNS1\" , \"WSR\".\"PROFIT\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY ROLLUP ( \"X\".\"CHANNEL\" , \"X\".\"ID\" ) ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_10\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_10\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ORDER BY \"CHANNEL\" , \"ID\" LIMIT 21",
                "preview": "\n/*            channel                            id      sales  returns1    profit\n0   catalog channel  catalog_pageAAAAAAAAAADBAAAA   72839.95   5660.98   5209.73\n1   catalog channel  catalog_pageAAAAAAAAABABAAAA  201880.59  12740.66   4269.14\n2   catalog channel  catalog_pageAAAAAAAAABDBAAAA   47193.32   1051.00  -8207.88\n3   catalog channel  catalog_pageAAAAAAAAACABAAAA  158320.18  11940.52 -37165.83\n4   catalog channel  catalog_pageAAAAAAAAACDBAAAA   61227.54   8225.35 -31217.09\n5   catalog channel  catalog_pageAAAAAAAAADABAAAA  226466.64   6000.89 -19111.82\n6   catalog channel  catalog_pageAAAAAAAAADDBAAAA   58817.42   2030.70  -5520.46\n7   catalog channel  catalog_pageAAAAAAAAAEABAAAA  229721.31   6538.01  -2992.13\n8   catalog channel  catalog_pageAAAAAAAAAEDBAAAA   62447.72    530.01  -5267.51\n9   catalog channel  catalog_pageAAAAAAAAAFABAAAA  194677.71  16620.45 -10280.60\n10  catalog channel  catalog_pageAAAAAAAAAFDBAAAA   61529.68   1386.19 -11633.03\n11  catalog channel  catalog_pageAAAAAAAAAGABAAAA  245535.13  13788.68 -22571.30\n12  catalog channel  catalog_pageAAAAAAAAAGDBAAAA   43203.87   2556.91 -10092.64\n13  catalog channel  catalog_pageAAAAAAAAAHABAAAA  206528.09  12688.88 -30074.16\n14  catalog channel  catalog_pageAAAAAAAAAHDBAAAA   56053.39   1553.07  -8907.02\n15  catalog channel  catalog_pageAAAAAAAAAIABAAAA  116221.71   5959.78 -26614.14\n16  catalog channel  catalog_pageAAAAAAAAAIDBAAAA   34205.30   1159.23 -22081.76\n17  catalog channel  catalog_pageAAAAAAAAAJABAAAA  124614.05   2855.05  -6506.35\n18  catalog channel  catalog_pageAAAAAAAAAKABAAAA  144829.21   3540.52  -4256.89\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018809,
                    "execution_time": 0.008151,
                    "compile_time": 7.7e-05,
                    "planning_time": 0.004258
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019323,
                    "execution_time": 0.008403,
                    "compile_time": 8e-05,
                    "planning_time": 0.004214
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" AS \"ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SALES\" ) AS \"SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"RETURNS1\" ) AS \"RETURNS1\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" GROUP BY ROLLUP ( \"SPEQLITE_TEMP_TABLE_9\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_9\".\"ID\" ) ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_10\".\"ID\" AS \"ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"RETURNS1\" AS \"RETURNS1\" , \"SPEQLITE_TEMP_TABLE_10\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*            channel                            id      sales  returns1    profit\n0   catalog channel  catalog_pageAAAAAAAAAADBAAAA   72839.95   5660.98   5209.73\n1   catalog channel  catalog_pageAAAAAAAAABABAAAA  201880.59  12740.66   4269.14\n2   catalog channel  catalog_pageAAAAAAAAABDBAAAA   47193.32   1051.00  -8207.88\n3   catalog channel  catalog_pageAAAAAAAAACABAAAA  158320.18  11940.52 -37165.83\n4   catalog channel  catalog_pageAAAAAAAAACDBAAAA   61227.54   8225.35 -31217.09\n5   catalog channel  catalog_pageAAAAAAAAADABAAAA  226466.64   6000.89 -19111.82\n6   catalog channel  catalog_pageAAAAAAAAADDBAAAA   58817.42   2030.70  -5520.46\n7   catalog channel  catalog_pageAAAAAAAAAEABAAAA  229721.31   6538.01  -2992.13\n8   catalog channel  catalog_pageAAAAAAAAAEDBAAAA   62447.72    530.01  -5267.51\n9   catalog channel  catalog_pageAAAAAAAAAFABAAAA  194677.71  16620.45 -10280.60\n10  catalog channel  catalog_pageAAAAAAAAAFDBAAAA   61529.68   1386.19 -11633.03\n11  catalog channel  catalog_pageAAAAAAAAAGABAAAA  245535.13  13788.68 -22571.30\n12  catalog channel  catalog_pageAAAAAAAAAGDBAAAA   43203.87   2556.91 -10092.64\n13  catalog channel  catalog_pageAAAAAAAAAHABAAAA  206528.09  12688.88 -30074.16\n14  catalog channel  catalog_pageAAAAAAAAAHDBAAAA   56053.39   1553.07  -8907.02\n15  catalog channel  catalog_pageAAAAAAAAAIABAAAA  116221.71   5959.78 -26614.14\n16  catalog channel  catalog_pageAAAAAAAAAIDBAAAA   34205.30   1159.23 -22081.76\n17  catalog channel  catalog_pageAAAAAAAAAJABAAAA  124614.05   2855.05  -6506.35\n18  catalog channel  catalog_pageAAAAAAAAAKABAAAA  144829.21   3540.52  -4256.89\n...*/"
    }
]