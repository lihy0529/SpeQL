[
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        'unknown' as s_state, 0 as g_state,\n        0 as agg1,\n        0 as agg2,\n        0 as agg3,\n        0 as agg4\n from item\n where /*CURSOR_IDENTIFIER*/\n       1=1 -- Placeholder condition to fix syntax error\n)\nselect * from results;",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , 'unknown' AS \"S_STATE\" , 0 AS \"G_STATE\" , 0 AS \"AGG1\" , 0 AS \"AGG2\" , 0 AS \"AGG3\" , 0 AS \"AGG4\" FROM \"ITEM\" AS \"ITEM\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , 'unknown' AS \"S_STATE\" , 0 AS \"G_STATE\" , 0 AS \"AGG1\" , 0 AS \"AGG2\" , 0 AS \"AGG3\" , 0 AS \"AGG4\" FROM \"ITEM\" AS \"ITEM\" LIMIT 21",
                "preview": "\n/*           i_item_id  s_state  g_state  agg1  agg2  agg3  agg4\n0   AAAAAAAAKAAAAAAA  unknown        0     0     0     0     0\n1   AAAAAAAAABAAAAAA  unknown        0     0     0     0     0\n2   AAAAAAAADBAAAAAA  unknown        0     0     0     0     0\n3   AAAAAAAAMEAAAAAA  unknown        0     0     0     0     0\n4   AAAAAAAAKGAAAAAA  unknown        0     0     0     0     0\n5   AAAAAAAAAHAAAAAA  unknown        0     0     0     0     0\n6   AAAAAAAACIAAAAAA  unknown        0     0     0     0     0\n7   AAAAAAAALLAAAAAA  unknown        0     0     0     0     0\n8   AAAAAAAAOLAAAAAA  unknown        0     0     0     0     0\n9   AAAAAAAAIMAAAAAA  unknown        0     0     0     0     0\n10  AAAAAAAAPNAAAAAA  unknown        0     0     0     0     0\n11  AAAAAAAAAOAAAAAA  unknown        0     0     0     0     0\n12  AAAAAAAAEPAAAAAA  unknown        0     0     0     0     0\n13  AAAAAAAAICBAAAAA  unknown        0     0     0     0     0\n14  AAAAAAAAIHBAAAAA  unknown        0     0     0     0     0\n15  AAAAAAAAOHBAAAAA  unknown        0     0     0     0     0\n16  AAAAAAAAKJBAAAAA  unknown        0     0     0     0     0\n17  AAAAAAAAKLBAAAAA  unknown        0     0     0     0     0\n18  AAAAAAAAGMBAAAAA  unknown        0     0     0     0     0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.035934,
                    "execution_time": 0.004167,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.025422
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.094642,
                    "execution_time": 0.004137,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.082751
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", 'unknown' AS \"S_STATE\", 0 AS \"G_STATE\", 0 AS \"AGG1\", 0 AS \"AGG2\", 0 AS \"AGG3\", 0 AS \"AGG4\" FROM \"ITEM\" AS \"ITEM\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", 'unknown' AS \"S_STATE\", 0 AS \"G_STATE\", 0 AS \"AGG1\", 0 AS \"AGG2\", 0 AS \"AGG3\", 0 AS \"AGG4\" FROM \"ITEM\" AS \"ITEM\""
            }
        ],
        "preview": "\n/*           i_item_id  s_state  g_state  agg1  agg2  agg3  agg4\n0   AAAAAAAAKAAAAAAA  unknown        0     0     0     0     0\n1   AAAAAAAAABAAAAAA  unknown        0     0     0     0     0\n2   AAAAAAAADBAAAAAA  unknown        0     0     0     0     0\n3   AAAAAAAAMEAAAAAA  unknown        0     0     0     0     0\n4   AAAAAAAAKGAAAAAA  unknown        0     0     0     0     0\n5   AAAAAAAAAHAAAAAA  unknown        0     0     0     0     0\n6   AAAAAAAACIAAAAAA  unknown        0     0     0     0     0\n7   AAAAAAAALLAAAAAA  unknown        0     0     0     0     0\n8   AAAAAAAAOLAAAAAA  unknown        0     0     0     0     0\n9   AAAAAAAAIMAAAAAA  unknown        0     0     0     0     0\n10  AAAAAAAAPNAAAAAA  unknown        0     0     0     0     0\n11  AAAAAAAAAOAAAAAA  unknown        0     0     0     0     0\n12  AAAAAAAAEPAAAAAA  unknown        0     0     0     0     0\n13  AAAAAAAAICBAAAAA  unknown        0     0     0     0     0\n14  AAAAAAAAIHBAAAAA  unknown        0     0     0     0     0\n15  AAAAAAAAOHBAAAAA  unknown        0     0     0     0     0\n16  AAAAAAAAKJBAAAAA  unknown        0     0     0     0     0\n17  AAAAAAAAKLBAAAAA  unknown        0     0     0     0     0\n18  AAAAAAAAGMBAAAAA  unknown        0     0     0     0     0\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity as agg1,\n        ss_list_price as agg2,\n        ss_coupon_amt as agg3,\n        ss_sales_price as agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n) /*CURSOR_IDENTIFIER*/ select * from results",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.233668,
                    "execution_time": 0.088896,
                    "compile_time": 0.000464,
                    "planning_time": 0.06069,
                    "create_size": 320
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.475289,
                    "execution_time": 0.118774,
                    "compile_time": 0.125599,
                    "planning_time": 0.142542,
                    "create_size": 320
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAPCJOAAAA      SD        0    70    6.18     0.00    2.53\n1   AAAAAAAAPIOAAAAA      SD        0     5   62.56     0.00   48.17\n2   AAAAAAAAKHBKAAAA      SD        0    42  123.90   636.85   21.06\n3   AAAAAAAABMECAAAA      SD        0    85   93.07     0.00   34.43\n4   AAAAAAAAIPBEAAAA      SD        0    73  142.70   839.58   88.47\n5   AAAAAAAADFDEBAAA      SD        0    59  122.30     0.00  106.40\n6   AAAAAAAAMJLHBAAA      SD        0     5   98.15     0.00   35.33\n7   AAAAAAAACCEEBAAA      SD        0    94   59.07     0.00   25.99\n8   AAAAAAAAPEFABAAA      SD        0    13   78.67     0.00   41.69\n9   AAAAAAAAMCAFAAAA      SD        0    58   75.57     0.00   11.33\n10  AAAAAAAAJDPGBAAA      SD        0    22  130.93     0.00   94.26\n11  AAAAAAAANKHHAAAA      SD        0     6   44.13     0.00   10.59\n12  AAAAAAAACKNNAAAA      SD        0    25   14.28     0.00    0.42\n13  AAAAAAAAJGEGAAAA      SD        0    85   37.83     0.00   16.26\n14  AAAAAAAAOCJJAAAA      SD        0    30   29.94   557.23   19.76\n15  AAAAAAAAPMPGBAAA      SD        0    68   98.36     0.00   82.62\n16  AAAAAAAADPEAAAAA      SD        0    15  116.10    43.84   10.44\n17  AAAAAAAAEIMFAAAA      SD        0    59  193.60  4883.07   87.12\n18  AAAAAAAACPOJAAAA      SD        0    59   11.73     0.00    7.50\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017449,
                    "execution_time": 0.007249,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003979
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055425,
                    "execution_time": 0.008211,
                    "compile_time": 6e-05,
                    "planning_time": 0.039371
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"STORE\".\"S_STATE\" AS \"S_STATE\", 0 AS \"G_STATE\", \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\", \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\", \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\", \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAPCJOAAAA      SD        0    70    6.18     0.00    2.53\n1   AAAAAAAAPIOAAAAA      SD        0     5   62.56     0.00   48.17\n2   AAAAAAAAKHBKAAAA      SD        0    42  123.90   636.85   21.06\n3   AAAAAAAABMECAAAA      SD        0    85   93.07     0.00   34.43\n4   AAAAAAAAIPBEAAAA      SD        0    73  142.70   839.58   88.47\n5   AAAAAAAADFDEBAAA      SD        0    59  122.30     0.00  106.40\n6   AAAAAAAAMJLHBAAA      SD        0     5   98.15     0.00   35.33\n7   AAAAAAAACCEEBAAA      SD        0    94   59.07     0.00   25.99\n8   AAAAAAAAPEFABAAA      SD        0    13   78.67     0.00   41.69\n9   AAAAAAAAMCAFAAAA      SD        0    58   75.57     0.00   11.33\n10  AAAAAAAAJDPGBAAA      SD        0    22  130.93     0.00   94.26\n11  AAAAAAAANKHHAAAA      SD        0     6   44.13     0.00   10.59\n12  AAAAAAAACKNNAAAA      SD        0    25   14.28     0.00    0.42\n13  AAAAAAAAJGEGAAAA      SD        0    85   37.83     0.00   16.26\n14  AAAAAAAAOCJJAAAA      SD        0    30   29.94   557.23   19.76\n15  AAAAAAAAPMPGBAAA      SD        0    68   98.36     0.00   82.62\n16  AAAAAAAADPEAAAAA      SD        0    15  116.10    43.84   10.44\n17  AAAAAAAAEIMFAAAA      SD        0    59  193.60  4883.07   87.12\n18  AAAAAAAACPOJAAAA      SD        0    59   11.73     0.00    7.50\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n ) \n/*CURSOR_IDENTIFIER*/ select * from results",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"S_STATE\" AS \"S_STATE\" , \"G_STATE\" AS \"G_STATE\" , \"AGG1\" AS \"AGG1\" , \"AGG2\" AS \"AGG2\" , \"AGG3\" AS \"AGG3\" , \"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0   AAAAAAAAEECKAAAA      SD        0  16.0  121.53   710.47  76.56\n1   AAAAAAAABCLLAAAA      SD        0   4.0   69.56     0.00   4.86\n2   AAAAAAAAODKKAAAA      SD        0  59.0   74.13     0.00  30.39\n3   AAAAAAAAHLKMAAAA      SD        0  71.0   23.63     0.00   2.83\n4   AAAAAAAAMFLJAAAA      SD        0  97.0   49.56     0.00  16.35\n5   AAAAAAAAKDLHBAAA      SD        0  29.0  119.14     0.00   4.76\n6   AAAAAAAAAMKKAAAA      SD        0  77.0  138.80  4809.42  83.28\n7   AAAAAAAAANIOAAAA      SD        0  53.0   94.17     0.00  86.63\n8   AAAAAAAAIIBOAAAA      SD        0  69.0   95.68     0.00  48.79\n9   AAAAAAAAKANMAAAA      SD        0  82.0  130.32     0.00  92.52\n10  AAAAAAAAOGEEAAAA      SD        0  27.0  134.58     0.00  37.68\n11  AAAAAAAABLPABAAA      SD        0   6.0   51.88     0.00  10.37\n12  AAAAAAAAMBMNAAAA      SD        0  56.0   70.90     0.00  48.21\n13  AAAAAAAAKMEPAAAA      SD        0  55.0  188.03     0.00  22.56\n14  AAAAAAAADBIHAAAA      SD        0   6.0   88.02     0.00  53.69\n15  AAAAAAAABLKFBAAA      SD        0  43.0   62.81     0.00   4.39\n16  AAAAAAAABCPGBAAA      SD        0  13.0   27.06     0.00   3.51\n17  AAAAAAAAIMDOAAAA      SD        0   NaN   37.33      NaN  30.23\n18  AAAAAAAAKOBGAAAA      SD        0  22.0   70.42     0.00  51.40\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018131,
                    "execution_time": 0.007843,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.003894
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052668,
                    "execution_time": 0.00714,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039046
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"STORE\".\"S_STATE\" AS \"S_STATE\", 0 AS \"G_STATE\", \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\", \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\", \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\", \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"I_ITEM_ID\" AS \"I_ITEM_ID\", \"S_STATE\" AS \"S_STATE\", \"G_STATE\" AS \"G_STATE\", \"AGG1\" AS \"AGG1\", \"AGG2\" AS \"AGG2\", \"AGG3\" AS \"AGG3\", \"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0   AAAAAAAAEECKAAAA      SD        0  16.0  121.53   710.47  76.56\n1   AAAAAAAABCLLAAAA      SD        0   4.0   69.56     0.00   4.86\n2   AAAAAAAAODKKAAAA      SD        0  59.0   74.13     0.00  30.39\n3   AAAAAAAAHLKMAAAA      SD        0  71.0   23.63     0.00   2.83\n4   AAAAAAAAMFLJAAAA      SD        0  97.0   49.56     0.00  16.35\n5   AAAAAAAAKDLHBAAA      SD        0  29.0  119.14     0.00   4.76\n6   AAAAAAAAAMKKAAAA      SD        0  77.0  138.80  4809.42  83.28\n7   AAAAAAAAANIOAAAA      SD        0  53.0   94.17     0.00  86.63\n8   AAAAAAAAIIBOAAAA      SD        0  69.0   95.68     0.00  48.79\n9   AAAAAAAAKANMAAAA      SD        0  82.0  130.32     0.00  92.52\n10  AAAAAAAAOGEEAAAA      SD        0  27.0  134.58     0.00  37.68\n11  AAAAAAAABLPABAAA      SD        0   6.0   51.88     0.00  10.37\n12  AAAAAAAAMBMNAAAA      SD        0  56.0   70.90     0.00  48.21\n13  AAAAAAAAKMEPAAAA      SD        0  55.0  188.03     0.00  22.56\n14  AAAAAAAADBIHAAAA      SD        0   6.0   88.02     0.00  53.69\n15  AAAAAAAABLKFBAAA      SD        0  43.0   62.81     0.00   4.39\n16  AAAAAAAABCPGBAAA      SD        0  13.0   27.06     0.00   3.51\n17  AAAAAAAAIMDOAAAA      SD        0   NaN   37.33      NaN  30.23\n18  AAAAAAAAKOBGAAAA      SD        0  22.0   70.42     0.00  51.40\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n/*CURSOR_IDENTIFIER*/ select * from results",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"S_STATE\" AS \"S_STATE\" , \"G_STATE\" AS \"G_STATE\" , \"AGG1\" AS \"AGG1\" , \"AGG2\" AS \"AGG2\" , \"AGG3\" AS \"AGG3\" , \"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAHPKOAAAA      SD        0    10    7.34    15.31    5.28\n1   AAAAAAAAAPFPAAAA      SD        0    26   63.11     0.00    0.00\n2   AAAAAAAAMKJEAAAA      SD        0    59   61.25     0.00   45.93\n3   AAAAAAAAJDMKAAAA      SD        0    56  111.75     0.00   74.87\n4   AAAAAAAAMGJFAAAA      SD        0    70   29.60     0.00    2.36\n5   AAAAAAAAJJOEBAAA      SD        0    78   69.94     0.00   48.95\n6   AAAAAAAAKOPEAAAA      SD        0    26   55.68     0.00   38.41\n7   AAAAAAAAKMPPAAAA      SD        0     2  141.99     0.00   75.25\n8   AAAAAAAAAIJIBAAA      SD        0    81  105.95     0.00   57.21\n9   AAAAAAAAPOIPAAAA      SD        0    38   22.07   309.33   18.09\n10  AAAAAAAAPDBGAAAA      SD        0    18  105.55     0.00   40.10\n11  AAAAAAAAEHGOAAAA      SD        0    47   55.50    23.72    7.21\n12  AAAAAAAAGNJAAAAA      SD        0    44   83.95   180.95   11.75\n13  AAAAAAAACJFMAAAA      SD        0    60   74.03     0.00   45.89\n14  AAAAAAAAEJBBBAAA      SD        0    32   26.46     0.00   26.46\n15  AAAAAAAAODCFBAAA      SD        0     9  145.75     0.00  134.09\n16  AAAAAAAALGGOAAAA      SD        0    95   77.58  2188.75   41.89\n17  AAAAAAAADKNEBAAA      SD        0    98    4.07     0.00    3.62\n18  AAAAAAAAGEHAAAAA      SD        0    52  104.59     0.00   63.79\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018018,
                    "execution_time": 0.007719,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.004019
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017537,
                    "execution_time": 0.007217,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.003961
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"STORE\".\"S_STATE\" AS \"S_STATE\", 0 AS \"G_STATE\", \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\", \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\", \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\", \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"I_ITEM_ID\" AS \"I_ITEM_ID\", \"S_STATE\" AS \"S_STATE\", \"G_STATE\" AS \"G_STATE\", \"AGG1\" AS \"AGG1\", \"AGG2\" AS \"AGG2\", \"AGG3\" AS \"AGG3\", \"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAHPKOAAAA      SD        0    10    7.34    15.31    5.28\n1   AAAAAAAAAPFPAAAA      SD        0    26   63.11     0.00    0.00\n2   AAAAAAAAMKJEAAAA      SD        0    59   61.25     0.00   45.93\n3   AAAAAAAAJDMKAAAA      SD        0    56  111.75     0.00   74.87\n4   AAAAAAAAMGJFAAAA      SD        0    70   29.60     0.00    2.36\n5   AAAAAAAAJJOEBAAA      SD        0    78   69.94     0.00   48.95\n6   AAAAAAAAKOPEAAAA      SD        0    26   55.68     0.00   38.41\n7   AAAAAAAAKMPPAAAA      SD        0     2  141.99     0.00   75.25\n8   AAAAAAAAAIJIBAAA      SD        0    81  105.95     0.00   57.21\n9   AAAAAAAAPOIPAAAA      SD        0    38   22.07   309.33   18.09\n10  AAAAAAAAPDBGAAAA      SD        0    18  105.55     0.00   40.10\n11  AAAAAAAAEHGOAAAA      SD        0    47   55.50    23.72    7.21\n12  AAAAAAAAGNJAAAAA      SD        0    44   83.95   180.95   11.75\n13  AAAAAAAACJFMAAAA      SD        0    60   74.03     0.00   45.89\n14  AAAAAAAAEJBBBAAA      SD        0    32   26.46     0.00   26.46\n15  AAAAAAAAODCFBAAA      SD        0     9  145.75     0.00  134.09\n16  AAAAAAAALGGOAAAA      SD        0    95   77.58  2188.75   41.89\n17  AAAAAAAADKNEBAAA      SD        0    98    4.07     0.00    3.62\n18  AAAAAAAAGEHAAAAA      SD        0    52  104.59     0.00   63.79\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id\n/*CURSOR_IDENTIFIER*/ from results",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.073564,
                    "execution_time": 0.039247,
                    "compile_time": 0.00023,
                    "planning_time": 0.002976,
                    "create_size": 136
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.170328,
                    "execution_time": 0.040011,
                    "compile_time": 0.000241,
                    "planning_time": 0.095731,
                    "create_size": 136
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*           i_item_id\n0   AAAAAAAACIKBBAAA\n1   AAAAAAAADFDFAAAA\n2   AAAAAAAAGMGKAAAA\n3   AAAAAAAAPHBBBAAA\n4   AAAAAAAAAHOBBAAA\n5   AAAAAAAANJDMAAAA\n6   AAAAAAAAOJOGAAAA\n7   AAAAAAAALLJPAAAA\n8   AAAAAAAAIAIMAAAA\n9   AAAAAAAADDBIBAAA\n10  AAAAAAAAKNLCBAAA\n11  AAAAAAAAMJBMAAAA\n12  AAAAAAAAOIJPAAAA\n13  AAAAAAAAEPCBBAAA\n14  AAAAAAAANENHAAAA\n15  AAAAAAAANBKABAAA\n16  AAAAAAAAMLKGBAAA\n17  AAAAAAAAOJFGAAAA\n18  AAAAAAAAAPMEAAAA\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015381,
                    "execution_time": 0.006644,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.002978
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052296,
                    "execution_time": 0.007396,
                    "compile_time": 4.1e-05,
                    "planning_time": 0.037704
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*           i_item_id\n0   AAAAAAAACIKBBAAA\n1   AAAAAAAADFDFAAAA\n2   AAAAAAAAGMGKAAAA\n3   AAAAAAAAPHBBBAAA\n4   AAAAAAAAAHOBBAAA\n5   AAAAAAAANJDMAAAA\n6   AAAAAAAAOJOGAAAA\n7   AAAAAAAALLJPAAAA\n8   AAAAAAAAIAIMAAAA\n9   AAAAAAAADDBIBAAA\n10  AAAAAAAAKNLCBAAA\n11  AAAAAAAAMJBMAAAA\n12  AAAAAAAAOIJPAAAA\n13  AAAAAAAAEPCBBAAA\n14  AAAAAAAANENHAAAA\n15  AAAAAAAANBKABAAA\n16  AAAAAAAAMLKGBAAA\n17  AAAAAAAAOJFGAAAA\n18  AAAAAAAAAPMEAAAA\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select i_item_id, s_state, g_state, agg1, agg2, agg3, agg4 from results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"S_STATE\" AS \"S_STATE\" , \"G_STATE\" AS \"G_STATE\" , \"AGG1\" AS \"AGG1\" , \"AGG2\" AS \"AGG2\" , \"AGG3\" AS \"AGG3\" , \"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAHPKOAAAA      SD        0    10    7.34    15.31    5.28\n1   AAAAAAAAAPFPAAAA      SD        0    26   63.11     0.00    0.00\n2   AAAAAAAAMKJEAAAA      SD        0    59   61.25     0.00   45.93\n3   AAAAAAAAJDMKAAAA      SD        0    56  111.75     0.00   74.87\n4   AAAAAAAAMGJFAAAA      SD        0    70   29.60     0.00    2.36\n5   AAAAAAAAJJOEBAAA      SD        0    78   69.94     0.00   48.95\n6   AAAAAAAAKOPEAAAA      SD        0    26   55.68     0.00   38.41\n7   AAAAAAAAKMPPAAAA      SD        0     2  141.99     0.00   75.25\n8   AAAAAAAAAIJIBAAA      SD        0    81  105.95     0.00   57.21\n9   AAAAAAAAPOIPAAAA      SD        0    38   22.07   309.33   18.09\n10  AAAAAAAAPDBGAAAA      SD        0    18  105.55     0.00   40.10\n11  AAAAAAAAEHGOAAAA      SD        0    47   55.50    23.72    7.21\n12  AAAAAAAAGNJAAAAA      SD        0    44   83.95   180.95   11.75\n13  AAAAAAAACJFMAAAA      SD        0    60   74.03     0.00   45.89\n14  AAAAAAAAEJBBBAAA      SD        0    32   26.46     0.00   26.46\n15  AAAAAAAAODCFBAAA      SD        0     9  145.75     0.00  134.09\n16  AAAAAAAALGGOAAAA      SD        0    95   77.58  2188.75   41.89\n17  AAAAAAAADKNEBAAA      SD        0    98    4.07     0.00    3.62\n18  AAAAAAAAGEHAAAAA      SD        0    52  104.59     0.00   63.79\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017083,
                    "execution_time": 0.007083,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003845
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017984,
                    "execution_time": 0.007422,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004039
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"STORE\".\"S_STATE\" AS \"S_STATE\", 0 AS \"G_STATE\", \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\", \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\", \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\", \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"I_ITEM_ID\" AS \"I_ITEM_ID\", \"S_STATE\" AS \"S_STATE\", \"G_STATE\" AS \"G_STATE\", \"AGG1\" AS \"AGG1\", \"AGG2\" AS \"AGG2\", \"AGG3\" AS \"AGG3\", \"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAHPKOAAAA      SD        0    10    7.34    15.31    5.28\n1   AAAAAAAAAPFPAAAA      SD        0    26   63.11     0.00    0.00\n2   AAAAAAAAMKJEAAAA      SD        0    59   61.25     0.00   45.93\n3   AAAAAAAAJDMKAAAA      SD        0    56  111.75     0.00   74.87\n4   AAAAAAAAMGJFAAAA      SD        0    70   29.60     0.00    2.36\n5   AAAAAAAAJJOEBAAA      SD        0    78   69.94     0.00   48.95\n6   AAAAAAAAKOPEAAAA      SD        0    26   55.68     0.00   38.41\n7   AAAAAAAAKMPPAAAA      SD        0     2  141.99     0.00   75.25\n8   AAAAAAAAAIJIBAAA      SD        0    81  105.95     0.00   57.21\n9   AAAAAAAAPOIPAAAA      SD        0    38   22.07   309.33   18.09\n10  AAAAAAAAPDBGAAAA      SD        0    18  105.55     0.00   40.10\n11  AAAAAAAAEHGOAAAA      SD        0    47   55.50    23.72    7.21\n12  AAAAAAAAGNJAAAAA      SD        0    44   83.95   180.95   11.75\n13  AAAAAAAACJFMAAAA      SD        0    60   74.03     0.00   45.89\n14  AAAAAAAAEJBBBAAA      SD        0    32   26.46     0.00   26.46\n15  AAAAAAAAODCFBAAA      SD        0     9  145.75     0.00  134.09\n16  AAAAAAAALGGOAAAA      SD        0    95   77.58  2188.75   41.89\n17  AAAAAAAADKNEBAAA      SD        0    98    4.07     0.00    3.62\n18  AAAAAAAAGEHAAAAA      SD        0    52  104.59     0.00   63.79\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"S_STATE\" AS \"S_STATE\" , \"G_STATE\" AS \"G_STATE\" , \"AGG1\" AS \"AGG1\" , \"AGG2\" AS \"AGG2\" , \"AGG3\" AS \"AGG3\" , \"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAPCJOAAAA      SD        0    70    6.18     0.00    2.53\n1   AAAAAAAAPIOAAAAA      SD        0     5   62.56     0.00   48.17\n2   AAAAAAAAKHBKAAAA      SD        0    42  123.90   636.85   21.06\n3   AAAAAAAABMECAAAA      SD        0    85   93.07     0.00   34.43\n4   AAAAAAAAIPBEAAAA      SD        0    73  142.70   839.58   88.47\n5   AAAAAAAADFDEBAAA      SD        0    59  122.30     0.00  106.40\n6   AAAAAAAAMJLHBAAA      SD        0     5   98.15     0.00   35.33\n7   AAAAAAAACCEEBAAA      SD        0    94   59.07     0.00   25.99\n8   AAAAAAAAPEFABAAA      SD        0    13   78.67     0.00   41.69\n9   AAAAAAAAMCAFAAAA      SD        0    58   75.57     0.00   11.33\n10  AAAAAAAAJDPGBAAA      SD        0    22  130.93     0.00   94.26\n11  AAAAAAAANKHHAAAA      SD        0     6   44.13     0.00   10.59\n12  AAAAAAAACKNNAAAA      SD        0    25   14.28     0.00    0.42\n13  AAAAAAAAJGEGAAAA      SD        0    85   37.83     0.00   16.26\n14  AAAAAAAAOCJJAAAA      SD        0    30   29.94   557.23   19.76\n15  AAAAAAAAPMPGBAAA      SD        0    68   98.36     0.00   82.62\n16  AAAAAAAADPEAAAAA      SD        0    15  116.10    43.84   10.44\n17  AAAAAAAAEIMFAAAA      SD        0    59  193.60  4883.07   87.12\n18  AAAAAAAACPOJAAAA      SD        0    59   11.73     0.00    7.50\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016946,
                    "execution_time": 0.007095,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003738
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017688,
                    "execution_time": 0.007384,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004009
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"STORE\".\"S_STATE\" AS \"S_STATE\", 0 AS \"G_STATE\", \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\", \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\", \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\", \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"I_ITEM_ID\" AS \"I_ITEM_ID\", \"S_STATE\" AS \"S_STATE\", \"G_STATE\" AS \"G_STATE\", \"AGG1\" AS \"AGG1\", \"AGG2\" AS \"AGG2\", \"AGG3\" AS \"AGG3\", \"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAPCJOAAAA      SD        0    70    6.18     0.00    2.53\n1   AAAAAAAAPIOAAAAA      SD        0     5   62.56     0.00   48.17\n2   AAAAAAAAKHBKAAAA      SD        0    42  123.90   636.85   21.06\n3   AAAAAAAABMECAAAA      SD        0    85   93.07     0.00   34.43\n4   AAAAAAAAIPBEAAAA      SD        0    73  142.70   839.58   88.47\n5   AAAAAAAADFDEBAAA      SD        0    59  122.30     0.00  106.40\n6   AAAAAAAAMJLHBAAA      SD        0     5   98.15     0.00   35.33\n7   AAAAAAAACCEEBAAA      SD        0    94   59.07     0.00   25.99\n8   AAAAAAAAPEFABAAA      SD        0    13   78.67     0.00   41.69\n9   AAAAAAAAMCAFAAAA      SD        0    58   75.57     0.00   11.33\n10  AAAAAAAAJDPGBAAA      SD        0    22  130.93     0.00   94.26\n11  AAAAAAAANKHHAAAA      SD        0     6   44.13     0.00   10.59\n12  AAAAAAAACKNNAAAA      SD        0    25   14.28     0.00    0.42\n13  AAAAAAAAJGEGAAAA      SD        0    85   37.83     0.00   16.26\n14  AAAAAAAAOCJJAAAA      SD        0    30   29.94   557.23   19.76\n15  AAAAAAAAPMPGBAAA      SD        0    68   98.36     0.00   82.62\n16  AAAAAAAADPEAAAAA      SD        0    15  116.10    43.84   10.44\n17  AAAAAAAAEIMFAAAA      SD        0    59  193.60  4883.07   87.12\n18  AAAAAAAACPOJAAAA      SD        0    59   11.73     0.00    7.50\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\ngroup by i_item_id, s_state /*CURSOR_IDENTIFIER*/ )",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"STORE\".\"S_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"STORE\".\"S_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.231994,
                    "execution_time": 0.092689,
                    "compile_time": 0.000533,
                    "planning_time": 0.062438,
                    "create_size": 240
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.313055,
                    "execution_time": 0.090438,
                    "compile_time": 0.000522,
                    "planning_time": 0.143482,
                    "create_size": 240
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2    agg3    agg4\n0   AAAAAAAAKAAGBAAA      SD        0    40   89.93    0.00   34.17\n1   AAAAAAAAMGNGAAAA      SD        0    58   27.04    0.00    9.28\n2   AAAAAAAAMOGIBAAA      SD        0     4  151.26    0.00  127.05\n3   AAAAAAAAMKGFBAAA      SD        0    97   37.90    0.00   34.11\n4   AAAAAAAAFMGOAAAA      SD        0    51   22.18    0.00   13.54\n5   AAAAAAAAIFBCAAAA      SD        0    33    3.61    0.00    1.73\n6   AAAAAAAAGOCKAAAA      SD        0    90   37.25    0.00   14.41\n7   AAAAAAAAENPCBAAA      SD        0    54   58.48    0.00   21.10\n8   AAAAAAAAPIOAAAAA      SD        0    26   85.18    0.00   32.17\n9   AAAAAAAAMCAFAAAA      SD        0    76  112.33    0.00   29.52\n10  AAAAAAAAPMPGBAAA      SD        0    49   63.47   55.59   35.94\n11  AAAAAAAADIENAAAA      SD        0    86  142.16    0.00    7.10\n12  AAAAAAAAAHOBBAAA      SD        0    48   53.61    0.00   40.74\n13  AAAAAAAAOJFGAAAA      SD        0    63   99.98  595.84   85.98\n14  AAAAAAAAAPDHAAAA      SD        0    67  112.94    0.00   72.28\n15  AAAAAAAANOJEAAAA      SD        0    38   59.59    0.00   12.06\n16  AAAAAAAAGIDAAAAA      SD        0     3  124.83    0.00   68.65\n17  AAAAAAAAGCCDAAAA      SD        0    56   91.65    0.00   20.11\n18  AAAAAAAAKKAHBAAA      SD        0     3   71.18    0.00   67.62\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018435,
                    "execution_time": 0.007918,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004062
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05562,
                    "execution_time": 0.008317,
                    "compile_time": 5e-05,
                    "planning_time": 0.039315
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"STORE\".\"S_STATE\" AS \"S_STATE\", 0 AS \"G_STATE\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"STORE\".\"S_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2    agg3    agg4\n0   AAAAAAAAKAAGBAAA      SD        0    40   89.93    0.00   34.17\n1   AAAAAAAAMGNGAAAA      SD        0    58   27.04    0.00    9.28\n2   AAAAAAAAMOGIBAAA      SD        0     4  151.26    0.00  127.05\n3   AAAAAAAAMKGFBAAA      SD        0    97   37.90    0.00   34.11\n4   AAAAAAAAFMGOAAAA      SD        0    51   22.18    0.00   13.54\n5   AAAAAAAAIFBCAAAA      SD        0    33    3.61    0.00    1.73\n6   AAAAAAAAGOCKAAAA      SD        0    90   37.25    0.00   14.41\n7   AAAAAAAAENPCBAAA      SD        0    54   58.48    0.00   21.10\n8   AAAAAAAAPIOAAAAA      SD        0    26   85.18    0.00   32.17\n9   AAAAAAAAMCAFAAAA      SD        0    76  112.33    0.00   29.52\n10  AAAAAAAAPMPGBAAA      SD        0    49   63.47   55.59   35.94\n11  AAAAAAAADIENAAAA      SD        0    86  142.16    0.00    7.10\n12  AAAAAAAAAHOBBAAA      SD        0    48   53.61    0.00   40.74\n13  AAAAAAAAOJFGAAAA      SD        0    63   99.98  595.84   85.98\n14  AAAAAAAAAPDHAAAA      SD        0    67  112.94    0.00   72.28\n15  AAAAAAAANOJEAAAA      SD        0    38   59.59    0.00   12.06\n16  AAAAAAAAGIDAAAAA      SD        0     3  124.83    0.00   68.65\n17  AAAAAAAAGCCDAAAA      SD        0    56   91.65    0.00   20.11\n18  AAAAAAAAKKAHBAAA      SD        0     3   71.18    0.00   67.62\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n/*CURSOR_IDENTIFIER*/\n   ) as t",
        "optimize": [
            "WITH \"T\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"STORE\".\"S_STATE\" ) SELECT \"T\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"T\".\"S_STATE\" AS \"S_STATE\" , \"T\".\"G_STATE\" AS \"G_STATE\" , \"T\".\"AGG1\" AS \"AGG1\" , \"T\".\"AGG2\" AS \"AGG2\" , \"T\".\"AGG3\" AS \"AGG3\" , \"T\".\"AGG4\" AS \"AGG4\" FROM \"T\" AS \"T\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0   AAAAAAAAKPFBAAAA      SD        0    73  119.67     0.00  61.03\n1   AAAAAAAAJAJBAAAA      SD        0     7   93.31     0.00  24.26\n2   AAAAAAAAKFLOAAAA      SD        0    26   76.32     0.00  25.55\n3   AAAAAAAAKGMNAAAA      SD        0    20   93.20     0.00  36.34\n4   AAAAAAAAIJACBAAA      SD        0    51   65.60     0.00  11.18\n5   AAAAAAAACAJOAAAA      SD        0    44   38.75     0.00   9.68\n6   AAAAAAAANIDBAAAA      SD        0    50   65.13   328.23  46.89\n7   AAAAAAAAGJJIAAAA      SD        0    57   41.63     0.00  30.47\n8   AAAAAAAAEOICAAAA      SD        0    58  112.56     0.00  64.15\n9   AAAAAAAAIDBABAAA      SD        0    22   64.20    72.28  31.23\n10  AAAAAAAAPBMAAAAA      SD        0    62   51.10   202.95  26.56\n11  AAAAAAAAHAPPAAAA      SD        0    24   85.43     0.00  23.92\n12  AAAAAAAAJBAFBAAA      SD        0    75  104.27     0.00  96.97\n13  AAAAAAAABBICBAAA      SD        0     8   81.01     0.00  27.54\n14  AAAAAAAAINKHAAAA      SD        0    68   37.21     0.00  32.00\n15  AAAAAAAACLECBAAA      SD        0    86   91.68     0.00  83.42\n16  AAAAAAAAAFFHAAAA      SD        0    51   98.50     0.00  51.22\n17  AAAAAAAAANBGAAAA      SD        0    22   74.10     0.00  66.69\n18  AAAAAAAAEMLOAAAA      SD        0    80  100.00  1589.68  55.01\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017419,
                    "execution_time": 0.007165,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003994
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017846,
                    "execution_time": 0.00723,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.00415
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0   AAAAAAAAKPFBAAAA      SD        0    73  119.67     0.00  61.03\n1   AAAAAAAAJAJBAAAA      SD        0     7   93.31     0.00  24.26\n2   AAAAAAAAKFLOAAAA      SD        0    26   76.32     0.00  25.55\n3   AAAAAAAAKGMNAAAA      SD        0    20   93.20     0.00  36.34\n4   AAAAAAAAIJACBAAA      SD        0    51   65.60     0.00  11.18\n5   AAAAAAAACAJOAAAA      SD        0    44   38.75     0.00   9.68\n6   AAAAAAAANIDBAAAA      SD        0    50   65.13   328.23  46.89\n7   AAAAAAAAGJJIAAAA      SD        0    57   41.63     0.00  30.47\n8   AAAAAAAAEOICAAAA      SD        0    58  112.56     0.00  64.15\n9   AAAAAAAAIDBABAAA      SD        0    22   64.20    72.28  31.23\n10  AAAAAAAAPBMAAAAA      SD        0    62   51.10   202.95  26.56\n11  AAAAAAAAHAPPAAAA      SD        0    24   85.43     0.00  23.92\n12  AAAAAAAAJBAFBAAA      SD        0    75  104.27     0.00  96.97\n13  AAAAAAAABBICBAAA      SD        0     8   81.01     0.00  27.54\n14  AAAAAAAAINKHAAAA      SD        0    68   37.21     0.00  32.00\n15  AAAAAAAACLECBAAA      SD        0    86   91.68     0.00  83.42\n16  AAAAAAAAAFFHAAAA      SD        0    51   98.50     0.00  51.22\n17  AAAAAAAAANBGAAAA      SD        0    22   74.10     0.00  66.69\n18  AAAAAAAAEMLOAAAA      SD        0    80  100.00  1589.68  55.01\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n/*CURSOR_IDENTIFIER*/ select i_item_id, s_state, 0 as g_state, sum(agg1) agg1, sum(agg2) agg2, sum(agg3) agg3, sum(agg4) agg4 from results group by i_item_id, s_state ) as t",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" ) , \"T\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , SUM ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , SUM ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , SUM ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , SUM ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" ) SELECT \"T\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"T\".\"S_STATE\" AS \"S_STATE\" , \"T\".\"G_STATE\" AS \"G_STATE\" , \"T\".\"AGG1\" AS \"AGG1\" , \"T\".\"AGG2\" AS \"AGG2\" , \"T\".\"AGG3\" AS \"AGG3\" , \"T\".\"AGG4\" AS \"AGG4\" FROM \"T\" AS \"T\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.125346,
                    "execution_time": 0.048241,
                    "compile_time": 0.000248,
                    "planning_time": 0.003704,
                    "create_size": 288
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.307307,
                    "execution_time": 0.046891,
                    "compile_time": 0.123141,
                    "planning_time": 0.060878,
                    "create_size": 279
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.194154,
                    "execution_time": 0.074562,
                    "compile_time": 0.000409,
                    "planning_time": 0.009523,
                    "create_size": 510
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.239649,
                    "execution_time": 0.075896,
                    "compile_time": 0.000415,
                    "planning_time": 0.051192,
                    "create_size": 480
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAPHEBBAAA      SD        0    74   35.68     0.00   13.20\n1   AAAAAAAAOLKOAAAA      SD        0    89   27.00     0.00   11.34\n2   AAAAAAAAFEIOAAAA      SD        0     6   25.13     0.00   12.81\n3   AAAAAAAAADNAAAAA      SD        0    51  168.99   190.41   28.72\n4   AAAAAAAAINIIAAAA      SD        0    35    6.83     0.00    3.27\n5   AAAAAAAAHFOFAAAA      SD        0    79   46.92     0.00    2.81\n6   AAAAAAAAKBEOAAAA      SD        0    66  141.05     0.00  115.66\n7   AAAAAAAAOFINAAAA      SD        0    30   48.58     0.00   13.60\n8   AAAAAAAABGOHAAAA      SD        0    77   30.24   821.43   12.70\n9   AAAAAAAAACLDBAAA      SD        0    10  133.02     0.00   49.21\n10  AAAAAAAAGGKAAAAA      SD        0    62   78.54     0.00   40.84\n11  AAAAAAAAMMCMAAAA      SD        0    38  195.30     0.00  119.13\n12  AAAAAAAAGKPAAAAA      SD        0    14  114.77  1040.22   89.52\n13  AAAAAAAAELKMAAAA      SD        0    19   74.13   339.26   24.46\n14  AAAAAAAAKILPAAAA      SD        0    43   37.35     0.00   16.43\n15  AAAAAAAAELHIBAAA      SD        0    34  175.12     0.00  154.10\n16  AAAAAAAAIICNAAAA      SD        0    30  126.17   123.01   82.01\n17  AAAAAAAAKIBDBAAA      SD        0    38  104.16     0.00    1.04\n18  AAAAAAAAEPLDBAAA      SD        0    28   35.62     0.00   28.49\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018201,
                    "execution_time": 0.007855,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003995
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054866,
                    "execution_time": 0.007585,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039398
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAPHEBBAAA      SD        0    74   35.68     0.00   13.20\n1   AAAAAAAAOLKOAAAA      SD        0    89   27.00     0.00   11.34\n2   AAAAAAAAFEIOAAAA      SD        0     6   25.13     0.00   12.81\n3   AAAAAAAAADNAAAAA      SD        0    51  168.99   190.41   28.72\n4   AAAAAAAAINIIAAAA      SD        0    35    6.83     0.00    3.27\n5   AAAAAAAAHFOFAAAA      SD        0    79   46.92     0.00    2.81\n6   AAAAAAAAKBEOAAAA      SD        0    66  141.05     0.00  115.66\n7   AAAAAAAAOFINAAAA      SD        0    30   48.58     0.00   13.60\n8   AAAAAAAABGOHAAAA      SD        0    77   30.24   821.43   12.70\n9   AAAAAAAAACLDBAAA      SD        0    10  133.02     0.00   49.21\n10  AAAAAAAAGGKAAAAA      SD        0    62   78.54     0.00   40.84\n11  AAAAAAAAMMCMAAAA      SD        0    38  195.30     0.00  119.13\n12  AAAAAAAAGKPAAAAA      SD        0    14  114.77  1040.22   89.52\n13  AAAAAAAAELKMAAAA      SD        0    19   74.13   339.26   24.46\n14  AAAAAAAAKILPAAAA      SD        0    43   37.35     0.00   16.43\n15  AAAAAAAAELHIBAAA      SD        0    34  175.12     0.00  154.10\n16  AAAAAAAAIICNAAAA      SD        0    30  126.17   123.01   82.01\n17  AAAAAAAAKIBDBAAA      SD        0    38  104.16     0.00    1.04\n18  AAAAAAAAEPLDBAAA      SD        0    28   35.62     0.00   28.49\n...*/"
    },
    {
        "input": "with /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX', 'MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4)\n/*CURSOR_IDENTIFIER*/\n        from results\n        group by i_item_id\n   )",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"_COL_6\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"_COL_6\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.241864,
                    "execution_time": 0.105333,
                    "compile_time": 0.000527,
                    "planning_time": 0.063161,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.324231,
                    "execution_time": 0.105192,
                    "compile_time": 0.000522,
                    "planning_time": 0.143811,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_6\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_6\" AS \"_COL_6\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2    agg3  _col_6\n0   AAAAAAAAIKEABAAA    None        1    59   81.65    5.71   16.32\n1   AAAAAAAAMGDLAAAA    None        1    14  109.61    0.00   75.63\n2   AAAAAAAAEDIKAAAA    None        1    26  156.30    0.00   92.21\n3   AAAAAAAAGGDBAAAA    None        1    91    2.19   70.82    1.81\n4   AAAAAAAAHPINAAAA    None        1    57   61.46    0.00   60.23\n5   AAAAAAAACMECAAAA    None        1    54   76.67    0.00   57.92\n6   AAAAAAAAGOINAAAA    None        1    56   86.44    0.00   83.84\n7   AAAAAAAACHHFBAAA    None        1    87   23.22    0.00   11.84\n8   AAAAAAAAOONMAAAA    None        1    21   60.62    0.00   55.77\n9   AAAAAAAAOPFCBAAA    None        1    19   81.97   19.77   35.59\n10  AAAAAAAAEBOGAAAA    None        1    26   42.74    0.00   29.91\n11  AAAAAAAAAEAJAAAA    None        1    42   81.89   15.15    1.23\n12  AAAAAAAAEMJJAAAA    None        1    98   31.52    0.00    6.93\n13  AAAAAAAAMEINAAAA    None        1    42   83.73    0.00   30.98\n14  AAAAAAAAKGDCBAAA    None        1    63   96.35  707.69   51.06\n15  AAAAAAAAKNOMAAAA    None        1    44   64.29    0.00    7.07\n16  AAAAAAAAIFOHBAAA    None        1    52   61.66    0.00   45.62\n17  AAAAAAAAMIDCAAAA    None        1    43   70.35    0.00   36.58\n18  AAAAAAAAOPJIAAAA    None        1    33   94.26   38.85   65.07\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017977,
                    "execution_time": 0.008081,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003834
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056574,
                    "execution_time": 0.009206,
                    "compile_time": 5e-05,
                    "planning_time": 0.03942
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", NULL AS \"S_STATE\", 1 AS \"G_STATE\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"_COL_6\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_6\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_6\" AS \"_COL_6\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2    agg3  _col_6\n0   AAAAAAAAIKEABAAA    None        1    59   81.65    5.71   16.32\n1   AAAAAAAAMGDLAAAA    None        1    14  109.61    0.00   75.63\n2   AAAAAAAAEDIKAAAA    None        1    26  156.30    0.00   92.21\n3   AAAAAAAAGGDBAAAA    None        1    91    2.19   70.82    1.81\n4   AAAAAAAAHPINAAAA    None        1    57   61.46    0.00   60.23\n5   AAAAAAAACMECAAAA    None        1    54   76.67    0.00   57.92\n6   AAAAAAAAGOINAAAA    None        1    56   86.44    0.00   83.84\n7   AAAAAAAACHHFBAAA    None        1    87   23.22    0.00   11.84\n8   AAAAAAAAOONMAAAA    None        1    21   60.62    0.00   55.77\n9   AAAAAAAAOPFCBAAA    None        1    19   81.97   19.77   35.59\n10  AAAAAAAAEBOGAAAA    None        1    26   42.74    0.00   29.91\n11  AAAAAAAAAEAJAAAA    None        1    42   81.89   15.15    1.23\n12  AAAAAAAAEMJJAAAA    None        1    98   31.52    0.00    6.93\n13  AAAAAAAAMEINAAAA    None        1    42   83.73    0.00   30.98\n14  AAAAAAAAKGDCBAAA    None        1    63   96.35  707.69   51.06\n15  AAAAAAAAKNOMAAAA    None        1    44   64.29    0.00    7.07\n16  AAAAAAAAIFOHBAAA    None        1    52   61.66    0.00   45.62\n17  AAAAAAAAMIDCAAAA    None        1    43   70.35    0.00   36.58\n18  AAAAAAAAOPJIAAAA    None        1    33   94.26   38.85   65.07\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\ngroup by i_item_id /*CURSOR_IDENTIFIER*/ ) as t",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.240085,
                    "execution_time": 0.10585,
                    "compile_time": 0.000516,
                    "planning_time": 0.061907,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.32051,
                    "execution_time": 0.105,
                    "compile_time": 0.000508,
                    "planning_time": 0.142994,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAHEMBBAAA    None        1    28   56.03   770.95   46.21\n1   AAAAAAAAMELKAAAA    None        1    36   11.26     0.00    0.78\n2   AAAAAAAABIEMAAAA    None        1    28  109.66     0.00   15.35\n3   AAAAAAAANIAABAAA    None        1    13  155.21     0.00  149.00\n4   AAAAAAAAEFHAAAAA    None        1    68   67.05     0.00   23.68\n5   AAAAAAAAGLCDAAAA    None        1   100   98.78     0.00   96.80\n6   AAAAAAAABFMABAAA    None        1    58  119.77     0.00   95.81\n7   AAAAAAAABACEAAAA    None        1    87   41.72   249.71   15.99\n8   AAAAAAAAEIILAAAA    None        1    84    4.60     0.00    3.95\n9   AAAAAAAAOEEGAAAA    None        1    29   29.66   451.47   22.24\n10  AAAAAAAALFKLAAAA    None        1    13  106.18  1284.42   99.80\n11  AAAAAAAACNHAAAAA    None        1    18   66.10     0.00   29.74\n12  AAAAAAAAIBGGBAAA    None        1    52  126.31     0.00  105.95\n13  AAAAAAAACGKOAAAA    None        1    31  116.00     0.00   40.60\n14  AAAAAAAAGJKDBAAA    None        1    70    2.89     0.00    2.74\n15  AAAAAAAADKEOAAAA    None        1    96   76.41  2428.50   58.83\n16  AAAAAAAAMAGHAAAA    None        1    37  135.33     0.00  127.21\n17  AAAAAAAAMBHCBAAA    None        1    79    4.51     0.00    1.26\n18  AAAAAAAAFMLFBAAA    None        1    18   73.79     0.00   47.96\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017789,
                    "execution_time": 0.00743,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.00389
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054582,
                    "execution_time": 0.008325,
                    "compile_time": 5e-05,
                    "planning_time": 0.039581
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", NULL AS \"S_STATE\", 1 AS \"G_STATE\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_7\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAHEMBBAAA    None        1    28   56.03   770.95   46.21\n1   AAAAAAAAMELKAAAA    None        1    36   11.26     0.00    0.78\n2   AAAAAAAABIEMAAAA    None        1    28  109.66     0.00   15.35\n3   AAAAAAAANIAABAAA    None        1    13  155.21     0.00  149.00\n4   AAAAAAAAEFHAAAAA    None        1    68   67.05     0.00   23.68\n5   AAAAAAAAGLCDAAAA    None        1   100   98.78     0.00   96.80\n6   AAAAAAAABFMABAAA    None        1    58  119.77     0.00   95.81\n7   AAAAAAAABACEAAAA    None        1    87   41.72   249.71   15.99\n8   AAAAAAAAEIILAAAA    None        1    84    4.60     0.00    3.95\n9   AAAAAAAAOEEGAAAA    None        1    29   29.66   451.47   22.24\n10  AAAAAAAALFKLAAAA    None        1    13  106.18  1284.42   99.80\n11  AAAAAAAACNHAAAAA    None        1    18   66.10     0.00   29.74\n12  AAAAAAAAIBGGBAAA    None        1    52  126.31     0.00  105.95\n13  AAAAAAAACGKOAAAA    None        1    31  116.00     0.00   40.60\n14  AAAAAAAAGJKDBAAA    None        1    70    2.89     0.00    2.74\n15  AAAAAAAADKEOAAAA    None        1    96   76.41  2428.50   58.83\n16  AAAAAAAAMAGHAAAA    None        1    37  135.33     0.00  127.21\n17  AAAAAAAAMBHCBAAA    None        1    79    4.51     0.00    1.26\n18  AAAAAAAAFMLFBAAA    None        1    18   73.79     0.00   47.96\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        group by i_item_id\n/*CURSOR_IDENTIFIER*/ ) as t",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" ) , \"T\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" ) SELECT \"T\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"T\".\"S_STATE\" AS \"S_STATE\" , \"T\".\"G_STATE\" AS \"G_STATE\" , \"T\".\"AGG1\" AS \"AGG1\" , \"T\".\"AGG2\" AS \"AGG2\" , \"T\".\"AGG3\" AS \"AGG3\" , \"T\".\"AGG4\" AS \"AGG4\" FROM \"T\" AS \"T\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.192809,
                    "execution_time": 0.075039,
                    "compile_time": 0.000409,
                    "planning_time": 0.009353,
                    "create_size": 530
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.236757,
                    "execution_time": 0.076288,
                    "compile_time": 0.000433,
                    "planning_time": 0.051039,
                    "create_size": 490
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAALGPIAAAA      SD        0    70   66.50     0.00   34.25\n1   AAAAAAAAEBEEAAAA      SD        0    50   33.11     0.00   25.82\n2   AAAAAAAAJCCPAAAA      SD        0    16  146.45  1372.79  136.19\n3   AAAAAAAAMMMGBAAA      SD        0    45   90.63     0.00   16.31\n4   AAAAAAAAKDHCBAAA      SD        0    51  106.37     0.00   23.40\n5   AAAAAAAAMECOAAAA      SD        0    49   61.49     0.00   40.58\n6   AAAAAAAADPNCBAAA      SD        0    27  163.06     0.00   63.59\n7   AAAAAAAABNNABAAA      SD        0    88   63.67     0.00   17.83\n8   AAAAAAAAJFKBAAAA      SD        0    93   65.43   481.21    5.88\n9   AAAAAAAACEFMAAAA      SD        0    22   64.66     0.00   16.40\n10  AAAAAAAAKJDAAAAA      SD        0    46  127.53     0.00   48.44\n11  AAAAAAAAAIHFAAAA      SD        0    48    4.82     0.00    2.65\n12  AAAAAAAAFNNCBAAA      SD        0    15   46.31     0.00   35.19\n13  AAAAAAAAIIDPAAAA      SD        0    66   97.92     0.00   17.16\n14  AAAAAAAAOMPPAAAA      SD        0    47   25.86     0.00   15.37\n15  AAAAAAAAAKDDBAAA      SD        0    45   87.64     0.00   18.40\n16  AAAAAAAACPJDAAAA      SD        0    50  144.88     0.00  124.59\n17  AAAAAAAACIONAAAA      SD        0    58   85.22     0.00   58.80\n18  AAAAAAAAGNLKAAAA      SD        0    55   27.11     0.00   16.80\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01751,
                    "execution_time": 0.007369,
                    "compile_time": 6.9e-05,
                    "planning_time": 0.00389
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053641,
                    "execution_time": 0.00782,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039462
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_8\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAALGPIAAAA      SD        0    70   66.50     0.00   34.25\n1   AAAAAAAAEBEEAAAA      SD        0    50   33.11     0.00   25.82\n2   AAAAAAAAJCCPAAAA      SD        0    16  146.45  1372.79  136.19\n3   AAAAAAAAMMMGBAAA      SD        0    45   90.63     0.00   16.31\n4   AAAAAAAAKDHCBAAA      SD        0    51  106.37     0.00   23.40\n5   AAAAAAAAMECOAAAA      SD        0    49   61.49     0.00   40.58\n6   AAAAAAAADPNCBAAA      SD        0    27  163.06     0.00   63.59\n7   AAAAAAAABNNABAAA      SD        0    88   63.67     0.00   17.83\n8   AAAAAAAAJFKBAAAA      SD        0    93   65.43   481.21    5.88\n9   AAAAAAAACEFMAAAA      SD        0    22   64.66     0.00   16.40\n10  AAAAAAAAKJDAAAAA      SD        0    46  127.53     0.00   48.44\n11  AAAAAAAAAIHFAAAA      SD        0    48    4.82     0.00    2.65\n12  AAAAAAAAFNNCBAAA      SD        0    15   46.31     0.00   35.19\n13  AAAAAAAAIIDPAAAA      SD        0    66   97.92     0.00   17.16\n14  AAAAAAAAOMPPAAAA      SD        0    47   25.86     0.00   15.37\n15  AAAAAAAAAKDDBAAA      SD        0    45   87.64     0.00   18.40\n16  AAAAAAAACPJDAAAA      SD        0    50  144.88     0.00  124.59\n17  AAAAAAAACIONAAAA      SD        0    58   85.22     0.00   58.80\n18  AAAAAAAAGNLKAAAA      SD        0    55   27.11     0.00   16.80\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        group by i_item_id\n         union all\nselect NULL AS i_item_id, NULL AS s_state, 2 AS g_state, sum(agg1) agg1, sum(agg2) agg2, sum(agg3) agg3, sum(agg4) agg4 from results\n/*CURSOR_IDENTIFIER*/ ) as t",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" ) , \"T\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 2 AS \"G_STATE\" , SUM ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , SUM ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , SUM ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , SUM ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"T\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"T\".\"S_STATE\" AS \"S_STATE\" , \"T\".\"G_STATE\" AS \"G_STATE\" , \"T\".\"AGG1\" AS \"AGG1\" , \"T\".\"AGG2\" AS \"AGG2\" , \"T\".\"AGG3\" AS \"AGG3\" , \"T\".\"AGG4\" AS \"AGG4\" FROM \"T\" AS \"T\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 2 AS \"G_STATE\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , SUM ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.214921,
                    "execution_time": 0.084636,
                    "compile_time": 0.000546,
                    "planning_time": 0.013507,
                    "create_size": 490
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.263635,
                    "execution_time": 0.089836,
                    "compile_time": 0.000518,
                    "planning_time": 0.054896,
                    "create_size": 490
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAODKKAAAA      SD        0    64   45.86     0.00   25.84\n1   AAAAAAAAAMKKAAAA      SD        0    40   78.39  2404.71   48.20\n2   AAAAAAAABLPABAAA      SD        0    37   96.61  1719.32   65.96\n3   AAAAAAAADBIHAAAA      SD        0     6   88.02     0.00   53.69\n4   AAAAAAAABLKFBAAA      SD        0    43   62.81     0.00    4.39\n5   AAAAAAAAFHAGBAAA      SD        0    59  114.09  1893.39  110.66\n6   AAAAAAAAACBEAAAA      SD        0    13  107.27   548.87   43.98\n7   AAAAAAAAJDGBAAAA      SD        0    83  113.98     0.00  109.42\n8   AAAAAAAAHOAKAAAA      SD        0    43   37.95   125.52   29.22\n9   AAAAAAAAEIFEBAAA      SD        0    97   24.37    12.10    0.24\n10  AAAAAAAAGMEAAAAA      SD        0    16   80.81     0.00   44.39\n11  AAAAAAAAPJIEBAAA      SD        0    55   22.96    18.68   16.99\n12  AAAAAAAAACELAAAA      SD        0    71  133.58  2688.52  108.19\n13  AAAAAAAADHCABAAA      SD        0    29   70.12     0.00   39.14\n14  AAAAAAAAKDKHBAAA      SD        0    76   40.16     0.00   16.15\n15  AAAAAAAAMGFCAAAA      SD        0    71   65.19     0.00    9.12\n16  AAAAAAAALLBEBAAA      SD        0    55   16.09     0.00    9.81\n17  AAAAAAAAMJEHAAAA      SD        0    38   81.88     0.00   67.14\n18  AAAAAAAAKDPAAAAA      SD        0    14   68.78      NaN     NaN\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018034,
                    "execution_time": 0.007898,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003929
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05519,
                    "execution_time": 0.007598,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.039503
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_9\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAODKKAAAA      SD        0    64   45.86     0.00   25.84\n1   AAAAAAAAAMKKAAAA      SD        0    40   78.39  2404.71   48.20\n2   AAAAAAAABLPABAAA      SD        0    37   96.61  1719.32   65.96\n3   AAAAAAAADBIHAAAA      SD        0     6   88.02     0.00   53.69\n4   AAAAAAAABLKFBAAA      SD        0    43   62.81     0.00    4.39\n5   AAAAAAAAFHAGBAAA      SD        0    59  114.09  1893.39  110.66\n6   AAAAAAAAACBEAAAA      SD        0    13  107.27   548.87   43.98\n7   AAAAAAAAJDGBAAAA      SD        0    83  113.98     0.00  109.42\n8   AAAAAAAAHOAKAAAA      SD        0    43   37.95   125.52   29.22\n9   AAAAAAAAEIFEBAAA      SD        0    97   24.37    12.10    0.24\n10  AAAAAAAAGMEAAAAA      SD        0    16   80.81     0.00   44.39\n11  AAAAAAAAPJIEBAAA      SD        0    55   22.96    18.68   16.99\n12  AAAAAAAAACELAAAA      SD        0    71  133.58  2688.52  108.19\n13  AAAAAAAADHCABAAA      SD        0    29   70.12     0.00   39.14\n14  AAAAAAAAKDKHBAAA      SD        0    76   40.16     0.00   16.15\n15  AAAAAAAAMGFCAAAA      SD        0    71   65.19     0.00    9.12\n16  AAAAAAAALLBEBAAA      SD        0    55   16.09     0.00    9.81\n17  AAAAAAAAMJEHAAAA      SD        0    38   81.88     0.00   67.14\n18  AAAAAAAAKDPAAAAA      SD        0    14   68.78      NaN     NaN\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity as agg1,\n        ss_list_price as agg2,\n        ss_coupon_amt as agg3,\n        ss_sales_price as agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) as agg1, avg(agg2) as agg2, avg(agg3) as agg3, avg(agg4) as agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) as agg1, avg(agg2) as agg2, avg(agg3) as agg3,\n         avg(agg4) as agg4 from results\n        group by i_item_id\n         union all\n        select NULL AS i_item_id, NULL as s_state, 1 as g_state, avg(agg1) as agg1, avg(agg2) as agg2, avg(agg3) as agg3,\n/*CURSOR_IDENTIFIER*/ avg(agg4) as agg4 from results)",
        "optimize": [
            "SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.17939,
                    "execution_time": 0.081649,
                    "compile_time": 0.000547,
                    "planning_time": 0.061073,
                    "create_size": 10
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.272788,
                    "execution_time": 0.080312,
                    "compile_time": 0.000552,
                    "planning_time": 0.15293,
                    "create_size": 10
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_10\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*  i_item_id s_state  g_state  agg1   agg2    agg3  agg4\n0      None    None        1    50  75.91  188.23  37.8*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017603,
                    "execution_time": 0.007188,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004004
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.0548,
                    "execution_time": 0.007823,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039189
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT NULL AS \"I_ITEM_ID\", NULL AS \"S_STATE\", 1 AS \"G_STATE\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ('TX', 'MI', 'IL', 'MN', 'NM', 'SD') AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_10\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_10\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*  i_item_id s_state  g_state  agg1   agg2    agg3  agg4\n0      None    None        1    50  75.91  188.23  37.8*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        group by i_item_id\n         union all\n        select NULL AS i_item_id, NULL as s_state, 1 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n/*CURSOR_IDENTIFIER*/ ) as t",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" ) , \"T\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"T\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"T\".\"S_STATE\" AS \"S_STATE\" , \"T\".\"G_STATE\" AS \"G_STATE\" , \"T\".\"AGG1\" AS \"AGG1\" , \"T\".\"AGG2\" AS \"AGG2\" , \"T\".\"AGG3\" AS \"AGG3\" , \"T\".\"AGG4\" AS \"AGG4\" FROM \"T\" AS \"T\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" GROUP BY \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" ) AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.214087,
                    "execution_time": 0.084992,
                    "compile_time": 0.000554,
                    "planning_time": 0.013153,
                    "create_size": 530
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.254476,
                    "execution_time": 0.08281,
                    "compile_time": 0.000532,
                    "planning_time": 0.05509,
                    "create_size": 530
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAGJMHAAAA      SD        0    44  103.58  2300.83   52.82\n1   AAAAAAAAOHDEBAAA      SD        0    89   60.22  1877.97   43.96\n2   AAAAAAAANOMBAAAA      SD        0    35    8.08    50.93    4.28\n3   AAAAAAAAPMHMAAAA      SD        0    53   11.98     0.00    7.54\n4   AAAAAAAANBOPAAAA      SD        0    75  152.07  3900.15   86.67\n5   AAAAAAAAAOLBAAAA      SD        0    25  122.51  2572.50  102.90\n6   AAAAAAAAKBCABAAA      SD        0    74   39.96     0.00    1.99\n7   AAAAAAAAEGPBAAAA      SD        0    13   25.50     0.00    9.94\n8   AAAAAAAAJBELAAAA      SD        0    20   68.06     0.00   55.80\n9   AAAAAAAAAIEHBAAA      SD        0    70   45.37     0.00   25.12\n10  AAAAAAAABPDGAAAA      SD        0    63  102.00     0.00   20.81\n11  AAAAAAAAFKIEBAAA      SD        0    21   43.58     0.00   38.78\n12  AAAAAAAAEIFPAAAA      SD        0    13   42.01     0.00   34.02\n13  AAAAAAAAEMPFBAAA      SD        0    37   72.46   121.85    9.41\n14  AAAAAAAAJFKNAAAA      SD        0    93  158.03     0.00  113.78\n15  AAAAAAAACCFIAAAA      SD        0    81   24.98     0.00    5.74\n16  AAAAAAAAKGDKAAAA      SD        0    93  166.70     0.00  150.03\n17  AAAAAAAAAPHHAAAA      SD        0    51  113.28   379.89   61.05\n18  AAAAAAAAAIJHBAAA      SD        0    28  155.39   177.50   12.43\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.0178,
                    "execution_time": 0.007474,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004034
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053589,
                    "execution_time": 0.007961,
                    "compile_time": 6.3e-05,
                    "planning_time": 0.039241
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3    agg4\n0   AAAAAAAAGJMHAAAA      SD        0    44  103.58  2300.83   52.82\n1   AAAAAAAAOHDEBAAA      SD        0    89   60.22  1877.97   43.96\n2   AAAAAAAANOMBAAAA      SD        0    35    8.08    50.93    4.28\n3   AAAAAAAAPMHMAAAA      SD        0    53   11.98     0.00    7.54\n4   AAAAAAAANBOPAAAA      SD        0    75  152.07  3900.15   86.67\n5   AAAAAAAAAOLBAAAA      SD        0    25  122.51  2572.50  102.90\n6   AAAAAAAAKBCABAAA      SD        0    74   39.96     0.00    1.99\n7   AAAAAAAAEGPBAAAA      SD        0    13   25.50     0.00    9.94\n8   AAAAAAAAJBELAAAA      SD        0    20   68.06     0.00   55.80\n9   AAAAAAAAAIEHBAAA      SD        0    70   45.37     0.00   25.12\n10  AAAAAAAABPDGAAAA      SD        0    63  102.00     0.00   20.81\n11  AAAAAAAAFKIEBAAA      SD        0    21   43.58     0.00   38.78\n12  AAAAAAAAEIFPAAAA      SD        0    13   42.01     0.00   34.02\n13  AAAAAAAAEMPFBAAA      SD        0    37   72.46   121.85    9.41\n14  AAAAAAAAJFKNAAAA      SD        0    93  158.03     0.00  113.78\n15  AAAAAAAACCFIAAAA      SD        0    81   24.98     0.00    5.74\n16  AAAAAAAAKGDKAAAA      SD        0    93  166.70     0.00  150.03\n17  AAAAAAAAAPHHAAAA      SD        0    51  113.28   379.89   61.05\n18  AAAAAAAAAIJHBAAA      SD        0    28  155.39   177.50   12.43\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        group by i_item_id\n         union all\n        select NULL AS i_item_id, NULL as s_state, 1 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        ) foo\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" ) , \"FOO\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"FOO\".\"S_STATE\" AS \"S_STATE\" , \"FOO\".\"G_STATE\" AS \"G_STATE\" , \"FOO\".\"AGG1\" AS \"AGG1\" , \"FOO\".\"AGG2\" AS \"AGG2\" , \"FOO\".\"AGG3\" AS \"AGG3\" , \"FOO\".\"AGG4\" AS \"AGG4\" FROM \"FOO\" AS \"FOO\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0   AAAAAAAAKJBDAAAA      SD        0    19   27.63   188.59  14.68\n1   AAAAAAAAMGIIAAAA      SD        0    25   31.82     7.15   9.54\n2   AAAAAAAAGGAIAAAA      SD        0    44   81.44     0.00  67.59\n3   AAAAAAAAPHMIBAAA      SD        0    97   63.71     0.00   7.64\n4   AAAAAAAAOOPNAAAA      SD        0    57  112.09  1566.49  62.44\n5   AAAAAAAAMEDIBAAA      SD        0    81  174.82     0.00  85.66\n6   AAAAAAAAGHKPAAAA      SD        0    39   82.72  1535.50  57.90\n7   AAAAAAAAKKDAAAAA      SD        0    21   88.14     0.00  15.86\n8   AAAAAAAADCEABAAA      SD        0    56   19.60     0.00   0.39\n9   AAAAAAAAENHCAAAA      SD        0    25   21.44     0.00  10.07\n10  AAAAAAAAIPGAAAAA      SD        0    48   20.16   195.91   9.07\n11  AAAAAAAALFAGAAAA      SD        0    41   93.22     0.00  54.06\n12  AAAAAAAABNACAAAA      SD        0    62   90.92     0.00  20.42\n13  AAAAAAAAIGMIBAAA      SD        0    13    1.62     2.13   0.35\n14  AAAAAAAAKOGBAAAA      SD        0    17   48.23     0.00  38.65\n15  AAAAAAAAAAFJAAAA      SD        0    33   71.50     0.00   7.15\n16  AAAAAAAAODCKAAAA      SD        0    62   93.28  1119.71  44.11\n17  AAAAAAAAILMABAAA      SD        0    65   40.60     0.00  37.75\n18  AAAAAAAAKMMPAAAA      SD        0    18  159.76     0.00  43.13\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017487,
                    "execution_time": 0.007317,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.003937
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018429,
                    "execution_time": 0.007939,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004121
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2     agg3   agg4\n0   AAAAAAAAKJBDAAAA      SD        0    19   27.63   188.59  14.68\n1   AAAAAAAAMGIIAAAA      SD        0    25   31.82     7.15   9.54\n2   AAAAAAAAGGAIAAAA      SD        0    44   81.44     0.00  67.59\n3   AAAAAAAAPHMIBAAA      SD        0    97   63.71     0.00   7.64\n4   AAAAAAAAOOPNAAAA      SD        0    57  112.09  1566.49  62.44\n5   AAAAAAAAMEDIBAAA      SD        0    81  174.82     0.00  85.66\n6   AAAAAAAAGHKPAAAA      SD        0    39   82.72  1535.50  57.90\n7   AAAAAAAAKKDAAAAA      SD        0    21   88.14     0.00  15.86\n8   AAAAAAAADCEABAAA      SD        0    56   19.60     0.00   0.39\n9   AAAAAAAAENHCAAAA      SD        0    25   21.44     0.00  10.07\n10  AAAAAAAAIPGAAAAA      SD        0    48   20.16   195.91   9.07\n11  AAAAAAAALFAGAAAA      SD        0    41   93.22     0.00  54.06\n12  AAAAAAAABNACAAAA      SD        0    62   90.92     0.00  20.42\n13  AAAAAAAAIGMIBAAA      SD        0    13    1.62     2.13   0.35\n14  AAAAAAAAKOGBAAAA      SD        0    17   48.23     0.00  38.65\n15  AAAAAAAAAAFJAAAA      SD        0    33   71.50     0.00   7.15\n16  AAAAAAAAODCKAAAA      SD        0    62   93.28  1119.71  44.11\n17  AAAAAAAAILMABAAA      SD        0    65   40.60     0.00  37.75\n18  AAAAAAAAKMMPAAAA      SD        0    18  159.76     0.00  43.13\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        group by i_item_id\n         union all\n        select NULL AS i_item_id, NULL as s_state, 1 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        ) foo\n  order by i_item_id, s_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" ) , \"FOO\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"FOO\".\"S_STATE\" AS \"S_STATE\" , \"FOO\".\"G_STATE\" AS \"G_STATE\" , \"FOO\".\"AGG1\" AS \"AGG1\" , \"FOO\".\"AGG2\" AS \"AGG2\" , \"FOO\".\"AGG3\" AS \"AGG3\" , \"FOO\".\"AGG4\" AS \"AGG4\" FROM \"FOO\" AS \"FOO\" ORDER BY \"I_ITEM_ID\" NULLS LAST , \"S_STATE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"I_ITEM_ID\" , \"S_STATE\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2    agg3   agg4\n0   AAAAAAAAAAABBAAA      SD        0    45  137.95    0.00  34.48\n1   AAAAAAAAAAABBAAA    None        1    45  137.95    0.00  34.48\n2   AAAAAAAAAAAGBAAA      SD        0    42   74.64    0.00  34.76\n3   AAAAAAAAAAAGBAAA    None        1    42   74.64    0.00  34.76\n4   AAAAAAAAAAANAAAA      SD        0    90   58.34    0.00  11.08\n5   AAAAAAAAAAANAAAA    None        1    90   58.34    0.00  11.08\n6   AAAAAAAAAABAAAAA      SD        0    29   96.70    0.00  69.62\n7   AAAAAAAAAABAAAAA    None        1    29   96.70    0.00  69.62\n8   AAAAAAAAAABGBAAA      SD        0    78   42.31    0.00  38.50\n9   AAAAAAAAAABGBAAA    None        1    78   42.31    0.00  38.50\n10  AAAAAAAAAABKAAAA      SD        0    26   55.73  894.68  52.94\n11  AAAAAAAAAABKAAAA    None        1    26   55.73  894.68  52.94\n12  AAAAAAAAAACDAAAA      SD        0    94   71.33    0.00  49.73\n13  AAAAAAAAAACDAAAA    None        1    94   71.33    0.00  49.73\n14  AAAAAAAAAACFAAAA      SD        0    76   25.74    0.00  25.22\n15  AAAAAAAAAACFAAAA    None        1    76   25.74    0.00  25.22\n16  AAAAAAAAAACGAAAA      SD        0    63   72.57    0.00  24.67\n17  AAAAAAAAAACGAAAA    None        1    63   72.57    0.00  24.67\n18  AAAAAAAAAACHBAAA      SD        0    73   78.59    0.00  49.59\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019716,
                    "execution_time": 0.009183,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.004244
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.059877,
                    "execution_time": 0.01042,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.039581
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"I_ITEM_ID\" NULLS LAST , \"S_STATE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"I_ITEM_ID\" NULLS LAST , \"S_STATE\" NULLS LAST"
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2    agg3   agg4\n0   AAAAAAAAAAABBAAA      SD        0    45  137.95    0.00  34.48\n1   AAAAAAAAAAABBAAA    None        1    45  137.95    0.00  34.48\n2   AAAAAAAAAAAGBAAA      SD        0    42   74.64    0.00  34.76\n3   AAAAAAAAAAAGBAAA    None        1    42   74.64    0.00  34.76\n4   AAAAAAAAAAANAAAA      SD        0    90   58.34    0.00  11.08\n5   AAAAAAAAAAANAAAA    None        1    90   58.34    0.00  11.08\n6   AAAAAAAAAABAAAAA      SD        0    29   96.70    0.00  69.62\n7   AAAAAAAAAABAAAAA    None        1    29   96.70    0.00  69.62\n8   AAAAAAAAAABGBAAA      SD        0    78   42.31    0.00  38.50\n9   AAAAAAAAAABGBAAA    None        1    78   42.31    0.00  38.50\n10  AAAAAAAAAABKAAAA      SD        0    26   55.73  894.68  52.94\n11  AAAAAAAAAABKAAAA    None        1    26   55.73  894.68  52.94\n12  AAAAAAAAAACDAAAA      SD        0    94   71.33    0.00  49.73\n13  AAAAAAAAAACDAAAA    None        1    94   71.33    0.00  49.73\n14  AAAAAAAAAACFAAAA      SD        0    76   25.74    0.00  25.22\n15  AAAAAAAAAACFAAAA    None        1    76   25.74    0.00  25.22\n16  AAAAAAAAAACGAAAA      SD        0    63   72.57    0.00  24.67\n17  AAAAAAAAAACGAAAA    None        1    63   72.57    0.00  24.67\n18  AAAAAAAAAACHBAAA      SD        0    73   78.59    0.00  49.59\n...*/"
    },
    {
        "input": "-- start template query27a.tpl query 16 in stream 0\nwith /* TPC-DS query27a.tpl 0.16 */ results as\n (select i_item_id,\n        s_state, 0 as g_state,\n        ss_quantity agg1,\n        ss_list_price agg2,\n        ss_coupon_amt agg3,\n        ss_sales_price agg4\n from store_sales, customer_demographics, date_dim, store, item\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_store_sk = s_store_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       cd_gender = 'F' and\n       cd_marital_status = 'S' and\n       cd_education_status = 'Advanced Degree' and\n       d_year = 1999 and\n       s_state in ('TX','MI', 'IL', 'MN', 'NM', 'SD')\n )\n\n  select  i_item_id,\n  s_state, g_state, agg1, agg2, agg3, agg4\n   from (\n        select i_item_id, s_state, 0 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4 from results\n        group by i_item_id, s_state\n         union all\n        select i_item_id, NULL AS s_state, 1 AS g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        group by i_item_id\n         union all\n        select NULL AS i_item_id, NULL as s_state, 1 as g_state, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n         avg(agg4) agg4 from results\n        ) foo\n  order by i_item_id, s_state\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"AGG1\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"AGG2\" , \"STORE_SALES\".\"SS_COUPON_AMT\" AS \"AGG3\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'F' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'S' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STATE\" IN ( 'TX' , 'MI' , 'IL' , 'MN' , 'NM' , 'SD' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" ) , \"FOO\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" AS \"S_STATE\" , 0 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"S_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"S_STATE\" , 1 AS \"G_STATE\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"FOO\".\"S_STATE\" AS \"S_STATE\" , \"FOO\".\"G_STATE\" AS \"G_STATE\" , \"FOO\".\"AGG1\" AS \"AGG1\" , \"FOO\".\"AGG2\" AS \"AGG2\" , \"FOO\".\"AGG3\" AS \"AGG3\" , \"FOO\".\"AGG4\" AS \"AGG4\" FROM \"FOO\" AS \"FOO\" ORDER BY \"I_ITEM_ID\" NULLS LAST , \"S_STATE\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"I_ITEM_ID\" , \"S_STATE\" LIMIT 21",
                "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2    agg3   agg4\n0   AAAAAAAAAAABBAAA      SD        0    45  137.95    0.00  34.48\n1   AAAAAAAAAAABBAAA    None        1    45  137.95    0.00  34.48\n2   AAAAAAAAAAAGBAAA      SD        0    42   74.64    0.00  34.76\n3   AAAAAAAAAAAGBAAA    None        1    42   74.64    0.00  34.76\n4   AAAAAAAAAAANAAAA      SD        0    90   58.34    0.00  11.08\n5   AAAAAAAAAAANAAAA    None        1    90   58.34    0.00  11.08\n6   AAAAAAAAAABAAAAA      SD        0    29   96.70    0.00  69.62\n7   AAAAAAAAAABAAAAA    None        1    29   96.70    0.00  69.62\n8   AAAAAAAAAABGBAAA      SD        0    78   42.31    0.00  38.50\n9   AAAAAAAAAABGBAAA    None        1    78   42.31    0.00  38.50\n10  AAAAAAAAAABKAAAA      SD        0    26   55.73  894.68  52.94\n11  AAAAAAAAAABKAAAA    None        1    26   55.73  894.68  52.94\n12  AAAAAAAAAACDAAAA      SD        0    94   71.33    0.00  49.73\n13  AAAAAAAAAACDAAAA    None        1    94   71.33    0.00  49.73\n14  AAAAAAAAAACFAAAA      SD        0    76   25.74    0.00  25.22\n15  AAAAAAAAAACFAAAA    None        1    76   25.74    0.00  25.22\n16  AAAAAAAAAACGAAAA      SD        0    63   72.57    0.00  24.67\n17  AAAAAAAAAACGAAAA    None        1    63   72.57    0.00  24.67\n18  AAAAAAAAAACHBAAA      SD        0    73   78.59    0.00  49.59\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020291,
                    "execution_time": 0.00943,
                    "compile_time": 7.7e-05,
                    "planning_time": 0.004265
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020179,
                    "execution_time": 0.009241,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.004452
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"I_ITEM_ID\" NULLS LAST , \"S_STATE\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"G_STATE\" AS \"G_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_11\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"I_ITEM_ID\" NULLS LAST , \"S_STATE\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*           i_item_id s_state  g_state  agg1    agg2    agg3   agg4\n0   AAAAAAAAAAABBAAA      SD        0    45  137.95    0.00  34.48\n1   AAAAAAAAAAABBAAA    None        1    45  137.95    0.00  34.48\n2   AAAAAAAAAAAGBAAA      SD        0    42   74.64    0.00  34.76\n3   AAAAAAAAAAAGBAAA    None        1    42   74.64    0.00  34.76\n4   AAAAAAAAAAANAAAA      SD        0    90   58.34    0.00  11.08\n5   AAAAAAAAAAANAAAA    None        1    90   58.34    0.00  11.08\n6   AAAAAAAAAABAAAAA      SD        0    29   96.70    0.00  69.62\n7   AAAAAAAAAABAAAAA    None        1    29   96.70    0.00  69.62\n8   AAAAAAAAAABGBAAA      SD        0    78   42.31    0.00  38.50\n9   AAAAAAAAAABGBAAA    None        1    78   42.31    0.00  38.50\n10  AAAAAAAAAABKAAAA      SD        0    26   55.73  894.68  52.94\n11  AAAAAAAAAABKAAAA    None        1    26   55.73  894.68  52.94\n12  AAAAAAAAAACDAAAA      SD        0    94   71.33    0.00  49.73\n13  AAAAAAAAAACDAAAA    None        1    94   71.33    0.00  49.73\n14  AAAAAAAAAACFAAAA      SD        0    76   25.74    0.00  25.22\n15  AAAAAAAAAACFAAAA    None        1    76   25.74    0.00  25.22\n16  AAAAAAAAAACGAAAA      SD        0    63   72.57    0.00  24.67\n17  AAAAAAAAAACGAAAA    None        1    63   72.57    0.00  24.67\n18  AAAAAAAAAACHBAAA      SD        0    73   78.59    0.00  49.59\n...*/"
    }
]