[
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store \ngroup by i_manufact_id /*CURSOR_IDENTIFIER*/ ) as sales_data",
        "optimize": [
            "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\", SUM(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"SUM_SALES\", AVG(SUM(\"STORE_SALES\".\"SS_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_MANUFACT_ID\") AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "rewrite": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" CROSS JOIN \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\n1=1 /*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\", SUM(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"SUM_SALES\", AVG(SUM(\"STORE_SALES\".\"SS_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_MANUFACT_ID\") AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "rewrite": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and 1=1 /*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.228061,
                    "execution_time": 3.150856,
                    "compile_time": 0.000496,
                    "planning_time": 0.049726,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.314286,
                    "execution_time": 3.155357,
                    "compile_time": 0.000504,
                    "planning_time": 0.127734,
                    "create_size": 1536
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    i_manufact_id     sum_sales  avg_quarterly_sales\n0              56  1.720828e+08         1.720828e+08\n1             135  1.932521e+08         1.932521e+08\n2             179  1.965058e+08         1.965058e+08\n3             243  1.811904e+08         1.811904e+08\n4             947  3.601708e+07         3.601708e+07\n5               1  1.896301e+08         1.896301e+08\n6              61  1.423058e+08         1.423058e+08\n7             148  1.776953e+08         1.776953e+08\n8             434  1.013413e+08         1.013413e+08\n9             504  9.567298e+07         9.567298e+07\n10            522  8.782116e+07         8.782116e+07\n11            590  1.073337e+08         1.073337e+08\n12            752  4.029489e+07         4.029489e+07\n13            877  1.624700e+07         1.624700e+07\n14            946  2.321287e+07         2.321287e+07\n15            231  2.107066e+08         2.107066e+08\n16            315  2.149063e+08         2.149063e+08\n17            331  2.073581e+08         2.073581e+08\n18            397  1.245397e+08         1.245397e+08\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018119,
                    "execution_time": 0.007836,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.004415
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055122,
                    "execution_time": 0.007675,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.039846
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\", SUM(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"SUM_SALES\", AVG(SUM(\"STORE_SALES\".\"SS_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_MANUFACT_ID\") AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    i_manufact_id     sum_sales  avg_quarterly_sales\n0              56  1.720828e+08         1.720828e+08\n1             135  1.932521e+08         1.932521e+08\n2             179  1.965058e+08         1.965058e+08\n3             243  1.811904e+08         1.811904e+08\n4             947  3.601708e+07         3.601708e+07\n5               1  1.896301e+08         1.896301e+08\n6              61  1.423058e+08         1.423058e+08\n7             148  1.776953e+08         1.776953e+08\n8             434  1.013413e+08         1.013413e+08\n9             504  9.567298e+07         9.567298e+07\n10            522  8.782116e+07         8.782116e+07\n11            590  1.073337e+08         1.073337e+08\n12            752  4.029489e+07         4.029489e+07\n13            877  1.624700e+07         1.624700e+07\n14            946  2.321287e+07         2.321287e+07\n15            231  2.107066e+08         2.107066e+08\n16            315  2.149063e+08         2.149063e+08\n17            331  2.073581e+08         2.073581e+08\n18            397  1.245397e+08         1.245397e+08\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk\n/*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\" ) SELECT \"SALES_DATA\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SALES_DATA\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SALES_DATA\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SALES_DATA\" AS \"SALES_DATA\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.321795,
                    "execution_time": 0.244303,
                    "compile_time": 0.00049,
                    "planning_time": 0.050475,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.405683,
                    "execution_time": 0.244668,
                    "compile_time": 0.000484,
                    "planning_time": 0.132596,
                    "create_size": 1536
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    i_manufact_id   sum_sales  avg_quarterly_sales\n0             181  1981661.69           1981661.69\n1             183  1971381.25           1971381.25\n2             215  1828238.54           1828238.54\n3             220  1633595.25           1633595.25\n4             285  1607948.33           1607948.33\n5             305  1631606.49           1631606.49\n6             427  1057658.18           1057658.18\n7             478   989908.32            989908.32\n8             496   865952.43            865952.43\n9             536   861281.60            861281.60\n10            741   235875.42            235875.42\n11            808   373459.28            373459.28\n12            837   315772.00            315772.00\n13              7  1577153.40           1577153.40\n14             74  1723805.81           1723805.81\n15            314  1990976.20           1990976.20\n16            322  1842259.54           1842259.54\n17            579   827416.13            827416.13\n18            650   845486.82            845486.82\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018174,
                    "execution_time": 0.007989,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.004342
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053034,
                    "execution_time": 0.007657,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.039481
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_2\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    i_manufact_id   sum_sales  avg_quarterly_sales\n0             181  1981661.69           1981661.69\n1             183  1971381.25           1971381.25\n2             215  1828238.54           1828238.54\n3             220  1633595.25           1633595.25\n4             285  1607948.33           1607948.33\n5             305  1631606.49           1631606.49\n6             427  1057658.18           1057658.18\n7             478   989908.32            989908.32\n8             496   865952.43            865952.43\n9             536   861281.60            861281.60\n10            741   235875.42            235875.42\n11            808   373459.28            373459.28\n12            837   315772.00            315772.00\n13              7  1577153.40           1577153.40\n14             74  1723805.81           1723805.81\n15            314  1990976.20           1990976.20\n16            322  1842259.54           1842259.54\n17            579   827416.13            827416.13\n18            650   845486.82            845486.82\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) \n/*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\" ) SELECT \"SALES_DATA\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SALES_DATA\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SALES_DATA\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SALES_DATA\" AS \"SALES_DATA\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.189002,
                    "execution_time": 0.109287,
                    "compile_time": 0.000533,
                    "planning_time": 0.051781,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.267453,
                    "execution_time": 0.109903,
                    "compile_time": 0.000526,
                    "planning_time": 0.127855,
                    "create_size": 1536
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0               7  306424.60            306424.60\n1              74  378569.75            378569.75\n2             314  396498.82            396498.82\n3             322  354319.97            354319.97\n4             579  158284.41            158284.41\n5             650  188304.20            188304.20\n6             693   52552.37             52552.37\n7             707   76564.04             76564.04\n8             716   35738.59             35738.59\n9             723   57346.49             57346.49\n10            959   37288.57             37288.57\n11            633  154688.28            154688.28\n12            672   43369.33             43369.33\n13            849   89671.10             89671.10\n14            933   61275.99             61275.99\n15            181  410891.81            410891.81\n16            183  374826.73            374826.73\n17            215  364283.72            364283.72\n18            220  329149.66            329149.66\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018227,
                    "execution_time": 0.008099,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.004261
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054194,
                    "execution_time": 0.008184,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.039736
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_3\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0               7  306424.60            306424.60\n1              74  378569.75            378569.75\n2             314  396498.82            396498.82\n3             322  354319.97            354319.97\n4             579  158284.41            158284.41\n5             650  188304.20            188304.20\n6             693   52552.37             52552.37\n7             707   76564.04             76564.04\n8             716   35738.59             35738.59\n9             723   57346.49             57346.49\n10            959   37288.57             37288.57\n11            633  154688.28            154688.28\n12            672   43369.33             43369.33\n13            849   89671.10             89671.10\n14            933   61275.99             61275.99\n15            181  410891.81            410891.81\n16            183  374826.73            374826.73\n17            215  364283.72            364283.72\n18            220  329149.66            329149.66\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n(i_category in ('Books','Children','Electronics')) /*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.186991,
                    "execution_time": 0.106862,
                    "compile_time": 0.000556,
                    "planning_time": 0.052389,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.418693,
                    "execution_time": 0.108005,
                    "compile_time": 0.145276,
                    "planning_time": 0.133885,
                    "create_size": 1536
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             181   96743.55             96743.55\n1             183  122206.65            122206.65\n2             215  103066.79            103066.79\n3             220  104396.40            104396.40\n4             285   97498.86             97498.86\n5             305   90722.59             90722.59\n6             427   64958.49             64958.49\n7             478   62430.59             62430.59\n8             496   52770.80             52770.80\n9             536   64111.33             64111.33\n10            741   12440.51             12440.51\n11            808   31447.64             31447.64\n12            837   19809.02             19809.02\n13             65   88126.50             88126.50\n14             90  102821.52            102821.52\n15            153  141695.72            141695.72\n16            169   90338.53             90338.53\n17            178  123430.17            123430.17\n18            470   78577.25             78577.25\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017866,
                    "execution_time": 0.007519,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004421
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056671,
                    "execution_time": 0.007828,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.039843
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\", SUM(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"SUM_SALES\", AVG(SUM(\"STORE_SALES\".\"SS_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_MANUFACT_ID\") AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN (1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, 1220, 1221, 1222, 1223) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ('Books', 'Children', 'Electronics') GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_4\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             181   96743.55             96743.55\n1             183  122206.65            122206.65\n2             215  103066.79            103066.79\n3             220  104396.40            104396.40\n4             285   97498.86             97498.86\n5             305   90722.59             90722.59\n6             427   64958.49             64958.49\n7             478   62430.59             62430.59\n8             496   52770.80             52770.80\n9             536   64111.33             64111.33\n10            741   12440.51             12440.51\n11            808   31447.64             31447.64\n12            837   19809.02             19809.02\n13             65   88126.50             88126.50\n14             90  102821.52            102821.52\n15            153  141695.72            141695.72\n16            169   90338.53             90338.53\n17            178  123430.17            123430.17\n18            470   78577.25             78577.25\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') ))\n/*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) AND \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" ) SELECT \"SALES_DATA\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SALES_DATA\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SALES_DATA\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SALES_DATA\" AS \"SALES_DATA\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) AND \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.164939,
                    "execution_time": 0.083288,
                    "compile_time": 0.000535,
                    "planning_time": 0.054503,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.256259,
                    "execution_time": 0.089389,
                    "compile_time": 0.000553,
                    "planning_time": 0.133425,
                    "create_size": 1536
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             181    4433.70              4433.70\n1             183    4152.65              4152.65\n2             215    3595.32              3595.32\n3             220   10908.34             10908.34\n4             285   11947.53             11947.53\n5             305   10225.68             10225.68\n6             427    7289.42              7289.42\n7             478    7873.78              7873.78\n8             536    8826.07              8826.07\n9               7    3832.23              3832.23\n10            314    3797.87              3797.87\n11            322    6032.02              6032.02\n12            650   11225.93             11225.93\n13            693    4226.02              4226.02\n14            716    4139.79              4139.79\n15             65    3604.58              3604.58\n16             90   11438.97             11438.97\n17            153   15175.09             15175.09\n18            178    6686.73              6686.73\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018503,
                    "execution_time": 0.008072,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.004526
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056246,
                    "execution_time": 0.007561,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.039739
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             181    4433.70              4433.70\n1             183    4152.65              4152.65\n2             215    3595.32              3595.32\n3             220   10908.34             10908.34\n4             285   11947.53             11947.53\n5             305   10225.68             10225.68\n6             427    7289.42              7289.42\n7             478    7873.78              7873.78\n8             536    8826.07              8826.07\n9               7    3832.23              3832.23\n10            314    3797.87              3797.87\n11            322    6032.02              6032.02\n12            650   11225.93             11225.93\n13            693    4226.02              4226.02\n14            716    4139.79              4139.79\n15             65    3604.58              3604.58\n16             90   11438.97             11438.97\n17            153   15175.09             15175.09\n18            178    6686.73              6686.73\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) as sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) as avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7')\n)) /*CURSOR_IDENTIFIER*/\ngroup by i_manufact_id\n) as sales_data;",
        "optimize": [
            "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' ) AND \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) AND \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' ) AND \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.149329,
                    "execution_time": 0.065794,
                    "compile_time": 0.000554,
                    "planning_time": 0.056334,
                    "create_size": 360
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.22943,
                    "execution_time": 0.065885,
                    "compile_time": 0.000537,
                    "planning_time": 0.131537,
                    "create_size": 360
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             318    4804.39              4804.39\n1              82    4553.56              4553.56\n2             191    3955.11              3955.11\n3             893    3473.59              3473.59\n4             193    3848.04              3848.04\n5             479    3854.14              3854.14\n6               5    4028.12              4028.12\n7             268    2752.70              2752.70\n8             279    4272.55              4272.55\n9              81    3904.85              3904.85\n10             87    3508.31              3508.31\n11            552    4377.23              4377.23\n12            594    4028.72              4028.72\n13            152    4215.47              4215.47\n14            149    3939.43              3939.43\n15            103    3811.26              3811.26\n16            415    3427.72              3427.72\n17            167    3536.33              3536.33\n18            508    4431.14              4431.14\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017065,
                    "execution_time": 0.00682,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.004358
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055861,
                    "execution_time": 0.006902,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.03989
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\", SUM(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"SUM_SALES\", AVG(SUM(\"STORE_SALES\".\"SS_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_MANUFACT_ID\") AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN (1212, 1213, 1214, 1215, 1216, 1217, 1218, 1219, 1220, 1221, 1222, 1223) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"ITEM\".\"I_BRAND\" IN ('scholaramalgamalg #14', 'scholaramalgamalg #7') AND \"ITEM\".\"I_CATEGORY\" IN ('Books', 'Children', 'Electronics') AND \"ITEM\".\"I_CLASS\" IN ('personal', 'portable', 'reference', 'self-help') GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             318    4804.39              4804.39\n1              82    4553.56              4553.56\n2             191    3955.11              3955.11\n3             893    3473.59              3473.59\n4             193    3848.04              3848.04\n5             479    3854.14              3854.14\n6               5    4028.12              4028.12\n7             268    2752.70              2752.70\n8             279    4272.55              4272.55\n9              81    3904.85              3904.85\n10             87    3508.31              3508.31\n11            552    4377.23              4377.23\n12            594    4028.72              4028.72\n13            152    4215.47              4215.47\n14            149    3939.43              3939.43\n15            103    3811.26              3811.26\n16            415    3427.72              3427.72\n17            167    3536.33              3536.33\n18            508    4431.14              4431.14\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') ))\n/*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" ) SELECT \"SALES_DATA\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SALES_DATA\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SALES_DATA\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SALES_DATA\" AS \"SALES_DATA\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.204526,
                    "execution_time": 0.119774,
                    "compile_time": 0.000579,
                    "planning_time": 0.056836,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.271573,
                    "execution_time": 0.099433,
                    "compile_time": 0.000584,
                    "planning_time": 0.140308,
                    "create_size": 1536
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             181   31390.22             31390.22\n1             183   14909.51             14909.51\n2             215   28697.72             28697.72\n3             220   18933.49             18933.49\n4             285   14262.93             14262.93\n5             305   25333.84             25333.84\n6             427   29779.85             29779.85\n7             478   18657.90             18657.90\n8             496   18230.20             18230.20\n9             536   20458.73             20458.73\n10            808   16989.66             16989.66\n11             58   60035.30             60035.30\n12            219   21985.32             21985.32\n13            281   35801.02             35801.02\n14            407   29111.54             29111.54\n15            408    3160.77              3160.77\n16            464   17991.73             17991.73\n17            515   37026.70             37026.70\n18            543   14785.10             14785.10\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020522,
                    "execution_time": 0.010413,
                    "compile_time": 4.1e-05,
                    "planning_time": 0.004255
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.059822,
                    "execution_time": 0.008413,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.040227
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             181   31390.22             31390.22\n1             183   14909.51             14909.51\n2             215   28697.72             28697.72\n3             220   18933.49             18933.49\n4             285   14262.93             14262.93\n5             305   25333.84             25333.84\n6             427   29779.85             29779.85\n7             478   18657.90             18657.90\n8             496   18230.20             18230.20\n9             536   20458.73             20458.73\n10            808   16989.66             16989.66\n11             58   60035.30             60035.30\n12            219   21985.32             21985.32\n13            281   35801.02             35801.02\n14            407   29111.54             29111.54\n15            408    3160.77              3160.77\n16            464   17991.73             17991.73\n17            515   37026.70             37026.70\n18            543   14785.10             14785.10\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) as sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) as avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor (i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1'))\n)\ngroup by i_manufact_id\n) as sales_data /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" ) SELECT \"SALES_DATA\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SALES_DATA\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SALES_DATA\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SALES_DATA\" AS \"SALES_DATA\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.186884,
                    "execution_time": 0.082917,
                    "compile_time": 0.02636,
                    "planning_time": 0.055165,
                    "create_size": 612
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.570596,
                    "execution_time": 0.077992,
                    "compile_time": 3.31664,
                    "planning_time": 0.141966,
                    "create_size": 612
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0               5    4028.12              4028.12\n1             396    4140.51              4140.51\n2             499    2859.79              2859.79\n3             279    7377.64              7377.64\n4             152    4215.47              4215.47\n5             893    3473.59              3473.59\n6             262    3149.78              3149.78\n7              25    3454.67              3454.67\n8              81    3904.85              3904.85\n9              87    3508.31              3508.31\n10            350    3385.60              3385.60\n11             82    4553.56              4553.56\n12            190    3350.10              3350.10\n13            103    3811.26              3811.26\n14            415    3427.72              3427.72\n15            318    4804.39              4804.39\n16            268    2752.70              2752.70\n17             76    3212.42              3212.42\n18            552    4377.23              4377.23\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017312,
                    "execution_time": 0.007034,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.004352
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056154,
                    "execution_time": 0.00777,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.039601
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0               5    4028.12              4028.12\n1             396    4140.51              4140.51\n2             499    2859.79              2859.79\n3             279    7377.64              7377.64\n4             152    4215.47              4215.47\n5             893    3473.59              3473.59\n6             262    3149.78              3149.78\n7              25    3454.67              3454.67\n8              81    3904.85              3904.85\n9              87    3508.31              3508.31\n10            350    3385.60              3385.60\n11             82    4553.56              4553.56\n12            190    3350.10              3350.10\n13            103    3811.26              3811.26\n14            415    3427.72              3427.72\n15            318    4804.39              4804.39\n16            268    2752.70              2752.70\n17             76    3212.42              3212.42\n18            552    4377.23              4377.23\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\n/*CURSOR_IDENTIFIER*/ group by i_manufact_id ) as sales_data",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" ) SELECT \"SALES_DATA\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SALES_DATA\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SALES_DATA\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SALES_DATA\" AS \"SALES_DATA\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.155929,
                    "execution_time": 0.071192,
                    "compile_time": 0.000544,
                    "planning_time": 0.057175,
                    "create_size": 612
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.240494,
                    "execution_time": 0.075954,
                    "compile_time": 0.000564,
                    "planning_time": 0.137075,
                    "create_size": 612
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0              25    3454.67              3454.67\n1              76    3212.42              3212.42\n2             453    3849.59              3849.59\n3             149    3939.43              3939.43\n4             103    3811.26              3811.26\n5             415    3427.72              3427.72\n6             193    3848.04              3848.04\n7             479    3854.14              3854.14\n8             268    2752.70              2752.70\n9             318    4804.39              4804.39\n10            499    2859.79              2859.79\n11            279    7377.64              7377.64\n12            152    4215.47              4215.47\n13            893    3473.59              3473.59\n14            113    4669.68              4669.68\n15            191    3955.11              3955.11\n16              5    4028.12              4028.12\n17            396    4140.51              4140.51\n18            552    4377.23              4377.23\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017553,
                    "execution_time": 0.007204,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.004327
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053897,
                    "execution_time": 0.007752,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.040058
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_9\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0              25    3454.67              3454.67\n1              76    3212.42              3212.42\n2             453    3849.59              3849.59\n3             149    3939.43              3939.43\n4             103    3811.26              3811.26\n5             415    3427.72              3427.72\n6             193    3848.04              3848.04\n7             479    3854.14              3854.14\n8             268    2752.70              2752.70\n9             318    4804.39              4804.39\n10            499    2859.79              2859.79\n11            279    7377.64              7377.64\n12            152    4215.47              4215.47\n13            893    3473.59              3473.59\n14            113    4669.68              4669.68\n15            191    3955.11              3955.11\n16              5    4028.12              4028.12\n17            396    4140.51              4140.51\n18            552    4377.23              4377.23\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.163829,
                    "execution_time": 0.076515,
                    "compile_time": 0.000615,
                    "planning_time": 0.057737,
                    "create_size": 612
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.252575,
                    "execution_time": 0.081293,
                    "compile_time": 0.001722,
                    "planning_time": 0.138563,
                    "create_size": 612
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0               5     984.92              1007.03\n1               5     628.15              1007.03\n2               5    1535.06              1007.03\n3               5     879.99              1007.03\n4             396     454.15              1035.12\n5             396     913.52              1035.12\n6             396    1316.85              1035.12\n7             396    1455.99              1035.12\n8             318    1318.86              1201.09\n9             318     944.41              1201.09\n10            318    2112.86              1201.09\n11            318     428.26              1201.09\n12            268    1004.66               688.17\n13            268    1043.65               688.17\n14            268     335.54               688.17\n15            268     368.85               688.17\n16             76     843.10               803.10\n17             76     474.78               803.10\n18             76     668.99               803.10\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017398,
                    "execution_time": 0.00702,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.004421
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057062,
                    "execution_time": 0.007871,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.039998
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0               5     984.92              1007.03\n1               5     628.15              1007.03\n2               5    1535.06              1007.03\n3               5     879.99              1007.03\n4             396     454.15              1035.12\n5             396     913.52              1035.12\n6             396    1316.85              1035.12\n7             396    1455.99              1035.12\n8             318    1318.86              1201.09\n9             318     944.41              1201.09\n10            318    2112.86              1201.09\n11            318     428.26              1201.09\n12            268    1004.66               688.17\n13            268    1043.65               688.17\n14            268     335.54               688.17\n15            268     368.85               688.17\n16             76     843.10               803.10\n17             76     474.78               803.10\n18             76     668.99               803.10\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 then 1 else 0 end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0 THEN 1 ELSE 0 END <> 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" > 0 THEN 1 ELSE 0 END <> 0",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.088984,
                    "execution_time": 0.059373,
                    "compile_time": 0.000233,
                    "planning_time": 0.005526,
                    "create_size": 612
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.149635,
                    "execution_time": 0.058502,
                    "compile_time": 0.000239,
                    "planning_time": 0.063507,
                    "create_size": 612
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_11\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             355    1092.85               874.30\n1             355     617.69               874.30\n2             355    1358.92               874.30\n3             355     427.76               874.30\n4             871    1464.34              1165.17\n5             871     613.81              1165.17\n6             871     634.17              1165.17\n7             871    1948.39              1165.17\n8             315     887.92              1897.11\n9             315    1696.68              1897.11\n10            315    1513.61              1897.11\n11            315    3490.25              1897.11\n12            167     203.59               884.08\n13            167    1651.68               884.08\n14            167    1135.21               884.08\n15            167     545.85               884.08\n16            508     464.54              1107.78\n17            508    2018.35              1107.78\n18            508    1095.44              1107.78\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017441,
                    "execution_time": 0.007209,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.004378
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053362,
                    "execution_time": 0.007252,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.03988
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" > 0 THEN 1 ELSE 0 END <> 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_11\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             355    1092.85               874.30\n1             355     617.69               874.30\n2             355    1358.92               874.30\n3             355     427.76               874.30\n4             871    1464.34              1165.17\n5             871     613.81              1165.17\n6             871     634.17              1165.17\n7             871    1948.39              1165.17\n8             315     887.92              1897.11\n9             315    1696.68              1897.11\n10            315    1513.61              1897.11\n11            315    3490.25              1897.11\n12            167     203.59               884.08\n13            167    1651.68               884.08\n14            167    1135.21               884.08\n15            167     545.85               884.08\n16            508     464.54              1107.78\n17            508    2018.35              1107.78\n18            508    1095.44              1107.78\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales > 0.1 end\n/*CURSOR_IDENTIFIER*/ order by sum_sales desc",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_QUARTERLY_SALES\" ) / \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0.1 END ORDER BY \"TMP1\".\"SUM_SALES\" DESC NULLS FIRST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" > 0.1 END",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.089284,
                    "execution_time": 0.058652,
                    "compile_time": 0.000231,
                    "planning_time": 0.006284,
                    "create_size": 612
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.155832,
                    "execution_time": 0.054634,
                    "compile_time": 0.000247,
                    "planning_time": 0.07179,
                    "create_size": 612
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" DESC LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             315    3490.25              1897.11\n1             454    2935.63              1236.19\n2             279    2921.99              1844.41\n3             130    2564.55              1020.39\n4             152    2371.91              1053.86\n5             985    2248.56              1036.89\n6              94    2243.18              1142.44\n7             370    2227.80              1209.53\n8             191    2207.91               988.77\n9             334    2175.66              1038.28\n10            168    2162.30              1018.21\n11            113    2124.60              1167.42\n12            318    2112.86              1201.09\n13            264    2098.86               920.15\n14            279    2078.56              1844.41\n15            410    2063.21              1049.58\n16            596    2049.40               946.25\n17            508    2018.35              1107.78\n18            931    2008.79               893.13\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018915,
                    "execution_time": 0.008218,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.004585
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057704,
                    "execution_time": 0.008877,
                    "compile_time": 6.9e-05,
                    "planning_time": 0.039945
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" > 0.1 END ORDER BY \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" DESC NULLS FIRST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"SUM_SALES\" DESC NULLS FIRST"
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             315    3490.25              1897.11\n1             454    2935.63              1236.19\n2             279    2921.99              1844.41\n3             130    2564.55              1020.39\n4             152    2371.91              1053.86\n5             985    2248.56              1036.89\n6              94    2243.18              1142.44\n7             370    2227.80              1209.53\n8             191    2207.91               988.77\n9             334    2175.66              1038.28\n10            168    2162.30              1018.21\n11            113    2124.60              1167.42\n12            318    2112.86              1201.09\n13            264    2098.86               920.15\n14            279    2078.56              1844.41\n15            410    2063.21              1049.58\n16            596    2049.40               946.25\n17            508    2018.35              1107.78\n18            931    2008.79               893.13\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_QUARTERLY_SALES\" ) / \"TMP1\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.088028,
                    "execution_time": 0.056809,
                    "compile_time": 0.000229,
                    "planning_time": 0.00646,
                    "create_size": 612
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.148135,
                    "execution_time": 0.055165,
                    "compile_time": 0.000244,
                    "planning_time": 0.064452,
                    "create_size": 612
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_13\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             268    1004.66               688.17\n1             268    1043.65               688.17\n2             268     335.54               688.17\n3             268     368.85               688.17\n4             318     944.41              1201.09\n5             318    2112.86              1201.09\n6             318     428.26              1201.09\n7              25     674.48               863.66\n8              25     525.66               863.66\n9              25     750.33               863.66\n10             25    1504.20               863.66\n11            552    1920.39              1094.30\n12            552     760.36              1094.30\n13            552     838.12              1094.30\n14            552     858.36              1094.30\n15            594     639.53              1007.18\n16            594     887.03              1007.18\n17            594     657.03              1007.18\n18            594    1845.13              1007.18\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018167,
                    "execution_time": 0.007932,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.004349
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05608,
                    "execution_time": 0.00737,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.039717
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_13\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             268    1004.66               688.17\n1             268    1043.65               688.17\n2             268     335.54               688.17\n3             268     368.85               688.17\n4             318     944.41              1201.09\n5             318    2112.86              1201.09\n6             318     428.26              1201.09\n7              25     674.48               863.66\n8              25     525.66               863.66\n9              25     750.33               863.66\n10             25    1504.20               863.66\n11            552    1920.39              1094.30\n12            552     760.36              1094.30\n13            552     838.12              1094.30\n14            552     858.36              1094.30\n15            594     639.53              1007.18\n16            594     887.03              1007.18\n17            594     657.03              1007.18\n18            594    1845.13              1007.18\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_QUARTERLY_SALES\" ) / \"TMP1\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"AVG_QUARTERLY_SALES\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_13\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"SPEQLITE_TEMP_TABLE_13\".\"AVG_QUARTERLY_SALES\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             268    1043.65               688.17\n1             268     335.54               688.17\n2             268     368.85               688.17\n3             268    1004.66               688.17\n4             174    1125.35               702.83\n5             174     582.78               702.83\n6             174     552.77               702.83\n7             174     550.43               702.83\n8             499     461.60               714.94\n9             499    1308.58               714.94\n10            499     244.28               714.94\n11            499     845.33               714.94\n12              8     233.21               759.72\n13              8     657.89               759.72\n14              8     912.71               759.72\n15              8    1235.08               759.72\n16             12     478.27               784.49\n17             12     631.72               784.49\n18             12     546.69               784.49\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018807,
                    "execution_time": 0.008307,
                    "compile_time": 7.1e-05,
                    "planning_time": 0.004643
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054574,
                    "execution_time": 0.00865,
                    "compile_time": 7e-05,
                    "planning_time": 0.040021
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_13\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"SPEQLITE_TEMP_TABLE_13\".\"AVG_QUARTERLY_SALES\" NULLS LAST"
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             268    1043.65               688.17\n1             268     335.54               688.17\n2             268     368.85               688.17\n3             268    1004.66               688.17\n4             174    1125.35               702.83\n5             174     582.78               702.83\n6             174     552.77               702.83\n7             174     550.43               702.83\n8             499     461.60               714.94\n9             499    1308.58               714.94\n10            499     244.28               714.94\n11            499     845.33               714.94\n12              8     233.21               759.72\n13              8     657.89               759.72\n14              8     912.71               759.72\n15              8    1235.08               759.72\n16             12     478.27               784.49\n17             12     631.72               784.49\n18             12     546.69               784.49\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_QUARTERLY_SALES\" ) / \"TMP1\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"TMP1\".\"SUM_SALES\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_13\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"SPEQLITE_TEMP_TABLE_13\".\"AVG_QUARTERLY_SALES\" , \"SPEQLITE_TEMP_TABLE_13\".\"SUM_SALES\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             268     335.54               688.17\n1             268     368.85               688.17\n2             268    1004.66               688.17\n3             268    1043.65               688.17\n4             174     550.43               702.83\n5             174     552.77               702.83\n6             174     582.78               702.83\n7             174    1125.35               702.83\n8             499     244.28               714.94\n9             499     461.60               714.94\n10            499     845.33               714.94\n11            499    1308.58               714.94\n12              8     233.21               759.72\n13              8     657.89               759.72\n14              8     912.71               759.72\n15              8    1235.08               759.72\n16             12     478.27               784.49\n17             12     546.69               784.49\n18             12     631.72               784.49\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018747,
                    "execution_time": 0.007956,
                    "compile_time": 7.1e-05,
                    "planning_time": 0.004827
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05447,
                    "execution_time": 0.008265,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.040209
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_13\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"SPEQLITE_TEMP_TABLE_13\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_13\".\"SUM_SALES\" NULLS LAST"
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             268     335.54               688.17\n1             268     368.85               688.17\n2             268    1004.66               688.17\n3             268    1043.65               688.17\n4             174     550.43               702.83\n5             174     552.77               702.83\n6             174     582.78               702.83\n7             174    1125.35               702.83\n8             499     244.28               714.94\n9             499     461.60               714.94\n10            499     845.33               714.94\n11            499    1308.58               714.94\n12              8     233.21               759.72\n13              8     657.89               759.72\n14              8     912.71               759.72\n15              8    1235.08               759.72\n16             12     478.27               784.49\n17             12     546.69               784.49\n18             12     631.72               784.49\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_QUARTERLY_SALES\" ) / \"TMP1\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"TMP1\".\"SUM_SALES\" NULLS LAST , \"TMP1\".\"I_MANUFACT_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_13\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"SPEQLITE_TEMP_TABLE_13\".\"AVG_QUARTERLY_SALES\" , \"SPEQLITE_TEMP_TABLE_13\".\"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_MANUFACT_ID\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             268     335.54               688.17\n1             268     368.85               688.17\n2             268    1004.66               688.17\n3             268    1043.65               688.17\n4             174     550.43               702.83\n5             174     552.77               702.83\n6             174     582.78               702.83\n7             174    1125.35               702.83\n8             499     244.28               714.94\n9             499     461.60               714.94\n10            499     845.33               714.94\n11            499    1308.58               714.94\n12              8     233.21               759.72\n13              8     657.89               759.72\n14              8     912.71               759.72\n15              8    1235.08               759.72\n16             12     478.27               784.49\n17             12     546.69               784.49\n18             12     631.72               784.49\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019295,
                    "execution_time": 0.008257,
                    "compile_time": 7.6e-05,
                    "planning_time": 0.004987
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055031,
                    "execution_time": 0.008717,
                    "compile_time": 9.3e-05,
                    "planning_time": 0.040317
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_10\".\"I_MANUFACT_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_13\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"SPEQLITE_TEMP_TABLE_13\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_13\".\"SUM_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_13\".\"I_MANUFACT_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             268     335.54               688.17\n1             268     368.85               688.17\n2             268    1004.66               688.17\n3             268    1043.65               688.17\n4             174     550.43               702.83\n5             174     552.77               702.83\n6             174     582.78               702.83\n7             174    1125.35               702.83\n8             499     244.28               714.94\n9             499     461.60               714.94\n10            499     845.33               714.94\n11            499    1308.58               714.94\n12              8     233.21               759.72\n13              8     657.89               759.72\n14              8     912.71               759.72\n15              8    1235.08               759.72\n16             12     478.27               784.49\n17             12     546.69               784.49\n18             12     631.72               784.49\n...*/"
    },
    {
        "input": "-- start template query53.tpl query 88 in stream 0\nselect /* TPC-DS query53.tpl 0.88 */  * from \n(select i_manufact_id,\nsum(ss_sales_price) sum_sales,\navg(sum(ss_sales_price)) over (partition by i_manufact_id) avg_quarterly_sales\nfrom item, store_sales, date_dim, store\nwhere ss_item_sk = i_item_sk and\nss_sold_date_sk = d_date_sk and\nss_store_sk = s_store_sk and\nd_month_seq in (1212,1212+1,1212+2,1212+3,1212+4,1212+5,1212+6,1212+7,1212+8,1212+9,1212+10,1212+11) and\n((i_category in ('Books','Children','Electronics') and\ni_class in ('personal','portable','reference','self-help') and\ni_brand in ('scholaramalgamalg #14','scholaramalgamalg #7',\n\t\t'exportiunivamalg #9','scholaramalgamalg #9'))\nor(i_category in ('Women','Music','Men') and\ni_class in ('accessories','classical','fragrances','pants') and\ni_brand in ('amalgimporto #1','edu packscholar #1','exportiimporto #1',\n\t\t'importoamalg #1')))\ngroup by i_manufact_id, d_qoy ) tmp1\nwhere case when avg_quarterly_sales > 0 \n\tthen abs (sum_sales - avg_quarterly_sales)/ avg_quarterly_sales \n\telse null end > 0.1\norder by avg_quarterly_sales,\n\t sum_sales,\n\t i_manufact_id\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"TMP1\" AS ( SELECT \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"SUM_SALES\" , AVG ( SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_MANUFACT_ID\" ) AS \"AVG_QUARTERLY_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" IN ( 1212 , 1213 , 1214 , 1215 , 1216 , 1217 , 1218 , 1219 , 1220 , 1221 , 1222 , 1223 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'amalgimporto #1' , 'edu packscholar #1' , 'exportiimporto #1' , 'importoamalg #1' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_BRAND\" IN ( 'scholaramalgamalg #14' , 'scholaramalgamalg #7' , 'exportiunivamalg #9' , 'scholaramalgamalg #9' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Books' , 'Children' , 'Electronics' ) OR \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) ) AND ( \"ITEM\".\"I_CATEGORY\" IN ( 'Women' , 'Music' , 'Men' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) AND ( \"ITEM\".\"I_CLASS\" IN ( 'accessories' , 'classical' , 'fragrances' , 'pants' ) OR \"ITEM\".\"I_CLASS\" IN ( 'personal' , 'portable' , 'reference' , 'self-help' ) ) GROUP BY \"ITEM\".\"I_MANUFACT_ID\" , \"DATE_DIM\".\"D_QOY\" ) SELECT \"TMP1\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"TMP1\".\"SUM_SALES\" AS \"SUM_SALES\" , \"TMP1\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"TMP1\" AS \"TMP1\" WHERE CASE WHEN \"TMP1\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"TMP1\".\"SUM_SALES\" - \"TMP1\".\"AVG_QUARTERLY_SALES\" ) / \"TMP1\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"TMP1\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"TMP1\".\"SUM_SALES\" NULLS LAST , \"TMP1\".\"I_MANUFACT_ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_13\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"SPEQLITE_TEMP_TABLE_13\".\"AVG_QUARTERLY_SALES\" , \"SPEQLITE_TEMP_TABLE_13\".\"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_MANUFACT_ID\" LIMIT 21",
                "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             268     335.54               688.17\n1             268     368.85               688.17\n2             268    1004.66               688.17\n3             268    1043.65               688.17\n4             174     550.43               702.83\n5             174     552.77               702.83\n6             174     582.78               702.83\n7             174    1125.35               702.83\n8             499     244.28               714.94\n9             499     461.60               714.94\n10            499     845.33               714.94\n11            499    1308.58               714.94\n12              8     233.21               759.72\n13              8     657.89               759.72\n14              8     912.71               759.72\n15              8    1235.08               759.72\n16             12     478.27               784.49\n17             12     546.69               784.49\n18             12     631.72               784.49\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019961,
                    "execution_time": 0.008944,
                    "compile_time": 7.1e-05,
                    "planning_time": 0.004969
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020498,
                    "execution_time": 0.009378,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.004969
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" WHERE CASE WHEN \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" > 0 THEN ABS ( \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" - \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" ) / \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" ELSE NULL END > 0.1 ORDER BY \"SPEQLITE_TEMP_TABLE_10\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_10\".\"SUM_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_10\".\"I_MANUFACT_ID\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SUM_SALES\" AS \"SUM_SALES\" , \"SPEQLITE_TEMP_TABLE_13\".\"AVG_QUARTERLY_SALES\" AS \"AVG_QUARTERLY_SALES\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"SPEQLITE_TEMP_TABLE_13\".\"AVG_QUARTERLY_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_13\".\"SUM_SALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_13\".\"I_MANUFACT_ID\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*    i_manufact_id  sum_sales  avg_quarterly_sales\n0             268     335.54               688.17\n1             268     368.85               688.17\n2             268    1004.66               688.17\n3             268    1043.65               688.17\n4             174     550.43               702.83\n5             174     552.77               702.83\n6             174     582.78               702.83\n7             174    1125.35               702.83\n8             499     244.28               714.94\n9             499     461.60               714.94\n10            499     845.33               714.94\n11            499    1308.58               714.94\n12              8     233.21               759.72\n13              8     657.89               759.72\n14              8     912.71               759.72\n15              8    1235.08               759.72\n16             12     478.27               784.49\n17             12     546.69               784.49\n18             12     631.72               784.49\n...*/"
    }
]