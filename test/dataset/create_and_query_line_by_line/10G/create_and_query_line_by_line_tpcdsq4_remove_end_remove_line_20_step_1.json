[
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.024721,
                    "execution_time": 0.40512,
                    "compile_time": 0.000396,
                    "planning_time": 0.024178,
                    "create_size": 1408
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.053029,
                    "execution_time": 0.426485,
                    "compile_time": 0.000422,
                    "planning_time": 0.027028,
                    "create_size": 1408
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.102902,
                    "execution_time": 0.039208,
                    "compile_time": 0.000222,
                    "planning_time": 0.02431,
                    "create_size": 480
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.165502,
                    "execution_time": 0.039701,
                    "compile_time": 0.000231,
                    "planning_time": 0.086254,
                    "create_size": 480
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.304704,
                    "execution_time": 1.775496,
                    "compile_time": 0.001178,
                    "planning_time": 0.05973,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.336032,
                    "execution_time": 1.804866,
                    "compile_time": 0.001198,
                    "planning_time": 0.069241,
                    "create_size": 1024
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name         customer_email_address\n0   AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n1   AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n2   AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n3   AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n4   AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n5   AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n6   AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n7   AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n8   AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n9   AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n10  AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n11  AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n12  AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n13  AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n14  AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n15  AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n16  AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n17  AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n18  AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.32282,
                    "execution_time": 0.259021,
                    "compile_time": 0.026801,
                    "planning_time": 0.016873
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.20556,
                    "execution_time": 0.238947,
                    "compile_time": 2.877909,
                    "planning_time": 0.053009
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name         customer_email_address\n0   AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n1   AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n2   AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n3   AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n4   AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n5   AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n6   AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n7   AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n8   AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n9   AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n10  AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n11  AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n12  AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n13  AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n14  AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n15  AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n16  AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n17  AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n18  AAAAAAAABEOAFAAA               Jenny              Davis  Jenny.Davis@A7ZZCs6M6MFuG.org\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name       customer_email_address\n0   AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n1   AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n2   AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n3   AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n4   AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n5   AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n6   AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n7   AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n8   AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n9   AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n10  AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n11  AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n12  AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n13  AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n14  AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n15  AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n16  AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n17  AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n18  AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.270202,
                    "execution_time": 0.202823,
                    "compile_time": 0.028858,
                    "planning_time": 0.01753
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.373719,
                    "execution_time": 0.206353,
                    "compile_time": 3.087759,
                    "planning_time": 0.054013
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name       customer_email_address\n0   AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n1   AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n2   AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n3   AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n4   AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n5   AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n6   AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n7   AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n8   AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n9   AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n10  AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n11  AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n12  AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n13  AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n14  AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n15  AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n16  AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n17  AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n18  AAAAAAAAEBEPDAAA              Robert              Smith  Robert.Smith@HSJKD80lf7.com\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.738602,
                    "execution_time": 2.330126,
                    "compile_time": 0.000853,
                    "planning_time": 0.017886,
                    "create_size": 5897
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.309537,
                    "execution_time": 2.370686,
                    "compile_time": 8.459326,
                    "planning_time": 0.07606,
                    "create_size": 5897
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name    customer_email_address\n0   AAAAAAAAMJKJCAAA               Doris             Crosby     Doris.Crosby@pFq9.edu\n1   AAAAAAAAMJKJCAAA               Doris             Crosby     Doris.Crosby@pFq9.edu\n2   AAAAAAAAMJKJCAAA               Doris             Crosby     Doris.Crosby@pFq9.edu\n3   AAAAAAAAMJKJCAAA               Doris             Crosby     Doris.Crosby@pFq9.edu\n4   AAAAAAAAMJKJCAAA               Doris             Crosby     Doris.Crosby@pFq9.edu\n5   AAAAAAAAMJKJCAAA               Doris             Crosby     Doris.Crosby@pFq9.edu\n6   AAAAAAAAMJKJCAAA               Doris             Crosby     Doris.Crosby@pFq9.edu\n7   AAAAAAAAMJKJCAAA               Doris             Crosby     Doris.Crosby@pFq9.edu\n8   AAAAAAAACCHKDAAA                Judy              Magee  Judy.Magee@b5hIF6dli.edu\n9   AAAAAAAACCHKDAAA                Judy              Magee  Judy.Magee@b5hIF6dli.edu\n10  AAAAAAAACCHKDAAA                Judy              Magee  Judy.Magee@b5hIF6dli.edu\n11  AAAAAAAACCHKDAAA                Judy              Magee  Judy.Magee@b5hIF6dli.edu\n12  AAAAAAAACCHKDAAA                Judy              Magee  Judy.Magee@b5hIF6dli.edu\n13  AAAAAAAACCHKDAAA                Judy              Magee  Judy.Magee@b5hIF6dli.edu\n14  AAAAAAAACCHKDAAA                Judy              Magee  Judy.Magee@b5hIF6dli.edu\n15  AAAAAAAACCHKDAAA                Judy              Magee  Judy.Magee@b5hIF6dli.edu\n16  AAAAAAAACCHKDAAA                Judy              Magee  Judy.Magee@b5hIF6dli.edu\n17  AAAAAAAACCHKDAAA                Judy              Magee  Judy.Magee@b5hIF6dli.edu\n18  AAAAAAAACCHKDAAA                Judy              Magee  Judy.Magee@b5hIF6dli.edu\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018171,
                    "execution_time": 0.0085,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003465
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057098,
                    "execution_time": 0.008753,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.038719
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name    customer_email_address\n0   AAAAAAAAMJKJCAAA               Doris             Crosby     Doris.Crosby@pFq9.edu\n1   AAAAAAAAMJKJCAAA               Doris             Crosby     Doris.Crosby@pFq9.edu\n2   AAAAAAAAMJKJCAAA               Doris             Crosby     Doris.Crosby@pFq9.edu\n3   AAAAAAAAMJKJCAAA               Doris             Crosby     Doris.Crosby@pFq9.edu\n4   AAAAAAAAMJKJCAAA               Doris             Crosby     Doris.Crosby@pFq9.edu\n5   AAAAAAAAMJKJCAAA               Doris             Crosby     Doris.Crosby@pFq9.edu\n6   AAAAAAAAMJKJCAAA               Doris             Crosby     Doris.Crosby@pFq9.edu\n7   AAAAAAAAMJKJCAAA               Doris             Crosby     Doris.Crosby@pFq9.edu\n8   AAAAAAAACCHKDAAA                Judy              Magee  Judy.Magee@b5hIF6dli.edu\n9   AAAAAAAACCHKDAAA                Judy              Magee  Judy.Magee@b5hIF6dli.edu\n10  AAAAAAAACCHKDAAA                Judy              Magee  Judy.Magee@b5hIF6dli.edu\n11  AAAAAAAACCHKDAAA                Judy              Magee  Judy.Magee@b5hIF6dli.edu\n12  AAAAAAAACCHKDAAA                Judy              Magee  Judy.Magee@b5hIF6dli.edu\n13  AAAAAAAACCHKDAAA                Judy              Magee  Judy.Magee@b5hIF6dli.edu\n14  AAAAAAAACCHKDAAA                Judy              Magee  Judy.Magee@b5hIF6dli.edu\n15  AAAAAAAACCHKDAAA                Judy              Magee  Judy.Magee@b5hIF6dli.edu\n16  AAAAAAAACCHKDAAA                Judy              Magee  Judy.Magee@b5hIF6dli.edu\n17  AAAAAAAACCHKDAAA                Judy              Magee  Judy.Magee@b5hIF6dli.edu\n18  AAAAAAAACCHKDAAA                Judy              Magee  Judy.Magee@b5hIF6dli.edu\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.380524,
                    "execution_time": 1.808268,
                    "compile_time": 0.001256,
                    "planning_time": 0.060421,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.47872,
                    "execution_time": 1.790533,
                    "compile_time": 0.001246,
                    "planning_time": 0.166684,
                    "create_size": 1152
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.516897,
                    "execution_time": 0.975076,
                    "compile_time": 0.135346,
                    "planning_time": 0.01983,
                    "create_size": 1792
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.59566,
                    "execution_time": 1.67123,
                    "compile_time": 9.430979,
                    "planning_time": 0.080558,
                    "create_size": 1792
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                  customer_email_address\n0   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n1   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n2   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n3   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n4   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n5   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n6   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n7   AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n8   AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n9   AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n10  AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n11  AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n12  AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n13  AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n14  AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n15  AAAAAAAAEJNCGAAA             Marilou             Garcia  Marilou.Garcia@PQ4dRdvNGUmQPfgyJBo.com\n16  AAAAAAAAEJNCGAAA             Marilou             Garcia  Marilou.Garcia@PQ4dRdvNGUmQPfgyJBo.com\n17  AAAAAAAAEJNCGAAA             Marilou             Garcia  Marilou.Garcia@PQ4dRdvNGUmQPfgyJBo.com\n18  AAAAAAAAEJNCGAAA             Marilou             Garcia  Marilou.Garcia@PQ4dRdvNGUmQPfgyJBo.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017872,
                    "execution_time": 0.008321,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003458
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056299,
                    "execution_time": 0.00821,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038636
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                  customer_email_address\n0   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n1   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n2   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n3   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n4   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n5   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n6   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n7   AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n8   AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n9   AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n10  AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n11  AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n12  AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n13  AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n14  AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n15  AAAAAAAAEJNCGAAA             Marilou             Garcia  Marilou.Garcia@PQ4dRdvNGUmQPfgyJBo.com\n16  AAAAAAAAEJNCGAAA             Marilou             Garcia  Marilou.Garcia@PQ4dRdvNGUmQPfgyJBo.com\n17  AAAAAAAAEJNCGAAA             Marilou             Garcia  Marilou.Garcia@PQ4dRdvNGUmQPfgyJBo.com\n18  AAAAAAAAEJNCGAAA             Marilou             Garcia  Marilou.Garcia@PQ4dRdvNGUmQPfgyJBo.com\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                    customer_email_address\n0   AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n1   AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n2   AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n3   AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n4   AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n5   AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n6   AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n7   AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n8   AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n9   AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n10  AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n11  AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n12  AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n13  AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n14  AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n15  AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n16  AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n17  AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n18  AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.029028,
                    "execution_time": 0.016717,
                    "compile_time": 8.5e-05,
                    "planning_time": 0.004985
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.069161,
                    "execution_time": 0.017923,
                    "compile_time": 0.001217,
                    "planning_time": 0.0403
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                    customer_email_address\n0   AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n1   AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n2   AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n3   AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n4   AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n5   AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n6   AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n7   AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n8   AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n9   AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n10  AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n11  AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n12  AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n13  AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n14  AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n15  AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n16  AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n17  AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n18  AAAAAAAAHPKFHAAA         Christopher              Adams  Christopher.Adams@NOTq2YdqEoi2upqGzG.com\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                  customer_email_address\n0   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n1   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n2   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n3   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n4   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n5   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n6   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n7   AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n8   AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n9   AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n10  AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n11  AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n12  AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n13  AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n14  AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n15  AAAAAAAAEJNCGAAA             Marilou             Garcia  Marilou.Garcia@PQ4dRdvNGUmQPfgyJBo.com\n16  AAAAAAAAEJNCGAAA             Marilou             Garcia  Marilou.Garcia@PQ4dRdvNGUmQPfgyJBo.com\n17  AAAAAAAAEJNCGAAA             Marilou             Garcia  Marilou.Garcia@PQ4dRdvNGUmQPfgyJBo.com\n18  AAAAAAAAEJNCGAAA             Marilou             Garcia  Marilou.Garcia@PQ4dRdvNGUmQPfgyJBo.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.218232,
                    "execution_time": 1.202988,
                    "compile_time": 0.000169,
                    "planning_time": 0.006489
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.312794,
                    "execution_time": 1.25886,
                    "compile_time": 0.001659,
                    "planning_time": 0.041907
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                  customer_email_address\n0   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n1   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n2   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n3   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n4   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n5   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n6   AAAAAAAAGNMKBAAA             Tiffany               Wong                                        \n7   AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n8   AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n9   AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n10  AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n11  AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n12  AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n13  AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n14  AAAAAAAABLIBFAAA             Natalie              Denny                    Natalie.Denny@Eg.com\n15  AAAAAAAAEJNCGAAA             Marilou             Garcia  Marilou.Garcia@PQ4dRdvNGUmQPfgyJBo.com\n16  AAAAAAAAEJNCGAAA             Marilou             Garcia  Marilou.Garcia@PQ4dRdvNGUmQPfgyJBo.com\n17  AAAAAAAAEJNCGAAA             Marilou             Garcia  Marilou.Garcia@PQ4dRdvNGUmQPfgyJBo.com\n18  AAAAAAAAEJNCGAAA             Marilou             Garcia  Marilou.Garcia@PQ4dRdvNGUmQPfgyJBo.com\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name customer_email_address\n0   AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n1   AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n2   AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n3   AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n4   AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n5   AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n6   AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n7   AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n8   AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n9   AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n10  AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n11  AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n12  AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n13  AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n14  AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n15  AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n16  AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n17  AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n18  AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.065521,
                    "execution_time": 0.04597,
                    "compile_time": 0.000213,
                    "planning_time": 0.008264
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.115977,
                    "execution_time": 0.045352,
                    "compile_time": 0.001282,
                    "planning_time": 0.043654
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name customer_email_address\n0   AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n1   AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n2   AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n3   AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n4   AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n5   AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n6   AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n7   AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n8   AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n9   AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n10  AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n11  AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n12  AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n13  AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n14  AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n15  AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n16  AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n17  AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n18  AAAAAAAAGNMKBAAA             Tiffany               Wong                       \n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name customer_email_address\n0   AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n1   AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n2   AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n3   AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n4   AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n5   AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n6   AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n7   AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n8   AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n9   AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n10  AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n11  AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n12  AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n13  AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n14  AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n15  AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n16  AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n17  AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n18  AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.404447,
                    "execution_time": 1.315192,
                    "compile_time": 0.064647,
                    "planning_time": 0.010312
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.397943,
                    "execution_time": 1.277355,
                    "compile_time": 3.056102,
                    "planning_time": 0.045942
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name customer_email_address\n0   AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n1   AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n2   AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n3   AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n4   AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n5   AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n6   AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n7   AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n8   AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n9   AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n10  AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n11  AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n12  AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n13  AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n14  AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n15  AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n16  AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n17  AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n18  AAAAAAAANFNHGAAA              Jennie              Brown  Jennie.Brown@d33n.com\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"DYEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"DYEAR\" = 1999 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name            customer_email_address\n0   AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n1   AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n2   AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n3   AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n4   AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n5   AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n6   AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n7   AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n8   AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n9   AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n10  AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n11  AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n12  AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n13  AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n14  AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n15  AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n16  AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n17  AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n18  AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 1.317811,
                    "execution_time": 1.225447,
                    "compile_time": 0.063043,
                    "planning_time": 0.012397
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.430949,
                    "execution_time": 1.256017,
                    "compile_time": 3.105052,
                    "planning_time": 0.0482
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"DYEAR\" = 1999"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name            customer_email_address\n0   AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n1   AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n2   AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n3   AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n4   AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n5   AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n6   AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n7   AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n8   AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n9   AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n10  AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n11  AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n12  AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n13  AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n14  AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n15  AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n16  AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n17  AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n18  AAAAAAAAGNNBCAAA               Deann             Foster  Deann.Foster@qHZSsntimVFyHAg.com\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.870958,
                    "execution_time": 2.142286,
                    "compile_time": 0.001283,
                    "planning_time": 0.066075,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.080542,
                    "execution_time": 2.24425,
                    "compile_time": 0.001277,
                    "planning_time": 0.170697,
                    "create_size": 1280
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.394116,
                    "execution_time": 0.157248,
                    "compile_time": 0.181183,
                    "planning_time": 0.024932,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 13.342187,
                    "execution_time": 0.181168,
                    "compile_time": 13.01974,
                    "planning_time": 0.086929,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                  customer_email_address\n0   AAAAAAAAABPJFAAA                Anne              Tyson           Anne.Tyson@3Bqo58h6qlpAhF.org\n1   AAAAAAAAHGDKFAAA             Clinton            Herring                   Clinton.Herring@t.org\n2   AAAAAAAAOPJABAAA                 Don               Wood       Don.Wood@J9DdjAF2Q4Ib8pUK3Rjy.edu\n3   AAAAAAAAAIODGAAA              Benito           Mitchell        Benito.Mitchell@q4UJ2Lfqkqqn.org\n4   AAAAAAAAKFFECAAA          Wilhelmina          Gutierrez      Wilhelmina.Gutierrez@qgHoEGiGs.org\n5   AAAAAAAAHLNOGAAA             Mildred               Wilt           Mildred.Wilt@YaKEkeMUC2ZM.com\n6   AAAAAAAAIFIAGAAA               Effie              Brown          Effie.Brown@leoLfspKsUaeuq.org\n7   AAAAAAAAGJPPDAAA                Judy             Galvan              Judy.Galvan@oxRz4ZqJ4I.com\n8   AAAAAAAAIGLIGAAA               Helen             Graham                      Helen.Graham@s.org\n9   AAAAAAAAIADMGAAA              Robert             Monaco    Robert.Monaco@5PGkI3IVyfMfcrha0F.edu\n10  AAAAAAAAJHEMGAAA                Lisa            Redmond              Lisa.Redmond@75yqy0g2I.org\n11  AAAAAAAAJCOHHAAA               Edwin           Gonzales           Edwin.Gonzales@laPA0ZKVE7.com\n12  AAAAAAAADPKJGAAA            Kristine          Henderson   Kristine.Henderson@haTLcRPNlmrRYd.com\n13  AAAAAAAANKBMEAAA               Nancy             Ocasio              Nancy.Ocasio@eVUIBXd2K.com\n14  AAAAAAAANGMBHAAA              Donald           Longoria  Donald.Longoria@utiZ6ArV6EZopxP44c.org\n15  AAAAAAAAHPIEEAAA             William              North  William.North@MvMQ5rhy2j5Lpnf2KouX.edu\n16  AAAAAAAANOMHBAAA             Kenneth           Chastain          Kenneth.Chastain@dmn8t2pkc.org\n17  AAAAAAAALAOODAAA               Tommy              Perry         Tommy.Perry@TJphmPXznqlFP46.com\n18  AAAAAAAAPBADBAAA              Cheryl             Benson                   Cheryl.Benson@Ub4.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016627,
                    "execution_time": 0.007247,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003406
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056616,
                    "execution_time": 0.007757,
                    "compile_time": 5e-05,
                    "planning_time": 0.039177
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                  customer_email_address\n0   AAAAAAAAABPJFAAA                Anne              Tyson           Anne.Tyson@3Bqo58h6qlpAhF.org\n1   AAAAAAAAHGDKFAAA             Clinton            Herring                   Clinton.Herring@t.org\n2   AAAAAAAAOPJABAAA                 Don               Wood       Don.Wood@J9DdjAF2Q4Ib8pUK3Rjy.edu\n3   AAAAAAAAAIODGAAA              Benito           Mitchell        Benito.Mitchell@q4UJ2Lfqkqqn.org\n4   AAAAAAAAKFFECAAA          Wilhelmina          Gutierrez      Wilhelmina.Gutierrez@qgHoEGiGs.org\n5   AAAAAAAAHLNOGAAA             Mildred               Wilt           Mildred.Wilt@YaKEkeMUC2ZM.com\n6   AAAAAAAAIFIAGAAA               Effie              Brown          Effie.Brown@leoLfspKsUaeuq.org\n7   AAAAAAAAGJPPDAAA                Judy             Galvan              Judy.Galvan@oxRz4ZqJ4I.com\n8   AAAAAAAAIGLIGAAA               Helen             Graham                      Helen.Graham@s.org\n9   AAAAAAAAIADMGAAA              Robert             Monaco    Robert.Monaco@5PGkI3IVyfMfcrha0F.edu\n10  AAAAAAAAJHEMGAAA                Lisa            Redmond              Lisa.Redmond@75yqy0g2I.org\n11  AAAAAAAAJCOHHAAA               Edwin           Gonzales           Edwin.Gonzales@laPA0ZKVE7.com\n12  AAAAAAAADPKJGAAA            Kristine          Henderson   Kristine.Henderson@haTLcRPNlmrRYd.com\n13  AAAAAAAANKBMEAAA               Nancy             Ocasio              Nancy.Ocasio@eVUIBXd2K.com\n14  AAAAAAAANGMBHAAA              Donald           Longoria  Donald.Longoria@utiZ6ArV6EZopxP44c.org\n15  AAAAAAAAHPIEEAAA             William              North  William.North@MvMQ5rhy2j5Lpnf2KouX.edu\n16  AAAAAAAANOMHBAAA             Kenneth           Chastain          Kenneth.Chastain@dmn8t2pkc.org\n17  AAAAAAAALAOODAAA               Tommy              Perry         Tommy.Perry@TJphmPXznqlFP46.com\n18  AAAAAAAAPBADBAAA              Cheryl             Benson                   Cheryl.Benson@Ub4.com\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                customer_email_address\n0   AAAAAAAAIAKMFAAA              Elaine            Rushing        Elaine.Rushing@l91m8YDmBVL.org\n1   AAAAAAAACDIBGAAA             Barbara         Mcreynolds  Barbara.Mcreynolds@Qptf9HKBI2MLb.com\n2   AAAAAAAANGKPBAAA             Lucille              Cheek                 Lucille.Cheek@Z9H.com\n3   AAAAAAAAHNDEEAAA              Raquel              Lopez         Raquel.Lopez@zR4Oei7XVbTz.edu\n4   AAAAAAAAFEPHCAAA               James            Mccrary         James.Mccrary@fKMH4jQpD88.org\n5   AAAAAAAALKPCFAAA                Lucy             Maupin              Lucy.Maupin@Rb4tqaAY.com\n6   AAAAAAAADFKJAAAA               Jason             Watson           Jason.Watson@d3KN55htLC.edu\n7   AAAAAAAANPCGHAAA               Doris             Holmes            Doris.Holmes@307dyzNOe.edu\n8   AAAAAAAAAGPBEAAA               Tonya             Urbina          Tonya.Urbina@DnMgRASUNqA.org\n9   AAAAAAAALMACFAAA             Phyllis            Jackson                 Phyllis.Jackson@5.com\n10  AAAAAAAAOMCJGAAA             Jeannie           Lawrence    Jeannie.Lawrence@dYOQ7QH8MksOd.org\n11  AAAAAAAAGIGJBAAA                John              Lynch                 John.Lynch@uO6V05.edu\n12  AAAAAAAAABPJFAAA                Anne              Tyson         Anne.Tyson@3Bqo58h6qlpAhF.org\n13  AAAAAAAAHGDKFAAA             Clinton            Herring                 Clinton.Herring@t.org\n14  AAAAAAAAOPJABAAA                 Don               Wood     Don.Wood@J9DdjAF2Q4Ib8pUK3Rjy.edu\n15  AAAAAAAAAIODGAAA              Benito           Mitchell      Benito.Mitchell@q4UJ2Lfqkqqn.org\n16  AAAAAAAAKFFECAAA          Wilhelmina          Gutierrez    Wilhelmina.Gutierrez@qgHoEGiGs.org\n17  AAAAAAAAHLNOGAAA             Mildred               Wilt         Mildred.Wilt@YaKEkeMUC2ZM.com\n18  AAAAAAAAIFIAGAAA               Effie              Brown        Effie.Brown@leoLfspKsUaeuq.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.028936,
                    "execution_time": 0.016212,
                    "compile_time": 9.3e-05,
                    "planning_time": 0.005074
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.139919,
                    "execution_time": 0.016783,
                    "compile_time": 3.077828,
                    "planning_time": 0.040513
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                customer_email_address\n0   AAAAAAAAIAKMFAAA              Elaine            Rushing        Elaine.Rushing@l91m8YDmBVL.org\n1   AAAAAAAACDIBGAAA             Barbara         Mcreynolds  Barbara.Mcreynolds@Qptf9HKBI2MLb.com\n2   AAAAAAAANGKPBAAA             Lucille              Cheek                 Lucille.Cheek@Z9H.com\n3   AAAAAAAAHNDEEAAA              Raquel              Lopez         Raquel.Lopez@zR4Oei7XVbTz.edu\n4   AAAAAAAAFEPHCAAA               James            Mccrary         James.Mccrary@fKMH4jQpD88.org\n5   AAAAAAAALKPCFAAA                Lucy             Maupin              Lucy.Maupin@Rb4tqaAY.com\n6   AAAAAAAADFKJAAAA               Jason             Watson           Jason.Watson@d3KN55htLC.edu\n7   AAAAAAAANPCGHAAA               Doris             Holmes            Doris.Holmes@307dyzNOe.edu\n8   AAAAAAAAAGPBEAAA               Tonya             Urbina          Tonya.Urbina@DnMgRASUNqA.org\n9   AAAAAAAALMACFAAA             Phyllis            Jackson                 Phyllis.Jackson@5.com\n10  AAAAAAAAOMCJGAAA             Jeannie           Lawrence    Jeannie.Lawrence@dYOQ7QH8MksOd.org\n11  AAAAAAAAGIGJBAAA                John              Lynch                 John.Lynch@uO6V05.edu\n12  AAAAAAAAABPJFAAA                Anne              Tyson         Anne.Tyson@3Bqo58h6qlpAhF.org\n13  AAAAAAAAHGDKFAAA             Clinton            Herring                 Clinton.Herring@t.org\n14  AAAAAAAAOPJABAAA                 Don               Wood     Don.Wood@J9DdjAF2Q4Ib8pUK3Rjy.edu\n15  AAAAAAAAAIODGAAA              Benito           Mitchell      Benito.Mitchell@q4UJ2Lfqkqqn.org\n16  AAAAAAAAKFFECAAA          Wilhelmina          Gutierrez    Wilhelmina.Gutierrez@qgHoEGiGs.org\n17  AAAAAAAAHLNOGAAA             Mildred               Wilt         Mildred.Wilt@YaKEkeMUC2ZM.com\n18  AAAAAAAAIFIAGAAA               Effie              Brown        Effie.Brown@leoLfspKsUaeuq.org\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name         customer_email_address\n0   AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n1   AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n2   AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n3   AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n4   AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n5   AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n6   AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n7   AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n8   AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n9   AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n10  AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n11  AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n12  AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n13  AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n14  AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n15  AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n16  AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n17  AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n18  AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.083,
                    "execution_time": 0.038948,
                    "compile_time": 0.035799,
                    "planning_time": 0.006775
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.400289,
                    "execution_time": 0.036817,
                    "compile_time": 3.314992,
                    "planning_time": 0.042097
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name         customer_email_address\n0   AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n1   AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n2   AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n3   AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n4   AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n5   AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n6   AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n7   AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n8   AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n9   AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n10  AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n11  AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n12  AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n13  AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n14  AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n15  AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n16  AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n17  AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n18  AAAAAAAAABPJFAAA                Anne              Tyson  Anne.Tyson@3Bqo58h6qlpAhF.org\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and (case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end) is not null\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND NOT CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END IS NULL WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND NOT CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END IS NULL WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.344271,
                    "execution_time": 0.143055,
                    "compile_time": 0.129214,
                    "planning_time": 0.027782,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.182541,
                    "execution_time": 0.186295,
                    "compile_time": 9.854021,
                    "planning_time": 0.087032,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                  customer_email_address\n0   AAAAAAAAKFFECAAA          Wilhelmina          Gutierrez      Wilhelmina.Gutierrez@qgHoEGiGs.org\n1   AAAAAAAAIGLIGAAA               Helen             Graham                      Helen.Graham@s.org\n2   AAAAAAAAIADMGAAA              Robert             Monaco    Robert.Monaco@5PGkI3IVyfMfcrha0F.edu\n3   AAAAAAAAIFIAGAAA               Effie              Brown          Effie.Brown@leoLfspKsUaeuq.org\n4   AAAAAAAAJHEMGAAA                Lisa            Redmond              Lisa.Redmond@75yqy0g2I.org\n5   AAAAAAAAJCOHHAAA               Edwin           Gonzales           Edwin.Gonzales@laPA0ZKVE7.com\n6   AAAAAAAAGJPPDAAA                Judy             Galvan              Judy.Galvan@oxRz4ZqJ4I.com\n7   AAAAAAAAABPJFAAA                Anne              Tyson           Anne.Tyson@3Bqo58h6qlpAhF.org\n8   AAAAAAAAHLNOGAAA             Mildred               Wilt           Mildred.Wilt@YaKEkeMUC2ZM.com\n9   AAAAAAAAHGDKFAAA             Clinton            Herring                   Clinton.Herring@t.org\n10  AAAAAAAADPKJGAAA            Kristine          Henderson   Kristine.Henderson@haTLcRPNlmrRYd.com\n11  AAAAAAAAOPJABAAA                 Don               Wood       Don.Wood@J9DdjAF2Q4Ib8pUK3Rjy.edu\n12  AAAAAAAANKBMEAAA               Nancy             Ocasio              Nancy.Ocasio@eVUIBXd2K.com\n13  AAAAAAAAAIODGAAA              Benito           Mitchell        Benito.Mitchell@q4UJ2Lfqkqqn.org\n14  AAAAAAAAHPIEEAAA             William              North  William.North@MvMQ5rhy2j5Lpnf2KouX.edu\n15  AAAAAAAANGMBHAAA              Donald           Longoria  Donald.Longoria@utiZ6ArV6EZopxP44c.org\n16  AAAAAAAANOMHBAAA             Kenneth           Chastain          Kenneth.Chastain@dmn8t2pkc.org\n17  AAAAAAAAHINFAAAA             Lavonne              Reyes    Lavonne.Reyes@J8eK7Nd1Z1if8e3E9q.com\n18  AAAAAAAANOEJBAAA                Ward             Daigle                 Ward.Daigle@G3f4qcJ.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017284,
                    "execution_time": 0.007641,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.00345
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055691,
                    "execution_time": 0.007626,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.038691
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND NOT CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END IS NULL WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                  customer_email_address\n0   AAAAAAAAKFFECAAA          Wilhelmina          Gutierrez      Wilhelmina.Gutierrez@qgHoEGiGs.org\n1   AAAAAAAAIGLIGAAA               Helen             Graham                      Helen.Graham@s.org\n2   AAAAAAAAIADMGAAA              Robert             Monaco    Robert.Monaco@5PGkI3IVyfMfcrha0F.edu\n3   AAAAAAAAIFIAGAAA               Effie              Brown          Effie.Brown@leoLfspKsUaeuq.org\n4   AAAAAAAAJHEMGAAA                Lisa            Redmond              Lisa.Redmond@75yqy0g2I.org\n5   AAAAAAAAJCOHHAAA               Edwin           Gonzales           Edwin.Gonzales@laPA0ZKVE7.com\n6   AAAAAAAAGJPPDAAA                Judy             Galvan              Judy.Galvan@oxRz4ZqJ4I.com\n7   AAAAAAAAABPJFAAA                Anne              Tyson           Anne.Tyson@3Bqo58h6qlpAhF.org\n8   AAAAAAAAHLNOGAAA             Mildred               Wilt           Mildred.Wilt@YaKEkeMUC2ZM.com\n9   AAAAAAAAHGDKFAAA             Clinton            Herring                   Clinton.Herring@t.org\n10  AAAAAAAADPKJGAAA            Kristine          Henderson   Kristine.Henderson@haTLcRPNlmrRYd.com\n11  AAAAAAAAOPJABAAA                 Don               Wood       Don.Wood@J9DdjAF2Q4Ib8pUK3Rjy.edu\n12  AAAAAAAANKBMEAAA               Nancy             Ocasio              Nancy.Ocasio@eVUIBXd2K.com\n13  AAAAAAAAAIODGAAA              Benito           Mitchell        Benito.Mitchell@q4UJ2Lfqkqqn.org\n14  AAAAAAAAHPIEEAAA             William              North  William.North@MvMQ5rhy2j5Lpnf2KouX.edu\n15  AAAAAAAANGMBHAAA              Donald           Longoria  Donald.Longoria@utiZ6ArV6EZopxP44c.org\n16  AAAAAAAANOMHBAAA             Kenneth           Chastain          Kenneth.Chastain@dmn8t2pkc.org\n17  AAAAAAAAHINFAAAA             Lavonne              Reyes    Lavonne.Reyes@J8eK7Nd1Z1if8e3E9q.com\n18  AAAAAAAANOEJBAAA                Ward             Daigle                 Ward.Daigle@G3f4qcJ.org\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.299135,
                    "execution_time": 0.160588,
                    "compile_time": 0.067788,
                    "planning_time": 0.02898,
                    "create_size": 889
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.861733,
                    "execution_time": 0.178736,
                    "compile_time": 6.5376,
                    "planning_time": 0.088349,
                    "create_size": 889
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                  customer_email_address\n0   AAAAAAAAJOHAEAAA                Paul             Mcleod                    Paul.Mcleod@RYKU.edu\n1   AAAAAAAAJMIBAAAA             Florine                                                           \n2   AAAAAAAAJLAEFAAA             Gregory              Gomez            Gregory.Gomez@2n2RELOFrE.com\n3   AAAAAAAAJHIOCAAA              Robert              Olson                     Robert.Olson@VL.edu\n4   AAAAAAAANGFIGAAA               Flora             Carter      Flora.Carter@gNnkOle2RhvZDATjF.edu\n5   AAAAAAAAEKHBBAAA             Zachary            Hillard                                        \n6   AAAAAAAAHPIEEAAA             William              North  William.North@MvMQ5rhy2j5Lpnf2KouX.edu\n7   AAAAAAAAKHHFAAAA              Jordan           Langlois                   Jordan.Langlois@o.com\n8   AAAAAAAAPBADBAAA              Cheryl             Benson                   Cheryl.Benson@Ub4.com\n9   AAAAAAAABMPKEAAA             Esteban             Bender             Esteban.Bender@FglQdXjC.org\n10  AAAAAAAAFMMCEAAA                Lela              Evans                      Lela.Evans@2Ra.edu\n11  AAAAAAAAHLFDBAAA               Julie              Woods         Julie.Woods@d1tBubP0H2Jckoh.org\n12  AAAAAAAANPKIGAAA               James               Pike             James.Pike@K8u0eh63f2FR.edu\n13  AAAAAAAAEEGAAAAA           Rosemarie          Hernandez             Rosemarie.Hernandez@ebP.com\n14  AAAAAAAANOMPFAAA             Barbara               Howe                   Barbara.Howe@eOUa.com\n15  AAAAAAAALGKJAAAA              Lillie            Leclair                   Lillie.Leclair@at.com\n16  AAAAAAAALEGPBAAA              Pamela             Alfaro             Pamela.Alfaro@T1eeb8qmN.edu\n17  AAAAAAAAKIHDAAAA              Tamera           Morrison      Tamera.Morrison@arAi6oPcBpNP5h.org\n18  AAAAAAAABPCFCAAA              Andrea              Gross           Andrea.Gross@YtkKtNzF0Q9l.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017171,
                    "execution_time": 0.007787,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003416
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056181,
                    "execution_time": 0.00818,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038694
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                  customer_email_address\n0   AAAAAAAAJOHAEAAA                Paul             Mcleod                    Paul.Mcleod@RYKU.edu\n1   AAAAAAAAJMIBAAAA             Florine                                                           \n2   AAAAAAAAJLAEFAAA             Gregory              Gomez            Gregory.Gomez@2n2RELOFrE.com\n3   AAAAAAAAJHIOCAAA              Robert              Olson                     Robert.Olson@VL.edu\n4   AAAAAAAANGFIGAAA               Flora             Carter      Flora.Carter@gNnkOle2RhvZDATjF.edu\n5   AAAAAAAAEKHBBAAA             Zachary            Hillard                                        \n6   AAAAAAAAHPIEEAAA             William              North  William.North@MvMQ5rhy2j5Lpnf2KouX.edu\n7   AAAAAAAAKHHFAAAA              Jordan           Langlois                   Jordan.Langlois@o.com\n8   AAAAAAAAPBADBAAA              Cheryl             Benson                   Cheryl.Benson@Ub4.com\n9   AAAAAAAABMPKEAAA             Esteban             Bender             Esteban.Bender@FglQdXjC.org\n10  AAAAAAAAFMMCEAAA                Lela              Evans                      Lela.Evans@2Ra.edu\n11  AAAAAAAAHLFDBAAA               Julie              Woods         Julie.Woods@d1tBubP0H2Jckoh.org\n12  AAAAAAAANPKIGAAA               James               Pike             James.Pike@K8u0eh63f2FR.edu\n13  AAAAAAAAEEGAAAAA           Rosemarie          Hernandez             Rosemarie.Hernandez@ebP.com\n14  AAAAAAAANOMPFAAA             Barbara               Howe                   Barbara.Howe@eOUa.com\n15  AAAAAAAALGKJAAAA              Lillie            Leclair                   Lillie.Leclair@at.com\n16  AAAAAAAALEGPBAAA              Pamela             Alfaro             Pamela.Alfaro@T1eeb8qmN.edu\n17  AAAAAAAAKIHDAAAA              Tamera           Morrison      Tamera.Morrison@arAi6oPcBpNP5h.org\n18  AAAAAAAABPCFCAAA              Andrea              Gross           Andrea.Gross@YtkKtNzF0Q9l.com\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,1998 dyear\n       ,0 year_total\n       ,'s' sale_type\n from customer\n where c_customer_id is not null\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,1998 dyear\n       ,0 year_total\n       ,'c' sale_type\n from customer\n where c_customer_id is not null\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,1998 dyear\n       ,0 year_total\n       ,'w' sale_type\n from customer\n where c_customer_id is not null\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n )\n select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 1998 AS \"DYEAR\" , 0 AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER\" AS \"CUSTOMER\" WHERE NOT \"CUSTOMER\".\"C_CUSTOMER_ID\" IS NULL GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 1998 AS \"DYEAR\" , 0 AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER\" AS \"CUSTOMER\" WHERE NOT \"CUSTOMER\".\"C_CUSTOMER_ID\" IS NULL GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 1998 AS \"DYEAR\" , 0 AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER\" AS \"CUSTOMER\" WHERE NOT \"CUSTOMER\".\"C_CUSTOMER_ID\" IS NULL GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END <> 0 AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 1998 AS \"DYEAR\" , 0 AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER\" AS \"CUSTOMER\" WHERE NOT \"CUSTOMER\".\"C_CUSTOMER_ID\" IS NULL GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 1998 AS \"DYEAR\" , 0 AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER\" AS \"CUSTOMER\" WHERE NOT \"CUSTOMER\".\"C_CUSTOMER_ID\" IS NULL GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 1998 AS \"DYEAR\" , 0 AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER\" AS \"CUSTOMER\" WHERE NOT \"CUSTOMER\".\"C_CUSTOMER_ID\" IS NULL GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.900497,
                    "execution_time": 0.893588,
                    "compile_time": 0.000865,
                    "planning_time": 0.979706,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.009057,
                    "execution_time": 0.919966,
                    "compile_time": 0.000904,
                    "planning_time": 1.064761,
                    "create_size": 1280
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END <> 0 AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.188388,
                    "execution_time": 0.056863,
                    "compile_time": 0.042816,
                    "planning_time": 0.031169,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.275341,
                    "execution_time": 0.06381,
                    "compile_time": 3.059026,
                    "planning_time": 0.110145,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [customer_id, customer_first_name, customer_last_name, customer_email_address]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019338,
                    "execution_time": 0.007012,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004702
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054729,
                    "execution_time": 0.007279,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039792
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END <> 0 AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN CAST ( \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" AS BIGINT ) ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [customer_id, customer_first_name, customer_last_name, customer_email_address]\nIndex: []*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.44164,
                    "execution_time": 0.153337,
                    "compile_time": 0.235216,
                    "planning_time": 0.031081,
                    "create_size": 889
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 12.717839,
                    "execution_time": 0.161791,
                    "compile_time": 12.415849,
                    "planning_time": 0.101642,
                    "create_size": 889
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                    customer_email_address\n0   AAAAAAAANGFIGAAA               Flora             Carter        Flora.Carter@gNnkOle2RhvZDATjF.edu\n1   AAAAAAAAJOHAEAAA                Paul             Mcleod                      Paul.Mcleod@RYKU.edu\n2   AAAAAAAAJHIOCAAA              Robert              Olson                       Robert.Olson@VL.edu\n3   AAAAAAAAEKHBBAAA             Zachary            Hillard                                          \n4   AAAAAAAAHPIEEAAA             William              North    William.North@MvMQ5rhy2j5Lpnf2KouX.edu\n5   AAAAAAAAPBADBAAA              Cheryl             Benson                     Cheryl.Benson@Ub4.com\n6   AAAAAAAAFEPHCAAA               James            Mccrary             James.Mccrary@fKMH4jQpD88.org\n7   AAAAAAAAGIGJBAAA                John              Lynch                     John.Lynch@uO6V05.edu\n8   AAAAAAAACDIBGAAA             Barbara         Mcreynolds      Barbara.Mcreynolds@Qptf9HKBI2MLb.com\n9   AAAAAAAAFMMCEAAA                Lela              Evans                        Lela.Evans@2Ra.edu\n10  AAAAAAAANPKIGAAA               James               Pike               James.Pike@K8u0eh63f2FR.edu\n11  AAAAAAAAHLFDBAAA               Julie              Woods           Julie.Woods@d1tBubP0H2Jckoh.org\n12  AAAAAAAAEEGAAAAA           Rosemarie          Hernandez               Rosemarie.Hernandez@ebP.com\n13  AAAAAAAANOMPFAAA             Barbara               Howe                     Barbara.Howe@eOUa.com\n14  AAAAAAAAKMNCBAAA                Levi             Dodson             Levi.Dodson@F70v4N8rojFbZ.com\n15  AAAAAAAAMJEFEAAA                Adam            Hopkins       Adam.Hopkins@2p2Y8PrxJJptMlaQEi.com\n16  AAAAAAAAOOAJGAAA                                                     James.Hall@fmXEl76Dfe1sj.org\n17  AAAAAAAAEHICHAAA                 Ted             Massey              Ted.Massey@uIpEHLqr6dE0g.edu\n18  AAAAAAAALKGBAAAA             Crystal               Diaz                     Crystal.Diaz@KlPE.edu\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016796,
                    "execution_time": 0.007323,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003438
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05613,
                    "execution_time": 0.007878,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038713
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                    customer_email_address\n0   AAAAAAAANGFIGAAA               Flora             Carter        Flora.Carter@gNnkOle2RhvZDATjF.edu\n1   AAAAAAAAJOHAEAAA                Paul             Mcleod                      Paul.Mcleod@RYKU.edu\n2   AAAAAAAAJHIOCAAA              Robert              Olson                       Robert.Olson@VL.edu\n3   AAAAAAAAEKHBBAAA             Zachary            Hillard                                          \n4   AAAAAAAAHPIEEAAA             William              North    William.North@MvMQ5rhy2j5Lpnf2KouX.edu\n5   AAAAAAAAPBADBAAA              Cheryl             Benson                     Cheryl.Benson@Ub4.com\n6   AAAAAAAAFEPHCAAA               James            Mccrary             James.Mccrary@fKMH4jQpD88.org\n7   AAAAAAAAGIGJBAAA                John              Lynch                     John.Lynch@uO6V05.edu\n8   AAAAAAAACDIBGAAA             Barbara         Mcreynolds      Barbara.Mcreynolds@Qptf9HKBI2MLb.com\n9   AAAAAAAAFMMCEAAA                Lela              Evans                        Lela.Evans@2Ra.edu\n10  AAAAAAAANPKIGAAA               James               Pike               James.Pike@K8u0eh63f2FR.edu\n11  AAAAAAAAHLFDBAAA               Julie              Woods           Julie.Woods@d1tBubP0H2Jckoh.org\n12  AAAAAAAAEEGAAAAA           Rosemarie          Hernandez               Rosemarie.Hernandez@ebP.com\n13  AAAAAAAANOMPFAAA             Barbara               Howe                     Barbara.Howe@eOUa.com\n14  AAAAAAAAKMNCBAAA                Levi             Dodson             Levi.Dodson@F70v4N8rojFbZ.com\n15  AAAAAAAAMJEFEAAA                Adam            Hopkins       Adam.Hopkins@2p2Y8PrxJJptMlaQEi.com\n16  AAAAAAAAOOAJGAAA                                                     James.Hall@fmXEl76Dfe1sj.org\n17  AAAAAAAAEHICHAAA                 Ted             Massey              Ted.Massey@uIpEHLqr6dE0g.edu\n18  AAAAAAAALKGBAAAA             Crystal               Diaz                     Crystal.Diaz@KlPE.edu\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_ID\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                 customer_email_address\n0   AAAAAAAAAACNCAAA               Korey             Steele          Korey.Steele@g9belmoHo6K9.org\n1   AAAAAAAAAAEKGAAA                Paul              Green                      Paul.Green@ZZ.com\n2   AAAAAAAAABGIAAAA             Carolyn            Jimenez         Carolyn.Jimenez@MhOKMMmgt7.com\n3   AAAAAAAAABHMAAAA             Anthony           Thompson              Anthony.Thompson@GJRf.org\n4   AAAAAAAAABPJFAAA                Anne              Tyson          Anne.Tyson@3Bqo58h6qlpAhF.org\n5   AAAAAAAAACCPCAAA                 Rex           Martinez             Rex.Martinez@mH3R0CVcc.edu\n6   AAAAAAAAADFKEAAA                                         Carlos.Wright@xtAHtQqdmIXLQMUmCqe.com\n7   AAAAAAAAADFMAAAA              Evelyn             Gordon           Evelyn.Gordon@Az9hDU1frr.org\n8   AAAAAAAAADMEHAAA             Krystal            Dempsey                Krystal.Dempsey@xRN.edu\n9   AAAAAAAAAECMBAAA              Yvette               Ross                   Yvette.Ross@JnNH.edu\n10  AAAAAAAAAEMBBAAA               Patty             Butler                 Patty.Butler@tgkKR.edu\n11  AAAAAAAAAEODAAAA              Austin              Healy                 Austin.Healy@DoOKc.edu\n12  AAAAAAAAAEPDGAAA              Andrew              Boren         Andrew.Boren@BlIvf63YgsqNE.edu\n13  AAAAAAAAAFDHBAAA               Jerry              Price                  Jerry.Price@PlNrJ.com\n14  AAAAAAAAAFJMCAAA                John            Eastman     John.Eastman@n387t9ITxNgJZZVve.com\n15  AAAAAAAAAGCEHAAA              Gerald            Burgess  Gerald.Burgess@jNoYxH9L3sbJRJOfzM.org\n16  AAAAAAAAAGMHBAAA                                           Deshawn.Robertson@COEVQEP2RCZyK.edu\n17  AAAAAAAAAGNJFAAA                Sara               Leak           Sara.Leak@sSYrsmLsq7iYlb.edu\n18  AAAAAAAAAHJHCAAA             Beverly           Thompson          Beverly.Thompson@ELpfMS0j.edu\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018714,
                    "execution_time": 0.009029,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.003621
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05968,
                    "execution_time": 0.009934,
                    "compile_time": 0.001257,
                    "planning_time": 0.03893
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                 customer_email_address\n0   AAAAAAAAAACNCAAA               Korey             Steele          Korey.Steele@g9belmoHo6K9.org\n1   AAAAAAAAAAEKGAAA                Paul              Green                      Paul.Green@ZZ.com\n2   AAAAAAAAABGIAAAA             Carolyn            Jimenez         Carolyn.Jimenez@MhOKMMmgt7.com\n3   AAAAAAAAABHMAAAA             Anthony           Thompson              Anthony.Thompson@GJRf.org\n4   AAAAAAAAABPJFAAA                Anne              Tyson          Anne.Tyson@3Bqo58h6qlpAhF.org\n5   AAAAAAAAACCPCAAA                 Rex           Martinez             Rex.Martinez@mH3R0CVcc.edu\n6   AAAAAAAAADFKEAAA                                         Carlos.Wright@xtAHtQqdmIXLQMUmCqe.com\n7   AAAAAAAAADFMAAAA              Evelyn             Gordon           Evelyn.Gordon@Az9hDU1frr.org\n8   AAAAAAAAADMEHAAA             Krystal            Dempsey                Krystal.Dempsey@xRN.edu\n9   AAAAAAAAAECMBAAA              Yvette               Ross                   Yvette.Ross@JnNH.edu\n10  AAAAAAAAAEMBBAAA               Patty             Butler                 Patty.Butler@tgkKR.edu\n11  AAAAAAAAAEODAAAA              Austin              Healy                 Austin.Healy@DoOKc.edu\n12  AAAAAAAAAEPDGAAA              Andrew              Boren         Andrew.Boren@BlIvf63YgsqNE.edu\n13  AAAAAAAAAFDHBAAA               Jerry              Price                  Jerry.Price@PlNrJ.com\n14  AAAAAAAAAFJMCAAA                John            Eastman     John.Eastman@n387t9ITxNgJZZVve.com\n15  AAAAAAAAAGCEHAAA              Gerald            Burgess  Gerald.Burgess@jNoYxH9L3sbJRJOfzM.org\n16  AAAAAAAAAGMHBAAA                                           Deshawn.Robertson@COEVQEP2RCZyK.edu\n17  AAAAAAAAAGNJFAAA                Sara               Leak           Sara.Leak@sSYrsmLsq7iYlb.edu\n18  AAAAAAAAAHJHCAAA             Beverly           Thompson          Beverly.Thompson@ELpfMS0j.edu\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_FIRST_NAME\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                 customer_email_address\n0   AAAAAAAAAACNCAAA               Korey             Steele          Korey.Steele@g9belmoHo6K9.org\n1   AAAAAAAAAAEKGAAA                Paul              Green                      Paul.Green@ZZ.com\n2   AAAAAAAAABGIAAAA             Carolyn            Jimenez         Carolyn.Jimenez@MhOKMMmgt7.com\n3   AAAAAAAAABHMAAAA             Anthony           Thompson              Anthony.Thompson@GJRf.org\n4   AAAAAAAAABPJFAAA                Anne              Tyson          Anne.Tyson@3Bqo58h6qlpAhF.org\n5   AAAAAAAAACCPCAAA                 Rex           Martinez             Rex.Martinez@mH3R0CVcc.edu\n6   AAAAAAAAADFKEAAA                                         Carlos.Wright@xtAHtQqdmIXLQMUmCqe.com\n7   AAAAAAAAADFMAAAA              Evelyn             Gordon           Evelyn.Gordon@Az9hDU1frr.org\n8   AAAAAAAAADMEHAAA             Krystal            Dempsey                Krystal.Dempsey@xRN.edu\n9   AAAAAAAAAECMBAAA              Yvette               Ross                   Yvette.Ross@JnNH.edu\n10  AAAAAAAAAEMBBAAA               Patty             Butler                 Patty.Butler@tgkKR.edu\n11  AAAAAAAAAEODAAAA              Austin              Healy                 Austin.Healy@DoOKc.edu\n12  AAAAAAAAAEPDGAAA              Andrew              Boren         Andrew.Boren@BlIvf63YgsqNE.edu\n13  AAAAAAAAAFDHBAAA               Jerry              Price                  Jerry.Price@PlNrJ.com\n14  AAAAAAAAAFJMCAAA                John            Eastman     John.Eastman@n387t9ITxNgJZZVve.com\n15  AAAAAAAAAGCEHAAA              Gerald            Burgess  Gerald.Burgess@jNoYxH9L3sbJRJOfzM.org\n16  AAAAAAAAAGMHBAAA                                           Deshawn.Robertson@COEVQEP2RCZyK.edu\n17  AAAAAAAAAGNJFAAA                Sara               Leak           Sara.Leak@sSYrsmLsq7iYlb.edu\n18  AAAAAAAAAHJHCAAA             Beverly           Thompson          Beverly.Thompson@ELpfMS0j.edu\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018862,
                    "execution_time": 0.00945,
                    "compile_time": 7e-05,
                    "planning_time": 0.003511
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055518,
                    "execution_time": 0.00915,
                    "compile_time": 0.001234,
                    "planning_time": 0.038868
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_FIRST_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                 customer_email_address\n0   AAAAAAAAAACNCAAA               Korey             Steele          Korey.Steele@g9belmoHo6K9.org\n1   AAAAAAAAAAEKGAAA                Paul              Green                      Paul.Green@ZZ.com\n2   AAAAAAAAABGIAAAA             Carolyn            Jimenez         Carolyn.Jimenez@MhOKMMmgt7.com\n3   AAAAAAAAABHMAAAA             Anthony           Thompson              Anthony.Thompson@GJRf.org\n4   AAAAAAAAABPJFAAA                Anne              Tyson          Anne.Tyson@3Bqo58h6qlpAhF.org\n5   AAAAAAAAACCPCAAA                 Rex           Martinez             Rex.Martinez@mH3R0CVcc.edu\n6   AAAAAAAAADFKEAAA                                         Carlos.Wright@xtAHtQqdmIXLQMUmCqe.com\n7   AAAAAAAAADFMAAAA              Evelyn             Gordon           Evelyn.Gordon@Az9hDU1frr.org\n8   AAAAAAAAADMEHAAA             Krystal            Dempsey                Krystal.Dempsey@xRN.edu\n9   AAAAAAAAAECMBAAA              Yvette               Ross                   Yvette.Ross@JnNH.edu\n10  AAAAAAAAAEMBBAAA               Patty             Butler                 Patty.Butler@tgkKR.edu\n11  AAAAAAAAAEODAAAA              Austin              Healy                 Austin.Healy@DoOKc.edu\n12  AAAAAAAAAEPDGAAA              Andrew              Boren         Andrew.Boren@BlIvf63YgsqNE.edu\n13  AAAAAAAAAFDHBAAA               Jerry              Price                  Jerry.Price@PlNrJ.com\n14  AAAAAAAAAFJMCAAA                John            Eastman     John.Eastman@n387t9ITxNgJZZVve.com\n15  AAAAAAAAAGCEHAAA              Gerald            Burgess  Gerald.Burgess@jNoYxH9L3sbJRJOfzM.org\n16  AAAAAAAAAGMHBAAA                                           Deshawn.Robertson@COEVQEP2RCZyK.edu\n17  AAAAAAAAAGNJFAAA                Sara               Leak           Sara.Leak@sSYrsmLsq7iYlb.edu\n18  AAAAAAAAAHJHCAAA             Beverly           Thompson          Beverly.Thompson@ELpfMS0j.edu\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n         ,t_s_secyear.customer_last_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_LAST_NAME\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                 customer_email_address\n0   AAAAAAAAAACNCAAA               Korey             Steele          Korey.Steele@g9belmoHo6K9.org\n1   AAAAAAAAAAEKGAAA                Paul              Green                      Paul.Green@ZZ.com\n2   AAAAAAAAABGIAAAA             Carolyn            Jimenez         Carolyn.Jimenez@MhOKMMmgt7.com\n3   AAAAAAAAABHMAAAA             Anthony           Thompson              Anthony.Thompson@GJRf.org\n4   AAAAAAAAABPJFAAA                Anne              Tyson          Anne.Tyson@3Bqo58h6qlpAhF.org\n5   AAAAAAAAACCPCAAA                 Rex           Martinez             Rex.Martinez@mH3R0CVcc.edu\n6   AAAAAAAAADFKEAAA                                         Carlos.Wright@xtAHtQqdmIXLQMUmCqe.com\n7   AAAAAAAAADFMAAAA              Evelyn             Gordon           Evelyn.Gordon@Az9hDU1frr.org\n8   AAAAAAAAADMEHAAA             Krystal            Dempsey                Krystal.Dempsey@xRN.edu\n9   AAAAAAAAAECMBAAA              Yvette               Ross                   Yvette.Ross@JnNH.edu\n10  AAAAAAAAAEMBBAAA               Patty             Butler                 Patty.Butler@tgkKR.edu\n11  AAAAAAAAAEODAAAA              Austin              Healy                 Austin.Healy@DoOKc.edu\n12  AAAAAAAAAEPDGAAA              Andrew              Boren         Andrew.Boren@BlIvf63YgsqNE.edu\n13  AAAAAAAAAFDHBAAA               Jerry              Price                  Jerry.Price@PlNrJ.com\n14  AAAAAAAAAFJMCAAA                John            Eastman     John.Eastman@n387t9ITxNgJZZVve.com\n15  AAAAAAAAAGCEHAAA              Gerald            Burgess  Gerald.Burgess@jNoYxH9L3sbJRJOfzM.org\n16  AAAAAAAAAGMHBAAA                                           Deshawn.Robertson@COEVQEP2RCZyK.edu\n17  AAAAAAAAAGNJFAAA                Sara               Leak           Sara.Leak@sSYrsmLsq7iYlb.edu\n18  AAAAAAAAAHJHCAAA             Beverly           Thompson          Beverly.Thompson@ELpfMS0j.edu\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018844,
                    "execution_time": 0.008922,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.003838
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055907,
                    "execution_time": 0.009439,
                    "compile_time": 0.001231,
                    "planning_time": 0.039003
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_LAST_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                 customer_email_address\n0   AAAAAAAAAACNCAAA               Korey             Steele          Korey.Steele@g9belmoHo6K9.org\n1   AAAAAAAAAAEKGAAA                Paul              Green                      Paul.Green@ZZ.com\n2   AAAAAAAAABGIAAAA             Carolyn            Jimenez         Carolyn.Jimenez@MhOKMMmgt7.com\n3   AAAAAAAAABHMAAAA             Anthony           Thompson              Anthony.Thompson@GJRf.org\n4   AAAAAAAAABPJFAAA                Anne              Tyson          Anne.Tyson@3Bqo58h6qlpAhF.org\n5   AAAAAAAAACCPCAAA                 Rex           Martinez             Rex.Martinez@mH3R0CVcc.edu\n6   AAAAAAAAADFKEAAA                                         Carlos.Wright@xtAHtQqdmIXLQMUmCqe.com\n7   AAAAAAAAADFMAAAA              Evelyn             Gordon           Evelyn.Gordon@Az9hDU1frr.org\n8   AAAAAAAAADMEHAAA             Krystal            Dempsey                Krystal.Dempsey@xRN.edu\n9   AAAAAAAAAECMBAAA              Yvette               Ross                   Yvette.Ross@JnNH.edu\n10  AAAAAAAAAEMBBAAA               Patty             Butler                 Patty.Butler@tgkKR.edu\n11  AAAAAAAAAEODAAAA              Austin              Healy                 Austin.Healy@DoOKc.edu\n12  AAAAAAAAAEPDGAAA              Andrew              Boren         Andrew.Boren@BlIvf63YgsqNE.edu\n13  AAAAAAAAAFDHBAAA               Jerry              Price                  Jerry.Price@PlNrJ.com\n14  AAAAAAAAAFJMCAAA                John            Eastman     John.Eastman@n387t9ITxNgJZZVve.com\n15  AAAAAAAAAGCEHAAA              Gerald            Burgess  Gerald.Burgess@jNoYxH9L3sbJRJOfzM.org\n16  AAAAAAAAAGMHBAAA                                           Deshawn.Robertson@COEVQEP2RCZyK.edu\n17  AAAAAAAAAGNJFAAA                Sara               Leak           Sara.Leak@sSYrsmLsq7iYlb.edu\n18  AAAAAAAAAHJHCAAA             Beverly           Thompson          Beverly.Thompson@ELpfMS0j.edu\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n         ,t_s_secyear.customer_last_name\n         ,t_s_secyear.customer_email_address\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_EMAIL_ADDRESS\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                 customer_email_address\n0   AAAAAAAAAACNCAAA               Korey             Steele          Korey.Steele@g9belmoHo6K9.org\n1   AAAAAAAAAAEKGAAA                Paul              Green                      Paul.Green@ZZ.com\n2   AAAAAAAAABGIAAAA             Carolyn            Jimenez         Carolyn.Jimenez@MhOKMMmgt7.com\n3   AAAAAAAAABHMAAAA             Anthony           Thompson              Anthony.Thompson@GJRf.org\n4   AAAAAAAAABPJFAAA                Anne              Tyson          Anne.Tyson@3Bqo58h6qlpAhF.org\n5   AAAAAAAAACCPCAAA                 Rex           Martinez             Rex.Martinez@mH3R0CVcc.edu\n6   AAAAAAAAADFKEAAA                                         Carlos.Wright@xtAHtQqdmIXLQMUmCqe.com\n7   AAAAAAAAADFMAAAA              Evelyn             Gordon           Evelyn.Gordon@Az9hDU1frr.org\n8   AAAAAAAAADMEHAAA             Krystal            Dempsey                Krystal.Dempsey@xRN.edu\n9   AAAAAAAAAECMBAAA              Yvette               Ross                   Yvette.Ross@JnNH.edu\n10  AAAAAAAAAEMBBAAA               Patty             Butler                 Patty.Butler@tgkKR.edu\n11  AAAAAAAAAEODAAAA              Austin              Healy                 Austin.Healy@DoOKc.edu\n12  AAAAAAAAAEPDGAAA              Andrew              Boren         Andrew.Boren@BlIvf63YgsqNE.edu\n13  AAAAAAAAAFDHBAAA               Jerry              Price                  Jerry.Price@PlNrJ.com\n14  AAAAAAAAAFJMCAAA                John            Eastman     John.Eastman@n387t9ITxNgJZZVve.com\n15  AAAAAAAAAGCEHAAA              Gerald            Burgess  Gerald.Burgess@jNoYxH9L3sbJRJOfzM.org\n16  AAAAAAAAAGMHBAAA                                           Deshawn.Robertson@COEVQEP2RCZyK.edu\n17  AAAAAAAAAGNJFAAA                Sara               Leak           Sara.Leak@sSYrsmLsq7iYlb.edu\n18  AAAAAAAAAHJHCAAA             Beverly           Thompson          Beverly.Thompson@ELpfMS0j.edu\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019569,
                    "execution_time": 0.009605,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.003931
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056245,
                    "execution_time": 0.009715,
                    "compile_time": 0.001169,
                    "planning_time": 0.039157
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                 customer_email_address\n0   AAAAAAAAAACNCAAA               Korey             Steele          Korey.Steele@g9belmoHo6K9.org\n1   AAAAAAAAAAEKGAAA                Paul              Green                      Paul.Green@ZZ.com\n2   AAAAAAAAABGIAAAA             Carolyn            Jimenez         Carolyn.Jimenez@MhOKMMmgt7.com\n3   AAAAAAAAABHMAAAA             Anthony           Thompson              Anthony.Thompson@GJRf.org\n4   AAAAAAAAABPJFAAA                Anne              Tyson          Anne.Tyson@3Bqo58h6qlpAhF.org\n5   AAAAAAAAACCPCAAA                 Rex           Martinez             Rex.Martinez@mH3R0CVcc.edu\n6   AAAAAAAAADFKEAAA                                         Carlos.Wright@xtAHtQqdmIXLQMUmCqe.com\n7   AAAAAAAAADFMAAAA              Evelyn             Gordon           Evelyn.Gordon@Az9hDU1frr.org\n8   AAAAAAAAADMEHAAA             Krystal            Dempsey                Krystal.Dempsey@xRN.edu\n9   AAAAAAAAAECMBAAA              Yvette               Ross                   Yvette.Ross@JnNH.edu\n10  AAAAAAAAAEMBBAAA               Patty             Butler                 Patty.Butler@tgkKR.edu\n11  AAAAAAAAAEODAAAA              Austin              Healy                 Austin.Healy@DoOKc.edu\n12  AAAAAAAAAEPDGAAA              Andrew              Boren         Andrew.Boren@BlIvf63YgsqNE.edu\n13  AAAAAAAAAFDHBAAA               Jerry              Price                  Jerry.Price@PlNrJ.com\n14  AAAAAAAAAFJMCAAA                John            Eastman     John.Eastman@n387t9ITxNgJZZVve.com\n15  AAAAAAAAAGCEHAAA              Gerald            Burgess  Gerald.Burgess@jNoYxH9L3sbJRJOfzM.org\n16  AAAAAAAAAGMHBAAA                                           Deshawn.Robertson@COEVQEP2RCZyK.edu\n17  AAAAAAAAAGNJFAAA                Sara               Leak           Sara.Leak@sSYrsmLsq7iYlb.edu\n18  AAAAAAAAAHJHCAAA             Beverly           Thompson          Beverly.Thompson@ELpfMS0j.edu\n...*/"
    },
    {
        "input": "-- start template query4.tpl query 93 in stream 0\nwith /* TPC-DS query4.tpl 0.93 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(((ss_ext_list_price-ss_ext_wholesale_cost-ss_ext_discount_amt)+ss_ext_sales_price)/2) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((cs_ext_list_price-cs_ext_wholesale_cost-cs_ext_discount_amt)+cs_ext_sales_price)/2) ) year_total\n       ,'c' sale_type\n from customer\n     ,catalog_sales\n     ,date_dim\n where c_customer_sk = cs_bill_customer_sk\n   and cs_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\nunion all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum((((ws_ext_list_price-ws_ext_wholesale_cost-ws_ext_discount_amt)+ws_ext_sales_price)/2) ) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag\n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_c_firstyear\n     ,year_total t_c_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_c_secyear.customer_id\n   and t_s_firstyear.customer_id = t_c_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n   and t_s_firstyear.customer_id = t_w_secyear.customer_id\n   and t_s_firstyear.sale_type = 's'\n   and t_c_firstyear.sale_type = 'c'\n   and t_w_firstyear.sale_type = 'w'\n   and t_s_secyear.sale_type = 's'\n   and t_c_secyear.sale_type = 'c'\n   and t_w_secyear.sale_type = 'w'\n   and t_s_firstyear.dyear =  1998\n   and t_s_secyear.dyear = 1998+1\n   and t_c_firstyear.dyear =  1998\n   and t_c_secyear.dyear =  1998+1\n   and t_w_firstyear.dyear = 1998\n   and t_w_secyear.dyear = 1998+1\n   and t_s_firstyear.year_total > 0\n   and t_c_firstyear.year_total > 0\n   and t_w_firstyear.year_total > 0\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else null end\n   and case when t_c_firstyear.year_total > 0 then t_c_secyear.year_total / t_c_firstyear.year_total else null end\n           > case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else null end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n         ,t_s_secyear.customer_last_name\n         ,t_s_secyear.customer_email_address\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_WHOLESALE_COST\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) + \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) / 2 ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"CATALOG_SALES\".\"CS_EXT_LIST_PRICE\" - \"CATALOG_SALES\".\"CS_EXT_WHOLESALE_COST\" - \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) + \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'c' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( ( ( ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_WHOLESALE_COST\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) + \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) / 2 ) ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_EMAIL_ADDRESS\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                 customer_email_address\n0   AAAAAAAAAACNCAAA               Korey             Steele          Korey.Steele@g9belmoHo6K9.org\n1   AAAAAAAAAAEKGAAA                Paul              Green                      Paul.Green@ZZ.com\n2   AAAAAAAAABGIAAAA             Carolyn            Jimenez         Carolyn.Jimenez@MhOKMMmgt7.com\n3   AAAAAAAAABHMAAAA             Anthony           Thompson              Anthony.Thompson@GJRf.org\n4   AAAAAAAAABPJFAAA                Anne              Tyson          Anne.Tyson@3Bqo58h6qlpAhF.org\n5   AAAAAAAAACCPCAAA                 Rex           Martinez             Rex.Martinez@mH3R0CVcc.edu\n6   AAAAAAAAADFKEAAA                                         Carlos.Wright@xtAHtQqdmIXLQMUmCqe.com\n7   AAAAAAAAADFMAAAA              Evelyn             Gordon           Evelyn.Gordon@Az9hDU1frr.org\n8   AAAAAAAAADMEHAAA             Krystal            Dempsey                Krystal.Dempsey@xRN.edu\n9   AAAAAAAAAECMBAAA              Yvette               Ross                   Yvette.Ross@JnNH.edu\n10  AAAAAAAAAEMBBAAA               Patty             Butler                 Patty.Butler@tgkKR.edu\n11  AAAAAAAAAEODAAAA              Austin              Healy                 Austin.Healy@DoOKc.edu\n12  AAAAAAAAAEPDGAAA              Andrew              Boren         Andrew.Boren@BlIvf63YgsqNE.edu\n13  AAAAAAAAAFDHBAAA               Jerry              Price                  Jerry.Price@PlNrJ.com\n14  AAAAAAAAAFJMCAAA                John            Eastman     John.Eastman@n387t9ITxNgJZZVve.com\n15  AAAAAAAAAGCEHAAA              Gerald            Burgess  Gerald.Burgess@jNoYxH9L3sbJRJOfzM.org\n16  AAAAAAAAAGMHBAAA                                           Deshawn.Robertson@COEVQEP2RCZyK.edu\n17  AAAAAAAAAGNJFAAA                Sara               Leak           Sara.Leak@sSYrsmLsq7iYlb.edu\n18  AAAAAAAAAHJHCAAA             Beverly           Thompson          Beverly.Thompson@ELpfMS0j.edu\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019055,
                    "execution_time": 0.009021,
                    "compile_time": 7.1e-05,
                    "planning_time": 0.003992
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019408,
                    "execution_time": 0.009253,
                    "compile_time": 7.1e-05,
                    "planning_time": 0.003965
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_FIRSTYEAR\" ON \"T_C_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_C_FIRSTYEAR\".\"SALE_TYPE\" = 'c' AND \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_C_SECYEAR\" ON \"T_C_SECYEAR\".\"CUSTOMER_ID\" = \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_C_SECYEAR\".\"DYEAR\" = 1999 AND \"T_C_SECYEAR\".\"SALE_TYPE\" = 'c' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_C_SECYEAR\".\"YEAR_TOTAL\" / \"T_C_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END > CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE NULL END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                 customer_email_address\n0   AAAAAAAAAACNCAAA               Korey             Steele          Korey.Steele@g9belmoHo6K9.org\n1   AAAAAAAAAAEKGAAA                Paul              Green                      Paul.Green@ZZ.com\n2   AAAAAAAAABGIAAAA             Carolyn            Jimenez         Carolyn.Jimenez@MhOKMMmgt7.com\n3   AAAAAAAAABHMAAAA             Anthony           Thompson              Anthony.Thompson@GJRf.org\n4   AAAAAAAAABPJFAAA                Anne              Tyson          Anne.Tyson@3Bqo58h6qlpAhF.org\n5   AAAAAAAAACCPCAAA                 Rex           Martinez             Rex.Martinez@mH3R0CVcc.edu\n6   AAAAAAAAADFKEAAA                                         Carlos.Wright@xtAHtQqdmIXLQMUmCqe.com\n7   AAAAAAAAADFMAAAA              Evelyn             Gordon           Evelyn.Gordon@Az9hDU1frr.org\n8   AAAAAAAAADMEHAAA             Krystal            Dempsey                Krystal.Dempsey@xRN.edu\n9   AAAAAAAAAECMBAAA              Yvette               Ross                   Yvette.Ross@JnNH.edu\n10  AAAAAAAAAEMBBAAA               Patty             Butler                 Patty.Butler@tgkKR.edu\n11  AAAAAAAAAEODAAAA              Austin              Healy                 Austin.Healy@DoOKc.edu\n12  AAAAAAAAAEPDGAAA              Andrew              Boren         Andrew.Boren@BlIvf63YgsqNE.edu\n13  AAAAAAAAAFDHBAAA               Jerry              Price                  Jerry.Price@PlNrJ.com\n14  AAAAAAAAAFJMCAAA                John            Eastman     John.Eastman@n387t9ITxNgJZZVve.com\n15  AAAAAAAAAGCEHAAA              Gerald            Burgess  Gerald.Burgess@jNoYxH9L3sbJRJOfzM.org\n16  AAAAAAAAAGMHBAAA                                           Deshawn.Robertson@COEVQEP2RCZyK.edu\n17  AAAAAAAAAGNJFAAA                Sara               Leak           Sara.Leak@sSYrsmLsq7iYlb.edu\n18  AAAAAAAAAHJHCAAA             Beverly           Thompson          Beverly.Thompson@ELpfMS0j.edu\n...*/"
    }
]