[
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"SS\" AS \"SS3\" CROSS JOIN \"WS\" AS \"WS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.241662,
                    "execution_time": 0.081598,
                    "compile_time": 0.000253,
                    "planning_time": 0.022593,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.315665,
                    "execution_time": 0.086471,
                    "compile_time": 0.000251,
                    "planning_time": 0.086608,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.117405,
                    "execution_time": 0.042434,
                    "compile_time": 0.000239,
                    "planning_time": 0.025194,
                    "create_size": 576
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.182155,
                    "execution_time": 0.044303,
                    "compile_time": 0.000234,
                    "planning_time": 0.088111,
                    "create_size": 576
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.775961,
                    "execution_time": 1.638243,
                    "compile_time": 0.031529,
                    "planning_time": 0.02868,
                    "create_size": 371
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.369836,
                    "execution_time": 2.885325,
                    "compile_time": 3.309975,
                    "planning_time": 0.091673,
                    "create_size": 371
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.589924,
                    "execution_time": 0.477315,
                    "compile_time": 0.027657,
                    "planning_time": 0.031562,
                    "create_size": 192
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.509809,
                    "execution_time": 1.082311,
                    "compile_time": 3.273225,
                    "planning_time": 0.096467,
                    "create_size": 192
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*          ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Lawrence County    1998             10.3976                0.9606              0.1978                0.1173\n1   Lawrence County    1998             10.3976                1.0230              0.1978                0.1102\n2   Lawrence County    1998             10.3976                2.9727              0.1978                0.0379\n3   Lawrence County    1998             10.3976                0.9270              0.1978                0.1216\n4   Lawrence County    1998             10.3976                3.1380              0.1978                0.0359\n5   Lawrence County    1998             10.3976                2.0721              0.1978                0.0544\n6   Lawrence County    1998             10.3976                2.9404              0.1978                0.0383\n7   Lawrence County    1998             10.3976                0.0707              0.1978                1.5949\n8   Lawrence County    1998             10.3976                1.9867              0.1978                0.0567\n9   Lawrence County    1998             10.3976                3.0115              0.1978                0.0374\n10  Lawrence County    1998             10.3976                1.0623              0.1978                0.1061\n11  Lawrence County    1998             10.3976                1.8535              0.1978                0.0608\n12  Lawrence County    1998             10.3976                2.0163              0.1978                0.0559\n13  Lawrence County    1998             10.3976                1.1947              0.1978                0.0943\n14  Lawrence County    1998             10.3976                1.1166              0.1978                0.1009\n15  Lawrence County    1998             10.3976                1.0197              0.1978                0.1105\n16  Lawrence County    1998             10.3976                2.9280              0.1978                0.0385\n17  Lawrence County    1998             10.3976                1.0381              0.1978                0.1086\n18  Lawrence County    1998             10.3976                1.1154              0.1978                0.1010\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.073519,
                    "execution_time": 0.048773,
                    "compile_time": 0.000263,
                    "planning_time": 0.011349
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.272982,
                    "execution_time": 0.208567,
                    "compile_time": 0.001264,
                    "planning_time": 0.047825
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*          ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Lawrence County    1998             10.3976                0.9606              0.1978                0.1173\n1   Lawrence County    1998             10.3976                1.0230              0.1978                0.1102\n2   Lawrence County    1998             10.3976                2.9727              0.1978                0.0379\n3   Lawrence County    1998             10.3976                0.9270              0.1978                0.1216\n4   Lawrence County    1998             10.3976                3.1380              0.1978                0.0359\n5   Lawrence County    1998             10.3976                2.0721              0.1978                0.0544\n6   Lawrence County    1998             10.3976                2.9404              0.1978                0.0383\n7   Lawrence County    1998             10.3976                0.0707              0.1978                1.5949\n8   Lawrence County    1998             10.3976                1.9867              0.1978                0.0567\n9   Lawrence County    1998             10.3976                3.0115              0.1978                0.0374\n10  Lawrence County    1998             10.3976                1.0623              0.1978                0.1061\n11  Lawrence County    1998             10.3976                1.8535              0.1978                0.0608\n12  Lawrence County    1998             10.3976                2.0163              0.1978                0.0559\n13  Lawrence County    1998             10.3976                1.1947              0.1978                0.0943\n14  Lawrence County    1998             10.3976                1.1166              0.1978                0.1009\n15  Lawrence County    1998             10.3976                1.0197              0.1978                0.1105\n16  Lawrence County    1998             10.3976                2.9280              0.1978                0.0385\n17  Lawrence County    1998             10.3976                1.0381              0.1978                0.1086\n18  Lawrence County    1998             10.3976                1.1154              0.1978                0.1010\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"SS\" AS \"SS3\" CROSS JOIN \"WS\" AS \"WS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*             ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0       Addison County    1998             11.7431                0.9333              0.0851                2.3225\n1       Addison County    1998             11.7431                0.9183              0.0851                2.3603\n2       Addison County    1998             11.7431                1.1110              0.0851                1.9511\n3       Addison County    1998             11.7431                0.8567              0.0851                2.5300\n4       Addison County    1998             11.7431                0.9511              0.0851                2.2790\n5   Sweet Grass County    1998             11.7431                0.6361              0.0851                3.5027\n6   Sweet Grass County    1998             11.7431                0.8498              0.0851                2.6221\n7   Sweet Grass County    1998             11.7431                0.7628              0.0851                2.9211\n8   Sweet Grass County    1998             11.7431                0.4989              0.0851                4.4660\n9   Sweet Grass County    1998             11.7431                0.8523              0.0851                2.6143\n10       Gilmer County    1998             11.7431                0.8287              0.0851                1.1832\n11       Gilmer County    1998             11.7431                0.7030              0.0851                1.3947\n12       Gilmer County    1998             11.7431                0.5258              0.0851                1.8646\n13       Gilmer County    1998             11.7431                0.7381              0.0851                1.3284\n14       Gilmer County    1998             11.7431                0.5910              0.0851                1.6589\n15     Franklin County    1998             11.7431                1.1550              0.0851                0.1164\n16     Franklin County    1998             11.7431                1.1747              0.0851                0.1145\n17     Franklin County    1998             11.7431                1.2036              0.0851                0.1117\n18     Franklin County    1998             11.7431                1.1158              0.0851                0.1205\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.073729,
                    "execution_time": 0.048282,
                    "compile_time": 0.000287,
                    "planning_time": 0.011805
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.35593,
                    "execution_time": 0.279709,
                    "compile_time": 0.000311,
                    "planning_time": 0.048345
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*             ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0       Addison County    1998             11.7431                0.9333              0.0851                2.3225\n1       Addison County    1998             11.7431                0.9183              0.0851                2.3603\n2       Addison County    1998             11.7431                1.1110              0.0851                1.9511\n3       Addison County    1998             11.7431                0.8567              0.0851                2.5300\n4       Addison County    1998             11.7431                0.9511              0.0851                2.2790\n5   Sweet Grass County    1998             11.7431                0.6361              0.0851                3.5027\n6   Sweet Grass County    1998             11.7431                0.8498              0.0851                2.6221\n7   Sweet Grass County    1998             11.7431                0.7628              0.0851                2.9211\n8   Sweet Grass County    1998             11.7431                0.4989              0.0851                4.4660\n9   Sweet Grass County    1998             11.7431                0.8523              0.0851                2.6143\n10       Gilmer County    1998             11.7431                0.8287              0.0851                1.1832\n11       Gilmer County    1998             11.7431                0.7030              0.0851                1.3947\n12       Gilmer County    1998             11.7431                0.5258              0.0851                1.8646\n13       Gilmer County    1998             11.7431                0.7381              0.0851                1.3284\n14       Gilmer County    1998             11.7431                0.5910              0.0851                1.6589\n15     Franklin County    1998             11.7431                1.1550              0.0851                0.1164\n16     Franklin County    1998             11.7431                1.1747              0.0851                0.1145\n17     Franklin County    1998             11.7431                1.2036              0.0851                0.1117\n18     Franklin County    1998             11.7431                1.1158              0.0851                0.1205\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"SS\" AS \"SS3\" CROSS JOIN \"WS\" AS \"WS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*             ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0         Latah County    1998                 1.0                1.0205              4.6638                0.5900\n1        Racine County    1998                 1.0                0.8660              4.6638                1.3204\n2         Stone County    1998                 1.0                1.4884              4.6638                0.2532\n3       Burnett County    1998                 1.0                1.9979              4.6638                0.5564\n4         Lucas County    1998                 1.0                1.0583              4.6638                0.3728\n5      Cheyenne County    1998                 1.0                1.0586              4.6638                0.2580\n6   Manassas Park city    1998                 1.0                1.0844              4.6638                0.7499\n7          Hyde County    1998                 1.0                0.6759              4.6638                0.5590\n8         Kiowa County    1998                 1.0                0.8814              4.6638                0.2793\n9     Granville County    1998                 1.0                0.6582              4.6638                0.5808\n10    Allegheny County    1998                 1.0                1.6472              4.6638                0.5818\n11     Atascosa County    1998                 1.0                0.8856              4.6638                0.6714\n12     Richland Parish    1998                 1.0                1.1204              4.6638                0.6417\n13   Pennington County    1998                 1.0                1.0253              4.6638                0.3605\n14        Ozark County    1998                 1.0                1.2653              4.6638                1.0797\n15     Buncombe County    1998                 1.0                2.0770              4.6638                0.5688\n16    Lafayette County    1998                 1.0                1.1478              4.6638                0.1617\n17    Ascension Parish    1998                 1.0                1.3435              4.6638                0.5729\n18       Oceana County    1998                 1.0                1.0939              4.6638                0.7857\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.075285,
                    "execution_time": 0.048412,
                    "compile_time": 0.000287,
                    "planning_time": 0.012836
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.114428,
                    "execution_time": 0.047347,
                    "compile_time": 0.001232,
                    "planning_time": 0.04935
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*             ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0         Latah County    1998                 1.0                1.0205              4.6638                0.5900\n1        Racine County    1998                 1.0                0.8660              4.6638                1.3204\n2         Stone County    1998                 1.0                1.4884              4.6638                0.2532\n3       Burnett County    1998                 1.0                1.9979              4.6638                0.5564\n4         Lucas County    1998                 1.0                1.0583              4.6638                0.3728\n5      Cheyenne County    1998                 1.0                1.0586              4.6638                0.2580\n6   Manassas Park city    1998                 1.0                1.0844              4.6638                0.7499\n7          Hyde County    1998                 1.0                0.6759              4.6638                0.5590\n8         Kiowa County    1998                 1.0                0.8814              4.6638                0.2793\n9     Granville County    1998                 1.0                0.6582              4.6638                0.5808\n10    Allegheny County    1998                 1.0                1.6472              4.6638                0.5818\n11     Atascosa County    1998                 1.0                0.8856              4.6638                0.6714\n12     Richland Parish    1998                 1.0                1.1204              4.6638                0.6417\n13   Pennington County    1998                 1.0                1.0253              4.6638                0.3605\n14        Ozark County    1998                 1.0                1.2653              4.6638                1.0797\n15     Buncombe County    1998                 1.0                2.0770              4.6638                0.5688\n16    Lafayette County    1998                 1.0                1.1478              4.6638                0.1617\n17    Ascension Parish    1998                 1.0                1.3435              4.6638                0.5729\n18       Oceana County    1998                 1.0                1.0939              4.6638                0.7857\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*            ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Beauregard Parish    1998             11.7431                1.0844              0.3971                0.7415\n1   Beauregard Parish    1998             11.7431                1.0844              0.3971                0.9718\n2   Beauregard Parish    1998             11.7431                1.0844              0.3971                0.8314\n3   Beauregard Parish    1998             11.7431                1.0844              0.3971                0.8524\n4   Beauregard Parish    1998             11.7431                1.0844              0.3971                0.1717\n5   Beauregard Parish    1998             11.7431                1.0844              0.3971                2.7012\n6   Beauregard Parish    1998             11.7431                1.0844              0.3971                2.7273\n7   Beauregard Parish    1998             11.7431                1.0844              0.3971                2.6708\n8   Beauregard Parish    1998             11.7431                1.0844              0.3971                0.8819\n9   Beauregard Parish    1998             11.7431                1.0844              0.3971                0.9736\n10  Beauregard Parish    1998             11.7431                1.0844              0.3971                1.0254\n11  Beauregard Parish    1998             11.7431                1.0844              0.3971                1.0860\n12  Beauregard Parish    1998             11.7431                1.0844              0.3971                0.6302\n13  Beauregard Parish    1998             11.7431                1.0844              0.3971                1.1001\n14  Beauregard Parish    1998             11.7431                1.0844              0.3971                0.9221\n15  Beauregard Parish    1998             11.7431                1.0844              0.3971                2.6161\n16  Beauregard Parish    1998             11.7431                1.0844              0.3971                0.8855\n17  Beauregard Parish    1998             11.7431                1.0844              0.3971                1.3482\n18  Beauregard Parish    1998             11.7431                1.0844              0.3971                2.5872\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.075935,
                    "execution_time": 0.048429,
                    "compile_time": 0.000291,
                    "planning_time": 0.013078
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.11732,
                    "execution_time": 0.048677,
                    "compile_time": 0.000342,
                    "planning_time": 0.050843
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*            ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Beauregard Parish    1998             11.7431                1.0844              0.3971                0.7415\n1   Beauregard Parish    1998             11.7431                1.0844              0.3971                0.9718\n2   Beauregard Parish    1998             11.7431                1.0844              0.3971                0.8314\n3   Beauregard Parish    1998             11.7431                1.0844              0.3971                0.8524\n4   Beauregard Parish    1998             11.7431                1.0844              0.3971                0.1717\n5   Beauregard Parish    1998             11.7431                1.0844              0.3971                2.7012\n6   Beauregard Parish    1998             11.7431                1.0844              0.3971                2.7273\n7   Beauregard Parish    1998             11.7431                1.0844              0.3971                2.6708\n8   Beauregard Parish    1998             11.7431                1.0844              0.3971                0.8819\n9   Beauregard Parish    1998             11.7431                1.0844              0.3971                0.9736\n10  Beauregard Parish    1998             11.7431                1.0844              0.3971                1.0254\n11  Beauregard Parish    1998             11.7431                1.0844              0.3971                1.0860\n12  Beauregard Parish    1998             11.7431                1.0844              0.3971                0.6302\n13  Beauregard Parish    1998             11.7431                1.0844              0.3971                1.1001\n14  Beauregard Parish    1998             11.7431                1.0844              0.3971                0.9221\n15  Beauregard Parish    1998             11.7431                1.0844              0.3971                2.6161\n16  Beauregard Parish    1998             11.7431                1.0844              0.3971                0.8855\n17  Beauregard Parish    1998             11.7431                1.0844              0.3971                1.3482\n18  Beauregard Parish    1998             11.7431                1.0844              0.3971                2.5872\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*          ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0    Chester County    1998                 1.0                0.8322              0.0851                2.0503\n1    Chester County    1998                 1.0                0.8322              0.0851                1.9385\n2    Chester County    1998                 1.0                0.8322              0.0851                2.1850\n3    Chester County    1998                 1.0                0.8322              0.0851                2.3657\n4    Chester County    1998                 1.0                0.8322              0.0851                2.0173\n5   Chenango County    1998                 1.0                1.6075              0.0851                1.4375\n6   Chenango County    1998                 1.0                1.6075              0.0851                1.1392\n7   Chenango County    1998                 1.0                1.6075              0.0851                0.9642\n8   Chenango County    1998                 1.0                1.6075              0.0851                1.2542\n9   Chenango County    1998                 1.0                1.6075              0.0851                1.3761\n10      Pima County    1998                 1.0                0.6943              0.0851                2.8706\n11      Pima County    1998                 1.0                0.6943              0.0851                2.8232\n12      Pima County    1998                 1.0                0.6943              0.0851                1.8205\n13      Pima County    1998                 1.0                0.6943              0.0851                2.2741\n14      Pima County    1998                 1.0                0.6943              0.0851                2.9862\n15     Macon County    1998                 1.0                1.2585              0.0851                1.8376\n16     Macon County    1998                 1.0                1.2585              0.0851                1.9036\n17     Macon County    1998                 1.0                1.2585              0.0851                1.9004\n18     Macon County    1998                 1.0                1.2585              0.0851                1.8046\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.07832,
                    "execution_time": 0.04906,
                    "compile_time": 0.000317,
                    "planning_time": 0.013884
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.115115,
                    "execution_time": 0.04815,
                    "compile_time": 0.00033,
                    "planning_time": 0.050085
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*          ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0    Chester County    1998                 1.0                0.8322              0.0851                2.0503\n1    Chester County    1998                 1.0                0.8322              0.0851                1.9385\n2    Chester County    1998                 1.0                0.8322              0.0851                2.1850\n3    Chester County    1998                 1.0                0.8322              0.0851                2.3657\n4    Chester County    1998                 1.0                0.8322              0.0851                2.0173\n5   Chenango County    1998                 1.0                1.6075              0.0851                1.4375\n6   Chenango County    1998                 1.0                1.6075              0.0851                1.1392\n7   Chenango County    1998                 1.0                1.6075              0.0851                0.9642\n8   Chenango County    1998                 1.0                1.6075              0.0851                1.2542\n9   Chenango County    1998                 1.0                1.6075              0.0851                1.3761\n10      Pima County    1998                 1.0                0.6943              0.0851                2.8706\n11      Pima County    1998                 1.0                0.6943              0.0851                2.8232\n12      Pima County    1998                 1.0                0.6943              0.0851                1.8205\n13      Pima County    1998                 1.0                0.6943              0.0851                2.2741\n14      Pima County    1998                 1.0                0.6943              0.0851                2.9862\n15     Macon County    1998                 1.0                1.2585              0.0851                1.8376\n16     Macon County    1998                 1.0                1.2585              0.0851                1.9036\n17     Macon County    1998                 1.0                1.2585              0.0851                1.9004\n18     Macon County    1998                 1.0                1.2585              0.0851                1.8046\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*                    ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0              Douglas County    1998              0.0851                1.0555                 1.0                1.8533\n1              Jackson County    1998              0.0851                1.1303                 1.0                1.7010\n2              Socorro County    1998              0.0851                2.1232                 1.0                1.5442\n3               Cibola County    1998              0.0851                2.2188                 1.0                1.5208\n4               Jasper County    1998              0.0851                1.2189                 1.0                1.7580\n5             Rockdale County    1998              0.0851                1.0950                 1.0                1.3218\n6                Union County    1998              0.0851                1.0632                 1.0                2.0065\n7               Custer County    1998              0.0851                1.1311                 1.0                1.6774\n8               Winona County    1998              0.0851                1.5896                 1.0                1.5086\n9            Jefferson County    1998              0.0851                1.0105                 1.0                1.8587\n10               Cooke County    1998              0.0851                1.6563                 1.0                1.7327\n11               Perry County    1998              0.0851                1.2557                 1.0                1.5279\n12              Moffat County    1998              0.0851                0.5684                 1.0                2.6861\n13             Laramie County    1998              0.0851                1.3352                 1.0                1.3712\n14  Matanuska-Susitna Borough    1998              0.0851                1.2352                 1.0                1.1048\n15           Limestone County    1998              0.0851                0.9112                 1.0                1.9025\n16              Searcy County    1998              0.0851                0.7034                 1.0                1.4902\n17             Chatham County    1998              0.0851                1.3576                 1.0                1.6193\n18               Moore County    1998              0.0851                0.6807                 1.0                1.9743\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.07848,
                    "execution_time": 0.048671,
                    "compile_time": 0.000319,
                    "planning_time": 0.014459
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.118304,
                    "execution_time": 0.04816,
                    "compile_time": 0.000311,
                    "planning_time": 0.050942
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*                    ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0              Douglas County    1998              0.0851                1.0555                 1.0                1.8533\n1              Jackson County    1998              0.0851                1.1303                 1.0                1.7010\n2              Socorro County    1998              0.0851                2.1232                 1.0                1.5442\n3               Cibola County    1998              0.0851                2.2188                 1.0                1.5208\n4               Jasper County    1998              0.0851                1.2189                 1.0                1.7580\n5             Rockdale County    1998              0.0851                1.0950                 1.0                1.3218\n6                Union County    1998              0.0851                1.0632                 1.0                2.0065\n7               Custer County    1998              0.0851                1.1311                 1.0                1.6774\n8               Winona County    1998              0.0851                1.5896                 1.0                1.5086\n9            Jefferson County    1998              0.0851                1.0105                 1.0                1.8587\n10               Cooke County    1998              0.0851                1.6563                 1.0                1.7327\n11               Perry County    1998              0.0851                1.2557                 1.0                1.5279\n12              Moffat County    1998              0.0851                0.5684                 1.0                2.6861\n13             Laramie County    1998              0.0851                1.3352                 1.0                1.3712\n14  Matanuska-Susitna Borough    1998              0.0851                1.2352                 1.0                1.1048\n15           Limestone County    1998              0.0851                0.9112                 1.0                1.9025\n16              Searcy County    1998              0.0851                0.7034                 1.0                1.4902\n17             Chatham County    1998              0.0851                1.3576                 1.0                1.6193\n18               Moore County    1998              0.0851                0.6807                 1.0                1.9743\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.212245,
                    "execution_time": 0.114477,
                    "compile_time": 0.000399,
                    "planning_time": 0.032824,
                    "create_size": 240
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.503363,
                    "execution_time": 0.24758,
                    "compile_time": 0.091441,
                    "planning_time": 0.095069,
                    "create_size": 240
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*         ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Madison County    1998              0.8782                0.9804                 1.0                1.8572\n1   Madison County    1998              0.8600                0.9804                 1.0                1.8572\n2   Madison County    1998              0.2165                0.9804                 1.0                1.8572\n3   Madison County    1998              0.4166                0.9804                 1.0                1.8572\n4   Madison County    1998              0.7342                0.9804                 1.0                1.8572\n5   Madison County    1998              0.6363                0.9804                 1.0                1.8572\n6   Madison County    1998             16.3717                0.9804                 1.0                1.8572\n7   Madison County    1998              0.2540                0.9804                 1.0                1.8572\n8   Madison County    1998              0.6650                0.9804                 1.0                1.8572\n9   Madison County    1998              0.4208                0.9804                 1.0                1.8572\n10  Madison County    1998              1.1680                0.9804                 1.0                1.8572\n11  Madison County    1998              0.2395                0.9804                 1.0                1.8572\n12  Madison County    1998              0.4908                0.9804                 1.0                1.8572\n13  Madison County    1998              0.2570                0.9804                 1.0                1.8572\n14  Madison County    1998              0.4134                0.9804                 1.0                1.8572\n15  Madison County    1998              0.7360                0.9804                 1.0                1.8572\n16  Madison County    1998              0.8017                0.9804                 1.0                1.8572\n17  Madison County    1998              0.6989                0.9804                 1.0                1.8572\n18  Madison County    1998              0.3980                0.9804                 1.0                1.8572\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.081005,
                    "execution_time": 0.049109,
                    "compile_time": 0.000331,
                    "planning_time": 0.015747
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.121007,
                    "execution_time": 0.04984,
                    "compile_time": 0.000335,
                    "planning_time": 0.051926
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*         ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Madison County    1998              0.8782                0.9804                 1.0                1.8572\n1   Madison County    1998              0.8600                0.9804                 1.0                1.8572\n2   Madison County    1998              0.2165                0.9804                 1.0                1.8572\n3   Madison County    1998              0.4166                0.9804                 1.0                1.8572\n4   Madison County    1998              0.7342                0.9804                 1.0                1.8572\n5   Madison County    1998              0.6363                0.9804                 1.0                1.8572\n6   Madison County    1998             16.3717                0.9804                 1.0                1.8572\n7   Madison County    1998              0.2540                0.9804                 1.0                1.8572\n8   Madison County    1998              0.6650                0.9804                 1.0                1.8572\n9   Madison County    1998              0.4208                0.9804                 1.0                1.8572\n10  Madison County    1998              1.1680                0.9804                 1.0                1.8572\n11  Madison County    1998              0.2395                0.9804                 1.0                1.8572\n12  Madison County    1998              0.4908                0.9804                 1.0                1.8572\n13  Madison County    1998              0.2570                0.9804                 1.0                1.8572\n14  Madison County    1998              0.4134                0.9804                 1.0                1.8572\n15  Madison County    1998              0.7360                0.9804                 1.0                1.8572\n16  Madison County    1998              0.8017                0.9804                 1.0                1.8572\n17  Madison County    1998              0.6989                0.9804                 1.0                1.8572\n18  Madison County    1998              0.3980                0.9804                 1.0                1.8572\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.211939,
                    "execution_time": 0.110652,
                    "compile_time": 0.000422,
                    "planning_time": 0.03065,
                    "create_size": 288
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.283798,
                    "execution_time": 0.114734,
                    "compile_time": 0.000418,
                    "planning_time": 0.094907,
                    "create_size": 288
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*          ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0    Madison County    1998              0.0606                0.9804              0.0863                1.8572\n1    Madison County    1998              1.5612                0.9804              0.0863                1.8572\n2    Madison County    1998              0.0764                0.9804              0.0863                1.8572\n3    Madison County    1998              0.1113                0.9804              0.0863                1.8572\n4    Madison County    1998              0.0634                0.9804              0.0863                1.8572\n5    Madison County    1998              0.0837                0.9804              0.0863                1.8572\n6     Clarke County    1998              0.2671                0.9514              0.0863                1.8150\n7     Clarke County    1998              0.3534                0.9514              0.0863                1.8150\n8     Clarke County    1998              2.3376                0.9514              0.0863                1.8150\n9     Clarke County    1998              0.2732                0.9514              0.0863                1.8150\n10    Clarke County    1998              0.3964                0.9514              0.0863                1.8150\n11    Clarke County    1998              0.3631                0.9514              0.0863                1.8150\n12  Woodford County    1998              1.2568                0.8144              0.0863                1.8451\n13  Woodford County    1998              0.9260                0.8144              0.0863                1.8451\n14  Woodford County    1998              0.5857                0.8144              0.0863                1.8451\n15  Woodford County    1998              2.0337                0.8144              0.0863                1.8451\n16  Woodford County    1998              0.6175                0.8144              0.0863                1.8451\n17    Brooke County    1998              1.3120                1.0770              0.0863                1.4028\n18    Brooke County    1998              1.4347                1.0770              0.0863                1.4028\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.083235,
                    "execution_time": 0.050354,
                    "compile_time": 0.000345,
                    "planning_time": 0.016659
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.120524,
                    "execution_time": 0.049069,
                    "compile_time": 0.000376,
                    "planning_time": 0.053272
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*          ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0    Madison County    1998              0.0606                0.9804              0.0863                1.8572\n1    Madison County    1998              1.5612                0.9804              0.0863                1.8572\n2    Madison County    1998              0.0764                0.9804              0.0863                1.8572\n3    Madison County    1998              0.1113                0.9804              0.0863                1.8572\n4    Madison County    1998              0.0634                0.9804              0.0863                1.8572\n5    Madison County    1998              0.0837                0.9804              0.0863                1.8572\n6     Clarke County    1998              0.2671                0.9514              0.0863                1.8150\n7     Clarke County    1998              0.3534                0.9514              0.0863                1.8150\n8     Clarke County    1998              2.3376                0.9514              0.0863                1.8150\n9     Clarke County    1998              0.2732                0.9514              0.0863                1.8150\n10    Clarke County    1998              0.3964                0.9514              0.0863                1.8150\n11    Clarke County    1998              0.3631                0.9514              0.0863                1.8150\n12  Woodford County    1998              1.2568                0.8144              0.0863                1.8451\n13  Woodford County    1998              0.9260                0.8144              0.0863                1.8451\n14  Woodford County    1998              0.5857                0.8144              0.0863                1.8451\n15  Woodford County    1998              2.0337                0.8144              0.0863                1.8451\n16  Woodford County    1998              0.6175                0.8144              0.0863                1.8451\n17    Brooke County    1998              1.3120                1.0770              0.0863                1.4028\n18    Brooke County    1998              1.4347                1.0770              0.0863                1.4028\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS2\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.219486,
                    "execution_time": 0.112941,
                    "compile_time": 0.000408,
                    "planning_time": 0.030229,
                    "create_size": 336
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.286724,
                    "execution_time": 0.113227,
                    "compile_time": 0.000439,
                    "planning_time": 0.09575,
                    "create_size": 336
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*            ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0      Merrick County    1998              5.8442                1.0058                 1.0                2.1942\n1   Twin Falls County    1998              4.7360                1.6630                 1.0                1.4773\n2     Muskegon County    1998              5.9759                0.7138                 1.0                1.7604\n3        Radford city    1998              8.6909                0.5176                 1.0                2.5735\n4       Wilkes County    1998              2.0687                1.3178                 1.0                1.4335\n5     Pershing County    1998              7.6359                1.1216                 1.0                1.9532\n6       Gilmer County    1998              4.1299                0.5910                 1.0                1.6288\n7        Boise County    1998              5.2564                0.7477                 1.0                1.9148\n8     Mahoning County    1998              7.2475                1.5462                 1.0                1.2083\n9        Grand County    1998              2.3352                1.3659                 1.0                1.9433\n10       Llano County    1998              7.4105                1.0160                 1.0                1.5384\n11   Champaign County    1998              5.9802                1.0584                 1.0                1.8295\n12      Seward County    1998              4.6161                1.8945                 1.0                1.4198\n13        Jack County    1998             13.0676                0.9203                 1.0                1.3372\n14       Troup County    1998              6.5421                0.8104                 1.0                1.8285\n15    New Kent County    1998              7.1012                1.5691                 1.0                1.2098\n16        Carson City    1998              3.0803                1.0314                 1.0                1.8190\n17       Noble County    1998              2.2352                1.1985                 1.0                1.6289\n18     Sherman County    1998              1.2758                0.8538                 1.0                1.7325\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.178958,
                    "execution_time": 0.049671,
                    "compile_time": 0.101135,
                    "planning_time": 0.018112
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.266992,
                    "execution_time": 0.050855,
                    "compile_time": 6.144603,
                    "planning_time": 0.054977
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*            ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0      Merrick County    1998              5.8442                1.0058                 1.0                2.1942\n1   Twin Falls County    1998              4.7360                1.6630                 1.0                1.4773\n2     Muskegon County    1998              5.9759                0.7138                 1.0                1.7604\n3        Radford city    1998              8.6909                0.5176                 1.0                2.5735\n4       Wilkes County    1998              2.0687                1.3178                 1.0                1.4335\n5     Pershing County    1998              7.6359                1.1216                 1.0                1.9532\n6       Gilmer County    1998              4.1299                0.5910                 1.0                1.6288\n7        Boise County    1998              5.2564                0.7477                 1.0                1.9148\n8     Mahoning County    1998              7.2475                1.5462                 1.0                1.2083\n9        Grand County    1998              2.3352                1.3659                 1.0                1.9433\n10       Llano County    1998              7.4105                1.0160                 1.0                1.5384\n11   Champaign County    1998              5.9802                1.0584                 1.0                1.8295\n12      Seward County    1998              4.6161                1.8945                 1.0                1.4198\n13        Jack County    1998             13.0676                0.9203                 1.0                1.3372\n14       Troup County    1998              6.5421                0.8104                 1.0                1.8285\n15    New Kent County    1998              7.1012                1.5691                 1.0                1.2098\n16        Carson City    1998              3.0803                1.0314                 1.0                1.8190\n17       Noble County    1998              2.2352                1.1985                 1.0                1.6289\n18     Sherman County    1998              1.2758                0.8538                 1.0                1.7325\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*           ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Brookings County    1998              1.0286                0.7638              0.5494                 2.619\n1   Brookings County    1998              1.0286                0.7638              1.6292                 2.619\n2   Brookings County    1998              1.0286                0.7638              0.8202                 2.619\n3   Brookings County    1998              1.0286                0.7638              0.9437                 2.619\n4   Brookings County    1998              1.0286                0.7638              3.7654                 2.619\n5   Brookings County    1998              1.0286                0.7638              5.2218                 2.619\n6   Brookings County    1998              1.0286                0.7638              4.2784                 2.619\n7   Brookings County    1998              1.0286                0.7638              1.4451                 2.619\n8   Brookings County    1998              1.0286                0.7638              1.5339                 2.619\n9   Brookings County    1998              1.0286                0.7638              1.9104                 2.619\n10  Brookings County    1998              1.0286                0.7638              8.1115                 2.619\n11  Brookings County    1998              1.0286                0.7638              0.7646                 2.619\n12  Brookings County    1998              1.0286                0.7638              1.4710                 2.619\n13  Brookings County    1998              1.0286                0.7638              2.3166                 2.619\n14  Brookings County    1998              1.0286                0.7638              1.1812                 2.619\n15  Brookings County    1998              1.0286                0.7638              1.0402                 2.619\n16  Brookings County    1998              1.0286                0.7638              1.7753                 2.619\n17  Brookings County    1998              1.0286                0.7638              3.9437                 2.619\n18  Brookings County    1998              1.0286                0.7638             18.6726                 2.619\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.098948,
                    "execution_time": 0.059181,
                    "compile_time": 0.000501,
                    "planning_time": 0.018825
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.140325,
                    "execution_time": 0.059371,
                    "compile_time": 0.000516,
                    "planning_time": 0.056694
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*           ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Brookings County    1998              1.0286                0.7638              0.5494                 2.619\n1   Brookings County    1998              1.0286                0.7638              1.6292                 2.619\n2   Brookings County    1998              1.0286                0.7638              0.8202                 2.619\n3   Brookings County    1998              1.0286                0.7638              0.9437                 2.619\n4   Brookings County    1998              1.0286                0.7638              3.7654                 2.619\n5   Brookings County    1998              1.0286                0.7638              5.2218                 2.619\n6   Brookings County    1998              1.0286                0.7638              4.2784                 2.619\n7   Brookings County    1998              1.0286                0.7638              1.4451                 2.619\n8   Brookings County    1998              1.0286                0.7638              1.5339                 2.619\n9   Brookings County    1998              1.0286                0.7638              1.9104                 2.619\n10  Brookings County    1998              1.0286                0.7638              8.1115                 2.619\n11  Brookings County    1998              1.0286                0.7638              0.7646                 2.619\n12  Brookings County    1998              1.0286                0.7638              1.4710                 2.619\n13  Brookings County    1998              1.0286                0.7638              2.3166                 2.619\n14  Brookings County    1998              1.0286                0.7638              1.1812                 2.619\n15  Brookings County    1998              1.0286                0.7638              1.0402                 2.619\n16  Brookings County    1998              1.0286                0.7638              1.7753                 2.619\n17  Brookings County    1998              1.0286                0.7638              3.9437                 2.619\n18  Brookings County    1998              1.0286                0.7638             18.6726                 2.619\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 LIMIT 21",
                "preview": "\n/*        ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Cayuga County    1998              0.6369                0.8069              1.5870                2.4623\n1   Cayuga County    1998              0.6369                0.8069              1.0967                2.4623\n2   Cayuga County    1998              0.6369                0.8069              7.9551                2.4623\n3   Cayuga County    1998              0.6369                0.8069              1.2517                2.4623\n4   Cayuga County    1998              0.6369                0.8069              3.6885                2.4623\n5   Cayuga County    1998              0.6369                0.8069              1.9003                2.4623\n6   Cayuga County    1998              0.6369                0.8069              1.1652                2.4623\n7   Cayuga County    1998              0.6369                0.8069              9.8249                2.4623\n8   Cayuga County    1998              0.6369                0.8069              1.1927                2.4623\n9   Cayuga County    1998              0.6369                0.8069              1.8753                2.4623\n10  Cayuga County    1998              0.6369                0.8069              0.5323                2.4623\n11  Cayuga County    1998              0.6369                0.8069              0.8781                2.4623\n12  Cayuga County    1998              0.6369                0.8069              2.1939                2.4623\n13  Cayuga County    1998              0.6369                0.8069             14.5906                2.4623\n14  Cayuga County    1998              0.6369                0.8069              2.9178                2.4623\n15  Cayuga County    1998              0.6369                0.8069              2.7650                2.4623\n16  Cayuga County    1998              0.6369                0.8069             10.6323                2.4623\n17  Cayuga County    1998              0.6369                0.8069              0.9420                2.4623\n18  Cayuga County    1998              0.6369                0.8069              2.7260                2.4623\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.095346,
                    "execution_time": 0.056049,
                    "compile_time": 0.000468,
                    "planning_time": 0.019571
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.492159,
                    "execution_time": 0.058407,
                    "compile_time": 3.352576,
                    "planning_time": 0.056717
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
            }
        ],
        "preview": "\n/*        ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Cayuga County    1998              0.6369                0.8069              1.5870                2.4623\n1   Cayuga County    1998              0.6369                0.8069              1.0967                2.4623\n2   Cayuga County    1998              0.6369                0.8069              7.9551                2.4623\n3   Cayuga County    1998              0.6369                0.8069              1.2517                2.4623\n4   Cayuga County    1998              0.6369                0.8069              3.6885                2.4623\n5   Cayuga County    1998              0.6369                0.8069              1.9003                2.4623\n6   Cayuga County    1998              0.6369                0.8069              1.1652                2.4623\n7   Cayuga County    1998              0.6369                0.8069              9.8249                2.4623\n8   Cayuga County    1998              0.6369                0.8069              1.1927                2.4623\n9   Cayuga County    1998              0.6369                0.8069              1.8753                2.4623\n10  Cayuga County    1998              0.6369                0.8069              0.5323                2.4623\n11  Cayuga County    1998              0.6369                0.8069              0.8781                2.4623\n12  Cayuga County    1998              0.6369                0.8069              2.1939                2.4623\n13  Cayuga County    1998              0.6369                0.8069             14.5906                2.4623\n14  Cayuga County    1998              0.6369                0.8069              2.9178                2.4623\n15  Cayuga County    1998              0.6369                0.8069              2.7650                2.4623\n16  Cayuga County    1998              0.6369                0.8069             10.6323                2.4623\n17  Cayuga County    1998              0.6369                0.8069              0.9420                2.4623\n18  Cayuga County    1998              0.6369                0.8069              2.7260                2.4623\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" CROSS JOIN \"WS\" AS \"WS3\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.460661,
                    "execution_time": 3.779023,
                    "compile_time": 0.000827,
                    "planning_time": 0.021349,
                    "create_size": 6657
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.594369,
                    "execution_time": 3.830189,
                    "compile_time": 0.003422,
                    "planning_time": 0.080426,
                    "create_size": 6657
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_8\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*                ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0           Fisher County    1998              1.7509                1.4830              4.2767                1.9561\n1          Lynchburg city    1998              0.8878                1.2641              3.4739                1.8793\n2     East Carroll Parish    1998              0.4921                1.6912             11.0145                0.9379\n3             Kane County    1998              0.5222                0.8415              4.4235                1.8949\n4         Iroquois County    1998              0.6640                1.2506              7.1649                1.1203\n5             Will County    1998              1.1650                0.5122              9.5121                3.3576\n6            Miner County    1998              1.3956                1.1065              7.9958                1.5676\n7           Coweta County    1998              1.1431                1.3819              4.2652                1.3868\n8          Chilton County    1998              2.1690                1.2500              4.9618                1.6578\n9           Becker County    1998              0.9523                1.0454              7.3584                2.1554\n10          Cannon County    1998              0.6412                1.1351             14.6808                1.1646\n11          Mobile County    1998              2.2354                0.8484              4.1528                2.9060\n12  San Bernardino County    1998              0.8015                0.6199              6.3997                2.1606\n13        Thurston County    1998              0.6876                1.0412              4.7932                1.7053\n14        Comanche County    1998              1.8643                0.9059              1.6016                1.4354\n15      Meriwether County    1998              1.7031                0.8495              3.0488                1.6264\n16           Moody County    1998              0.6966                1.2591             12.5569                1.6498\n17           Bristol city    1998              1.3589                1.5969              6.7635                1.4182\n18           Jones County    1998              0.8749                1.0904              1.3182                1.8811\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018346,
                    "execution_time": 0.008088,
                    "compile_time": 5e-05,
                    "planning_time": 0.003911
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057381,
                    "execution_time": 0.008652,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039489
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_8\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_8\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*                ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0           Fisher County    1998              1.7509                1.4830              4.2767                1.9561\n1          Lynchburg city    1998              0.8878                1.2641              3.4739                1.8793\n2     East Carroll Parish    1998              0.4921                1.6912             11.0145                0.9379\n3             Kane County    1998              0.5222                0.8415              4.4235                1.8949\n4         Iroquois County    1998              0.6640                1.2506              7.1649                1.1203\n5             Will County    1998              1.1650                0.5122              9.5121                3.3576\n6            Miner County    1998              1.3956                1.1065              7.9958                1.5676\n7           Coweta County    1998              1.1431                1.3819              4.2652                1.3868\n8          Chilton County    1998              2.1690                1.2500              4.9618                1.6578\n9           Becker County    1998              0.9523                1.0454              7.3584                2.1554\n10          Cannon County    1998              0.6412                1.1351             14.6808                1.1646\n11          Mobile County    1998              2.2354                0.8484              4.1528                2.9060\n12  San Bernardino County    1998              0.8015                0.6199              6.3997                2.1606\n13        Thurston County    1998              0.6876                1.0412              4.7932                1.7053\n14        Comanche County    1998              1.8643                0.9059              1.6016                1.4354\n15      Meriwether County    1998              1.7031                0.8495              3.0488                1.6264\n16           Moody County    1998              0.6966                1.2591             12.5569                1.6498\n17           Bristol city    1998              1.3589                1.5969              6.7635                1.4182\n18           Jones County    1998              0.8749                1.0904              1.3182                1.8811\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.254456,
                    "execution_time": 0.093978,
                    "compile_time": 0.00061,
                    "planning_time": 0.027689,
                    "create_size": 450
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.785818,
                    "execution_time": 0.096267,
                    "compile_time": 7.472795,
                    "planning_time": 0.086239,
                    "create_size": 468
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*             ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0          Hall County    1998              1.0163                0.7069              0.9839                2.3929\n1        Traill County    1998             11.1069                0.6811              0.0900                2.4030\n2       Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n3       Hidalgo County    1998              1.1419                1.4703              0.8757                1.3101\n4        Catron County    1998              0.4543                0.8517              2.2009                2.2656\n5     McCulloch County    1998              0.8691                0.8421              1.1505                1.8385\n6        Apache County    1998              0.4296                0.8224              2.3272                2.5215\n7       Wasatch County    1998              2.1114                0.7590              0.4736                2.2202\n8       Bandera County    1998              0.6923                1.1876              1.4443                2.0395\n9       Whitman County    1998              0.6291                1.2072              1.5894                1.7613\n10       Sierra County    1998              0.5773                1.0271              1.7319                1.8948\n11  Westchester County    1998              2.7400                1.2627              1.0000                2.5699\n12      Elliott County    1998              1.0280                0.5808              1.0000                1.9384\n13       Aurora County    1998              1.3554                2.5768              1.0000                1.8082\n14      Forsyth County    1998              2.0961                1.0618              1.0000                1.6064\n15    Van Buren County    1998              0.9098                1.1521              1.0000                1.6106\n16      Alfalfa County    1998              2.2270                1.5233              1.0000                1.8465\n17      Hopkins County    1998              2.3415                0.9639              1.0000                2.4037\n18        Green County    1998              0.6251                1.3125              1.0000                1.9741\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017872,
                    "execution_time": 0.007627,
                    "compile_time": 5e-05,
                    "planning_time": 0.003934
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054862,
                    "execution_time": 0.007492,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039516
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*             ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0          Hall County    1998              1.0163                0.7069              0.9839                2.3929\n1        Traill County    1998             11.1069                0.6811              0.0900                2.4030\n2       Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n3       Hidalgo County    1998              1.1419                1.4703              0.8757                1.3101\n4        Catron County    1998              0.4543                0.8517              2.2009                2.2656\n5     McCulloch County    1998              0.8691                0.8421              1.1505                1.8385\n6        Apache County    1998              0.4296                0.8224              2.3272                2.5215\n7       Wasatch County    1998              2.1114                0.7590              0.4736                2.2202\n8       Bandera County    1998              0.6923                1.1876              1.4443                2.0395\n9       Whitman County    1998              0.6291                1.2072              1.5894                1.7613\n10       Sierra County    1998              0.5773                1.0271              1.7319                1.8948\n11  Westchester County    1998              2.7400                1.2627              1.0000                2.5699\n12      Elliott County    1998              1.0280                0.5808              1.0000                1.9384\n13       Aurora County    1998              1.3554                2.5768              1.0000                1.8082\n14      Forsyth County    1998              2.0961                1.0618              1.0000                1.6064\n15    Van Buren County    1998              0.9098                1.1521              1.0000                1.6106\n16      Alfalfa County    1998              2.2270                1.5233              1.0000                1.8465\n17      Hopkins County    1998              2.3415                0.9639              1.0000                2.4037\n18        Green County    1998              0.6251                1.3125              1.0000                1.9741\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS3\".\"D_QOY\" = 3",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS3\".\"D_QOY\" = 3 LIMIT 21",
                "preview": "\n/*        ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n1   Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n2   Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n3   Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n4   Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n5   Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n6   Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n7   Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n8   Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n9   Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n10  Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n11  Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n12  Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n13  Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n14  Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n15  Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n16  Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n17  Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n18  Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.027909,
                    "execution_time": 0.014279,
                    "compile_time": 9.4e-05,
                    "planning_time": 0.006017
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.07988,
                    "execution_time": 0.015091,
                    "compile_time": 0.000116,
                    "planning_time": 0.053034
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS3\".\"D_QOY\" = 3"
            }
        ],
        "preview": "\n/*        ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n1   Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n2   Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n3   Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n4   Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n5   Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n6   Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n7   Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n8   Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n9   Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n10  Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n11  Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n12  Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n13  Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n14  Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n15  Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n16  Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n17  Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n18  Ottawa County    1998              1.3188                1.1239              1.0053                2.0036\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_9\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_9\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.343001,
                    "execution_time": 3.683672,
                    "compile_time": 0.000438,
                    "planning_time": 0.006447,
                    "create_size": 6657
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.525671,
                    "execution_time": 3.761752,
                    "compile_time": 0.000467,
                    "planning_time": 0.093701,
                    "create_size": 6657
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_10\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_10\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_10\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_10\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_10\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*         ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n1   Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n2   Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n3   Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n4   Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n5   Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n6   Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n7   Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n8   Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n9   Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n10  Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n11  Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n12  Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n13  Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n14  Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n15  Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n16  Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n17  Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n18  Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01846,
                    "execution_time": 0.007967,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.00404
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058355,
                    "execution_time": 0.008784,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.040218
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_10\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_10\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_10\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_10\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_10\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*         ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0   Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n1   Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n2   Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n3   Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n4   Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n5   Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n6   Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n7   Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n8   Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n9   Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n10  Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n11  Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n12  Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n13  Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n14  Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n15  Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n16  Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n17  Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n18  Menifee County    1998              2.3898                1.4519              0.4184                1.5704\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and (case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end IS NOT NULL) \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND NOT CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END IS NULL JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND NOT CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END IS NULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.221826,
                    "execution_time": 0.108642,
                    "compile_time": 0.035744,
                    "planning_time": 0.033247,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.82805,
                    "execution_time": 0.109048,
                    "compile_time": 3.571364,
                    "planning_time": 0.096928,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_11\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_11\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_11\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_11\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*              ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0      Wilbarger County    1998              4.8377                0.5311              2.1580                3.5687\n1       Waushara County    1998              0.5534                0.7970              1.9399                2.7403\n2           Dare County    1998              0.9806                0.9590              3.3677                2.2129\n3    Buena Vista County    1998              1.8685                0.6809              1.7579                1.8491\n4        Rapides Parish    1998              0.8570                1.1346              1.6505                2.3223\n5     Clearfield County    1998              0.2698                0.7269              4.8273                2.0844\n6         Lenoir County    1998              1.5823                1.2448              0.7011                1.7253\n7        Denali Borough    1998              0.8386                2.1269              0.9713                1.2305\n8        Menifee County    1998              2.3898                1.4519              0.8678                1.5704\n9        Venango County    1998              1.4752                1.3382              2.6660                1.8990\n10     Kandiyohi County    1998              0.4917                1.0893              1.9268                2.5342\n11       Lexington city    1998              0.7811                0.6642              1.2494                2.1734\n12      Lipscomb County    1998              0.7609                1.2065              1.7320                1.5355\n13       Prowers County    1998              0.2917                0.9374              3.5151                1.6536\n14        Juneau County    1998              2.2320                1.2492              1.2882                1.7121\n15  East Carroll Parish    1998              0.4921                1.6912              2.8174                0.9379\n16       Gooding County    1998              1.4665                1.3058              0.6208                1.8010\n17        Haakon County    1998              1.2106                1.2267              1.8802                2.0861\n18        Holmes County    1998              1.1099                1.0214              2.1831                1.2602\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017924,
                    "execution_time": 0.007468,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.00402
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056159,
                    "execution_time": 0.007831,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.040342
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND NOT CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END IS NULL JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_11\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_11\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_11\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_11\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*              ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0      Wilbarger County    1998              4.8377                0.5311              2.1580                3.5687\n1       Waushara County    1998              0.5534                0.7970              1.9399                2.7403\n2           Dare County    1998              0.9806                0.9590              3.3677                2.2129\n3    Buena Vista County    1998              1.8685                0.6809              1.7579                1.8491\n4        Rapides Parish    1998              0.8570                1.1346              1.6505                2.3223\n5     Clearfield County    1998              0.2698                0.7269              4.8273                2.0844\n6         Lenoir County    1998              1.5823                1.2448              0.7011                1.7253\n7        Denali Borough    1998              0.8386                2.1269              0.9713                1.2305\n8        Menifee County    1998              2.3898                1.4519              0.8678                1.5704\n9        Venango County    1998              1.4752                1.3382              2.6660                1.8990\n10     Kandiyohi County    1998              0.4917                1.0893              1.9268                2.5342\n11       Lexington city    1998              0.7811                0.6642              1.2494                2.1734\n12      Lipscomb County    1998              0.7609                1.2065              1.7320                1.5355\n13       Prowers County    1998              0.2917                0.9374              3.5151                1.6536\n14        Juneau County    1998              2.2320                1.2492              1.2882                1.7121\n15  East Carroll Parish    1998              0.4921                1.6912              2.8174                0.9379\n16       Gooding County    1998              1.4665                1.3058              0.6208                1.8010\n17        Haakon County    1998              1.2106                1.2267              1.8802                2.0861\n18        Holmes County    1998              1.1099                1.0214              2.1831                1.2602\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.176546,
                    "execution_time": 0.095073,
                    "compile_time": 0.000872,
                    "planning_time": 0.034097,
                    "create_size": 27
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.245125,
                    "execution_time": 0.097127,
                    "compile_time": 0.000825,
                    "planning_time": 0.095223,
                    "create_size": 27
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_12\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_12\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_12\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_12\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_12\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*                 ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0    Cape Girardeau County    1998              2.4709                1.2165              1.6061                1.8614\n1          McKinley County    1998              1.9081                0.6502              0.4020                1.9975\n2             Cross County    1998              2.1419                0.4596              0.8893                4.0047\n3              Gulf County    1998              2.5378                1.1846              2.8115                1.9055\n4             Dewey County    1998              1.1959                1.1669              1.5641                2.6590\n5            Traill County    1998             11.1069                0.6811              3.2894                2.4030\n6         Culberson County    1998              1.4394                0.8348              1.8811                2.3905\n7       Sweet Grass County    1998              1.0676                0.4989              1.6249                3.1678\n8           Webster Parish    1998              1.2093                1.1331              1.4909                2.1823\n9         Van Zandt County    1998              2.3580                0.8609              4.4517                2.3554\n10          McClain County    1998              6.2068                1.2995              2.1285                1.8160\n11         Converse County    1998              1.2390                0.9913              1.0351                2.6485\n12       Martinsville city    1998              1.8921                0.5828              0.9375                3.0220\n13          Venango County    1998              1.4752                1.3382              2.6660                1.8990\n14       Huntingdon County    1998              3.0849                0.5912              1.2741                2.1225\n15            Ferry County    1998              1.4797                0.7849              0.5334                2.1577\n16            Pratt County    1998              2.5351                0.7131              1.5377                2.0420\n17         Torrance County    1998              0.7244                0.5348              2.3226                1.3588\n18  Dillingham Census Area    1998              0.5445                0.5116              5.5543                2.4110\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017489,
                    "execution_time": 0.007199,
                    "compile_time": 5e-05,
                    "planning_time": 0.00398
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.068804,
                    "execution_time": 0.007222,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.052297
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_12\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_12\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_12\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_12\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_12\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*                 ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0    Cape Girardeau County    1998              2.4709                1.2165              1.6061                1.8614\n1          McKinley County    1998              1.9081                0.6502              0.4020                1.9975\n2             Cross County    1998              2.1419                0.4596              0.8893                4.0047\n3              Gulf County    1998              2.5378                1.1846              2.8115                1.9055\n4             Dewey County    1998              1.1959                1.1669              1.5641                2.6590\n5            Traill County    1998             11.1069                0.6811              3.2894                2.4030\n6         Culberson County    1998              1.4394                0.8348              1.8811                2.3905\n7       Sweet Grass County    1998              1.0676                0.4989              1.6249                3.1678\n8           Webster Parish    1998              1.2093                1.1331              1.4909                2.1823\n9         Van Zandt County    1998              2.3580                0.8609              4.4517                2.3554\n10          McClain County    1998              6.2068                1.2995              2.1285                1.8160\n11         Converse County    1998              1.2390                0.9913              1.0351                2.6485\n12       Martinsville city    1998              1.8921                0.5828              0.9375                3.0220\n13          Venango County    1998              1.4752                1.3382              2.6660                1.8990\n14       Huntingdon County    1998              3.0849                0.5912              1.2741                2.1225\n15            Ferry County    1998              1.4797                0.7849              0.5334                2.1577\n16            Pratt County    1998              2.5351                0.7131              1.5377                2.0420\n17         Torrance County    1998              0.7244                0.5348              2.3226                1.3588\n18  Dillingham Census Area    1998              0.5445                0.5116              5.5543                2.4110\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and (case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end) \n       > (case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end)\n    and (case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end) > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END > 0 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END > 0 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.241521,
                    "execution_time": 0.090397,
                    "compile_time": 0.06865,
                    "planning_time": 0.035187,
                    "create_size": 27
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.591589,
                    "execution_time": 0.098318,
                    "compile_time": 5.314404,
                    "planning_time": 0.126099,
                    "create_size": 27
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_13\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_13\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_13\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_13\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_13\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*                 ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0         Pipestone County    1998              1.5420                1.4669              0.9367                1.7912\n1           Gladwin County    1998              1.6087                0.9082              4.4118                0.9635\n2            Gosper County    1998              0.8614                0.6910              1.0478                2.1354\n3        Huntingdon County    1998              3.0849                0.5912              1.2741                2.1225\n4           Laclede County    1998              2.0572                0.7001              2.6825                2.3779\n5         Armstrong County    1998              1.3487                0.7153              3.1579                2.0398\n6          Montague County    1998              1.4560                0.9397              0.7748                2.0932\n7         Montezuma County    1998              2.1563                1.0891              1.2064                1.7603\n8               Bee County    1998              2.9574                0.9671              2.0028                1.9042\n9             Ozark County    1998              2.0646                1.2653              0.5649                2.4836\n10          Wapello County    1998              1.0345                0.9891              1.8071                1.2556\n11            Greer County    1998              1.4941                1.4143              1.9693                1.8829\n12         Kittitas County    1998              1.9595                1.0803              0.2633                1.8729\n13        Nome Census Area    1998              2.2974                1.3410              0.7696                1.1506\n14           Tippah County    1998              9.6041                1.7383              1.4284                1.6396\n15           Clinch County    1998              2.2135                1.0204              2.1718                1.8249\n16    Prince Edward County    1998              1.7016                0.6750              2.1438                2.5484\n17  Jefferson Davis County    1998              2.0361                0.6190              2.1822                2.3942\n18        Wabaunsee County    1998              2.1443                0.5076              3.3974                2.1015\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017022,
                    "execution_time": 0.006861,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003941
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054749,
                    "execution_time": 0.007691,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.040631
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END > 0 WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_13\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_13\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_13\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_13\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_13\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*                 ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0         Pipestone County    1998              1.5420                1.4669              0.9367                1.7912\n1           Gladwin County    1998              1.6087                0.9082              4.4118                0.9635\n2            Gosper County    1998              0.8614                0.6910              1.0478                2.1354\n3        Huntingdon County    1998              3.0849                0.5912              1.2741                2.1225\n4           Laclede County    1998              2.0572                0.7001              2.6825                2.3779\n5         Armstrong County    1998              1.3487                0.7153              3.1579                2.0398\n6          Montague County    1998              1.4560                0.9397              0.7748                2.0932\n7         Montezuma County    1998              2.1563                1.0891              1.2064                1.7603\n8               Bee County    1998              2.9574                0.9671              2.0028                1.9042\n9             Ozark County    1998              2.0646                1.2653              0.5649                2.4836\n10          Wapello County    1998              1.0345                0.9891              1.8071                1.2556\n11            Greer County    1998              1.4941                1.4143              1.9693                1.8829\n12         Kittitas County    1998              1.9595                1.0803              0.2633                1.8729\n13        Nome Census Area    1998              2.2974                1.3410              0.7696                1.1506\n14           Tippah County    1998              9.6041                1.7383              1.4284                1.6396\n15           Clinch County    1998              2.2135                1.0204              2.1718                1.8249\n16    Prince Edward County    1998              1.7016                0.6750              2.1438                2.5484\n17  Jefferson Davis County    1998              2.0361                0.6190              2.1822                2.3942\n18        Wabaunsee County    1998              2.1443                0.5076              3.3974                2.1015\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS2\".\"STORE_SALES\" > 0 THEN \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS2\".\"STORE_SALES\" > 0 THEN \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.206993,
                    "execution_time": 0.111517,
                    "compile_time": 0.01366,
                    "planning_time": 0.037657,
                    "create_size": 1017
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.876932,
                    "execution_time": 0.107586,
                    "compile_time": 3.624466,
                    "planning_time": 0.096902,
                    "create_size": 1017
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_14\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" LIMIT 21",
                "preview": "\n/*              ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0          Trigg County    1998              1.5264                1.0757              2.5381                1.3465\n1       Brantley County    1998              1.4019                1.1416              1.8849                1.4457\n2         Asotin County    1998              1.8044                0.6760              1.9711                1.9402\n3       Reynolds County    1998              1.4475                0.7806              1.7116                1.0966\n4           Baca County    1998              3.7288                0.7824              1.9947                1.3853\n5          Worth County    1998              0.8721                0.7438              3.1334                1.7931\n6         Morton County    1998              1.1363                0.9628              2.9634                1.6644\n7      McCormick County    1998              1.2062                0.6161              3.3952                1.5976\n8   Contra Costa County    1998              1.7930                1.6023              3.1396                1.7906\n9        Newport County    1998              3.3160                0.9301              1.3748                1.3640\n10       Gregory County    1998              0.8897                0.8006              2.6214                1.4746\n11      Callaway County    1998              0.7848                0.6531              4.2713                1.8608\n12    Harrisonburg city    1998              1.1487                0.7101              5.4134                3.2278\n13    Clearwater County    1998              1.9365                1.5449              1.9021                1.6699\n14        Concho County    1998              2.2518                1.1216              3.4619                1.7759\n15      Hardeman County    1998              1.3420                1.0806              2.4812                1.6611\n16        Athens County    1998              1.1531                0.7678              3.0033                1.8710\n17        Brooks County    1998              0.8699                0.7954              2.1145                1.9772\n18        Sussex County    1998              1.1063                0.6485              2.9803                2.4125\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01814,
                    "execution_time": 0.007763,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.004026
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.068539,
                    "execution_time": 0.008277,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.052016
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS2\".\"STORE_SALES\" > 0 THEN \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_14\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\""
            }
        ],
        "preview": "\n/*              ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0          Trigg County    1998              1.5264                1.0757              2.5381                1.3465\n1       Brantley County    1998              1.4019                1.1416              1.8849                1.4457\n2         Asotin County    1998              1.8044                0.6760              1.9711                1.9402\n3       Reynolds County    1998              1.4475                0.7806              1.7116                1.0966\n4           Baca County    1998              3.7288                0.7824              1.9947                1.3853\n5          Worth County    1998              0.8721                0.7438              3.1334                1.7931\n6         Morton County    1998              1.1363                0.9628              2.9634                1.6644\n7      McCormick County    1998              1.2062                0.6161              3.3952                1.5976\n8   Contra Costa County    1998              1.7930                1.6023              3.1396                1.7906\n9        Newport County    1998              3.3160                0.9301              1.3748                1.3640\n10       Gregory County    1998              0.8897                0.8006              2.6214                1.4746\n11      Callaway County    1998              0.7848                0.6531              4.2713                1.8608\n12    Harrisonburg city    1998              1.1487                0.7101              5.4134                3.2278\n13    Clearwater County    1998              1.9365                1.5449              1.9021                1.6699\n14        Concho County    1998              2.2518                1.1216              3.4619                1.7759\n15      Hardeman County    1998              1.3420                1.0806              2.4812                1.6611\n16        Athens County    1998              1.1531                0.7678              3.0033                1.8710\n17        Brooks County    1998              0.8699                0.7954              2.1145                1.9772\n18        Sussex County    1998              1.1063                0.6485              2.9803                2.4125\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n order by web_q1_q2_increase\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS2\".\"STORE_SALES\" > 0 THEN \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 ORDER BY \"WEB_Q1_Q2_INCREASE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_14\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ORDER BY \"WEB_Q1_Q2_INCREASE\" LIMIT 21",
                "preview": "\n/*                 ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0          Siskiyou County    1998              0.4752                0.3809              6.1917                2.4127\n1             Wythe County    1998              0.5234                0.5229              2.7563                2.4487\n2        Otter Tail County    1998              0.5383                0.5332              5.5978                2.6971\n3   Dillingham Census Area    1998              0.5445                0.5116              5.5543                2.4110\n4          Faulkner County    1998              0.6256                0.6012              2.8769                2.1961\n5         Roscommon County    1998              0.6377                0.5012              2.8357                2.4854\n6         Del Norte County    1998              0.6532                0.4092              4.6935                4.6021\n7          Torrance County    1998              0.7244                0.5348              2.3226                1.3588\n8              Hyde County    1998              0.7275                0.6759              3.2179                2.7769\n9           Clarion County    1998              0.7536                0.5751              3.6085                2.4459\n10           Richmond city    1998              0.7649                0.6761              2.9395                1.6583\n11         Calloway County    1998              0.7786                0.7643              2.4491                1.3952\n12          Cameron County    1998              0.7807                0.6880              3.4391                2.2855\n13         Callaway County    1998              0.7848                0.6531              4.2713                1.8608\n14         Beltrami County    1998              0.7947                0.7578              4.4563                3.1516\n15         Flathead County    1998              0.7971                0.7383              4.2737                1.9220\n16           Moffat County    1998              0.8099                0.5684              3.1010                2.6861\n17       Shiawassee County    1998              0.8140                0.6276              3.1940                2.6082\n18            Boise County    1998              0.8147                0.7477              2.2096                1.9148\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019524,
                    "execution_time": 0.009242,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.004082
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.063783,
                    "execution_time": 0.009641,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.045964
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS2\".\"STORE_SALES\" > 0 THEN \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 ORDER BY \"WEB_Q1_Q2_INCREASE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_14\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ORDER BY \"WEB_Q1_Q2_INCREASE\" NULLS LAST"
            }
        ],
        "preview": "\n/*                 ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0          Siskiyou County    1998              0.4752                0.3809              6.1917                2.4127\n1             Wythe County    1998              0.5234                0.5229              2.7563                2.4487\n2        Otter Tail County    1998              0.5383                0.5332              5.5978                2.6971\n3   Dillingham Census Area    1998              0.5445                0.5116              5.5543                2.4110\n4          Faulkner County    1998              0.6256                0.6012              2.8769                2.1961\n5         Roscommon County    1998              0.6377                0.5012              2.8357                2.4854\n6         Del Norte County    1998              0.6532                0.4092              4.6935                4.6021\n7          Torrance County    1998              0.7244                0.5348              2.3226                1.3588\n8              Hyde County    1998              0.7275                0.6759              3.2179                2.7769\n9           Clarion County    1998              0.7536                0.5751              3.6085                2.4459\n10           Richmond city    1998              0.7649                0.6761              2.9395                1.6583\n11         Calloway County    1998              0.7786                0.7643              2.4491                1.3952\n12          Cameron County    1998              0.7807                0.6880              3.4391                2.2855\n13         Callaway County    1998              0.7848                0.6531              4.2713                1.8608\n14         Beltrami County    1998              0.7947                0.7578              4.4563                3.1516\n15         Flathead County    1998              0.7971                0.7383              4.2737                1.9220\n16           Moffat County    1998              0.8099                0.5684              3.1010                2.6861\n17       Shiawassee County    1998              0.8140                0.6276              3.1940                2.6082\n18            Boise County    1998              0.8147                0.7477              2.2096                1.9148\n...*/"
    },
    {
        "input": "-- start template query31.tpl query 50 in stream 0\nwith /* TPC-DS query31.tpl 0.50 */ ss as\n (select ca_county,d_qoy, d_year,sum(ss_ext_sales_price) as store_sales\n from store_sales,date_dim,customer_address\n where ss_sold_date_sk = d_date_sk\n  and ss_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year),\n ws as\n (select ca_county,d_qoy, d_year,sum(ws_ext_sales_price) as web_sales\n from web_sales,date_dim,customer_address\n where ws_sold_date_sk = d_date_sk\n  and ws_bill_addr_sk=ca_address_sk\n group by ca_county,d_qoy, d_year)\n select \n        ss1.ca_county\n       ,ss1.d_year\n       ,ws2.web_sales/ws1.web_sales web_q1_q2_increase\n       ,ss2.store_sales/ss1.store_sales store_q1_q2_increase\n       ,ws3.web_sales/ws2.web_sales web_q2_q3_increase\n       ,ss3.store_sales/ss2.store_sales store_q2_q3_increase\n from\n        ss ss1\n       ,ss ss2\n       ,ss ss3\n       ,ws ws1\n       ,ws ws2\n       ,ws ws3\n where\n    ss1.d_qoy = 1\n    and ss1.d_year = 1998\n    and ss1.ca_county = ss2.ca_county\n    and ss2.d_qoy = 2\n    and ss2.d_year = 1998\n and ss2.ca_county = ss3.ca_county\n    and ss3.d_qoy = 3\n    and ss3.d_year = 1998\n    and ss1.ca_county = ws1.ca_county\n    and ws1.d_qoy = 1\n    and ws1.d_year = 1998\n    and ws1.ca_county = ws2.ca_county\n    and ws2.d_qoy = 2\n    and ws2.d_year = 1998\n    and ws1.ca_county = ws3.ca_county\n    and ws3.d_qoy = 3\n    and ws3.d_year =1998\n    and case when ws1.web_sales > 0 then ws2.web_sales/ws1.web_sales else null end \n       > case when ss1.store_sales > 0 then ss2.store_sales/ss1.store_sales else null end\n    and case when ws2.web_sales > 0 then ws3.web_sales/ws2.web_sales else null end\n       > case when ss2.store_sales > 0 then ss3.store_sales/ss2.store_sales else null end\n order by web_q1_q2_increase\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_ADDRESS_2\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AS \"CA_ADDRESS_SK\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" FROM \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"SS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"STORE_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"STORE_SALES\".\"SS_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) , \"WS\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WEB_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER_ADDRESS_2\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_SALES\".\"WS_BILL_ADDR_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SS\" AS \"SS1\" JOIN \"SS\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SS\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"WS\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"WS\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS2\".\"STORE_SALES\" > 0 THEN \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 ORDER BY \"WEB_Q1_Q2_INCREASE\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_14\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ORDER BY \"WEB_Q1_Q2_INCREASE\" LIMIT 21",
                "preview": "\n/*                 ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0          Siskiyou County    1998              0.4752                0.3809              6.1917                2.4127\n1             Wythe County    1998              0.5234                0.5229              2.7563                2.4487\n2        Otter Tail County    1998              0.5383                0.5332              5.5978                2.6971\n3   Dillingham Census Area    1998              0.5445                0.5116              5.5543                2.4110\n4          Faulkner County    1998              0.6256                0.6012              2.8769                2.1961\n5         Roscommon County    1998              0.6377                0.5012              2.8357                2.4854\n6         Del Norte County    1998              0.6532                0.4092              4.6935                4.6021\n7          Torrance County    1998              0.7244                0.5348              2.3226                1.3588\n8              Hyde County    1998              0.7275                0.6759              3.2179                2.7769\n9           Clarion County    1998              0.7536                0.5751              3.6085                2.4459\n10           Richmond city    1998              0.7649                0.6761              2.9395                1.6583\n11         Calloway County    1998              0.7786                0.7643              2.4491                1.3952\n12          Cameron County    1998              0.7807                0.6880              3.4391                2.2855\n13         Callaway County    1998              0.7848                0.6531              4.2713                1.8608\n14         Beltrami County    1998              0.7947                0.7578              4.4563                3.1516\n15         Flathead County    1998              0.7971                0.7383              4.2737                1.9220\n16           Moffat County    1998              0.8099                0.5684              3.1010                2.6861\n17       Shiawassee County    1998              0.8140                0.6276              3.1940                2.6082\n18            Boise County    1998              0.8147                0.7477              2.2096                1.9148\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020201,
                    "execution_time": 0.009693,
                    "compile_time": 7.6e-05,
                    "planning_time": 0.004134
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020396,
                    "execution_time": 0.009836,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.004189
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SS1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SS1\".\"D_YEAR\" AS \"D_YEAR\" , \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" AS \"WEB_Q1_Q2_INCREASE\" , \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" AS \"STORE_Q1_Q2_INCREASE\" , \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" AS \"WEB_Q2_Q3_INCREASE\" , \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SS1\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS2\" ON \"SS1\".\"CA_COUNTY\" = \"SS2\".\"CA_COUNTY\" AND \"SS2\".\"D_QOY\" = 2 AND \"SS2\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS1\" ON \"SS1\".\"CA_COUNTY\" = \"WS1\".\"CA_COUNTY\" AND \"WS1\".\"D_QOY\" = 1 AND \"WS1\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SS3\" ON \"SS2\".\"CA_COUNTY\" = \"SS3\".\"CA_COUNTY\" AND \"SS3\".\"D_QOY\" = 3 AND \"SS3\".\"D_YEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS2\" ON \"WS1\".\"CA_COUNTY\" = \"WS2\".\"CA_COUNTY\" AND \"WS2\".\"D_QOY\" = 2 AND \"WS2\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS1\".\"STORE_SALES\" > 0 THEN \"SS2\".\"STORE_SALES\" / \"SS1\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS1\".\"WEB_SALES\" > 0 THEN \"WS2\".\"WEB_SALES\" / \"WS1\".\"WEB_SALES\" ELSE NULL END JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"WS3\" ON \"WS1\".\"CA_COUNTY\" = \"WS3\".\"CA_COUNTY\" AND \"WS3\".\"D_QOY\" = 3 AND \"WS3\".\"D_YEAR\" = 1998 AND CASE WHEN \"SS2\".\"STORE_SALES\" > 0 THEN \"SS3\".\"STORE_SALES\" / \"SS2\".\"STORE_SALES\" ELSE NULL END < CASE WHEN \"WS2\".\"WEB_SALES\" > 0 THEN \"WS3\".\"WEB_SALES\" / \"WS2\".\"WEB_SALES\" ELSE NULL END WHERE \"SS1\".\"D_QOY\" = 1 AND \"SS1\".\"D_YEAR\" = 1998 ORDER BY \"WEB_Q1_Q2_INCREASE\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_14\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q1_Q2_INCREASE\" AS \"WEB_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q1_Q2_INCREASE\" AS \"STORE_Q1_Q2_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"WEB_Q2_Q3_INCREASE\" AS \"WEB_Q2_Q3_INCREASE\" , \"SPEQLITE_TEMP_TABLE_14\".\"STORE_Q2_Q3_INCREASE\" AS \"STORE_Q2_Q3_INCREASE\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ORDER BY \"WEB_Q1_Q2_INCREASE\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*                 ca_county  d_year  web_q1_q2_increase  store_q1_q2_increase  web_q2_q3_increase  store_q2_q3_increase\n0          Siskiyou County    1998              0.4752                0.3809              6.1917                2.4127\n1             Wythe County    1998              0.5234                0.5229              2.7563                2.4487\n2        Otter Tail County    1998              0.5383                0.5332              5.5978                2.6971\n3   Dillingham Census Area    1998              0.5445                0.5116              5.5543                2.4110\n4          Faulkner County    1998              0.6256                0.6012              2.8769                2.1961\n5         Roscommon County    1998              0.6377                0.5012              2.8357                2.4854\n6         Del Norte County    1998              0.6532                0.4092              4.6935                4.6021\n7          Torrance County    1998              0.7244                0.5348              2.3226                1.3588\n8              Hyde County    1998              0.7275                0.6759              3.2179                2.7769\n9           Clarion County    1998              0.7536                0.5751              3.6085                2.4459\n10           Richmond city    1998              0.7649                0.6761              2.9395                1.6583\n11         Calloway County    1998              0.7786                0.7643              2.4491                1.3952\n12          Cameron County    1998              0.7807                0.6880              3.4391                2.2855\n13         Callaway County    1998              0.7848                0.6531              4.2713                1.8608\n14         Beltrami County    1998              0.7947                0.7578              4.4563                3.1516\n15         Flathead County    1998              0.7971                0.7383              4.2737                1.9220\n16           Moffat County    1998              0.8099                0.5684              3.1010                2.6861\n17       Shiawassee County    1998              0.8140                0.6276              3.1940                2.6082\n18            Boise County    1998              0.8147                0.7477              2.2096                1.9148\n...*/"
    }
]