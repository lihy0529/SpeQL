[
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\"",
                "rewrite": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\""
            }
        ],
        "preview": null
    },
    {
        "input": "select /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ncs_sold_date_sk = d_date_sk /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\"",
                "rewrite": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 283"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 283 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "rewrite": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 283"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.707072,
                    "execution_time": 0.635924,
                    "compile_time": 0.000417,
                    "planning_time": 0.041602,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.787371,
                    "execution_time": 0.633051,
                    "compile_time": 0.000425,
                    "planning_time": 0.121954,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            4.063287e+12*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015174,
                    "execution_time": 0.006841,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.002804
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.050462,
                    "execution_time": 0.006882,
                    "compile_time": 4e-05,
                    "planning_time": 0.037809
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   excess discount amount\n0            4.063287e+12*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and '1999-03-22' \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '1999-03-22' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '1999-03-22' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.089642,
                    "execution_time": 0.038136,
                    "compile_time": 0.000282,
                    "planning_time": 0.026815,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.157062,
                    "execution_time": 0.040052,
                    "compile_time": 0.000271,
                    "planning_time": 0.090202,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    excess discount amount\n0             4.063287e+12\n1             4.063287e+12\n2             4.063287e+12\n3             4.063287e+12\n4             4.063287e+12\n5             4.063287e+12\n6             4.063287e+12\n7             4.063287e+12\n8             4.063287e+12\n9             4.063287e+12\n10            4.063287e+12\n11            4.063287e+12\n12            4.063287e+12\n13            4.063287e+12\n14            4.063287e+12\n15            4.063287e+12\n16            4.063287e+12\n17            4.063287e+12\n18            4.063287e+12\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015309,
                    "execution_time": 0.006721,
                    "compile_time": 4.1e-05,
                    "planning_time": 0.002858
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052517,
                    "execution_time": 0.007229,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.037946
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST('1999-03-22' AS DATE) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1999-02-22' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    excess discount amount\n0             4.063287e+12\n1             4.063287e+12\n2             4.063287e+12\n3             4.063287e+12\n4             4.063287e+12\n5             4.063287e+12\n6             4.063287e+12\n7             4.063287e+12\n8             4.063287e+12\n9             4.063287e+12\n10            4.063287e+12\n11            4.063287e+12\n12            4.063287e+12\n13            4.063287e+12\n14            4.063287e+12\n15            4.063287e+12\n16            4.063287e+12\n17            4.063287e+12\n18            4.063287e+12\n...*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            5.061795e+09*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.072615,
                    "execution_time": 0.023079,
                    "compile_time": 0.000188,
                    "planning_time": 0.039048
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.137092,
                    "execution_time": 0.022357,
                    "compile_time": 0.000195,
                    "planning_time": 0.103245
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 90, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1999-02-22' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0            5.061795e+09*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              1697787.25*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.06854,
                    "execution_time": 0.017517,
                    "compile_time": 0.000193,
                    "planning_time": 0.040102
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.136688,
                    "execution_time": 0.018456,
                    "compile_time": 0.000205,
                    "planning_time": 0.106035
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 90, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1999-02-22' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0              1697787.25*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt IS NOT NULL \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283 WHERE NOT \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" IS NULL"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND NOT CS_EXT_DISCOUNT_AMT IS NULL LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              1697787.25*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.071569,
                    "execution_time": 0.018002,
                    "compile_time": 0.00021,
                    "planning_time": 0.042428
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.252303,
                    "execution_time": 0.018778,
                    "compile_time": 0.115155,
                    "planning_time": 0.106158
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 90, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1999-02-22' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283 WHERE NOT \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" IS NULL",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0              1697787.25*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \nwhere\ncs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n         where \n            cs_sold_date_sk between (select min(cs_sold_date_sk) from catalog_sales) and \n            dateadd(day,90,cast('1999-02-22' as date))\n        )\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT MIN ( \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"_U_1\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" <= \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" WHERE \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES WHERE CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES WHERE CS_SOLD_DATE_SK BETWEEN ( SELECT MIN ( CS_SOLD_DATE_SK ) FROM CATALOG_SALES ) AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) ) LIMIT 21",
                "preview": "\n/*  excess discount amount\n0                   None*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.769197,
                    "execution_time": 0.717597,
                    "compile_time": 0.000305,
                    "planning_time": 0.036911
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.837029,
                    "execution_time": 0.722829,
                    "compile_time": 0.00029,
                    "planning_time": 0.098357
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*  excess discount amount\n0                   None*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": null,
        "rewrite_main_query": [
            {
                "script": "WITH _U_0 AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "rewrite": "WITH _U_0 AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n         where \n         d_date_sk = cs_sold_date_sk\n         )\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.125176,
                    "execution_time": 0.062065,
                    "compile_time": 0.000335,
                    "planning_time": 0.035846,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.194237,
                    "execution_time": 0.061966,
                    "compile_time": 0.000357,
                    "planning_time": 0.102539,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES , DATE_DIM WHERE D_DATE_SK = CS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              1213813.93*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.115407,
                    "execution_time": 0.049719,
                    "compile_time": 0.000345,
                    "planning_time": 0.048818
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.194598,
                    "execution_time": 0.053503,
                    "compile_time": 0.000346,
                    "planning_time": 0.122839
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0              1213813.93*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,date_dim\nwhere\nd_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n         where \n              cs_sold_date_sk = d_date_sk \n/*CURSOR_IDENTIFIER*/ \n           )",
        "optimize": [
            "WITH \"CATALOG_SALES_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"CS_SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" AS \"CS_EXT_DISCOUNT_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"CS_SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" AS \"CS_EXT_DISCOUNT_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.594566,
                    "execution_time": 0.362259,
                    "compile_time": 0.000251,
                    "planning_time": 0.026081,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.648447,
                    "execution_time": 0.356697,
                    "compile_time": 0.000248,
                    "planning_time": 0.087845,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.123309,
                    "execution_time": 0.064511,
                    "compile_time": 0.000347,
                    "planning_time": 0.030602,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.190867,
                    "execution_time": 0.063993,
                    "compile_time": 0.000329,
                    "planning_time": 0.095136,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , DATE_DIM WHERE D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES , DATE_DIM WHERE CS_SOLD_DATE_SK = D_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            7.316589e+08*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.105594,
                    "execution_time": 0.04687,
                    "compile_time": 0.000276,
                    "planning_time": 0.044053
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.176116,
                    "execution_time": 0.046229,
                    "compile_time": 0.000289,
                    "planning_time": 0.113865
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE )",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0            7.316589e+08*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n         where \n              cs_item_sk = i_item_sk \n          and d_date between '1999-02-22' and\n              dateadd(day,90,cast('1999-02-22' as date))\n          and d_date_sk = cs_sold_date_sk \n     )\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CATALOG_SALES_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"CS_SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" AS \"CS_EXT_DISCOUNT_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"_U_1\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"CS_SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" AS \"CS_EXT_DISCOUNT_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.686614,
                    "execution_time": 0.406692,
                    "compile_time": 0.000261,
                    "planning_time": 0.028356,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.746325,
                    "execution_time": 0.405041,
                    "compile_time": 0.000252,
                    "planning_time": 0.089899,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              1183959.47*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.12606,
                    "execution_time": 0.034936,
                    "compile_time": 0.000442,
                    "planning_time": 0.069932
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.204513,
                    "execution_time": 0.038658,
                    "compile_time": 0.00045,
                    "planning_time": 0.142618
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0              1183959.47*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n         where \n              cs_item_sk = i_item_sk \n          and d_date between '1999-02-22' and\n                             dateadd(day,90,cast('1999-02-22' as date))\n/*CURSOR_IDENTIFIER*/\n         )",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"_U_1\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              1220619.65*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.132234,
                    "execution_time": 0.0419,
                    "compile_time": 0.000464,
                    "planning_time": 0.06953
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.204064,
                    "execution_time": 0.044691,
                    "compile_time": 0.000463,
                    "planning_time": 0.137432
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0              1220619.65*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n         where \n              cs_item_sk = i_item_sk \n          and d_date between '1999-02-22' and\n                             dateadd(day,90,cast('1999-02-22' as date))\n          and d_date_sk = cs_sold_date_sk \n/*CURSOR_IDENTIFIER*/\n     )",
        "optimize": [
            "WITH \"CATALOG_SALES_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"CS_SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" AS \"CS_EXT_DISCOUNT_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"_U_1\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              1183959.47*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.130403,
                    "execution_time": 0.03918,
                    "compile_time": 0.000446,
                    "planning_time": 0.069775
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.127771,
                    "execution_time": 0.038258,
                    "compile_time": 0.000447,
                    "planning_time": 0.068003
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0              1183959.47*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n         where \n              cs_item_sk = i_item_sk \n          and d_date between '1999-02-22' and\n                             dateadd(day,90,cast('1999-02-22' as date))\n          and d_date_sk = cs_sold_date_sk \n      ) \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CATALOG_SALES_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"CS_SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" AS \"CS_EXT_DISCOUNT_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"_U_1\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              1183959.47*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.129068,
                    "execution_time": 0.038028,
                    "compile_time": 0.000464,
                    "planning_time": 0.068973
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.126859,
                    "execution_time": 0.037452,
                    "compile_time": 0.000462,
                    "planning_time": 0.067678
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0              1183959.47*/"
    },
    {
        "input": "-- start template query32.tpl query 7 in stream 0\nselect /* TPC-DS query32.tpl 0.7 */  sum(cs_ext_discount_amt)  as \"excess discount amount\" \nfrom \n   catalog_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 283\nand i_item_sk = cs_item_sk \nand d_date between '1999-02-22' and \n        dateadd(day,90,cast('1999-02-22' as date))\nand d_date_sk = cs_sold_date_sk \nand cs_ext_discount_amt  \n     > ( \n         select \n            1.3 * avg(cs_ext_discount_amt) \n         from \n            catalog_sales \n           ,date_dim\n         where \n              cs_item_sk = i_item_sk \n          and d_date between '1999-02-22' and\n                             dateadd(day,90,cast('1999-02-22' as date))\n          and d_date_sk = cs_sold_date_sk \n      ) \nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CATALOG_SALES_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"CS_SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" AS \"CS_EXT_DISCOUNT_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1999-02-22' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"_U_1\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"CATALOG_SALES_2\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 283 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CATALOG_SALES\".\"CS_EXT_DISCOUNT_AMT\" LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM CATALOG_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 283 AND I_ITEM_SK = CS_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK AND CS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( CS_EXT_DISCOUNT_AMT ) FROM CATALOG_SALES , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1999-02-22' AND DATEADD ( DAY , 90 , CAST ( '1999-02-22' AS DATE ) ) AND D_DATE_SK = CS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0              1183959.47*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.12983,
                    "execution_time": 0.039178,
                    "compile_time": 0.000461,
                    "planning_time": 0.069036
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.125086,
                    "execution_time": 0.035497,
                    "compile_time": 0.000447,
                    "planning_time": 0.068298
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0              1183959.47*/"
    }
]