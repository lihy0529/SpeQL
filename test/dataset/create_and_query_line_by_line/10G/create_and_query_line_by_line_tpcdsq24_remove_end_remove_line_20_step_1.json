[
    {
        "input": "-- end template query24.tpl query 92 in stream 0\n-- start template query24.tpl query 92 in stream 0\nwith /* TPC-DS query24.tpl 0.92 */ ssales as\n(select \n      ss_ticket_number\n      ,ss_item_sk\n      ,sum(ss_sales_price) as netpaid\nfrom store_sales\ngroup by \n        ss_ticket_number\n        ,ss_item_sk)\n/*CURSOR_IDENTIFIER*/\nSELECT * FROM ssales;",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) SELECT \"SSALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SSALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"SSALES\".\"NETPAID\" AS \"NETPAID\" FROM \"SSALES\" AS \"SSALES\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.384709,
                    "execution_time": 1.095546,
                    "compile_time": 0.00028,
                    "planning_time": 0.027209,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.568244,
                    "execution_time": 1.079387,
                    "compile_time": 0.135787,
                    "planning_time": 0.089767,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ss_ticket_number  ss_item_sk  netpaid\n0            1408619       32326    67.07\n1            1408619       65521    63.00\n2            1408619       85957    82.52\n3            1408619       64858    53.73\n4            1408619       67630    35.91\n5            1408619       73922    15.31\n6            1408619       26228   162.38\n7            1408619       63760     7.51\n8            1408619       97346     0.00\n9            1408619       39109    99.85\n10           1408619       18739    53.25\n11           1408619       36109    28.18\n12           2170440       46432   127.71\n13           2170440       36250     2.83\n14           2170440       12866    30.79\n15           2170440       23164   119.65\n16           2170440       89786    58.41\n17           2170440       85750    86.54\n18           2170440      100849     1.84\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.066605,
                    "execution_time": 0.007878,
                    "compile_time": 0.049176,
                    "planning_time": 0.003384
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.361734,
                    "execution_time": 0.00804,
                    "compile_time": 3.302747,
                    "planning_time": 0.039237
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ss_ticket_number  ss_item_sk  netpaid\n0            1408619       32326    67.07\n1            1408619       65521    63.00\n2            1408619       85957    82.52\n3            1408619       64858    53.73\n4            1408619       67630    35.91\n5            1408619       73922    15.31\n6            1408619       26228   162.38\n7            1408619       63760     7.51\n8            1408619       97346     0.00\n9            1408619       39109    99.85\n10           1408619       18739    53.25\n11           1408619       36109    28.18\n12           2170440       46432   127.71\n13           2170440       36250     2.83\n14           2170440       12866    30.79\n15           2170440       23164   119.65\n16           2170440       89786    58.41\n17           2170440       85750    86.54\n18           2170440      100849     1.84\n...*/"
    },
    {
        "input": "-- end template query24.tpl query 92 in stream 0\n-- start template query24.tpl query 92 in stream 0\nwith /* TPC-DS query24.tpl 0.92 */ ssales as\n(select \n      sum(SS_SALES_PRICE) netpaid\nfrom store_sales\nwhere SS_SOLD_DATE_SK is not null\nand SS_SOLD_TIME_SK is not null\nand SS_SOLD_DATE_SK >= DATEADD(day, -30, CURRENT_DATE)\nand SS_SALES_PRICE > 0\nand SS_STORE_SK in (select distinct ss_store_sk from store_sales) \nand SS_QUANTITY > 0\nand SS_PROMO_SK is null\ngroup by SS_SOLD_DATE_SK)\n/*CURSOR_IDENTIFIER*/\nselect * from ssales",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" ) , \"SSALES\" AS ( SELECT SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"SS_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE \"STORE_SALES\".\"SS_PROMO_SK\" IS NULL AND \"STORE_SALES\".\"SS_QUANTITY\" > 0 AND \"STORE_SALES\".\"SS_SALES_PRICE\" > 0 AND \"STORE_SALES\".\"SS_SOLD_DATE_SK\" >= TS_OR_DS_ADD ( 'DAY' , -30 , DAY , TIMESTAMP ) AND NOT \"_U_0\".\"SS_STORE_SK\" IS NULL AND NOT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" IS NULL AND NOT \"STORE_SALES\".\"SS_SOLD_TIME_SK\" IS NULL GROUP BY \"STORE_SALES\".\"SS_SOLD_DATE_SK\" ) SELECT \"SSALES\".\"NETPAID\" AS \"NETPAID\" FROM \"SSALES\" AS \"SSALES\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT DISTINCT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.105129,
                    "execution_time": 0.054465,
                    "compile_time": 0.000283,
                    "planning_time": 0.02496,
                    "create_size": 156
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.170079,
                    "execution_time": 0.054125,
                    "compile_time": 0.000283,
                    "planning_time": 0.086043,
                    "create_size": 156
                }
            }
        ],
        "query": [
            {
                "query": "WITH SSALES AS ( SELECT SUM ( SS_SALES_PRICE ) AS NETPAID FROM STORE_SALES WHERE NOT SS_SOLD_DATE_SK IS NULL AND NOT SS_SOLD_TIME_SK IS NULL AND SS_SOLD_DATE_SK >= DATEADD ( DAY , -30 , CURRENT_DATE ) AND SS_SALES_PRICE > 0 AND SS_STORE_SK IN ( SELECT DISTINCT SS_STORE_SK FROM STORE_SALES ) AND SS_QUANTITY > 0 AND SS_PROMO_SK IS NULL GROUP BY SS_SOLD_DATE_SK ) SELECT * FROM SSALES LIMIT 21",
                "preview": "\n/*    netpaid\n0    328.63\n1    745.13\n2    351.94\n3    423.06\n4    321.69\n5    219.16\n6    601.28\n7    105.83\n8   1080.81\n9    615.79\n10   847.56\n11   772.22\n12  1147.74\n13   832.60\n14   948.04\n15  1546.78\n16  1266.09\n17  1592.86\n18  1492.85\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.225271,
                    "execution_time": 0.124233,
                    "compile_time": 0.05106,
                    "planning_time": 0.03555
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 4.802418,
                    "execution_time": 1.191166,
                    "compile_time": 3.491551,
                    "planning_time": 0.100812
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*    netpaid\n0    328.63\n1    745.13\n2    351.94\n3    423.06\n4    321.69\n5    219.16\n6    601.28\n7    105.83\n8   1080.81\n9    615.79\n10   847.56\n11   772.22\n12  1147.74\n13   832.60\n14   948.04\n15  1546.78\n16  1266.09\n17  1592.86\n18  1492.85\n...*/"
    },
    {
        "input": "-- end template query24.tpl query 92 in stream 0\n-- start template query24.tpl query 92 in stream 0\nwith /* TPC-DS query24.tpl 0.92 */ ssales as\n(select ss_customer_sk\n      ,ss_store_sk\n      ,sum(ss_sales_price) as netpaid\nfrom store_sales\ngroup by ss_customer_sk\n        ,ss_store_sk\n)\n/*CURSOR_IDENTIFIER*/\nselect *\nfrom ssales",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" ) SELECT \"SSALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SSALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"SSALES\".\"NETPAID\" AS \"NETPAID\" FROM \"SSALES\" AS \"SSALES\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.716059,
                    "execution_time": 0.441709,
                    "compile_time": 0.000321,
                    "planning_time": 0.027222,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.787813,
                    "execution_time": 0.442949,
                    "compile_time": 0.000321,
                    "planning_time": 0.092758,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*    ss_customer_sk  ss_store_sk    netpaid\n0         311995.0          1.0     907.13\n1         363360.0         34.0     680.74\n2         363360.0          NaN      47.63\n3          60157.0          7.0     284.60\n4          49212.0         22.0     302.33\n5         102933.0         85.0     446.28\n6         322543.0         34.0     443.03\n7         195547.0         94.0     836.88\n8          56849.0         82.0     802.79\n9         172074.0         70.0     515.98\n10        194820.0          1.0     393.96\n11        296530.0         19.0     281.08\n12        142877.0         20.0     265.79\n13        127766.0         14.0     553.05\n14        487337.0          1.0     286.58\n15             NaN         62.0  241595.58\n16        443260.0         26.0     382.64\n17          5924.0         73.0     685.71\n18        171731.0        100.0     373.06\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017136,
                    "execution_time": 0.007625,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003495
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055473,
                    "execution_time": 0.007573,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.038895
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_3\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*    ss_customer_sk  ss_store_sk    netpaid\n0         311995.0          1.0     907.13\n1         363360.0         34.0     680.74\n2         363360.0          NaN      47.63\n3          60157.0          7.0     284.60\n4          49212.0         22.0     302.33\n5         102933.0         85.0     446.28\n6         322543.0         34.0     443.03\n7         195547.0         94.0     836.88\n8          56849.0         82.0     802.79\n9         172074.0         70.0     515.98\n10        194820.0          1.0     393.96\n11        296530.0         19.0     281.08\n12        142877.0         20.0     265.79\n13        127766.0         14.0     553.05\n14        487337.0          1.0     286.58\n15             NaN         62.0  241595.58\n16        443260.0         26.0     382.64\n17          5924.0         73.0     685.71\n18        171731.0        100.0     373.06\n...*/"
    },
    {
        "input": "-- end template query24.tpl query 92 in stream 0\n-- start template query24.tpl query 92 in stream 0\nwith /* TPC-DS query24.tpl 0.92 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(SS_SALES_PRICE) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\n  and s_market_id = 5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect * from ssales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" AS \"I_UNITS\" , \"ITEM\".\"I_SIZE\" AS \"I_SIZE\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SSALES\".\"CA_STATE\" AS \"CA_STATE\" , \"SSALES\".\"S_STATE\" AS \"S_STATE\" , \"SSALES\".\"I_COLOR\" AS \"I_COLOR\" , \"SSALES\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SSALES\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SSALES\".\"I_UNITS\" AS \"I_UNITS\" , \"SSALES\".\"I_SIZE\" AS \"I_SIZE\" , \"SSALES\".\"NETPAID\" AS \"NETPAID\" FROM \"SSALES\" AS \"SSALES\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" AS \"I_UNITS\" , \"ITEM\".\"I_SIZE\" AS \"I_SIZE\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.247555,
                    "execution_time": 0.129126,
                    "compile_time": 0.000693,
                    "planning_time": 0.072076,
                    "create_size": 112
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.399531,
                    "execution_time": 2.069485,
                    "compile_time": 0.116175,
                    "planning_time": 0.162152,
                    "create_size": 112
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_COLOR\" AS \"I_COLOR\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_UNITS\" AS \"I_UNITS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_SIZE\" AS \"I_SIZE\" , \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name s_store_name ca_state s_state  i_color  i_current_price  i_manager_id  i_units       i_size  netpaid\n0        White      Dolores         able       GA      AL     peru             3.52           100  Unknown       medium    51.46\n1      Ballard    Elizabeth          ese       FL      AL   tomato             1.00            40       Lb          N/A   187.16\n2     Thompson       Joshua          ese       FL      AL   medium             0.69            29    Gross          N/A    14.85\n3       Brooks         Sara         able       FL      AL    steel             0.79            25    Bunch          N/A    50.13\n4      Collins      Raymond        ation       TN      TN    linen             2.14            11      Box  extra large     0.26\n5        Clark     Kimberly          ese       GA      AL    smoke             1.52            57    Ounce          N/A    59.41\n6     Robinson        Julia         eing       WI      SD     lime             4.70            52     Gram       medium    99.47\n7       Walker      Roxanne         able       FL      AL   yellow             7.84            37     Gram          N/A    80.21\n8        White      Russell         anti       AL      AL   salmon             3.53            82     Dram          N/A    18.96\n9    Rodriguez       Edward         anti       TN      AL     rosy             2.29            12     Dram          N/A    34.96\n10     Roberts     Jennifer        cally       AL      TN    blush            87.87            27    Pound          N/A   131.49\n11       Sykes         Rita         anti       AL      AL   salmon             9.10             2     Gram          N/A    16.86\n12    Simpkins     Margaret         eing       MS      SD   orchid             0.79            28   Carton       medium    23.14\n13     Edwards         Matt          pri       GA      AL    white             2.94            29     Case  extra large    65.97\n14   Nicholson        Randy        ation       AL      TN     pale             3.91            71     Case        large    26.19\n15        Dick      Beverly        cally       AL      TN   sienna             4.21            25    Ounce        large    43.57\n16      Miller      Charles         able       TN      AL    wheat             3.99            10    Gross          N/A    26.99\n17     Borrego       Edward          pri       TN      AL   yellow             0.86            50       Oz          N/A     2.45\n18        Wang    Priscilla          ese       GA      AL  chiffon             8.06             8     Gram          N/A    23.60\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019924,
                    "execution_time": 0.008033,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.004998
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05753,
                    "execution_time": 0.00804,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.040741
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_COLOR\" AS \"I_COLOR\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_UNITS\" AS \"I_UNITS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_SIZE\" AS \"I_SIZE\" , \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_COLOR\" AS \"I_COLOR\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_UNITS\" AS \"I_UNITS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_SIZE\" AS \"I_SIZE\" , \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name s_store_name ca_state s_state  i_color  i_current_price  i_manager_id  i_units       i_size  netpaid\n0        White      Dolores         able       GA      AL     peru             3.52           100  Unknown       medium    51.46\n1      Ballard    Elizabeth          ese       FL      AL   tomato             1.00            40       Lb          N/A   187.16\n2     Thompson       Joshua          ese       FL      AL   medium             0.69            29    Gross          N/A    14.85\n3       Brooks         Sara         able       FL      AL    steel             0.79            25    Bunch          N/A    50.13\n4      Collins      Raymond        ation       TN      TN    linen             2.14            11      Box  extra large     0.26\n5        Clark     Kimberly          ese       GA      AL    smoke             1.52            57    Ounce          N/A    59.41\n6     Robinson        Julia         eing       WI      SD     lime             4.70            52     Gram       medium    99.47\n7       Walker      Roxanne         able       FL      AL   yellow             7.84            37     Gram          N/A    80.21\n8        White      Russell         anti       AL      AL   salmon             3.53            82     Dram          N/A    18.96\n9    Rodriguez       Edward         anti       TN      AL     rosy             2.29            12     Dram          N/A    34.96\n10     Roberts     Jennifer        cally       AL      TN    blush            87.87            27    Pound          N/A   131.49\n11       Sykes         Rita         anti       AL      AL   salmon             9.10             2     Gram          N/A    16.86\n12    Simpkins     Margaret         eing       MS      SD   orchid             0.79            28   Carton       medium    23.14\n13     Edwards         Matt          pri       GA      AL    white             2.94            29     Case  extra large    65.97\n14   Nicholson        Randy        ation       AL      TN     pale             3.91            71     Case        large    26.19\n15        Dick      Beverly        cally       AL      TN   sienna             4.21            25    Ounce        large    43.57\n16      Miller      Charles         able       TN      AL    wheat             3.99            10    Gross          N/A    26.99\n17     Borrego       Edward          pri       TN      AL   yellow             0.86            50       Oz          N/A     2.45\n18        Wang    Priscilla          ese       GA      AL  chiffon             8.06             8     Gram          N/A    23.60\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- end template query24.tpl query 92 in stream 0\n-- start template query24.tpl query 92 in stream 0\nwith /* TPC-DS query24.tpl 0.92 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\nand s_market_id=5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\n/*CURSOR_IDENTIFIER*/\nselect * from ssales",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"STORE\".\"S_STATE\" AS \"S_STATE\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" AS \"I_UNITS\" , \"ITEM\".\"I_SIZE\" AS \"I_SIZE\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SSALES\".\"CA_STATE\" AS \"CA_STATE\" , \"SSALES\".\"S_STATE\" AS \"S_STATE\" , \"SSALES\".\"I_COLOR\" AS \"I_COLOR\" , \"SSALES\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SSALES\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SSALES\".\"I_UNITS\" AS \"I_UNITS\" , \"SSALES\".\"I_SIZE\" AS \"I_SIZE\" , \"SSALES\".\"NETPAID\" AS \"NETPAID\" FROM \"SSALES\" AS \"SSALES\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_COLOR\" AS \"I_COLOR\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_UNITS\" AS \"I_UNITS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_SIZE\" AS \"I_SIZE\" , \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name s_store_name ca_state s_state   i_color  i_current_price  i_manager_id  i_units       i_size  netpaid\n0      Samuels       Robert         eing       MN      SD   thistle             2.64             9    Bunch          N/A    89.27\n1      Samuels       Robert         eing       MN      SD      peru             1.66            25      N/A        small    29.10\n2        Scott           Ma          pri       TN      AL    papaya            56.34            39  Unknown          N/A     0.63\n3        Clark     Kimberly          ese       GA      AL     smoke             9.40            33      N/A          N/A     7.00\n4        Clark     Kimberly          ese       GA      AL    saddle             2.67            89      Tbl          N/A     8.38\n5      Webster        Amber         anti       GA      AL     khaki             4.35            51      Box          N/A    25.84\n6      Parrish      Phillip          ese       GA      AL    floral             5.88            78    Gross      economy    44.81\n7        Nieto        Robyn          pri       GA      AL  seashell             7.81            62     Each          N/A    49.02\n8         Neff       Ronald          ese       GA      AL     steel             0.99            57     Gram          N/A     0.55\n9      Woodard         John         eing       SD      SD     lemon             0.91            25      Box          N/A     1.56\n10   Mccloskey        Betty         able       AL      AL  seashell             7.17             2     Gram          N/A    43.88\n11     Gooding     Jeremiah          pri       FL      AL    maroon            37.15            58     Dram        large    59.29\n12     Simpson      Sabrina         eing       IA      SD     beige             1.41            86   Pallet        large     6.07\n13      Dalton     Lawrence         able       TN      AL     brown             5.39            14  Unknown        large    35.16\n14     England        Ralph        cally       AL      TN     khaki             1.79            22     Each  extra large    27.55\n15   Fernandez    Cassandra         able       GA      AL       red             2.06            53       Oz          N/A    28.42\n16        Moon         Anne         anti       TN      AL     ghost             3.40            11      N/A          N/A    49.28\n17    Simpkins     Margaret         eing       MS      SD      puff             8.25            49      Ton        large    11.39\n18      Galvan       Lenora        cally       MS      SD      pink             5.84            48      Cup      economy    65.38\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019928,
                    "execution_time": 0.00772,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.004981
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020223,
                    "execution_time": 0.008129,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.004999
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_COLOR\" AS \"I_COLOR\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_UNITS\" AS \"I_UNITS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_SIZE\" AS \"I_SIZE\" , \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STATE\" AS \"S_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_COLOR\" AS \"I_COLOR\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_MANAGER_ID\" AS \"I_MANAGER_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_UNITS\" AS \"I_UNITS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_SIZE\" AS \"I_SIZE\" , \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name s_store_name ca_state s_state   i_color  i_current_price  i_manager_id  i_units       i_size  netpaid\n0      Samuels       Robert         eing       MN      SD   thistle             2.64             9    Bunch          N/A    89.27\n1      Samuels       Robert         eing       MN      SD      peru             1.66            25      N/A        small    29.10\n2        Scott           Ma          pri       TN      AL    papaya            56.34            39  Unknown          N/A     0.63\n3        Clark     Kimberly          ese       GA      AL     smoke             9.40            33      N/A          N/A     7.00\n4        Clark     Kimberly          ese       GA      AL    saddle             2.67            89      Tbl          N/A     8.38\n5      Webster        Amber         anti       GA      AL     khaki             4.35            51      Box          N/A    25.84\n6      Parrish      Phillip          ese       GA      AL    floral             5.88            78    Gross      economy    44.81\n7        Nieto        Robyn          pri       GA      AL  seashell             7.81            62     Each          N/A    49.02\n8         Neff       Ronald          ese       GA      AL     steel             0.99            57     Gram          N/A     0.55\n9      Woodard         John         eing       SD      SD     lemon             0.91            25      Box          N/A     1.56\n10   Mccloskey        Betty         able       AL      AL  seashell             7.17             2     Gram          N/A    43.88\n11     Gooding     Jeremiah          pri       FL      AL    maroon            37.15            58     Dram        large    59.29\n12     Simpson      Sabrina         eing       IA      SD     beige             1.41            86   Pallet        large     6.07\n13      Dalton     Lawrence         able       TN      AL     brown             5.39            14  Unknown        large    35.16\n14     England        Ralph        cally       AL      TN     khaki             1.79            22     Each  extra large    27.55\n15   Fernandez    Cassandra         able       GA      AL       red             2.06            53       Oz          N/A    28.42\n16        Moon         Anne         anti       TN      AL     ghost             3.40            11      N/A          N/A    49.28\n17    Simpkins     Margaret         eing       MS      SD      puff             8.25            49      Ton        large    11.39\n18      Galvan       Lenora        cally       MS      SD      pink             5.84            48      Cup      economy    65.38\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "with /* TPC-DS query24.tpl 0.92 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(SS_SALES_PRICE) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\nand s_market_id=5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.065185,
                    "execution_time": 0.035411,
                    "compile_time": 0.000261,
                    "planning_time": 0.003815,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.128587,
                    "execution_time": 0.036322,
                    "compile_time": 0.000264,
                    "planning_time": 0.061202,
                    "create_size": 21
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_5\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" GROUP BY \"SPEQLITE_TEMP_TABLE_5\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.070739,
                    "execution_time": 0.037847,
                    "compile_time": 0.000314,
                    "planning_time": 0.004522,
                    "create_size": 7
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.135752,
                    "execution_time": 0.038218,
                    "compile_time": 0.000306,
                    "planning_time": 0.063734,
                    "create_size": 7
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name s_store_name    paid\n0         Dick      Beverly        cally  176.74\n1        Lerma       Tyrone        ation  165.49\n2       Gordon      Timothy         able   61.12\n3     Martinez         Mark          ese   81.59\n4     Matthews        Joann         anti    1.59\n5         Head         Gwen         anti   16.38\n6        Brady    Alexander        ation   58.88\n7       Moreno        Sonia        ation  103.10\n8    Mccloskey        Betty         able  192.36\n9     Williams         Lisa        cally   95.92\n10       Colon        Lloyd         anti    9.02\n11       Payne      Charles         able   56.51\n12        Mark        Debra        cally   29.83\n13    Castillo       Harold        cally   63.40\n14  Huddleston       Arnold         able   36.84\n15        Hart         Sara         anti   13.11\n16     Ledford    Margarete        ation   64.62\n17      Taylor       Harold         anti   72.84\n18   Mccormick      Bernard         able   48.09\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016779,
                    "execution_time": 0.007081,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003667
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055697,
                    "execution_time": 0.007714,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039069
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_5\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" GROUP BY \"SPEQLITE_TEMP_TABLE_5\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name s_store_name    paid\n0         Dick      Beverly        cally  176.74\n1        Lerma       Tyrone        ation  165.49\n2       Gordon      Timothy         able   61.12\n3     Martinez         Mark          ese   81.59\n4     Matthews        Joann         anti    1.59\n5         Head         Gwen         anti   16.38\n6        Brady    Alexander        ation   58.88\n7       Moreno        Sonia        ation  103.10\n8    Mccloskey        Betty         able  192.36\n9     Williams         Lisa        cally   95.92\n10       Colon        Lloyd         anti    9.02\n11       Payne      Charles         able   56.51\n12        Mark        Debra        cally   29.83\n13    Castillo       Harold        cally   63.40\n14  Huddleston       Arnold         able   36.84\n15        Hart         Sara         anti   13.11\n16     Ledford    Margarete        ation   64.62\n17      Taylor       Harold         anti   72.84\n18   Mccormick      Bernard         able   48.09\n...*/"
    },
    {
        "input": "-- end template query24.tpl query 92 in stream 0\n-- start template query24.tpl query 92 in stream 0\nwith /* TPC-DS query24.tpl 0.92 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\nand s_market_id=5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name,\n      c_first_name,\n      s_store_name,\n      sum(netpaid) paid\nfrom ssales\nwhere i_color = 'gainsboro'\n  group by c_last_name,\n        c_first_name,\n        s_store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" WHERE \"SSALES\".\"I_COLOR\" = 'gainsboro' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_COLOR\" AS \"I_COLOR\" , \"SPEQLITE_TEMP_TABLE_4\".\"NETPAID\" AS \"NETPAID\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.066236,
                    "execution_time": 0.035916,
                    "compile_time": 0.000266,
                    "planning_time": 0.003929,
                    "create_size": 24
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.126588,
                    "execution_time": 0.036519,
                    "compile_time": 0.000256,
                    "planning_time": 0.060657,
                    "create_size": 24
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"I_COLOR\" = 'gainsboro' GROUP BY \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.072204,
                    "execution_time": 0.038337,
                    "compile_time": 0.00033,
                    "planning_time": 0.005413,
                    "create_size": 7
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.134517,
                    "execution_time": 0.037362,
                    "compile_time": 0.000307,
                    "planning_time": 0.06362,
                    "create_size": 7
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0      Burris       Pamela          ese  70.43\n1       Hodge      Richard        cally  49.28*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017355,
                    "execution_time": 0.007475,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003648
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056633,
                    "execution_time": 0.007299,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.03913
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"I_COLOR\" = 'gainsboro' GROUP BY \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0      Burris       Pamela          ese  70.43\n1       Hodge      Richard        cally  49.28*/"
    },
    {
        "input": "-- end template query24.tpl query 92 in stream 0\n-- start template query24.tpl query 92 in stream 0\nwith /* TPC-DS query24.tpl 0.92 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    join store_returns on ss_ticket_number = sr_ticket_number and ss_item_sk = sr_item_sk\n    join store on ss_store_sk = s_store_sk\n    join item on ss_item_sk = i_item_sk\n    join customer on ss_customer_sk = c_customer_sk\n    join customer_address on c_current_addr_sk = ca_address_sk\nwhere c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\nand s_market_id=5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'gainsboro'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" WHERE \"SSALES\".\"I_COLOR\" = 'gainsboro' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0      Burris       Pamela          ese  70.43\n1       Hodge      Richard        cally  49.28*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016505,
                    "execution_time": 0.006733,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003599
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052756,
                    "execution_time": 0.007758,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.03882
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"I_COLOR\" = 'gainsboro' GROUP BY \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\"",
                "rewrite": "SELECT \"C_LAST_NAME\" AS \"C_LAST_NAME\", \"C_FIRST_NAME\" AS \"C_FIRST_NAME\", \"S_STORE_NAME\" AS \"S_STORE_NAME\", \"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0      Burris       Pamela          ese  70.43\n1       Hodge      Richard        cally  49.28*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- end template query24.tpl query 92 in stream 0\n-- start template query24.tpl query 92 in stream 0\nwith /* TPC-DS query24.tpl 0.92 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\nand s_market_id=5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'gainsboro'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" WHERE \"SSALES\".\"I_COLOR\" = 'gainsboro' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0      Burris       Pamela          ese  70.43\n1       Hodge      Richard        cally  49.28*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017974,
                    "execution_time": 0.006827,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.00415
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017016,
                    "execution_time": 0.007192,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003638
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"I_COLOR\" = 'gainsboro' GROUP BY \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\"",
                "rewrite": "SELECT \"C_LAST_NAME\" AS \"C_LAST_NAME\", \"C_FIRST_NAME\" AS \"C_FIRST_NAME\", \"S_STORE_NAME\" AS \"S_STORE_NAME\", \"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0      Burris       Pamela          ese  70.43\n1       Hodge      Richard        cally  49.28*/"
    },
    {
        "input": "-- end template query24.tpl query 92 in stream 0\n-- start template query24.tpl query 92 in stream 0\nwith /* TPC-DS query24.tpl 0.92 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) as netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\nand s_market_id=5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) as paid\nfrom ssales\nwhere i_color = 'gainsboro'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\nhaving sum(netpaid) > (select 0.05*avg(netpaid) from ssales)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) , \"_U_0\" AS ( SELECT 0.05 * AVG ( \"SSALES\".\"NETPAID\" ) AS \"_COL_0\" FROM \"SSALES\" AS \"SSALES\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"SSALES\".\"I_COLOR\" = 'gainsboro' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" HAVING MAX ( \"_U_0\".\"_COL_0\" ) < SUM ( \"SSALES\".\"NETPAID\" )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT 0.05 * AVG ( \"SPEQLITE_TEMP_TABLE_7\".\"NETPAID\" ) AS \"_COL_0\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.069389,
                    "execution_time": 0.038127,
                    "compile_time": 0.000347,
                    "planning_time": 0.003829,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.128241,
                    "execution_time": 0.037661,
                    "compile_time": 0.000301,
                    "planning_time": 0.062634,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"I_COLOR\" = 'gainsboro' GROUP BY \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" ) < SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"NETPAID\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.081226,
                    "execution_time": 0.046271,
                    "compile_time": 0.000367,
                    "planning_time": 0.006988,
                    "create_size": 7
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.143047,
                    "execution_time": 0.04623,
                    "compile_time": 0.000363,
                    "planning_time": 0.06738,
                    "create_size": 7
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0       Hodge      Richard        cally  49.28\n1      Burris       Pamela          ese  70.43*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016885,
                    "execution_time": 0.007169,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003621
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054151,
                    "execution_time": 0.00779,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039822
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"I_COLOR\" = 'gainsboro' GROUP BY \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" ) < SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"NETPAID\" )",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0       Hodge      Richard        cally  49.28\n1      Burris       Pamela          ese  70.43*/"
    },
    {
        "input": "-- end template query24.tpl query 92 in stream 0\n-- start template query24.tpl query 92 in stream 0\nwith /* TPC-DS query24.tpl 0.92 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\nand s_market_id=5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'gainsboro'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\n                                 from ssales)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) , \"_U_0\" AS ( SELECT 0.05 * AVG ( \"SSALES\".\"NETPAID\" ) AS \"_COL_0\" FROM \"SSALES\" AS \"SSALES\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"SSALES\".\"I_COLOR\" = 'gainsboro' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" HAVING MAX ( \"_U_0\".\"_COL_0\" ) < SUM ( \"SSALES\".\"NETPAID\" )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0       Hodge      Richard        cally  49.28\n1      Burris       Pamela          ese  70.43*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016861,
                    "execution_time": 0.007227,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003557
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053,
                    "execution_time": 0.007149,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039689
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"I_COLOR\" = 'gainsboro' GROUP BY \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" ) < SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"NETPAID\" )",
                "rewrite": "SELECT \"C_LAST_NAME\" AS \"C_LAST_NAME\", \"C_FIRST_NAME\" AS \"C_FIRST_NAME\", \"S_STORE_NAME\" AS \"S_STORE_NAME\", \"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0       Hodge      Richard        cally  49.28\n1      Burris       Pamela          ese  70.43*/"
    },
    {
        "input": "-- end template query24.tpl query 92 in stream 0\n-- start template query24.tpl query 92 in stream 0\nwith /* TPC-DS query24.tpl 0.92 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\nand s_market_id=5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'gainsboro'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\n                                 from ssales)\norder by c_last_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) , \"_U_0\" AS ( SELECT 0.05 * AVG ( \"SSALES\".\"NETPAID\" ) AS \"_COL_0\" FROM \"SSALES\" AS \"SSALES\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"SSALES\".\"I_COLOR\" = 'gainsboro' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" HAVING MAX ( \"_U_0\".\"_COL_0\" ) < SUM ( \"SSALES\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ORDER BY \"C_LAST_NAME\" LIMIT 21",
                "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0      Burris       Pamela          ese  70.43\n1       Hodge      Richard        cally  49.28*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017154,
                    "execution_time": 0.007641,
                    "compile_time": 6.9e-05,
                    "planning_time": 0.003573
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057266,
                    "execution_time": 0.008473,
                    "compile_time": 8e-05,
                    "planning_time": 0.039612
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"I_COLOR\" = 'gainsboro' GROUP BY \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" ) < SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ORDER BY \"C_LAST_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0      Burris       Pamela          ese  70.43\n1       Hodge      Richard        cally  49.28*/"
    },
    {
        "input": "-- end template query24.tpl query 92 in stream 0\n-- start template query24.tpl query 92 in stream 0\nwith /* TPC-DS query24.tpl 0.92 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\nand s_market_id=5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'gainsboro'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\n                                 from ssales)\norder by c_last_name\n        ,c_first_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) , \"_U_0\" AS ( SELECT 0.05 * AVG ( \"SSALES\".\"NETPAID\" ) AS \"_COL_0\" FROM \"SSALES\" AS \"SSALES\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"SSALES\".\"I_COLOR\" = 'gainsboro' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" HAVING MAX ( \"_U_0\".\"_COL_0\" ) < SUM ( \"SSALES\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ORDER BY \"C_LAST_NAME\" , \"C_FIRST_NAME\" LIMIT 21",
                "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0      Burris       Pamela          ese  70.43\n1       Hodge      Richard        cally  49.28*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018161,
                    "execution_time": 0.00784,
                    "compile_time": 8.2e-05,
                    "planning_time": 0.003964
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056473,
                    "execution_time": 0.009074,
                    "compile_time": 8.6e-05,
                    "planning_time": 0.040733
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"I_COLOR\" = 'gainsboro' GROUP BY \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" ) < SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0      Burris       Pamela          ese  70.43\n1       Hodge      Richard        cally  49.28*/"
    },
    {
        "input": "-- end template query24.tpl query 92 in stream 0\n-- start template query24.tpl query 92 in stream 0\nwith /* TPC-DS query24.tpl 0.92 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\nand s_market_id=5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'gainsboro'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\n                                 from ssales)\norder by c_last_name\n        ,c_first_name\n        ,s_store_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) , \"_U_0\" AS ( SELECT 0.05 * AVG ( \"SSALES\".\"NETPAID\" ) AS \"_COL_0\" FROM \"SSALES\" AS \"SSALES\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"SSALES\".\"I_COLOR\" = 'gainsboro' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" HAVING MAX ( \"_U_0\".\"_COL_0\" ) < SUM ( \"SSALES\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"S_STORE_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ORDER BY \"C_LAST_NAME\" , \"C_FIRST_NAME\" , \"S_STORE_NAME\" LIMIT 21",
                "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0      Burris       Pamela          ese  70.43\n1       Hodge      Richard        cally  49.28*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018659,
                    "execution_time": 0.008495,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.003973
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057843,
                    "execution_time": 0.008605,
                    "compile_time": 7.7e-05,
                    "planning_time": 0.042951
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"I_COLOR\" = 'gainsboro' GROUP BY \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" ) < SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"S_STORE_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"S_STORE_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0      Burris       Pamela          ese  70.43\n1       Hodge      Richard        cally  49.28*/"
    },
    {
        "input": "-- end template query24.tpl query 92 in stream 0\n-- start template query24.tpl query 92 in stream 0\nwith /* TPC-DS query24.tpl 0.92 */ ssales as\n(select c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,ca_state\n      ,s_state\n      ,i_color\n      ,i_current_price\n      ,i_manager_id\n      ,i_units\n      ,i_size\n      ,sum(ss_sales_price) netpaid\nfrom store_sales\n    ,store_returns\n    ,store\n    ,item\n    ,customer\n    ,customer_address\nwhere ss_ticket_number = sr_ticket_number\n  and ss_item_sk = sr_item_sk\n  and ss_customer_sk = c_customer_sk\n  and ss_item_sk = i_item_sk\n  and ss_store_sk = s_store_sk\n  and c_current_addr_sk = ca_address_sk\n  and c_birth_country <> upper(ca_country)\n  and s_zip = ca_zip\nand s_market_id=5\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\n        ,ca_state\n        ,s_state\n        ,i_color\n        ,i_current_price\n        ,i_manager_id\n        ,i_units\n        ,i_size)\nselect c_last_name\n      ,c_first_name\n      ,s_store_name\n      ,sum(netpaid) paid\nfrom ssales\nwhere i_color = 'gainsboro'\ngroup by c_last_name\n        ,c_first_name\n        ,s_store_name\nhaving sum(netpaid) > (select 0.05*avg(netpaid)\n                                 from ssales)\norder by c_last_name\n        ,c_first_name\n        ,s_store_name\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SSALES\" AS ( SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_COLOR\" AS \"I_COLOR\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"NETPAID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_MARKET_ID\" = 5 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_BIRTH_COUNTRY\" <> UPPER ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" ) AND \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_ZIP\" = \"STORE\".\"S_ZIP\" GROUP BY \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"STORE\".\"S_STORE_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" , \"STORE\".\"S_STATE\" , \"ITEM\".\"I_COLOR\" , \"ITEM\".\"I_CURRENT_PRICE\" , \"ITEM\".\"I_MANAGER_ID\" , \"ITEM\".\"I_UNITS\" , \"ITEM\".\"I_SIZE\" ) , \"_U_0\" AS ( SELECT 0.05 * AVG ( \"SSALES\".\"NETPAID\" ) AS \"_COL_0\" FROM \"SSALES\" AS \"SSALES\" ) SELECT \"SSALES\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SSALES\".\"NETPAID\" ) AS \"PAID\" FROM \"SSALES\" AS \"SSALES\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"SSALES\".\"I_COLOR\" = 'gainsboro' GROUP BY \"SSALES\".\"C_LAST_NAME\" , \"SSALES\".\"C_FIRST_NAME\" , \"SSALES\".\"S_STORE_NAME\" HAVING MAX ( \"_U_0\".\"_COL_0\" ) < SUM ( \"SSALES\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"S_STORE_NAME\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ORDER BY \"C_LAST_NAME\" , \"C_FIRST_NAME\" , \"S_STORE_NAME\" LIMIT 21",
                "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0      Burris       Pamela          ese  70.43\n1       Hodge      Richard        cally  49.28*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018496,
                    "execution_time": 0.008489,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.003946
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018129,
                    "execution_time": 0.007868,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.004065
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"NETPAID\" ) AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"I_COLOR\" = 'gainsboro' GROUP BY \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" ) < SUM ( \"SPEQLITE_TEMP_TABLE_7\".\"NETPAID\" ) ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"S_STORE_NAME\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"PAID\" AS \"PAID\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"S_STORE_NAME\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*  c_last_name c_first_name s_store_name   paid\n0      Burris       Pamela          ese  70.43\n1       Hodge      Richard        cally  49.28*/"
    }
]