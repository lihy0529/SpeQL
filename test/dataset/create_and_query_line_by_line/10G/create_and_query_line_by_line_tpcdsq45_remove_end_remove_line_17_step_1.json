[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price) \n from web_sales, customer, customer_address, date_dim, item group by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\", SUM(\"WEB_SALES\".\"WS_SALES_PRICE\") AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk group by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\", SUM(\"WEB_SALES\".\"WS_SALES_PRICE\") AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk\ngroup by ca_zip, ca_state /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\", SUM(\"WEB_SALES\".\"WS_SALES_PRICE\") AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk group by ca_zip, ca_state \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\", SUM(\"WEB_SALES\".\"WS_SALES_PRICE\") AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792'))\n group by ca_zip, ca_state \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.381892,
                    "execution_time": 0.275642,
                    "compile_time": 0.000609,
                    "planning_time": 0.061531,
                    "create_size": 24
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.466917,
                    "execution_time": 0.277159,
                    "compile_time": 0.000536,
                    "planning_time": 0.145382,
                    "create_size": 24
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*  ca_zip ca_state        _col_2\n0  85669       WY  4.578551e+08\n1  85669       CO  4.288670e+08\n2  85669       ID  5.530759e+08\n3  88274       WY  9.745686e+07\n4  80348       ID  4.110569e+08\n5  85669       UT  2.926781e+07\n6  86475       CO  2.636477e+08\n7  81792       ID  9.677166e+07*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016841,
                    "execution_time": 0.007723,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003246
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054748,
                    "execution_time": 0.007517,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.038339
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\", SUM(\"WEB_SALES\".\"WS_SALES_PRICE\") AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND SUBSTRING(\"CUSTOMER_ADDRESS\".\"CA_ZIP\", 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792') GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*  ca_zip ca_state        _col_2\n0  85669       WY  4.578551e+08\n1  85669       CO  4.288670e+08\n2  85669       ID  5.530759e+08\n3  88274       WY  9.745686e+07\n4  80348       ID  4.110569e+08\n5  85669       UT  2.926781e+07\n6  86475       CO  2.636477e+08\n7  81792       ID  9.677166e+07*/"
    },
    {
        "input": "select /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n/*CURSOR_IDENTIFIER*/\n )\n group by ca_zip, ca_state",
        "optimize": [
            "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CA_ZIP\" AS \"CA_ZIP\" , \"CA_STATE\" AS \"CA_STATE\" , \"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*  ca_zip ca_state        _col_2\n0  86475       CO  2.636477e+08\n1  81792       ID  9.677166e+07\n2  85669       CO  4.288670e+08\n3  85669       ID  5.530759e+08\n4  88274       WY  9.745686e+07\n5  85669       WY  4.578551e+08\n6  80348       ID  4.110569e+08\n7  85669       UT  2.926781e+07*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015917,
                    "execution_time": 0.006718,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003274
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051444,
                    "execution_time": 0.00694,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.038427
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\", SUM(\"WEB_SALES\".\"WS_SALES_PRICE\") AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND SUBSTRING(\"CUSTOMER_ADDRESS\".\"CA_ZIP\", 1, 5) IN ('85669', '86197', '88274', '83405', '86475', '85392', '85460', '80348', '81792') GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\", \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"CA_ZIP\" AS \"CA_ZIP\", \"CA_STATE\" AS \"CA_STATE\", \"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*  ca_zip ca_state        _col_2\n0  86475       CO  2.636477e+08\n1  81792       ID  9.677166e+07\n2  85669       CO  4.288670e+08\n3  85669       ID  5.530759e+08\n4  88274       WY  9.745686e+07\n5  85669       WY  4.578551e+08\n6  80348       ID  4.110569e+08\n7  85669       UT  2.926781e+07*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "select /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n \t      or \n \t      i_item_id in (select i_item_id\n                             from item\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)))\n group by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.089418,
                    "execution_time": 0.035713,
                    "compile_time": 0.000283,
                    "planning_time": 0.027756,
                    "create_size": 36
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.15669,
                    "execution_time": 0.035865,
                    "compile_time": 0.000284,
                    "planning_time": 0.091928,
                    "create_size": 36
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" FROM 1 FOR 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "select /* TPC-DS query45.tpl 0.18 */ NULL as ca_zip, NULL as ca_state, sum(i_current_price) as ws_sales_price\n from item\n where i_item_id in (select i_item_id\n                     from item\n                     where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n                     )\n and substring(NULL,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT NULL AS \"CA_ZIP\" , NULL AS \"CA_STATE\" , SUM ( \"ITEM\".\"I_CURRENT_PRICE\" ) AS \"WS_SALES_PRICE\" FROM \"ITEM\" AS \"ITEM\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL AND SUBSTRING ( NULL , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT NULL AS \"CA_ZIP\" , NULL AS \"CA_STATE\" , SUM ( \"ITEM\".\"I_CURRENT_PRICE\" ) AS \"WS_SALES_PRICE\" FROM \"ITEM\" AS \"ITEM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL AND SUBSTRING ( NULL , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.094127,
                    "execution_time": 0.033988,
                    "compile_time": 0.000305,
                    "planning_time": 0.033099,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.158638,
                    "execution_time": 0.034022,
                    "compile_time": 0.000308,
                    "planning_time": 0.093553,
                    "create_size": 6
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"WS_SALES_PRICE\" AS \"WS_SALES_PRICE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*  ca_zip ca_state ws_sales_price\n0   None     None           None*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016299,
                    "execution_time": 0.006892,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003328
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053236,
                    "execution_time": 0.007178,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.03846
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT NULL AS \"CA_ZIP\" , NULL AS \"CA_STATE\" , SUM ( \"ITEM\".\"I_CURRENT_PRICE\" ) AS \"WS_SALES_PRICE\" FROM \"ITEM\" AS \"ITEM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL AND SUBSTRING ( NULL , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' )",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"WS_SALES_PRICE\" AS \"WS_SALES_PRICE\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*  ca_zip ca_state ws_sales_price\n0   None     None           None*/"
    },
    {
        "input": "select /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n \t      or \n \t      i_item_id in (select i_item_id\n                             from item\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n                             )\n \t    )\ngroup by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" FROM 1 FOR 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "select /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales\n join customer on ws_bill_customer_sk = c_customer_sk\n join customer_address on c_current_addr_sk = ca_address_sk \n join date_dim on ws_sold_date_sk = d_date_sk\n join item on ws_item_sk = i_item_sk \n where ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n \t      or \n \t      i_item_id in (select i_item_id\n                             from item\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n                             )\n \t    )\n group by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.455631,
                    "execution_time": 1.305819,
                    "compile_time": 0.032229,
                    "planning_time": 0.074277,
                    "create_size": 48
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.037311,
                    "execution_time": 1.30947,
                    "compile_time": 3.518718,
                    "planning_time": 0.157336,
                    "create_size": 48
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*   ca_zip ca_state  _col_2\n0   19303       PA   13.77\n1   77683       TX   39.67\n2   58811       MS   47.28\n3   61711       MO   67.86\n4   98721       CA   50.49\n5   51749       IA   40.50\n6   09603       CT   25.08\n7   76614       AR   97.83\n8   26719       VA  113.84\n9   59003       IA   19.31\n10  63604       KS   45.76\n11  42293       MI    1.83\n12  80499       AZ   99.80\n13  66557       MO  140.62\n14  45124       KY   15.80\n15  49310       MI   58.90\n16  20162       NC   28.00\n17  16871       NY  204.49\n18  93604       WA   41.61\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016525,
                    "execution_time": 0.007195,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003238
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055551,
                    "execution_time": 0.007797,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.038623
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*   ca_zip ca_state  _col_2\n0   19303       PA   13.77\n1   77683       TX   39.67\n2   58811       MS   47.28\n3   61711       MO   67.86\n4   98721       CA   50.49\n5   51749       IA   40.50\n6   09603       CT   25.08\n7   76614       AR   97.83\n8   26719       VA  113.84\n9   59003       IA   19.31\n10  63604       KS   45.76\n11  42293       MI    1.83\n12  80499       AZ   99.80\n13  66557       MO  140.62\n14  45124       KY   15.80\n15  49310       MI   58.90\n16  20162       NC   28.00\n17  16871       NY  204.49\n18  93604       WA   41.61\n...*/"
    },
    {
        "input": "select /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n \t      or \n \t      i_item_id in (select i_item_id\n                             from item\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n                             )\n \t    )\n \tand ws_sold_date_sk = d_date_sk\n \tand d_qoy = 1 and d_year = 2000\n group by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.32885,
                    "execution_time": 0.105195,
                    "compile_time": 0.108523,
                    "planning_time": 0.079097,
                    "create_size": 48
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.469935,
                    "execution_time": 0.134237,
                    "compile_time": 6.131693,
                    "planning_time": 0.158084,
                    "create_size": 48
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   ca_zip ca_state  _col_2\n0   51749       SD    4.60\n1   59237       MN    0.15\n2   23425       WV   13.16\n3   30411       AL    4.34\n4   43683       MI  142.64\n5   69101       KS   98.69\n6   49584       OH   10.97\n7   60150       NE   45.35\n8   34975       TN   60.39\n9   69303       IL   22.65\n10  70069       LA   11.08\n11  89840       UT    5.29\n12  57936       WI    0.23\n13  79532       TX   14.64\n14  92812       WA   33.53\n15  85669       ID  892.87\n16  54338       WI   62.91\n17  49275       IN   24.15\n18  56871       IA   13.45\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016454,
                    "execution_time": 0.007243,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003309
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054567,
                    "execution_time": 0.007172,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038389
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   ca_zip ca_state  _col_2\n0   51749       SD    4.60\n1   59237       MN    0.15\n2   23425       WV   13.16\n3   30411       AL    4.34\n4   43683       MI  142.64\n5   69101       KS   98.69\n6   49584       OH   10.97\n7   60150       NE   45.35\n8   34975       TN   60.39\n9   69303       IL   22.65\n10  70069       LA   11.08\n11  89840       UT    5.29\n12  57936       WI    0.23\n13  79532       TX   14.64\n14  92812       WA   33.53\n15  85669       ID  892.87\n16  54338       WI   62.91\n17  49275       IN   24.15\n18  56871       IA   13.45\n...*/"
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n \t      or \n \t      i_item_id in (select i_item_id\n                             from item\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n                             )\n \t    )\n \tand ws_sold_date_sk = d_date_sk\n \tand d_qoy = 1 and d_year = 2000\n group by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CA_ZIP\" AS \"CA_ZIP\" , \"CA_STATE\" AS \"CA_STATE\" , \"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   ca_zip ca_state  _col_2\n0   60150       NE   45.35\n1   34975       TN   60.39\n2   51749       SD    4.60\n3   59237       MN    0.15\n4   69101       KS   98.69\n5   49584       OH   10.97\n6   23425       WV   13.16\n7   30411       AL    4.34\n8   43683       MI  142.64\n9   31933       GA    1.03\n10  60059       NE   43.01\n11  80348       ID  638.90\n12  85669       UT  400.66\n13  69532       NE   23.99\n14  54975       MN   12.30\n15  54338       WI   62.91\n16  49275       IN   24.15\n17  56871       IA   13.45\n18  13372       NY   32.42\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015981,
                    "execution_time": 0.006822,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003289
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051688,
                    "execution_time": 0.006997,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.038474
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "rewrite": "SELECT \"CA_ZIP\" AS \"CA_ZIP\", \"CA_STATE\" AS \"CA_STATE\", \"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   ca_zip ca_state  _col_2\n0   60150       NE   45.35\n1   34975       TN   60.39\n2   51749       SD    4.60\n3   59237       MN    0.15\n4   69101       KS   98.69\n5   49584       OH   10.97\n6   23425       WV   13.16\n7   30411       AL    4.34\n8   43683       MI  142.64\n9   31933       GA    1.03\n10  60059       NE   43.01\n11  80348       ID  638.90\n12  85669       UT  400.66\n13  69532       NE   23.99\n14  54975       MN   12.30\n15  54338       WI   62.91\n16  49275       IN   24.15\n17  56871       IA   13.45\n18  13372       NY   32.42\n...*/"
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n \t      or \n \t      i_item_id in (select i_item_id\n                             from item\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n                             )\n \t    )\n \tand ws_sold_date_sk = d_date_sk\n \tand d_qoy = 1 and d_year = 2000\n group by ca_zip, ca_state\n order by ca_zip, ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ORDER BY \"CA_ZIP\" NULLS LAST , \"CA_STATE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ORDER BY \"CA_ZIP\" , \"CA_STATE\" LIMIT 21",
                "preview": "\n/*   ca_zip ca_state  _col_2\n0   13372       NY   32.42\n1   20534       NC   11.89\n2   23425       WV   13.16\n3   30411       AL    4.34\n4   31933       GA    1.03\n5   34975       TN   60.39\n6   43683       MI  142.64\n7   44462       MI   31.04\n8   49275       IN   24.15\n9   49584       OH   10.97\n10  51749       SD    4.60\n11  54338       WI   62.91\n12  54975       MN   12.30\n13  56871       IA   13.45\n14  57936       WI    0.23\n15  59237       MN    0.15\n16  60059       NE   43.01\n17  60150       NE   45.35\n18  60411       MT   89.97\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017279,
                    "execution_time": 0.00801,
                    "compile_time": 6.9e-05,
                    "planning_time": 0.003475
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056495,
                    "execution_time": 0.008668,
                    "compile_time": 7.1e-05,
                    "planning_time": 0.038811
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ORDER BY \"CA_ZIP\" NULLS LAST , \"CA_STATE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ORDER BY \"CA_ZIP\" NULLS LAST , \"CA_STATE\" NULLS LAST"
            }
        ],
        "preview": "\n/*   ca_zip ca_state  _col_2\n0   13372       NY   32.42\n1   20534       NC   11.89\n2   23425       WV   13.16\n3   30411       AL    4.34\n4   31933       GA    1.03\n5   34975       TN   60.39\n6   43683       MI  142.64\n7   44462       MI   31.04\n8   49275       IN   24.15\n9   49584       OH   10.97\n10  51749       SD    4.60\n11  54338       WI   62.91\n12  54975       MN   12.30\n13  56871       IA   13.45\n14  57936       WI    0.23\n15  59237       MN    0.15\n16  60059       NE   43.01\n17  60150       NE   45.35\n18  60411       MT   89.97\n...*/"
    },
    {
        "input": "-- start template query45.tpl query 18 in stream 0\nselect /* TPC-DS query45.tpl 0.18 */ ca_zip, ca_state, sum(ws_sales_price)\n from web_sales, customer, customer_address, date_dim, item\n where ws_bill_customer_sk = c_customer_sk\n \tand c_current_addr_sk = ca_address_sk \n \tand ws_item_sk = i_item_sk \n \tand ( substring(ca_zip,1,5) in ('85669', '86197','88274','83405','86475', '85392', '85460', '80348', '81792')\n \t      or \n \t      i_item_id in (select i_item_id\n                             from item\n                             where i_item_sk in (2, 3, 5, 7, 11, 13, 17, 19, 23, 29)\n                             )\n \t    )\n \tand ws_sold_date_sk = d_date_sk\n \tand d_qoy = 1 and d_year = 2000\n group by ca_zip, ca_state\n order by ca_zip, ca_state\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_ITEM_SK\" IN ( 2 , 3 , 5 , 7 , 11 , 13 , 17 , 19 , 23 , 29 ) GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"_U_0\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ORDER BY \"CA_ZIP\" NULLS LAST , \"CA_STATE\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ORDER BY \"CA_ZIP\" , \"CA_STATE\" LIMIT 21",
                "preview": "\n/*   ca_zip ca_state  _col_2\n0   13372       NY   32.42\n1   20534       NC   11.89\n2   23425       WV   13.16\n3   30411       AL    4.34\n4   31933       GA    1.03\n5   34975       TN   60.39\n6   43683       MI  142.64\n7   44462       MI   31.04\n8   49275       IN   24.15\n9   49584       OH   10.97\n10  51749       SD    4.60\n11  54338       WI   62.91\n12  54975       MN   12.30\n13  56871       IA   13.45\n14  57936       WI    0.23\n15  59237       MN    0.15\n16  60059       NE   43.01\n17  60150       NE   45.35\n18  60411       MT   89.97\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017607,
                    "execution_time": 0.008242,
                    "compile_time": 7.1e-05,
                    "planning_time": 0.003525
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017786,
                    "execution_time": 0.008034,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.003589
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , SUM ( \"WEB_SALES\".\"WS_SALES_PRICE\" ) AS \"_COL_2\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" = 1 AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" = \"ITEM\".\"I_ITEM_ID\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" IS NULL OR SUBSTRING ( \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , 1 , 5 ) IN ( '85669' , '86197' , '88274' , '83405' , '86475' , '85392' , '85460' , '80348' , '81792' ) GROUP BY \"CUSTOMER_ADDRESS\".\"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ORDER BY \"CA_ZIP\" NULLS LAST , \"CA_STATE\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_2\" AS \"_COL_2\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ORDER BY \"CA_ZIP\" NULLS LAST , \"CA_STATE\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   ca_zip ca_state  _col_2\n0   13372       NY   32.42\n1   20534       NC   11.89\n2   23425       WV   13.16\n3   30411       AL    4.34\n4   31933       GA    1.03\n5   34975       TN   60.39\n6   43683       MI  142.64\n7   44462       MI   31.04\n8   49275       IN   24.15\n9   49584       OH   10.97\n10  51749       SD    4.60\n11  54338       WI   62.91\n12  54975       MN   12.30\n13  56871       IA   13.45\n14  57936       WI    0.23\n15  59237       MN    0.15\n16  60059       NE   43.01\n17  60150       NE   45.35\n18  60411       MT   89.97\n...*/"
    }
]