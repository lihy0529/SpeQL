[
    {
        "input": "WITH cross_items \n     AS (SELECT i_item_sk ss_item_sk \n         FROM   item, \n                (SELECT iss.i_brand_id    brand_id, \n                        iss.i_class_id    class_id, \n                        iss.i_category_id category_id \n                 FROM   store_sales, \n                        item iss, \n                        date_dim d1 \n                 WHERE  ss_item_sk = iss.i_item_sk \n                        AND ss_sold_date_sk = d1.d_date_sk \n                        AND d1.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT ics.i_brand_id, \n                        ics.i_class_id, \n                        ics.i_category_id \n                 FROM   catalog_sales, \n                        item ics, \n                        date_dim d2 \n                 WHERE  cs_item_sk = ics.i_item_sk \n                        AND cs_sold_date_sk = d2.d_date_sk \n                        AND d2.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT iws.i_brand_id, \n                        iws.i_class_id, \n                        iws.i_category_id \n                 FROM   web_sales, \n                        item iws, \n                        date_dim d3 \n                 WHERE  ws_item_sk = iws.i_item_sk \n                        AND ws_sold_date_sk = d3.d_date_sk \n                        AND d3.d_year BETWEEN 1999 AND 1999 + 2) x \n         WHERE  i_brand_id = brand_id \n                AND i_class_id = class_id \n                AND i_category_id = category_id), \n     avg_sales \n     AS (SELECT Avg(quantity * list_price) average_sales \n         FROM   (SELECT ss_quantity   quantity, \n                        ss_list_price list_price \n                 FROM   store_sales, \n                        date_dim \n                 WHERE  ss_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT cs_quantity   quantity, \n                        cs_list_price list_price \n                 FROM   catalog_sales, \n                        date_dim \n                 WHERE  cs_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT ws_quantity   quantity, \n                        ws_list_price list_price \n                 FROM   web_sales, \n                        date_dim \n                 WHERE  ws_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2) x) \nSELECT  * \nFROM   (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 + 1 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) this_year, \n       (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n/*CURSOR_IDENTIFIER*/\n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales) \n) previous_year ",
        "optimize": [
            "WITH \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"X\" AS ( SELECT \"ISS\".\"I_BRAND_ID\" AS \"BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"CATEGORY_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"D1\".\"D_YEAR\" <= 2001 AND \"D1\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" INTERSECT SELECT \"ICS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ICS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ICS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D2\".\"D_DATE_SK\" AND \"D2\".\"D_YEAR\" <= 2001 AND \"D2\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ICS\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ICS\".\"I_ITEM_SK\" INTERSECT SELECT \"IWS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"IWS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"IWS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D3\" ON \"D3\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D3\".\"D_YEAR\" <= 2001 AND \"D3\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"IWS\" ON \"IWS\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" <= 2001 AND \"DATE_DIM\".\"D_YEAR\" >= 1999 ) , \"X_2\" AS ( SELECT \"STORE_SALES\".\"SS_QUANTITY\" AS \"QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_QUANTITY\" AS \"QUANTITY\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" UNION ALL SELECT \"WEB_SALES\".\"WS_QUANTITY\" AS \"QUANTITY\" , \"WEB_SALES\".\"WS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) , \"AVG_SALES\" AS ( SELECT AVG ( \"X\".\"QUANTITY\" * \"X\".\"LIST_PRICE\" ) AS \"AVERAGE_SALES\" FROM \"X_2\" AS \"X\" ) , \"_U_2\" AS ( SELECT \"AVG_SALES\".\"AVERAGE_SALES\" AS \"AVERAGE_SALES\" FROM \"AVG_SALES\" AS \"AVG_SALES\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"SS_ITEM_SK\" FROM \"ITEM_2\" AS \"ITEM\" JOIN \"X\" AS \"X\" ON \"ITEM\".\"I_BRAND_ID\" = \"X\".\"BRAND_ID\" AND \"ITEM\".\"I_CATEGORY_ID\" = \"X\".\"CATEGORY_ID\" AND \"ITEM\".\"I_CLASS_ID\" = \"X\".\"CLASS_ID\" GROUP BY \"ITEM\".\"I_ITEM_SK\" ) , \"THIS_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_2\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 2000 WHERE NOT \"_U_0\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_2\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) , \"PREVIOUS_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_4\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" LEFT JOIN \"_U_0\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_4\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) SELECT \"THIS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"THIS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"THIS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"THIS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"THIS_YEAR\".\"SALES\" AS \"SALES\" , \"THIS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"PREVIOUS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"PREVIOUS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"PREVIOUS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"PREVIOUS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"PREVIOUS_YEAR\".\"SALES\" AS \"SALES\" , \"PREVIOUS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"THIS_YEAR\" AS \"THIS_YEAR\" CROSS JOIN \"PREVIOUS_YEAR\" AS \"PREVIOUS_YEAR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.171858,
                    "execution_time": 0.048654,
                    "compile_time": 0.000228,
                    "planning_time": 0.027867,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.202354,
                    "execution_time": 0.07245,
                    "compile_time": 0.000228,
                    "planning_time": 0.034722,
                    "create_size": 896
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ISS\".\"I_BRAND_ID\" AS \"BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"CATEGORY_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"D1\".\"D_YEAR\" <= 2001 AND \"D1\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" INTERSECT SELECT \"ICS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ICS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ICS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D2\".\"D_DATE_SK\" AND \"D2\".\"D_YEAR\" <= 2001 AND \"D2\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ICS\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ICS\".\"I_ITEM_SK\" INTERSECT SELECT \"IWS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"IWS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"IWS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D3\" ON \"D3\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D3\".\"D_YEAR\" <= 2001 AND \"D3\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"IWS\" ON \"IWS\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.528678,
                    "execution_time": 0.401269,
                    "compile_time": 0.000684,
                    "planning_time": 0.079901,
                    "create_size": 96
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.711487,
                    "execution_time": 0.459642,
                    "compile_time": 0.000701,
                    "planning_time": 0.203125,
                    "create_size": 96
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" <= 2001 AND \"DATE_DIM\".\"D_YEAR\" >= 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.081546,
                    "execution_time": 0.032305,
                    "compile_time": 0.000227,
                    "planning_time": 0.02596,
                    "create_size": 20
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.145224,
                    "execution_time": 0.0306,
                    "compile_time": 0.000229,
                    "planning_time": 0.090623,
                    "create_size": 20
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"STORE_SALES\".\"SS_QUANTITY\" AS \"QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_QUANTITY\" AS \"QUANTITY\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" UNION ALL SELECT \"WEB_SALES\".\"WS_QUANTITY\" AS \"QUANTITY\" , \"WEB_SALES\".\"WS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.886646,
                    "execution_time": 0.644984,
                    "compile_time": 0.000465,
                    "planning_time": 0.045017,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.025718,
                    "execution_time": 0.67389,
                    "compile_time": 0.000509,
                    "planning_time": 0.157314,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT AVG ( \"SPEQLITE_TEMP_TABLE_2\".\"QUANTITY\" * \"SPEQLITE_TEMP_TABLE_2\".\"LIST_PRICE\" ) AS \"AVERAGE_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.08554,
                    "execution_time": 0.056685,
                    "compile_time": 0.000286,
                    "planning_time": 0.003565,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.143566,
                    "execution_time": 0.056366,
                    "compile_time": 0.000333,
                    "planning_time": 0.060788,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"AVERAGE_SALES\" AS \"AVERAGE_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.060966,
                    "execution_time": 0.034873,
                    "compile_time": 0.000226,
                    "planning_time": 0.002818,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.117856,
                    "execution_time": 0.035245,
                    "compile_time": 0.000223,
                    "planning_time": 0.059202,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"ITEM\".\"I_ITEM_SK\" AS \"SS_ITEM_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"ITEM\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"ITEM\".\"I_BRAND_ID\" = \"SPEQLITE_TEMP_TABLE_2\".\"BRAND_ID\" AND \"ITEM\".\"I_CATEGORY_ID\" = \"SPEQLITE_TEMP_TABLE_2\".\"CATEGORY_ID\" AND \"ITEM\".\"I_CLASS_ID\" = \"SPEQLITE_TEMP_TABLE_2\".\"CLASS_ID\" GROUP BY \"ITEM\".\"I_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.100905,
                    "execution_time": 0.053603,
                    "compile_time": 0.0003,
                    "planning_time": 0.005938,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.158971,
                    "execution_time": 0.053857,
                    "compile_time": 0.000348,
                    "planning_time": 0.063243,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ\" AND \"SPEQLITE_TEMP_TABLE_3\".\"D_DOM\" = 25 AND \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" = 12 AND \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" = 2000 WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_6\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.178434,
                    "execution_time": 0.088081,
                    "compile_time": 0.000538,
                    "planning_time": 0.05066,
                    "create_size": 108
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.259116,
                    "execution_time": 0.093849,
                    "compile_time": 0.000539,
                    "planning_time": 0.12291,
                    "create_size": 108
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"_U_4\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_4\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH PREVIOUS_YEAR AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"_U_4\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_4\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_8\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"PREVIOUS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"PREVIOUS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"PREVIOUS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"PREVIOUS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"PREVIOUS_YEAR\".\"SALES\" AS \"SALES\" , \"PREVIOUS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"PREVIOUS_YEAR\" AS \"PREVIOUS_YEAR\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH PREVIOUS_YEAR AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"_U_4\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_4\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_8\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"PREVIOUS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"PREVIOUS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"PREVIOUS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"PREVIOUS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"PREVIOUS_YEAR\".\"SALES\" AS \"SALES\" , \"PREVIOUS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"PREVIOUS_YEAR\" AS \"PREVIOUS_YEAR\"",
                "rewrite": "WITH PREVIOUS_YEAR AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"_U_4\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_4\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_8\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"PREVIOUS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"PREVIOUS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"PREVIOUS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"PREVIOUS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"PREVIOUS_YEAR\".\"SALES\" AS \"SALES\" , \"PREVIOUS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"PREVIOUS_YEAR\" AS \"PREVIOUS_YEAR\""
            }
        ],
        "preview": null
    },
    {
        "input": "WITH cross_items \n     AS (SELECT i_item_sk ss_item_sk \n         FROM   item, \n                (SELECT iss.i_brand_id    brand_id, \n                        iss.i_class_id    class_id, \n                        iss.i_category_id category_id \n                 FROM   store_sales, \n                        item iss, \n                        date_dim d1 \n                 WHERE  ss_item_sk = iss.i_item_sk \n                        AND ss_sold_date_sk = d1.d_date_sk \n                        AND d1.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT ics.i_brand_id, \n                        ics.i_class_id, \n                        ics.i_category_id \n                 FROM   catalog_sales, \n                        item ics, \n                        date_dim d2 \n                 WHERE  cs_item_sk = ics.i_item_sk \n                        AND cs_sold_date_sk = d2.d_date_sk \n                        AND d2.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT iws.i_brand_id, \n                        iws.i_class_id, \n                        iws.i_category_id \n                 FROM   web_sales, \n                        item iws, \n                        date_dim d3 \n                 WHERE  ws_item_sk = iws.i_item_sk \n                        AND ws_sold_date_sk = d3.d_date_sk \n                        AND d3.d_year BETWEEN 1999 AND 1999 + 2) x \n         WHERE  i_brand_id = brand_id \n                AND i_class_id = class_id \n                AND i_category_id = category_id), \n     avg_sales \n     AS (SELECT Avg(quantity * list_price) average_sales \n         FROM   (SELECT ss_quantity   quantity, \n                        ss_list_price list_price \n                 FROM   store_sales, \n                        date_dim \n                 WHERE  ss_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT cs_quantity   quantity, \n                        cs_list_price list_price \n                 FROM   catalog_sales, \n                        date_dim \n                 WHERE  cs_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT ws_quantity   quantity, \n                        ws_list_price list_price \n                 FROM   web_sales, \n                        date_dim \n                 WHERE  ws_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2) x) \nSELECT  * \nFROM   (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 + 1 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) this_year, \n       (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n/*CURSOR_IDENTIFIER*/\n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales) \n) previous_year \n",
        "optimize": [
            "WITH \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"X\" AS ( SELECT \"ISS\".\"I_BRAND_ID\" AS \"BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"CATEGORY_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"D1\".\"D_YEAR\" <= 2001 AND \"D1\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" INTERSECT SELECT \"ICS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ICS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ICS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D2\".\"D_DATE_SK\" AND \"D2\".\"D_YEAR\" <= 2001 AND \"D2\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ICS\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ICS\".\"I_ITEM_SK\" INTERSECT SELECT \"IWS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"IWS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"IWS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D3\" ON \"D3\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D3\".\"D_YEAR\" <= 2001 AND \"D3\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"IWS\" ON \"IWS\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" <= 2001 AND \"DATE_DIM\".\"D_YEAR\" >= 1999 ) , \"X_2\" AS ( SELECT \"STORE_SALES\".\"SS_QUANTITY\" AS \"QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_QUANTITY\" AS \"QUANTITY\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" UNION ALL SELECT \"WEB_SALES\".\"WS_QUANTITY\" AS \"QUANTITY\" , \"WEB_SALES\".\"WS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) , \"AVG_SALES\" AS ( SELECT AVG ( \"X\".\"QUANTITY\" * \"X\".\"LIST_PRICE\" ) AS \"AVERAGE_SALES\" FROM \"X_2\" AS \"X\" ) , \"_U_2\" AS ( SELECT \"AVG_SALES\".\"AVERAGE_SALES\" AS \"AVERAGE_SALES\" FROM \"AVG_SALES\" AS \"AVG_SALES\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"SS_ITEM_SK\" FROM \"ITEM_2\" AS \"ITEM\" JOIN \"X\" AS \"X\" ON \"ITEM\".\"I_BRAND_ID\" = \"X\".\"BRAND_ID\" AND \"ITEM\".\"I_CATEGORY_ID\" = \"X\".\"CATEGORY_ID\" AND \"ITEM\".\"I_CLASS_ID\" = \"X\".\"CLASS_ID\" GROUP BY \"ITEM\".\"I_ITEM_SK\" ) , \"THIS_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_2\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 2000 WHERE NOT \"_U_0\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_2\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) , \"PREVIOUS_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_4\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"_U_0\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_4\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) SELECT \"THIS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"THIS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"THIS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"THIS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"THIS_YEAR\".\"SALES\" AS \"SALES\" , \"THIS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"PREVIOUS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"PREVIOUS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"PREVIOUS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"PREVIOUS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"PREVIOUS_YEAR\".\"SALES\" AS \"SALES\" , \"PREVIOUS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"THIS_YEAR\" AS \"THIS_YEAR\" CROSS JOIN \"PREVIOUS_YEAR\" AS \"PREVIOUS_YEAR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"_U_4\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_4\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH PREVIOUS_YEAR AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"_U_4\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_4\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_8\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"PREVIOUS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"PREVIOUS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"PREVIOUS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"PREVIOUS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"PREVIOUS_YEAR\".\"SALES\" AS \"SALES\" , \"PREVIOUS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"PREVIOUS_YEAR\" AS \"PREVIOUS_YEAR\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH PREVIOUS_YEAR AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"_U_4\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_4\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_8\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"PREVIOUS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"PREVIOUS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"PREVIOUS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"PREVIOUS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"PREVIOUS_YEAR\".\"SALES\" AS \"SALES\" , \"PREVIOUS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"PREVIOUS_YEAR\" AS \"PREVIOUS_YEAR\"",
                "rewrite": "WITH PREVIOUS_YEAR AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"_U_4\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_4\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_8\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_8\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"PREVIOUS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"PREVIOUS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"PREVIOUS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"PREVIOUS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"PREVIOUS_YEAR\".\"SALES\" AS \"SALES\" , \"PREVIOUS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"PREVIOUS_YEAR\" AS \"PREVIOUS_YEAR\""
            }
        ],
        "preview": null
    },
    {
        "input": "WITH cross_items \n     AS (SELECT i_item_sk ss_item_sk \n         FROM   item, \n                (SELECT iss.i_brand_id    brand_id, \n                        iss.i_class_id    class_id, \n                        iss.i_category_id category_id \n                 FROM   store_sales, \n                        item iss, \n                        date_dim d1 \n                 WHERE  ss_item_sk = iss.i_item_sk \n                        AND ss_sold_date_sk = d1.d_date_sk \n                        AND d1.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT ics.i_brand_id, \n                        ics.i_class_id, \n                        ics.i_category_id \n                 FROM   catalog_sales, \n                        item ics, \n                        date_dim d2 \n                 WHERE  cs_item_sk = ics.i_item_sk \n                        AND cs_sold_date_sk = d2.d_date_sk \n                        AND d2.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT iws.i_brand_id, \n                        iws.i_class_id, \n                        iws.i_category_id \n                 FROM   web_sales, \n                        item iws, \n                        date_dim d3 \n                 WHERE  ws_item_sk = iws.i_item_sk \n                        AND ws_sold_date_sk = d3.d_date_sk \n                        AND d3.d_year BETWEEN 1999 AND 1999 + 2) x \n         WHERE  i_brand_id = brand_id \n                AND i_class_id = class_id \n                AND i_category_id = category_id), \n     avg_sales \n     AS (SELECT Avg(quantity * list_price) average_sales \n         FROM   (SELECT ss_quantity   quantity, \n                        ss_list_price list_price \n                 FROM   store_sales, \n                        date_dim \n                 WHERE  ss_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT cs_quantity   quantity, \n                        cs_list_price list_price \n                 FROM   catalog_sales, \n                        date_dim \n                 WHERE  cs_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT ws_quantity   quantity, \n                        ws_list_price list_price \n                 FROM   web_sales, \n                        date_dim \n                 WHERE  ws_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2) x) \nSELECT  * \nFROM   (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 + 1 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) this_year, \n       (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 + 1 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"X\" AS ( SELECT \"ISS\".\"I_BRAND_ID\" AS \"BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"CATEGORY_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"D1\".\"D_YEAR\" <= 2001 AND \"D1\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" INTERSECT SELECT \"ICS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ICS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ICS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D2\".\"D_DATE_SK\" AND \"D2\".\"D_YEAR\" <= 2001 AND \"D2\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ICS\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ICS\".\"I_ITEM_SK\" INTERSECT SELECT \"IWS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"IWS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"IWS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D3\" ON \"D3\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D3\".\"D_YEAR\" <= 2001 AND \"D3\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"IWS\" ON \"IWS\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" <= 2001 AND \"DATE_DIM\".\"D_YEAR\" >= 1999 ) , \"X_2\" AS ( SELECT \"STORE_SALES\".\"SS_QUANTITY\" AS \"QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_QUANTITY\" AS \"QUANTITY\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" UNION ALL SELECT \"WEB_SALES\".\"WS_QUANTITY\" AS \"QUANTITY\" , \"WEB_SALES\".\"WS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) , \"AVG_SALES\" AS ( SELECT AVG ( \"X\".\"QUANTITY\" * \"X\".\"LIST_PRICE\" ) AS \"AVERAGE_SALES\" FROM \"X_2\" AS \"X\" ) , \"STORE_SALES_4\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"SS_QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"SS_LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"SS_ITEM_SK\" FROM \"ITEM_2\" AS \"ITEM\" JOIN \"X\" AS \"X\" ON \"ITEM\".\"I_BRAND_ID\" = \"X\".\"BRAND_ID\" AND \"ITEM\".\"I_CATEGORY_ID\" = \"X\".\"CATEGORY_ID\" AND \"ITEM\".\"I_CLASS_ID\" = \"X\".\"CLASS_ID\" GROUP BY \"ITEM\".\"I_ITEM_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DOM\" = 25 AND \"DATE_DIM\".\"D_MOY\" = 12 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"THIS_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"AVG_SALES\" AS \"AVG_SALES\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"AVG_SALES\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) , \"_Q_0\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" LEFT JOIN \"_U_0\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"_U_1\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" ) SELECT \"THIS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"THIS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"THIS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"THIS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"THIS_YEAR\".\"SALES\" AS \"SALES\" , \"THIS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"_Q_0\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"_Q_0\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"_Q_0\".\"SALES\" AS \"SALES\" , \"_Q_0\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"THIS_YEAR\" AS \"THIS_YEAR\" CROSS JOIN \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"SS_QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"SS_LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.034596,
                    "execution_time": 0.727928,
                    "compile_time": 0.000265,
                    "planning_time": 0.02423,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.084744,
                    "execution_time": 0.721847,
                    "compile_time": 0.000275,
                    "planning_time": 0.086378,
                    "create_size": 1024
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.106152,
                    "execution_time": 0.039532,
                    "compile_time": 0.000269,
                    "planning_time": 0.025743,
                    "create_size": 480
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.167525,
                    "execution_time": 0.039235,
                    "compile_time": 0.000233,
                    "planning_time": 0.088143,
                    "create_size": 480
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DOM\" = 25 AND \"DATE_DIM\".\"D_MOY\" = 12",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.080768,
                    "execution_time": 0.031492,
                    "compile_time": 0.000238,
                    "planning_time": 0.025854,
                    "create_size": 8
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.285662,
                    "execution_time": 0.031156,
                    "compile_time": 0.139553,
                    "planning_time": 0.089019,
                    "create_size": 8
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"STORE_SALES\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_5\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.219141,
                    "execution_time": 0.150158,
                    "compile_time": 0.000571,
                    "planning_time": 0.015113,
                    "create_size": 153
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.298381,
                    "execution_time": 0.156264,
                    "compile_time": 0.002588,
                    "planning_time": 0.074244,
                    "create_size": 153
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"STORE_SALES\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.194607,
                    "execution_time": 0.12997,
                    "compile_time": 0.000557,
                    "planning_time": 0.01226,
                    "create_size": 153
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.26943,
                    "execution_time": 0.12968,
                    "compile_time": 0.003154,
                    "planning_time": 0.077721,
                    "create_size": 153
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_13\".\"CHANNEL\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_BRAND_ID\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_CLASS_ID\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_13\".\"SALES\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_13\".\"NUMBER_SALES\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 10.658386,
                    "execution_time": 9.941383,
                    "compile_time": 0.000594,
                    "planning_time": 0.006309,
                    "create_size": 13056
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 10.912931,
                    "execution_time": 10.138373,
                    "compile_time": 0.00575,
                    "planning_time": 0.068922,
                    "create_size": 13056
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_14\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_14\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_14\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_14\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" LIMIT 21",
                "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id     sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     9013004           3              9  54389.32            18         store          10006011                 6                   10    1365663.06                  358\n1    store     6012002           2              6  28884.68             9         store          10006011                 6                   10    1365663.06                  358\n2    store    10016017          16              4  31380.78             9         store          10006011                 6                   10    1365663.06                  358\n3    store     7007005           5             10  21130.50             9         store          10006011                 6                   10    1365663.06                  358\n4    store    10010007           2             10  51458.00            11         store          10006011                 6                   10    1365663.06                  358\n5    store     6007004           1              6  52579.53             9         store          10006011                 6                   10    1365663.06                  358\n6    store     8015001          15              5  64870.46            19         store          10006011                 6                   10    1365663.06                  358\n7    store     8007007           1              1  60982.38            15         store          10006011                 6                   10    1365663.06                  358\n8    store    10012010          12              7  38301.53            11         store          10006011                 6                   10    1365663.06                  358\n9    store    10002007           2              5  31451.82             7         store          10006011                 6                   10    1365663.06                  358\n10   store    10004012          12              7  52219.15            12         store          10006011                 6                   10    1365663.06                  358\n11   store     6002005           2              9  83521.02            30         store          10006011                 6                   10    1365663.06                  358\n12   store     7003009           1              7  31479.36            12         store          10006011                 6                   10    1365663.06                  358\n13   store     6002007           2              4  10439.92             6         store          10006011                 6                   10    1365663.06                  358\n14   store    10009005           1              8  12169.59             7         store          10006011                 6                   10    1365663.06                  358\n15   store     6004007           3              4  49956.27            12         store          10006011                 6                   10    1365663.06                  358\n16   store     8015009           1              3  10051.69             3         store          10006011                 6                   10    1365663.06                  358\n17   store     4001001           3              7  87543.61            23         store          10006011                 6                   10    1365663.06                  358\n18   store     9006005           2              1  41646.59            15         store          10006011                 6                   10    1365663.06                  358\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020474,
                    "execution_time": 0.008526,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.005015
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060996,
                    "execution_time": 0.00864,
                    "compile_time": 0.001202,
                    "planning_time": 0.040886
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_12\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_13\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_13\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_14\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_14\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_14\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_14\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\""
            }
        ],
        "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id     sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     9013004           3              9  54389.32            18         store          10006011                 6                   10    1365663.06                  358\n1    store     6012002           2              6  28884.68             9         store          10006011                 6                   10    1365663.06                  358\n2    store    10016017          16              4  31380.78             9         store          10006011                 6                   10    1365663.06                  358\n3    store     7007005           5             10  21130.50             9         store          10006011                 6                   10    1365663.06                  358\n4    store    10010007           2             10  51458.00            11         store          10006011                 6                   10    1365663.06                  358\n5    store     6007004           1              6  52579.53             9         store          10006011                 6                   10    1365663.06                  358\n6    store     8015001          15              5  64870.46            19         store          10006011                 6                   10    1365663.06                  358\n7    store     8007007           1              1  60982.38            15         store          10006011                 6                   10    1365663.06                  358\n8    store    10012010          12              7  38301.53            11         store          10006011                 6                   10    1365663.06                  358\n9    store    10002007           2              5  31451.82             7         store          10006011                 6                   10    1365663.06                  358\n10   store    10004012          12              7  52219.15            12         store          10006011                 6                   10    1365663.06                  358\n11   store     6002005           2              9  83521.02            30         store          10006011                 6                   10    1365663.06                  358\n12   store     7003009           1              7  31479.36            12         store          10006011                 6                   10    1365663.06                  358\n13   store     6002007           2              4  10439.92             6         store          10006011                 6                   10    1365663.06                  358\n14   store    10009005           1              8  12169.59             7         store          10006011                 6                   10    1365663.06                  358\n15   store     6004007           3              4  49956.27            12         store          10006011                 6                   10    1365663.06                  358\n16   store     8015009           1              3  10051.69             3         store          10006011                 6                   10    1365663.06                  358\n17   store     4001001           3              7  87543.61            23         store          10006011                 6                   10    1365663.06                  358\n18   store     9006005           2              1  41646.59            15         store          10006011                 6                   10    1365663.06                  358\n...*/"
    },
    {
        "input": "WITH cross_items \n     AS (SELECT i_item_sk ss_item_sk \n         FROM   item, \n                (SELECT iss.i_brand_id    brand_id, \n                        iss.i_class_id    class_id, \n                        iss.i_category_id category_id \n                 FROM   store_sales, \n                        item iss, \n                        date_dim d1 \n                 WHERE  ss_item_sk = iss.i_item_sk \n                        AND ss_sold_date_sk = d1.d_date_sk \n                        AND d1.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT ics.i_brand_id, \n                        ics.i_class_id, \n                        ics.i_category_id \n                 FROM   catalog_sales, \n                        item ics, \n                        date_dim d2 \n                 WHERE  cs_item_sk = ics.i_item_sk \n                        AND cs_sold_date_sk = d2.d_date_sk \n                        AND d2.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT iws.i_brand_id, \n                        iws.i_class_id, \n                        iws.i_category_id \n                 FROM   web_sales, \n                        item iws, \n                        date_dim d3 \n                 WHERE  ws_item_sk = iws.i_item_sk \n                        AND ws_sold_date_sk = d3.d_date_sk \n                        AND d3.d_year BETWEEN 1999 AND 1999 + 2) x \n         WHERE  i_brand_id = brand_id \n                AND i_class_id = class_id \n                AND i_category_id = category_id), \n     avg_sales \n     AS (SELECT Avg(quantity * list_price) average_sales \n         FROM   (SELECT ss_quantity   quantity, \n                        ss_list_price list_price \n                 FROM   store_sales, \n                        date_dim \n                 WHERE  ss_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT cs_quantity   quantity, \n                        cs_list_price list_price \n                 FROM   catalog_sales, \n                        date_dim \n                 WHERE  cs_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT ws_quantity   quantity, \n                        ws_list_price list_price \n                 FROM   web_sales, \n                        date_dim \n                 WHERE  ws_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2) x) \nSELECT  * \nFROM   (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 + 1 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) this_year, \n       (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 + 1 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales))/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"X\" AS ( SELECT \"ISS\".\"I_BRAND_ID\" AS \"BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"CATEGORY_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"D1\".\"D_YEAR\" <= 2001 AND \"D1\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" INTERSECT SELECT \"ICS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ICS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ICS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D2\".\"D_DATE_SK\" AND \"D2\".\"D_YEAR\" <= 2001 AND \"D2\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ICS\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ICS\".\"I_ITEM_SK\" INTERSECT SELECT \"IWS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"IWS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"IWS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D3\" ON \"D3\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D3\".\"D_YEAR\" <= 2001 AND \"D3\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"IWS\" ON \"IWS\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" <= 2001 AND \"DATE_DIM\".\"D_YEAR\" >= 1999 ) , \"X_2\" AS ( SELECT \"STORE_SALES\".\"SS_QUANTITY\" AS \"QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_QUANTITY\" AS \"QUANTITY\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" UNION ALL SELECT \"WEB_SALES\".\"WS_QUANTITY\" AS \"QUANTITY\" , \"WEB_SALES\".\"WS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) , \"AVG_SALES\" AS ( SELECT AVG ( \"X\".\"QUANTITY\" * \"X\".\"LIST_PRICE\" ) AS \"AVERAGE_SALES\" FROM \"X_2\" AS \"X\" ) , \"STORE_SALES_4\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"SS_QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"SS_LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"_U_2\" AS ( SELECT \"AVG_SALES\".\"AVERAGE_SALES\" AS \"AVERAGE_SALES\" FROM \"AVG_SALES\" AS \"AVG_SALES\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"SS_ITEM_SK\" FROM \"ITEM_2\" AS \"ITEM\" JOIN \"X\" AS \"X\" ON \"ITEM\".\"I_BRAND_ID\" = \"X\".\"BRAND_ID\" AND \"ITEM\".\"I_CATEGORY_ID\" = \"X\".\"CATEGORY_ID\" AND \"ITEM\".\"I_CLASS_ID\" = \"X\".\"CLASS_ID\" GROUP BY \"ITEM\".\"I_ITEM_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DOM\" = 25 AND \"DATE_DIM\".\"D_MOY\" = 12 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"THIS_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_2\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_0\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_2\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) , \"_Q_0\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_5\" LEFT JOIN \"_U_0\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"_U_1\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_5\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) SELECT \"THIS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"THIS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"THIS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"THIS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"THIS_YEAR\".\"SALES\" AS \"SALES\" , \"THIS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"_Q_0\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"_Q_0\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"_Q_0\".\"SALES\" AS \"SALES\" , \"_Q_0\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"THIS_YEAR\" AS \"THIS_YEAR\" CROSS JOIN \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "WITH CROSS_ITEMS AS ( SELECT I_ITEM_SK AS SS_ITEM_SK FROM ITEM , ( SELECT ISS.I_BRAND_ID AS BRAND_ID , ISS.I_CLASS_ID AS CLASS_ID , ISS.I_CATEGORY_ID AS CATEGORY_ID FROM STORE_SALES , ITEM AS ISS , DATE_DIM AS D1 WHERE SS_ITEM_SK = ISS.I_ITEM_SK AND SS_SOLD_DATE_SK = D1.D_DATE_SK AND D1.D_YEAR BETWEEN 1999 AND 1999 + 2 INTERSECT SELECT ICS.I_BRAND_ID , ICS.I_CLASS_ID , ICS.I_CATEGORY_ID FROM CATALOG_SALES , ITEM AS ICS , DATE_DIM AS D2 WHERE CS_ITEM_SK = ICS.I_ITEM_SK AND CS_SOLD_DATE_SK = D2.D_DATE_SK AND D2.D_YEAR BETWEEN 1999 AND 1999 + 2 INTERSECT SELECT IWS.I_BRAND_ID , IWS.I_CLASS_ID , IWS.I_CATEGORY_ID FROM WEB_SALES , ITEM AS IWS , DATE_DIM AS D3 WHERE WS_ITEM_SK = IWS.I_ITEM_SK AND WS_SOLD_DATE_SK = D3.D_DATE_SK AND D3.D_YEAR BETWEEN 1999 AND 1999 + 2 ) AS X WHERE I_BRAND_ID = BRAND_ID AND I_CLASS_ID = CLASS_ID AND I_CATEGORY_ID = CATEGORY_ID ) , AVG_SALES AS ( SELECT AVG ( QUANTITY * LIST_PRICE ) AS AVERAGE_SALES FROM ( SELECT SS_QUANTITY AS QUANTITY , SS_LIST_PRICE AS LIST_PRICE FROM STORE_SALES , DATE_DIM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR BETWEEN 1999 AND 1999 + 2 UNION ALL SELECT CS_QUANTITY AS QUANTITY , CS_LIST_PRICE AS LIST_PRICE FROM CATALOG_SALES , DATE_DIM WHERE CS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR BETWEEN 1999 AND 1999 + 2 UNION ALL SELECT WS_QUANTITY AS QUANTITY , WS_LIST_PRICE AS LIST_PRICE FROM WEB_SALES , DATE_DIM WHERE WS_SOLD_DATE_SK = D_DATE_SK AND D_YEAR BETWEEN 1999 AND 1999 + 2 ) AS X ) SELECT * FROM ( SELECT 'store' AS CHANNEL , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , SUM ( SS_QUANTITY * SS_LIST_PRICE ) AS SALES , COUNT ( * ) AS NUMBER_SALES FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK IN ( SELECT SS_ITEM_SK FROM CROSS_ITEMS ) AND SS_ITEM_SK = I_ITEM_SK AND SS_SOLD_DATE_SK = D_DATE_SK AND D_WEEK_SEQ = ( SELECT D_WEEK_SEQ FROM DATE_DIM WHERE D_YEAR = 1999 + 1 AND D_MOY = 12 AND D_DOM = 25 ) GROUP BY I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID HAVING SUM ( SS_QUANTITY * SS_LIST_PRICE ) > ( SELECT AVERAGE_SALES FROM AVG_SALES ) ) AS THIS_YEAR , ( SELECT 'store' AS CHANNEL , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , SUM ( SS_QUANTITY * SS_LIST_PRICE ) AS SALES , COUNT ( * ) AS NUMBER_SALES FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK IN ( SELECT SS_ITEM_SK FROM CROSS_ITEMS ) AND SS_ITEM_SK = I_ITEM_SK AND SS_SOLD_DATE_SK = D_DATE_SK AND D_WEEK_SEQ = ( SELECT D_WEEK_SEQ FROM DATE_DIM WHERE D_YEAR = 1999 + 1 AND D_MOY = 12 AND D_DOM = 25 ) GROUP BY I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID HAVING SUM ( SS_QUANTITY * SS_LIST_PRICE ) > ( SELECT AVERAGE_SALES FROM AVG_SALES ) ) LIMIT 21",
                "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id     sales  number_sales channel  i_brand_id  i_class_id  i_category_id       sales  number_sales\n0    store     7011007          11              9  17422.19             5   store     7011007          11              9    17422.19             5\n1    store     7011007          11              9  17422.19             5   store     3002001           2              3  7271832.68          1940\n2    store     7011007          11              9  17422.19             5   store     9012002          12              9  1036193.27           268\n3    store     7011007          11              9  17422.19             5   store     8016007          16              8   396752.24           108\n4    store     7011007          11              9  17422.19             5   store     1003001           3              5   245701.12            73\n5    store     7011007          11              9  17422.19             5   store     1003002           3              1  8489408.10          2244\n6    store     7011007          11              9  17422.19             5   store     2001002           1              2  8887122.24          2374\n7    store     7011007          11              9  17422.19             5   store     1004001           3              1    43710.68            11\n8    store     7011007          11              9  17422.19             5   store     3002002           2              3  8640465.25          2300\n9    store     7011007          11              9  17422.19             5   store     7002005           2              5    14686.78             4\n10   store     7011007          11              9  17422.19             5   store     9009003           9              9   781369.65           225\n11   store     7011007          11              9  17422.19             5   store     1001001           1              1  6404262.37          1762\n12   store     7011007          11              9  17422.19             5   store     6015001           1              5     8222.85             4\n13   store     7011007          11              9  17422.19             5   store     8010001          10              8   331302.18            98\n14   store     7011007          11              9  17422.19             5   store     6006008           6              6   440887.19           129\n15   store     7011007          11              9  17422.19             5   store     2004001           4              2  6585735.74          1833\n16   store     7011007          11              9  17422.19             5   store     5003002           3              5  8550759.54          2362\n17   store     7011007          11              9  17422.19             5   store     3001001           1              2   222237.69            63\n18   store     7011007          11              9  17422.19             5   store     9014012          14              9   267499.41            84\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.952038,
                    "execution_time": 0.544184,
                    "compile_time": 0.001681,
                    "planning_time": 0.928328
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.098675,
                    "execution_time": 0.574013,
                    "compile_time": 0.001724,
                    "planning_time": 1.072862
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id     sales  number_sales channel  i_brand_id  i_class_id  i_category_id       sales  number_sales\n0    store     7011007          11              9  17422.19             5   store     7011007          11              9    17422.19             5\n1    store     7011007          11              9  17422.19             5   store     3002001           2              3  7271832.68          1940\n2    store     7011007          11              9  17422.19             5   store     9012002          12              9  1036193.27           268\n3    store     7011007          11              9  17422.19             5   store     8016007          16              8   396752.24           108\n4    store     7011007          11              9  17422.19             5   store     1003001           3              5   245701.12            73\n5    store     7011007          11              9  17422.19             5   store     1003002           3              1  8489408.10          2244\n6    store     7011007          11              9  17422.19             5   store     2001002           1              2  8887122.24          2374\n7    store     7011007          11              9  17422.19             5   store     1004001           3              1    43710.68            11\n8    store     7011007          11              9  17422.19             5   store     3002002           2              3  8640465.25          2300\n9    store     7011007          11              9  17422.19             5   store     7002005           2              5    14686.78             4\n10   store     7011007          11              9  17422.19             5   store     9009003           9              9   781369.65           225\n11   store     7011007          11              9  17422.19             5   store     1001001           1              1  6404262.37          1762\n12   store     7011007          11              9  17422.19             5   store     6015001           1              5     8222.85             4\n13   store     7011007          11              9  17422.19             5   store     8010001          10              8   331302.18            98\n14   store     7011007          11              9  17422.19             5   store     6006008           6              6   440887.19           129\n15   store     7011007          11              9  17422.19             5   store     2004001           4              2  6585735.74          1833\n16   store     7011007          11              9  17422.19             5   store     5003002           3              5  8550759.54          2362\n17   store     7011007          11              9  17422.19             5   store     3001001           1              2   222237.69            63\n18   store     7011007          11              9  17422.19             5   store     9014012          14              9   267499.41            84\n...*/"
    },
    {
        "input": "WITH cross_items \n     AS (SELECT i_item_sk ss_item_sk \n         FROM   item, \n                (SELECT iss.i_brand_id    brand_id, \n                        iss.i_class_id    class_id, \n                        iss.i_category_id category_id \n                 FROM   store_sales, \n                        item iss, \n                        date_dim d1 \n                 WHERE  ss_item_sk = iss.i_item_sk \n                        AND ss_sold_date_sk = d1.d_date_sk \n                        AND d1.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT ics.i_brand_id, \n                        ics.i_class_id, \n                        ics.i_category_id \n                 FROM   catalog_sales, \n                        item ics, \n                        date_dim d2 \n                 WHERE  cs_item_sk = ics.i_item_sk \n                        AND cs_sold_date_sk = d2.d_date_sk \n                        AND d2.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT iws.i_brand_id, \n                        iws.i_class_id, \n                        iws.i_category_id \n                 FROM   web_sales, \n                        item iws, \n                        date_dim d3 \n                 WHERE  ws_item_sk = iws.i_item_sk \n                        AND ws_sold_date_sk = d3.d_date_sk \n                        AND d3.d_year BETWEEN 1999 AND 1999 + 2) x \n         WHERE  i_brand_id = brand_id \n                AND i_class_id = class_id \n                AND i_category_id = category_id), \n     avg_sales \n     AS (SELECT Avg(quantity * list_price) average_sales \n         FROM   (SELECT ss_quantity   quantity, \n                        ss_list_price list_price \n                 FROM   store_sales, \n                        date_dim \n                 WHERE  ss_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT cs_quantity   quantity, \n                        cs_list_price list_price \n                 FROM   catalog_sales, \n                        date_dim \n                 WHERE  cs_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT ws_quantity   quantity, \n                        ws_list_price list_price \n                 FROM   web_sales, \n                        date_dim \n                 WHERE  ws_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2) x) \nSELECT  * \nFROM   (SELECT 'store'                          channel, \n               iss.i_brand_id, \n               iss.i_class_id, \n               iss.i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item iss, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = iss.i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 + 1 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY iss.i_brand_id, \n                  iss.i_class_id, \n                  iss.i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) this_year, \n       (SELECT 'store'                          channel, \n               iss.i_brand_id, \n               iss.i_class_id, \n               iss.i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item iss, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = iss.i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1998 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY iss.i_brand_id, \n                  iss.i_class_id, \n                  iss.i_category_id) previous_year\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"ISS\" AS ( SELECT \"ISS\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ISS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ISS\" ) , \"X\" AS ( SELECT \"ISS\".\"I_BRAND_ID\" AS \"BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"CATEGORY_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"D1\".\"D_YEAR\" <= 2001 AND \"D1\".\"D_YEAR\" >= 1999 JOIN \"ISS\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" INTERSECT SELECT \"ICS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ICS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ICS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D2\".\"D_DATE_SK\" AND \"D2\".\"D_YEAR\" <= 2001 AND \"D2\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ICS\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ICS\".\"I_ITEM_SK\" INTERSECT SELECT \"IWS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"IWS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"IWS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D3\" ON \"D3\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D3\".\"D_YEAR\" <= 2001 AND \"D3\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"IWS\" ON \"IWS\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" <= 2001 AND \"DATE_DIM\".\"D_YEAR\" >= 1999 ) , \"X_2\" AS ( SELECT \"STORE_SALES\".\"SS_QUANTITY\" AS \"QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_QUANTITY\" AS \"QUANTITY\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" UNION ALL SELECT \"WEB_SALES\".\"WS_QUANTITY\" AS \"QUANTITY\" , \"WEB_SALES\".\"WS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) , \"AVG_SALES\" AS ( SELECT AVG ( \"X\".\"QUANTITY\" * \"X\".\"LIST_PRICE\" ) AS \"AVERAGE_SALES\" FROM \"X_2\" AS \"X\" ) , \"STORE_SALES_4\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"SS_QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"SS_LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"SS_ITEM_SK\" FROM \"ITEM\" AS \"ITEM\" JOIN \"X\" AS \"X\" ON \"ITEM\".\"I_BRAND_ID\" = \"X\".\"BRAND_ID\" AND \"ITEM\".\"I_CATEGORY_ID\" = \"X\".\"CATEGORY_ID\" AND \"ITEM\".\"I_CLASS_ID\" = \"X\".\"CLASS_ID\" GROUP BY \"ITEM\".\"I_ITEM_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"THIS_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ISS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"AVG_SALES\" AS \"AVG_SALES\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ISS\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 2000 WHERE NOT \"_U_0\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ISS\".\"I_BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" HAVING MAX ( \"AVG_SALES\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) , \"PREVIOUS_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ISS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" LEFT JOIN \"_U_0\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ISS\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 1998 WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ISS\".\"I_BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" ) SELECT \"THIS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"THIS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"THIS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"THIS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"THIS_YEAR\".\"SALES\" AS \"SALES\" , \"THIS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"PREVIOUS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"PREVIOUS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"PREVIOUS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"PREVIOUS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"PREVIOUS_YEAR\".\"SALES\" AS \"SALES\" , \"PREVIOUS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"THIS_YEAR\" AS \"THIS_YEAR\" CROSS JOIN \"PREVIOUS_YEAR\" AS \"PREVIOUS_YEAR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"ISS\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ISS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ISS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.170078,
                    "execution_time": 0.048939,
                    "compile_time": 0.000261,
                    "planning_time": 0.025198,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.233834,
                    "execution_time": 0.048765,
                    "compile_time": 0.000265,
                    "planning_time": 0.088384,
                    "create_size": 896
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"SPEQLITE_TEMP_TABLE_15\".\"I_BRAND_ID\" AS \"BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CLASS_ID\" AS \"CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CATEGORY_ID\" AS \"CATEGORY_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"D1\".\"D_YEAR\" <= 2001 AND \"D1\".\"D_YEAR\" >= 1999 JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" INTERSECT SELECT \"ICS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ICS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ICS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D2\".\"D_DATE_SK\" AND \"D2\".\"D_YEAR\" <= 2001 AND \"D2\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ICS\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ICS\".\"I_ITEM_SK\" INTERSECT SELECT \"IWS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"IWS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"IWS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D3\" ON \"D3\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D3\".\"D_YEAR\" <= 2001 AND \"D3\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"IWS\" ON \"IWS\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.553727,
                    "execution_time": 0.425208,
                    "compile_time": 0.000756,
                    "planning_time": 0.079323,
                    "create_size": 96
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.643522,
                    "execution_time": 0.397849,
                    "compile_time": 0.000751,
                    "planning_time": 0.196405,
                    "create_size": 96
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT AVG ( \"SPEQLITE_TEMP_TABLE_16\".\"QUANTITY\" * \"SPEQLITE_TEMP_TABLE_16\".\"LIST_PRICE\" ) AS \"AVERAGE_SALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.085054,
                    "execution_time": 0.056128,
                    "compile_time": 0.000292,
                    "planning_time": 0.003451,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.143914,
                    "execution_time": 0.055887,
                    "compile_time": 0.000315,
                    "planning_time": 0.060692,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"ITEM\".\"I_ITEM_SK\" AS \"SS_ITEM_SK\" FROM \"ITEM\" AS \"ITEM\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"ITEM\".\"I_BRAND_ID\" = \"SPEQLITE_TEMP_TABLE_16\".\"BRAND_ID\" AND \"ITEM\".\"I_CATEGORY_ID\" = \"SPEQLITE_TEMP_TABLE_16\".\"CATEGORY_ID\" AND \"ITEM\".\"I_CLASS_ID\" = \"SPEQLITE_TEMP_TABLE_16\".\"CLASS_ID\" GROUP BY \"ITEM\".\"I_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.119402,
                    "execution_time": 0.050323,
                    "compile_time": 0.000313,
                    "planning_time": 0.027537,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.309637,
                    "execution_time": 0.049906,
                    "compile_time": 0.125056,
                    "planning_time": 0.093186,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT 'store' AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"STORE_SALES\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ\" AND \"SPEQLITE_TEMP_TABLE_3\".\"D_DOM\" = 25 AND \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" = 12 AND \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" = 2000 WHERE NOT \"SPEQLITE_TEMP_TABLE_18\".\"SS_ITEM_SK\" IS NULL GROUP BY \"SPEQLITE_TEMP_TABLE_15\".\"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CATEGORY_ID\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.244147,
                    "execution_time": 0.110471,
                    "compile_time": 0.049859,
                    "planning_time": 0.040815,
                    "create_size": 108
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.72606,
                    "execution_time": 0.124614,
                    "compile_time": 6.444339,
                    "planning_time": 0.109556,
                    "create_size": 108
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT 'store' AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"STORE_SALES\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ\" AND \"SPEQLITE_TEMP_TABLE_3\".\"D_DOM\" = 25 AND \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" = 12 AND \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" = 1998 WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"SPEQLITE_TEMP_TABLE_15\".\"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CATEGORY_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.218278,
                    "execution_time": 0.100324,
                    "compile_time": 0.03732,
                    "planning_time": 0.040805,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.522155,
                    "execution_time": 0.100202,
                    "compile_time": 3.270901,
                    "planning_time": 0.102487,
                    "create_size": 18
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"SPEQLITE_TEMP_TABLE_19\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_19\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_19\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_19\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_19\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_19\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_20\".\"CHANNEL\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_BRAND_ID\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_CLASS_ID\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_20\".\"SALES\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_20\".\"NUMBER_SALES\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.637148,
                    "execution_time": 0.964379,
                    "compile_time": 0.000614,
                    "planning_time": 0.006184,
                    "create_size": 1920
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.299666,
                    "execution_time": 1.561864,
                    "compile_time": 0.001693,
                    "planning_time": 0.063651,
                    "create_size": 1920
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_21\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_21\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_21\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_21\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_21\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_21\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_21\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_21\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_21\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_21\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_21\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" LIMIT 21",
                "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id      sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     4001001           1              9  251425.86            61         store           7015005                15                    7     743885.06                  204\n1    store     4001001           1              9  251425.86            61         store           9013005                13                    9     586999.86                  166\n2    store     4001001           1              9  251425.86            61         store          10016013                16                   10     293979.94                   69\n3    store     4001001           1              9  251425.86            61         store           7007010                 7                    7     473690.61                  127\n4    store     4001001           1              9  251425.86            61         store           8001003                 1                    8     582901.19                  177\n5    store     4001001           1              9  251425.86            61         store           6001004                 1                    6     382491.49                   92\n6    store     4001001           1              9  251425.86            61         store           8005010                 5                    8     475047.47                  113\n7    store     4001001           1              9  251425.86            61         store           8013003                13                    8     680518.95                  184\n8    store     4001001           1              9  251425.86            61         store          10011004                11                   10     391401.30                  114\n9    store     4001001           1              9  251425.86            61         store           7001009                 1                    7     928791.59                  237\n10   store     4001001           1              9  251425.86            61         store          10013006                13                   10     418500.03                  119\n11   store     4001001           1              9  251425.86            61         store           6016004                16                    6     383956.96                  121\n12   store     4001001           1              9  251425.86            61         store          10010013                10                   10     262041.02                   83\n13   store     4001001           1              9  251425.86            61         store           7006004                 6                    7     276120.09                   74\n14   store     4001001           1              9  251425.86            61         store           7013005                13                    7     645616.06                  159\n15   store     4001001           1              9  251425.86            61         store          10005007                 5                   10     293974.30                   85\n16   store     4001001           1              9  251425.86            61         store           6012008                12                    6     423381.91                  114\n17   store     4001001           1              9  251425.86            61         store           7001002                 1                    7     228559.66                   73\n18   store     4001001           1              9  251425.86            61         store           6011007                11                    6     699905.89                  190\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020247,
                    "execution_time": 0.008569,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004787
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057421,
                    "execution_time": 0.008222,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.040639
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_19\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_19\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_19\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_19\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_19\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_20\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_20\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_21\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_21\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_21\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_21\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_21\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_21\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_21\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_21\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_21\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_21\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_21\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\""
            }
        ],
        "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id      sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     4001001           1              9  251425.86            61         store           7015005                15                    7     743885.06                  204\n1    store     4001001           1              9  251425.86            61         store           9013005                13                    9     586999.86                  166\n2    store     4001001           1              9  251425.86            61         store          10016013                16                   10     293979.94                   69\n3    store     4001001           1              9  251425.86            61         store           7007010                 7                    7     473690.61                  127\n4    store     4001001           1              9  251425.86            61         store           8001003                 1                    8     582901.19                  177\n5    store     4001001           1              9  251425.86            61         store           6001004                 1                    6     382491.49                   92\n6    store     4001001           1              9  251425.86            61         store           8005010                 5                    8     475047.47                  113\n7    store     4001001           1              9  251425.86            61         store           8013003                13                    8     680518.95                  184\n8    store     4001001           1              9  251425.86            61         store          10011004                11                   10     391401.30                  114\n9    store     4001001           1              9  251425.86            61         store           7001009                 1                    7     928791.59                  237\n10   store     4001001           1              9  251425.86            61         store          10013006                13                   10     418500.03                  119\n11   store     4001001           1              9  251425.86            61         store           6016004                16                    6     383956.96                  121\n12   store     4001001           1              9  251425.86            61         store          10010013                10                   10     262041.02                   83\n13   store     4001001           1              9  251425.86            61         store           7006004                 6                    7     276120.09                   74\n14   store     4001001           1              9  251425.86            61         store           7013005                13                    7     645616.06                  159\n15   store     4001001           1              9  251425.86            61         store          10005007                 5                   10     293974.30                   85\n16   store     4001001           1              9  251425.86            61         store           6012008                12                    6     423381.91                  114\n17   store     4001001           1              9  251425.86            61         store           7001002                 1                    7     228559.66                   73\n18   store     4001001           1              9  251425.86            61         store           6011007                11                    6     699905.89                  190\n...*/"
    },
    {
        "input": "WITH cross_items \n     AS (SELECT i_item_sk ss_item_sk \n         FROM   item, \n                (SELECT iss.i_brand_id    brand_id, \n                        iss.i_class_id    class_id, \n                        iss.i_category_id category_id \n                 FROM   store_sales, \n                        item iss, \n                        date_dim d1 \n                 WHERE  ss_item_sk = iss.i_item_sk \n                        AND ss_sold_date_sk = d1.d_date_sk \n                        AND d1.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT ics.i_brand_id, \n                        ics.i_class_id, \n                        ics.i_category_id \n                 FROM   catalog_sales, \n                        item ics, \n                        date_dim d2 \n                 WHERE  cs_item_sk = ics.i_item_sk \n                        AND cs_sold_date_sk = d2.d_date_sk \n                        AND d2.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT iws.i_brand_id, \n                        iws.i_class_id, \n                        iws.i_category_id \n                 FROM   web_sales, \n                        item iws, \n                        date_dim d3 \n                 WHERE  ws_item_sk = iws.i_item_sk \n                        AND ws_sold_date_sk = d3.d_date_sk \n                        AND d3.d_year BETWEEN 1999 AND 1999 + 2) x \n         WHERE  i_brand_id = brand_id \n                AND i_class_id = class_id \n                AND i_category_id = category_id), \n     avg_sales \n     AS (SELECT Avg(quantity * list_price) average_sales \n         FROM   (SELECT ss_quantity   quantity, \n                        ss_list_price list_price \n                 FROM   store_sales, \n                        date_dim \n                 WHERE  ss_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT cs_quantity   quantity, \n                        cs_list_price list_price \n                 FROM   catalog_sales, \n                        date_dim \n                 WHERE  cs_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT ws_quantity   quantity, \n                        ws_list_price list_price \n                 FROM   web_sales, \n                        date_dim \n                 WHERE  ws_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2) x) \nSELECT  * \nFROM   (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 + 1 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) this_year, \n       (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) last_year\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"X\" AS ( SELECT \"ISS\".\"I_BRAND_ID\" AS \"BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"CATEGORY_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"D1\".\"D_YEAR\" <= 2001 AND \"D1\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" INTERSECT SELECT \"ICS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ICS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ICS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D2\".\"D_DATE_SK\" AND \"D2\".\"D_YEAR\" <= 2001 AND \"D2\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ICS\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ICS\".\"I_ITEM_SK\" INTERSECT SELECT \"IWS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"IWS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"IWS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D3\" ON \"D3\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D3\".\"D_YEAR\" <= 2001 AND \"D3\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"IWS\" ON \"IWS\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" <= 2001 AND \"DATE_DIM\".\"D_YEAR\" >= 1999 ) , \"X_2\" AS ( SELECT \"STORE_SALES\".\"SS_QUANTITY\" AS \"QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_QUANTITY\" AS \"QUANTITY\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" UNION ALL SELECT \"WEB_SALES\".\"WS_QUANTITY\" AS \"QUANTITY\" , \"WEB_SALES\".\"WS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) , \"AVG_SALES\" AS ( SELECT AVG ( \"X\".\"QUANTITY\" * \"X\".\"LIST_PRICE\" ) AS \"AVERAGE_SALES\" FROM \"X_2\" AS \"X\" ) , \"STORE_SALES_4\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"SS_QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"SS_LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"_U_2\" AS ( SELECT \"AVG_SALES\".\"AVERAGE_SALES\" AS \"AVERAGE_SALES\" FROM \"AVG_SALES\" AS \"AVG_SALES\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"SS_ITEM_SK\" FROM \"ITEM_2\" AS \"ITEM\" JOIN \"X\" AS \"X\" ON \"ITEM\".\"I_BRAND_ID\" = \"X\".\"BRAND_ID\" AND \"ITEM\".\"I_CATEGORY_ID\" = \"X\".\"CATEGORY_ID\" AND \"ITEM\".\"I_CLASS_ID\" = \"X\".\"CLASS_ID\" GROUP BY \"ITEM\".\"I_ITEM_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"THIS_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_2\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 2000 WHERE NOT \"_U_0\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_2\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) , \"LAST_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_5\" LEFT JOIN \"_U_0\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 1999 WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_5\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) SELECT \"THIS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"THIS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"THIS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"THIS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"THIS_YEAR\".\"SALES\" AS \"SALES\" , \"THIS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"LAST_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"LAST_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"LAST_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"LAST_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"LAST_YEAR\".\"SALES\" AS \"SALES\" , \"LAST_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"THIS_YEAR\" AS \"THIS_YEAR\" CROSS JOIN \"LAST_YEAR\" AS \"LAST_YEAR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_22\" AS SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"STORE_SALES\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ\" AND \"SPEQLITE_TEMP_TABLE_3\".\"D_DOM\" = 25 AND \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" = 12 AND \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" = 2000 WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_6\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.190882,
                    "execution_time": 0.109726,
                    "compile_time": 0.000635,
                    "planning_time": 0.038965,
                    "create_size": 108
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.275046,
                    "execution_time": 0.124524,
                    "compile_time": 0.00058,
                    "planning_time": 0.105879,
                    "create_size": 108
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_23\" AS SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"STORE_SALES\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"_U_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ\" AND \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" = 1999 WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_5\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.460604,
                    "execution_time": 0.374587,
                    "compile_time": 0.000609,
                    "planning_time": 0.039768,
                    "create_size": 81
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.534956,
                    "execution_time": 0.376219,
                    "compile_time": 0.001762,
                    "planning_time": 0.105505,
                    "create_size": 81
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_24\" AS SELECT \"SPEQLITE_TEMP_TABLE_22\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_22\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_23\".\"CHANNEL\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_23\".\"I_BRAND_ID\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_23\".\"I_CLASS_ID\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_23\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_23\".\"SALES\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_23\".\"NUMBER_SALES\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.378491,
                    "execution_time": 2.696924,
                    "compile_time": 0.000584,
                    "planning_time": 0.005955,
                    "create_size": 3456
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.07852,
                    "execution_time": 5.318687,
                    "compile_time": 0.000594,
                    "planning_time": 0.064132,
                    "create_size": 3456
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_24\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_24\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_24\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_24\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_24\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_24\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_24\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_24\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_24\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_24\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_24\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_24\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" LIMIT 21",
                "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id      sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     6002005           2              6  414615.46           111         store          10010002                10                   10   59200362.24                16077\n1    store    10004010           4             10  232002.77            61         store          10010002                10                   10   59200362.24                16077\n2    store     7015004           3              7    4671.17             2         store          10010002                10                   10   59200362.24                16077\n3    store     7004007           4              4   12629.96             3         store          10010002                10                   10   59200362.24                16077\n4    store    10012009          12             10  162737.26            42         store          10010002                10                   10   59200362.24                16077\n5    store     3002002           5              3   16079.44             6         store          10010002                10                   10   59200362.24                16077\n6    store     1003001          11              8   50344.60            15         store          10010002                10                   10   59200362.24                16077\n7    store     7004009           1              3   14620.92             4         store          10010002                10                   10   59200362.24                16077\n8    store     6014004          14              6  470038.87           139         store          10010002                10                   10   59200362.24                16077\n9    store     9011003          11              9  840372.51           230         store          10010002                10                   10   59200362.24                16077\n10   store     8005001           5              8  349350.90            87         store          10010002                10                   10   59200362.24                16077\n11   store     8016004           4              8   26990.95             8         store          10010002                10                   10   59200362.24                16077\n12   store     8009007           9             10   25332.69             3         store          10010002                10                   10   59200362.24                16077\n13   store     8006003           6              2   13844.89             3         store          10010002                10                   10   59200362.24                16077\n14   store     9016009          16              9  708466.75           202         store          10010002                10                   10   59200362.24                16077\n15   store     1003002           7              1   12143.98             3         store          10010002                10                   10   59200362.24                16077\n16   store     6016005          16              6  370378.87           104         store          10010002                10                   10   59200362.24                16077\n17   store     5002001           2              4  371689.93            97         store          10010002                10                   10   59200362.24                16077\n18   store     9005002           5              9  807572.71           232         store          10010002                10                   10   59200362.24                16077\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019237,
                    "execution_time": 0.007703,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004826
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.059613,
                    "execution_time": 0.009041,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.040378
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_22\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_23\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_23\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_23\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_24\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_24\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_24\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_24\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_24\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_24\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_24\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_24\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_24\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_24\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_24\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_24\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\""
            }
        ],
        "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id      sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     6002005           2              6  414615.46           111         store          10010002                10                   10   59200362.24                16077\n1    store    10004010           4             10  232002.77            61         store          10010002                10                   10   59200362.24                16077\n2    store     7015004           3              7    4671.17             2         store          10010002                10                   10   59200362.24                16077\n3    store     7004007           4              4   12629.96             3         store          10010002                10                   10   59200362.24                16077\n4    store    10012009          12             10  162737.26            42         store          10010002                10                   10   59200362.24                16077\n5    store     3002002           5              3   16079.44             6         store          10010002                10                   10   59200362.24                16077\n6    store     1003001          11              8   50344.60            15         store          10010002                10                   10   59200362.24                16077\n7    store     7004009           1              3   14620.92             4         store          10010002                10                   10   59200362.24                16077\n8    store     6014004          14              6  470038.87           139         store          10010002                10                   10   59200362.24                16077\n9    store     9011003          11              9  840372.51           230         store          10010002                10                   10   59200362.24                16077\n10   store     8005001           5              8  349350.90            87         store          10010002                10                   10   59200362.24                16077\n11   store     8016004           4              8   26990.95             8         store          10010002                10                   10   59200362.24                16077\n12   store     8009007           9             10   25332.69             3         store          10010002                10                   10   59200362.24                16077\n13   store     8006003           6              2   13844.89             3         store          10010002                10                   10   59200362.24                16077\n14   store     9016009          16              9  708466.75           202         store          10010002                10                   10   59200362.24                16077\n15   store     1003002           7              1   12143.98             3         store          10010002                10                   10   59200362.24                16077\n16   store     6016005          16              6  370378.87           104         store          10010002                10                   10   59200362.24                16077\n17   store     5002001           2              4  371689.93            97         store          10010002                10                   10   59200362.24                16077\n18   store     9005002           5              9  807572.71           232         store          10010002                10                   10   59200362.24                16077\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "WITH cross_items \n     AS (SELECT i_item_sk ss_item_sk \n         FROM   item, \n                (SELECT iss.i_brand_id    brand_id, \n                        iss.i_class_id    class_id, \n                        iss.i_category_id category_id \n                 FROM   store_sales, \n                        item iss, \n                        date_dim d1 \n                 WHERE  ss_item_sk = iss.i_item_sk \n                        AND ss_sold_date_sk = d1.d_date_sk \n                        AND d1.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT ics.i_brand_id, \n                        ics.i_class_id, \n                        ics.i_category_id \n                 FROM   catalog_sales, \n                        item ics, \n                        date_dim d2 \n                 WHERE  cs_item_sk = ics.i_item_sk \n                        AND cs_sold_date_sk = d2.d_date_sk \n                        AND d2.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT iws.i_brand_id, \n                        iws.i_class_id, \n                        iws.i_category_id \n                 FROM   web_sales, \n                        item iws, \n                        date_dim d3 \n                 WHERE  ws_item_sk = iws.i_item_sk \n                        AND ws_sold_date_sk = d3.d_date_sk \n                        AND d3.d_year BETWEEN 1999 AND 1999 + 2) x \n         WHERE  i_brand_id = brand_id \n                AND i_class_id = class_id \n                AND i_category_id = category_id), \n     avg_sales \n     AS (SELECT Avg(quantity * list_price) average_sales \n         FROM   (SELECT ss_quantity   quantity, \n                        ss_list_price list_price \n                 FROM   store_sales, \n                        date_dim \n                 WHERE  ss_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT cs_quantity   quantity, \n                        cs_list_price list_price \n                 FROM   catalog_sales, \n                        date_dim \n                 WHERE  cs_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT ws_quantity   quantity, \n                        ws_list_price list_price \n                 FROM   web_sales, \n                        date_dim \n                 WHERE  ws_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2) x) \nSELECT  * \nFROM   (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 + 1 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) this_year, \n       (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"X\" AS ( SELECT \"ISS\".\"I_BRAND_ID\" AS \"BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"CATEGORY_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"D1\".\"D_YEAR\" <= 2001 AND \"D1\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" INTERSECT SELECT \"ICS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ICS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ICS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D2\".\"D_DATE_SK\" AND \"D2\".\"D_YEAR\" <= 2001 AND \"D2\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ICS\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ICS\".\"I_ITEM_SK\" INTERSECT SELECT \"IWS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"IWS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"IWS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D3\" ON \"D3\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D3\".\"D_YEAR\" <= 2001 AND \"D3\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"IWS\" ON \"IWS\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" <= 2001 AND \"DATE_DIM\".\"D_YEAR\" >= 1999 ) , \"X_2\" AS ( SELECT \"STORE_SALES\".\"SS_QUANTITY\" AS \"QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_QUANTITY\" AS \"QUANTITY\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" UNION ALL SELECT \"WEB_SALES\".\"WS_QUANTITY\" AS \"QUANTITY\" , \"WEB_SALES\".\"WS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) , \"AVG_SALES\" AS ( SELECT AVG ( \"X\".\"QUANTITY\" * \"X\".\"LIST_PRICE\" ) AS \"AVERAGE_SALES\" FROM \"X_2\" AS \"X\" ) , \"STORE_SALES_4\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"SS_QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"SS_LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"SS_ITEM_SK\" FROM \"ITEM_2\" AS \"ITEM\" JOIN \"X\" AS \"X\" ON \"ITEM\".\"I_BRAND_ID\" = \"X\".\"BRAND_ID\" AND \"ITEM\".\"I_CATEGORY_ID\" = \"X\".\"CATEGORY_ID\" AND \"ITEM\".\"I_CLASS_ID\" = \"X\".\"CLASS_ID\" GROUP BY \"ITEM\".\"I_ITEM_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"THIS_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"AVG_SALES\" AS \"AVG_SALES\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 2000 WHERE NOT \"_U_0\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"AVG_SALES\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) , \"_Q_0\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" LEFT JOIN \"_U_0\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 1999 WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" ) SELECT \"THIS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"THIS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"THIS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"THIS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"THIS_YEAR\".\"SALES\" AS \"SALES\" , \"THIS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"_Q_0\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"_Q_0\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"_Q_0\".\"SALES\" AS \"SALES\" , \"_Q_0\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"THIS_YEAR\" AS \"THIS_YEAR\" CROSS JOIN \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_25\" AS SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"STORE_SALES\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ\" AND \"SPEQLITE_TEMP_TABLE_3\".\"D_DOM\" = 25 AND \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" = 12 AND \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" = 2000 WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_5\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.189989,
                    "execution_time": 0.107857,
                    "compile_time": 0.000605,
                    "planning_time": 0.039807,
                    "create_size": 108
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.265224,
                    "execution_time": 0.121082,
                    "compile_time": 0.000569,
                    "planning_time": 0.103929,
                    "create_size": 108
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_26\" AS SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"STORE_SALES\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ\" AND \"SPEQLITE_TEMP_TABLE_3\".\"D_DOM\" = 25 AND \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" = 12 AND \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" = 1999 WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.166387,
                    "execution_time": 0.090177,
                    "compile_time": 0.000515,
                    "planning_time": 0.037494,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.312817,
                    "execution_time": 0.09398,
                    "compile_time": 0.078257,
                    "planning_time": 0.098758,
                    "create_size": 18
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_27\" AS SELECT \"SPEQLITE_TEMP_TABLE_25\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_25\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_25\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_25\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_25\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_25\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_26\".\"CHANNEL\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_26\".\"I_BRAND_ID\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_26\".\"I_CLASS_ID\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_26\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_26\".\"SALES\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_26\".\"NUMBER_SALES\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_26\" AS \"SPEQLITE_TEMP_TABLE_26\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.584675,
                    "execution_time": 0.920047,
                    "compile_time": 0.00056,
                    "planning_time": 0.006315,
                    "create_size": 1920
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.238567,
                    "execution_time": 2.51063,
                    "compile_time": 0.000596,
                    "planning_time": 0.072169,
                    "create_size": 1920
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_27\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_27\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_27\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_27\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_27\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_27\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_27\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_27\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_27\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_27\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_27\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_27\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_27\" AS \"SPEQLITE_TEMP_TABLE_27\" LIMIT 21",
                "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id     sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     9003005           3              2  45789.84            13         store           8003002                 3                    8     432160.24                  129\n1    store     9003005           3              2  45789.84            13         store           6008001                 8                    6     867725.73                  227\n2    store     9003005           3              2  45789.84            13         store          10011014                11                   10     430642.21                   99\n3    store     9003005           3              2  45789.84            13         store           7003002                 3                    7     347168.35                   92\n4    store     9003005           3              2  45789.84            13         store           8008001                 8                    8     514222.32                  136\n5    store     9003005           3              2  45789.84            13         store           8011003                11                    8     789534.78                  218\n6    store     9003005           3              2  45789.84            13         store           7011006                11                    7     435846.97                  114\n7    store     9003005           3              2  45789.84            13         store           6015008                15                    6     567071.33                  151\n8    store     9003005           3              2  45789.84            13         store           7013006                13                    7     220493.23                   61\n9    store     9003005           3              2  45789.84            13         store           6003004                 3                    6     503831.65                  129\n10   store     9003005           3              2  45789.84            13         store           8002008                 2                    8     310524.71                   77\n11   store     9003005           3              2  45789.84            13         store          10010012                10                   10     192361.48                   52\n12   store     9003005           3              2  45789.84            13         store           8011001                11                    8     756117.81                  206\n13   store     9003005           3              2  45789.84            13         store           8015002                15                    8     257430.90                   78\n14   store     9003005           3              2  45789.84            13         store          10010007                10                   10     368547.19                   94\n15   store     9003005           3              2  45789.84            13         store           9002008                 2                    9     594737.61                  191\n16   store     9003005           3              2  45789.84            13         store          10015015                15                   10     356748.08                   86\n17   store     9003005           3              2  45789.84            13         store           7013001                13                    7     525285.60                  144\n18   store     9003005           3              2  45789.84            13         store           7013009                13                    7     730051.22                  182\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020711,
                    "execution_time": 0.008708,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.004984
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056538,
                    "execution_time": 0.008476,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.040892
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_25\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_25\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_25\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_25\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_25\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_26\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_26\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_26\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_26\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_26\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_26\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_26\" AS \"SPEQLITE_TEMP_TABLE_26\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_27\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_27\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_27\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_27\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_27\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_27\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_27\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_27\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_27\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_27\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_27\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_27\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_27\" AS \"SPEQLITE_TEMP_TABLE_27\""
            }
        ],
        "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id     sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     9003005           3              2  45789.84            13         store           8003002                 3                    8     432160.24                  129\n1    store     9003005           3              2  45789.84            13         store           6008001                 8                    6     867725.73                  227\n2    store     9003005           3              2  45789.84            13         store          10011014                11                   10     430642.21                   99\n3    store     9003005           3              2  45789.84            13         store           7003002                 3                    7     347168.35                   92\n4    store     9003005           3              2  45789.84            13         store           8008001                 8                    8     514222.32                  136\n5    store     9003005           3              2  45789.84            13         store           8011003                11                    8     789534.78                  218\n6    store     9003005           3              2  45789.84            13         store           7011006                11                    7     435846.97                  114\n7    store     9003005           3              2  45789.84            13         store           6015008                15                    6     567071.33                  151\n8    store     9003005           3              2  45789.84            13         store           7013006                13                    7     220493.23                   61\n9    store     9003005           3              2  45789.84            13         store           6003004                 3                    6     503831.65                  129\n10   store     9003005           3              2  45789.84            13         store           8002008                 2                    8     310524.71                   77\n11   store     9003005           3              2  45789.84            13         store          10010012                10                   10     192361.48                   52\n12   store     9003005           3              2  45789.84            13         store           8011001                11                    8     756117.81                  206\n13   store     9003005           3              2  45789.84            13         store           8015002                15                    8     257430.90                   78\n14   store     9003005           3              2  45789.84            13         store          10010007                10                   10     368547.19                   94\n15   store     9003005           3              2  45789.84            13         store           9002008                 2                    9     594737.61                  191\n16   store     9003005           3              2  45789.84            13         store          10015015                15                   10     356748.08                   86\n17   store     9003005           3              2  45789.84            13         store           7013001                13                    7     525285.60                  144\n18   store     9003005           3              2  45789.84            13         store           7013009                13                    7     730051.22                  182\n...*/"
    },
    {
        "input": "WITH cross_items \n     AS (SELECT i_item_sk ss_item_sk \n         FROM   item, \n                (SELECT iss.i_brand_id    brand_id, \n                        iss.i_class_id    class_id, \n                        iss.i_category_id category_id \n                 FROM   store_sales, \n                        item iss, \n                        date_dim d1 \n                 WHERE  ss_item_sk = iss.i_item_sk \n                        AND ss_sold_date_sk = d1.d_date_sk \n                        AND d1.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT ics.i_brand_id, \n                        ics.i_class_id, \n                        ics.i_category_id \n                 FROM   catalog_sales, \n                        item ics, \n                        date_dim d2 \n                 WHERE  cs_item_sk = ics.i_item_sk \n                        AND cs_sold_date_sk = d2.d_date_sk \n                        AND d2.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT iws.i_brand_id, \n                        iws.i_class_id, \n                        iws.i_category_id \n                 FROM   web_sales, \n                        item iws, \n                        date_dim d3 \n                 WHERE  ws_item_sk = iws.i_item_sk \n                        AND ws_sold_date_sk = d3.d_date_sk \n                        AND d3.d_year BETWEEN 1999 AND 1999 + 2) x \n         WHERE  i_brand_id = brand_id \n                AND i_class_id = class_id \n                AND i_category_id = category_id), \n     avg_sales \n     AS (SELECT Avg(quantity * list_price) average_sales \n         FROM   (SELECT ss_quantity   quantity, \n                        ss_list_price list_price \n                 FROM   store_sales, \n                        date_dim \n                 WHERE  ss_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT cs_quantity   quantity, \n                        cs_list_price list_price \n                 FROM   catalog_sales, \n                        date_dim \n                 WHERE  cs_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT ws_quantity   quantity, \n                        ws_list_price list_price \n                 FROM   web_sales, \n                        date_dim \n                 WHERE  ws_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2) x) \nSELECT  * \nFROM   (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 + 1 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) this_year, \n       (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"X\" AS ( SELECT \"ISS\".\"I_BRAND_ID\" AS \"BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"CATEGORY_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"D1\".\"D_YEAR\" <= 2001 AND \"D1\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" INTERSECT SELECT \"ICS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ICS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ICS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D2\".\"D_DATE_SK\" AND \"D2\".\"D_YEAR\" <= 2001 AND \"D2\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ICS\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ICS\".\"I_ITEM_SK\" INTERSECT SELECT \"IWS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"IWS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"IWS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D3\" ON \"D3\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D3\".\"D_YEAR\" <= 2001 AND \"D3\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"IWS\" ON \"IWS\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" <= 2001 AND \"DATE_DIM\".\"D_YEAR\" >= 1999 ) , \"X_2\" AS ( SELECT \"STORE_SALES\".\"SS_QUANTITY\" AS \"QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_QUANTITY\" AS \"QUANTITY\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" UNION ALL SELECT \"WEB_SALES\".\"WS_QUANTITY\" AS \"QUANTITY\" , \"WEB_SALES\".\"WS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) , \"AVG_SALES\" AS ( SELECT AVG ( \"X\".\"QUANTITY\" * \"X\".\"LIST_PRICE\" ) AS \"AVERAGE_SALES\" FROM \"X_2\" AS \"X\" ) , \"STORE_SALES_4\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"SS_QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"SS_LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"SS_ITEM_SK\" FROM \"ITEM_2\" AS \"ITEM\" JOIN \"X\" AS \"X\" ON \"ITEM\".\"I_BRAND_ID\" = \"X\".\"BRAND_ID\" AND \"ITEM\".\"I_CATEGORY_ID\" = \"X\".\"CATEGORY_ID\" AND \"ITEM\".\"I_CLASS_ID\" = \"X\".\"CLASS_ID\" GROUP BY \"ITEM\".\"I_ITEM_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"THIS_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"AVG_SALES\" AS \"AVG_SALES\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 2000 WHERE NOT \"_U_0\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"AVG_SALES\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) , \"_Q_0\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" LEFT JOIN \"_U_0\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 1999 WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" ) SELECT \"THIS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"THIS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"THIS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"THIS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"THIS_YEAR\".\"SALES\" AS \"SALES\" , \"THIS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"_Q_0\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"_Q_0\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"_Q_0\".\"SALES\" AS \"SALES\" , \"_Q_0\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"THIS_YEAR\" AS \"THIS_YEAR\" CROSS JOIN \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CHANNEL\" AS \"CHANNEL\" , \"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES\" AS \"SALES\" , \"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SALES_COL_10\" AS \"SALES_COL_10\" , \"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_27\" AS \"SPEQLITE_TEMP_TABLE_27\" LIMIT 21",
                "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id     sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     9003005           3              2  45789.84            13         store           9016009                16                    9     823573.64                  217\n1    store     9003005           3              2  45789.84            13         store           6002002                 2                    6     339313.83                  105\n2    store     9003005           3              2  45789.84            13         store           9008011                 8                    9     755631.11                  216\n3    store     9003005           3              2  45789.84            13         store          10002011                 2                   10     178085.57                   47\n4    store     9003005           3              2  45789.84            13         store          10009003                 9                   10     282420.27                   81\n5    store     9003005           3              2  45789.84            13         store          10008004                 8                   10     188563.85                   56\n6    store     9003005           3              2  45789.84            13         store          10004007                 4                   10     203161.52                   58\n7    store     9003005           3              2  45789.84            13         store          10011013                11                   10     443509.68                  115\n8    store     9003005           3              2  45789.84            13         store           8009010                 9                    8     348504.50                   93\n9    store     9003005           3              2  45789.84            13         store          10008007                 8                   10     174597.31                   50\n10   store     9003005           3              2  45789.84            13         store          10006014                 6                   10     165635.05                   46\n11   store     9003005           3              2  45789.84            13         store          10002016                 2                   10     305706.92                   83\n12   store     9003005           3              2  45789.84            13         store          10001004                 1                   10     330505.17                   80\n13   store     9003005           3              2  45789.84            13         store          10004006                 4                   10     169685.04                   54\n14   store     9003005           3              2  45789.84            13         store           8011010                11                    8     371040.54                   87\n15   store     9003005           3              2  45789.84            13         store          10002009                 2                   10     170759.82                   46\n16   store     9003005           3              2  45789.84            13         store           6011002                11                    6     292473.55                   84\n17   store     9003005           3              2  45789.84            13         store          10014013                14                   10     289355.04                   85\n18   store     9003005           3              2  45789.84            13         store           8011008                11                    8     269938.69                   85\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020433,
                    "execution_time": 0.008387,
                    "compile_time": 6e-05,
                    "planning_time": 0.004997
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055211,
                    "execution_time": 0.008285,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.040002
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_25\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_25\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_25\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_25\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_25\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_26\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_26\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_26\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_26\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_26\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_26\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_26\" AS \"SPEQLITE_TEMP_TABLE_26\"",
                "rewrite": "SELECT \"CHANNEL\" AS \"CHANNEL\", \"I_BRAND_ID\" AS \"I_BRAND_ID\", \"I_CLASS_ID\" AS \"I_CLASS_ID\", \"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\", \"SALES\" AS \"SALES\", \"NUMBER_SALES\" AS \"NUMBER_SALES\", \"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\", \"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\", \"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\", \"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\", \"SALES_COL_10\" AS \"SALES_COL_10\", \"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_27\" AS \"SPEQLITE_TEMP_TABLE_27\""
            }
        ],
        "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id     sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     9003005           3              2  45789.84            13         store           9016009                16                    9     823573.64                  217\n1    store     9003005           3              2  45789.84            13         store           6002002                 2                    6     339313.83                  105\n2    store     9003005           3              2  45789.84            13         store           9008011                 8                    9     755631.11                  216\n3    store     9003005           3              2  45789.84            13         store          10002011                 2                   10     178085.57                   47\n4    store     9003005           3              2  45789.84            13         store          10009003                 9                   10     282420.27                   81\n5    store     9003005           3              2  45789.84            13         store          10008004                 8                   10     188563.85                   56\n6    store     9003005           3              2  45789.84            13         store          10004007                 4                   10     203161.52                   58\n7    store     9003005           3              2  45789.84            13         store          10011013                11                   10     443509.68                  115\n8    store     9003005           3              2  45789.84            13         store           8009010                 9                    8     348504.50                   93\n9    store     9003005           3              2  45789.84            13         store          10008007                 8                   10     174597.31                   50\n10   store     9003005           3              2  45789.84            13         store          10006014                 6                   10     165635.05                   46\n11   store     9003005           3              2  45789.84            13         store          10002016                 2                   10     305706.92                   83\n12   store     9003005           3              2  45789.84            13         store          10001004                 1                   10     330505.17                   80\n13   store     9003005           3              2  45789.84            13         store          10004006                 4                   10     169685.04                   54\n14   store     9003005           3              2  45789.84            13         store           8011010                11                    8     371040.54                   87\n15   store     9003005           3              2  45789.84            13         store          10002009                 2                   10     170759.82                   46\n16   store     9003005           3              2  45789.84            13         store           6011002                11                    6     292473.55                   84\n17   store     9003005           3              2  45789.84            13         store          10014013                14                   10     289355.04                   85\n18   store     9003005           3              2  45789.84            13         store           8011008                11                    8     269938.69                   85\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "WITH cross_items \n     AS (SELECT i_item_sk ss_item_sk \n         FROM   item, \n                (SELECT iss.i_brand_id    brand_id, \n                        iss.i_class_id    class_id, \n                        iss.i_category_id category_id \n                 FROM   store_sales, \n                        item iss, \n                        date_dim d1 \n                 WHERE  ss_item_sk = iss.i_item_sk \n                        AND ss_sold_date_sk = d1.d_date_sk \n                        AND d1.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT ics.i_brand_id, \n                        ics.i_class_id, \n                        ics.i_category_id \n                 FROM   catalog_sales, \n                        item ics, \n                        date_dim d2 \n                 WHERE  cs_item_sk = ics.i_item_sk \n                        AND cs_sold_date_sk = d2.d_date_sk \n                        AND d2.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT iws.i_brand_id, \n                        iws.i_class_id, \n                        iws.i_category_id \n                 FROM   web_sales, \n                        item iws, \n                        date_dim d3 \n                 WHERE  ws_item_sk = iws.i_item_sk \n                        AND ws_sold_date_sk = d3.d_date_sk \n                        AND d3.d_year BETWEEN 1999 AND 1999 + 2) x \n         WHERE  i_brand_id = brand_id \n                AND i_class_id = class_id \n                AND i_category_id = category_id), \n     avg_sales \n     AS (SELECT Avg(quantity * list_price) average_sales \n         FROM   (SELECT ss_quantity   quantity, \n                        ss_list_price list_price \n                 FROM   store_sales, \n                        date_dim \n                 WHERE  ss_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT cs_quantity   quantity, \n                        cs_list_price list_price \n                 FROM   catalog_sales, \n                        date_dim \n                 WHERE  cs_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT ws_quantity   quantity, \n                        ws_list_price list_price \n                 FROM   web_sales, \n                        date_dim \n                 WHERE  ws_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2) x) \nSELECT  * \nFROM   (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 + 1 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) this_year, \n       (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"X\" AS ( SELECT \"ISS\".\"I_BRAND_ID\" AS \"BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"CATEGORY_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"D1\".\"D_YEAR\" <= 2001 AND \"D1\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" INTERSECT SELECT \"ICS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ICS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ICS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D2\".\"D_DATE_SK\" AND \"D2\".\"D_YEAR\" <= 2001 AND \"D2\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ICS\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ICS\".\"I_ITEM_SK\" INTERSECT SELECT \"IWS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"IWS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"IWS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D3\" ON \"D3\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D3\".\"D_YEAR\" <= 2001 AND \"D3\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"IWS\" ON \"IWS\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" <= 2001 AND \"DATE_DIM\".\"D_YEAR\" >= 1999 ) , \"X_2\" AS ( SELECT \"STORE_SALES\".\"SS_QUANTITY\" AS \"QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_QUANTITY\" AS \"QUANTITY\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" UNION ALL SELECT \"WEB_SALES\".\"WS_QUANTITY\" AS \"QUANTITY\" , \"WEB_SALES\".\"WS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) , \"AVG_SALES\" AS ( SELECT AVG ( \"X\".\"QUANTITY\" * \"X\".\"LIST_PRICE\" ) AS \"AVERAGE_SALES\" FROM \"X_2\" AS \"X\" ) , \"STORE_SALES_4\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"SS_QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"SS_LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"_U_2\" AS ( SELECT \"AVG_SALES\".\"AVERAGE_SALES\" AS \"AVERAGE_SALES\" FROM \"AVG_SALES\" AS \"AVG_SALES\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"SS_ITEM_SK\" FROM \"ITEM_2\" AS \"ITEM\" JOIN \"X\" AS \"X\" ON \"ITEM\".\"I_BRAND_ID\" = \"X\".\"BRAND_ID\" AND \"ITEM\".\"I_CATEGORY_ID\" = \"X\".\"CATEGORY_ID\" AND \"ITEM\".\"I_CLASS_ID\" = \"X\".\"CLASS_ID\" GROUP BY \"ITEM\".\"I_ITEM_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"THIS_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_2\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 2000 WHERE NOT \"_U_0\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_2\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) , \"_Q_0\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_5\" LEFT JOIN \"_U_0\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 1999 WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_5\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) SELECT \"THIS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"THIS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"THIS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"THIS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"THIS_YEAR\".\"SALES\" AS \"SALES\" , \"THIS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"_Q_0\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"_Q_0\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"_Q_0\".\"SALES\" AS \"SALES\" , \"_Q_0\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"THIS_YEAR\" AS \"THIS_YEAR\" CROSS JOIN \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_28\" AS SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"STORE_SALES\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"_U_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ\" AND \"SPEQLITE_TEMP_TABLE_3\".\"D_DOM\" = 25 AND \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" = 12 AND \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" = 1999 WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_5\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.174899,
                    "execution_time": 0.104126,
                    "compile_time": 0.000639,
                    "planning_time": 0.039172,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.246555,
                    "execution_time": 0.107499,
                    "compile_time": 0.000675,
                    "planning_time": 0.105151,
                    "create_size": 18
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_29\" AS SELECT \"SPEQLITE_TEMP_TABLE_22\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_22\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_28\".\"CHANNEL\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_28\".\"SALES\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_28\".\"NUMBER_SALES\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.592137,
                    "execution_time": 0.928157,
                    "compile_time": 0.000584,
                    "planning_time": 0.006335,
                    "create_size": 1920
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.20443,
                    "execution_time": 2.480494,
                    "compile_time": 0.000581,
                    "planning_time": 0.064516,
                    "create_size": 1920
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\" LIMIT 21",
                "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id     sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     8006005           6              8  437356.7           108         store          10011009                11                   10     322659.83                   79\n1    store     8006005           6              8  437356.7           108         store           9013008                13                    9     635379.02                  189\n2    store     8006005           6              8  437356.7           108         store           6002003                 2                    6     868903.33                  233\n3    store     8006005           6              8  437356.7           108         store          10012006                12                   10     297690.42                   74\n4    store     8006005           6              8  437356.7           108         store           9011008                11                    9     769928.25                  208\n5    store     8006005           6              8  437356.7           108         store           6005002                 5                    6     343034.30                   95\n6    store     8006005           6              8  437356.7           108         store           6001007                 1                    6     640080.63                  166\n7    store     8006005           6              8  437356.7           108         store           9007011                 7                    9     625040.33                  171\n8    store     8006005           6              8  437356.7           108         store           7003009                 3                    7     773497.59                  192\n9    store     8006005           6              8  437356.7           108         store           7010010                10                    7     274643.25                   77\n10   store     8006005           6              8  437356.7           108         store           8006006                 6                    8     338025.12                  102\n11   store     8006005           6              8  437356.7           108         store           7008001                 8                    7     661867.93                  177\n12   store     8006005           6              8  437356.7           108         store          10008005                 8                   10     309692.84                   66\n13   store     8006005           6              8  437356.7           108         store           8008006                 8                    8     250419.01                   72\n14   store     8006005           6              8  437356.7           108         store          10003008                 3                   10     252694.93                   78\n15   store     8006005           6              8  437356.7           108         store           6013005                13                    6     988906.58                  241\n16   store     8006005           6              8  437356.7           108         store           9008008                 8                    9     600450.48                  154\n17   store     8006005           6              8  437356.7           108         store           6011006                11                    6     262928.84                   97\n18   store     8006005           6              8  437356.7           108         store           7002003                 2                    7     591430.38                  160\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019478,
                    "execution_time": 0.00798,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004792
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056357,
                    "execution_time": 0.008132,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.040849
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_22\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_28\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_28\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\""
            }
        ],
        "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id     sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     8006005           6              8  437356.7           108         store          10011009                11                   10     322659.83                   79\n1    store     8006005           6              8  437356.7           108         store           9013008                13                    9     635379.02                  189\n2    store     8006005           6              8  437356.7           108         store           6002003                 2                    6     868903.33                  233\n3    store     8006005           6              8  437356.7           108         store          10012006                12                   10     297690.42                   74\n4    store     8006005           6              8  437356.7           108         store           9011008                11                    9     769928.25                  208\n5    store     8006005           6              8  437356.7           108         store           6005002                 5                    6     343034.30                   95\n6    store     8006005           6              8  437356.7           108         store           6001007                 1                    6     640080.63                  166\n7    store     8006005           6              8  437356.7           108         store           9007011                 7                    9     625040.33                  171\n8    store     8006005           6              8  437356.7           108         store           7003009                 3                    7     773497.59                  192\n9    store     8006005           6              8  437356.7           108         store           7010010                10                    7     274643.25                   77\n10   store     8006005           6              8  437356.7           108         store           8006006                 6                    8     338025.12                  102\n11   store     8006005           6              8  437356.7           108         store           7008001                 8                    7     661867.93                  177\n12   store     8006005           6              8  437356.7           108         store          10008005                 8                   10     309692.84                   66\n13   store     8006005           6              8  437356.7           108         store           8008006                 8                    8     250419.01                   72\n14   store     8006005           6              8  437356.7           108         store          10003008                 3                   10     252694.93                   78\n15   store     8006005           6              8  437356.7           108         store           6013005                13                    6     988906.58                  241\n16   store     8006005           6              8  437356.7           108         store           9008008                 8                    9     600450.48                  154\n17   store     8006005           6              8  437356.7           108         store           6011006                11                    6     262928.84                   97\n18   store     8006005           6              8  437356.7           108         store           7002003                 2                    7     591430.38                  160\n...*/"
    },
    {
        "input": "WITH cross_items \n     AS (SELECT i_item_sk ss_item_sk \n         FROM   item, \n                (SELECT iss.i_brand_id    brand_id, \n                        iss.i_class_id    class_id, \n                        iss.i_category_id category_id \n                 FROM   store_sales, \n                        item iss, \n                        date_dim d1 \n                 WHERE  ss_item_sk = iss.i_item_sk \n                        AND ss_sold_date_sk = d1.d_date_sk \n                        AND d1.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT ics.i_brand_id, \n                        ics.i_class_id, \n                        ics.i_category_id \n                 FROM   catalog_sales, \n                        item ics, \n                        date_dim d2 \n                 WHERE  cs_item_sk = ics.i_item_sk \n                        AND cs_sold_date_sk = d2.d_date_sk \n                        AND d2.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT iws.i_brand_id, \n                        iws.i_class_id, \n                        iws.i_category_id \n                 FROM   web_sales, \n                        item iws, \n                        date_dim d3 \n                 WHERE  ws_item_sk = iws.i_item_sk \n                        AND ws_sold_date_sk = d3.d_date_sk \n                        AND d3.d_year BETWEEN 1999 AND 1999 + 2) x \n         WHERE  i_brand_id = brand_id \n                AND i_class_id = class_id \n                AND i_category_id = category_id), \n     avg_sales \n     AS (SELECT Avg(quantity * list_price) average_sales \n         FROM   (SELECT ss_quantity   quantity, \n                        ss_list_price list_price \n                 FROM   store_sales, \n                        date_dim \n                 WHERE  ss_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT cs_quantity   quantity, \n                        cs_list_price list_price \n                 FROM   catalog_sales, \n                        date_dim \n                 WHERE  cs_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT ws_quantity   quantity, \n                        ws_list_price list_price \n                 FROM   web_sales, \n                        date_dim \n                 WHERE  ws_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2) x) \nSELECT  * \nFROM   (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 + 1 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) this_year, \n       (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) last_year \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"X\" AS ( SELECT \"ISS\".\"I_BRAND_ID\" AS \"BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"CATEGORY_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"D1\".\"D_YEAR\" <= 2001 AND \"D1\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" INTERSECT SELECT \"ICS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ICS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ICS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D2\".\"D_DATE_SK\" AND \"D2\".\"D_YEAR\" <= 2001 AND \"D2\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ICS\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ICS\".\"I_ITEM_SK\" INTERSECT SELECT \"IWS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"IWS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"IWS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D3\" ON \"D3\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D3\".\"D_YEAR\" <= 2001 AND \"D3\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"IWS\" ON \"IWS\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" <= 2001 AND \"DATE_DIM\".\"D_YEAR\" >= 1999 ) , \"X_2\" AS ( SELECT \"STORE_SALES\".\"SS_QUANTITY\" AS \"QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_QUANTITY\" AS \"QUANTITY\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" UNION ALL SELECT \"WEB_SALES\".\"WS_QUANTITY\" AS \"QUANTITY\" , \"WEB_SALES\".\"WS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) , \"AVG_SALES\" AS ( SELECT AVG ( \"X\".\"QUANTITY\" * \"X\".\"LIST_PRICE\" ) AS \"AVERAGE_SALES\" FROM \"X_2\" AS \"X\" ) , \"STORE_SALES_4\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"SS_QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"SS_LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"_U_2\" AS ( SELECT \"AVG_SALES\".\"AVERAGE_SALES\" AS \"AVERAGE_SALES\" FROM \"AVG_SALES\" AS \"AVG_SALES\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"SS_ITEM_SK\" FROM \"ITEM_2\" AS \"ITEM\" JOIN \"X\" AS \"X\" ON \"ITEM\".\"I_BRAND_ID\" = \"X\".\"BRAND_ID\" AND \"ITEM\".\"I_CATEGORY_ID\" = \"X\".\"CATEGORY_ID\" AND \"ITEM\".\"I_CLASS_ID\" = \"X\".\"CLASS_ID\" GROUP BY \"ITEM\".\"I_ITEM_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"THIS_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_2\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 2000 WHERE NOT \"_U_0\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_2\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) , \"LAST_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_5\" LEFT JOIN \"_U_0\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 1999 WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_5\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) SELECT \"THIS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"THIS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"THIS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"THIS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"THIS_YEAR\".\"SALES\" AS \"SALES\" , \"THIS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"LAST_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"LAST_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"LAST_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"LAST_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"LAST_YEAR\".\"SALES\" AS \"SALES\" , \"LAST_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"THIS_YEAR\" AS \"THIS_YEAR\" CROSS JOIN \"LAST_YEAR\" AS \"LAST_YEAR\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CHANNEL\" AS \"CHANNEL\" , \"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES\" AS \"SALES\" , \"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SALES_COL_10\" AS \"SALES_COL_10\" , \"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\" LIMIT 21",
                "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id     sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     8006005           6              8  437356.7           108         store          10011009                11                   10     322659.83                   79\n1    store     8006005           6              8  437356.7           108         store           9013008                13                    9     635379.02                  189\n2    store     8006005           6              8  437356.7           108         store           6002003                 2                    6     868903.33                  233\n3    store     8006005           6              8  437356.7           108         store          10012006                12                   10     297690.42                   74\n4    store     8006005           6              8  437356.7           108         store           9011008                11                    9     769928.25                  208\n5    store     8006005           6              8  437356.7           108         store           6005002                 5                    6     343034.30                   95\n6    store     8006005           6              8  437356.7           108         store           6001007                 1                    6     640080.63                  166\n7    store     8006005           6              8  437356.7           108         store           9007011                 7                    9     625040.33                  171\n8    store     8006005           6              8  437356.7           108         store           7003009                 3                    7     773497.59                  192\n9    store     8006005           6              8  437356.7           108         store           7010010                10                    7     274643.25                   77\n10   store     8006005           6              8  437356.7           108         store           8006006                 6                    8     338025.12                  102\n11   store     8006005           6              8  437356.7           108         store           7008001                 8                    7     661867.93                  177\n12   store     8006005           6              8  437356.7           108         store          10008005                 8                   10     309692.84                   66\n13   store     8006005           6              8  437356.7           108         store           8008006                 8                    8     250419.01                   72\n14   store     8006005           6              8  437356.7           108         store          10003008                 3                   10     252694.93                   78\n15   store     8006005           6              8  437356.7           108         store           6013005                13                    6     988906.58                  241\n16   store     8006005           6              8  437356.7           108         store           9008008                 8                    9     600450.48                  154\n17   store     8006005           6              8  437356.7           108         store           6011006                11                    6     262928.84                   97\n18   store     8006005           6              8  437356.7           108         store           7002003                 2                    7     591430.38                  160\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019206,
                    "execution_time": 0.007684,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004739
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05535,
                    "execution_time": 0.00863,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039965
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_22\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_28\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_28\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\"",
                "rewrite": "SELECT \"CHANNEL\" AS \"CHANNEL\", \"I_BRAND_ID\" AS \"I_BRAND_ID\", \"I_CLASS_ID\" AS \"I_CLASS_ID\", \"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\", \"SALES\" AS \"SALES\", \"NUMBER_SALES\" AS \"NUMBER_SALES\", \"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\", \"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\", \"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\", \"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\", \"SALES_COL_10\" AS \"SALES_COL_10\", \"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\""
            }
        ],
        "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id     sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     8006005           6              8  437356.7           108         store          10011009                11                   10     322659.83                   79\n1    store     8006005           6              8  437356.7           108         store           9013008                13                    9     635379.02                  189\n2    store     8006005           6              8  437356.7           108         store           6002003                 2                    6     868903.33                  233\n3    store     8006005           6              8  437356.7           108         store          10012006                12                   10     297690.42                   74\n4    store     8006005           6              8  437356.7           108         store           9011008                11                    9     769928.25                  208\n5    store     8006005           6              8  437356.7           108         store           6005002                 5                    6     343034.30                   95\n6    store     8006005           6              8  437356.7           108         store           6001007                 1                    6     640080.63                  166\n7    store     8006005           6              8  437356.7           108         store           9007011                 7                    9     625040.33                  171\n8    store     8006005           6              8  437356.7           108         store           7003009                 3                    7     773497.59                  192\n9    store     8006005           6              8  437356.7           108         store           7010010                10                    7     274643.25                   77\n10   store     8006005           6              8  437356.7           108         store           8006006                 6                    8     338025.12                  102\n11   store     8006005           6              8  437356.7           108         store           7008001                 8                    7     661867.93                  177\n12   store     8006005           6              8  437356.7           108         store          10008005                 8                   10     309692.84                   66\n13   store     8006005           6              8  437356.7           108         store           8008006                 8                    8     250419.01                   72\n14   store     8006005           6              8  437356.7           108         store          10003008                 3                   10     252694.93                   78\n15   store     8006005           6              8  437356.7           108         store           6013005                13                    6     988906.58                  241\n16   store     8006005           6              8  437356.7           108         store           9008008                 8                    9     600450.48                  154\n17   store     8006005           6              8  437356.7           108         store           6011006                11                    6     262928.84                   97\n18   store     8006005           6              8  437356.7           108         store           7002003                 2                    7     591430.38                  160\n...*/"
    },
    {
        "input": "WITH cross_items \n     AS (SELECT i_item_sk ss_item_sk \n         FROM   item, \n                (SELECT iss.i_brand_id    brand_id, \n                        iss.i_class_id    class_id, \n                        iss.i_category_id category_id \n                 FROM   store_sales, \n                        item iss, \n                        date_dim d1 \n                 WHERE  ss_item_sk = iss.i_item_sk \n                        AND ss_sold_date_sk = d1.d_date_sk \n                        AND d1.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT ics.i_brand_id, \n                        ics.i_class_id, \n                        ics.i_category_id \n                 FROM   catalog_sales, \n                        item ics, \n                        date_dim d2 \n                 WHERE  cs_item_sk = ics.i_item_sk \n                        AND cs_sold_date_sk = d2.d_date_sk \n                        AND d2.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT iws.i_brand_id, \n                        iws.i_class_id, \n                        iws.i_category_id \n                 FROM   web_sales, \n                        item iws, \n                        date_dim d3 \n                 WHERE  ws_item_sk = iws.i_item_sk \n                        AND ws_sold_date_sk = d3.d_date_sk \n                        AND d3.d_year BETWEEN 1999 AND 1999 + 2) x \n         WHERE  i_brand_id = brand_id \n                AND i_class_id = class_id \n                AND i_category_id = category_id), \n     avg_sales \n     AS (SELECT Avg(quantity * list_price) average_sales \n         FROM   (SELECT ss_quantity   quantity, \n                        ss_list_price list_price \n                 FROM   store_sales, \n                        date_dim \n                 WHERE  ss_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT cs_quantity   quantity, \n                        cs_list_price list_price \n                 FROM   catalog_sales, \n                        date_dim \n                 WHERE  cs_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT ws_quantity   quantity, \n                        ws_list_price list_price \n                 FROM   web_sales, \n                        date_dim \n                 WHERE  ws_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2) x) \nSELECT  * \nFROM   (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 + 1 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) this_year, \n       (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) last_year \nWHERE  this_year.i_brand_id = last_year.i_brand_id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"X\" AS ( SELECT \"ISS\".\"I_BRAND_ID\" AS \"BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"CATEGORY_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"D1\".\"D_YEAR\" <= 2001 AND \"D1\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" INTERSECT SELECT \"ICS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ICS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ICS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D2\".\"D_DATE_SK\" AND \"D2\".\"D_YEAR\" <= 2001 AND \"D2\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ICS\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ICS\".\"I_ITEM_SK\" INTERSECT SELECT \"IWS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"IWS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"IWS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D3\" ON \"D3\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D3\".\"D_YEAR\" <= 2001 AND \"D3\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"IWS\" ON \"IWS\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" <= 2001 AND \"DATE_DIM\".\"D_YEAR\" >= 1999 ) , \"X_2\" AS ( SELECT \"STORE_SALES\".\"SS_QUANTITY\" AS \"QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_QUANTITY\" AS \"QUANTITY\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" UNION ALL SELECT \"WEB_SALES\".\"WS_QUANTITY\" AS \"QUANTITY\" , \"WEB_SALES\".\"WS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) , \"AVG_SALES\" AS ( SELECT AVG ( \"X\".\"QUANTITY\" * \"X\".\"LIST_PRICE\" ) AS \"AVERAGE_SALES\" FROM \"X_2\" AS \"X\" ) , \"STORE_SALES_4\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"SS_QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"SS_LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"_U_2\" AS ( SELECT \"AVG_SALES\".\"AVERAGE_SALES\" AS \"AVERAGE_SALES\" FROM \"AVG_SALES\" AS \"AVG_SALES\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"SS_ITEM_SK\" FROM \"ITEM_2\" AS \"ITEM\" JOIN \"X\" AS \"X\" ON \"ITEM\".\"I_BRAND_ID\" = \"X\".\"BRAND_ID\" AND \"ITEM\".\"I_CATEGORY_ID\" = \"X\".\"CATEGORY_ID\" AND \"ITEM\".\"I_CLASS_ID\" = \"X\".\"CLASS_ID\" GROUP BY \"ITEM\".\"I_ITEM_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"THIS_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_2\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 2000 WHERE NOT \"_U_0\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_2\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) , \"LAST_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_5\" LEFT JOIN \"_U_0\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 1999 WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_5\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) SELECT \"THIS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"THIS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"THIS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"THIS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"THIS_YEAR\".\"SALES\" AS \"SALES\" , \"THIS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"LAST_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"LAST_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"LAST_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"LAST_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"LAST_YEAR\".\"SALES\" AS \"SALES\" , \"LAST_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"THIS_YEAR\" AS \"THIS_YEAR\" JOIN \"LAST_YEAR\" AS \"LAST_YEAR\" ON \"LAST_YEAR\".\"I_BRAND_ID\" = \"THIS_YEAR\".\"I_BRAND_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_30\" AS SELECT \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\" JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" ON \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" AND \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\" JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" ON \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" AND \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" LIMIT 21",
                "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id      sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n1    store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n2    store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n3    store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n4    store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n5    store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n6    store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n7    store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n8    store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n9    store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n10   store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n11   store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n12   store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n13   store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n14   store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n15   store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n16   store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n17   store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n18   store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.032257,
                    "execution_time": 0.015839,
                    "compile_time": 0.000112,
                    "planning_time": 0.007974
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.071036,
                    "execution_time": 0.015479,
                    "compile_time": 0.001189,
                    "planning_time": 0.043756
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_22\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_28\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_28\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" ON \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" = \"SPEQLITE_TEMP_TABLE_22\".\"I_BRAND_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\" JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" ON \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" AND \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\""
            }
        ],
        "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id      sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n1    store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n2    store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n3    store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n4    store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n5    store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n6    store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n7    store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n8    store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n9    store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n10   store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n11   store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n12   store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n13   store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n14   store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n15   store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n16   store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n17   store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n18   store    10006005           6             10  189162.53            49         store           7005008                 5                    7      297807.4                   68\n...*/"
    },
    {
        "input": "WITH cross_items \n     AS (SELECT i_item_sk ss_item_sk \n         FROM   item, \n                (SELECT iss.i_brand_id    brand_id, \n                        iss.i_class_id    class_id, \n                        iss.i_category_id category_id \n                 FROM   store_sales, \n                        item iss, \n                        date_dim d1 \n                 WHERE  ss_item_sk = iss.i_item_sk \n                        AND ss_sold_date_sk = d1.d_date_sk \n                        AND d1.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT ics.i_brand_id, \n                        ics.i_class_id, \n                        ics.i_category_id \n                 FROM   catalog_sales, \n                        item ics, \n                        date_dim d2 \n                 WHERE  cs_item_sk = ics.i_item_sk \n                        AND cs_sold_date_sk = d2.d_date_sk \n                        AND d2.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT iws.i_brand_id, \n                        iws.i_class_id, \n                        iws.i_category_id \n                 FROM   web_sales, \n                        item iws, \n                        date_dim d3 \n                 WHERE  ws_item_sk = iws.i_item_sk \n                        AND ws_sold_date_sk = d3.d_date_sk \n                        AND d3.d_year BETWEEN 1999 AND 1999 + 2) x \n         WHERE  i_brand_id = brand_id \n                AND i_class_id = class_id \n                AND i_category_id = category_id), \n     avg_sales \n     AS (SELECT Avg(quantity * list_price) average_sales \n         FROM   (SELECT ss_quantity   quantity, \n                        ss_list_price list_price \n                 FROM   store_sales, \n                        date_dim \n                 WHERE  ss_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT cs_quantity   quantity, \n                        cs_list_price list_price \n                 FROM   catalog_sales, \n                        date_dim \n                 WHERE  cs_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT ws_quantity   quantity, \n                        ws_list_price list_price \n                 FROM   web_sales, \n                        date_dim \n                 WHERE  ws_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2) x) \nSELECT  * \nFROM   (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 + 1 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) this_year, \n       (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) last_year \nWHERE  this_year.i_brand_id = last_year.i_brand_id \n       AND this_year.i_class_id = last_year.i_class_id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"X\" AS ( SELECT \"ISS\".\"I_BRAND_ID\" AS \"BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"CATEGORY_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"D1\".\"D_YEAR\" <= 2001 AND \"D1\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" INTERSECT SELECT \"ICS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ICS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ICS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D2\".\"D_DATE_SK\" AND \"D2\".\"D_YEAR\" <= 2001 AND \"D2\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ICS\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ICS\".\"I_ITEM_SK\" INTERSECT SELECT \"IWS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"IWS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"IWS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D3\" ON \"D3\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D3\".\"D_YEAR\" <= 2001 AND \"D3\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"IWS\" ON \"IWS\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" <= 2001 AND \"DATE_DIM\".\"D_YEAR\" >= 1999 ) , \"X_2\" AS ( SELECT \"STORE_SALES\".\"SS_QUANTITY\" AS \"QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_QUANTITY\" AS \"QUANTITY\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" UNION ALL SELECT \"WEB_SALES\".\"WS_QUANTITY\" AS \"QUANTITY\" , \"WEB_SALES\".\"WS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) , \"AVG_SALES\" AS ( SELECT AVG ( \"X\".\"QUANTITY\" * \"X\".\"LIST_PRICE\" ) AS \"AVERAGE_SALES\" FROM \"X_2\" AS \"X\" ) , \"STORE_SALES_4\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"SS_QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"SS_LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"_U_2\" AS ( SELECT \"AVG_SALES\".\"AVERAGE_SALES\" AS \"AVERAGE_SALES\" FROM \"AVG_SALES\" AS \"AVG_SALES\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"SS_ITEM_SK\" FROM \"ITEM_2\" AS \"ITEM\" JOIN \"X\" AS \"X\" ON \"ITEM\".\"I_BRAND_ID\" = \"X\".\"BRAND_ID\" AND \"ITEM\".\"I_CATEGORY_ID\" = \"X\".\"CATEGORY_ID\" AND \"ITEM\".\"I_CLASS_ID\" = \"X\".\"CLASS_ID\" GROUP BY \"ITEM\".\"I_ITEM_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"THIS_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_2\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 2000 WHERE NOT \"_U_0\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_2\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) , \"LAST_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_5\" LEFT JOIN \"_U_0\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 1999 WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_5\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) SELECT \"THIS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"THIS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"THIS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"THIS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"THIS_YEAR\".\"SALES\" AS \"SALES\" , \"THIS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"LAST_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"LAST_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"LAST_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"LAST_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"LAST_YEAR\".\"SALES\" AS \"SALES\" , \"LAST_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"THIS_YEAR\" AS \"THIS_YEAR\" JOIN \"LAST_YEAR\" AS \"LAST_YEAR\" ON \"LAST_YEAR\".\"I_BRAND_ID\" = \"THIS_YEAR\".\"I_BRAND_ID\" AND \"LAST_YEAR\".\"I_CLASS_ID\" = \"THIS_YEAR\".\"I_CLASS_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_30\" AS SELECT \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\" JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" ON \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.338851,
                    "execution_time": 0.663021,
                    "compile_time": 0.000594,
                    "planning_time": 0.007735,
                    "create_size": 1920
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.415104,
                    "execution_time": 0.680257,
                    "compile_time": 0.002529,
                    "planning_time": 0.064829,
                    "create_size": 1920
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_30\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_30\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_30\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_30\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_30\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_30\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_30\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_30\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_30\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_30\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_30\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_30\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_30\" AS \"SPEQLITE_TEMP_TABLE_30\" LIMIT 21",
                "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id     sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     9013011          13              8  86246.03            12         store           7004007                 4                    7     632143.63                  192\n1    store     9013011          13              8  86246.03            12         store          10016012                16                   10     423219.43                  107\n2    store     9013011          13              8  86246.03            12         store          10005011                 5                   10     443714.60                  102\n3    store     9013011          13              8  86246.03            12         store           6014008                14                    6     377616.73                  102\n4    store     9013011          13              8  86246.03            12         store          10011006                11                   10     393751.70                   89\n5    store     9013011          13              8  86246.03            12         store           7006007                 6                    7     558873.46                  166\n6    store     9013011          13              8  86246.03            12         store           6008008                 8                    6     380974.87                  102\n7    store     9013011          13              8  86246.03            12         store           7010008                10                    7     252735.86                   73\n8    store     9013011          13              8  86246.03            12         store           7011004                11                    7     451007.40                  123\n9    store     9013011          13              8  86246.03            12         store           9014003                14                    9     792181.54                  206\n10   store     9013011          13              8  86246.03            12         store           7006001                 6                    7     721961.06                  202\n11   store     9013011          13              8  86246.03            12         store           9005005                 5                    9     737117.34                  218\n12   store     9013011          13              8  86246.03            12         store           7009005                 9                    7     722940.23                  206\n13   store     9013011          13              8  86246.03            12         store           7005003                 5                    7     547372.19                  160\n14   store     9013011          13              8  86246.03            12         store           8006003                 6                    8     614415.35                  177\n15   store     9013011          13              8  86246.03            12         store           8011005                11                    8     668634.60                  173\n16   store     9013011          13              8  86246.03            12         store           8005010                 5                    8     446645.45                  120\n17   store     9013011          13              8  86246.03            12         store           4001002                 1                    4    6238010.53                 1713\n18   store     9013011          13              8  86246.03            12         store           8004003                 4                    8     571747.77                  154\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020728,
                    "execution_time": 0.008569,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.005144
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.059762,
                    "execution_time": 0.008714,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.040826
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_22\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_28\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_28\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" ON \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" = \"SPEQLITE_TEMP_TABLE_22\".\"I_BRAND_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" = \"SPEQLITE_TEMP_TABLE_22\".\"I_CLASS_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_30\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_30\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_30\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_30\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_30\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_30\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_30\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_30\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_30\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_30\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_30\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_30\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_30\" AS \"SPEQLITE_TEMP_TABLE_30\""
            }
        ],
        "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id     sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     9013011          13              8  86246.03            12         store           7004007                 4                    7     632143.63                  192\n1    store     9013011          13              8  86246.03            12         store          10016012                16                   10     423219.43                  107\n2    store     9013011          13              8  86246.03            12         store          10005011                 5                   10     443714.60                  102\n3    store     9013011          13              8  86246.03            12         store           6014008                14                    6     377616.73                  102\n4    store     9013011          13              8  86246.03            12         store          10011006                11                   10     393751.70                   89\n5    store     9013011          13              8  86246.03            12         store           7006007                 6                    7     558873.46                  166\n6    store     9013011          13              8  86246.03            12         store           6008008                 8                    6     380974.87                  102\n7    store     9013011          13              8  86246.03            12         store           7010008                10                    7     252735.86                   73\n8    store     9013011          13              8  86246.03            12         store           7011004                11                    7     451007.40                  123\n9    store     9013011          13              8  86246.03            12         store           9014003                14                    9     792181.54                  206\n10   store     9013011          13              8  86246.03            12         store           7006001                 6                    7     721961.06                  202\n11   store     9013011          13              8  86246.03            12         store           9005005                 5                    9     737117.34                  218\n12   store     9013011          13              8  86246.03            12         store           7009005                 9                    7     722940.23                  206\n13   store     9013011          13              8  86246.03            12         store           7005003                 5                    7     547372.19                  160\n14   store     9013011          13              8  86246.03            12         store           8006003                 6                    8     614415.35                  177\n15   store     9013011          13              8  86246.03            12         store           8011005                11                    8     668634.60                  173\n16   store     9013011          13              8  86246.03            12         store           8005010                 5                    8     446645.45                  120\n17   store     9013011          13              8  86246.03            12         store           4001002                 1                    4    6238010.53                 1713\n18   store     9013011          13              8  86246.03            12         store           8004003                 4                    8     571747.77                  154\n...*/"
    },
    {
        "input": "WITH cross_items \n     AS (SELECT i_item_sk ss_item_sk \n         FROM   item, \n                (SELECT iss.i_brand_id    brand_id, \n                        iss.i_class_id    class_id, \n                        iss.i_category_id category_id \n                 FROM   store_sales, \n                        item iss, \n                        date_dim d1 \n                 WHERE  ss_item_sk = iss.i_item_sk \n                        AND ss_sold_date_sk = d1.d_date_sk \n                        AND d1.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT ics.i_brand_id, \n                        ics.i_class_id, \n                        ics.i_category_id \n                 FROM   catalog_sales, \n                        item ics, \n                        date_dim d2 \n                 WHERE  cs_item_sk = ics.i_item_sk \n                        AND cs_sold_date_sk = d2.d_date_sk \n                        AND d2.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT iws.i_brand_id, \n                        iws.i_class_id, \n                        iws.i_category_id \n                 FROM   web_sales, \n                        item iws, \n                        date_dim d3 \n                 WHERE  ws_item_sk = iws.i_item_sk \n                        AND ws_sold_date_sk = d3.d_date_sk \n                        AND d3.d_year BETWEEN 1999 AND 1999 + 2) x \n         WHERE  i_brand_id = brand_id \n                AND i_class_id = class_id \n                AND i_category_id = category_id), \n     avg_sales \n     AS (SELECT Avg(quantity * list_price) average_sales \n         FROM   (SELECT ss_quantity   quantity, \n                        ss_list_price list_price \n                 FROM   store_sales, \n                        date_dim \n                 WHERE  ss_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT cs_quantity   quantity, \n                        cs_list_price list_price \n                 FROM   catalog_sales, \n                        date_dim \n                 WHERE  cs_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT ws_quantity   quantity, \n                        ws_list_price list_price \n                 FROM   web_sales, \n                        date_dim \n                 WHERE  ws_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2) x) \nSELECT  * \nFROM   (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 + 1 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) this_year, \n       (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) last_year \nWHERE  this_year.i_brand_id = last_year.i_brand_id \n       AND this_year.i_class_id = last_year.i_class_id \n       AND this_year.i_category_id = last_year.i_category_id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"X\" AS ( SELECT \"ISS\".\"I_BRAND_ID\" AS \"BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"CATEGORY_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"D1\".\"D_YEAR\" <= 2001 AND \"D1\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" INTERSECT SELECT \"ICS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ICS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ICS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D2\".\"D_DATE_SK\" AND \"D2\".\"D_YEAR\" <= 2001 AND \"D2\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ICS\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ICS\".\"I_ITEM_SK\" INTERSECT SELECT \"IWS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"IWS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"IWS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D3\" ON \"D3\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D3\".\"D_YEAR\" <= 2001 AND \"D3\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"IWS\" ON \"IWS\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" <= 2001 AND \"DATE_DIM\".\"D_YEAR\" >= 1999 ) , \"X_2\" AS ( SELECT \"STORE_SALES\".\"SS_QUANTITY\" AS \"QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_QUANTITY\" AS \"QUANTITY\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" UNION ALL SELECT \"WEB_SALES\".\"WS_QUANTITY\" AS \"QUANTITY\" , \"WEB_SALES\".\"WS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) , \"AVG_SALES\" AS ( SELECT AVG ( \"X\".\"QUANTITY\" * \"X\".\"LIST_PRICE\" ) AS \"AVERAGE_SALES\" FROM \"X_2\" AS \"X\" ) , \"STORE_SALES_4\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"SS_QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"SS_LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"_U_2\" AS ( SELECT \"AVG_SALES\".\"AVERAGE_SALES\" AS \"AVERAGE_SALES\" FROM \"AVG_SALES\" AS \"AVG_SALES\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"SS_ITEM_SK\" FROM \"ITEM_2\" AS \"ITEM\" JOIN \"X\" AS \"X\" ON \"ITEM\".\"I_BRAND_ID\" = \"X\".\"BRAND_ID\" AND \"ITEM\".\"I_CATEGORY_ID\" = \"X\".\"CATEGORY_ID\" AND \"ITEM\".\"I_CLASS_ID\" = \"X\".\"CLASS_ID\" GROUP BY \"ITEM\".\"I_ITEM_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"THIS_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_2\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 2000 WHERE NOT \"_U_0\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_2\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) , \"LAST_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_5\" LEFT JOIN \"_U_0\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 1999 WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_5\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) SELECT \"THIS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"THIS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"THIS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"THIS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"THIS_YEAR\".\"SALES\" AS \"SALES\" , \"THIS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"LAST_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"LAST_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"LAST_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"LAST_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"LAST_YEAR\".\"SALES\" AS \"SALES\" , \"LAST_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"THIS_YEAR\" AS \"THIS_YEAR\" JOIN \"LAST_YEAR\" AS \"LAST_YEAR\" ON \"LAST_YEAR\".\"I_BRAND_ID\" = \"THIS_YEAR\".\"I_BRAND_ID\" AND \"LAST_YEAR\".\"I_CATEGORY_ID\" = \"THIS_YEAR\".\"I_CATEGORY_ID\" AND \"LAST_YEAR\".\"I_CLASS_ID\" = \"THIS_YEAR\".\"I_CLASS_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_31\" AS SELECT \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\" JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" ON \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.226417,
                    "execution_time": 0.568198,
                    "compile_time": 0.000587,
                    "planning_time": 0.007789,
                    "create_size": 1920
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.475737,
                    "execution_time": 0.577073,
                    "compile_time": 0.18272,
                    "planning_time": 0.065999,
                    "create_size": 1920
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_31\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_31\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_31\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_31\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_31\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_31\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_31\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_31\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_31\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_31\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_31\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_31\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_31\" AS \"SPEQLITE_TEMP_TABLE_31\" LIMIT 21",
                "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id      sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     8001008           1              8  352385.23            92         store           6004008                 4                    6     300661.36                   60\n1    store     8001008           1              8  352385.23            92         store           8004005                 4                    8     734076.27                  203\n2    store     8001008           1              8  352385.23            92         store           7016008                16                    7     455009.53                  121\n3    store     8001008           1              8  352385.23            92         store           7014005                14                    7     620932.49                  173\n4    store     8001008           1              8  352385.23            92         store           9010003                10                    9     526275.14                  150\n5    store     8001008           1              8  352385.23            92         store          10015010                15                   10     494335.96                  112\n6    store     8001008           1              8  352385.23            92         store          10015004                15                   10     350079.59                   98\n7    store     8001008           1              8  352385.23            92         store           8001007                 1                    8     866551.17                  205\n8    store     8001008           1              8  352385.23            92         store           6002006                 2                    6     394148.51                  102\n9    store     8001008           1              8  352385.23            92         store          10016008                16                   10     314041.61                   86\n10   store     8001008           1              8  352385.23            92         store           7016005                16                    7     560901.14                  174\n11   store     8001008           1              8  352385.23            92         store           7005004                 5                    7     170387.25                   51\n12   store     8001008           1              8  352385.23            92         store          10006013                 6                   10     233193.72                   65\n13   store     8001008           1              8  352385.23            92         store           7004002                 4                    7     266728.28                   76\n14   store     8001008           1              8  352385.23            92         store          10012010                12                   10     351611.05                  101\n15   store     8001008           1              8  352385.23            92         store           8013009                13                    8     719022.86                  193\n16   store     8001008           1              8  352385.23            92         store          10013010                13                   10     311157.56                   89\n17   store     8001008           1              8  352385.23            92         store           6009001                 9                    6    1140125.71                  296\n18   store     8001008           1              8  352385.23            92         store           7013004                13                    7     206902.20                   61\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019343,
                    "execution_time": 0.007765,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.004791
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.059159,
                    "execution_time": 0.008251,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.040568
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_22\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_28\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_28\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" ON \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" = \"SPEQLITE_TEMP_TABLE_22\".\"I_BRAND_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" = \"SPEQLITE_TEMP_TABLE_22\".\"I_CATEGORY_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" = \"SPEQLITE_TEMP_TABLE_22\".\"I_CLASS_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_31\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_31\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_31\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_31\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_31\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_31\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_31\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_31\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_31\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_31\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_31\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_31\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_31\" AS \"SPEQLITE_TEMP_TABLE_31\""
            }
        ],
        "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id      sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     8001008           1              8  352385.23            92         store           6004008                 4                    6     300661.36                   60\n1    store     8001008           1              8  352385.23            92         store           8004005                 4                    8     734076.27                  203\n2    store     8001008           1              8  352385.23            92         store           7016008                16                    7     455009.53                  121\n3    store     8001008           1              8  352385.23            92         store           7014005                14                    7     620932.49                  173\n4    store     8001008           1              8  352385.23            92         store           9010003                10                    9     526275.14                  150\n5    store     8001008           1              8  352385.23            92         store          10015010                15                   10     494335.96                  112\n6    store     8001008           1              8  352385.23            92         store          10015004                15                   10     350079.59                   98\n7    store     8001008           1              8  352385.23            92         store           8001007                 1                    8     866551.17                  205\n8    store     8001008           1              8  352385.23            92         store           6002006                 2                    6     394148.51                  102\n9    store     8001008           1              8  352385.23            92         store          10016008                16                   10     314041.61                   86\n10   store     8001008           1              8  352385.23            92         store           7016005                16                    7     560901.14                  174\n11   store     8001008           1              8  352385.23            92         store           7005004                 5                    7     170387.25                   51\n12   store     8001008           1              8  352385.23            92         store          10006013                 6                   10     233193.72                   65\n13   store     8001008           1              8  352385.23            92         store           7004002                 4                    7     266728.28                   76\n14   store     8001008           1              8  352385.23            92         store          10012010                12                   10     351611.05                  101\n15   store     8001008           1              8  352385.23            92         store           8013009                13                    8     719022.86                  193\n16   store     8001008           1              8  352385.23            92         store          10013010                13                   10     311157.56                   89\n17   store     8001008           1              8  352385.23            92         store           6009001                 9                    6    1140125.71                  296\n18   store     8001008           1              8  352385.23            92         store           7013004                13                    7     206902.20                   61\n...*/"
    },
    {
        "input": "WITH cross_items \n     AS (SELECT i_item_sk ss_item_sk \n         FROM   item, \n                (SELECT iss.i_brand_id    brand_id, \n                        iss.i_class_id    class_id, \n                        iss.i_category_id category_id \n                 FROM   store_sales, \n                        item iss, \n                        date_dim d1 \n                 WHERE  ss_item_sk = iss.i_item_sk \n                        AND ss_sold_date_sk = d1.d_date_sk \n                        AND d1.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT ics.i_brand_id, \n                        ics.i_class_id, \n                        ics.i_category_id \n                 FROM   catalog_sales, \n                        item ics, \n                        date_dim d2 \n                 WHERE  cs_item_sk = ics.i_item_sk \n                        AND cs_sold_date_sk = d2.d_date_sk \n                        AND d2.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT iws.i_brand_id, \n                        iws.i_class_id, \n                        iws.i_category_id \n                 FROM   web_sales, \n                        item iws, \n                        date_dim d3 \n                 WHERE  ws_item_sk = iws.i_item_sk \n                        AND ws_sold_date_sk = d3.d_date_sk \n                        AND d3.d_year BETWEEN 1999 AND 1999 + 2) x \n         WHERE  i_brand_id = brand_id \n                AND i_class_id = class_id \n                AND i_category_id = category_id), \n     avg_sales \n     AS (SELECT Avg(quantity * list_price) average_sales \n         FROM   (SELECT ss_quantity   quantity, \n                        ss_list_price list_price \n                 FROM   store_sales, \n                        date_dim \n                 WHERE  ss_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT cs_quantity   quantity, \n                        cs_list_price list_price \n                 FROM   catalog_sales, \n                        date_dim \n                 WHERE  cs_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT ws_quantity   quantity, \n                        ws_list_price list_price \n                 FROM   web_sales, \n                        date_dim \n                 WHERE  ws_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2) x) \nSELECT  * \nFROM   (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 + 1 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) this_year, \n       (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) last_year \nWHERE  this_year.i_brand_id = last_year.i_brand_id \n       AND this_year.i_class_id = last_year.i_class_id \n       AND this_year.i_category_id = last_year.i_category_id \nORDER  BY this_year.channel, \n          this_year.sales DESC \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"X\" AS ( SELECT \"ISS\".\"I_BRAND_ID\" AS \"BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"CATEGORY_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"D1\".\"D_YEAR\" <= 2001 AND \"D1\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" INTERSECT SELECT \"ICS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ICS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ICS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D2\".\"D_DATE_SK\" AND \"D2\".\"D_YEAR\" <= 2001 AND \"D2\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ICS\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ICS\".\"I_ITEM_SK\" INTERSECT SELECT \"IWS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"IWS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"IWS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D3\" ON \"D3\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D3\".\"D_YEAR\" <= 2001 AND \"D3\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"IWS\" ON \"IWS\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" <= 2001 AND \"DATE_DIM\".\"D_YEAR\" >= 1999 ) , \"X_2\" AS ( SELECT \"STORE_SALES\".\"SS_QUANTITY\" AS \"QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_QUANTITY\" AS \"QUANTITY\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" UNION ALL SELECT \"WEB_SALES\".\"WS_QUANTITY\" AS \"QUANTITY\" , \"WEB_SALES\".\"WS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) , \"AVG_SALES\" AS ( SELECT AVG ( \"X\".\"QUANTITY\" * \"X\".\"LIST_PRICE\" ) AS \"AVERAGE_SALES\" FROM \"X_2\" AS \"X\" ) , \"STORE_SALES_4\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"SS_QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"SS_LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"_U_2\" AS ( SELECT \"AVG_SALES\".\"AVERAGE_SALES\" AS \"AVERAGE_SALES\" FROM \"AVG_SALES\" AS \"AVG_SALES\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"SS_ITEM_SK\" FROM \"ITEM_2\" AS \"ITEM\" JOIN \"X\" AS \"X\" ON \"ITEM\".\"I_BRAND_ID\" = \"X\".\"BRAND_ID\" AND \"ITEM\".\"I_CATEGORY_ID\" = \"X\".\"CATEGORY_ID\" AND \"ITEM\".\"I_CLASS_ID\" = \"X\".\"CLASS_ID\" GROUP BY \"ITEM\".\"I_ITEM_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"THIS_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_2\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 2000 WHERE NOT \"_U_0\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_2\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) , \"LAST_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_5\" LEFT JOIN \"_U_0\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 1999 WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_5\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) SELECT \"THIS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"THIS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"THIS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"THIS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"THIS_YEAR\".\"SALES\" AS \"SALES\" , \"THIS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"LAST_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"LAST_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"LAST_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"LAST_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"LAST_YEAR\".\"SALES\" AS \"SALES\" , \"LAST_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"THIS_YEAR\" AS \"THIS_YEAR\" JOIN \"LAST_YEAR\" AS \"LAST_YEAR\" ON \"LAST_YEAR\".\"I_BRAND_ID\" = \"THIS_YEAR\".\"I_BRAND_ID\" AND \"LAST_YEAR\".\"I_CATEGORY_ID\" = \"THIS_YEAR\".\"I_CATEGORY_ID\" AND \"LAST_YEAR\".\"I_CLASS_ID\" = \"THIS_YEAR\".\"I_CLASS_ID\" ORDER BY \"THIS_YEAR\".\"CHANNEL\" NULLS LAST , \"THIS_YEAR\".\"SALES\" DESC NULLS FIRST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\" JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" ON \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES\" DESC LIMIT 21",
                "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id       sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     5001002           1              5  9196486.69          2447         store          10015017                15                   10     100477.07                   35\n1    store     5001002           1              5  9196486.69          2447         store           6007004                 7                    6     407870.01                  117\n2    store     5001002           1              5  9196486.69          2447         store          10011009                11                   10     322659.83                   79\n3    store     5001002           1              5  9196486.69          2447         store           8008002                 8                    8     302815.98                   71\n4    store     5001002           1              5  9196486.69          2447         store           6009008                 9                    6     417779.11                  104\n5    store     5001002           1              5  9196486.69          2447         store           9007011                 7                    9     625040.33                  171\n6    store     5001002           1              5  9196486.69          2447         store           7007004                 7                    7     277991.28                   64\n7    store     5001002           1              5  9196486.69          2447         store           8009003                 9                    8     550119.89                  144\n8    store     5001002           1              5  9196486.69          2447         store           8009007                 9                    8     825405.98                  223\n9    store     5001002           1              5  9196486.69          2447         store          10009011                 9                   10     263206.61                   70\n10   store     5001002           1              5  9196486.69          2447         store          10015006                15                   10     255425.44                   75\n11   store     5001002           1              5  9196486.69          2447         store           2003002                 3                    2    5994209.63                 1622\n12   store     5001002           1              5  9196486.69          2447         store           8007002                 7                    8     415372.11                  105\n13   store     5001002           1              5  9196486.69          2447         store           9001011                 1                    9    1117972.34                  313\n14   store     5001002           1              5  9196486.69          2447         store          10012006                12                   10     297690.42                   74\n15   store     5001002           1              5  9196486.69          2447         store          10012015                12                   10     248256.64                   59\n16   store     5001002           1              5  9196486.69          2447         store          10005002                 5                   10     324271.43                   81\n17   store     5001002           1              5  9196486.69          2447         store           6001007                 1                    6     640080.63                  166\n18   store     5001002           1              5  9196486.69          2447         store          10008004                 8                   10     188563.85                   56\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.058991,
                    "execution_time": 0.040989,
                    "compile_time": 0.000142,
                    "planning_time": 0.008151
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.280638,
                    "execution_time": 0.041522,
                    "compile_time": 0.182061,
                    "planning_time": 0.04438
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_22\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_28\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_28\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" ON \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" = \"SPEQLITE_TEMP_TABLE_22\".\"I_BRAND_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" = \"SPEQLITE_TEMP_TABLE_22\".\"I_CATEGORY_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" = \"SPEQLITE_TEMP_TABLE_22\".\"I_CLASS_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_22\".\"CHANNEL\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_22\".\"SALES\" DESC NULLS FIRST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\" JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" ON \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_29\".\"SALES\" DESC NULLS FIRST"
            }
        ],
        "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id       sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     5001002           1              5  9196486.69          2447         store          10015017                15                   10     100477.07                   35\n1    store     5001002           1              5  9196486.69          2447         store           6007004                 7                    6     407870.01                  117\n2    store     5001002           1              5  9196486.69          2447         store          10011009                11                   10     322659.83                   79\n3    store     5001002           1              5  9196486.69          2447         store           8008002                 8                    8     302815.98                   71\n4    store     5001002           1              5  9196486.69          2447         store           6009008                 9                    6     417779.11                  104\n5    store     5001002           1              5  9196486.69          2447         store           9007011                 7                    9     625040.33                  171\n6    store     5001002           1              5  9196486.69          2447         store           7007004                 7                    7     277991.28                   64\n7    store     5001002           1              5  9196486.69          2447         store           8009003                 9                    8     550119.89                  144\n8    store     5001002           1              5  9196486.69          2447         store           8009007                 9                    8     825405.98                  223\n9    store     5001002           1              5  9196486.69          2447         store          10009011                 9                   10     263206.61                   70\n10   store     5001002           1              5  9196486.69          2447         store          10015006                15                   10     255425.44                   75\n11   store     5001002           1              5  9196486.69          2447         store           2003002                 3                    2    5994209.63                 1622\n12   store     5001002           1              5  9196486.69          2447         store           8007002                 7                    8     415372.11                  105\n13   store     5001002           1              5  9196486.69          2447         store           9001011                 1                    9    1117972.34                  313\n14   store     5001002           1              5  9196486.69          2447         store          10012006                12                   10     297690.42                   74\n15   store     5001002           1              5  9196486.69          2447         store          10012015                12                   10     248256.64                   59\n16   store     5001002           1              5  9196486.69          2447         store          10005002                 5                   10     324271.43                   81\n17   store     5001002           1              5  9196486.69          2447         store           6001007                 1                    6     640080.63                  166\n18   store     5001002           1              5  9196486.69          2447         store          10008004                 8                   10     188563.85                   56\n...*/"
    },
    {
        "input": "WITH cross_items \n     AS (SELECT i_item_sk ss_item_sk \n         FROM   item, \n                (SELECT iss.i_brand_id    brand_id, \n                        iss.i_class_id    class_id, \n                        iss.i_category_id category_id \n                 FROM   store_sales, \n                        item iss, \n                        date_dim d1 \n                 WHERE  ss_item_sk = iss.i_item_sk \n                        AND ss_sold_date_sk = d1.d_date_sk \n                        AND d1.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT ics.i_brand_id, \n                        ics.i_class_id, \n                        ics.i_category_id \n                 FROM   catalog_sales, \n                        item ics, \n                        date_dim d2 \n                 WHERE  cs_item_sk = ics.i_item_sk \n                        AND cs_sold_date_sk = d2.d_date_sk \n                        AND d2.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT iws.i_brand_id, \n                        iws.i_class_id, \n                        iws.i_category_id \n                 FROM   web_sales, \n                        item iws, \n                        date_dim d3 \n                 WHERE  ws_item_sk = iws.i_item_sk \n                        AND ws_sold_date_sk = d3.d_date_sk \n                        AND d3.d_year BETWEEN 1999 AND 1999 + 2) x \n         WHERE  i_brand_id = brand_id \n                AND i_class_id = class_id \n                AND i_category_id = category_id), \n     avg_sales \n     AS (SELECT Avg(quantity * list_price) average_sales \n         FROM   (SELECT ss_quantity   quantity, \n                        ss_list_price list_price \n                 FROM   store_sales, \n                        date_dim \n                 WHERE  ss_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT cs_quantity   quantity, \n                        cs_list_price list_price \n                 FROM   catalog_sales, \n                        date_dim \n                 WHERE  cs_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT ws_quantity   quantity, \n                        ws_list_price list_price \n                 FROM   web_sales, \n                        date_dim \n                 WHERE  ws_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2) x) \nSELECT  * \nFROM   (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 + 1 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) this_year, \n       (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) last_year \nWHERE  this_year.i_brand_id = last_year.i_brand_id \n       AND this_year.i_class_id = last_year.i_class_id \n       AND this_year.i_category_id = last_year.i_category_id \nORDER  BY this_year.channel, \n          this_year.i_brand_id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"X\" AS ( SELECT \"ISS\".\"I_BRAND_ID\" AS \"BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"CATEGORY_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"D1\".\"D_YEAR\" <= 2001 AND \"D1\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" INTERSECT SELECT \"ICS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ICS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ICS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D2\".\"D_DATE_SK\" AND \"D2\".\"D_YEAR\" <= 2001 AND \"D2\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ICS\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ICS\".\"I_ITEM_SK\" INTERSECT SELECT \"IWS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"IWS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"IWS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D3\" ON \"D3\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D3\".\"D_YEAR\" <= 2001 AND \"D3\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"IWS\" ON \"IWS\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" <= 2001 AND \"DATE_DIM\".\"D_YEAR\" >= 1999 ) , \"X_2\" AS ( SELECT \"STORE_SALES\".\"SS_QUANTITY\" AS \"QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_QUANTITY\" AS \"QUANTITY\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" UNION ALL SELECT \"WEB_SALES\".\"WS_QUANTITY\" AS \"QUANTITY\" , \"WEB_SALES\".\"WS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) , \"AVG_SALES\" AS ( SELECT AVG ( \"X\".\"QUANTITY\" * \"X\".\"LIST_PRICE\" ) AS \"AVERAGE_SALES\" FROM \"X_2\" AS \"X\" ) , \"STORE_SALES_4\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"SS_QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"SS_LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"_U_2\" AS ( SELECT \"AVG_SALES\".\"AVERAGE_SALES\" AS \"AVERAGE_SALES\" FROM \"AVG_SALES\" AS \"AVG_SALES\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"SS_ITEM_SK\" FROM \"ITEM_2\" AS \"ITEM\" JOIN \"X\" AS \"X\" ON \"ITEM\".\"I_BRAND_ID\" = \"X\".\"BRAND_ID\" AND \"ITEM\".\"I_CATEGORY_ID\" = \"X\".\"CATEGORY_ID\" AND \"ITEM\".\"I_CLASS_ID\" = \"X\".\"CLASS_ID\" GROUP BY \"ITEM\".\"I_ITEM_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"THIS_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_2\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 2000 WHERE NOT \"_U_0\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_2\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) , \"LAST_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_5\" LEFT JOIN \"_U_0\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 1999 WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_5\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) SELECT \"THIS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"THIS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"THIS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"THIS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"THIS_YEAR\".\"SALES\" AS \"SALES\" , \"THIS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"LAST_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"LAST_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"LAST_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"LAST_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"LAST_YEAR\".\"SALES\" AS \"SALES\" , \"LAST_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"THIS_YEAR\" AS \"THIS_YEAR\" JOIN \"LAST_YEAR\" AS \"LAST_YEAR\" ON \"LAST_YEAR\".\"I_BRAND_ID\" = \"THIS_YEAR\".\"I_BRAND_ID\" AND \"LAST_YEAR\".\"I_CATEGORY_ID\" = \"THIS_YEAR\".\"I_CATEGORY_ID\" AND \"LAST_YEAR\".\"I_CLASS_ID\" = \"THIS_YEAR\".\"I_CLASS_ID\" ORDER BY \"THIS_YEAR\".\"CHANNEL\" NULLS LAST , \"THIS_YEAR\".\"I_BRAND_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\" JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" ON \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" LIMIT 21",
                "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id       sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     1001001           1              1  6404262.37          1762         store          10004007                 4                   10     203161.52                   58\n1    store     1001001           1              1  6404262.37          1762         store           7008007                 8                    7     585352.23                  142\n2    store     1001001           1              1  6404262.37          1762         store          10014006                14                   10     153252.04                   30\n3    store     1001001           1              1  6404262.37          1762         store          10008011                 8                   10     356817.17                   97\n4    store     1001001           1              1  6404262.37          1762         store           9007009                 7                    9     698785.76                  175\n5    store     1001001           1              1  6404262.37          1762         store           8005007                 5                    8     425845.95                  139\n6    store     1001001           1              1  6404262.37          1762         store          10001004                 1                   10     330505.17                   80\n7    store     1001001           1              1  6404262.37          1762         store          10005014                 5                   10     224646.07                   60\n8    store     1001001           1              1  6404262.37          1762         store          10002016                 2                   10     305706.92                   83\n9    store     1001001           1              1  6404262.37          1762         store           7012007                12                    7     569143.24                  176\n10   store     1001001           1              1  6404262.37          1762         store          10014005                14                   10     151813.98                   45\n11   store     1001001           1              1  6404262.37          1762         store           6002002                 2                    6     339313.83                  105\n12   store     1001001           1              1  6404262.37          1762         store           8001006                 1                    8     227753.06                   52\n13   store     1001001           1              1  6404262.37          1762         store          10016004                16                   10     325385.05                   83\n14   store     1001001           1              1  6404262.37          1762         store          10003009                 3                   10     292630.52                   85\n15   store     1001001           1              1  6404262.37          1762         store          10004001                 4                   10     299116.22                   80\n16   store     1001001           1              1  6404262.37          1762         store          10012003                12                   10     473554.90                  125\n17   store     1001001           1              1  6404262.37          1762         store           8007007                 7                    8     523649.77                  138\n18   store     1001001           1              1  6404262.37          1762         store           8016010                16                    8     580545.54                  158\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.060456,
                    "execution_time": 0.041756,
                    "compile_time": 0.000165,
                    "planning_time": 0.008396
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.198339,
                    "execution_time": 0.042211,
                    "compile_time": 0.100453,
                    "planning_time": 0.045307
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_22\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_28\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_28\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" ON \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" = \"SPEQLITE_TEMP_TABLE_22\".\"I_BRAND_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" = \"SPEQLITE_TEMP_TABLE_22\".\"I_CATEGORY_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" = \"SPEQLITE_TEMP_TABLE_22\".\"I_CLASS_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_22\".\"CHANNEL\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_22\".\"I_BRAND_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\" JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" ON \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id       sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     1001001           1              1  6404262.37          1762         store          10004007                 4                   10     203161.52                   58\n1    store     1001001           1              1  6404262.37          1762         store           7008007                 8                    7     585352.23                  142\n2    store     1001001           1              1  6404262.37          1762         store          10014006                14                   10     153252.04                   30\n3    store     1001001           1              1  6404262.37          1762         store          10008011                 8                   10     356817.17                   97\n4    store     1001001           1              1  6404262.37          1762         store           9007009                 7                    9     698785.76                  175\n5    store     1001001           1              1  6404262.37          1762         store           8005007                 5                    8     425845.95                  139\n6    store     1001001           1              1  6404262.37          1762         store          10001004                 1                   10     330505.17                   80\n7    store     1001001           1              1  6404262.37          1762         store          10005014                 5                   10     224646.07                   60\n8    store     1001001           1              1  6404262.37          1762         store          10002016                 2                   10     305706.92                   83\n9    store     1001001           1              1  6404262.37          1762         store           7012007                12                    7     569143.24                  176\n10   store     1001001           1              1  6404262.37          1762         store          10014005                14                   10     151813.98                   45\n11   store     1001001           1              1  6404262.37          1762         store           6002002                 2                    6     339313.83                  105\n12   store     1001001           1              1  6404262.37          1762         store           8001006                 1                    8     227753.06                   52\n13   store     1001001           1              1  6404262.37          1762         store          10016004                16                   10     325385.05                   83\n14   store     1001001           1              1  6404262.37          1762         store          10003009                 3                   10     292630.52                   85\n15   store     1001001           1              1  6404262.37          1762         store          10004001                 4                   10     299116.22                   80\n16   store     1001001           1              1  6404262.37          1762         store          10012003                12                   10     473554.90                  125\n17   store     1001001           1              1  6404262.37          1762         store           8007007                 7                    8     523649.77                  138\n18   store     1001001           1              1  6404262.37          1762         store           8016010                16                    8     580545.54                  158\n...*/"
    },
    {
        "input": "WITH cross_items \n     AS (SELECT i_item_sk ss_item_sk \n         FROM   item, \n                (SELECT iss.i_brand_id    brand_id, \n                        iss.i_class_id    class_id, \n                        iss.i_category_id category_id \n                 FROM   store_sales, \n                        item iss, \n                        date_dim d1 \n                 WHERE  ss_item_sk = iss.i_item_sk \n                        AND ss_sold_date_sk = d1.d_date_sk \n                        AND d1.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT ics.i_brand_id, \n                        ics.i_class_id, \n                        ics.i_category_id \n                 FROM   catalog_sales, \n                        item ics, \n                        date_dim d2 \n                 WHERE  cs_item_sk = ics.i_item_sk \n                        AND cs_sold_date_sk = d2.d_date_sk \n                        AND d2.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT iws.i_brand_id, \n                        iws.i_class_id, \n                        iws.i_category_id \n                 FROM   web_sales, \n                        item iws, \n                        date_dim d3 \n                 WHERE  ws_item_sk = iws.i_item_sk \n                        AND ws_sold_date_sk = d3.d_date_sk \n                        AND d3.d_year BETWEEN 1999 AND 1999 + 2) x \n         WHERE  i_brand_id = brand_id \n                AND i_class_id = class_id \n                AND i_category_id = category_id), \n     avg_sales \n     AS (SELECT Avg(quantity * list_price) average_sales \n         FROM   (SELECT ss_quantity   quantity, \n                        ss_list_price list_price \n                 FROM   store_sales, \n                        date_dim \n                 WHERE  ss_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT cs_quantity   quantity, \n                        cs_list_price list_price \n                 FROM   catalog_sales, \n                        date_dim \n                 WHERE  cs_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT ws_quantity   quantity, \n                        ws_list_price list_price \n                 FROM   web_sales, \n                        date_dim \n                 WHERE  ws_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2) x) \nSELECT  * \nFROM   (SELECT 'store'                          channel, \n               iss.i_brand_id, \n               iss.i_class_id, \n               iss.i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item iss, \n               date_dim d \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = iss.i_item_sk \n               AND ss_sold_date_sk = d.d_date_sk \n               AND d.d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 + 1 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY iss.i_brand_id, \n                  iss.i_class_id, \n                  iss.i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) this_year, \n       (SELECT 'store'                          channel, \n               iss.i_brand_id, \n               iss.i_class_id, \n               iss.i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item iss, \n               date_dim d \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = iss.i_item_sk \n               AND ss_sold_date_sk = d.d_date_sk \n               AND d.d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY iss.i_brand_id, \n                  iss.i_class_id, \n                  iss.i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) last_year \nWHERE  this_year.i_brand_id = last_year.i_brand_id \n       AND this_year.i_class_id = last_year.i_class_id \n       AND this_year.i_category_id = last_year.i_category_id \nORDER  BY this_year.channel, \n          this_year.i_brand_id, \n          this_year.i_class_id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"ISS\" AS ( SELECT \"ISS\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ISS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ISS\" ) , \"X\" AS ( SELECT \"ISS\".\"I_BRAND_ID\" AS \"BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"CATEGORY_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"D1\".\"D_YEAR\" <= 2001 AND \"D1\".\"D_YEAR\" >= 1999 JOIN \"ISS\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" INTERSECT SELECT \"ICS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ICS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ICS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D2\".\"D_DATE_SK\" AND \"D2\".\"D_YEAR\" <= 2001 AND \"D2\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ICS\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ICS\".\"I_ITEM_SK\" INTERSECT SELECT \"IWS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"IWS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"IWS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D3\" ON \"D3\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D3\".\"D_YEAR\" <= 2001 AND \"D3\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"IWS\" ON \"IWS\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" <= 2001 AND \"DATE_DIM\".\"D_YEAR\" >= 1999 ) , \"X_2\" AS ( SELECT \"STORE_SALES\".\"SS_QUANTITY\" AS \"QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_QUANTITY\" AS \"QUANTITY\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" UNION ALL SELECT \"WEB_SALES\".\"WS_QUANTITY\" AS \"QUANTITY\" , \"WEB_SALES\".\"WS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) , \"AVG_SALES\" AS ( SELECT AVG ( \"X\".\"QUANTITY\" * \"X\".\"LIST_PRICE\" ) AS \"AVERAGE_SALES\" FROM \"X_2\" AS \"X\" ) , \"STORE_SALES_4\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"SS_QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"SS_LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"_U_2\" AS ( SELECT \"AVG_SALES\".\"AVERAGE_SALES\" AS \"AVERAGE_SALES\" FROM \"AVG_SALES\" AS \"AVG_SALES\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"SS_ITEM_SK\" FROM \"ITEM\" AS \"ITEM\" JOIN \"X\" AS \"X\" ON \"ITEM\".\"I_BRAND_ID\" = \"X\".\"BRAND_ID\" AND \"ITEM\".\"I_CATEGORY_ID\" = \"X\".\"CATEGORY_ID\" AND \"ITEM\".\"I_CLASS_ID\" = \"X\".\"CLASS_ID\" GROUP BY \"ITEM\".\"I_ITEM_SK\" ) , \"D\" AS ( SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"D\" ) , \"THIS_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ISS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_2\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"D\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ISS\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"D\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_DOM\" = 25 AND \"DATE_DIM\".\"D_MOY\" = 12 AND \"DATE_DIM\".\"D_YEAR\" = 2000 WHERE NOT \"_U_0\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ISS\".\"I_BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_2\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) , \"LAST_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ISS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_5\" LEFT JOIN \"_U_0\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"D\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ISS\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"D\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_DOM\" = 25 AND \"DATE_DIM\".\"D_MOY\" = 12 AND \"DATE_DIM\".\"D_YEAR\" = 1999 WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ISS\".\"I_BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_5\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) SELECT \"THIS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"THIS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"THIS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"THIS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"THIS_YEAR\".\"SALES\" AS \"SALES\" , \"THIS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"LAST_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"LAST_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"LAST_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"LAST_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"LAST_YEAR\".\"SALES\" AS \"SALES\" , \"LAST_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"THIS_YEAR\" AS \"THIS_YEAR\" JOIN \"LAST_YEAR\" AS \"LAST_YEAR\" ON \"LAST_YEAR\".\"I_BRAND_ID\" = \"THIS_YEAR\".\"I_BRAND_ID\" AND \"LAST_YEAR\".\"I_CATEGORY_ID\" = \"THIS_YEAR\".\"I_CATEGORY_ID\" AND \"LAST_YEAR\".\"I_CLASS_ID\" = \"THIS_YEAR\".\"I_CLASS_ID\" ORDER BY \"THIS_YEAR\".\"CHANNEL\" NULLS LAST , \"THIS_YEAR\".\"I_BRAND_ID\" NULLS LAST , \"THIS_YEAR\".\"I_CLASS_ID\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_32\" AS SELECT \"SPEQLITE_TEMP_TABLE_17\".\"AVERAGE_SALES\" AS \"AVERAGE_SALES\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.062141,
                    "execution_time": 0.035545,
                    "compile_time": 0.000241,
                    "planning_time": 0.002643,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.12532,
                    "execution_time": 0.035655,
                    "compile_time": 0.000276,
                    "planning_time": 0.063784,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_33\" AS SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"D\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.106415,
                    "execution_time": 0.039364,
                    "compile_time": 0.000244,
                    "planning_time": 0.026337,
                    "create_size": 480
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.170111,
                    "execution_time": 0.042047,
                    "compile_time": 0.000263,
                    "planning_time": 0.087396,
                    "create_size": 480
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_34\" AS SELECT 'store' AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"STORE_SALES\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_32\" AS \"SPEQLITE_TEMP_TABLE_32\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_33\" AS \"SPEQLITE_TEMP_TABLE_33\" ON \"SPEQLITE_TEMP_TABLE_33\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"SPEQLITE_TEMP_TABLE_33\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_DOM\" = 25 AND \"DATE_DIM\".\"D_MOY\" = 12 AND \"DATE_DIM\".\"D_YEAR\" = 2000 WHERE NOT \"SPEQLITE_TEMP_TABLE_18\".\"SS_ITEM_SK\" IS NULL GROUP BY \"SPEQLITE_TEMP_TABLE_15\".\"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CATEGORY_ID\" HAVING MAX ( \"SPEQLITE_TEMP_TABLE_32\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.190309,
                    "execution_time": 0.11052,
                    "compile_time": 0.000581,
                    "planning_time": 0.039182,
                    "create_size": 108
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.254174,
                    "execution_time": 0.11031,
                    "compile_time": 0.000601,
                    "planning_time": 0.103833,
                    "create_size": 108
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_35\" AS SELECT 'store' AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"STORE_SALES\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_32\" AS \"_U_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_33\" AS \"SPEQLITE_TEMP_TABLE_33\" ON \"SPEQLITE_TEMP_TABLE_33\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"SPEQLITE_TEMP_TABLE_33\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_DOM\" = 25 AND \"DATE_DIM\".\"D_MOY\" = 12 AND \"DATE_DIM\".\"D_YEAR\" = 1999 WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"SPEQLITE_TEMP_TABLE_15\".\"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_5\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.177434,
                    "execution_time": 0.105329,
                    "compile_time": 0.000597,
                    "planning_time": 0.039592,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.245435,
                    "execution_time": 0.104352,
                    "compile_time": 0.00056,
                    "planning_time": 0.106073,
                    "create_size": 18
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_36\" AS SELECT \"SPEQLITE_TEMP_TABLE_34\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_34\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_34\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_34\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_34\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_34\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_35\".\"CHANNEL\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_35\".\"I_BRAND_ID\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_35\".\"I_CLASS_ID\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_35\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_35\".\"SALES\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_35\".\"NUMBER_SALES\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_34\" AS \"SPEQLITE_TEMP_TABLE_34\" JOIN \"SPEQLITE_TEMP_TABLE_35\" AS \"SPEQLITE_TEMP_TABLE_35\" ON \"SPEQLITE_TEMP_TABLE_35\".\"I_BRAND_ID\" = \"SPEQLITE_TEMP_TABLE_34\".\"I_BRAND_ID\" AND \"SPEQLITE_TEMP_TABLE_35\".\"I_CATEGORY_ID\" = \"SPEQLITE_TEMP_TABLE_34\".\"I_CATEGORY_ID\" AND \"SPEQLITE_TEMP_TABLE_35\".\"I_CLASS_ID\" = \"SPEQLITE_TEMP_TABLE_34\".\"I_CLASS_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.086236,
                    "execution_time": 0.045449,
                    "compile_time": 0.000358,
                    "planning_time": 0.007656,
                    "create_size": 60
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.317202,
                    "execution_time": 0.051515,
                    "compile_time": 0.16278,
                    "planning_time": 0.066052,
                    "create_size": 60
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_36\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_36\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_36\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_36\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_36\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_36\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_36\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_36\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_36\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_36\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_36\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_36\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_36\" AS \"SPEQLITE_TEMP_TABLE_36\" ORDER BY \"SPEQLITE_TEMP_TABLE_36\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_36\".\"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_36\".\"I_CLASS_ID\" LIMIT 21",
                "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id       sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     1001001           1              1  6404262.37          1762         store           1001001                 1                    1   12953447.50                 3602\n1    store     1001002           1              1  8395652.34          2279         store           1001002                 1                    1    6406229.50                 1796\n2    store     1002001           2              1  7040482.27          1842         store           1002001                 2                    1   12519959.01                 3465\n3    store     1002002           2              1  8508680.67          2275         store           1002002                 2                    1    6701931.30                 1788\n4    store     1003001           3              1  6572331.91          1832         store           1003001                 3                    1   12919127.23                 3440\n5    store     1003002           3              1  8489408.10          2244         store           1003002                 3                    1    6167147.66                 1628\n6    store     1004001           4              1  6402598.52          1705         store           1004001                 4                    1   12683557.89                 3419\n7    store     1004002           4              1  8028643.03          2191         store           1004002                 4                    1    6477831.79                 1757\n8    store     2001001           1              2  6822089.15          1928         store           2001001                 1                    2   12895905.19                 3501\n9    store     2001002           1              2  8887122.24          2374         store           2001002                 1                    2    6770580.60                 1833\n10   store     2002001           2              2  6735909.73          1851         store           2002001                 2                    2   12634064.64                 3430\n11   store     2002002           2              2  7916276.56          2140         store           2002002                 2                    2    5603481.94                 1598\n12   store     2003001           3              2  6539485.66          1727         store           2003001                 3                    2   12777624.38                 3405\n13   store     2003002           3              2  7013486.61          1963         store           2003002                 3                    2    5994209.63                 1622\n14   store     2004001           4              2  6585735.74          1833         store           2004001                 4                    2   13574969.83                 3607\n15   store     2004002           4              2  8299472.84          2276         store           2004002                 4                    2    6201665.10                 1714\n16   store     3001001           1              3  6995771.72          1848         store           3001001                 1                    3   12211564.26                 3295\n17   store     3001002           1              3  7830544.31          2102         store           3001002                 1                    3    5827346.06                 1617\n18   store     3002001           2              3  7271832.68          1940         store           3002001                 2                    3   13370920.47                 3530\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020363,
                    "execution_time": 0.008132,
                    "compile_time": 8.4e-05,
                    "planning_time": 0.005232
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.182775,
                    "execution_time": 0.008788,
                    "compile_time": 0.124579,
                    "planning_time": 0.040843
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_34\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_34\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_34\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_34\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_34\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_34\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_35\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_35\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_35\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_35\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_35\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_35\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_34\" AS \"SPEQLITE_TEMP_TABLE_34\" JOIN \"SPEQLITE_TEMP_TABLE_35\" AS \"SPEQLITE_TEMP_TABLE_35\" ON \"SPEQLITE_TEMP_TABLE_35\".\"I_BRAND_ID\" = \"SPEQLITE_TEMP_TABLE_34\".\"I_BRAND_ID\" AND \"SPEQLITE_TEMP_TABLE_35\".\"I_CATEGORY_ID\" = \"SPEQLITE_TEMP_TABLE_34\".\"I_CATEGORY_ID\" AND \"SPEQLITE_TEMP_TABLE_35\".\"I_CLASS_ID\" = \"SPEQLITE_TEMP_TABLE_34\".\"I_CLASS_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_34\".\"CHANNEL\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_34\".\"I_BRAND_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_34\".\"I_CLASS_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_36\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_36\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_36\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_36\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_36\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_36\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_36\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_36\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_36\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_36\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_36\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_36\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_36\" AS \"SPEQLITE_TEMP_TABLE_36\" ORDER BY \"SPEQLITE_TEMP_TABLE_36\".\"CHANNEL\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_36\".\"I_BRAND_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_36\".\"I_CLASS_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id       sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     1001001           1              1  6404262.37          1762         store           1001001                 1                    1   12953447.50                 3602\n1    store     1001002           1              1  8395652.34          2279         store           1001002                 1                    1    6406229.50                 1796\n2    store     1002001           2              1  7040482.27          1842         store           1002001                 2                    1   12519959.01                 3465\n3    store     1002002           2              1  8508680.67          2275         store           1002002                 2                    1    6701931.30                 1788\n4    store     1003001           3              1  6572331.91          1832         store           1003001                 3                    1   12919127.23                 3440\n5    store     1003002           3              1  8489408.10          2244         store           1003002                 3                    1    6167147.66                 1628\n6    store     1004001           4              1  6402598.52          1705         store           1004001                 4                    1   12683557.89                 3419\n7    store     1004002           4              1  8028643.03          2191         store           1004002                 4                    1    6477831.79                 1757\n8    store     2001001           1              2  6822089.15          1928         store           2001001                 1                    2   12895905.19                 3501\n9    store     2001002           1              2  8887122.24          2374         store           2001002                 1                    2    6770580.60                 1833\n10   store     2002001           2              2  6735909.73          1851         store           2002001                 2                    2   12634064.64                 3430\n11   store     2002002           2              2  7916276.56          2140         store           2002002                 2                    2    5603481.94                 1598\n12   store     2003001           3              2  6539485.66          1727         store           2003001                 3                    2   12777624.38                 3405\n13   store     2003002           3              2  7013486.61          1963         store           2003002                 3                    2    5994209.63                 1622\n14   store     2004001           4              2  6585735.74          1833         store           2004001                 4                    2   13574969.83                 3607\n15   store     2004002           4              2  8299472.84          2276         store           2004002                 4                    2    6201665.10                 1714\n16   store     3001001           1              3  6995771.72          1848         store           3001001                 1                    3   12211564.26                 3295\n17   store     3001002           1              3  7830544.31          2102         store           3001002                 1                    3    5827346.06                 1617\n18   store     3002001           2              3  7271832.68          1940         store           3002001                 2                    3   13370920.47                 3530\n...*/"
    },
    {
        "input": "WITH cross_items \n     AS (SELECT i_item_sk ss_item_sk \n         FROM   item, \n                (SELECT iss.i_brand_id    brand_id, \n                        iss.i_class_id    class_id, \n                        iss.i_category_id category_id \n                 FROM   store_sales, \n                        item iss, \n                        date_dim d1 \n                 WHERE  ss_item_sk = iss.i_item_sk \n                        AND ss_sold_date_sk = d1.d_date_sk \n                        AND d1.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT ics.i_brand_id, \n                        ics.i_class_id, \n                        ics.i_category_id \n                 FROM   catalog_sales, \n                        item ics, \n                        date_dim d2 \n                 WHERE  cs_item_sk = ics.i_item_sk \n                        AND cs_sold_date_sk = d2.d_date_sk \n                        AND d2.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT iws.i_brand_id, \n                        iws.i_class_id, \n                        iws.i_category_id \n                 FROM   web_sales, \n                        item iws, \n                        date_dim d3 \n                 WHERE  ws_item_sk = iws.i_item_sk \n                        AND ws_sold_date_sk = d3.d_date_sk \n                        AND d3.d_year BETWEEN 1999 AND 1999 + 2) x \n         WHERE  i_brand_id = brand_id \n                AND i_class_id = class_id \n                AND i_category_id = category_id), \n     avg_sales \n     AS (SELECT Avg(quantity * list_price) average_sales \n         FROM   (SELECT ss_quantity   quantity, \n                        ss_list_price list_price \n                 FROM   store_sales, \n                        date_dim \n                 WHERE  ss_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT cs_quantity   quantity, \n                        cs_list_price list_price \n                 FROM   catalog_sales, \n                        date_dim \n                 WHERE  cs_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT ws_quantity   quantity, \n                        ws_list_price list_price \n                 FROM   web_sales, \n                        date_dim \n                 WHERE  ws_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2) x) \nSELECT  * \nFROM   (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 + 1 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) this_year, \n       (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) last_year \nWHERE  this_year.i_brand_id = last_year.i_brand_id \n       AND this_year.i_class_id = last_year.i_class_id \n       AND this_year.i_category_id = last_year.i_category_id \nORDER  BY this_year.channel, \n          this_year.i_brand_id, \n          this_year.i_class_id, \n          this_year.i_category_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"X\" AS ( SELECT \"ISS\".\"I_BRAND_ID\" AS \"BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"CATEGORY_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"D1\".\"D_YEAR\" <= 2001 AND \"D1\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" INTERSECT SELECT \"ICS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ICS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ICS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D2\".\"D_DATE_SK\" AND \"D2\".\"D_YEAR\" <= 2001 AND \"D2\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ICS\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ICS\".\"I_ITEM_SK\" INTERSECT SELECT \"IWS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"IWS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"IWS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D3\" ON \"D3\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D3\".\"D_YEAR\" <= 2001 AND \"D3\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"IWS\" ON \"IWS\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" <= 2001 AND \"DATE_DIM\".\"D_YEAR\" >= 1999 ) , \"X_2\" AS ( SELECT \"STORE_SALES\".\"SS_QUANTITY\" AS \"QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_QUANTITY\" AS \"QUANTITY\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" UNION ALL SELECT \"WEB_SALES\".\"WS_QUANTITY\" AS \"QUANTITY\" , \"WEB_SALES\".\"WS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) , \"AVG_SALES\" AS ( SELECT AVG ( \"X\".\"QUANTITY\" * \"X\".\"LIST_PRICE\" ) AS \"AVERAGE_SALES\" FROM \"X_2\" AS \"X\" ) , \"STORE_SALES_4\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"SS_QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"SS_LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"_U_2\" AS ( SELECT \"AVG_SALES\".\"AVERAGE_SALES\" AS \"AVERAGE_SALES\" FROM \"AVG_SALES\" AS \"AVG_SALES\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"SS_ITEM_SK\" FROM \"ITEM_2\" AS \"ITEM\" JOIN \"X\" AS \"X\" ON \"ITEM\".\"I_BRAND_ID\" = \"X\".\"BRAND_ID\" AND \"ITEM\".\"I_CATEGORY_ID\" = \"X\".\"CATEGORY_ID\" AND \"ITEM\".\"I_CLASS_ID\" = \"X\".\"CLASS_ID\" GROUP BY \"ITEM\".\"I_ITEM_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"THIS_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_2\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 2000 WHERE NOT \"_U_0\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_2\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) , \"LAST_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_5\" LEFT JOIN \"_U_0\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 1999 WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_5\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) SELECT \"THIS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"THIS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"THIS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"THIS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"THIS_YEAR\".\"SALES\" AS \"SALES\" , \"THIS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"LAST_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"LAST_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"LAST_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"LAST_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"LAST_YEAR\".\"SALES\" AS \"SALES\" , \"LAST_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"THIS_YEAR\" AS \"THIS_YEAR\" JOIN \"LAST_YEAR\" AS \"LAST_YEAR\" ON \"LAST_YEAR\".\"I_BRAND_ID\" = \"THIS_YEAR\".\"I_BRAND_ID\" AND \"LAST_YEAR\".\"I_CATEGORY_ID\" = \"THIS_YEAR\".\"I_CATEGORY_ID\" AND \"LAST_YEAR\".\"I_CLASS_ID\" = \"THIS_YEAR\".\"I_CLASS_ID\" ORDER BY \"THIS_YEAR\".\"CHANNEL\" NULLS LAST , \"THIS_YEAR\".\"I_BRAND_ID\" NULLS LAST , \"THIS_YEAR\".\"I_CLASS_ID\" NULLS LAST , \"THIS_YEAR\".\"I_CATEGORY_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\" JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" ON \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" LIMIT 21",
                "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id       sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     1001001           1              1  6404262.37          1762         store          10004007                 4                   10     203161.52                   58\n1    store     1001001           1              1  6404262.37          1762         store           7008007                 8                    7     585352.23                  142\n2    store     1001001           1              1  6404262.37          1762         store          10014006                14                   10     153252.04                   30\n3    store     1001001           1              1  6404262.37          1762         store          10008011                 8                   10     356817.17                   97\n4    store     1001001           1              1  6404262.37          1762         store           9007009                 7                    9     698785.76                  175\n5    store     1001001           1              1  6404262.37          1762         store           8005007                 5                    8     425845.95                  139\n6    store     1001001           1              1  6404262.37          1762         store          10001004                 1                   10     330505.17                   80\n7    store     1001001           1              1  6404262.37          1762         store          10005014                 5                   10     224646.07                   60\n8    store     1001001           1              1  6404262.37          1762         store          10002016                 2                   10     305706.92                   83\n9    store     1001001           1              1  6404262.37          1762         store           7012007                12                    7     569143.24                  176\n10   store     1001001           1              1  6404262.37          1762         store          10014005                14                   10     151813.98                   45\n11   store     1001001           1              1  6404262.37          1762         store           6002002                 2                    6     339313.83                  105\n12   store     1001001           1              1  6404262.37          1762         store           8001006                 1                    8     227753.06                   52\n13   store     1001001           1              1  6404262.37          1762         store          10016004                16                   10     325385.05                   83\n14   store     1001001           1              1  6404262.37          1762         store          10003009                 3                   10     292630.52                   85\n15   store     1001001           1              1  6404262.37          1762         store          10004001                 4                   10     299116.22                   80\n16   store     1001001           1              1  6404262.37          1762         store          10012003                12                   10     473554.90                  125\n17   store     1001001           1              1  6404262.37          1762         store           8007007                 7                    8     523649.77                  138\n18   store     1001001           1              1  6404262.37          1762         store           8016010                16                    8     580545.54                  158\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.059484,
                    "execution_time": 0.041241,
                    "compile_time": 0.000143,
                    "planning_time": 0.008311
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.200788,
                    "execution_time": 0.042162,
                    "compile_time": 0.103492,
                    "planning_time": 0.044409
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_22\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_28\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_28\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" ON \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" = \"SPEQLITE_TEMP_TABLE_22\".\"I_BRAND_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" = \"SPEQLITE_TEMP_TABLE_22\".\"I_CATEGORY_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" = \"SPEQLITE_TEMP_TABLE_22\".\"I_CLASS_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_22\".\"CHANNEL\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_22\".\"I_BRAND_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_22\".\"I_CLASS_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_22\".\"I_CATEGORY_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\" JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" ON \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id       sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     1001001           1              1  6404262.37          1762         store          10004007                 4                   10     203161.52                   58\n1    store     1001001           1              1  6404262.37          1762         store           7008007                 8                    7     585352.23                  142\n2    store     1001001           1              1  6404262.37          1762         store          10014006                14                   10     153252.04                   30\n3    store     1001001           1              1  6404262.37          1762         store          10008011                 8                   10     356817.17                   97\n4    store     1001001           1              1  6404262.37          1762         store           9007009                 7                    9     698785.76                  175\n5    store     1001001           1              1  6404262.37          1762         store           8005007                 5                    8     425845.95                  139\n6    store     1001001           1              1  6404262.37          1762         store          10001004                 1                   10     330505.17                   80\n7    store     1001001           1              1  6404262.37          1762         store          10005014                 5                   10     224646.07                   60\n8    store     1001001           1              1  6404262.37          1762         store          10002016                 2                   10     305706.92                   83\n9    store     1001001           1              1  6404262.37          1762         store           7012007                12                    7     569143.24                  176\n10   store     1001001           1              1  6404262.37          1762         store          10014005                14                   10     151813.98                   45\n11   store     1001001           1              1  6404262.37          1762         store           6002002                 2                    6     339313.83                  105\n12   store     1001001           1              1  6404262.37          1762         store           8001006                 1                    8     227753.06                   52\n13   store     1001001           1              1  6404262.37          1762         store          10016004                16                   10     325385.05                   83\n14   store     1001001           1              1  6404262.37          1762         store          10003009                 3                   10     292630.52                   85\n15   store     1001001           1              1  6404262.37          1762         store          10004001                 4                   10     299116.22                   80\n16   store     1001001           1              1  6404262.37          1762         store          10012003                12                   10     473554.90                  125\n17   store     1001001           1              1  6404262.37          1762         store           8007007                 7                    8     523649.77                  138\n18   store     1001001           1              1  6404262.37          1762         store           8016010                16                    8     580545.54                  158\n...*/"
    },
    {
        "input": "WITH cross_items \n     AS (SELECT i_item_sk ss_item_sk \n         FROM   item, \n                (SELECT iss.i_brand_id    brand_id, \n                        iss.i_class_id    class_id, \n                        iss.i_category_id category_id \n                 FROM   store_sales, \n                        item iss, \n                        date_dim d1 \n                 WHERE  ss_item_sk = iss.i_item_sk \n                        AND ss_sold_date_sk = d1.d_date_sk \n                        AND d1.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT ics.i_brand_id, \n                        ics.i_class_id, \n                        ics.i_category_id \n                 FROM   catalog_sales, \n                        item ics, \n                        date_dim d2 \n                 WHERE  cs_item_sk = ics.i_item_sk \n                        AND cs_sold_date_sk = d2.d_date_sk \n                        AND d2.d_year BETWEEN 1999 AND 1999 + 2 \n                 INTERSECT \n                 SELECT iws.i_brand_id, \n                        iws.i_class_id, \n                        iws.i_category_id \n                 FROM   web_sales, \n                        item iws, \n                        date_dim d3 \n                 WHERE  ws_item_sk = iws.i_item_sk \n                        AND ws_sold_date_sk = d3.d_date_sk \n                        AND d3.d_year BETWEEN 1999 AND 1999 + 2) x \n         WHERE  i_brand_id = brand_id \n                AND i_class_id = class_id \n                AND i_category_id = category_id), \n     avg_sales \n     AS (SELECT Avg(quantity * list_price) average_sales \n         FROM   (SELECT ss_quantity   quantity, \n                        ss_list_price list_price \n                 FROM   store_sales, \n                        date_dim \n                 WHERE  ss_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT cs_quantity   quantity, \n                        cs_list_price list_price \n                 FROM   catalog_sales, \n                        date_dim \n                 WHERE  cs_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2 \n                 UNION ALL \n                 SELECT ws_quantity   quantity, \n                        ws_list_price list_price \n                 FROM   web_sales, \n                        date_dim \n                 WHERE  ws_sold_date_sk = d_date_sk \n                        AND d_year BETWEEN 1999 AND 1999 + 2) x) \nSELECT  * \nFROM   (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 + 1 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) this_year, \n       (SELECT 'store'                          channel, \n               i_brand_id, \n               i_class_id, \n               i_category_id, \n               Sum(ss_quantity * ss_list_price) sales, \n               Count(*)                         number_sales \n        FROM   store_sales, \n               item, \n               date_dim \n        WHERE  ss_item_sk IN (SELECT ss_item_sk \n                              FROM   cross_items) \n               AND ss_item_sk = i_item_sk \n               AND ss_sold_date_sk = d_date_sk \n               AND d_week_seq = (SELECT d_week_seq \n                                 FROM   date_dim \n                                 WHERE  d_year = 1999 \n                                        AND d_moy = 12 \n                                        AND d_dom = 25) \n        GROUP  BY i_brand_id, \n                  i_class_id, \n                  i_category_id \n        HAVING Sum(ss_quantity * ss_list_price) > (SELECT average_sales \n                                                   FROM   avg_sales)) last_year \nWHERE  this_year.i_brand_id = last_year.i_brand_id \n       AND this_year.i_class_id = last_year.i_class_id \n       AND this_year.i_category_id = last_year.i_category_id \nORDER  BY this_year.channel, \n          this_year.i_brand_id, \n          this_year.i_class_id, \n          this_year.i_category_id\nLIMIT 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"X\" AS ( SELECT \"ISS\".\"I_BRAND_ID\" AS \"BRAND_ID\" , \"ISS\".\"I_CLASS_ID\" AS \"CLASS_ID\" , \"ISS\".\"I_CATEGORY_ID\" AS \"CATEGORY_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"D1\".\"D_YEAR\" <= 2001 AND \"D1\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ISS\" ON \"ISS\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" INTERSECT SELECT \"ICS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ICS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ICS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"D2\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D2\".\"D_DATE_SK\" AND \"D2\".\"D_YEAR\" <= 2001 AND \"D2\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"ICS\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ICS\".\"I_ITEM_SK\" INTERSECT SELECT \"IWS\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"IWS\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"IWS\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D3\" ON \"D3\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D3\".\"D_YEAR\" <= 2001 AND \"D3\".\"D_YEAR\" >= 1999 JOIN \"ITEM\" AS \"IWS\" ON \"IWS\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" <= 2001 AND \"DATE_DIM\".\"D_YEAR\" >= 1999 ) , \"X_2\" AS ( SELECT \"STORE_SALES\".\"SS_QUANTITY\" AS \"QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_QUANTITY\" AS \"QUANTITY\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" UNION ALL SELECT \"WEB_SALES\".\"WS_QUANTITY\" AS \"QUANTITY\" , \"WEB_SALES\".\"WS_LIST_PRICE\" AS \"LIST_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) , \"AVG_SALES\" AS ( SELECT AVG ( \"X\".\"QUANTITY\" * \"X\".\"LIST_PRICE\" ) AS \"AVERAGE_SALES\" FROM \"X_2\" AS \"X\" ) , \"STORE_SALES_4\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_QUANTITY\" AS \"SS_QUANTITY\" , \"STORE_SALES\".\"SS_LIST_PRICE\" AS \"SS_LIST_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"_U_2\" AS ( SELECT \"AVG_SALES\".\"AVERAGE_SALES\" AS \"AVERAGE_SALES\" FROM \"AVG_SALES\" AS \"AVG_SALES\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"SS_ITEM_SK\" FROM \"ITEM_2\" AS \"ITEM\" JOIN \"X\" AS \"X\" ON \"ITEM\".\"I_BRAND_ID\" = \"X\".\"BRAND_ID\" AND \"ITEM\".\"I_CATEGORY_ID\" = \"X\".\"CATEGORY_ID\" AND \"ITEM\".\"I_CLASS_ID\" = \"X\".\"CLASS_ID\" GROUP BY \"ITEM\".\"I_ITEM_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"THIS_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_2\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 2000 WHERE NOT \"_U_0\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_2\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) , \"LAST_YEAR\" AS ( SELECT 'store' AS \"CHANNEL\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"SALES\" , COUNT ( * ) AS \"NUMBER_SALES\" FROM \"STORE_SALES_4\" AS \"STORE_SALES\" CROSS JOIN \"_U_2\" AS \"_U_5\" LEFT JOIN \"_U_0\" AS \"_U_3\" ON \"_U_3\".\"SS_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"DATE_DIM_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_DOM\" = 25 AND \"DATE_DIM_2\".\"D_MOY\" = 12 AND \"DATE_DIM_2\".\"D_YEAR\" = 1999 WHERE NOT \"_U_3\".\"SS_ITEM_SK\" IS NULL GROUP BY \"ITEM\".\"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" HAVING MAX ( \"_U_5\".\"AVERAGE_SALES\" ) < SUM ( \"STORE_SALES\".\"SS_QUANTITY\" * \"STORE_SALES\".\"SS_LIST_PRICE\" ) ) SELECT \"THIS_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"THIS_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"THIS_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"THIS_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"THIS_YEAR\".\"SALES\" AS \"SALES\" , \"THIS_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"LAST_YEAR\".\"CHANNEL\" AS \"CHANNEL\" , \"LAST_YEAR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"LAST_YEAR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"LAST_YEAR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"LAST_YEAR\".\"SALES\" AS \"SALES\" , \"LAST_YEAR\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"THIS_YEAR\" AS \"THIS_YEAR\" JOIN \"LAST_YEAR\" AS \"LAST_YEAR\" ON \"LAST_YEAR\".\"I_BRAND_ID\" = \"THIS_YEAR\".\"I_BRAND_ID\" AND \"LAST_YEAR\".\"I_CATEGORY_ID\" = \"THIS_YEAR\".\"I_CATEGORY_ID\" AND \"LAST_YEAR\".\"I_CLASS_ID\" = \"THIS_YEAR\".\"I_CLASS_ID\" ORDER BY \"THIS_YEAR\".\"CHANNEL\" NULLS LAST , \"THIS_YEAR\".\"I_BRAND_ID\" NULLS LAST , \"THIS_YEAR\".\"I_CLASS_ID\" NULLS LAST , \"THIS_YEAR\".\"I_CATEGORY_ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\" JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" ON \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" LIMIT 21",
                "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id       sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     1001001           1              1  6404262.37          1762         store          10004007                 4                   10     203161.52                   58\n1    store     1001001           1              1  6404262.37          1762         store           7008007                 8                    7     585352.23                  142\n2    store     1001001           1              1  6404262.37          1762         store          10014006                14                   10     153252.04                   30\n3    store     1001001           1              1  6404262.37          1762         store          10008011                 8                   10     356817.17                   97\n4    store     1001001           1              1  6404262.37          1762         store           9007009                 7                    9     698785.76                  175\n5    store     1001001           1              1  6404262.37          1762         store           8005007                 5                    8     425845.95                  139\n6    store     1001001           1              1  6404262.37          1762         store          10001004                 1                   10     330505.17                   80\n7    store     1001001           1              1  6404262.37          1762         store          10005014                 5                   10     224646.07                   60\n8    store     1001001           1              1  6404262.37          1762         store          10002016                 2                   10     305706.92                   83\n9    store     1001001           1              1  6404262.37          1762         store           7012007                12                    7     569143.24                  176\n10   store     1001001           1              1  6404262.37          1762         store          10014005                14                   10     151813.98                   45\n11   store     1001001           1              1  6404262.37          1762         store           6002002                 2                    6     339313.83                  105\n12   store     1001001           1              1  6404262.37          1762         store           8001006                 1                    8     227753.06                   52\n13   store     1001001           1              1  6404262.37          1762         store          10016004                16                   10     325385.05                   83\n14   store     1001001           1              1  6404262.37          1762         store          10003009                 3                   10     292630.52                   85\n15   store     1001001           1              1  6404262.37          1762         store          10004001                 4                   10     299116.22                   80\n16   store     1001001           1              1  6404262.37          1762         store          10012003                12                   10     473554.90                  125\n17   store     1001001           1              1  6404262.37          1762         store           8007007                 7                    8     523649.77                  138\n18   store     1001001           1              1  6404262.37          1762         store           8016010                16                    8     580545.54                  158\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.059683,
                    "execution_time": 0.041252,
                    "compile_time": 0.000139,
                    "planning_time": 0.008442
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.059363,
                    "execution_time": 0.040948,
                    "compile_time": 0.000137,
                    "planning_time": 0.008374
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_22\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_28\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_28\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_28\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" ON \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" = \"SPEQLITE_TEMP_TABLE_22\".\"I_BRAND_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" = \"SPEQLITE_TEMP_TABLE_22\".\"I_CATEGORY_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" = \"SPEQLITE_TEMP_TABLE_22\".\"I_CLASS_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_22\".\"CHANNEL\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_22\".\"I_BRAND_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_22\".\"I_CLASS_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_22\".\"I_CATEGORY_ID\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" AS \"CHANNEL\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES\" AS \"SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES\" AS \"NUMBER_SALES\" , \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL_COL_6\" AS \"CHANNEL_COL_6\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID_COL_7\" AS \"I_BRAND_ID_COL_7\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID_COL_8\" AS \"I_CLASS_ID_COL_8\" , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID_COL_9\" AS \"I_CATEGORY_ID_COL_9\" , \"SPEQLITE_TEMP_TABLE_29\".\"SALES_COL_10\" AS \"SALES_COL_10\" , \"SPEQLITE_TEMP_TABLE_29\".\"NUMBER_SALES_COL_11\" AS \"NUMBER_SALES_COL_11\" FROM \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\" JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" ON \"SPEQLITE_TEMP_TABLE_28\".\"I_BRAND_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CATEGORY_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" AND \"SPEQLITE_TEMP_TABLE_28\".\"I_CLASS_ID\" = \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_29\".\"CHANNEL\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_29\".\"I_BRAND_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_29\".\"I_CLASS_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_29\".\"I_CATEGORY_ID\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   channel  i_brand_id  i_class_id  i_category_id       sales  number_sales channel_col_6  i_brand_id_col_7  i_class_id_col_8  i_category_id_col_9  sales_col_10  number_sales_col_11\n0    store     1001001           1              1  6404262.37          1762         store          10004007                 4                   10     203161.52                   58\n1    store     1001001           1              1  6404262.37          1762         store           7008007                 8                    7     585352.23                  142\n2    store     1001001           1              1  6404262.37          1762         store          10014006                14                   10     153252.04                   30\n3    store     1001001           1              1  6404262.37          1762         store          10008011                 8                   10     356817.17                   97\n4    store     1001001           1              1  6404262.37          1762         store           9007009                 7                    9     698785.76                  175\n5    store     1001001           1              1  6404262.37          1762         store           8005007                 5                    8     425845.95                  139\n6    store     1001001           1              1  6404262.37          1762         store          10001004                 1                   10     330505.17                   80\n7    store     1001001           1              1  6404262.37          1762         store          10005014                 5                   10     224646.07                   60\n8    store     1001001           1              1  6404262.37          1762         store          10002016                 2                   10     305706.92                   83\n9    store     1001001           1              1  6404262.37          1762         store           7012007                12                    7     569143.24                  176\n10   store     1001001           1              1  6404262.37          1762         store          10014005                14                   10     151813.98                   45\n11   store     1001001           1              1  6404262.37          1762         store           6002002                 2                    6     339313.83                  105\n12   store     1001001           1              1  6404262.37          1762         store           8001006                 1                    8     227753.06                   52\n13   store     1001001           1              1  6404262.37          1762         store          10016004                16                   10     325385.05                   83\n14   store     1001001           1              1  6404262.37          1762         store          10003009                 3                   10     292630.52                   85\n15   store     1001001           1              1  6404262.37          1762         store          10004001                 4                   10     299116.22                   80\n16   store     1001001           1              1  6404262.37          1762         store          10012003                12                   10     473554.90                  125\n17   store     1001001           1              1  6404262.37          1762         store           8007007                 7                    8     523649.77                  138\n18   store     1001001           1              1  6404262.37          1762         store           8016010                16                    8     580545.54                  158\n...*/"
    }
]