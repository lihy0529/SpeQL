[
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20) B4 /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.132777,
                    "execution_time": 0.0729,
                    "compile_time": 0.000392,
                    "planning_time": 0.028179,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.12957,
                    "execution_time": 1.001324,
                    "compile_time": 0.000399,
                    "planning_time": 0.094247,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.125315,
                    "execution_time": 0.06628,
                    "compile_time": 0.0004,
                    "planning_time": 0.028283,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.192383,
                    "execution_time": 0.067169,
                    "compile_time": 0.000386,
                    "planning_time": 0.091776,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.131321,
                    "execution_time": 0.071728,
                    "compile_time": 0.000402,
                    "planning_time": 0.028281,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.211228,
                    "execution_time": 0.072519,
                    "compile_time": 0.000408,
                    "planning_time": 0.093068,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.114871,
                    "execution_time": 0.055467,
                    "compile_time": 0.000422,
                    "planning_time": 0.026812,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.175721,
                    "execution_time": 0.054982,
                    "compile_time": 0.000398,
                    "planning_time": 0.088406,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_4\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_4\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_4\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.095331,
                    "execution_time": 0.060194,
                    "compile_time": 0.000379,
                    "planning_time": 0.007779,
                    "create_size": 15
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.158084,
                    "execution_time": 0.060154,
                    "compile_time": 0.000386,
                    "planning_time": 0.066984,
                    "create_size": 15
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_5\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_5\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_5\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd  b4_lp   b4_cnt  b4_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  75.72  1342966    19688*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018569,
                    "execution_time": 0.00716,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004846
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056491,
                    "execution_time": 0.007533,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.040577
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_4\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_4\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_4\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_5\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_5\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_5\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_5\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd  b4_lp   b4_cnt  b4_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  75.72  1342966    19688*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10))\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"_Q_0\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"_Q_0\".\"B4_LP\" AS \"B4_LP\" , \"_Q_0\".\"B4_CNT\" AS \"B4_CNT\" , \"_Q_0\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"_Q_0\" AS \"_Q_0\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.115244,
                    "execution_time": 0.057391,
                    "compile_time": 0.000396,
                    "planning_time": 0.02719,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.177235,
                    "execution_time": 0.055948,
                    "compile_time": 0.000416,
                    "planning_time": 0.087978,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"B2_CNTD\" AS \"B2_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.062868,
                    "execution_time": 0.035687,
                    "compile_time": 0.000232,
                    "planning_time": 0.003236,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.121267,
                    "execution_time": 0.035926,
                    "compile_time": 0.000234,
                    "planning_time": 0.059241,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_3\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_3\".\"B3_CNTD\" AS \"B3_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.063158,
                    "execution_time": 0.035836,
                    "compile_time": 0.000236,
                    "planning_time": 0.003104,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.118994,
                    "execution_time": 0.035181,
                    "compile_time": 0.000242,
                    "planning_time": 0.05898,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_6\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_6\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_6\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.096282,
                    "execution_time": 0.060267,
                    "compile_time": 0.000392,
                    "planning_time": 0.008079,
                    "create_size": 15
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.154042,
                    "execution_time": 0.059206,
                    "compile_time": 0.00039,
                    "planning_time": 0.066566,
                    "create_size": 15
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_9\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_9\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_9\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  108.87  1679623     1001*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019109,
                    "execution_time": 0.007238,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.00493
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055104,
                    "execution_time": 0.007489,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.040843
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_6\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_6\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_6\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_9\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_9\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_9\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_9\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_9\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  108.87  1679623     1001*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10)\n          or ss_coupon_amt between 2440 and 2440+1000\n/*CURSOR_IDENTIFIER*/)",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"_Q_0\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 OR \"STORE_SALES\".\"SS_QUANTITY\" <= 20 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 OR \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_QUANTITY\" <= 20 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"_Q_0\".\"B4_LP\" AS \"B4_LP\" , \"_Q_0\".\"B4_CNT\" AS \"B4_CNT\" , \"_Q_0\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"_Q_0\" AS \"_Q_0\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 ) AND ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.177801,
                    "execution_time": 0.12015,
                    "compile_time": 0.000395,
                    "planning_time": 0.026966,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.245622,
                    "execution_time": 0.12213,
                    "compile_time": 0.000388,
                    "planning_time": 0.08988,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_10\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_10\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_10\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.098708,
                    "execution_time": 0.060017,
                    "compile_time": 0.000374,
                    "planning_time": 0.007872,
                    "create_size": 15
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.155095,
                    "execution_time": 0.063833,
                    "compile_time": 0.000377,
                    "planning_time": 0.06615,
                    "create_size": 15
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_11\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_11\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_11\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd  b4_lp    b4_cnt  b4_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  75.23  26587556    19736*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018757,
                    "execution_time": 0.007271,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004836
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055565,
                    "execution_time": 0.007473,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.041074
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_10\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_10\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_10\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_11\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_11\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_11\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_11\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd  b4_lp    b4_cnt  b4_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  75.23  26587556    19736*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.133944,
                    "execution_time": 0.074419,
                    "compile_time": 0.000394,
                    "planning_time": 0.028464,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.205849,
                    "execution_time": 0.07667,
                    "compile_time": 0.000387,
                    "planning_time": 0.095414,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.096282,
                    "execution_time": 0.062037,
                    "compile_time": 0.00038,
                    "planning_time": 0.007853,
                    "create_size": 15
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.157022,
                    "execution_time": 0.063318,
                    "compile_time": 0.000382,
                    "planning_time": 0.066135,
                    "create_size": 15
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_13\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_13\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_13\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019255,
                    "execution_time": 0.007239,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.005092
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055207,
                    "execution_time": 0.007457,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.04088
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_13\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_13\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_13\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_13\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_13\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            /*CURSOR_IDENTIFIER*/\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 120 and 120+10\n          or ss_coupon_amt between 3000 and 3000+1000\n          or ss_wholesale_cost between 75 and 75+20)) B5\n",
        "optimize": [
            "SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 4000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 3000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 130 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 120 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 95 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 75 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 4000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 3000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 130 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 120 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 95 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 75 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.123795,
                    "execution_time": 0.069782,
                    "compile_time": 0.000305,
                    "planning_time": 0.027946,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.190417,
                    "execution_time": 0.069512,
                    "compile_time": 0.000311,
                    "planning_time": 0.091333,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"B5_LP\" AS \"B5_LP\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" LIMIT 21",
                "preview": "\n/*    b5_lp\n0  127.19*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016213,
                    "execution_time": 0.007534,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.002931
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.050821,
                    "execution_time": 0.007235,
                    "compile_time": 4e-05,
                    "planning_time": 0.037912
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"B5_LP\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE (\"STORE_SALES\".\"SS_COUPON_AMT\" <= 4000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 3000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 130 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 120 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 95 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 75) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"B5_LP\" AS \"B5_LP\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\""
            }
        ],
        "preview": "\n/*    b5_lp\n0  127.19*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25) B5  /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"SPEQLITE_TEMP_TABLE_12\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"B4_CNTD\" AS \"B4_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.062634,
                    "execution_time": 0.035444,
                    "compile_time": 0.000231,
                    "planning_time": 0.003175,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.120329,
                    "execution_time": 0.035203,
                    "compile_time": 0.000235,
                    "planning_time": 0.060767,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.113056,
                    "execution_time": 0.055187,
                    "compile_time": 0.000389,
                    "planning_time": 0.028132,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.179789,
                    "execution_time": 0.05559,
                    "compile_time": 0.000408,
                    "planning_time": 0.089844,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.107572,
                    "execution_time": 0.068458,
                    "compile_time": 0.000432,
                    "planning_time": 0.009742,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.179998,
                    "execution_time": 0.06894,
                    "compile_time": 0.000434,
                    "planning_time": 0.067876,
                    "create_size": 18
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  75.75  1340909    19692*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019577,
                    "execution_time": 0.007168,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.005449
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057827,
                    "execution_time": 0.007929,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.041256
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_17\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_17\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  75.75  1340909    19692*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 90 and 90+10\n          or ss_coupon_amt between 5000 and 5000+1000\n          or ss_wholesale_cost between 12 and 12+20)) B5\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 100 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 90 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 32 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 12 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 100 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 90 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 32 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 12 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.133041,
                    "execution_time": 0.073759,
                    "compile_time": 0.000387,
                    "planning_time": 0.028676,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.199229,
                    "execution_time": 0.073362,
                    "compile_time": 0.000398,
                    "planning_time": 0.091975,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_18\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_18\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_18\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.107886,
                    "execution_time": 0.067669,
                    "compile_time": 0.000454,
                    "planning_time": 0.009908,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.167193,
                    "execution_time": 0.068228,
                    "compile_time": 0.000464,
                    "planning_time": 0.068835,
                    "create_size": 18
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" LIMIT 21",
                "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  49.13  1808676     6121*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020897,
                    "execution_time": 0.007879,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.005602
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056723,
                    "execution_time": 0.007864,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.041598
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_18\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_18\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_18\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_19\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_19\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\""
            }
        ],
        "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  49.13  1808676     6121*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n) B5 /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.158561,
                    "execution_time": 0.101981,
                    "compile_time": 0.000404,
                    "planning_time": 0.025924,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.22349,
                    "execution_time": 0.101663,
                    "compile_time": 0.000391,
                    "planning_time": 0.090109,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_20\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_20\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_20\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.10646,
                    "execution_time": 0.067464,
                    "compile_time": 0.000437,
                    "planning_time": 0.009802,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.16605,
                    "execution_time": 0.068347,
                    "compile_time": 0.000424,
                    "planning_time": 0.068065,
                    "create_size": 18
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" LIMIT 21",
                "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  75.74  27504367    19736*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.024005,
                    "execution_time": 0.011423,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.00538
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056343,
                    "execution_time": 0.00785,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.041273
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_20\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_20\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_20\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_21\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_21\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_21\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\""
            }
        ],
        "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp    b5_cnt  b5_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  75.74  27504367    19736*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n) B5/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"B1_LP\" AS \"B1_LP\" , \"B1_CNT\" AS \"B1_CNT\" , \"B1_CNTD\" AS \"B1_CNTD\" , \"B2_LP\" AS \"B2_LP\" , \"B2_CNT\" AS \"B2_CNT\" , \"B2_CNTD\" AS \"B2_CNTD\" , \"B3_LP\" AS \"B3_LP\" , \"B3_CNT\" AS \"B3_CNT\" , \"B3_CNTD\" AS \"B3_CNTD\" , \"B4_LP\" AS \"B4_LP\" , \"B4_CNT\" AS \"B4_CNT\" , \"B4_CNTD\" AS \"B4_CNTD\" , \"B5_LP\" AS \"B5_LP\" , \"B5_CNT\" AS \"B5_CNT\" , \"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  75.75  1340909    19692*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019244,
                    "execution_time": 0.007158,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.005194
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055485,
                    "execution_time": 0.007566,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.041044
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_16\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "rewrite": "SELECT \"B1_LP\" AS \"B1_LP\", \"B1_CNT\" AS \"B1_CNT\", \"B1_CNTD\" AS \"B1_CNTD\", \"B2_LP\" AS \"B2_LP\", \"B2_CNT\" AS \"B2_CNT\", \"B2_CNTD\" AS \"B2_CNTD\", \"B3_LP\" AS \"B3_LP\", \"B3_CNT\" AS \"B3_CNT\", \"B3_CNTD\" AS \"B3_CNTD\", \"B4_LP\" AS \"B4_LP\", \"B4_CNT\" AS \"B4_CNT\", \"B4_CNTD\" AS \"B4_CNTD\", \"B5_LP\" AS \"B5_LP\", \"B5_CNT\" AS \"B5_CNT\", \"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  75.75  1340909    19692*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 10295 and 10295+1000\n          or ss_wholesale_cost between 85 and 85+20)\n/*CURSOR_IDENTIFIER*/\n      ) B5",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 11295 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 10295 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 105 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 85 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_22\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 11295 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 10295 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 105 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 85 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.135521,
                    "execution_time": 0.071089,
                    "compile_time": 0.000395,
                    "planning_time": 0.033716,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.210169,
                    "execution_time": 0.071566,
                    "compile_time": 0.000401,
                    "planning_time": 0.104562,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_23\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_22\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_22\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.108666,
                    "execution_time": 0.067931,
                    "compile_time": 0.000472,
                    "planning_time": 0.009922,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.170563,
                    "execution_time": 0.068496,
                    "compile_time": 0.000443,
                    "planning_time": 0.071614,
                    "create_size": 18
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" LIMIT 21",
                "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd   b5_lp   b5_cnt  b5_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  139.64  1057482    11336*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020236,
                    "execution_time": 0.007787,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.00546
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056519,
                    "execution_time": 0.007623,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.041725
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_22\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_22\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_23\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_23\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_23\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\""
            }
        ],
        "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd   b5_lp   b5_cnt  b5_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  139.64  1057482    11336*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000)) B5 -- Added missing closing parenthesis\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_24\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.125561,
                    "execution_time": 0.066784,
                    "compile_time": 0.000406,
                    "planning_time": 0.027549,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.188464,
                    "execution_time": 0.064645,
                    "compile_time": 0.000386,
                    "planning_time": 0.090624,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_25\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_24\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_24\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_24\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.10762,
                    "execution_time": 0.068782,
                    "compile_time": 0.00043,
                    "planning_time": 0.009646,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.167831,
                    "execution_time": 0.068255,
                    "compile_time": 0.000465,
                    "planning_time": 0.069296,
                    "create_size": 18
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" LIMIT 21",
                "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd   b5_lp  b5_cnt  b5_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  153.94  184704    10563*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020147,
                    "execution_time": 0.007889,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.005315
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057108,
                    "execution_time": 0.007499,
                    "compile_time": 6.2e-05,
                    "planning_time": 0.041931
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_24\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_24\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_24\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_25\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_25\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_25\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\""
            }
        ],
        "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd   b5_lp  b5_cnt  b5_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  153.94  184704    10563*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_26\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.141821,
                    "execution_time": 0.079637,
                    "compile_time": 0.000459,
                    "planning_time": 0.029975,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.203537,
                    "execution_time": 0.077083,
                    "compile_time": 0.000407,
                    "planning_time": 0.092173,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_27\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_26\" AS \"SPEQLITE_TEMP_TABLE_26\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.106445,
                    "execution_time": 0.06722,
                    "compile_time": 0.000427,
                    "planning_time": 0.009881,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.17146,
                    "execution_time": 0.070182,
                    "compile_time": 0.000488,
                    "planning_time": 0.0701,
                    "create_size": 18
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_27\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_27\" AS \"SPEQLITE_TEMP_TABLE_27\" LIMIT 21",
                "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  35.79  1524743    14853*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019129,
                    "execution_time": 0.007138,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.005235
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056315,
                    "execution_time": 0.007963,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.041239
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_26\" AS \"SPEQLITE_TEMP_TABLE_26\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_27\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_27\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_27\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_27\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_27\" AS \"SPEQLITE_TEMP_TABLE_27\""
            }
        ],
        "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  35.79  1524743    14853*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 200 and 200+10\n          or ss_coupon_amt between 1500 and 1500+1000\n          or ss_wholesale_cost between 10 and 10+20)) B6\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2500 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1500 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 210 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 200 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_28\" AS SELECT \"SPEQLITE_TEMP_TABLE_26\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_26\".\"B5_CNTD\" AS \"B5_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_26\" AS \"SPEQLITE_TEMP_TABLE_26\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.062432,
                    "execution_time": 0.035651,
                    "compile_time": 0.000241,
                    "planning_time": 0.003115,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.121868,
                    "execution_time": 0.035554,
                    "compile_time": 0.000234,
                    "planning_time": 0.061761,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_29\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2500 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1500 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 210 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 200 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.132881,
                    "execution_time": 0.073514,
                    "compile_time": 0.000395,
                    "planning_time": 0.028663,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.210792,
                    "execution_time": 0.072998,
                    "compile_time": 0.000418,
                    "planning_time": 0.092185,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_30\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_29\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_29\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_29\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.119028,
                    "execution_time": 0.075847,
                    "compile_time": 0.000467,
                    "planning_time": 0.011815,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.180324,
                    "execution_time": 0.074513,
                    "compile_time": 0.000485,
                    "planning_time": 0.070804,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_30\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_30\" AS \"SPEQLITE_TEMP_TABLE_30\" LIMIT 21",
                "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd  b6_lp   b6_cnt  b6_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  35.79  1524743    14853  32.31  1644187    16516*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.02014,
                    "execution_time": 0.007118,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.005832
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05828,
                    "execution_time": 0.007591,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.0418
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_29\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_29\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_29\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_29\" AS \"SPEQLITE_TEMP_TABLE_29\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_30\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_30\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_30\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_30\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_30\" AS \"SPEQLITE_TEMP_TABLE_30\""
            }
        ],
        "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd  b6_lp   b6_cnt  b6_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  35.79  1524743    14853  32.31  1644187    16516*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 80 and 80+10\n          or ss_coupon_amt between 1000 and 1000+1000\n          or ss_wholesale_cost between 5 and 5+20)) B6\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 90 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 80 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 25 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 5 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_31\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 90 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 80 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 25 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 5 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.140505,
                    "execution_time": 0.08033,
                    "compile_time": 0.000391,
                    "planning_time": 0.029307,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.206687,
                    "execution_time": 0.079842,
                    "compile_time": 0.000399,
                    "planning_time": 0.092816,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_32\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_31\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_31\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_31\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_31\" AS \"SPEQLITE_TEMP_TABLE_31\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.122001,
                    "execution_time": 0.07642,
                    "compile_time": 0.000506,
                    "planning_time": 0.013475,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.177428,
                    "execution_time": 0.075971,
                    "compile_time": 0.000511,
                    "planning_time": 0.070767,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_32\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_32\" AS \"SPEQLITE_TEMP_TABLE_32\" LIMIT 21",
                "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd  b6_lp   b6_cnt  b6_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  35.79  1524743    14853  41.84  2256685    18566*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021011,
                    "execution_time": 0.007901,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.005918
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05684,
                    "execution_time": 0.007513,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.041892
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_31\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_31\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_31\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_31\" AS \"SPEQLITE_TEMP_TABLE_31\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_32\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_32\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_32\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_32\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_32\" AS \"SPEQLITE_TEMP_TABLE_32\""
            }
        ],
        "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd  b6_lp   b6_cnt  b6_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  35.79  1524743    14853  41.84  2256685    18566*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 10 and 10+10\n          or ss_coupon_amt between 2500 and 2500+1000\n          or ss_wholesale_cost between 10 and 10+20)) B6\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3500 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2500 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 20 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 10 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_33\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3500 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2500 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 20 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 10 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.139316,
                    "execution_time": 0.078815,
                    "compile_time": 0.000443,
                    "planning_time": 0.028666,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.204238,
                    "execution_time": 0.078208,
                    "compile_time": 0.000401,
                    "planning_time": 0.092234,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_34\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_33\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_33\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_33\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_33\" AS \"SPEQLITE_TEMP_TABLE_33\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.118434,
                    "execution_time": 0.075271,
                    "compile_time": 0.000506,
                    "planning_time": 0.011821,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.180431,
                    "execution_time": 0.07849,
                    "compile_time": 0.000475,
                    "planning_time": 0.070832,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_34\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_34\" AS \"SPEQLITE_TEMP_TABLE_34\" LIMIT 21",
                "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd  b6_lp   b6_cnt  b6_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  35.79  1524743    14853  28.14  1865741     9651*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021017,
                    "execution_time": 0.007962,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.005864
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05793,
                    "execution_time": 0.007468,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.042689
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_33\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_33\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_33\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_33\" AS \"SPEQLITE_TEMP_TABLE_33\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_34\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_34\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_34\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_34\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_34\" AS \"SPEQLITE_TEMP_TABLE_34\""
            }
        ],
        "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd  b6_lp   b6_cnt  b6_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  35.79  1524743    14853  28.14  1865741     9651*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n/*CURSOR_IDENTIFIER*/\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 200 and 200+10\n          or ss_coupon_amt between 1500 and 1500+1000\n          or ss_wholesale_cost between 10 and 10+20)) B6",
        "optimize": [
            "SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2500 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1500 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 210 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 200 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"B6_LP\" AS \"B6_LP\" , \"B6_CNT\" AS \"B6_CNT\" , \"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_29\" LIMIT 21",
                "preview": "\n/*   b6_lp   b6_cnt  b6_cntd\n0  32.31  1644187    16516*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017197,
                    "execution_time": 0.007698,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.003396
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054473,
                    "execution_time": 0.007657,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.038701
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"B6_LP\", COUNT(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"B6_CNT\", COUNT(DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\") AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE (\"STORE_SALES\".\"SS_COUPON_AMT\" <= 2500 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1500 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 210 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 200 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26",
                "rewrite": "SELECT \"B6_LP\" AS \"B6_LP\", \"B6_CNT\" AS \"B6_CNT\", \"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_29\""
            }
        ],
        "preview": "\n/*   b6_lp   b6_cnt  b6_cntd\n0  32.31  1644187    16516*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n/*CURSOR_IDENTIFIER*/\n      ) B6",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_35\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.112273,
                    "execution_time": 0.05559,
                    "compile_time": 0.000391,
                    "planning_time": 0.026403,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.174862,
                    "execution_time": 0.054472,
                    "compile_time": 0.000399,
                    "planning_time": 0.090189,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_36\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_35\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_35\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_35\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_35\" AS \"SPEQLITE_TEMP_TABLE_35\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.118529,
                    "execution_time": 0.075965,
                    "compile_time": 0.000465,
                    "planning_time": 0.011826,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.177096,
                    "execution_time": 0.075225,
                    "compile_time": 0.000474,
                    "planning_time": 0.070145,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_36\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_36\" AS \"SPEQLITE_TEMP_TABLE_36\" LIMIT 21",
                "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd  b6_lp   b6_cnt  b6_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  35.79  1524743    14853  75.75  1342273    19698*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020381,
                    "execution_time": 0.007245,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.005948
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057537,
                    "execution_time": 0.007967,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.042243
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_35\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_35\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_35\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_35\" AS \"SPEQLITE_TEMP_TABLE_35\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_36\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_36\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_36\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_36\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_36\" AS \"SPEQLITE_TEMP_TABLE_36\""
            }
        ],
        "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd  b6_lp   b6_cnt  b6_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  35.79  1524743    14853  75.75  1342273    19698*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 64 and 64+10\n          or ss_coupon_amt between 5000 and 5000+1000\n          or ss_wholesale_cost between 25 and 25+20)\n/*CURSOR_IDENTIFIER*/\n      ) B6",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 74 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 64 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 45 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 25 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_37\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6000 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5000 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 74 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 64 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 45 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 25 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.138684,
                    "execution_time": 0.076728,
                    "compile_time": 0.000442,
                    "planning_time": 0.030165,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.204235,
                    "execution_time": 0.076056,
                    "compile_time": 0.000444,
                    "planning_time": 0.092759,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_38\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_37\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_37\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_37\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_37\" AS \"SPEQLITE_TEMP_TABLE_37\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.119102,
                    "execution_time": 0.075396,
                    "compile_time": 0.000481,
                    "planning_time": 0.012063,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.181419,
                    "execution_time": 0.076663,
                    "compile_time": 0.000508,
                    "planning_time": 0.072153,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_38\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_38\" AS \"SPEQLITE_TEMP_TABLE_38\" LIMIT 21",
                "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd  b6_lp   b6_cnt  b6_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  35.79  1524743    14853  55.53  1957483     6493*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020519,
                    "execution_time": 0.007389,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.005894
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058769,
                    "execution_time": 0.007736,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.042656
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_37\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_37\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_37\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_37\" AS \"SPEQLITE_TEMP_TABLE_37\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_38\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_38\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_38\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_38\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_38\" AS \"SPEQLITE_TEMP_TABLE_38\""
            }
        ],
        "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd  b6_lp   b6_cnt  b6_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  35.79  1524743    14853  55.53  1957483     6493*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n           ,count(ss_list_price) B1_CNT\n           ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n           ,count(ss_list_price) B2_CNT\n           ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n           ,count(ss_list_price) B3_CNT\n           ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n           ,count(ss_list_price) B4_CNT\n           ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n           ,count(ss_list_price) B5_CNT\n           ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n           ,count(ss_list_price) B6_CNT\n           ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 64 and 64+10\n          or ss_coupon_amt between 2991 and 2991+1000\n          or ss_wholesale_cost between 10 and 10+20)) B6 /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3991 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2991 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 74 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 64 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_39\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3991 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2991 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 74 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 64 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 30 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 10 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.138663,
                    "execution_time": 0.078266,
                    "compile_time": 0.000394,
                    "planning_time": 0.029161,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.206823,
                    "execution_time": 0.07973,
                    "compile_time": 0.000425,
                    "planning_time": 0.092511,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_40\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_39\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_39\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_39\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_39\" AS \"SPEQLITE_TEMP_TABLE_39\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.118875,
                    "execution_time": 0.075704,
                    "compile_time": 0.000511,
                    "planning_time": 0.011763,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.177752,
                    "execution_time": 0.0755,
                    "compile_time": 0.000477,
                    "planning_time": 0.070686,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_40\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_40\" AS \"SPEQLITE_TEMP_TABLE_40\" LIMIT 21",
                "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd  b6_lp   b6_cnt  b6_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  35.79  1524743    14853  40.32  2175312     8168*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020856,
                    "execution_time": 0.007185,
                    "compile_time": 6.2e-05,
                    "planning_time": 0.006202
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05692,
                    "execution_time": 0.007477,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.042145
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_39\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_39\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_39\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_39\" AS \"SPEQLITE_TEMP_TABLE_39\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_40\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_40\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_40\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_40\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_40\" AS \"SPEQLITE_TEMP_TABLE_40\""
            }
        ],
        "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd  b6_lp   b6_cnt  b6_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  35.79  1524743    14853  40.32  2175312     8168*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 64 and 64+10\n          or ss_coupon_amt between 2991 and 2991+1000\n          or ss_wholesale_cost between 7 and 7+20)) B6\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3991 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2991 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 74 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 64 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 27 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 7 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_41\" AS SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3991 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2991 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 74 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 64 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 27 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 7 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.135561,
                    "execution_time": 0.077593,
                    "compile_time": 0.000388,
                    "planning_time": 0.028054,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.22403,
                    "execution_time": 0.078153,
                    "compile_time": 0.00039,
                    "planning_time": 0.112134,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_42\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_41\" AS \"SPEQLITE_TEMP_TABLE_41\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.11893,
                    "execution_time": 0.076365,
                    "compile_time": 0.000453,
                    "planning_time": 0.012007,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.178521,
                    "execution_time": 0.076112,
                    "compile_time": 0.000484,
                    "planning_time": 0.069943,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_42\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_42\" AS \"SPEQLITE_TEMP_TABLE_42\" LIMIT 21",
                "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd  b6_lp   b6_cnt  b6_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  35.79  1524743    14853  36.99  2176090     7933*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020541,
                    "execution_time": 0.007701,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.005871
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057357,
                    "execution_time": 0.007776,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.042298
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_41\" AS \"SPEQLITE_TEMP_TABLE_41\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_42\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_42\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_42\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_42\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_42\" AS \"SPEQLITE_TEMP_TABLE_42\""
            }
        ],
        "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd  b6_lp   b6_cnt  b6_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  35.79  1524743    14853  36.99  2176090     7933*/"
    },
    {
        "input": "-- start template query28.tpl query 36 in stream 0\nselect /* TPC-DS query28.tpl 0.36 */  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 85 and 85+10 \n             or ss_coupon_amt between 725 and 725+1000\n             or ss_wholesale_cost between 18 and 18+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 6 and 6+10\n          or ss_coupon_amt between 11704 and 11704+1000\n          or ss_wholesale_cost between 15 and 15+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 72 and 72+10\n          or ss_coupon_amt between 5172 and 5172+1000\n          or ss_wholesale_cost between 27 and 27+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 104 and 104+10\n          or ss_coupon_amt between 2440 and 2440+1000\n          or ss_wholesale_cost between 65 and 65+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 153 and 153+10\n          or ss_coupon_amt between 1350 and 1350+1000\n          or ss_wholesale_cost between 3 and 3+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 64 and 64+10\n          or ss_coupon_amt between 2991 and 2991+1000\n          or ss_wholesale_cost between 7 and 7+20)) B6\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"B1\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B1_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 1725 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 725 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 95 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 85 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 38 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 18 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 5 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 0 ) , \"B2\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B2_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 12704 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 11704 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 16 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 6 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 35 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 15 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 10 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 6 ) , \"B3\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B3_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 6172 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 5172 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 82 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 72 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 47 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 27 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 15 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 11 ) , \"B4\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B4_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3440 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2440 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 114 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 104 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 85 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 65 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 20 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 16 ) , \"B5\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B5_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 2350 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 1350 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 163 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 153 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 23 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 3 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 25 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 21 ) , \"B6\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_LP\" , COUNT ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNT\" , COUNT ( DISTINCT \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"B6_CNTD\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE ( \"STORE_SALES\".\"SS_COUPON_AMT\" <= 3991 AND \"STORE_SALES\".\"SS_COUPON_AMT\" >= 2991 OR \"STORE_SALES\".\"SS_LIST_PRICE\" <= 74 AND \"STORE_SALES\".\"SS_LIST_PRICE\" >= 64 OR \"STORE_SALES\".\"SS_WHOLESALE_COST\" <= 27 AND \"STORE_SALES\".\"SS_WHOLESALE_COST\" >= 7 ) AND \"STORE_SALES\".\"SS_QUANTITY\" <= 30 AND \"STORE_SALES\".\"SS_QUANTITY\" >= 26 ) SELECT \"B1\".\"B1_LP\" AS \"B1_LP\" , \"B1\".\"B1_CNT\" AS \"B1_CNT\" , \"B1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"B2\".\"B2_LP\" AS \"B2_LP\" , \"B2\".\"B2_CNT\" AS \"B2_CNT\" , \"B2\".\"B2_CNTD\" AS \"B2_CNTD\" , \"B3\".\"B3_LP\" AS \"B3_LP\" , \"B3\".\"B3_CNT\" AS \"B3_CNT\" , \"B3\".\"B3_CNTD\" AS \"B3_CNTD\" , \"B4\".\"B4_LP\" AS \"B4_LP\" , \"B4\".\"B4_CNT\" AS \"B4_CNT\" , \"B4\".\"B4_CNTD\" AS \"B4_CNTD\" , \"B5\".\"B5_LP\" AS \"B5_LP\" , \"B5\".\"B5_CNT\" AS \"B5_CNT\" , \"B5\".\"B5_CNTD\" AS \"B5_CNTD\" , \"B6\".\"B6_LP\" AS \"B6_LP\" , \"B6\".\"B6_CNT\" AS \"B6_CNT\" , \"B6\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"B1\" AS \"B1\" CROSS JOIN \"B2\" AS \"B2\" CROSS JOIN \"B3\" AS \"B3\" CROSS JOIN \"B4\" AS \"B4\" CROSS JOIN \"B5\" AS \"B5\" CROSS JOIN \"B6\" AS \"B6\" LIMIT 100"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_43\" AS SELECT \"SPEQLITE_TEMP_TABLE_41\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_41\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_41\" AS \"SPEQLITE_TEMP_TABLE_41\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.062341,
                    "execution_time": 0.035701,
                    "compile_time": 0.000226,
                    "planning_time": 0.003119,
                    "create_size": 6
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.119917,
                    "execution_time": 0.035467,
                    "compile_time": 0.000232,
                    "planning_time": 0.060462,
                    "create_size": 6
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_44\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_43\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_43\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_43\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_43\" AS \"SPEQLITE_TEMP_TABLE_43\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.135043,
                    "execution_time": 0.080023,
                    "compile_time": 0.000483,
                    "planning_time": 0.011918,
                    "create_size": 21
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.177903,
                    "execution_time": 0.076576,
                    "compile_time": 0.000463,
                    "planning_time": 0.070351,
                    "create_size": 21
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_44\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_44\" AS \"SPEQLITE_TEMP_TABLE_44\" LIMIT 21",
                "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd  b6_lp   b6_cnt  b6_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  35.79  1524743    14853  36.99  2176090     7933*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020178,
                    "execution_time": 0.007229,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.005835
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058398,
                    "execution_time": 0.007519,
                    "compile_time": 6.3e-05,
                    "planning_time": 0.042641
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_1\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_8\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_28\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_43\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_43\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_43\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_43\" AS \"SPEQLITE_TEMP_TABLE_43\" LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_44\".\"B1_LP\" AS \"B1_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B1_CNT\" AS \"B1_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B1_CNTD\" AS \"B1_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B2_LP\" AS \"B2_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B2_CNT\" AS \"B2_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B2_CNTD\" AS \"B2_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B3_LP\" AS \"B3_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B3_CNT\" AS \"B3_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B3_CNTD\" AS \"B3_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B4_LP\" AS \"B4_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B4_CNT\" AS \"B4_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B4_CNTD\" AS \"B4_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B5_LP\" AS \"B5_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B5_CNT\" AS \"B5_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B5_CNTD\" AS \"B5_CNTD\" , \"SPEQLITE_TEMP_TABLE_44\".\"B6_LP\" AS \"B6_LP\" , \"SPEQLITE_TEMP_TABLE_44\".\"B6_CNT\" AS \"B6_CNT\" , \"SPEQLITE_TEMP_TABLE_44\".\"B6_CNTD\" AS \"B6_CNTD\" FROM \"SPEQLITE_TEMP_TABLE_44\" AS \"SPEQLITE_TEMP_TABLE_44\" LIMIT 100"
            }
        ],
        "preview": "\n/*   b1_lp  b1_cnt  b1_cntd  b2_lp  b2_cnt  b2_cntd  b3_lp   b3_cnt  b3_cntd   b4_lp   b4_cnt  b4_cntd  b5_lp   b5_cnt  b5_cntd  b6_lp   b6_cnt  b6_cntd\n0  54.49  361700     6748  30.61  722791     6378  59.86  1004134     6677  111.95  1256465    10700  35.79  1524743    14853  36.99  2176090     7933*/"
    }
]