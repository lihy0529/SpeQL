[
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nWITH /* TPC-DS query59.tpl 0.30 */ wss AS \n (SELECT d_week_seq,\n        ss_store_sk,\n        SUM(CASE WHEN (d_day_name='Sunday') THEN ss_sales_price ELSE NULL END) sun_sales,\n        SUM(CASE WHEN (d_day_name='Monday') THEN ss_sales_price ELSE NULL END) mon_sales,\n        SUM(CASE WHEN (d_day_name='Tuesday') THEN ss_sales_price ELSE NULL END) tue_sales,\n        SUM(CASE WHEN (d_day_name='Wednesday') THEN ss_sales_price ELSE NULL END) wed_sales,\n        SUM(CASE WHEN (d_day_name='Thursday') THEN ss_sales_price ELSE NULL END) thu_sales,\n        SUM(CASE WHEN (d_day_name='Friday') THEN ss_sales_price ELSE NULL END) fri_sales,\n        SUM(CASE WHEN (d_day_name='Saturday') THEN ss_sales_price ELSE NULL END) sat_sales\n FROM store_sales, date_dim\n WHERE d_date_sk = ss_sold_date_sk\n GROUP BY d_week_seq, ss_store_sk\n ),\n store_info AS (\n  SELECT s_store_name,\n         s_store_id,\n         wss.d_week_seq,\n         sun_sales,\n         mon_sales,\n         tue_sales,\n         wed_sales,\n         thu_sales,\n         fri_sales,\n         sat_sales\n  FROM wss\n  JOIN store ON store.s_store_sk = wss.ss_store_sk\n )\n SELECT s_store_name1, s_store_id1, d_week_seq1,\n        sun_sales1/sun_sales2 AS sun_sales_ratio,\n        mon_sales1/mon_sales2 AS mon_sales_ratio,\n        tue_sales1/tue_sales2 AS tue_sales_ratio,\n        wed_sales1/wed_sales2 AS wed_sales_ratio,\n        thu_sales1/thu_sales2 AS thu_sales_ratio,\n        fri_sales1/fri_sales2 AS fri_sales_ratio,\n        sat_sales1/sat_sales2 AS sat_sales_ratio\n FROM\n (SELECT s_store_name AS s_store_name1,\n         d_week_seq AS d_week_seq1,\n         s_store_id AS s_store_id1,\n         sun_sales AS sun_sales1,\n         mon_sales AS mon_sales1,\n         tue_sales AS tue_sales1,\n         wed_sales AS wed_sales1,\n         thu_sales AS thu_sales1,\n         fri_sales AS fri_sales1,\n         sat_sales AS sat_sales1\n  FROM store_info\n  WHERE s_store_name = 'Store A') AS t1\n JOIN\n (SELECT s_store_name AS s_store_name2,\n         d_week_seq AS d_week_seq2,\n         s_store_id AS s_store_id2,\n         sun_sales AS sun_sales2,\n         mon_sales AS mon_sales2,\n         tue_sales AS tue_sales2,\n         wed_sales AS wed_sales2,\n         thu_sales AS thu_sales2,\n         fri_sales AS fri_sales2,\n         sat_sales AS sat_sales2\n  FROM store_info\n  WHERE s_store_name = 'Store B') AS t2\n ON t1.d_week_seq1 = t2.d_week_seq2;\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"STORE_INFO\" AS ( SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES\" FROM \"WSS\" AS \"WSS\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE_INFO\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE_INFO\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"STORE_INFO\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"STORE_INFO\".\"SUN_SALES\" / \"STORE_INFO_2\".\"SUN_SALES\" AS \"SUN_SALES_RATIO\" , \"STORE_INFO\".\"MON_SALES\" / \"STORE_INFO_2\".\"MON_SALES\" AS \"MON_SALES_RATIO\" , \"STORE_INFO\".\"TUE_SALES\" / \"STORE_INFO_2\".\"TUE_SALES\" AS \"TUE_SALES_RATIO\" , \"STORE_INFO\".\"WED_SALES\" / \"STORE_INFO_2\".\"WED_SALES\" AS \"WED_SALES_RATIO\" , \"STORE_INFO\".\"THU_SALES\" / \"STORE_INFO_2\".\"THU_SALES\" AS \"THU_SALES_RATIO\" , \"STORE_INFO\".\"FRI_SALES\" / \"STORE_INFO_2\".\"FRI_SALES\" AS \"FRI_SALES_RATIO\" , \"STORE_INFO\".\"SAT_SALES\" / \"STORE_INFO_2\".\"SAT_SALES\" AS \"SAT_SALES_RATIO\" FROM \"STORE_INFO\" AS \"STORE_INFO\" JOIN \"STORE_INFO\" AS \"STORE_INFO_2\" ON \"STORE_INFO\".\"D_WEEK_SEQ\" = \"STORE_INFO_2\".\"D_WEEK_SEQ\" AND \"STORE_INFO_2\".\"S_STORE_NAME\" = 'Store B' WHERE \"STORE_INFO\".\"S_STORE_NAME\" = 'Store A'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.334012,
                    "execution_time": 0.211079,
                    "compile_time": 0.000363,
                    "planning_time": 0.038416,
                    "create_size": 288
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.411309,
                    "execution_time": 0.210079,
                    "compile_time": 0.001486,
                    "planning_time": 0.112306,
                    "create_size": 288
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" AS \"SUN_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" AS \"MON_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" AS \"TUE_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" AS \"WED_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" AS \"THU_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" AS \"FRI_SALES\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" AS \"SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.161741,
                    "execution_time": 0.04868,
                    "compile_time": 0.000307,
                    "planning_time": 0.029187,
                    "create_size": 260
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.236459,
                    "execution_time": 0.050049,
                    "compile_time": 0.000301,
                    "planning_time": 0.096668,
                    "create_size": 247
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUN_SALES\" / \"STORE_INFO_2\".\"SUN_SALES\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"MON_SALES\" / \"STORE_INFO_2\".\"MON_SALES\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"TUE_SALES\" / \"STORE_INFO_2\".\"TUE_SALES\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"WED_SALES\" / \"STORE_INFO_2\".\"WED_SALES\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"THU_SALES\" / \"STORE_INFO_2\".\"THU_SALES\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"FRI_SALES\" / \"STORE_INFO_2\".\"FRI_SALES\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"SAT_SALES\" / \"STORE_INFO_2\".\"SAT_SALES\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"STORE_INFO_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" = \"STORE_INFO_2\".\"D_WEEK_SEQ\" AND \"STORE_INFO_2\".\"S_STORE_NAME\" = 'Store B' WHERE \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" = 'Store A'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.078393,
                    "execution_time": 0.038779,
                    "compile_time": 0.000311,
                    "planning_time": 0.010168,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.140099,
                    "execution_time": 0.039912,
                    "compile_time": 0.000294,
                    "planning_time": 0.068448,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUN_SALES_RATIO\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"MON_SALES_RATIO\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"TUE_SALES_RATIO\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"WED_SALES_RATIO\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"THU_SALES_RATIO\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"FRI_SALES_RATIO\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"SAT_SALES_RATIO\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [s_store_name1, s_store_id1, d_week_seq1, sun_sales_ratio, mon_sales_ratio, tue_sales_ratio, wed_sales_ratio, thu_sales_ratio, fri_sales_ratio, sat_sales_ratio]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020349,
                    "execution_time": 0.007808,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.005784
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057781,
                    "execution_time": 0.007869,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.041565
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUN_SALES\" / \"STORE_INFO_2\".\"SUN_SALES\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"MON_SALES\" / \"STORE_INFO_2\".\"MON_SALES\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"TUE_SALES\" / \"STORE_INFO_2\".\"TUE_SALES\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"WED_SALES\" / \"STORE_INFO_2\".\"WED_SALES\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"THU_SALES\" / \"STORE_INFO_2\".\"THU_SALES\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"FRI_SALES\" / \"STORE_INFO_2\".\"FRI_SALES\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_2\".\"SAT_SALES\" / \"STORE_INFO_2\".\"SAT_SALES\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"STORE_INFO_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" = \"STORE_INFO_2\".\"D_WEEK_SEQ\" AND \"STORE_INFO_2\".\"S_STORE_NAME\" = 'Store B' WHERE \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_NAME\" = 'Store A'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUN_SALES_RATIO\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"MON_SALES_RATIO\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"TUE_SALES_RATIO\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"WED_SALES_RATIO\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"THU_SALES_RATIO\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"FRI_SALES_RATIO\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_3\".\"SAT_SALES_RATIO\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [s_store_name1, s_store_id1, d_week_seq1, sun_sales_ratio, mon_sales_ratio, tue_sales_ratio, wed_sales_ratio, thu_sales_ratio, fri_sales_ratio, sat_sales_ratio]\nIndex: []*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name as s_store_name1, wss.d_week_seq as d_week_seq1\n        ,s_store_id as s_store_id1, sun_sales as sun_sales1\n        ,mon_sales as mon_sales1, tue_sales as tue_sales1\n        ,wed_sales as wed_sales1, thu_sales as thu_sales1\n        ,fri_sales as fri_sales1, sat_sales as sat_sales1\n from wss\n join store on wss.ss_store_sk = store.s_store_sk) as wss_data /*CURSOR_IDENTIFIER*/ \n join\n (\n select s_store_name as s_store_name2, wss.d_week_seq as d_week_seq2\n       ,s_store_id as s_store_id2, sun_sales as sun_sales2\n       ,mon_sales as mon_sales2, tue_sales as tue_sales2\n       ,wed_sales as wed_sales2, thu_sales as thu_sales2\n       ,fri_sales as fri_sales2, sat_sales as sat_sales2\n from wss\n join store on wss.ss_store_sk = store.s_store_sk) as wss_data2\n on wss_data.s_store_id1 = wss_data2.s_store_id2\n and wss_data.d_week_seq1 = wss_data2.d_week_seq2 - 1",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"WSS_DATA2\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_DATA2\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_DATA2\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_DATA2\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_DATA2\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_DATA2\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_DATA2\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_DATA2\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS_DATA2\" AS \"WSS_DATA2\" ON \"STORE\".\"S_STORE_ID\" = \"WSS_DATA2\".\"S_STORE_ID2\" AND \"WSS\".\"D_WEEK_SEQ\" = \"WSS_DATA2\".\"D_WEEK_SEQ2\" - 1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" AS \"MON_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" AS \"WED_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" AS \"THU_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.159116,
                    "execution_time": 0.0481,
                    "compile_time": 0.000306,
                    "planning_time": 0.030366,
                    "create_size": 228
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.239146,
                    "execution_time": 0.049666,
                    "compile_time": 0.001464,
                    "planning_time": 0.100176,
                    "create_size": 228
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_4\".\"D_WEEK_SEQ2\" - 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.251339,
                    "execution_time": 0.062256,
                    "compile_time": 0.069602,
                    "planning_time": 0.034096,
                    "create_size": 260
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.892265,
                    "execution_time": 0.063395,
                    "compile_time": 6.630332,
                    "planning_time": 0.100052,
                    "create_size": 260
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0            ese  AAAAAAAAOAAAAAAA         5188  1.1445  0.6475  0.6572  0.8348  1.0098  1.5939  0.9969\n1           eing  AAAAAAAAGCAAAAAA         5188  0.9708  1.0943  1.0413  0.4981  1.8748  1.0283  1.7207\n2          cally  AAAAAAAAMEAAAAAA         5188  1.6671  0.9861  0.7046  0.9598  1.7488  1.1869  1.0146\n3           n st  AAAAAAAADBAAAAAA         5189  1.9939  1.4828  1.8965  1.3354  1.4276  2.1206  1.3869\n4           able  AAAAAAAAEDAAAAAA         5189  1.0708  1.1042  0.5962  0.6020  1.0750  2.1536  1.3508\n5           anti  AAAAAAAAJBAAAAAA         5189  0.5329  1.1758  0.8102  0.7839  0.8820  0.9212  1.0899\n6           anti  AAAAAAAAHDAAAAAA         5189  1.1195  1.1723  0.9107  1.3231  0.7069  0.6173  1.1753\n7            ese  AAAAAAAAEAAAAAAA         5189  0.9793  2.5604  2.6194  0.6917  0.9576  1.2477  1.0233\n8           eing  AAAAAAAACGAAAAAA         5189  1.4035  0.9311  1.5110  1.3469  1.0356  1.3026  1.6654\n9            pri  AAAAAAAALCAAAAAA         5189  0.4431  0.5625  0.5808  2.1483  1.6705  0.6331  2.0035\n10         ought  AAAAAAAAPBAAAAAA         5189  0.8025  1.5366  0.7666  0.7474  0.7153  1.2552  0.9231\n11           ese  AAAAAAAAAEAAAAAA         5190  1.9723  1.0449  1.0391  0.7932  0.7877  0.8997  1.4780\n12          anti  AAAAAAAAFFAAAAAA         5190  1.0975  1.5371  0.7029  1.1157  1.1548  0.5472  1.2251\n13          eing  AAAAAAAAIFAAAAAA         5190  0.9579  0.6191  0.5107  1.2734  1.6879  0.7158  1.0774\n14         cally  AAAAAAAAABAAAAAA         5190  0.7824  0.8733  0.9479  1.2945  0.6973  1.1887  0.4602\n15           bar  AAAAAAAACDAAAAAA         5191  0.6380  1.8008  1.6717  0.9258  0.3336  1.0187  1.4083\n16          n st  AAAAAAAAPEAAAAAA         5191  1.0103  0.7301  0.4561  0.4337  0.4249  1.1172  1.3301\n17           pri  AAAAAAAANAAAAAAA         5191  1.7627  0.7592  1.6609  0.7031  0.8712  0.7978  1.7880\n18           bar  AAAAAAAAICAAAAAA         5191  0.8262  0.7137  0.9686  1.0643  1.1874  1.2813  1.4048\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01862,
                    "execution_time": 0.007288,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.00443
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058138,
                    "execution_time": 0.007569,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.040327
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_4\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_4\".\"D_WEEK_SEQ2\" - 1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0            ese  AAAAAAAAOAAAAAAA         5188  1.1445  0.6475  0.6572  0.8348  1.0098  1.5939  0.9969\n1           eing  AAAAAAAAGCAAAAAA         5188  0.9708  1.0943  1.0413  0.4981  1.8748  1.0283  1.7207\n2          cally  AAAAAAAAMEAAAAAA         5188  1.6671  0.9861  0.7046  0.9598  1.7488  1.1869  1.0146\n3           n st  AAAAAAAADBAAAAAA         5189  1.9939  1.4828  1.8965  1.3354  1.4276  2.1206  1.3869\n4           able  AAAAAAAAEDAAAAAA         5189  1.0708  1.1042  0.5962  0.6020  1.0750  2.1536  1.3508\n5           anti  AAAAAAAAJBAAAAAA         5189  0.5329  1.1758  0.8102  0.7839  0.8820  0.9212  1.0899\n6           anti  AAAAAAAAHDAAAAAA         5189  1.1195  1.1723  0.9107  1.3231  0.7069  0.6173  1.1753\n7            ese  AAAAAAAAEAAAAAAA         5189  0.9793  2.5604  2.6194  0.6917  0.9576  1.2477  1.0233\n8           eing  AAAAAAAACGAAAAAA         5189  1.4035  0.9311  1.5110  1.3469  1.0356  1.3026  1.6654\n9            pri  AAAAAAAALCAAAAAA         5189  0.4431  0.5625  0.5808  2.1483  1.6705  0.6331  2.0035\n10         ought  AAAAAAAAPBAAAAAA         5189  0.8025  1.5366  0.7666  0.7474  0.7153  1.2552  0.9231\n11           ese  AAAAAAAAAEAAAAAA         5190  1.9723  1.0449  1.0391  0.7932  0.7877  0.8997  1.4780\n12          anti  AAAAAAAAFFAAAAAA         5190  1.0975  1.5371  0.7029  1.1157  1.1548  0.5472  1.2251\n13          eing  AAAAAAAAIFAAAAAA         5190  0.9579  0.6191  0.5107  1.2734  1.6879  0.7158  1.0774\n14         cally  AAAAAAAAABAAAAAA         5190  0.7824  0.8733  0.9479  1.2945  0.6973  1.1887  0.4602\n15           bar  AAAAAAAACDAAAAAA         5191  0.6380  1.8008  1.6717  0.9258  0.3336  1.0187  1.4083\n16          n st  AAAAAAAAPEAAAAAA         5191  1.0103  0.7301  0.4561  0.4337  0.4249  1.1172  1.3301\n17           pri  AAAAAAAANAAAAAAA         5191  1.7627  0.7592  1.6609  0.7031  0.8712  0.7978  1.7880\n18           bar  AAAAAAAAICAAAAAA         5191  0.8262  0.7137  0.9686  1.0643  1.1874  1.2813  1.4048\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales, date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq, ss_store_sk\n )\n  select  s_store_name, s_store_id, wss1.d_week_seq\n       , wss1.sun_sales / wss2.sun_sales sun_sales_ratio\n       , wss1.mon_sales / wss2.mon_sales mon_sales_ratio\n       , wss1.tue_sales / wss2.tue_sales tue_sales_ratio\n       , wss1.wed_sales / wss2.wed_sales wed_sales_ratio\n       , wss1.thu_sales / wss2.thu_sales thu_sales_ratio\n       , wss1.fri_sales / wss2.fri_sales fri_sales_ratio\n       , wss1.sat_sales / wss2.sat_sales sat_sales_ratio\n from\n (select s_store_name, s_store_id, wss.d_week_seq, sun_sales, mon_sales, tue_sales, wed_sales, thu_sales, fri_sales, sat_sales\n  from wss, store\n  where store.s_store_sk = wss.ss_store_sk) wss1\n join \n (select d_week_seq, sum(sun_sales) as sun_sales, sum(mon_sales) as mon_sales, sum(tue_sales) as tue_sales, \n          sum(wed_sales) as wed_sales, sum(thu_sales) as thu_sales, sum(fri_sales) as fri_sales, sum(sat_sales) as sat_sales\n  from wss\n  group by d_week_seq) wss2\n on wss1.d_week_seq = wss2.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"WSS2\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( \"WSS\".\"SUN_SALES\" ) AS \"SUN_SALES\" , SUM ( \"WSS\".\"MON_SALES\" ) AS \"MON_SALES\" , SUM ( \"WSS\".\"TUE_SALES\" ) AS \"TUE_SALES\" , SUM ( \"WSS\".\"WED_SALES\" ) AS \"WED_SALES\" , SUM ( \"WSS\".\"THU_SALES\" ) AS \"THU_SALES\" , SUM ( \"WSS\".\"FRI_SALES\" ) AS \"FRI_SALES\" , SUM ( \"WSS\".\"SAT_SALES\" ) AS \"SAT_SALES\" FROM \"WSS\" AS \"WSS\" GROUP BY \"WSS\".\"D_WEEK_SEQ\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WSS\".\"SUN_SALES\" / \"WSS2\".\"SUN_SALES\" AS \"SUN_SALES_RATIO\" , \"WSS\".\"MON_SALES\" / \"WSS2\".\"MON_SALES\" AS \"MON_SALES_RATIO\" , \"WSS\".\"TUE_SALES\" / \"WSS2\".\"TUE_SALES\" AS \"TUE_SALES_RATIO\" , \"WSS\".\"WED_SALES\" / \"WSS2\".\"WED_SALES\" AS \"WED_SALES_RATIO\" , \"WSS\".\"THU_SALES\" / \"WSS2\".\"THU_SALES\" AS \"THU_SALES_RATIO\" , \"WSS\".\"FRI_SALES\" / \"WSS2\".\"FRI_SALES\" AS \"FRI_SALES_RATIO\" , \"WSS\".\"SAT_SALES\" / \"WSS2\".\"SAT_SALES\" AS \"SAT_SALES_RATIO\" FROM \"WSS\" AS \"WSS\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS2\" AS \"WSS2\" ON \"WSS\".\"D_WEEK_SEQ\" = \"WSS2\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" ) AS \"SUN_SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" ) AS \"MON_SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" ) AS \"TUE_SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" ) AS \"WED_SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" ) AS \"THU_SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" ) AS \"FRI_SALES\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" ) AS \"SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.093478,
                    "execution_time": 0.058448,
                    "compile_time": 0.000291,
                    "planning_time": 0.005946,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.154409,
                    "execution_time": 0.059056,
                    "compile_time": 0.000284,
                    "planning_time": 0.063167,
                    "create_size": 1232
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"SUN_SALES\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"MON_SALES\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"TUE_SALES\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"WED_SALES\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"THU_SALES\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"FRI_SALES\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"SAT_SALES\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.170612,
                    "execution_time": 0.057657,
                    "compile_time": 0.000369,
                    "planning_time": 0.032773,
                    "create_size": 286
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.243854,
                    "execution_time": 0.061293,
                    "compile_time": 0.000379,
                    "planning_time": 0.09898,
                    "create_size": 247
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES_RATIO\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES_RATIO\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES_RATIO\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES_RATIO\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES_RATIO\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES_RATIO\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES_RATIO\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*   s_store_name        s_store_id  d_week_seq  sun_sales_ratio  mon_sales_ratio  tue_sales_ratio  wed_sales_ratio  thu_sales_ratio  fri_sales_ratio  sat_sales_ratio\n0          able  AAAAAAAACAAAAAAA        5133           0.0193           0.0255           0.0213           0.0204           0.0186           0.0170           0.0233\n1           ese  AAAAAAAAAEAAAAAA        5133           0.0190           0.0141           0.0203           0.0201           0.0216           0.0096           0.0143\n2         cally  AAAAAAAAABAAAAAA        5133           0.0158           0.0265           0.0218           0.0127           0.0198           0.0114           0.0159\n3          able  AAAAAAAACFAAAAAA        5133           0.0154           0.0285           0.0235           0.0210           0.0191           0.0145           0.0094\n4          anti  AAAAAAAAFFAAAAAA        5134           0.0172           0.0121           0.0169           0.0228           0.0230           0.0203           0.0190\n5           bar  AAAAAAAAKAAAAAAA        5134           0.0249           0.0076           0.0203           0.0137           0.0183           0.0299           0.0265\n6         ought  AAAAAAAANDAAAAAA        5134           0.0212           0.0098           0.0139           0.0361           0.0157           0.0131           0.0175\n7           bar  AAAAAAAAEBAAAAAA        5134           0.0208           0.0217           0.0221           0.0215           0.0268           0.0129           0.0181\n8          able  AAAAAAAACAAAAAAA        5134           0.0303           0.0212           0.0187           0.0202           0.0118           0.0209           0.0271\n9         cally  AAAAAAAAMEAAAAAA        5134           0.0166           0.0217           0.0141           0.0121           0.0119           0.0178           0.0198\n10        cally  AAAAAAAAKBAAAAAA        5134           0.0207           0.0129           0.0214           0.0121           0.0175           0.0231           0.0173\n11         eing  AAAAAAAAGCAAAAAA        5135           0.0186           0.0158           0.0098           0.0178           0.0221           0.0312           0.0156\n12        ought  AAAAAAAALFAAAAAA        5135           0.0145           0.0213           0.0254           0.0292           0.0278           0.0138           0.0197\n13         eing  AAAAAAAAKDAAAAAA        5135           0.0246           0.0216           0.0232           0.0204           0.0194           0.0234           0.0155\n14         n st  AAAAAAAADBAAAAAA        5136           0.0233           0.0117           0.0204           0.0286           0.0161           0.0169           0.0119\n15         able  AAAAAAAAGBAAAAAA        5136           0.0178           0.0192           0.0183           0.0116           0.0252           0.0228           0.0184\n16         eing  AAAAAAAAEEAAAAAA        5136           0.0041           0.0210           0.0273           0.0362           0.0196           0.0254           0.0254\n17         n st  AAAAAAAABDAAAAAA        5136           0.0241           0.0192           0.0152           0.0234           0.0178           0.0239           0.0246\n18          ese  AAAAAAAAEAAAAAAA        5136           0.0148           0.0189           0.0230           0.0145           0.0193           0.0232           0.0221\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018892,
                    "execution_time": 0.007453,
                    "compile_time": 5e-05,
                    "planning_time": 0.004609
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058516,
                    "execution_time": 0.008221,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.04038
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"SUN_SALES\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"MON_SALES\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"TUE_SALES\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"WED_SALES\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"THU_SALES\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"FRI_SALES\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_6\".\"SAT_SALES\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES_RATIO\" AS \"SUN_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES_RATIO\" AS \"MON_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES_RATIO\" AS \"TUE_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES_RATIO\" AS \"WED_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES_RATIO\" AS \"THU_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES_RATIO\" AS \"FRI_SALES_RATIO\" , \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES_RATIO\" AS \"SAT_SALES_RATIO\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*   s_store_name        s_store_id  d_week_seq  sun_sales_ratio  mon_sales_ratio  tue_sales_ratio  wed_sales_ratio  thu_sales_ratio  fri_sales_ratio  sat_sales_ratio\n0          able  AAAAAAAACAAAAAAA        5133           0.0193           0.0255           0.0213           0.0204           0.0186           0.0170           0.0233\n1           ese  AAAAAAAAAEAAAAAA        5133           0.0190           0.0141           0.0203           0.0201           0.0216           0.0096           0.0143\n2         cally  AAAAAAAAABAAAAAA        5133           0.0158           0.0265           0.0218           0.0127           0.0198           0.0114           0.0159\n3          able  AAAAAAAACFAAAAAA        5133           0.0154           0.0285           0.0235           0.0210           0.0191           0.0145           0.0094\n4          anti  AAAAAAAAFFAAAAAA        5134           0.0172           0.0121           0.0169           0.0228           0.0230           0.0203           0.0190\n5           bar  AAAAAAAAKAAAAAAA        5134           0.0249           0.0076           0.0203           0.0137           0.0183           0.0299           0.0265\n6         ought  AAAAAAAANDAAAAAA        5134           0.0212           0.0098           0.0139           0.0361           0.0157           0.0131           0.0175\n7           bar  AAAAAAAAEBAAAAAA        5134           0.0208           0.0217           0.0221           0.0215           0.0268           0.0129           0.0181\n8          able  AAAAAAAACAAAAAAA        5134           0.0303           0.0212           0.0187           0.0202           0.0118           0.0209           0.0271\n9         cally  AAAAAAAAMEAAAAAA        5134           0.0166           0.0217           0.0141           0.0121           0.0119           0.0178           0.0198\n10        cally  AAAAAAAAKBAAAAAA        5134           0.0207           0.0129           0.0214           0.0121           0.0175           0.0231           0.0173\n11         eing  AAAAAAAAGCAAAAAA        5135           0.0186           0.0158           0.0098           0.0178           0.0221           0.0312           0.0156\n12        ought  AAAAAAAALFAAAAAA        5135           0.0145           0.0213           0.0254           0.0292           0.0278           0.0138           0.0197\n13         eing  AAAAAAAAKDAAAAAA        5135           0.0246           0.0216           0.0232           0.0204           0.0194           0.0234           0.0155\n14         n st  AAAAAAAADBAAAAAA        5136           0.0233           0.0117           0.0204           0.0286           0.0161           0.0169           0.0119\n15         able  AAAAAAAAGBAAAAAA        5136           0.0178           0.0192           0.0183           0.0116           0.0252           0.0228           0.0184\n16         eing  AAAAAAAAEEAAAAAA        5136           0.0041           0.0210           0.0273           0.0362           0.0196           0.0254           0.0254\n17         n st  AAAAAAAABDAAAAAA        5136           0.0241           0.0192           0.0152           0.0234           0.0178           0.0239           0.0246\n18          ese  AAAAAAAAEAAAAAAA        5136           0.0148           0.0189           0.0230           0.0145           0.0193           0.0232           0.0221\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales, date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq, ss_store_sk\n ),\n sales_totals as \n (select sum(sun_sales) as sun_sales_total,\n         sum(mon_sales) as mon_sales_total,\n         sum(tue_sales) as tue_sales_total,\n         sum(wed_sales) as wed_sales_total,\n         sum(thu_sales) as thu_sales_total,\n         sum(fri_sales) as fri_sales_total,\n         sum(sat_sales) as sat_sales_total\n  from wss)\n select s_store_name1, s_store_id1, d_week_seq1,\n        sun_sales1/sun_sales_total as sun_sales2,\n        mon_sales1/mon_sales_total as mon_sales2,\n        tue_sales1/tue_sales_total as tue_sales2,\n        wed_sales1/wed_sales_total as wed_sales2,\n        thu_sales1/thu_sales_total as thu_sales2,\n        fri_sales1/fri_sales_total as fri_sales2,\n        sat_sales1/sat_sales_total as sat_sales2\n from\n (select s_store_name s_store_name1, wss.d_week_seq d_week_seq1,\n         s_store_id s_store_id1, sun_sales sun_sales1,\n         mon_sales mon_sales1, tue_sales tue_sales1,\n         wed_sales wed_sales1, thu_sales thu_sales1,\n         fri_sales fri_sales1, sat_sales sat_sales1\n  from wss, store, date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n/*CURSOR_IDENTIFIER*/\n  wss.ss_store_sk = s_store_sk), sales_totals",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES1\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES1\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES1\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES1\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" AS \"MON_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" AS \"WED_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" AS \"THU_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" AS \"SAT_SALES1\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.64577,
                    "execution_time": 0.102436,
                    "compile_time": 0.071754,
                    "planning_time": 0.037353,
                    "create_size": 1560
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.949241,
                    "execution_time": 0.109917,
                    "compile_time": 3.290401,
                    "planning_time": 0.105302,
                    "create_size": 1534
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_8\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUN_SALES1\" AS \"SUN_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"MON_SALES1\" AS \"MON_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"TUE_SALES1\" AS \"TUE_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"WED_SALES1\" AS \"WED_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"THU_SALES1\" AS \"THU_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"FRI_SALES1\" AS \"FRI_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"SAT_SALES1\" AS \"SAT_SALES1\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*   s_store_name1  d_week_seq1       s_store_id1  sun_sales1  mon_sales1  tue_sales1  wed_sales1  thu_sales1  fri_sales1  sat_sales1\n0           eing         5327  AAAAAAAAIFAAAAAA     2762.55     8309.68     6392.91     3279.50     8347.32     8594.31     2952.82\n1           eing         5327  AAAAAAAAIFAAAAAA     2762.55     8309.68     6392.91     3279.50     8347.32     8594.31     2952.82\n2           eing         5327  AAAAAAAAIFAAAAAA     2762.55     8309.68     6392.91     3279.50     8347.32     8594.31     2952.82\n3           eing         5327  AAAAAAAAIFAAAAAA     2762.55     8309.68     6392.91     3279.50     8347.32     8594.31     2952.82\n4           eing         5327  AAAAAAAAIFAAAAAA     2762.55     8309.68     6392.91     3279.50     8347.32     8594.31     2952.82\n5           eing         5327  AAAAAAAAIFAAAAAA     2762.55     8309.68     6392.91     3279.50     8347.32     8594.31     2952.82\n6           eing         5327  AAAAAAAAIFAAAAAA     2762.55     8309.68     6392.91     3279.50     8347.32     8594.31     2952.82\n7          ation         5327  AAAAAAAAHAAAAAAA     6373.32     6871.69     6243.66     9049.87     6183.65     5072.09    10551.75\n8          ation         5327  AAAAAAAAHAAAAAAA     6373.32     6871.69     6243.66     9049.87     6183.65     5072.09    10551.75\n9          ation         5327  AAAAAAAAHAAAAAAA     6373.32     6871.69     6243.66     9049.87     6183.65     5072.09    10551.75\n10         ation         5327  AAAAAAAAHAAAAAAA     6373.32     6871.69     6243.66     9049.87     6183.65     5072.09    10551.75\n11         ation         5327  AAAAAAAAHAAAAAAA     6373.32     6871.69     6243.66     9049.87     6183.65     5072.09    10551.75\n12         ation         5327  AAAAAAAAHAAAAAAA     6373.32     6871.69     6243.66     9049.87     6183.65     5072.09    10551.75\n13         ation         5327  AAAAAAAAHAAAAAAA     6373.32     6871.69     6243.66     9049.87     6183.65     5072.09    10551.75\n14           pri         5327  AAAAAAAANAAAAAAA     5228.17     6048.06     4422.33     6832.65     5425.71     7869.47     6973.02\n15           pri         5327  AAAAAAAANAAAAAAA     5228.17     6048.06     4422.33     6832.65     5425.71     7869.47     6973.02\n16           pri         5327  AAAAAAAANAAAAAAA     5228.17     6048.06     4422.33     6832.65     5425.71     7869.47     6973.02\n17           pri         5327  AAAAAAAANAAAAAAA     5228.17     6048.06     4422.33     6832.65     5425.71     7869.47     6973.02\n18           pri         5327  AAAAAAAANAAAAAAA     5228.17     6048.06     4422.33     6832.65     5425.71     7869.47     6973.02\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.031088,
                    "execution_time": 0.007737,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.005224
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058457,
                    "execution_time": 0.008361,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.040231
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" AS \"MON_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" AS \"WED_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" AS \"THU_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" AS \"SAT_SALES1\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_8\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_8\".\"SUN_SALES1\" AS \"SUN_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"MON_SALES1\" AS \"MON_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"TUE_SALES1\" AS \"TUE_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"WED_SALES1\" AS \"WED_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"THU_SALES1\" AS \"THU_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"FRI_SALES1\" AS \"FRI_SALES1\" , \"SPEQLITE_TEMP_TABLE_8\".\"SAT_SALES1\" AS \"SAT_SALES1\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*   s_store_name1  d_week_seq1       s_store_id1  sun_sales1  mon_sales1  tue_sales1  wed_sales1  thu_sales1  fri_sales1  sat_sales1\n0           eing         5327  AAAAAAAAIFAAAAAA     2762.55     8309.68     6392.91     3279.50     8347.32     8594.31     2952.82\n1           eing         5327  AAAAAAAAIFAAAAAA     2762.55     8309.68     6392.91     3279.50     8347.32     8594.31     2952.82\n2           eing         5327  AAAAAAAAIFAAAAAA     2762.55     8309.68     6392.91     3279.50     8347.32     8594.31     2952.82\n3           eing         5327  AAAAAAAAIFAAAAAA     2762.55     8309.68     6392.91     3279.50     8347.32     8594.31     2952.82\n4           eing         5327  AAAAAAAAIFAAAAAA     2762.55     8309.68     6392.91     3279.50     8347.32     8594.31     2952.82\n5           eing         5327  AAAAAAAAIFAAAAAA     2762.55     8309.68     6392.91     3279.50     8347.32     8594.31     2952.82\n6           eing         5327  AAAAAAAAIFAAAAAA     2762.55     8309.68     6392.91     3279.50     8347.32     8594.31     2952.82\n7          ation         5327  AAAAAAAAHAAAAAAA     6373.32     6871.69     6243.66     9049.87     6183.65     5072.09    10551.75\n8          ation         5327  AAAAAAAAHAAAAAAA     6373.32     6871.69     6243.66     9049.87     6183.65     5072.09    10551.75\n9          ation         5327  AAAAAAAAHAAAAAAA     6373.32     6871.69     6243.66     9049.87     6183.65     5072.09    10551.75\n10         ation         5327  AAAAAAAAHAAAAAAA     6373.32     6871.69     6243.66     9049.87     6183.65     5072.09    10551.75\n11         ation         5327  AAAAAAAAHAAAAAAA     6373.32     6871.69     6243.66     9049.87     6183.65     5072.09    10551.75\n12         ation         5327  AAAAAAAAHAAAAAAA     6373.32     6871.69     6243.66     9049.87     6183.65     5072.09    10551.75\n13         ation         5327  AAAAAAAAHAAAAAAA     6373.32     6871.69     6243.66     9049.87     6183.65     5072.09    10551.75\n14           pri         5327  AAAAAAAANAAAAAAA     5228.17     6048.06     4422.33     6832.65     5425.71     7869.47     6973.02\n15           pri         5327  AAAAAAAANAAAAAAA     5228.17     6048.06     4422.33     6832.65     5425.71     7869.47     6973.02\n16           pri         5327  AAAAAAAANAAAAAAA     5228.17     6048.06     4422.33     6832.65     5425.71     7869.47     6973.02\n17           pri         5327  AAAAAAAANAAAAAAA     5228.17     6048.06     4422.33     6832.65     5425.71     7869.47     6973.02\n18           pri         5327  AAAAAAAANAAAAAAA     5228.17     6048.06     4422.33     6832.65     5425.71     7869.47     6973.02\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales, date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq, ss_store_sk\n )\n  select  s_store_name1, s_store_id1, d_week_seq1\n       , sun_sales1 / sun_sales2, mon_sales1 / mon_sales2\n       , tue_sales1 / tue_sales2, wed_sales1 / wed_sales2, thu_sales1 / thu_sales2\n       , fri_sales1 / fri_sales2, sat_sales1 / sat_sales2\n from\n (select s_store_name as s_store_name1, wss.d_week_seq as d_week_seq1\n        , s_store_id as s_store_id1, sun_sales as sun_sales1\n        , mon_sales as mon_sales1, tue_sales as tue_sales1\n        , wed_sales as wed_sales1, thu_sales as thu_sales1\n        , fri_sales as fri_sales1, sat_sales as sat_sales1\n  from wss, store\n  where ss_store_sk = s_store_sk\n ) s1\n join\n (select d_week_seq, sun_sales as sun_sales2, mon_sales as mon_sales2, tue_sales as tue_sales2,\n        wed_sales as wed_sales2, thu_sales as thu_sales2, fri_sales as fri_sales2, sat_sales as sat_sales2\n  from wss\n ) s2\n on s1.d_week_seq1 = s2.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS\" AS \"WSS_2\" ON \"WSS\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.747101,
                    "execution_time": 0.574173,
                    "compile_time": 0.000649,
                    "planning_time": 0.034126,
                    "create_size": 1664
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.8455,
                    "execution_time": 0.583422,
                    "compile_time": 0.000657,
                    "planning_time": 0.108148,
                    "create_size": 1664
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_9\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0          ought  AAAAAAAANDAAAAAA         5148  1.2683  0.8043  1.2627  1.3841  1.1672  1.0794  1.0446\n1          ought  AAAAAAAANDAAAAAA         5148  1.5044  1.4351  1.0412  0.9540  0.9958  1.2124  1.4510\n2          ought  AAAAAAAANDAAAAAA         5148  0.9857  0.7881  1.6242  0.9382  0.8653  1.5217  2.1167\n3          ought  AAAAAAAANDAAAAAA         5148  1.1514  0.9539  1.1282  0.8933  0.8860  1.1347  1.0911\n4          ought  AAAAAAAANDAAAAAA         5148  1.0676  0.8363  1.1403  1.1962  0.8709  0.9283  1.0905\n5          ought  AAAAAAAANDAAAAAA         5148  1.0629  1.0983  1.1157  0.7552  0.8589  1.0501  1.2154\n6          ought  AAAAAAAANDAAAAAA         5148  1.1211  1.0504  1.1549  1.0046  0.9919  1.0531  1.0313\n7          ought  AAAAAAAANDAAAAAA         5148  1.2003  0.7525  1.2905  1.1813  1.0900  1.0247  0.8905\n8          ought  AAAAAAAANDAAAAAA         5148  1.4305  0.5726  1.8033  1.0181  0.9049  1.0978  0.8612\n9          ought  AAAAAAAANDAAAAAA         5148  1.6287  1.0712  1.1532  1.3979  0.8151  0.8818  0.8546\n10         ought  AAAAAAAANDAAAAAA         5148  1.1680  0.8485  1.6115  0.8899  0.8724  0.9696  1.0560\n11         ought  AAAAAAAANDAAAAAA         5148  0.9803  0.9197  1.3718  0.9047  1.2973  1.1935  1.0522\n12         ought  AAAAAAAANDAAAAAA         5148  1.0515  1.1989  1.0866  1.1575  1.0546  0.8312  0.7267\n13         ought  AAAAAAAANDAAAAAA         5148  1.8280  1.5046  1.8636  1.4816  1.5334  1.7079  1.7002\n14         ought  AAAAAAAANDAAAAAA         5148  1.5583  0.7781  1.1177  1.1638  1.3012  1.5025  1.4427\n15         ought  AAAAAAAANDAAAAAA         5148  1.0848  0.9114  1.4035  1.2140  1.4102  1.0958  1.1489\n16         ought  AAAAAAAANDAAAAAA         5148  1.1509  1.0336  1.5327  1.0641  1.2029  0.9411  1.1153\n17         ought  AAAAAAAANDAAAAAA         5148  1.2858  1.1854  0.9808  1.1974  1.0299  1.4541  1.1768\n18         ought  AAAAAAAANDAAAAAA         5148  1.4355  1.1856  1.3270  0.7936  1.4317  1.0598  1.6198\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019082,
                    "execution_time": 0.007745,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.004486
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.059012,
                    "execution_time": 0.008897,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.040264
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_9\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0          ought  AAAAAAAANDAAAAAA         5148  1.2683  0.8043  1.2627  1.3841  1.1672  1.0794  1.0446\n1          ought  AAAAAAAANDAAAAAA         5148  1.5044  1.4351  1.0412  0.9540  0.9958  1.2124  1.4510\n2          ought  AAAAAAAANDAAAAAA         5148  0.9857  0.7881  1.6242  0.9382  0.8653  1.5217  2.1167\n3          ought  AAAAAAAANDAAAAAA         5148  1.1514  0.9539  1.1282  0.8933  0.8860  1.1347  1.0911\n4          ought  AAAAAAAANDAAAAAA         5148  1.0676  0.8363  1.1403  1.1962  0.8709  0.9283  1.0905\n5          ought  AAAAAAAANDAAAAAA         5148  1.0629  1.0983  1.1157  0.7552  0.8589  1.0501  1.2154\n6          ought  AAAAAAAANDAAAAAA         5148  1.1211  1.0504  1.1549  1.0046  0.9919  1.0531  1.0313\n7          ought  AAAAAAAANDAAAAAA         5148  1.2003  0.7525  1.2905  1.1813  1.0900  1.0247  0.8905\n8          ought  AAAAAAAANDAAAAAA         5148  1.4305  0.5726  1.8033  1.0181  0.9049  1.0978  0.8612\n9          ought  AAAAAAAANDAAAAAA         5148  1.6287  1.0712  1.1532  1.3979  0.8151  0.8818  0.8546\n10         ought  AAAAAAAANDAAAAAA         5148  1.1680  0.8485  1.6115  0.8899  0.8724  0.9696  1.0560\n11         ought  AAAAAAAANDAAAAAA         5148  0.9803  0.9197  1.3718  0.9047  1.2973  1.1935  1.0522\n12         ought  AAAAAAAANDAAAAAA         5148  1.0515  1.1989  1.0866  1.1575  1.0546  0.8312  0.7267\n13         ought  AAAAAAAANDAAAAAA         5148  1.8280  1.5046  1.8636  1.4816  1.5334  1.7079  1.7002\n14         ought  AAAAAAAANDAAAAAA         5148  1.5583  0.7781  1.1177  1.1638  1.3012  1.5025  1.4427\n15         ought  AAAAAAAANDAAAAAA         5148  1.0848  0.9114  1.4035  1.2140  1.4102  1.0958  1.1489\n16         ought  AAAAAAAANDAAAAAA         5148  1.1509  1.0336  1.5327  1.0641  1.2029  0.9411  1.1153\n17         ought  AAAAAAAANDAAAAAA         5148  1.2858  1.1854  0.9808  1.1974  1.0299  1.4541  1.1768\n18         ought  AAAAAAAANDAAAAAA         5148  1.4355  1.1856  1.3270  0.7936  1.4317  1.0598  1.6198\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1, s_store_id1, d_week_seq1\n       , NULL AS sun_sales2, NULL AS mon_sales2\n       , NULL AS tue_sales2, NULL AS wed_sales2, NULL AS thu_sales2\n       , NULL AS fri_sales2, NULL AS sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y\n \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , NULL AS \"SUN_SALES2\" , NULL AS \"MON_SALES2\" , NULL AS \"TUE_SALES2\" , NULL AS \"WED_SALES2\" , NULL AS \"THU_SALES2\" , NULL AS \"FRI_SALES2\" , NULL AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.06996,
                    "execution_time": 0.037649,
                    "compile_time": 0.000267,
                    "planning_time": 0.003262,
                    "create_size": 115
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.130963,
                    "execution_time": 0.036765,
                    "compile_time": 0.000246,
                    "planning_time": 0.060047,
                    "create_size": 100
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_10\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , NULL AS \"SUN_SALES2\" , NULL AS \"MON_SALES2\" , NULL AS \"TUE_SALES2\" , NULL AS \"WED_SALES2\" , NULL AS \"THU_SALES2\" , NULL AS \"FRI_SALES2\" , NULL AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_10\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.129527,
                    "execution_time": 0.051039,
                    "compile_time": 0.000357,
                    "planning_time": 0.035066,
                    "create_size": 351
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.337828,
                    "execution_time": 0.052193,
                    "compile_time": 0.124513,
                    "planning_time": 0.111831,
                    "create_size": 364
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_11\".\"SUN_SALES2\" AS \"SUN_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"MON_SALES2\" AS \"MON_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"TUE_SALES2\" AS \"TUE_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"WED_SALES2\" AS \"WED_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"THU_SALES2\" AS \"THU_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"FRI_SALES2\" AS \"FRI_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"SAT_SALES2\" AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1 sun_sales2 mon_sales2 tue_sales2 wed_sales2 thu_sales2 fri_sales2 sat_sales2\n0           n st  AAAAAAAAPEAAAAAA         5162       None       None       None       None       None       None       None\n1           n st  AAAAAAAAPEAAAAAA         5162       None       None       None       None       None       None       None\n2           n st  AAAAAAAAPEAAAAAA         5162       None       None       None       None       None       None       None\n3           n st  AAAAAAAAPEAAAAAA         5162       None       None       None       None       None       None       None\n4           n st  AAAAAAAAPEAAAAAA         5162       None       None       None       None       None       None       None\n5           n st  AAAAAAAAPEAAAAAA         5162       None       None       None       None       None       None       None\n6           n st  AAAAAAAAPEAAAAAA         5162       None       None       None       None       None       None       None\n7           able  AAAAAAAAACAAAAAA         5162       None       None       None       None       None       None       None\n8           able  AAAAAAAAACAAAAAA         5162       None       None       None       None       None       None       None\n9           able  AAAAAAAAACAAAAAA         5162       None       None       None       None       None       None       None\n10          able  AAAAAAAAACAAAAAA         5162       None       None       None       None       None       None       None\n11          able  AAAAAAAAACAAAAAA         5162       None       None       None       None       None       None       None\n12          able  AAAAAAAAACAAAAAA         5162       None       None       None       None       None       None       None\n13          able  AAAAAAAAACAAAAAA         5162       None       None       None       None       None       None       None\n14          anti  AAAAAAAAFFAAAAAA         5162       None       None       None       None       None       None       None\n15          anti  AAAAAAAAFFAAAAAA         5162       None       None       None       None       None       None       None\n16          anti  AAAAAAAAFFAAAAAA         5162       None       None       None       None       None       None       None\n17          anti  AAAAAAAAFFAAAAAA         5162       None       None       None       None       None       None       None\n18          anti  AAAAAAAAFFAAAAAA         5162       None       None       None       None       None       None       None\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019554,
                    "execution_time": 0.008019,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.004699
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056982,
                    "execution_time": 0.007948,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.040472
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_10\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , NULL AS \"SUN_SALES2\" , NULL AS \"MON_SALES2\" , NULL AS \"TUE_SALES2\" , NULL AS \"WED_SALES2\" , NULL AS \"THU_SALES2\" , NULL AS \"FRI_SALES2\" , NULL AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_10\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_11\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_11\".\"SUN_SALES2\" AS \"SUN_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"MON_SALES2\" AS \"MON_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"TUE_SALES2\" AS \"TUE_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"WED_SALES2\" AS \"WED_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"THU_SALES2\" AS \"THU_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"FRI_SALES2\" AS \"FRI_SALES2\" , \"SPEQLITE_TEMP_TABLE_11\".\"SAT_SALES2\" AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1 sun_sales2 mon_sales2 tue_sales2 wed_sales2 thu_sales2 fri_sales2 sat_sales2\n0           n st  AAAAAAAAPEAAAAAA         5162       None       None       None       None       None       None       None\n1           n st  AAAAAAAAPEAAAAAA         5162       None       None       None       None       None       None       None\n2           n st  AAAAAAAAPEAAAAAA         5162       None       None       None       None       None       None       None\n3           n st  AAAAAAAAPEAAAAAA         5162       None       None       None       None       None       None       None\n4           n st  AAAAAAAAPEAAAAAA         5162       None       None       None       None       None       None       None\n5           n st  AAAAAAAAPEAAAAAA         5162       None       None       None       None       None       None       None\n6           n st  AAAAAAAAPEAAAAAA         5162       None       None       None       None       None       None       None\n7           able  AAAAAAAAACAAAAAA         5162       None       None       None       None       None       None       None\n8           able  AAAAAAAAACAAAAAA         5162       None       None       None       None       None       None       None\n9           able  AAAAAAAAACAAAAAA         5162       None       None       None       None       None       None       None\n10          able  AAAAAAAAACAAAAAA         5162       None       None       None       None       None       None       None\n11          able  AAAAAAAAACAAAAAA         5162       None       None       None       None       None       None       None\n12          able  AAAAAAAAACAAAAAA         5162       None       None       None       None       None       None       None\n13          able  AAAAAAAAACAAAAAA         5162       None       None       None       None       None       None       None\n14          anti  AAAAAAAAFFAAAAAA         5162       None       None       None       None       None       None       None\n15          anti  AAAAAAAAFFAAAAAA         5162       None       None       None       None       None       None       None\n16          anti  AAAAAAAAFFAAAAAA         5162       None       None       None       None       None       None       None\n17          anti  AAAAAAAAFFAAAAAA         5162       None       None       None       None       None       None       None\n18          anti  AAAAAAAAFFAAAAAA         5162       None       None       None       None       None       None       None\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales, date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq, ss_store_sk\n )\nselect  s_store_name1, s_store_id1, d_week_seq1\n       , sun_sales1/sun_sales2, mon_sales1/mon_sales2\n       , tue_sales1/tue_sales2, wed_sales1/wed_sales2, thu_sales1/thu_sales2\n       , fri_sales1/fri_sales2, sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1, wss.d_week_seq d_week_seq1\n        , s_store_id s_store_id1, sun_sales sun_sales1\n        , mon_sales mon_sales1, tue_sales tue_sales1\n        , wed_sales wed_sales1, thu_sales thu_sales1\n        , fri_sales fri_sales1, sat_sales sat_sales1\n  from wss, store, date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        wss.ss_store_sk = s_store_sk and \n        d.d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2, wss.d_week_seq d_week_seq2\n        , s_store_id s_store_id2, sun_sales sun_sales2\n        , mon_sales mon_sales2, tue_sales tue_sales2\n        , wed_sales wed_sales2, thu_sales thu_sales2\n        , fri_sales fri_sales2, sat_sales sat_sales2\n  from wss, store, date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        wss.ss_store_sk = s_store_sk and \n        d.d_month_seq between 1182 + 12 and 1182 + 23) z\nwhere s_store_id1 = s_store_id2\nand d_week_seq1 = d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"Z\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"Z\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"Z\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"Z\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"Z\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"Z\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"Z\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"Z\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"Z\" AS \"Z\" ON \"STORE\".\"S_STORE_ID\" = \"Z\".\"S_STORE_ID2\" AND \"WSS\".\"D_WEEK_SEQ\" = \"Z\".\"D_WEEK_SEQ2\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" AS \"MON_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" AS \"WED_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" AS \"THU_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.19309,
                    "execution_time": 0.057496,
                    "compile_time": 0.000374,
                    "planning_time": 0.039905,
                    "create_size": 312
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.27169,
                    "execution_time": 0.060487,
                    "compile_time": 0.000378,
                    "planning_time": 0.11052,
                    "create_size": 300
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.171618,
                    "execution_time": 0.050866,
                    "compile_time": 0.041583,
                    "planning_time": 0.043569,
                    "create_size": 26
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.756844,
                    "execution_time": 0.05183,
                    "compile_time": 3.547792,
                    "planning_time": 0.114027,
                    "create_size": 26
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_13\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0            bar  AAAAAAAAGEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1            bar  AAAAAAAAGEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2            bar  AAAAAAAAGEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3            bar  AAAAAAAAGEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4           eing  AAAAAAAAKDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5           eing  AAAAAAAAKDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6           eing  AAAAAAAAKDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7           eing  AAAAAAAAKDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8           eing  AAAAAAAAKDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9           eing  AAAAAAAAKDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10          eing  AAAAAAAAKDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11          eing  AAAAAAAAKDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12          eing  AAAAAAAAKDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13          eing  AAAAAAAAKDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14           bar  AAAAAAAACDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15           bar  AAAAAAAACDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16           bar  AAAAAAAACDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17           bar  AAAAAAAACDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18           bar  AAAAAAAACDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018957,
                    "execution_time": 0.007425,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.004572
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057654,
                    "execution_time": 0.007255,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.040377
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_13\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0            bar  AAAAAAAAGEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1            bar  AAAAAAAAGEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2            bar  AAAAAAAAGEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3            bar  AAAAAAAAGEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4           eing  AAAAAAAAKDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5           eing  AAAAAAAAKDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6           eing  AAAAAAAAKDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7           eing  AAAAAAAAKDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8           eing  AAAAAAAAKDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9           eing  AAAAAAAAKDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10          eing  AAAAAAAAKDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11          eing  AAAAAAAAKDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12          eing  AAAAAAAAKDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13          eing  AAAAAAAAKDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14           bar  AAAAAAAACDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15           bar  AAAAAAAACDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16           bar  AAAAAAAACDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17           bar  AAAAAAAACDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18           bar  AAAAAAAACDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2,mon_sales mon_sales2,tue_sales tue_sales2,wed_sales wed_sales2,thu_sales thu_sales2,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss, store, date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        wss.ss_store_sk = s_store_sk and \n        d_month_seq between 1182 + 12 and 1182 + 23) z\nwhere s_store_id1 = s_store_id2\nand d_week_seq1 = d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"Z\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"Z\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"Z\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"Z\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"Z\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"Z\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"Z\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"Z\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"Z\" AS \"Z\" ON \"STORE\".\"S_STORE_ID\" = \"Z\".\"S_STORE_ID2\" AND \"WSS\".\"D_WEEK_SEQ\" = \"Z\".\"D_WEEK_SEQ2\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"_COL_3\" AS \"_COL_3\" , \"_COL_4\" AS \"_COL_4\" , \"_COL_5\" AS \"_COL_5\" , \"_COL_6\" AS \"_COL_6\" , \"_COL_7\" AS \"_COL_7\" , \"_COL_8\" AS \"_COL_8\" , \"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0            ese  AAAAAAAAOFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1            ese  AAAAAAAAOFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2            ese  AAAAAAAAOFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3            ese  AAAAAAAAOFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4           eing  AAAAAAAAEEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5           eing  AAAAAAAAEEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6           eing  AAAAAAAAEEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7           eing  AAAAAAAAEEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8           eing  AAAAAAAAEEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9           eing  AAAAAAAAEEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10          eing  AAAAAAAAEEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11          eing  AAAAAAAAEEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12          eing  AAAAAAAAEEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13          eing  AAAAAAAAEEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         ought  AAAAAAAALFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         ought  AAAAAAAALFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         ought  AAAAAAAALFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         ought  AAAAAAAALFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         ought  AAAAAAAALFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01889,
                    "execution_time": 0.007803,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004443
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054338,
                    "execution_time": 0.007626,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.039843
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\"",
                "rewrite": "SELECT \"S_STORE_NAME1\" AS \"S_STORE_NAME1\", \"S_STORE_ID1\" AS \"S_STORE_ID1\", \"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\", \"_COL_3\" AS \"_COL_3\", \"_COL_4\" AS \"_COL_4\", \"_COL_5\" AS \"_COL_5\", \"_COL_6\" AS \"_COL_6\", \"_COL_7\" AS \"_COL_7\", \"_COL_8\" AS \"_COL_8\", \"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0            ese  AAAAAAAAOFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1            ese  AAAAAAAAOFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2            ese  AAAAAAAAOFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3            ese  AAAAAAAAOFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4           eing  AAAAAAAAEEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5           eing  AAAAAAAAEEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6           eing  AAAAAAAAEEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7           eing  AAAAAAAAEEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8           eing  AAAAAAAAEEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9           eing  AAAAAAAAEEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10          eing  AAAAAAAAEEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11          eing  AAAAAAAAEEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12          eing  AAAAAAAAEEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13          eing  AAAAAAAAEEAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         ought  AAAAAAAALFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         ought  AAAAAAAALFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         ought  AAAAAAAALFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         ought  AAAAAAAALFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         ought  AAAAAAAALFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2,wed_sales wed_sales2,thu_sales thu_sales2,fri_sales fri_sales2,sat_sales sat_sales2\n from wss,store,date_dim d where d.d_week_seq = wss.d_week_seq and ss_store_sk = s_store_sk and d_month_seq between 1182 + 12 and 1182 + 23) z where s_store_id1 = s_store_id2 and d_week_seq1 = d_week_seq2 order by s_store_name1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"Z\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"Z\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"Z\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"Z\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"Z\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"Z\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"Z\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"Z\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"Z\" AS \"Z\" ON \"STORE\".\"S_STORE_ID\" = \"Z\".\"S_STORE_ID2\" AND \"WSS\".\"D_WEEK_SEQ\" = \"Z\".\"D_WEEK_SEQ2\" ORDER BY \"S_STORE_NAME1\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_13\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"S_STORE_NAME1\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           able  AAAAAAAAGBAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1           able  AAAAAAAAEDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2           able  AAAAAAAAGBAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3           able  AAAAAAAAEDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4           able  AAAAAAAAACAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5           able  AAAAAAAAEDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6           able  AAAAAAAAGBAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7           able  AAAAAAAAEDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8           able  AAAAAAAAGBAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9           able  AAAAAAAACFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10          able  AAAAAAAAGBAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11          able  AAAAAAAAEDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12          able  AAAAAAAAACAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13          able  AAAAAAAAEDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14          able  AAAAAAAAACAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15          able  AAAAAAAAEDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16          able  AAAAAAAAACAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17          able  AAAAAAAAEDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18          able  AAAAAAAAGBAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019386,
                    "execution_time": 0.008188,
                    "compile_time": 7.8e-05,
                    "planning_time": 0.004632
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.079172,
                    "execution_time": 0.008996,
                    "compile_time": 8.8e-05,
                    "planning_time": 0.060061
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\" ORDER BY \"S_STORE_NAME1\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_13\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_13\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_13\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"S_STORE_NAME1\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           able  AAAAAAAAGBAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1           able  AAAAAAAAEDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2           able  AAAAAAAAGBAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3           able  AAAAAAAAEDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4           able  AAAAAAAAACAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5           able  AAAAAAAAEDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6           able  AAAAAAAAGBAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7           able  AAAAAAAAEDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8           able  AAAAAAAAGBAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9           able  AAAAAAAACFAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10          able  AAAAAAAAGBAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11          able  AAAAAAAAEDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12          able  AAAAAAAAACAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13          able  AAAAAAAAEDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14          able  AAAAAAAAACAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15          able  AAAAAAAAEDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16          able  AAAAAAAAACAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17          able  AAAAAAAAEDAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18          able  AAAAAAAAGBAAAAAA         5192     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) z\n where y.d_week_seq1 = z.d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"D\" AS ( SELECT \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS\" AS \"WSS_2\" ON \"WSS\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"D\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.082332,
                    "execution_time": 0.031412,
                    "compile_time": 0.000286,
                    "planning_time": 0.025398,
                    "create_size": 20
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.145202,
                    "execution_time": 0.031906,
                    "compile_time": 0.000232,
                    "planning_time": 0.089417,
                    "create_size": 20
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.208518,
                    "execution_time": 0.998722,
                    "compile_time": 0.000805,
                    "planning_time": 0.042946,
                    "create_size": 1792
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.275196,
                    "execution_time": 1.030147,
                    "compile_time": 0.000869,
                    "planning_time": 0.110587,
                    "create_size": 1792
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_15\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_15\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0            ese  AAAAAAAAOFAAAAAA         5144  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000\n1            ese  AAAAAAAAOFAAAAAA         5144  0.4544  1.4763  0.8012  1.6043  0.7417  0.7283  1.3155\n2            ese  AAAAAAAAOFAAAAAA         5144  0.3819  0.9842  0.7065  1.4344  1.6133  1.1264  1.0222\n3            ese  AAAAAAAAOFAAAAAA         5144  0.4051  1.3348  0.6572  2.6985  0.7504  1.0154  0.9420\n4            ese  AAAAAAAAOFAAAAAA         5144  0.4282  0.7775  0.4707  1.2140  1.0736  0.8500  0.9304\n5            ese  AAAAAAAAOFAAAAAA         5144  0.4186  1.1004  0.7379  2.1106  0.8711  0.8625  0.9683\n6            ese  AAAAAAAAOFAAAAAA         5144  0.4196  1.2153  0.7101  1.5393  1.1057  0.4964  1.4701\n7            ese  AAAAAAAAOFAAAAAA         5144  0.4926  0.8454  0.7303  1.2101  1.2775  0.5860  1.5990\n8            ese  AAAAAAAAOFAAAAAA         5144  0.7595  0.8361  0.4995  3.1029  1.3600  0.6913  1.5603\n9            ese  AAAAAAAAOFAAAAAA         5144  0.4964  0.9298  0.6099  2.0130  1.0554  0.8519  1.0836\n10           ese  AAAAAAAAOFAAAAAA         5144  0.4493  0.8751  0.6605  2.1203  0.9596  1.0818  0.8326\n11           ese  AAAAAAAAOFAAAAAA         5144  0.5412  1.0574  0.5045  1.4066  1.0354  0.9545  1.4211\n12           ese  AAAAAAAAOFAAAAAA         5144  0.3415  0.8250  0.5612  2.8957  1.1437  0.4768  1.2580\n13           ese  AAAAAAAAOFAAAAAA         5144  0.6417  0.8862  0.6169  1.3027  0.5360  0.6310  1.5355\n14           ese  AAAAAAAAOFAAAAAA         5144  0.5130  1.0733  0.7279  1.4621  1.5933  0.7861  0.9884\n15           ese  AAAAAAAAOFAAAAAA         5144  0.4646  1.1554  0.7115  1.2109  0.9502  0.8813  2.6260\n16           ese  AAAAAAAAOFAAAAAA         5144  0.5192  1.0979  0.7145  1.5131  0.6446  1.0971  0.7575\n17           ese  AAAAAAAAOFAAAAAA         5144  0.3438  1.0454  0.7615  1.4358  0.9517  0.8509  1.3558\n18           ese  AAAAAAAAOFAAAAAA         5144  0.4071  1.3006  1.4506  1.8994  2.0471  0.8974  1.3385\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018871,
                    "execution_time": 0.007984,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004361
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057891,
                    "execution_time": 0.008215,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039889
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_15\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_15\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0            ese  AAAAAAAAOFAAAAAA         5144  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000\n1            ese  AAAAAAAAOFAAAAAA         5144  0.4544  1.4763  0.8012  1.6043  0.7417  0.7283  1.3155\n2            ese  AAAAAAAAOFAAAAAA         5144  0.3819  0.9842  0.7065  1.4344  1.6133  1.1264  1.0222\n3            ese  AAAAAAAAOFAAAAAA         5144  0.4051  1.3348  0.6572  2.6985  0.7504  1.0154  0.9420\n4            ese  AAAAAAAAOFAAAAAA         5144  0.4282  0.7775  0.4707  1.2140  1.0736  0.8500  0.9304\n5            ese  AAAAAAAAOFAAAAAA         5144  0.4186  1.1004  0.7379  2.1106  0.8711  0.8625  0.9683\n6            ese  AAAAAAAAOFAAAAAA         5144  0.4196  1.2153  0.7101  1.5393  1.1057  0.4964  1.4701\n7            ese  AAAAAAAAOFAAAAAA         5144  0.4926  0.8454  0.7303  1.2101  1.2775  0.5860  1.5990\n8            ese  AAAAAAAAOFAAAAAA         5144  0.7595  0.8361  0.4995  3.1029  1.3600  0.6913  1.5603\n9            ese  AAAAAAAAOFAAAAAA         5144  0.4964  0.9298  0.6099  2.0130  1.0554  0.8519  1.0836\n10           ese  AAAAAAAAOFAAAAAA         5144  0.4493  0.8751  0.6605  2.1203  0.9596  1.0818  0.8326\n11           ese  AAAAAAAAOFAAAAAA         5144  0.5412  1.0574  0.5045  1.4066  1.0354  0.9545  1.4211\n12           ese  AAAAAAAAOFAAAAAA         5144  0.3415  0.8250  0.5612  2.8957  1.1437  0.4768  1.2580\n13           ese  AAAAAAAAOFAAAAAA         5144  0.6417  0.8862  0.6169  1.3027  0.5360  0.6310  1.5355\n14           ese  AAAAAAAAOFAAAAAA         5144  0.5130  1.0733  0.7279  1.4621  1.5933  0.7861  0.9884\n15           ese  AAAAAAAAOFAAAAAA         5144  0.4646  1.1554  0.7115  1.2109  0.9502  0.8813  2.6260\n16           ese  AAAAAAAAOFAAAAAA         5144  0.5192  1.0979  0.7145  1.5131  0.6446  1.0971  0.7575\n17           ese  AAAAAAAAOFAAAAAA         5144  0.3438  1.0454  0.7615  1.4358  0.9517  0.8509  1.3558\n18           ese  AAAAAAAAOFAAAAAA         5144  0.4071  1.3006  1.4506  1.8994  2.0471  0.8974  1.3385\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) z\n where y.d_week_seq1 = z.d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"D\" AS ( SELECT \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS\" AS \"WSS_2\" ON \"WSS\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"D\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"_COL_3\" AS \"_COL_3\" , \"_COL_4\" AS \"_COL_4\" , \"_COL_5\" AS \"_COL_5\" , \"_COL_6\" AS \"_COL_6\" , \"_COL_7\" AS \"_COL_7\" , \"_COL_8\" AS \"_COL_8\" , \"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0            ese  AAAAAAAAOFAAAAAA         5144  0.3819  0.9842  0.7065  1.4344  1.6133  1.1264  1.0222\n1            ese  AAAAAAAAOFAAAAAA         5144  0.4051  1.3348  0.6572  2.6985  0.7504  1.0154  0.9420\n2            ese  AAAAAAAAOFAAAAAA         5144  0.4282  0.7775  0.4707  1.2140  1.0736  0.8500  0.9304\n3            ese  AAAAAAAAOFAAAAAA         5144  0.4186  1.1004  0.7379  2.1106  0.8711  0.8625  0.9683\n4            ese  AAAAAAAAOFAAAAAA         5144  0.4196  1.2153  0.7101  1.5393  1.1057  0.4964  1.4701\n5            ese  AAAAAAAAOFAAAAAA         5144  0.4926  0.8454  0.7303  1.2101  1.2775  0.5860  1.5990\n6            ese  AAAAAAAAOFAAAAAA         5144  0.7595  0.8361  0.4995  3.1029  1.3600  0.6913  1.5603\n7            ese  AAAAAAAAOFAAAAAA         5144  0.4964  0.9298  0.6099  2.0130  1.0554  0.8519  1.0836\n8            ese  AAAAAAAAOFAAAAAA         5144  0.4493  0.8751  0.6605  2.1203  0.9596  1.0818  0.8326\n9            ese  AAAAAAAAOFAAAAAA         5144  0.5412  1.0574  0.5045  1.4066  1.0354  0.9545  1.4211\n10           ese  AAAAAAAAOFAAAAAA         5144  0.3415  0.8250  0.5612  2.8957  1.1437  0.4768  1.2580\n11           ese  AAAAAAAAOFAAAAAA         5144  0.6417  0.8862  0.6169  1.3027  0.5360  0.6310  1.5355\n12           ese  AAAAAAAAOFAAAAAA         5144  0.5130  1.0733  0.7279  1.4621  1.5933  0.7861  0.9884\n13           ese  AAAAAAAAOFAAAAAA         5144  0.4646  1.1554  0.7115  1.2109  0.9502  0.8813  2.6260\n14           ese  AAAAAAAAOFAAAAAA         5144  0.5192  1.0979  0.7145  1.5131  0.6446  1.0971  0.7575\n15           ese  AAAAAAAAOFAAAAAA         5144  0.3438  1.0454  0.7615  1.4358  0.9517  0.8509  1.3558\n16           ese  AAAAAAAAOFAAAAAA         5144  0.4071  1.3006  1.4506  1.8994  2.0471  0.8974  1.3385\n17           ese  AAAAAAAAOFAAAAAA         5144  0.2665  0.9614  0.4419  1.6197  0.9946  1.1598  2.0251\n18           ese  AAAAAAAAOFAAAAAA         5144  0.4547  1.4109  0.6105  2.9670  0.8609  1.1260  0.9350\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019243,
                    "execution_time": 0.008393,
                    "compile_time": 5e-05,
                    "planning_time": 0.004329
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054186,
                    "execution_time": 0.007759,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.039726
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"S_STORE_NAME1\" AS \"S_STORE_NAME1\", \"S_STORE_ID1\" AS \"S_STORE_ID1\", \"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\", \"_COL_3\" AS \"_COL_3\", \"_COL_4\" AS \"_COL_4\", \"_COL_5\" AS \"_COL_5\", \"_COL_6\" AS \"_COL_6\", \"_COL_7\" AS \"_COL_7\", \"_COL_8\" AS \"_COL_8\", \"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0            ese  AAAAAAAAOFAAAAAA         5144  0.3819  0.9842  0.7065  1.4344  1.6133  1.1264  1.0222\n1            ese  AAAAAAAAOFAAAAAA         5144  0.4051  1.3348  0.6572  2.6985  0.7504  1.0154  0.9420\n2            ese  AAAAAAAAOFAAAAAA         5144  0.4282  0.7775  0.4707  1.2140  1.0736  0.8500  0.9304\n3            ese  AAAAAAAAOFAAAAAA         5144  0.4186  1.1004  0.7379  2.1106  0.8711  0.8625  0.9683\n4            ese  AAAAAAAAOFAAAAAA         5144  0.4196  1.2153  0.7101  1.5393  1.1057  0.4964  1.4701\n5            ese  AAAAAAAAOFAAAAAA         5144  0.4926  0.8454  0.7303  1.2101  1.2775  0.5860  1.5990\n6            ese  AAAAAAAAOFAAAAAA         5144  0.7595  0.8361  0.4995  3.1029  1.3600  0.6913  1.5603\n7            ese  AAAAAAAAOFAAAAAA         5144  0.4964  0.9298  0.6099  2.0130  1.0554  0.8519  1.0836\n8            ese  AAAAAAAAOFAAAAAA         5144  0.4493  0.8751  0.6605  2.1203  0.9596  1.0818  0.8326\n9            ese  AAAAAAAAOFAAAAAA         5144  0.5412  1.0574  0.5045  1.4066  1.0354  0.9545  1.4211\n10           ese  AAAAAAAAOFAAAAAA         5144  0.3415  0.8250  0.5612  2.8957  1.1437  0.4768  1.2580\n11           ese  AAAAAAAAOFAAAAAA         5144  0.6417  0.8862  0.6169  1.3027  0.5360  0.6310  1.5355\n12           ese  AAAAAAAAOFAAAAAA         5144  0.5130  1.0733  0.7279  1.4621  1.5933  0.7861  0.9884\n13           ese  AAAAAAAAOFAAAAAA         5144  0.4646  1.1554  0.7115  1.2109  0.9502  0.8813  2.6260\n14           ese  AAAAAAAAOFAAAAAA         5144  0.5192  1.0979  0.7145  1.5131  0.6446  1.0971  0.7575\n15           ese  AAAAAAAAOFAAAAAA         5144  0.3438  1.0454  0.7615  1.4358  0.9517  0.8509  1.3558\n16           ese  AAAAAAAAOFAAAAAA         5144  0.4071  1.3006  1.4506  1.8994  2.0471  0.8974  1.3385\n17           ese  AAAAAAAAOFAAAAAA         5144  0.2665  0.9614  0.4419  1.6197  0.9946  1.1598  2.0251\n18           ese  AAAAAAAAOFAAAAAA         5144  0.4547  1.4109  0.6105  2.9670  0.8609  1.1260  0.9350\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) z\n where y.d_week_seq1 = z.d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"D\" AS ( SELECT \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS\" AS \"WSS_2\" ON \"WSS\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"D\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"_COL_3\" AS \"_COL_3\" , \"_COL_4\" AS \"_COL_4\" , \"_COL_5\" AS \"_COL_5\" , \"_COL_6\" AS \"_COL_6\" , \"_COL_7\" AS \"_COL_7\" , \"_COL_8\" AS \"_COL_8\" , \"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           able  AAAAAAAACFAAAAAA         5144  0.9668  0.7859  0.6596  1.0829  1.0201  1.3098  1.4180\n1           able  AAAAAAAACFAAAAAA         5144  0.7571  0.9478  0.8559  0.7391  1.1995  1.1753  0.7974\n2           able  AAAAAAAACFAAAAAA         5144  1.4608  0.7632  0.6009  1.8663  1.7087  2.5468  0.6074\n3           able  AAAAAAAACFAAAAAA         5144  1.0181  0.6203  0.7113  1.5015  1.1178  0.9249  0.7553\n4           able  AAAAAAAACFAAAAAA         5144  1.0392  0.5589  1.3252  2.4264  1.9925  1.1106  0.8477\n5           able  AAAAAAAACFAAAAAA         5144  1.0714  0.5746  0.7454  1.6556  1.3232  1.8702  1.0413\n6           able  AAAAAAAACFAAAAAA         5144  1.0041  0.6722  0.9692  1.3838  1.3146  0.7276  0.7191\n7           able  AAAAAAAACFAAAAAA         5144  1.1240  0.8006  1.0164  1.2351  1.2671  1.2157  0.8321\n8           able  AAAAAAAACFAAAAAA         5144  1.0836  1.0490  0.8076  0.8731  1.7725  1.0232  0.8166\n9           able  AAAAAAAACFAAAAAA         5144  0.9090  0.7407  0.8010  1.8780  1.2285  1.1556  0.5868\n10          able  AAAAAAAACFAAAAAA         5144  0.9783  0.7070  1.0222  0.8792  1.4346  0.7376  1.1801\n11          able  AAAAAAAACFAAAAAA         5144  1.6066  0.6259  0.6588  1.1315  1.4802  1.0954  0.7140\n12          able  AAAAAAAACFAAAAAA         5144  1.4698  0.7093  0.5899  1.6881  1.4344  0.9213  1.5782\n13          able  AAAAAAAACFAAAAAA         5144  0.6376  0.6447  0.6553  1.1442  1.4216  0.9465  0.7555\n14          able  AAAAAAAACFAAAAAA         5144  0.9105  0.7957  1.1145  1.1822  1.2706  0.6592  0.9047\n15          able  AAAAAAAACFAAAAAA         5144  0.9252  0.5514  0.9590  0.8068  1.2939  1.1969  0.9440\n16          able  AAAAAAAACFAAAAAA         5144  0.8075  0.5926  0.9508  1.1831  1.4178  1.4260  0.8906\n17          able  AAAAAAAACFAAAAAA         5144  0.6997  0.7489  0.6105  1.2843  1.4295  0.9127  1.2863\n18          able  AAAAAAAACFAAAAAA         5144  1.6138  0.8962  0.8410  1.3644  1.3497  1.1291  0.9122\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021027,
                    "execution_time": 0.008485,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.005595
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019959,
                    "execution_time": 0.008552,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004552
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"S_STORE_NAME1\" AS \"S_STORE_NAME1\", \"S_STORE_ID1\" AS \"S_STORE_ID1\", \"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\", \"_COL_3\" AS \"_COL_3\", \"_COL_4\" AS \"_COL_4\", \"_COL_5\" AS \"_COL_5\", \"_COL_6\" AS \"_COL_6\", \"_COL_7\" AS \"_COL_7\", \"_COL_8\" AS \"_COL_8\", \"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           able  AAAAAAAACFAAAAAA         5144  0.9668  0.7859  0.6596  1.0829  1.0201  1.3098  1.4180\n1           able  AAAAAAAACFAAAAAA         5144  0.7571  0.9478  0.8559  0.7391  1.1995  1.1753  0.7974\n2           able  AAAAAAAACFAAAAAA         5144  1.4608  0.7632  0.6009  1.8663  1.7087  2.5468  0.6074\n3           able  AAAAAAAACFAAAAAA         5144  1.0181  0.6203  0.7113  1.5015  1.1178  0.9249  0.7553\n4           able  AAAAAAAACFAAAAAA         5144  1.0392  0.5589  1.3252  2.4264  1.9925  1.1106  0.8477\n5           able  AAAAAAAACFAAAAAA         5144  1.0714  0.5746  0.7454  1.6556  1.3232  1.8702  1.0413\n6           able  AAAAAAAACFAAAAAA         5144  1.0041  0.6722  0.9692  1.3838  1.3146  0.7276  0.7191\n7           able  AAAAAAAACFAAAAAA         5144  1.1240  0.8006  1.0164  1.2351  1.2671  1.2157  0.8321\n8           able  AAAAAAAACFAAAAAA         5144  1.0836  1.0490  0.8076  0.8731  1.7725  1.0232  0.8166\n9           able  AAAAAAAACFAAAAAA         5144  0.9090  0.7407  0.8010  1.8780  1.2285  1.1556  0.5868\n10          able  AAAAAAAACFAAAAAA         5144  0.9783  0.7070  1.0222  0.8792  1.4346  0.7376  1.1801\n11          able  AAAAAAAACFAAAAAA         5144  1.6066  0.6259  0.6588  1.1315  1.4802  1.0954  0.7140\n12          able  AAAAAAAACFAAAAAA         5144  1.4698  0.7093  0.5899  1.6881  1.4344  0.9213  1.5782\n13          able  AAAAAAAACFAAAAAA         5144  0.6376  0.6447  0.6553  1.1442  1.4216  0.9465  0.7555\n14          able  AAAAAAAACFAAAAAA         5144  0.9105  0.7957  1.1145  1.1822  1.2706  0.6592  0.9047\n15          able  AAAAAAAACFAAAAAA         5144  0.9252  0.5514  0.9590  0.8068  1.2939  1.1969  0.9440\n16          able  AAAAAAAACFAAAAAA         5144  0.8075  0.5926  0.9508  1.1831  1.4178  1.4260  0.8906\n17          able  AAAAAAAACFAAAAAA         5144  0.6997  0.7489  0.6105  1.2843  1.4295  0.9127  1.2863\n18          able  AAAAAAAACFAAAAAA         5144  1.6138  0.8962  0.8410  1.3644  1.3497  1.1291  0.9122\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk\n) z\n where y.d_week_seq1 = z.d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS\" AS \"WSS_2\" ON \"WSS\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.238636,
                    "execution_time": 1.020309,
                    "compile_time": 0.000775,
                    "planning_time": 0.056867,
                    "create_size": 1792
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.347524,
                    "execution_time": 1.054773,
                    "compile_time": 0.00082,
                    "planning_time": 0.131841,
                    "create_size": 1792
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_16\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_16\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0          cally  AAAAAAAAKBAAAAAA         5148  1.9656  0.7046  1.4640  0.7060  0.8090  1.1686  1.1616\n1          cally  AAAAAAAAKBAAAAAA         5148  1.4433  0.5645  1.1555  0.7833  0.8420  1.5284  1.2415\n2          cally  AAAAAAAAKBAAAAAA         5148  0.9315  0.9456  1.6396  0.8280  0.9520  0.8331  1.0343\n3          cally  AAAAAAAAKBAAAAAA         5148  1.4975  0.5022  1.9710  0.9260  0.6756  1.1335  0.8099\n4          cally  AAAAAAAAKBAAAAAA         5148  1.7050  0.9394  1.2605  1.2714  0.6085  0.9105  0.8037\n5          cally  AAAAAAAAKBAAAAAA         5148  1.2227  0.7441  1.7614  0.8093  0.6513  1.0011  0.9931\n6          cally  AAAAAAAAKBAAAAAA         5148  1.0263  0.8066  1.4994  0.8228  0.9686  1.2324  0.9895\n7          cally  AAAAAAAAKBAAAAAA         5148  1.1007  1.0514  1.1877  1.0527  0.7874  0.8583  0.6834\n8          cally  AAAAAAAAKBAAAAAA         5148  1.3277  0.7054  1.3801  1.2589  0.8715  1.1145  0.9824\n9          cally  AAAAAAAAKBAAAAAA         5148  1.5749  1.2586  1.1381  0.8677  0.7435  1.2518  1.3646\n10         cally  AAAAAAAAKBAAAAAA         5148  1.0319  0.6912  1.7753  0.8533  0.6460  1.5712  1.9906\n11         cally  AAAAAAAAKBAAAAAA         5148  1.2054  0.8366  1.2331  0.8125  0.6615  1.1716  1.0261\n12         cally  AAAAAAAAKBAAAAAA         5148  1.1176  0.7334  1.2464  1.0880  0.6502  0.9585  1.0255\n13         cally  AAAAAAAAKBAAAAAA         5148  1.1127  0.9632  1.2195  0.6868  0.6413  1.0843  1.1430\n14         cally  AAAAAAAAKBAAAAAA         5148  1.1736  0.9212  1.2624  0.9137  0.7406  1.0873  0.9699\n15         cally  AAAAAAAAKBAAAAAA         5148  1.2565  0.6599  1.4105  1.0744  0.8138  1.0581  0.8374\n16         cally  AAAAAAAAKBAAAAAA         5148  1.6313  0.6824  1.2216  1.0584  0.9714  1.5514  1.3567\n17         cally  AAAAAAAAKBAAAAAA         5148  1.1356  0.7993  1.5341  1.1041  1.0528  1.1315  1.0804\n18         cally  AAAAAAAAKBAAAAAA         5148  1.2048  0.9065  1.6753  0.9678  0.8981  0.9717  1.0489\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018379,
                    "execution_time": 0.007527,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004334
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.079824,
                    "execution_time": 0.008204,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.061792
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_16\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_16\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_16\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0          cally  AAAAAAAAKBAAAAAA         5148  1.9656  0.7046  1.4640  0.7060  0.8090  1.1686  1.1616\n1          cally  AAAAAAAAKBAAAAAA         5148  1.4433  0.5645  1.1555  0.7833  0.8420  1.5284  1.2415\n2          cally  AAAAAAAAKBAAAAAA         5148  0.9315  0.9456  1.6396  0.8280  0.9520  0.8331  1.0343\n3          cally  AAAAAAAAKBAAAAAA         5148  1.4975  0.5022  1.9710  0.9260  0.6756  1.1335  0.8099\n4          cally  AAAAAAAAKBAAAAAA         5148  1.7050  0.9394  1.2605  1.2714  0.6085  0.9105  0.8037\n5          cally  AAAAAAAAKBAAAAAA         5148  1.2227  0.7441  1.7614  0.8093  0.6513  1.0011  0.9931\n6          cally  AAAAAAAAKBAAAAAA         5148  1.0263  0.8066  1.4994  0.8228  0.9686  1.2324  0.9895\n7          cally  AAAAAAAAKBAAAAAA         5148  1.1007  1.0514  1.1877  1.0527  0.7874  0.8583  0.6834\n8          cally  AAAAAAAAKBAAAAAA         5148  1.3277  0.7054  1.3801  1.2589  0.8715  1.1145  0.9824\n9          cally  AAAAAAAAKBAAAAAA         5148  1.5749  1.2586  1.1381  0.8677  0.7435  1.2518  1.3646\n10         cally  AAAAAAAAKBAAAAAA         5148  1.0319  0.6912  1.7753  0.8533  0.6460  1.5712  1.9906\n11         cally  AAAAAAAAKBAAAAAA         5148  1.2054  0.8366  1.2331  0.8125  0.6615  1.1716  1.0261\n12         cally  AAAAAAAAKBAAAAAA         5148  1.1176  0.7334  1.2464  1.0880  0.6502  0.9585  1.0255\n13         cally  AAAAAAAAKBAAAAAA         5148  1.1127  0.9632  1.2195  0.6868  0.6413  1.0843  1.1430\n14         cally  AAAAAAAAKBAAAAAA         5148  1.1736  0.9212  1.2624  0.9137  0.7406  1.0873  0.9699\n15         cally  AAAAAAAAKBAAAAAA         5148  1.2565  0.6599  1.4105  1.0744  0.8138  1.0581  0.8374\n16         cally  AAAAAAAAKBAAAAAA         5148  1.6313  0.6824  1.2216  1.0584  0.9714  1.5514  1.3567\n17         cally  AAAAAAAAKBAAAAAA         5148  1.1356  0.7993  1.5341  1.1041  1.0528  1.1315  1.0804\n18         cally  AAAAAAAAKBAAAAAA         5148  1.2048  0.9065  1.6753  0.9678  0.8981  0.9717  1.0489\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) z\n where y.d_week_seq1 = z.d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"D\" AS ( SELECT \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"WSS\" AS \"WSS_2\" ON \"WSS\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"D\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"_COL_3\" AS \"_COL_3\" , \"_COL_4\" AS \"_COL_4\" , \"_COL_5\" AS \"_COL_5\" , \"_COL_6\" AS \"_COL_6\" , \"_COL_7\" AS \"_COL_7\" , \"_COL_8\" AS \"_COL_8\" , \"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           able  AAAAAAAACFAAAAAA         5144  1.0392  0.5589  1.3252  2.4264  1.9925  1.1106  0.8477\n1           able  AAAAAAAACFAAAAAA         5144  1.0714  0.5746  0.7454  1.6556  1.3232  1.8702  1.0413\n2           able  AAAAAAAACFAAAAAA         5144  1.0041  0.6722  0.9692  1.3838  1.3146  0.7276  0.7191\n3           able  AAAAAAAACFAAAAAA         5144  1.1240  0.8006  1.0164  1.2351  1.2671  1.2157  0.8321\n4           able  AAAAAAAACFAAAAAA         5144  1.0836  1.0490  0.8076  0.8731  1.7725  1.0232  0.8166\n5           able  AAAAAAAACFAAAAAA         5144  0.9090  0.7407  0.8010  1.8780  1.2285  1.1556  0.5868\n6           able  AAAAAAAACFAAAAAA         5144  0.9783  0.7070  1.0222  0.8792  1.4346  0.7376  1.1801\n7           able  AAAAAAAACFAAAAAA         5144  1.6066  0.6259  0.6588  1.1315  1.4802  1.0954  0.7140\n8           able  AAAAAAAACFAAAAAA         5144  1.4698  0.7093  0.5899  1.6881  1.4344  0.9213  1.5782\n9           able  AAAAAAAACFAAAAAA         5144  0.6376  0.6447  0.6553  1.1442  1.4216  0.9465  0.7555\n10          able  AAAAAAAACFAAAAAA         5144  0.9105  0.7957  1.1145  1.1822  1.2706  0.6592  0.9047\n11          able  AAAAAAAACFAAAAAA         5144  0.9252  0.5514  0.9590  0.8068  1.2939  1.1969  0.9440\n12          able  AAAAAAAACFAAAAAA         5144  0.8075  0.5926  0.9508  1.1831  1.4178  1.4260  0.8906\n13          able  AAAAAAAACFAAAAAA         5144  0.6997  0.7489  0.6105  1.2843  1.4295  0.9127  1.2863\n14          able  AAAAAAAACFAAAAAA         5144  1.6138  0.8962  0.8410  1.3644  1.3497  1.1291  0.9122\n15          able  AAAAAAAACFAAAAAA         5144  0.8582  0.9469  1.0883  1.0886  1.4176  1.0109  0.7908\n16          able  AAAAAAAACFAAAAAA         5144  2.2006  0.6773  1.2481  0.6232  1.3481  1.3730  0.7601\n17          able  AAAAAAAACFAAAAAA         5144  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000\n18          able  AAAAAAAACFAAAAAA         5144  0.8405  0.6666  0.8818  0.8940  2.1750  1.5466  0.7770\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019774,
                    "execution_time": 0.008338,
                    "compile_time": 9.7e-05,
                    "planning_time": 0.004368
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018969,
                    "execution_time": 0.00773,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004505
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"D_2\" ON \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"S_STORE_NAME1\" AS \"S_STORE_NAME1\", \"S_STORE_ID1\" AS \"S_STORE_ID1\", \"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\", \"_COL_3\" AS \"_COL_3\", \"_COL_4\" AS \"_COL_4\", \"_COL_5\" AS \"_COL_5\", \"_COL_6\" AS \"_COL_6\", \"_COL_7\" AS \"_COL_7\", \"_COL_8\" AS \"_COL_8\", \"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           able  AAAAAAAACFAAAAAA         5144  1.0392  0.5589  1.3252  2.4264  1.9925  1.1106  0.8477\n1           able  AAAAAAAACFAAAAAA         5144  1.0714  0.5746  0.7454  1.6556  1.3232  1.8702  1.0413\n2           able  AAAAAAAACFAAAAAA         5144  1.0041  0.6722  0.9692  1.3838  1.3146  0.7276  0.7191\n3           able  AAAAAAAACFAAAAAA         5144  1.1240  0.8006  1.0164  1.2351  1.2671  1.2157  0.8321\n4           able  AAAAAAAACFAAAAAA         5144  1.0836  1.0490  0.8076  0.8731  1.7725  1.0232  0.8166\n5           able  AAAAAAAACFAAAAAA         5144  0.9090  0.7407  0.8010  1.8780  1.2285  1.1556  0.5868\n6           able  AAAAAAAACFAAAAAA         5144  0.9783  0.7070  1.0222  0.8792  1.4346  0.7376  1.1801\n7           able  AAAAAAAACFAAAAAA         5144  1.6066  0.6259  0.6588  1.1315  1.4802  1.0954  0.7140\n8           able  AAAAAAAACFAAAAAA         5144  1.4698  0.7093  0.5899  1.6881  1.4344  0.9213  1.5782\n9           able  AAAAAAAACFAAAAAA         5144  0.6376  0.6447  0.6553  1.1442  1.4216  0.9465  0.7555\n10          able  AAAAAAAACFAAAAAA         5144  0.9105  0.7957  1.1145  1.1822  1.2706  0.6592  0.9047\n11          able  AAAAAAAACFAAAAAA         5144  0.9252  0.5514  0.9590  0.8068  1.2939  1.1969  0.9440\n12          able  AAAAAAAACFAAAAAA         5144  0.8075  0.5926  0.9508  1.1831  1.4178  1.4260  0.8906\n13          able  AAAAAAAACFAAAAAA         5144  0.6997  0.7489  0.6105  1.2843  1.4295  0.9127  1.2863\n14          able  AAAAAAAACFAAAAAA         5144  1.6138  0.8962  0.8410  1.3644  1.3497  1.1291  0.9122\n15          able  AAAAAAAACFAAAAAA         5144  0.8582  0.9469  1.0883  1.0886  1.4176  1.0109  0.7908\n16          able  AAAAAAAACFAAAAAA         5144  2.2006  0.6773  1.2481  0.6232  1.3481  1.3730  0.7601\n17          able  AAAAAAAACFAAAAAA         5144  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000  1.0000\n18          able  AAAAAAAACFAAAAAA         5144  0.8405  0.6666  0.8818  0.8940  2.1750  1.5466  0.7770\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182+ 12 and 1182 + 23) x\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" CROSS JOIN \"WSS\" AS \"WSS_2\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_MONTH_SEQ\" <= 1205 AND \"D_2\".\"D_MONTH_SEQ\" >= 1194 AND \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_MONTH_SEQ\" <= 1205 AND \"D_2\".\"D_MONTH_SEQ\" >= 1194 AND \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_MONTH_SEQ\" <= 1205 AND \"D_2\".\"D_MONTH_SEQ\" >= 1194 AND \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0          ought  AAAAAAAABAAAAAAA         5188  0.9973  0.9038  1.0652  0.4415  0.5188  0.7559  0.7151\n1          ought  AAAAAAAABAAAAAAA         5188  0.9973  0.9038  1.0652  0.4415  0.5188  0.7559  0.7151\n2          ought  AAAAAAAABAAAAAAA         5188  0.9973  0.9038  1.0652  0.4415  0.5188  0.7559  0.7151\n3          ought  AAAAAAAABAAAAAAA         5188  0.9973  0.9038  1.0652  0.4415  0.5188  0.7559  0.7151\n4          ought  AAAAAAAABAAAAAAA         5188  0.9973  0.9038  1.0652  0.4415  0.5188  0.7559  0.7151\n5          ought  AAAAAAAABAAAAAAA         5188  0.9973  0.9038  1.0652  0.4415  0.5188  0.7559  0.7151\n6          ought  AAAAAAAABAAAAAAA         5188  0.9973  0.9038  1.0652  0.4415  0.5188  0.7559  0.7151\n7          ought  AAAAAAAABAAAAAAA         5144  0.9840  1.4970  0.4593  0.7811  1.0425  1.2465  1.0038\n8          ought  AAAAAAAABAAAAAAA         5144  0.9840  1.4970  0.4593  0.7811  1.0425  1.2465  1.0038\n9          ought  AAAAAAAABAAAAAAA         5144  0.9840  1.4970  0.4593  0.7811  1.0425  1.2465  1.0038\n10         ought  AAAAAAAABAAAAAAA         5144  0.9840  1.4970  0.4593  0.7811  1.0425  1.2465  1.0038\n11         ought  AAAAAAAABAAAAAAA         5144  0.9840  1.4970  0.4593  0.7811  1.0425  1.2465  1.0038\n12         ought  AAAAAAAABAAAAAAA         5144  0.9840  1.4970  0.4593  0.7811  1.0425  1.2465  1.0038\n13         ought  AAAAAAAABAAAAAAA         5144  0.9840  1.4970  0.4593  0.7811  1.0425  1.2465  1.0038\n14         ought  AAAAAAAABAAAAAAA         5175  1.0649  0.8541     NaN  0.3932  1.0397  0.5835  0.9941\n15         ought  AAAAAAAABAAAAAAA         5175  1.0649  0.8541     NaN  0.3932  1.0397  0.5835  0.9941\n16         ought  AAAAAAAABAAAAAAA         5175  1.0649  0.8541     NaN  0.3932  1.0397  0.5835  0.9941\n17         ought  AAAAAAAABAAAAAAA         5175  1.0649  0.8541     NaN  0.3932  1.0397  0.5835  0.9941\n18         ought  AAAAAAAABAAAAAAA         5175  1.0649  0.8541     NaN  0.3932  1.0397  0.5835  0.9941\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.099701,
                    "execution_time": 0.025234,
                    "compile_time": 0.000311,
                    "planning_time": 0.056824
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 7.665925,
                    "execution_time": 0.026226,
                    "compile_time": 7.493053,
                    "planning_time": 0.129054
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_MONTH_SEQ\" <= 1205 AND \"D_2\".\"D_MONTH_SEQ\" >= 1194 AND \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\"",
                "rewrite": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSS_2\".\"SUN_SALES\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSS_2\".\"MON_SALES\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSS_2\".\"TUE_SALES\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSS_2\".\"WED_SALES\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSS_2\".\"THU_SALES\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSS_2\".\"FRI_SALES\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSS_2\".\"SAT_SALES\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSS_2\" JOIN \"DATE_DIM\" AS \"D_2\" ON \"D_2\".\"D_MONTH_SEQ\" <= 1205 AND \"D_2\".\"D_MONTH_SEQ\" >= 1194 AND \"D_2\".\"D_WEEK_SEQ\" = \"WSS_2\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE_2\" ON \"STORE_2\".\"S_STORE_SK\" = \"WSS_2\".\"SS_STORE_SK\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0          ought  AAAAAAAABAAAAAAA         5188  0.9973  0.9038  1.0652  0.4415  0.5188  0.7559  0.7151\n1          ought  AAAAAAAABAAAAAAA         5188  0.9973  0.9038  1.0652  0.4415  0.5188  0.7559  0.7151\n2          ought  AAAAAAAABAAAAAAA         5188  0.9973  0.9038  1.0652  0.4415  0.5188  0.7559  0.7151\n3          ought  AAAAAAAABAAAAAAA         5188  0.9973  0.9038  1.0652  0.4415  0.5188  0.7559  0.7151\n4          ought  AAAAAAAABAAAAAAA         5188  0.9973  0.9038  1.0652  0.4415  0.5188  0.7559  0.7151\n5          ought  AAAAAAAABAAAAAAA         5188  0.9973  0.9038  1.0652  0.4415  0.5188  0.7559  0.7151\n6          ought  AAAAAAAABAAAAAAA         5188  0.9973  0.9038  1.0652  0.4415  0.5188  0.7559  0.7151\n7          ought  AAAAAAAABAAAAAAA         5144  0.9840  1.4970  0.4593  0.7811  1.0425  1.2465  1.0038\n8          ought  AAAAAAAABAAAAAAA         5144  0.9840  1.4970  0.4593  0.7811  1.0425  1.2465  1.0038\n9          ought  AAAAAAAABAAAAAAA         5144  0.9840  1.4970  0.4593  0.7811  1.0425  1.2465  1.0038\n10         ought  AAAAAAAABAAAAAAA         5144  0.9840  1.4970  0.4593  0.7811  1.0425  1.2465  1.0038\n11         ought  AAAAAAAABAAAAAAA         5144  0.9840  1.4970  0.4593  0.7811  1.0425  1.2465  1.0038\n12         ought  AAAAAAAABAAAAAAA         5144  0.9840  1.4970  0.4593  0.7811  1.0425  1.2465  1.0038\n13         ought  AAAAAAAABAAAAAAA         5144  0.9840  1.4970  0.4593  0.7811  1.0425  1.2465  1.0038\n14         ought  AAAAAAAABAAAAAAA         5175  1.0649  0.8541     NaN  0.3932  1.0397  0.5835  0.9941\n15         ought  AAAAAAAABAAAAAAA         5175  1.0649  0.8541     NaN  0.3932  1.0397  0.5835  0.9941\n16         ought  AAAAAAAABAAAAAAA         5175  1.0649  0.8541     NaN  0.3932  1.0397  0.5835  0.9941\n17         ought  AAAAAAAABAAAAAAA         5175  1.0649  0.8541     NaN  0.3932  1.0397  0.5835  0.9941\n18         ought  AAAAAAAABAAAAAAA         5175  1.0649  0.8541     NaN  0.3932  1.0397  0.5835  0.9941\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182+ 12 and 1182 + 23) x\n where s_store_id1=s_store_id2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"X\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"X\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"X\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"X\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"X\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"X\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"X\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"X\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"X\" AS \"X\" ON \"STORE\".\"S_STORE_ID\" = \"X\".\"S_STORE_ID2\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AS \"S_STORE_ID2\" , \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"SUN_SALES2\" , \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"MON_SALES2\" , \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"TUE_SALES2\" , \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"WED_SALES2\" , \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"THU_SALES2\" , \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"FRI_SALES2\" , \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.139489,
                    "execution_time": 0.045884,
                    "compile_time": 0.000268,
                    "planning_time": 0.004274,
                    "create_size": 297
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.203133,
                    "execution_time": 0.047775,
                    "compile_time": 0.000254,
                    "planning_time": 0.060956,
                    "create_size": 308
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_17\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_17\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_17\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_17\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_17\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_17\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_17\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_17\".\"S_STORE_ID2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.257376,
                    "execution_time": 1.04238,
                    "compile_time": 0.000698,
                    "planning_time": 0.042234,
                    "create_size": 1792
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.327415,
                    "execution_time": 1.048679,
                    "compile_time": 0.000744,
                    "planning_time": 0.112821,
                    "create_size": 1792
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_18\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_18\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_18\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           eing  AAAAAAAAMBAAAAAA         5147  2.2591  2.4113  2.5193  3.0622  2.9284  3.0314  2.8333\n1           eing  AAAAAAAAMBAAAAAA         5147  2.2591  2.4113  2.5193  3.0622  2.9284  3.0314  2.8333\n2           eing  AAAAAAAAMBAAAAAA         5147  2.2591  2.4113  2.5193  3.0622  2.9284  3.0314  2.8333\n3           eing  AAAAAAAAMBAAAAAA         5144  1.4267  2.1186  1.3017  0.9827  1.0741  1.3555  0.7065\n4           eing  AAAAAAAAMBAAAAAA         5144  1.4267  2.1186  1.3017  0.9827  1.0741  1.3555  0.7065\n5           eing  AAAAAAAAMBAAAAAA         5144  1.4267  2.1186  1.3017  0.9827  1.0741  1.3555  0.7065\n6           eing  AAAAAAAAMBAAAAAA         5144  1.4267  2.1186  1.3017  0.9827  1.0741  1.3555  0.7065\n7           eing  AAAAAAAAMBAAAAAA         5144  1.4267  2.1186  1.3017  0.9827  1.0741  1.3555  0.7065\n8           eing  AAAAAAAAMBAAAAAA         5144  1.4267  2.1186  1.3017  0.9827  1.0741  1.3555  0.7065\n9           eing  AAAAAAAAMBAAAAAA         5144  1.4267  2.1186  1.3017  0.9827  1.0741  1.3555  0.7065\n10          eing  AAAAAAAAMBAAAAAA         5170  1.1297  0.8779  1.6546  1.7970  1.7562  0.8547  1.4552\n11          eing  AAAAAAAAMBAAAAAA         5170  1.1297  0.8779  1.6546  1.7970  1.7562  0.8547  1.4552\n12          eing  AAAAAAAAMBAAAAAA         5170  1.1297  0.8779  1.6546  1.7970  1.7562  0.8547  1.4552\n13          eing  AAAAAAAAMBAAAAAA         5170  1.1297  0.8779  1.6546  1.7970  1.7562  0.8547  1.4552\n14          eing  AAAAAAAAMBAAAAAA         5170  1.1297  0.8779  1.6546  1.7970  1.7562  0.8547  1.4552\n15          eing  AAAAAAAAMBAAAAAA         5170  1.1297  0.8779  1.6546  1.7970  1.7562  0.8547  1.4552\n16          eing  AAAAAAAAMBAAAAAA         5170  1.1297  0.8779  1.6546  1.7970  1.7562  0.8547  1.4552\n17          eing  AAAAAAAAMBAAAAAA         5182  0.9517  1.0833  1.2156  0.9556  1.2661  0.6329  0.6926\n18          eing  AAAAAAAAMBAAAAAA         5182  0.9517  1.0833  1.2156  0.9556  1.2661  0.6329  0.6926\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019048,
                    "execution_time": 0.00769,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.0046
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05815,
                    "execution_time": 0.007972,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.040396
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_17\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_17\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_17\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_17\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_17\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_17\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_17\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_17\".\"S_STORE_ID2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_18\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_18\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_18\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_18\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           eing  AAAAAAAAMBAAAAAA         5147  2.2591  2.4113  2.5193  3.0622  2.9284  3.0314  2.8333\n1           eing  AAAAAAAAMBAAAAAA         5147  2.2591  2.4113  2.5193  3.0622  2.9284  3.0314  2.8333\n2           eing  AAAAAAAAMBAAAAAA         5147  2.2591  2.4113  2.5193  3.0622  2.9284  3.0314  2.8333\n3           eing  AAAAAAAAMBAAAAAA         5144  1.4267  2.1186  1.3017  0.9827  1.0741  1.3555  0.7065\n4           eing  AAAAAAAAMBAAAAAA         5144  1.4267  2.1186  1.3017  0.9827  1.0741  1.3555  0.7065\n5           eing  AAAAAAAAMBAAAAAA         5144  1.4267  2.1186  1.3017  0.9827  1.0741  1.3555  0.7065\n6           eing  AAAAAAAAMBAAAAAA         5144  1.4267  2.1186  1.3017  0.9827  1.0741  1.3555  0.7065\n7           eing  AAAAAAAAMBAAAAAA         5144  1.4267  2.1186  1.3017  0.9827  1.0741  1.3555  0.7065\n8           eing  AAAAAAAAMBAAAAAA         5144  1.4267  2.1186  1.3017  0.9827  1.0741  1.3555  0.7065\n9           eing  AAAAAAAAMBAAAAAA         5144  1.4267  2.1186  1.3017  0.9827  1.0741  1.3555  0.7065\n10          eing  AAAAAAAAMBAAAAAA         5170  1.1297  0.8779  1.6546  1.7970  1.7562  0.8547  1.4552\n11          eing  AAAAAAAAMBAAAAAA         5170  1.1297  0.8779  1.6546  1.7970  1.7562  0.8547  1.4552\n12          eing  AAAAAAAAMBAAAAAA         5170  1.1297  0.8779  1.6546  1.7970  1.7562  0.8547  1.4552\n13          eing  AAAAAAAAMBAAAAAA         5170  1.1297  0.8779  1.6546  1.7970  1.7562  0.8547  1.4552\n14          eing  AAAAAAAAMBAAAAAA         5170  1.1297  0.8779  1.6546  1.7970  1.7562  0.8547  1.4552\n15          eing  AAAAAAAAMBAAAAAA         5170  1.1297  0.8779  1.6546  1.7970  1.7562  0.8547  1.4552\n16          eing  AAAAAAAAMBAAAAAA         5170  1.1297  0.8779  1.6546  1.7970  1.7562  0.8547  1.4552\n17          eing  AAAAAAAAMBAAAAAA         5182  0.9517  1.0833  1.2156  0.9556  1.2661  0.6329  0.6926\n18          eing  AAAAAAAAMBAAAAAA         5182  0.9517  1.0833  1.2156  0.9556  1.2661  0.6329  0.6926\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182+ 12 and 1182 + 23) x\n where s_store_id1=s_store_id2\n   and d_week_seq1=d_week_seq2-52\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"X\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"X\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"X\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"X\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"X\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"X\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"X\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"X\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"X\" AS \"X\" ON \"STORE\".\"S_STORE_ID\" = \"X\".\"S_STORE_ID2\" AND \"WSS\".\"D_WEEK_SEQ\" = \"X\".\"D_WEEK_SEQ2\" - 52"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\" - 52",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.769238,
                    "execution_time": 0.150058,
                    "compile_time": 0.042709,
                    "planning_time": 0.045034,
                    "create_size": 1664
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.206091,
                    "execution_time": 0.147697,
                    "compile_time": 3.40681,
                    "planning_time": 0.114015,
                    "create_size": 1664
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_19\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0            pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n1            pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n2            pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n3            pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n4            pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n5            pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n6            pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n7            pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n8            pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n9            pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n10           pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n11           pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n12         cally  AAAAAAAAKBAAAAAA         5187  0.6908  0.9018  2.3427  1.3698  0.7326  2.6734  1.3081\n13         cally  AAAAAAAAKBAAAAAA         5187  0.6908  0.9018  2.3427  1.3698  0.7326  2.6734  1.3081\n14         cally  AAAAAAAAKBAAAAAA         5187  0.6908  0.9018  2.3427  1.3698  0.7326  2.6734  1.3081\n15         cally  AAAAAAAAKBAAAAAA         5187  0.6908  0.9018  2.3427  1.3698  0.7326  2.6734  1.3081\n16         cally  AAAAAAAAKBAAAAAA         5187  0.6908  0.9018  2.3427  1.3698  0.7326  2.6734  1.3081\n17         cally  AAAAAAAAKBAAAAAA         5187  0.6908  0.9018  2.3427  1.3698  0.7326  2.6734  1.3081\n18         cally  AAAAAAAAKBAAAAAA         5187  0.6908  0.9018  2.3427  1.3698  0.7326  2.6734  1.3081\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01876,
                    "execution_time": 0.007432,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004563
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05679,
                    "execution_time": 0.008041,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.040317
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\" - 52",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_19\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\""
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0            pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n1            pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n2            pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n3            pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n4            pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n5            pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n6            pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n7            pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n8            pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n9            pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n10           pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n11           pri  AAAAAAAANAAAAAAA         5187  0.3978  0.8647  0.6973  1.2116  1.2393  0.7473  0.9682\n12         cally  AAAAAAAAKBAAAAAA         5187  0.6908  0.9018  2.3427  1.3698  0.7326  2.6734  1.3081\n13         cally  AAAAAAAAKBAAAAAA         5187  0.6908  0.9018  2.3427  1.3698  0.7326  2.6734  1.3081\n14         cally  AAAAAAAAKBAAAAAA         5187  0.6908  0.9018  2.3427  1.3698  0.7326  2.6734  1.3081\n15         cally  AAAAAAAAKBAAAAAA         5187  0.6908  0.9018  2.3427  1.3698  0.7326  2.6734  1.3081\n16         cally  AAAAAAAAKBAAAAAA         5187  0.6908  0.9018  2.3427  1.3698  0.7326  2.6734  1.3081\n17         cally  AAAAAAAAKBAAAAAA         5187  0.6908  0.9018  2.3427  1.3698  0.7326  2.6734  1.3081\n18         cally  AAAAAAAAKBAAAAAA         5187  0.6908  0.9018  2.3427  1.3698  0.7326  2.6734  1.3081\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182+ 12 and 1182 + 23) x\n where s_store_id1=s_store_id2\n   and d_week_seq1=d_week_seq2-52\n order by s_store_name1,s_store_id1,d_week_seq1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"X\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"X\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"X\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"X\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"X\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"X\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"X\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"X\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"X\" AS \"X\" ON \"STORE\".\"S_STORE_ID\" = \"X\".\"S_STORE_ID2\" AND \"WSS\".\"D_WEEK_SEQ\" = \"X\".\"D_WEEK_SEQ2\" - 52 ORDER BY \"S_STORE_NAME1\" NULLS LAST , \"S_STORE_ID1\" NULLS LAST , \"D_WEEK_SEQ1\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_19\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ORDER BY \"S_STORE_NAME1\" , \"S_STORE_ID1\" , \"D_WEEK_SEQ1\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n1           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n2           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n3           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n4           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n5           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n6           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n7           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n8           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n9           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n10          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n11          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n12          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n13          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n14          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n15          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n16          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n17          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n18          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.02302,
                    "execution_time": 0.011061,
                    "compile_time": 8.3e-05,
                    "planning_time": 0.004989
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060571,
                    "execution_time": 0.011657,
                    "compile_time": 8.5e-05,
                    "planning_time": 0.040278
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\" - 52 ORDER BY \"S_STORE_NAME1\" NULLS LAST , \"S_STORE_ID1\" NULLS LAST , \"D_WEEK_SEQ1\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_19\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ORDER BY \"S_STORE_NAME1\" NULLS LAST , \"S_STORE_ID1\" NULLS LAST , \"D_WEEK_SEQ1\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n1           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n2           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n3           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n4           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n5           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n6           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n7           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n8           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n9           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n10          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n11          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n12          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n13          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n14          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n15          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n16          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n17          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n18          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n...*/"
    },
    {
        "input": "-- start template query59.tpl query 30 in stream 0\nwith /* TPC-DS query59.tpl 0.30 */ wss as \n (select d_week_seq,\n        ss_store_sk,\n        sum(case when (d_day_name='Sunday') then ss_sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then ss_sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then ss_sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then ss_sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then ss_sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then ss_sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then ss_sales_price else null end) sat_sales\n from store_sales,date_dim\n where d_date_sk = ss_sold_date_sk\n group by d_week_seq,ss_store_sk\n )\n  select  s_store_name1,s_store_id1,d_week_seq1\n       ,sun_sales1/sun_sales2,mon_sales1/mon_sales2\n       ,tue_sales1/tue_sales2,wed_sales1/wed_sales2,thu_sales1/thu_sales2\n       ,fri_sales1/fri_sales2,sat_sales1/sat_sales2\n from\n (select s_store_name s_store_name1,wss.d_week_seq d_week_seq1\n        ,s_store_id s_store_id1,sun_sales sun_sales1\n        ,mon_sales mon_sales1,tue_sales tue_sales1\n        ,wed_sales wed_sales1,thu_sales thu_sales1\n        ,fri_sales fri_sales1,sat_sales sat_sales1\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182 and 1182 + 11) y,\n (select s_store_name s_store_name2,wss.d_week_seq d_week_seq2\n        ,s_store_id s_store_id2,sun_sales sun_sales2\n        ,mon_sales mon_sales2,tue_sales tue_sales2\n        ,wed_sales wed_sales2,thu_sales thu_sales2\n        ,fri_sales fri_sales2,sat_sales sat_sales2\n  from wss,store,date_dim d\n  where d.d_week_seq = wss.d_week_seq and\n        ss_store_sk = s_store_sk and \n        d_month_seq between 1182+ 12 and 1182 + 23) x\n where s_store_id1=s_store_id2\n   and d_week_seq1=d_week_seq2-52\n order by s_store_name1,s_store_id1,d_week_seq1\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"STORE_SALES\".\"SS_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"X\" AS ( SELECT \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID2\" , \"WSS\".\"SUN_SALES\" AS \"SUN_SALES2\" , \"WSS\".\"MON_SALES\" AS \"MON_SALES2\" , \"WSS\".\"TUE_SALES\" AS \"TUE_SALES2\" , \"WSS\".\"WED_SALES\" AS \"WED_SALES2\" , \"WSS\".\"THU_SALES\" AS \"THU_SALES2\" , \"WSS\".\"FRI_SALES\" AS \"FRI_SALES2\" , \"WSS\".\"SAT_SALES\" AS \"SAT_SALES2\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1205 AND \"D\".\"D_MONTH_SEQ\" >= 1194 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"WSS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSS\".\"SUN_SALES\" / \"X\".\"SUN_SALES2\" AS \"_COL_3\" , \"WSS\".\"MON_SALES\" / \"X\".\"MON_SALES2\" AS \"_COL_4\" , \"WSS\".\"TUE_SALES\" / \"X\".\"TUE_SALES2\" AS \"_COL_5\" , \"WSS\".\"WED_SALES\" / \"X\".\"WED_SALES2\" AS \"_COL_6\" , \"WSS\".\"THU_SALES\" / \"X\".\"THU_SALES2\" AS \"_COL_7\" , \"WSS\".\"FRI_SALES\" / \"X\".\"FRI_SALES2\" AS \"_COL_8\" , \"WSS\".\"SAT_SALES\" / \"X\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"WSS\" AS \"WSS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"WSS\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"WSS\".\"SS_STORE_SK\" JOIN \"X\" AS \"X\" ON \"STORE\".\"S_STORE_ID\" = \"X\".\"S_STORE_ID2\" AND \"WSS\".\"D_WEEK_SEQ\" = \"X\".\"D_WEEK_SEQ2\" - 52 ORDER BY \"S_STORE_NAME1\" NULLS LAST , \"S_STORE_ID1\" NULLS LAST , \"D_WEEK_SEQ1\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_19\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ORDER BY \"S_STORE_NAME1\" , \"S_STORE_ID1\" , \"D_WEEK_SEQ1\" LIMIT 21",
                "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n1           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n2           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n3           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n4           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n5           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n6           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n7           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n8           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n9           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n10          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n11          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n12          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n13          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n14          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n15          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n16          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n17          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n18          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.023476,
                    "execution_time": 0.011636,
                    "compile_time": 8.2e-05,
                    "planning_time": 0.004997
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.023848,
                    "execution_time": 0.011509,
                    "compile_time": 8.9e-05,
                    "planning_time": 0.005041
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME1\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES2\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES2\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES2\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES2\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES2\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES2\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES2\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_MONTH_SEQ\" <= 1193 AND \"D\".\"D_MONTH_SEQ\" >= 1182 AND \"D\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"STORE\".\"S_STORE_ID\" = \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_ID2\" AND \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ2\" - 52 ORDER BY \"S_STORE_NAME1\" NULLS LAST , \"S_STORE_ID1\" NULLS LAST , \"D_WEEK_SEQ1\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"S_STORE_NAME1\" AS \"S_STORE_NAME1\" , \"SPEQLITE_TEMP_TABLE_19\".\"S_STORE_ID1\" AS \"S_STORE_ID1\" , \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_8\" AS \"_COL_8\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_9\" AS \"_COL_9\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ORDER BY \"S_STORE_NAME1\" NULLS LAST , \"S_STORE_ID1\" NULLS LAST , \"D_WEEK_SEQ1\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   s_store_name1       s_store_id1  d_week_seq1  _col_3  _col_4  _col_5  _col_6  _col_7  _col_8  _col_9\n0           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n1           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n2           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n3           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n4           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n5           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n6           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n7           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n8           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n9           able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n10          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n11          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n12          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n13          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n14          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n15          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n16          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n17          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n18          able  AAAAAAAAACAAAAAA         5140  0.9626  0.8583  0.9358  0.3833  1.2296  1.2884  1.0094\n...*/"
    }
]