[
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  c.C_CURRENT_CDEMO_SK as cd_gender,\n  c.C_CURRENT_CDEMO_SK as cd_marital_status,\n  c.C_CURRENT_CDEMO_SK as cd_education_status,\n  count(*) as cnt1,\n  c.C_CURRENT_CDEMO_SK as cd_purchase_estimate,\n  count(*) as cnt2,\n  c.C_CURRENT_CDEMO_SK as cd_credit_rating,\n  count(*) as cnt3,\n  c.C_CURRENT_CDEMO_SK as cd_dep_count,\n  count(*) as cnt4,\n  c.C_CURRENT_CDEMO_SK as cd_dep_employed_count,\n  count(*) as cnt5,\n  c.C_CURRENT_CDEMO_SK as cd_dep_college_count,\n  count(*) as cnt6\n from\n  customer c\n where\n  c.C_CURRENT_ADDR_SK IS NOT NULL and\n  exists (select *\n          from customer\n          where c.C_CUSTOMER_SK = C_CUSTOMER_SK) and\n   (exists (select *\n            from customer\n            where c.C_CUSTOMER_SK = C_CUSTOMER_SK) or \n    exists (select * \n            from customer\n            where c.C_CUSTOMER_SK = C_CUSTOMER_SK))\ngroup by c.C_CURRENT_CDEMO_SK\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" FROM \"CUSTOMER\" AS \"CUSTOMER\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_SK\" ) SELECT \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_GENDER\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_MARITAL_STATUS\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_0\" AS \"_U_1\" ON \"_U_1\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" WHERE NOT \"_U_0\".\"C_CUSTOMER_SK\" IS NULL AND ( NOT \"_U_1\".\"C_CUSTOMER_SK\" IS NULL OR NOT \"_U_2\".\"C_CUSTOMER_SK\" IS NULL ) AND NOT \"C\".\"C_CURRENT_ADDR_SK\" IS NULL GROUP BY \"C\".\"C_CURRENT_CDEMO_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" FROM \"CUSTOMER\" AS \"CUSTOMER\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.270167,
                    "execution_time": 0.188333,
                    "compile_time": 0.000272,
                    "planning_time": 0.024999,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.347981,
                    "execution_time": 0.193643,
                    "compile_time": 0.00026,
                    "planning_time": 0.092841,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_GENDER\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_MARITAL_STATUS\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"_U_1\" ON \"_U_1\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"_U_2\" ON \"_U_2\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"C_CUSTOMER_SK\" IS NULL AND ( NOT \"_U_1\".\"C_CUSTOMER_SK\" IS NULL OR NOT \"_U_2\".\"C_CUSTOMER_SK\" IS NULL ) GROUP BY \"C\".\"C_CURRENT_CDEMO_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.41703,
                    "execution_time": 0.757477,
                    "compile_time": 0.000876,
                    "planning_time": 0.036451,
                    "create_size": 2176
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.017801,
                    "execution_time": 1.287663,
                    "compile_time": 0.000896,
                    "planning_time": 0.100518,
                    "create_size": 2176
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    cd_gender  cd_marital_status  cd_education_status  cnt1  cd_purchase_estimate  cnt2  cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0     1474420            1474420              1474420     3               1474420     3           1474420     3       1474420     3                1474420     3               1474420     3\n1     1740200            1740200              1740200     1               1740200     1           1740200     1       1740200     1                1740200     1               1740200     1\n2     1919314            1919314              1919314     2               1919314     2           1919314     2       1919314     2                1919314     2               1919314     2\n3     1012731            1012731              1012731     1               1012731     1           1012731     1       1012731     1                1012731     1               1012731     1\n4      201505             201505               201505     1                201505     1            201505     1        201505     1                 201505     1                201505     1\n5     1218016            1218016              1218016     1               1218016     1           1218016     1       1218016     1                1218016     1               1218016     1\n6     1425372            1425372              1425372     3               1425372     3           1425372     3       1425372     3                1425372     3               1425372     3\n7     1402439            1402439              1402439     2               1402439     2           1402439     2       1402439     2                1402439     2               1402439     2\n8      343595             343595               343595     1                343595     1            343595     1        343595     1                 343595     1                343595     1\n9     1411866            1411866              1411866     1               1411866     1           1411866     1       1411866     1                1411866     1               1411866     1\n10    1699349            1699349              1699349     1               1699349     1           1699349     1       1699349     1                1699349     1               1699349     1\n11    1817126            1817126              1817126     1               1817126     1           1817126     1       1817126     1                1817126     1               1817126     1\n12    1247670            1247670              1247670     2               1247670     2           1247670     2       1247670     2                1247670     2               1247670     2\n13    1307255            1307255              1307255     1               1307255     1           1307255     1       1307255     1                1307255     1               1307255     1\n14    1312042            1312042              1312042     2               1312042     2           1312042     2       1312042     2                1312042     2               1312042     2\n15    1521567            1521567              1521567     2               1521567     2           1521567     2       1521567     2                1521567     2               1521567     2\n16     679745             679745               679745     1                679745     1            679745     1        679745     1                 679745     1                679745     1\n17     514964             514964               514964     1                514964     1            514964     1        514964     1                 514964     1                514964     1\n18     190673             190673               190673     1                190673     1            190673     1        190673     1                 190673     1                190673     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020711,
                    "execution_time": 0.008114,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.005283
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.059311,
                    "execution_time": 0.008212,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.041238
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_GENDER\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_MARITAL_STATUS\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"C\".\"C_CURRENT_CDEMO_SK\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"_U_1\" ON \"_U_1\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"_U_2\" ON \"_U_2\".\"C_CUSTOMER_SK\" = \"C\".\"C_CUSTOMER_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"C_CUSTOMER_SK\" IS NULL AND ( NOT \"_U_1\".\"C_CUSTOMER_SK\" IS NULL OR NOT \"_U_2\".\"C_CUSTOMER_SK\" IS NULL ) AND NOT \"C\".\"C_CURRENT_ADDR_SK\" IS NULL GROUP BY \"C\".\"C_CURRENT_CDEMO_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_2\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    cd_gender  cd_marital_status  cd_education_status  cnt1  cd_purchase_estimate  cnt2  cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0     1474420            1474420              1474420     3               1474420     3           1474420     3       1474420     3                1474420     3               1474420     3\n1     1740200            1740200              1740200     1               1740200     1           1740200     1       1740200     1                1740200     1               1740200     1\n2     1919314            1919314              1919314     2               1919314     2           1919314     2       1919314     2                1919314     2               1919314     2\n3     1012731            1012731              1012731     1               1012731     1           1012731     1       1012731     1                1012731     1               1012731     1\n4      201505             201505               201505     1                201505     1            201505     1        201505     1                 201505     1                201505     1\n5     1218016            1218016              1218016     1               1218016     1           1218016     1       1218016     1                1218016     1               1218016     1\n6     1425372            1425372              1425372     3               1425372     3           1425372     3       1425372     3                1425372     3               1425372     3\n7     1402439            1402439              1402439     2               1402439     2           1402439     2       1402439     2                1402439     2               1402439     2\n8      343595             343595               343595     1                343595     1            343595     1        343595     1                 343595     1                343595     1\n9     1411866            1411866              1411866     1               1411866     1           1411866     1       1411866     1                1411866     1               1411866     1\n10    1699349            1699349              1699349     1               1699349     1           1699349     1       1699349     1                1699349     1               1699349     1\n11    1817126            1817126              1817126     1               1817126     1           1817126     1       1817126     1                1817126     1               1817126     1\n12    1247670            1247670              1247670     2               1247670     2           1247670     2       1247670     2                1247670     2               1247670     2\n13    1307255            1307255              1307255     1               1307255     1           1307255     1       1307255     1                1307255     1               1307255     1\n14    1312042            1312042              1312042     2               1312042     2           1312042     2       1312042     2                1312042     2               1312042     2\n15    1521567            1521567              1521567     2               1521567     2           1521567     2       1521567     2                1521567     2               1521567     2\n16     679745             679745               679745     1                679745     1            679745     1        679745     1                 679745     1                679745     1\n17     514964             514964               514964     1                514964     1            514964     1        514964     1                 514964     1                514964     1\n18     190673             190673               190673     1                190673     1            190673     1        190673     1                 190673     1                190673     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\nfrom\n  customer c, customer_address ca, customer_demographics cd\nwhere\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca.ca_county in ('Chautauqua County', 'Cherokee County', 'Bell County', 'Washington County', 'Clarke County') and\n  cd.cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales ss, date_dim d\n          where c.c_customer_sk = ss.ss_customer_sk and\n                ss.ss_sold_date_sk = d.d_date_sk and\n                d.d_year = 2000 and\n                d.d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales ws, date_dim d\n            where c.c_customer_sk = ws.ws_bill_customer_sk and\n                  ws.ws_sold_date_sk = d.d_date_sk and\n                  d.d_year = 2000 and\n                  d.d_moy between 2 and 2+3) or \n    exists (select * \n            from catalog_sales cs, date_dim d\n            where c.c_customer_sk = cs.cs_ship_customer_sk and\n                  cs.cs_sold_date_sk = d.d_date_sk and\n                  d.d_year = 2000 and\n                  d.d_moy between 2 and 2+3))\ngroup by \n  cd_gender, \n  cd_marital_status, \n  cd_education_status, \n  cd_purchase_estimate, \n  cd_credit_rating, \n  cd_dep_count, \n  cd_dep_employed_count, \n  cd_dep_college_count \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"D\" AS ( SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"D\".\"D_DATE\" AS \"D_DATE\" , \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"D\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"D\".\"D_YEAR\" AS \"D_YEAR\" , \"D\".\"D_DOW\" AS \"D_DOW\" , \"D\".\"D_MOY\" AS \"D_MOY\" , \"D\".\"D_DOM\" AS \"D_DOM\" , \"D\".\"D_QOY\" AS \"D_QOY\" , \"D\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"D\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"D\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"D\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"D\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"D\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"D\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"D\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"D\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"D\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"D\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"D\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"D\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"D\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"D\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"D\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"D\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MOY\" <= 5 AND \"D\".\"D_MOY\" >= 2 AND \"D\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" GROUP BY \"SS\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" GROUP BY \"WS\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"D\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\" GROUP BY \"CS\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"D\".\"D_DATE\" AS \"D_DATE\" , \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"D\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"D\".\"D_YEAR\" AS \"D_YEAR\" , \"D\".\"D_DOW\" AS \"D_DOW\" , \"D\".\"D_MOY\" AS \"D_MOY\" , \"D\".\"D_DOM\" AS \"D_DOM\" , \"D\".\"D_QOY\" AS \"D_QOY\" , \"D\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"D\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"D\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"D\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"D\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"D\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"D\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"D\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"D\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"D\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"D\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"D\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"D\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"D\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"D\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"D\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"D\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MOY\" <= 5 AND \"D\".\"D_MOY\" >= 2",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.221393,
                    "execution_time": 0.058849,
                    "compile_time": 0.000317,
                    "planning_time": 0.030318,
                    "create_size": 1116
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.061453,
                    "execution_time": 2.834624,
                    "compile_time": 0.000342,
                    "planning_time": 0.093548,
                    "create_size": 1116
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" GROUP BY \"SS\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.277764,
                    "execution_time": 0.176442,
                    "compile_time": 0.000322,
                    "planning_time": 0.027193,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.349491,
                    "execution_time": 0.177784,
                    "compile_time": 0.000355,
                    "planning_time": 0.092258,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" GROUP BY \"WS\".\"WS_BILL_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.142057,
                    "execution_time": 0.063882,
                    "compile_time": 0.00033,
                    "planning_time": 0.02876,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.213276,
                    "execution_time": 0.066668,
                    "compile_time": 0.000328,
                    "planning_time": 0.09351,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"SPEQLITE_TEMP_TABLE_3\".\"D_DATE_SK\" GROUP BY \"CS\".\"CS_SHIP_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.200738,
                    "execution_time": 0.098468,
                    "compile_time": 0.000325,
                    "planning_time": 0.028628,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.263571,
                    "execution_time": 1.082382,
                    "compile_time": 0.000334,
                    "planning_time": 0.091522,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_4\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_5\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_6\".\"_U_5\" IS NULL ) GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.183989,
                    "execution_time": 0.08574,
                    "compile_time": 0.00063,
                    "planning_time": 0.05042,
                    "create_size": 136
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.567202,
                    "execution_time": 3.386744,
                    "compile_time": 0.0048,
                    "planning_time": 0.123193,
                    "create_size": 136
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 W             Unknown     1                  1500     1             Good     1             1     1                      0     1                     1     1\n1          F                 W             Primary     1                  1000     1        High Risk     1             4     1                      3     1                     4     1\n2          M                 D         2 yr Degree     1                  8000     1          Unknown     1             1     1                      1     1                     2     1\n3          F                 W             Unknown     1                  8500     1             Good     1             0     1                      3     1                     2     1\n4          F                 U             Primary     1                  9000     1        High Risk     1             1     1                      1     1                     6     1\n5          M                 S             College     1                  7500     1          Unknown     1             0     1                      2     1                     5     1\n6          M                 D     Advanced Degree     1                  2000     1        High Risk     1             1     1                      2     1                     0     1\n7          M                 D           Secondary     1                  8000     1          Unknown     1             5     1                      2     1                     1     1\n8          F                 D           Secondary     1                  8000     1         Low Risk     1             1     1                      6     1                     1     1\n9          M                 U             Primary     1                  7500     1          Unknown     1             6     1                      1     1                     4     1\n10         F                 W             Primary     1                  3500     1          Unknown     1             5     1                      5     1                     2     1\n11         F                 D         2 yr Degree     1                  3000     1             Good     1             5     1                      4     1                     3     1\n12         F                 M         2 yr Degree     1                  8500     1         Low Risk     1             2     1                      4     1                     0     1\n13         M                 W           Secondary     1                  4500     1          Unknown     1             4     1                      4     1                     5     1\n14         F                 S           Secondary     1                  4500     1          Unknown     1             0     1                      3     1                     5     1\n15         F                 W     Advanced Degree     1                  5500     1         Low Risk     1             2     1                      1     1                     6     1\n16         F                 U             College     1                  6000     1             Good     1             3     1                      2     1                     3     1\n17         F                 S     Advanced Degree     1                  2500     1         Low Risk     1             0     1                      0     1                     2     1\n18         F                 D     Advanced Degree     1                  6500     1          Unknown     1             3     1                      6     1                     2     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019858,
                    "execution_time": 0.007892,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.005072
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058761,
                    "execution_time": 0.007958,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.041087
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_4\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_5\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_6\".\"_U_5\" IS NULL ) GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_7\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 W             Unknown     1                  1500     1             Good     1             1     1                      0     1                     1     1\n1          F                 W             Primary     1                  1000     1        High Risk     1             4     1                      3     1                     4     1\n2          M                 D         2 yr Degree     1                  8000     1          Unknown     1             1     1                      1     1                     2     1\n3          F                 W             Unknown     1                  8500     1             Good     1             0     1                      3     1                     2     1\n4          F                 U             Primary     1                  9000     1        High Risk     1             1     1                      1     1                     6     1\n5          M                 S             College     1                  7500     1          Unknown     1             0     1                      2     1                     5     1\n6          M                 D     Advanced Degree     1                  2000     1        High Risk     1             1     1                      2     1                     0     1\n7          M                 D           Secondary     1                  8000     1          Unknown     1             5     1                      2     1                     1     1\n8          F                 D           Secondary     1                  8000     1         Low Risk     1             1     1                      6     1                     1     1\n9          M                 U             Primary     1                  7500     1          Unknown     1             6     1                      1     1                     4     1\n10         F                 W             Primary     1                  3500     1          Unknown     1             5     1                      5     1                     2     1\n11         F                 D         2 yr Degree     1                  3000     1             Good     1             5     1                      4     1                     3     1\n12         F                 M         2 yr Degree     1                  8500     1         Low Risk     1             2     1                      4     1                     0     1\n13         M                 W           Secondary     1                  4500     1          Unknown     1             4     1                      4     1                     5     1\n14         F                 S           Secondary     1                  4500     1          Unknown     1             0     1                      3     1                     5     1\n15         F                 W     Advanced Degree     1                  5500     1         Low Risk     1             2     1                      1     1                     6     1\n16         F                 U             College     1                  6000     1             Good     1             3     1                      2     1                     3     1\n17         F                 S     Advanced Degree     1                  2500     1         Low Risk     1             0     1                      0     1                     2     1\n18         F                 D     Advanced Degree     1                  6500     1          Unknown     1             3     1                      6     1                     2     1\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating, cd_dep_count, cd_dep_employed_count, cd_dep_college_count \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.221387,
                    "execution_time": 0.059355,
                    "compile_time": 0.000328,
                    "planning_time": 0.031028,
                    "create_size": 1116
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.282673,
                    "execution_time": 0.058274,
                    "compile_time": 0.000318,
                    "planning_time": 0.091943,
                    "create_size": 1116
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.279829,
                    "execution_time": 0.176655,
                    "compile_time": 0.000351,
                    "planning_time": 0.028152,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.339325,
                    "execution_time": 0.176189,
                    "compile_time": 0.000322,
                    "planning_time": 0.0894,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.14325,
                    "execution_time": 0.065753,
                    "compile_time": 0.00045,
                    "planning_time": 0.028502,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.205397,
                    "execution_time": 0.064965,
                    "compile_time": 0.000332,
                    "planning_time": 0.091403,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.198885,
                    "execution_time": 0.096466,
                    "compile_time": 0.000339,
                    "planning_time": 0.029005,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.260828,
                    "execution_time": 0.096221,
                    "compile_time": 0.000325,
                    "planning_time": 0.09087,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_10\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_11\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.18654,
                    "execution_time": 0.089401,
                    "compile_time": 0.000617,
                    "planning_time": 0.050023,
                    "create_size": 136
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.257279,
                    "execution_time": 0.087697,
                    "compile_time": 0.000623,
                    "planning_time": 0.120922,
                    "create_size": 136
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 S         4 yr Degree     1                  9000     1         Low Risk     1             1     1                      5     1                     2     1\n1          M                 W         2 yr Degree     1                  9500     1         Low Risk     1             6     1                      5     1                     0     1\n2          M                 U             College     1                  1000     1        High Risk     1             3     1                      0     1                     1     1\n3          M                 M         2 yr Degree     1                   500     1        High Risk     1             2     1                      4     1                     4     1\n4          M                 M         2 yr Degree     1                  4500     1         Low Risk     1             4     1                      5     1                     1     1\n5          F                 U             College     1                  4500     1          Unknown     1             0     1                      1     1                     6     1\n6          M                 D         2 yr Degree     1                  1000     1             Good     1             6     1                      1     1                     6     1\n7          M                 D         4 yr Degree     1                  4500     1         Low Risk     1             5     1                      6     1                     4     1\n8          F                 W             Unknown     1                  3500     1        High Risk     1             2     1                      3     1                     3     1\n9          M                 S             Unknown     1                  6500     1             Good     1             3     1                      1     1                     0     1\n10         F                 D         2 yr Degree     1                   500     1         Low Risk     1             4     1                      3     1                     3     1\n11         F                 S           Secondary     1                  2000     1        High Risk     1             2     1                      3     1                     5     1\n12         M                 W             College     1                  7000     1          Unknown     1             4     1                      5     1                     6     1\n13         F                 U           Secondary     1                  1000     1          Unknown     1             3     1                      3     1                     5     1\n14         F                 W           Secondary     1                  8000     1             Good     1             6     1                      2     1                     6     1\n15         F                 D     Advanced Degree     1                  6500     1             Good     1             3     1                      3     1                     1     1\n16         M                 M         4 yr Degree     1                  3000     1        High Risk     1             4     1                      1     1                     3     1\n17         F                 M             Primary     1                  2000     1          Unknown     1             1     1                      2     1                     6     1\n18         F                 M         4 yr Degree     1                  8000     1             Good     1             0     1                      1     1                     4     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01922,
                    "execution_time": 0.007308,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.005087
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055612,
                    "execution_time": 0.007623,
                    "compile_time": 6.8e-05,
                    "planning_time": 0.041048
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_10\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_11\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 S         4 yr Degree     1                  9000     1         Low Risk     1             1     1                      5     1                     2     1\n1          M                 W         2 yr Degree     1                  9500     1         Low Risk     1             6     1                      5     1                     0     1\n2          M                 U             College     1                  1000     1        High Risk     1             3     1                      0     1                     1     1\n3          M                 M         2 yr Degree     1                   500     1        High Risk     1             2     1                      4     1                     4     1\n4          M                 M         2 yr Degree     1                  4500     1         Low Risk     1             4     1                      5     1                     1     1\n5          F                 U             College     1                  4500     1          Unknown     1             0     1                      1     1                     6     1\n6          M                 D         2 yr Degree     1                  1000     1             Good     1             6     1                      1     1                     6     1\n7          M                 D         4 yr Degree     1                  4500     1         Low Risk     1             5     1                      6     1                     4     1\n8          F                 W             Unknown     1                  3500     1        High Risk     1             2     1                      3     1                     3     1\n9          M                 S             Unknown     1                  6500     1             Good     1             3     1                      1     1                     0     1\n10         F                 D         2 yr Degree     1                   500     1         Low Risk     1             4     1                      3     1                     3     1\n11         F                 S           Secondary     1                  2000     1        High Risk     1             2     1                      3     1                     5     1\n12         M                 W             College     1                  7000     1          Unknown     1             4     1                      5     1                     6     1\n13         F                 U           Secondary     1                  1000     1          Unknown     1             3     1                      3     1                     5     1\n14         F                 W           Secondary     1                  8000     1             Good     1             6     1                      2     1                     6     1\n15         F                 D     Advanced Degree     1                  6500     1             Good     1             3     1                      3     1                     1     1\n16         M                 M         4 yr Degree     1                  3000     1        High Risk     1             4     1                      1     1                     3     1\n17         F                 M             Primary     1                  2000     1          Unknown     1             1     1                      2     1                     6     1\n18         F                 M         4 yr Degree     1                  8000     1             Good     1             0     1                      1     1                     4     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"SPEQLITE_TEMP_TABLE_8\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_DATE\" AS \"D_DATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_DOW\" AS \"D_DOW\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_DOM\" AS \"D_DOM\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"SPEQLITE_TEMP_TABLE_8\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.216032,
                    "execution_time": 0.075659,
                    "compile_time": 0.000313,
                    "planning_time": 0.00747,
                    "create_size": 992
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.276402,
                    "execution_time": 0.076622,
                    "compile_time": 0.000319,
                    "planning_time": 0.065301,
                    "create_size": 992
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.279452,
                    "execution_time": 0.175095,
                    "compile_time": 0.000375,
                    "planning_time": 0.029076,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.347174,
                    "execution_time": 0.182205,
                    "compile_time": 0.000385,
                    "planning_time": 0.090027,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.144703,
                    "execution_time": 0.065723,
                    "compile_time": 0.000381,
                    "planning_time": 0.029123,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.205721,
                    "execution_time": 0.064525,
                    "compile_time": 0.000346,
                    "planning_time": 0.091454,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.201757,
                    "execution_time": 0.0982,
                    "compile_time": 0.000351,
                    "planning_time": 0.029164,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.262525,
                    "execution_time": 0.097017,
                    "compile_time": 0.000322,
                    "planning_time": 0.09177,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.184897,
                    "execution_time": 0.085513,
                    "compile_time": 0.000616,
                    "planning_time": 0.052049,
                    "create_size": 136
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.264362,
                    "execution_time": 0.08859,
                    "compile_time": 0.000629,
                    "planning_time": 0.12698,
                    "create_size": 136
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 S             Primary     1                  6500     1        High Risk     1             4     1                      4     1                     1     1\n1          M                 U           Secondary     1                  4500     1             Good     1             0     1                      2     1                     4     1\n2          F                 U         4 yr Degree     1                  3000     1        High Risk     1             5     1                      0     1                     6     1\n3          F                 U         4 yr Degree     1                  1500     1             Good     1             2     1                      4     1                     0     1\n4          F                 U     Advanced Degree     1                  5000     1             Good     1             3     1                      2     1                     6     1\n5          M                 M         4 yr Degree     1                  2000     1         Low Risk     1             0     1                      5     1                     5     1\n6          M                 M             Unknown     1                  7000     1          Unknown     1             4     1                      3     1                     5     1\n7          F                 M             Unknown     1                  4500     1          Unknown     1             0     1                      4     1                     1     1\n8          F                 U         2 yr Degree     1                  5500     1        High Risk     1             0     1                      5     1                     0     1\n9          M                 D             College     1                  7000     1         Low Risk     1             1     1                      3     1                     4     1\n10         M                 M             Primary     1                  6000     1        High Risk     1             6     1                      3     1                     3     1\n11         F                 U     Advanced Degree     1                  7500     1        High Risk     1             5     1                      2     1                     1     1\n12         F                 M         4 yr Degree     1                  6000     1          Unknown     1             2     1                      0     1                     4     1\n13         F                 U             Unknown     1                  6000     1        High Risk     1             2     1                      3     1                     1     1\n14         F                 M             Unknown     1                  1500     1          Unknown     1             5     1                      3     1                     2     1\n15         M                 D         2 yr Degree     1                  5000     1         Low Risk     1             5     1                      3     1                     6     1\n16         F                 M             Primary     1                  9500     1          Unknown     1             2     1                      4     1                     5     1\n17         F                 W         2 yr Degree     1                  1000     1          Unknown     1             4     1                      4     1                     5     1\n18         F                 M     Advanced Degree     1                  8000     1         Low Risk     1             3     1                      2     1                     6     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019876,
                    "execution_time": 0.007458,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.005305
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056686,
                    "execution_time": 0.008226,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.041306
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 S             Primary     1                  6500     1        High Risk     1             4     1                      4     1                     1     1\n1          M                 U           Secondary     1                  4500     1             Good     1             0     1                      2     1                     4     1\n2          F                 U         4 yr Degree     1                  3000     1        High Risk     1             5     1                      0     1                     6     1\n3          F                 U         4 yr Degree     1                  1500     1             Good     1             2     1                      4     1                     0     1\n4          F                 U     Advanced Degree     1                  5000     1             Good     1             3     1                      2     1                     6     1\n5          M                 M         4 yr Degree     1                  2000     1         Low Risk     1             0     1                      5     1                     5     1\n6          M                 M             Unknown     1                  7000     1          Unknown     1             4     1                      3     1                     5     1\n7          F                 M             Unknown     1                  4500     1          Unknown     1             0     1                      4     1                     1     1\n8          F                 U         2 yr Degree     1                  5500     1        High Risk     1             0     1                      5     1                     0     1\n9          M                 D             College     1                  7000     1         Low Risk     1             1     1                      3     1                     4     1\n10         M                 M             Primary     1                  6000     1        High Risk     1             6     1                      3     1                     3     1\n11         F                 U     Advanced Degree     1                  7500     1        High Risk     1             5     1                      2     1                     1     1\n12         F                 M         4 yr Degree     1                  6000     1          Unknown     1             2     1                      0     1                     4     1\n13         F                 U             Unknown     1                  6000     1        High Risk     1             2     1                      3     1                     1     1\n14         F                 M             Unknown     1                  1500     1          Unknown     1             5     1                      3     1                     2     1\n15         M                 D         2 yr Degree     1                  5000     1         Low Risk     1             5     1                      3     1                     6     1\n16         F                 M             Primary     1                  9500     1          Unknown     1             2     1                      4     1                     5     1\n17         F                 W         2 yr Degree     1                  1000     1          Unknown     1             4     1                      4     1                     5     1\n18         F                 M     Advanced Degree     1                  8000     1         Low Risk     1             3     1                      2     1                     6     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating,\n  cd_dep_count,\n  cd_dep_employed_count,\n  cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"CNT1\" AS \"CNT1\" , \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"CNT2\" AS \"CNT2\" , \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"CNT3\" AS \"CNT3\" , \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"CNT4\" AS \"CNT4\" , \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"CNT5\" AS \"CNT5\" , \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 W             College     1                  5000     1        High Risk     1             3     1                      4     1                     4     1\n1          F                 D         4 yr Degree     1                  3000     1         Low Risk     1             5     1                      6     1                     2     1\n2          F                 W             College     1                  5500     1             Good     1             6     1                      0     1                     0     1\n3          M                 W         4 yr Degree     1                  9000     1             Good     1             2     1                      0     1                     4     1\n4          F                 S             Unknown     1                  8000     1             Good     1             3     1                      3     1                     4     1\n5          M                 W         2 yr Degree     1                  6000     1        High Risk     1             3     1                      3     1                     4     1\n6          F                 S         4 yr Degree     1                  4000     1             Good     1             5     1                      2     1                     0     1\n7          M                 S           Secondary     1                  1500     1        High Risk     1             0     1                      6     1                     0     1\n8          M                 S         2 yr Degree     1                  9000     1        High Risk     1             2     1                      1     1                     2     1\n9          M                 D           Secondary     1                  8500     1             Good     1             2     1                      5     1                     3     1\n10         F                 S           Secondary     1                  8500     1             Good     1             0     1                      3     1                     6     1\n11         M                 M             College     1                  2500     1         Low Risk     1             4     1                      4     1                     6     1\n12         M                 S         2 yr Degree     1                  6000     1        High Risk     1             6     1                      4     1                     4     1\n13         M                 S     Advanced Degree     1                  6000     1          Unknown     1             3     1                      3     1                     6     1\n14         F                 W             Primary     1                  2500     1          Unknown     1             6     1                      6     1                     6     1\n15         F                 S             Unknown     1                  2500     1          Unknown     1             4     1                      4     1                     5     1\n16         F                 D         4 yr Degree     1                  7500     1          Unknown     1             4     1                      1     1                     0     1\n17         F                 U     Advanced Degree     1                  6000     1         Low Risk     1             4     1                      3     1                     5     1\n18         M                 D         2 yr Degree     1                  6500     1        High Risk     1             5     1                      2     1                     4     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019433,
                    "execution_time": 0.007357,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.005157
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055752,
                    "execution_time": 0.007744,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.040921
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\", \"CNT1\" AS \"CNT1\", \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\", \"CNT2\" AS \"CNT2\", \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\", \"CNT3\" AS \"CNT3\", \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\", \"CNT4\" AS \"CNT4\", \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\", \"CNT5\" AS \"CNT5\", \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\", \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 W             College     1                  5000     1        High Risk     1             3     1                      4     1                     4     1\n1          F                 D         4 yr Degree     1                  3000     1         Low Risk     1             5     1                      6     1                     2     1\n2          F                 W             College     1                  5500     1             Good     1             6     1                      0     1                     0     1\n3          M                 W         4 yr Degree     1                  9000     1             Good     1             2     1                      0     1                     4     1\n4          F                 S             Unknown     1                  8000     1             Good     1             3     1                      3     1                     4     1\n5          M                 W         2 yr Degree     1                  6000     1        High Risk     1             3     1                      3     1                     4     1\n6          F                 S         4 yr Degree     1                  4000     1             Good     1             5     1                      2     1                     0     1\n7          M                 S           Secondary     1                  1500     1        High Risk     1             0     1                      6     1                     0     1\n8          M                 S         2 yr Degree     1                  9000     1        High Risk     1             2     1                      1     1                     2     1\n9          M                 D           Secondary     1                  8500     1             Good     1             2     1                      5     1                     3     1\n10         F                 S           Secondary     1                  8500     1             Good     1             0     1                      3     1                     6     1\n11         M                 M             College     1                  2500     1         Low Risk     1             4     1                      4     1                     6     1\n12         M                 S         2 yr Degree     1                  6000     1        High Risk     1             6     1                      4     1                     4     1\n13         M                 S     Advanced Degree     1                  6000     1          Unknown     1             3     1                      3     1                     6     1\n14         F                 W             Primary     1                  2500     1          Unknown     1             6     1                      6     1                     6     1\n15         F                 S             Unknown     1                  2500     1          Unknown     1             4     1                      4     1                     5     1\n16         F                 D         4 yr Degree     1                  7500     1          Unknown     1             4     1                      1     1                     0     1\n17         F                 U     Advanced Degree     1                  6000     1         Low Risk     1             4     1                      3     1                     5     1\n18         M                 D         2 yr Degree     1                  6500     1        High Risk     1             5     1                      2     1                     4     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"CNT1\" AS \"CNT1\" , \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"CNT2\" AS \"CNT2\" , \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"CNT3\" AS \"CNT3\" , \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"CNT4\" AS \"CNT4\" , \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"CNT5\" AS \"CNT5\" , \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 S         4 yr Degree     1                  9500     1          Unknown     1             2     1                      4     1                     2     1\n1          F                 M           Secondary     1                   500     1         Low Risk     1             4     1                      1     1                     2     1\n2          M                 U             Primary     1                  5000     1             Good     1             5     1                      5     1                     6     1\n3          F                 W           Secondary     1                  3500     1             Good     1             0     1                      4     1                     3     1\n4          F                 S     Advanced Degree     1                  2000     1        High Risk     1             0     1                      4     1                     3     1\n5          F                 M     Advanced Degree     1                  1000     1        High Risk     1             1     1                      1     1                     3     1\n6          M                 M             Unknown     1                  5000     1          Unknown     1             6     1                      0     1                     0     1\n7          M                 U         2 yr Degree     1                  7000     1             Good     1             5     1                      1     1                     1     1\n8          M                 M             Primary     1                  4000     1         Low Risk     1             5     1                      3     1                     4     1\n9          M                 W           Secondary     1                  4000     1        High Risk     1             6     1                      0     1                     4     1\n10         M                 U             Unknown     1                  5500     1          Unknown     1             0     1                      5     1                     5     1\n11         M                 U         4 yr Degree     1                   500     1         Low Risk     1             4     1                      3     1                     5     1\n12         M                 S             Primary     1                  4500     1         Low Risk     1             4     1                      6     1                     0     1\n13         M                 W         4 yr Degree     1                  5500     1        High Risk     1             2     1                      5     1                     5     1\n14         F                 U     Advanced Degree     1                  1500     1         Low Risk     1             3     1                      2     1                     5     1\n15         F                 D         4 yr Degree     1                   500     1          Unknown     1             1     1                      3     1                     1     1\n16         F                 U             Unknown     1                  1500     1             Good     1             0     1                      5     1                     6     1\n17         F                 M             Primary     1                  5500     1             Good     1             1     1                      3     1                     3     1\n18         F                 W             Primary     1                  9500     1         Low Risk     1             1     1                      4     1                     2     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020171,
                    "execution_time": 0.00758,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.005298
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019959,
                    "execution_time": 0.007385,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.005414
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\", \"CNT1\" AS \"CNT1\", \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\", \"CNT2\" AS \"CNT2\", \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\", \"CNT3\" AS \"CNT3\", \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\", \"CNT4\" AS \"CNT4\", \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\", \"CNT5\" AS \"CNT5\", \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\", \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 S         4 yr Degree     1                  9500     1          Unknown     1             2     1                      4     1                     2     1\n1          F                 M           Secondary     1                   500     1         Low Risk     1             4     1                      1     1                     2     1\n2          M                 U             Primary     1                  5000     1             Good     1             5     1                      5     1                     6     1\n3          F                 W           Secondary     1                  3500     1             Good     1             0     1                      4     1                     3     1\n4          F                 S     Advanced Degree     1                  2000     1        High Risk     1             0     1                      4     1                     3     1\n5          F                 M     Advanced Degree     1                  1000     1        High Risk     1             1     1                      1     1                     3     1\n6          M                 M             Unknown     1                  5000     1          Unknown     1             6     1                      0     1                     0     1\n7          M                 U         2 yr Degree     1                  7000     1             Good     1             5     1                      1     1                     1     1\n8          M                 M             Primary     1                  4000     1         Low Risk     1             5     1                      3     1                     4     1\n9          M                 W           Secondary     1                  4000     1        High Risk     1             6     1                      0     1                     4     1\n10         M                 U             Unknown     1                  5500     1          Unknown     1             0     1                      5     1                     5     1\n11         M                 U         4 yr Degree     1                   500     1         Low Risk     1             4     1                      3     1                     5     1\n12         M                 S             Primary     1                  4500     1         Low Risk     1             4     1                      6     1                     0     1\n13         M                 W         4 yr Degree     1                  5500     1        High Risk     1             2     1                      5     1                     5     1\n14         F                 U     Advanced Degree     1                  1500     1         Low Risk     1             3     1                      2     1                     5     1\n15         F                 D         4 yr Degree     1                   500     1          Unknown     1             1     1                      3     1                     1     1\n16         F                 U             Unknown     1                  1500     1             Good     1             0     1                      5     1                     6     1\n17         F                 M             Primary     1                  5500     1             Good     1             1     1                      3     1                     3     1\n18         F                 W             Primary     1                  9500     1         Low Risk     1             1     1                      4     1                     2     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"CNT1\" AS \"CNT1\" , \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"CNT2\" AS \"CNT2\" , \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"CNT3\" AS \"CNT3\" , \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"CNT4\" AS \"CNT4\" , \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"CNT5\" AS \"CNT5\" , \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 S         4 yr Degree     1                  9500     1          Unknown     1             2     1                      4     1                     2     1\n1          F                 M           Secondary     1                   500     1         Low Risk     1             4     1                      1     1                     2     1\n2          M                 U             Primary     1                  5000     1             Good     1             5     1                      5     1                     6     1\n3          F                 W           Secondary     1                  3500     1             Good     1             0     1                      4     1                     3     1\n4          F                 S     Advanced Degree     1                  2000     1        High Risk     1             0     1                      4     1                     3     1\n5          F                 M     Advanced Degree     1                  1000     1        High Risk     1             1     1                      1     1                     3     1\n6          M                 M             Unknown     1                  5000     1          Unknown     1             6     1                      0     1                     0     1\n7          M                 U         2 yr Degree     1                  7000     1             Good     1             5     1                      1     1                     1     1\n8          M                 M             Primary     1                  4000     1         Low Risk     1             5     1                      3     1                     4     1\n9          M                 W           Secondary     1                  4000     1        High Risk     1             6     1                      0     1                     4     1\n10         M                 U             Unknown     1                  5500     1          Unknown     1             0     1                      5     1                     5     1\n11         M                 U         4 yr Degree     1                   500     1         Low Risk     1             4     1                      3     1                     5     1\n12         M                 S             Primary     1                  4500     1         Low Risk     1             4     1                      6     1                     0     1\n13         M                 W         4 yr Degree     1                  5500     1        High Risk     1             2     1                      5     1                     5     1\n14         F                 U     Advanced Degree     1                  1500     1         Low Risk     1             3     1                      2     1                     5     1\n15         F                 D         4 yr Degree     1                   500     1          Unknown     1             1     1                      3     1                     1     1\n16         F                 U             Unknown     1                  1500     1             Good     1             0     1                      5     1                     6     1\n17         F                 M             Primary     1                  5500     1             Good     1             1     1                      3     1                     3     1\n18         F                 W             Primary     1                  9500     1         Low Risk     1             1     1                      4     1                     2     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.030613,
                    "execution_time": 0.007505,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.005041
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.02011,
                    "execution_time": 0.007694,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.00533
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\", \"CNT1\" AS \"CNT1\", \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\", \"CNT2\" AS \"CNT2\", \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\", \"CNT3\" AS \"CNT3\", \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\", \"CNT4\" AS \"CNT4\", \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\", \"CNT5\" AS \"CNT5\", \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\", \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 S         4 yr Degree     1                  9500     1          Unknown     1             2     1                      4     1                     2     1\n1          F                 M           Secondary     1                   500     1         Low Risk     1             4     1                      1     1                     2     1\n2          M                 U             Primary     1                  5000     1             Good     1             5     1                      5     1                     6     1\n3          F                 W           Secondary     1                  3500     1             Good     1             0     1                      4     1                     3     1\n4          F                 S     Advanced Degree     1                  2000     1        High Risk     1             0     1                      4     1                     3     1\n5          F                 M     Advanced Degree     1                  1000     1        High Risk     1             1     1                      1     1                     3     1\n6          M                 M             Unknown     1                  5000     1          Unknown     1             6     1                      0     1                     0     1\n7          M                 U         2 yr Degree     1                  7000     1             Good     1             5     1                      1     1                     1     1\n8          M                 M             Primary     1                  4000     1         Low Risk     1             5     1                      3     1                     4     1\n9          M                 W           Secondary     1                  4000     1        High Risk     1             6     1                      0     1                     4     1\n10         M                 U             Unknown     1                  5500     1          Unknown     1             0     1                      5     1                     5     1\n11         M                 U         4 yr Degree     1                   500     1         Low Risk     1             4     1                      3     1                     5     1\n12         M                 S             Primary     1                  4500     1         Low Risk     1             4     1                      6     1                     0     1\n13         M                 W         4 yr Degree     1                  5500     1        High Risk     1             2     1                      5     1                     5     1\n14         F                 U     Advanced Degree     1                  1500     1         Low Risk     1             3     1                      2     1                     5     1\n15         F                 D         4 yr Degree     1                   500     1          Unknown     1             1     1                      3     1                     1     1\n16         F                 U             Unknown     1                  1500     1             Good     1             0     1                      5     1                     6     1\n17         F                 M             Primary     1                  5500     1             Good     1             1     1                      3     1                     3     1\n18         F                 W             Primary     1                  9500     1         Low Risk     1             1     1                      4     1                     2     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"CNT1\" AS \"CNT1\" , \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"CNT2\" AS \"CNT2\" , \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"CNT3\" AS \"CNT3\" , \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"CNT4\" AS \"CNT4\" , \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"CNT5\" AS \"CNT5\" , \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D             Primary     1                  9500     1         Low Risk     1             6     1                      3     1                     4     1\n1          M                 S             Unknown     1                  9500     1         Low Risk     1             5     1                      0     1                     6     1\n2          M                 S             Unknown     1                  4500     1         Low Risk     1             6     1                      5     1                     2     1\n3          F                 D         2 yr Degree     1                  8500     1         Low Risk     1             1     1                      6     1                     0     1\n4          F                 S     Advanced Degree     1                  1000     1          Unknown     1             0     1                      1     1                     6     1\n5          M                 W             Unknown     1                  2500     1          Unknown     1             2     1                      3     1                     0     1\n6          F                 D     Advanced Degree     1                  6500     1             Good     1             0     1                      4     1                     3     1\n7          M                 S             Unknown     1                  9000     1             Good     1             0     1                      4     1                     3     1\n8          M                 D             College     1                  9000     1         Low Risk     1             1     1                      4     1                     5     1\n9          F                 S           Secondary     1                  1000     1         Low Risk     1             1     1                      6     1                     5     1\n10         M                 D             Primary     1                  6000     1             Good     1             3     1                      4     1                     0     1\n11         F                 S         2 yr Degree     1                  5500     1          Unknown     1             3     1                      0     1                     3     1\n12         F                 M             Primary     1                  4000     1        High Risk     1             4     1                      1     1                     4     1\n13         M                 S             Unknown     1                  2000     1          Unknown     1             4     1                      1     1                     6     1\n14         F                 D         4 yr Degree     1                  8000     1         Low Risk     1             0     1                      1     1                     0     1\n15         F                 S           Secondary     1                  3500     1         Low Risk     1             6     1                      6     1                     2     1\n16         M                 D     Advanced Degree     1                 10000     1        High Risk     1             2     1                      4     1                     5     1\n17         M                 U     Advanced Degree     1                  7000     1             Good     1             4     1                      0     1                     4     1\n18         M                 D         2 yr Degree     1                  2000     1          Unknown     1             0     1                      3     1                     3     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019365,
                    "execution_time": 0.00716,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.005263
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020503,
                    "execution_time": 0.00806,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.005322
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\", \"CNT1\" AS \"CNT1\", \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\", \"CNT2\" AS \"CNT2\", \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\", \"CNT3\" AS \"CNT3\", \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\", \"CNT4\" AS \"CNT4\", \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\", \"CNT5\" AS \"CNT5\", \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\", \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D             Primary     1                  9500     1         Low Risk     1             6     1                      3     1                     4     1\n1          M                 S             Unknown     1                  9500     1         Low Risk     1             5     1                      0     1                     6     1\n2          M                 S             Unknown     1                  4500     1         Low Risk     1             6     1                      5     1                     2     1\n3          F                 D         2 yr Degree     1                  8500     1         Low Risk     1             1     1                      6     1                     0     1\n4          F                 S     Advanced Degree     1                  1000     1          Unknown     1             0     1                      1     1                     6     1\n5          M                 W             Unknown     1                  2500     1          Unknown     1             2     1                      3     1                     0     1\n6          F                 D     Advanced Degree     1                  6500     1             Good     1             0     1                      4     1                     3     1\n7          M                 S             Unknown     1                  9000     1             Good     1             0     1                      4     1                     3     1\n8          M                 D             College     1                  9000     1         Low Risk     1             1     1                      4     1                     5     1\n9          F                 S           Secondary     1                  1000     1         Low Risk     1             1     1                      6     1                     5     1\n10         M                 D             Primary     1                  6000     1             Good     1             3     1                      4     1                     0     1\n11         F                 S         2 yr Degree     1                  5500     1          Unknown     1             3     1                      0     1                     3     1\n12         F                 M             Primary     1                  4000     1        High Risk     1             4     1                      1     1                     4     1\n13         M                 S             Unknown     1                  2000     1          Unknown     1             4     1                      1     1                     6     1\n14         F                 D         4 yr Degree     1                  8000     1         Low Risk     1             0     1                      1     1                     0     1\n15         F                 S           Secondary     1                  3500     1         Low Risk     1             6     1                      6     1                     2     1\n16         M                 D     Advanced Degree     1                 10000     1        High Risk     1             2     1                      4     1                     5     1\n17         M                 U     Advanced Degree     1                  7000     1             Good     1             4     1                      0     1                     4     1\n18         M                 D         2 yr Degree     1                  2000     1          Unknown     1             0     1                      3     1                     3     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\ncd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"CNT1\" AS \"CNT1\" , \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"CNT2\" AS \"CNT2\" , \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"CNT3\" AS \"CNT3\" , \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"CNT4\" AS \"CNT4\" , \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"CNT5\" AS \"CNT5\" , \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 W             College     1                  5000     1        High Risk     1             3     1                      4     1                     4     1\n1          F                 D         4 yr Degree     1                  3000     1         Low Risk     1             5     1                      6     1                     2     1\n2          F                 W             College     1                  5500     1             Good     1             6     1                      0     1                     0     1\n3          M                 W         4 yr Degree     1                  9000     1             Good     1             2     1                      0     1                     4     1\n4          F                 S             Unknown     1                  8000     1             Good     1             3     1                      3     1                     4     1\n5          M                 W         2 yr Degree     1                  6000     1        High Risk     1             3     1                      3     1                     4     1\n6          F                 S         4 yr Degree     1                  4000     1             Good     1             5     1                      2     1                     0     1\n7          M                 S           Secondary     1                  1500     1        High Risk     1             0     1                      6     1                     0     1\n8          M                 S         2 yr Degree     1                  9000     1        High Risk     1             2     1                      1     1                     2     1\n9          M                 D           Secondary     1                  8500     1             Good     1             2     1                      5     1                     3     1\n10         F                 S           Secondary     1                  8500     1             Good     1             0     1                      3     1                     6     1\n11         M                 M             College     1                  2500     1         Low Risk     1             4     1                      4     1                     6     1\n12         M                 S         2 yr Degree     1                  6000     1        High Risk     1             6     1                      4     1                     4     1\n13         M                 S     Advanced Degree     1                  6000     1          Unknown     1             3     1                      3     1                     6     1\n14         F                 W             Primary     1                  2500     1          Unknown     1             6     1                      6     1                     6     1\n15         F                 S             Unknown     1                  2500     1          Unknown     1             4     1                      4     1                     5     1\n16         F                 D         4 yr Degree     1                  7500     1          Unknown     1             4     1                      1     1                     0     1\n17         F                 U     Advanced Degree     1                  6000     1         Low Risk     1             4     1                      3     1                     5     1\n18         M                 D         2 yr Degree     1                  6500     1        High Risk     1             5     1                      2     1                     4     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019545,
                    "execution_time": 0.007349,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.005298
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020288,
                    "execution_time": 0.007441,
                    "compile_time": 6.2e-05,
                    "planning_time": 0.005486
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\", \"CNT1\" AS \"CNT1\", \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\", \"CNT2\" AS \"CNT2\", \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\", \"CNT3\" AS \"CNT3\", \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\", \"CNT4\" AS \"CNT4\", \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\", \"CNT5\" AS \"CNT5\", \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\", \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 W             College     1                  5000     1        High Risk     1             3     1                      4     1                     4     1\n1          F                 D         4 yr Degree     1                  3000     1         Low Risk     1             5     1                      6     1                     2     1\n2          F                 W             College     1                  5500     1             Good     1             6     1                      0     1                     0     1\n3          M                 W         4 yr Degree     1                  9000     1             Good     1             2     1                      0     1                     4     1\n4          F                 S             Unknown     1                  8000     1             Good     1             3     1                      3     1                     4     1\n5          M                 W         2 yr Degree     1                  6000     1        High Risk     1             3     1                      3     1                     4     1\n6          F                 S         4 yr Degree     1                  4000     1             Good     1             5     1                      2     1                     0     1\n7          M                 S           Secondary     1                  1500     1        High Risk     1             0     1                      6     1                     0     1\n8          M                 S         2 yr Degree     1                  9000     1        High Risk     1             2     1                      1     1                     2     1\n9          M                 D           Secondary     1                  8500     1             Good     1             2     1                      5     1                     3     1\n10         F                 S           Secondary     1                  8500     1             Good     1             0     1                      3     1                     6     1\n11         M                 M             College     1                  2500     1         Low Risk     1             4     1                      4     1                     6     1\n12         M                 S         2 yr Degree     1                  6000     1        High Risk     1             6     1                      4     1                     4     1\n13         M                 S     Advanced Degree     1                  6000     1          Unknown     1             3     1                      3     1                     6     1\n14         F                 W             Primary     1                  2500     1          Unknown     1             6     1                      6     1                     6     1\n15         F                 S             Unknown     1                  2500     1          Unknown     1             4     1                      4     1                     5     1\n16         F                 D         4 yr Degree     1                  7500     1          Unknown     1             4     1                      1     1                     0     1\n17         F                 U     Advanced Degree     1                  6000     1         Low Risk     1             4     1                      3     1                     5     1\n18         M                 D         2 yr Degree     1                  6500     1        High Risk     1             5     1                      2     1                     4     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"CNT1\" AS \"CNT1\" , \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"CNT2\" AS \"CNT2\" , \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"CNT3\" AS \"CNT3\" , \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"CNT4\" AS \"CNT4\" , \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"CNT5\" AS \"CNT5\" , \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 W             College     1                  5000     1        High Risk     1             3     1                      4     1                     4     1\n1          F                 D         4 yr Degree     1                  3000     1         Low Risk     1             5     1                      6     1                     2     1\n2          F                 W             College     1                  5500     1             Good     1             6     1                      0     1                     0     1\n3          M                 W         4 yr Degree     1                  9000     1             Good     1             2     1                      0     1                     4     1\n4          F                 S             Unknown     1                  8000     1             Good     1             3     1                      3     1                     4     1\n5          M                 W         2 yr Degree     1                  6000     1        High Risk     1             3     1                      3     1                     4     1\n6          F                 S         4 yr Degree     1                  4000     1             Good     1             5     1                      2     1                     0     1\n7          M                 S           Secondary     1                  1500     1        High Risk     1             0     1                      6     1                     0     1\n8          M                 S         2 yr Degree     1                  9000     1        High Risk     1             2     1                      1     1                     2     1\n9          M                 D           Secondary     1                  8500     1             Good     1             2     1                      5     1                     3     1\n10         F                 S           Secondary     1                  8500     1             Good     1             0     1                      3     1                     6     1\n11         M                 M             College     1                  2500     1         Low Risk     1             4     1                      4     1                     6     1\n12         M                 S         2 yr Degree     1                  6000     1        High Risk     1             6     1                      4     1                     4     1\n13         M                 S     Advanced Degree     1                  6000     1          Unknown     1             3     1                      3     1                     6     1\n14         F                 W             Primary     1                  2500     1          Unknown     1             6     1                      6     1                     6     1\n15         F                 S             Unknown     1                  2500     1          Unknown     1             4     1                      4     1                     5     1\n16         F                 D         4 yr Degree     1                  7500     1          Unknown     1             4     1                      1     1                     0     1\n17         F                 U     Advanced Degree     1                  6000     1         Low Risk     1             4     1                      3     1                     5     1\n18         M                 D         2 yr Degree     1                  6500     1        High Risk     1             5     1                      2     1                     4     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020127,
                    "execution_time": 0.007859,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.005236
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020479,
                    "execution_time": 0.008058,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.005317
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\", \"CNT1\" AS \"CNT1\", \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\", \"CNT2\" AS \"CNT2\", \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\", \"CNT3\" AS \"CNT3\", \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\", \"CNT4\" AS \"CNT4\", \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\", \"CNT5\" AS \"CNT5\", \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\", \"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          M                 W             College     1                  5000     1        High Risk     1             3     1                      4     1                     4     1\n1          F                 D         4 yr Degree     1                  3000     1         Low Risk     1             5     1                      6     1                     2     1\n2          F                 W             College     1                  5500     1             Good     1             6     1                      0     1                     0     1\n3          M                 W         4 yr Degree     1                  9000     1             Good     1             2     1                      0     1                     4     1\n4          F                 S             Unknown     1                  8000     1             Good     1             3     1                      3     1                     4     1\n5          M                 W         2 yr Degree     1                  6000     1        High Risk     1             3     1                      3     1                     4     1\n6          F                 S         4 yr Degree     1                  4000     1             Good     1             5     1                      2     1                     0     1\n7          M                 S           Secondary     1                  1500     1        High Risk     1             0     1                      6     1                     0     1\n8          M                 S         2 yr Degree     1                  9000     1        High Risk     1             2     1                      1     1                     2     1\n9          M                 D           Secondary     1                  8500     1             Good     1             2     1                      5     1                     3     1\n10         F                 S           Secondary     1                  8500     1             Good     1             0     1                      3     1                     6     1\n11         M                 M             College     1                  2500     1         Low Risk     1             4     1                      4     1                     6     1\n12         M                 S         2 yr Degree     1                  6000     1        High Risk     1             6     1                      4     1                     4     1\n13         M                 S     Advanced Degree     1                  6000     1          Unknown     1             3     1                      3     1                     6     1\n14         F                 W             Primary     1                  2500     1          Unknown     1             6     1                      6     1                     6     1\n15         F                 S             Unknown     1                  2500     1          Unknown     1             4     1                      4     1                     5     1\n16         F                 D         4 yr Degree     1                  7500     1          Unknown     1             4     1                      1     1                     0     1\n17         F                 U     Advanced Degree     1                  6000     1         Low Risk     1             4     1                      3     1                     5     1\n18         M                 D         2 yr Degree     1                  6500     1        High Risk     1             5     1                      2     1                     4     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 S             Unknown     1                  6500     1             Good     1             2     1                      1     1                     3     1\n1          F                 M             College     1                  5000     1             Good     1             5     1                      6     1                     4     1\n2          F                 S             College     1                  6500     1          Unknown     1             6     1                      5     1                     2     1\n3          F                 D             College     1                   500     1         Low Risk     1             1     1                      6     1                     0     1\n4          F                 W           Secondary     1                  4500     1         Low Risk     1             3     1                      1     1                     4     1\n5          F                 S             Unknown     1                  6500     1             Good     1             3     1                      5     1                     6     1\n6          F                 S         4 yr Degree     1                  5500     1             Good     1             2     1                      1     1                     3     1\n7          F                 S             College     1                  7000     1         Low Risk     1             6     1                      0     1                     4     1\n8          F                 D             Primary     1                  3000     1             Good     1             3     1                      0     1                     6     1\n9          F                 M             Primary     1                  7500     1          Unknown     1             0     1                      4     1                     0     1\n10         F                 W             Primary     1                  5000     1        High Risk     1             2     1                      1     1                     2     1\n11         F                 S           Secondary     1                  8000     1         Low Risk     1             4     1                      1     1                     0     1\n12         F                 W         2 yr Degree     1                  8000     1          Unknown     1             0     1                      1     1                     1     1\n13         F                 M             Unknown     1                  1500     1             Good     1             3     1                      1     1                     4     1\n14         F                 S         2 yr Degree     1                 10000     1          Unknown     1             2     1                      1     1                     6     1\n15         F                 U             Unknown     1                  7500     1        High Risk     1             2     1                      4     1                     3     1\n16         F                 D         2 yr Degree     1                  3000     1             Good     1             2     1                      3     1                     2     1\n17         F                 U     Advanced Degree     1                  8000     1          Unknown     1             2     1                      3     1                     3     1\n18         F                 D             College     1                  4500     1          Unknown     1             6     1                      1     1                     2     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020812,
                    "execution_time": 0.008326,
                    "compile_time": 9.5e-05,
                    "planning_time": 0.005454
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060245,
                    "execution_time": 0.009148,
                    "compile_time": 0.000101,
                    "planning_time": 0.041221
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 S             Unknown     1                  6500     1             Good     1             2     1                      1     1                     3     1\n1          F                 M             College     1                  5000     1             Good     1             5     1                      6     1                     4     1\n2          F                 S             College     1                  6500     1          Unknown     1             6     1                      5     1                     2     1\n3          F                 D             College     1                   500     1         Low Risk     1             1     1                      6     1                     0     1\n4          F                 W           Secondary     1                  4500     1         Low Risk     1             3     1                      1     1                     4     1\n5          F                 S             Unknown     1                  6500     1             Good     1             3     1                      5     1                     6     1\n6          F                 S         4 yr Degree     1                  5500     1             Good     1             2     1                      1     1                     3     1\n7          F                 S             College     1                  7000     1         Low Risk     1             6     1                      0     1                     4     1\n8          F                 D             Primary     1                  3000     1             Good     1             3     1                      0     1                     6     1\n9          F                 M             Primary     1                  7500     1          Unknown     1             0     1                      4     1                     0     1\n10         F                 W             Primary     1                  5000     1        High Risk     1             2     1                      1     1                     2     1\n11         F                 S           Secondary     1                  8000     1         Low Risk     1             4     1                      1     1                     0     1\n12         F                 W         2 yr Degree     1                  8000     1          Unknown     1             0     1                      1     1                     1     1\n13         F                 M             Unknown     1                  1500     1             Good     1             3     1                      1     1                     4     1\n14         F                 S         2 yr Degree     1                 10000     1          Unknown     1             2     1                      1     1                     6     1\n15         F                 U             Unknown     1                  7500     1        High Risk     1             2     1                      4     1                     3     1\n16         F                 D         2 yr Degree     1                  3000     1             Good     1             2     1                      3     1                     2     1\n17         F                 U     Advanced Degree     1                  8000     1          Unknown     1             2     1                      3     1                     3     1\n18         F                 D             College     1                  4500     1          Unknown     1             6     1                      1     1                     2     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                  7000     1          Unknown     1             1     1                      0     1                     6     1\n1          F                 D             Primary     1                  1500     1         Low Risk     1             4     1                      2     1                     2     1\n2          F                 D             Unknown     1                  3500     1        High Risk     1             5     1                      3     1                     4     1\n3          F                 D           Secondary     1                  3500     1             Good     1             1     1                      2     1                     3     1\n4          F                 D     Advanced Degree     1                  7000     1        High Risk     1             3     1                      1     1                     1     1\n5          F                 D     Advanced Degree     1                  8000     1        High Risk     1             3     1                      0     1                     1     1\n6          F                 D         2 yr Degree     1                  7500     1        High Risk     1             2     1                      0     1                     4     1\n7          F                 D         2 yr Degree     1                  4000     1             Good     1             5     1                      2     1                     4     1\n8          F                 D           Secondary     1                  2500     1         Low Risk     1             0     1                      2     1                     6     1\n9          F                 D             Primary     1                  9000     1         Low Risk     1             6     1                      6     1                     1     1\n10         F                 D             Unknown     1                  8500     1             Good     1             6     1                      6     1                     1     1\n11         F                 D             College     1                  6500     1             Good     1             0     1                      0     1                     2     1\n12         F                 D             Unknown     1                  4000     1             Good     1             2     1                      3     1                     2     1\n13         F                 D           Secondary     1                  8000     1          Unknown     1             5     1                      5     1                     0     1\n14         F                 D             Unknown     1                  5500     1          Unknown     1             4     1                      6     1                     0     1\n15         F                 D             Primary     1                  5500     1             Good     1             0     1                      0     1                     3     1\n16         F                 D     Advanced Degree     1                  1000     1             Good     1             1     1                      5     1                     6     1\n17         F                 D             College     1                  5000     1        High Risk     1             1     1                      1     1                     2     1\n18         F                 D             College     1                  4500     1          Unknown     1             6     1                      1     1                     2     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021246,
                    "execution_time": 0.008399,
                    "compile_time": 8.6e-05,
                    "planning_time": 0.00568
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056943,
                    "execution_time": 0.008465,
                    "compile_time": 8.6e-05,
                    "planning_time": 0.041334
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                  7000     1          Unknown     1             1     1                      0     1                     6     1\n1          F                 D             Primary     1                  1500     1         Low Risk     1             4     1                      2     1                     2     1\n2          F                 D             Unknown     1                  3500     1        High Risk     1             5     1                      3     1                     4     1\n3          F                 D           Secondary     1                  3500     1             Good     1             1     1                      2     1                     3     1\n4          F                 D     Advanced Degree     1                  7000     1        High Risk     1             3     1                      1     1                     1     1\n5          F                 D     Advanced Degree     1                  8000     1        High Risk     1             3     1                      0     1                     1     1\n6          F                 D         2 yr Degree     1                  7500     1        High Risk     1             2     1                      0     1                     4     1\n7          F                 D         2 yr Degree     1                  4000     1             Good     1             5     1                      2     1                     4     1\n8          F                 D           Secondary     1                  2500     1         Low Risk     1             0     1                      2     1                     6     1\n9          F                 D             Primary     1                  9000     1         Low Risk     1             6     1                      6     1                     1     1\n10         F                 D             Unknown     1                  8500     1             Good     1             6     1                      6     1                     1     1\n11         F                 D             College     1                  6500     1             Good     1             0     1                      0     1                     2     1\n12         F                 D             Unknown     1                  4000     1             Good     1             2     1                      3     1                     2     1\n13         F                 D           Secondary     1                  8000     1          Unknown     1             5     1                      5     1                     0     1\n14         F                 D             Unknown     1                  5500     1          Unknown     1             4     1                      6     1                     0     1\n15         F                 D             Primary     1                  5500     1             Good     1             0     1                      0     1                     3     1\n16         F                 D     Advanced Degree     1                  1000     1             Good     1             1     1                      5     1                     6     1\n17         F                 D             College     1                  5000     1        High Risk     1             1     1                      1     1                     2     1\n18         F                 D             College     1                  4500     1          Unknown     1             6     1                      1     1                     2     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                  7500     1        High Risk     1             2     1                      0     1                     4     1\n1          F                 D         2 yr Degree     1                  2000     1        High Risk     1             4     1                      3     1                     6     1\n2          F                 D         2 yr Degree     1                  9500     1             Good     1             6     1                      6     1                     3     1\n3          F                 D         2 yr Degree     1                  4000     1             Good     1             5     1                      2     1                     4     1\n4          F                 D         2 yr Degree     1                  3000     1             Good     1             2     1                      3     1                     2     1\n5          F                 D         2 yr Degree     1                  1500     1             Good     1             0     1                      0     1                     1     1\n6          F                 D         2 yr Degree     1                  7500     1        High Risk     1             3     1                      1     1                     0     1\n7          F                 D         2 yr Degree     1                  4500     1             Good     1             0     1                      2     1                     0     1\n8          F                 D         2 yr Degree     1                  7000     1          Unknown     1             1     1                      0     1                     6     1\n9          F                 D         2 yr Degree     1                  7500     1        High Risk     1             4     1                      0     1                     5     1\n10         F                 D         2 yr Degree     1                  8500     1         Low Risk     1             1     1                      6     1                     0     1\n11         F                 D         2 yr Degree     1                  4500     1         Low Risk     1             6     1                      2     1                     5     1\n12         F                 D         2 yr Degree     1                  3000     1             Good     1             5     1                      4     1                     3     1\n13         F                 D         2 yr Degree     1                  3000     1          Unknown     1             6     1                      1     1                     1     1\n14         F                 D         2 yr Degree     1                  2500     1         Low Risk     1             4     1                      5     1                     5     1\n15         F                 D         2 yr Degree     1                  3500     1         Low Risk     1             6     1                      5     1                     2     1\n16         F                 D         2 yr Degree     1                   500     1         Low Risk     1             4     1                      3     1                     3     1\n17         F                 D         2 yr Degree     1                  2500     1         Low Risk     1             0     1                      5     1                     4     1\n18         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021716,
                    "execution_time": 0.008926,
                    "compile_time": 8.5e-05,
                    "planning_time": 0.00569
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058034,
                    "execution_time": 0.009169,
                    "compile_time": 8.8e-05,
                    "planning_time": 0.041627
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                  7500     1        High Risk     1             2     1                      0     1                     4     1\n1          F                 D         2 yr Degree     1                  2000     1        High Risk     1             4     1                      3     1                     6     1\n2          F                 D         2 yr Degree     1                  9500     1             Good     1             6     1                      6     1                     3     1\n3          F                 D         2 yr Degree     1                  4000     1             Good     1             5     1                      2     1                     4     1\n4          F                 D         2 yr Degree     1                  3000     1             Good     1             2     1                      3     1                     2     1\n5          F                 D         2 yr Degree     1                  1500     1             Good     1             0     1                      0     1                     1     1\n6          F                 D         2 yr Degree     1                  7500     1        High Risk     1             3     1                      1     1                     0     1\n7          F                 D         2 yr Degree     1                  4500     1             Good     1             0     1                      2     1                     0     1\n8          F                 D         2 yr Degree     1                  7000     1          Unknown     1             1     1                      0     1                     6     1\n9          F                 D         2 yr Degree     1                  7500     1        High Risk     1             4     1                      0     1                     5     1\n10         F                 D         2 yr Degree     1                  8500     1         Low Risk     1             1     1                      6     1                     0     1\n11         F                 D         2 yr Degree     1                  4500     1         Low Risk     1             6     1                      2     1                     5     1\n12         F                 D         2 yr Degree     1                  3000     1             Good     1             5     1                      4     1                     3     1\n13         F                 D         2 yr Degree     1                  3000     1          Unknown     1             6     1                      1     1                     1     1\n14         F                 D         2 yr Degree     1                  2500     1         Low Risk     1             4     1                      5     1                     5     1\n15         F                 D         2 yr Degree     1                  3500     1         Low Risk     1             6     1                      5     1                     2     1\n16         F                 D         2 yr Degree     1                   500     1         Low Risk     1             4     1                      3     1                     3     1\n17         F                 D         2 yr Degree     1                  2500     1         Low Risk     1             0     1                      5     1                     4     1\n18         F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n1          F                 D         2 yr Degree     1                   500     1         Low Risk     1             4     1                      3     1                     3     1\n2          F                 D         2 yr Degree     1                  1000     1             Good     1             6     1                      3     1                     5     1\n3          F                 D         2 yr Degree     1                  1500     1             Good     1             0     1                      0     1                     1     1\n4          F                 D         2 yr Degree     1                  2000     1        High Risk     1             4     1                      3     1                     6     1\n5          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             4     1                      5     1                     5     1\n6          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             0     1                      5     1                     4     1\n7          F                 D         2 yr Degree     1                  3000     1             Good     1             2     1                      3     1                     2     1\n8          F                 D         2 yr Degree     1                  3000     1          Unknown     1             6     1                      1     1                     1     1\n9          F                 D         2 yr Degree     1                  3000     1             Good     1             5     1                      4     1                     3     1\n10         F                 D         2 yr Degree     1                  3500     1         Low Risk     1             6     1                      5     1                     2     1\n11         F                 D         2 yr Degree     1                  4000     1             Good     1             5     1                      2     1                     4     1\n12         F                 D         2 yr Degree     1                  4500     1         Low Risk     1             6     1                      2     1                     5     1\n13         F                 D         2 yr Degree     1                  4500     1        High Risk     1             4     1                      6     1                     2     1\n14         F                 D         2 yr Degree     1                  4500     1             Good     1             0     1                      2     1                     0     1\n15         F                 D         2 yr Degree     1                  5000     1        High Risk     1             4     1                      2     1                     3     1\n16         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             6     1                      3     1                     3     1\n17         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             3     1                      4     1                     4     1\n18         F                 D         2 yr Degree     1                  5500     1          Unknown     1             0     1                      6     1                     1     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020735,
                    "execution_time": 0.008135,
                    "compile_time": 8.3e-05,
                    "planning_time": 0.005643
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057484,
                    "execution_time": 0.008523,
                    "compile_time": 8.7e-05,
                    "planning_time": 0.041626
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n1          F                 D         2 yr Degree     1                   500     1         Low Risk     1             4     1                      3     1                     3     1\n2          F                 D         2 yr Degree     1                  1000     1             Good     1             6     1                      3     1                     5     1\n3          F                 D         2 yr Degree     1                  1500     1             Good     1             0     1                      0     1                     1     1\n4          F                 D         2 yr Degree     1                  2000     1        High Risk     1             4     1                      3     1                     6     1\n5          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             4     1                      5     1                     5     1\n6          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             0     1                      5     1                     4     1\n7          F                 D         2 yr Degree     1                  3000     1             Good     1             2     1                      3     1                     2     1\n8          F                 D         2 yr Degree     1                  3000     1          Unknown     1             6     1                      1     1                     1     1\n9          F                 D         2 yr Degree     1                  3000     1             Good     1             5     1                      4     1                     3     1\n10         F                 D         2 yr Degree     1                  3500     1         Low Risk     1             6     1                      5     1                     2     1\n11         F                 D         2 yr Degree     1                  4000     1             Good     1             5     1                      2     1                     4     1\n12         F                 D         2 yr Degree     1                  4500     1         Low Risk     1             6     1                      2     1                     5     1\n13         F                 D         2 yr Degree     1                  4500     1        High Risk     1             4     1                      6     1                     2     1\n14         F                 D         2 yr Degree     1                  4500     1             Good     1             0     1                      2     1                     0     1\n15         F                 D         2 yr Degree     1                  5000     1        High Risk     1             4     1                      2     1                     3     1\n16         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             6     1                      3     1                     3     1\n17         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             3     1                      4     1                     4     1\n18         F                 D         2 yr Degree     1                  5500     1          Unknown     1             0     1                      6     1                     1     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" , \"CD_CREDIT_RATING\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1         Low Risk     1             4     1                      3     1                     3     1\n1          F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n2          F                 D         2 yr Degree     1                  1000     1             Good     1             6     1                      3     1                     5     1\n3          F                 D         2 yr Degree     1                  1500     1             Good     1             0     1                      0     1                     1     1\n4          F                 D         2 yr Degree     1                  2000     1        High Risk     1             4     1                      3     1                     6     1\n5          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             4     1                      5     1                     5     1\n6          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             0     1                      5     1                     4     1\n7          F                 D         2 yr Degree     1                  3000     1             Good     1             2     1                      3     1                     2     1\n8          F                 D         2 yr Degree     1                  3000     1             Good     1             5     1                      4     1                     3     1\n9          F                 D         2 yr Degree     1                  3000     1          Unknown     1             6     1                      1     1                     1     1\n10         F                 D         2 yr Degree     1                  3500     1         Low Risk     1             6     1                      5     1                     2     1\n11         F                 D         2 yr Degree     1                  4000     1             Good     1             5     1                      2     1                     4     1\n12         F                 D         2 yr Degree     1                  4500     1             Good     1             0     1                      2     1                     0     1\n13         F                 D         2 yr Degree     1                  4500     1        High Risk     1             4     1                      6     1                     2     1\n14         F                 D         2 yr Degree     1                  4500     1         Low Risk     1             6     1                      2     1                     5     1\n15         F                 D         2 yr Degree     1                  5000     1        High Risk     1             4     1                      2     1                     3     1\n16         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             3     1                      4     1                     4     1\n17         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             6     1                      3     1                     3     1\n18         F                 D         2 yr Degree     1                  5500     1          Unknown     1             0     1                      6     1                     1     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022054,
                    "execution_time": 0.009063,
                    "compile_time": 8.6e-05,
                    "planning_time": 0.005887
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057722,
                    "execution_time": 0.009031,
                    "compile_time": 8.8e-05,
                    "planning_time": 0.041445
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1         Low Risk     1             4     1                      3     1                     3     1\n1          F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n2          F                 D         2 yr Degree     1                  1000     1             Good     1             6     1                      3     1                     5     1\n3          F                 D         2 yr Degree     1                  1500     1             Good     1             0     1                      0     1                     1     1\n4          F                 D         2 yr Degree     1                  2000     1        High Risk     1             4     1                      3     1                     6     1\n5          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             4     1                      5     1                     5     1\n6          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             0     1                      5     1                     4     1\n7          F                 D         2 yr Degree     1                  3000     1             Good     1             2     1                      3     1                     2     1\n8          F                 D         2 yr Degree     1                  3000     1             Good     1             5     1                      4     1                     3     1\n9          F                 D         2 yr Degree     1                  3000     1          Unknown     1             6     1                      1     1                     1     1\n10         F                 D         2 yr Degree     1                  3500     1         Low Risk     1             6     1                      5     1                     2     1\n11         F                 D         2 yr Degree     1                  4000     1             Good     1             5     1                      2     1                     4     1\n12         F                 D         2 yr Degree     1                  4500     1             Good     1             0     1                      2     1                     0     1\n13         F                 D         2 yr Degree     1                  4500     1        High Risk     1             4     1                      6     1                     2     1\n14         F                 D         2 yr Degree     1                  4500     1         Low Risk     1             6     1                      2     1                     5     1\n15         F                 D         2 yr Degree     1                  5000     1        High Risk     1             4     1                      2     1                     3     1\n16         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             3     1                      4     1                     4     1\n17         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             6     1                      3     1                     3     1\n18         F                 D         2 yr Degree     1                  5500     1          Unknown     1             0     1                      6     1                     1     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) as cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" , \"CD_CREDIT_RATING\" , \"CD_DEP_COUNT\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1         Low Risk     1             4     1                      3     1                     3     1\n1          F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n2          F                 D         2 yr Degree     1                  1000     1             Good     1             6     1                      3     1                     5     1\n3          F                 D         2 yr Degree     1                  1500     1             Good     1             0     1                      0     1                     1     1\n4          F                 D         2 yr Degree     1                  2000     1        High Risk     1             4     1                      3     1                     6     1\n5          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             0     1                      5     1                     4     1\n6          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             4     1                      5     1                     5     1\n7          F                 D         2 yr Degree     1                  3000     1             Good     1             2     1                      3     1                     2     1\n8          F                 D         2 yr Degree     1                  3000     1             Good     1             5     1                      4     1                     3     1\n9          F                 D         2 yr Degree     1                  3000     1          Unknown     1             6     1                      1     1                     1     1\n10         F                 D         2 yr Degree     1                  3500     1         Low Risk     1             6     1                      5     1                     2     1\n11         F                 D         2 yr Degree     1                  4000     1             Good     1             5     1                      2     1                     4     1\n12         F                 D         2 yr Degree     1                  4500     1             Good     1             0     1                      2     1                     0     1\n13         F                 D         2 yr Degree     1                  4500     1        High Risk     1             4     1                      6     1                     2     1\n14         F                 D         2 yr Degree     1                  4500     1         Low Risk     1             6     1                      2     1                     5     1\n15         F                 D         2 yr Degree     1                  5000     1        High Risk     1             4     1                      2     1                     3     1\n16         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             3     1                      4     1                     4     1\n17         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             6     1                      3     1                     3     1\n18         F                 D         2 yr Degree     1                  5500     1          Unknown     1             0     1                      6     1                     1     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021512,
                    "execution_time": 0.008514,
                    "compile_time": 8.4e-05,
                    "planning_time": 0.005872
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057749,
                    "execution_time": 0.008685,
                    "compile_time": 8.8e-05,
                    "planning_time": 0.041763
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1         Low Risk     1             4     1                      3     1                     3     1\n1          F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n2          F                 D         2 yr Degree     1                  1000     1             Good     1             6     1                      3     1                     5     1\n3          F                 D         2 yr Degree     1                  1500     1             Good     1             0     1                      0     1                     1     1\n4          F                 D         2 yr Degree     1                  2000     1        High Risk     1             4     1                      3     1                     6     1\n5          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             0     1                      5     1                     4     1\n6          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             4     1                      5     1                     5     1\n7          F                 D         2 yr Degree     1                  3000     1             Good     1             2     1                      3     1                     2     1\n8          F                 D         2 yr Degree     1                  3000     1             Good     1             5     1                      4     1                     3     1\n9          F                 D         2 yr Degree     1                  3000     1          Unknown     1             6     1                      1     1                     1     1\n10         F                 D         2 yr Degree     1                  3500     1         Low Risk     1             6     1                      5     1                     2     1\n11         F                 D         2 yr Degree     1                  4000     1             Good     1             5     1                      2     1                     4     1\n12         F                 D         2 yr Degree     1                  4500     1             Good     1             0     1                      2     1                     0     1\n13         F                 D         2 yr Degree     1                  4500     1        High Risk     1             4     1                      6     1                     2     1\n14         F                 D         2 yr Degree     1                  4500     1         Low Risk     1             6     1                      2     1                     5     1\n15         F                 D         2 yr Degree     1                  5000     1        High Risk     1             4     1                      2     1                     3     1\n16         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             3     1                      4     1                     4     1\n17         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             6     1                      3     1                     3     1\n18         F                 D         2 yr Degree     1                  5500     1          Unknown     1             0     1                      6     1                     1     1\n...*/"
    },
    {
        "input": "select /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c, customer_address ca, customer_demographics cd\n where\n  c.C_CURRENT_ADDR_SK = ca.CA_ADDRESS_SK and\n  ca.CA_COUNTY in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd.CD_DEMO_SK = c.C_CURRENT_CDEMO_SK and \n  exists (select *\n          from store_sales ss, date_dim dd\n          where c.C_CUSTOMER_SK = ss.SS_CUSTOMER_SK and\n                ss.SS_SOLD_DATE_SK = dd.D_DATE_SK and\n                dd.D_YEAR = 2000 and\n                dd.D_MOY between 2 and 2+3) and\n   (exists (select *\n            from web_sales ws, date_dim dd\n            where c.C_CUSTOMER_SK = ws.WS_BILL_CUSTOMER_SK and\n                  ws.WS_SOLD_DATE_SK = dd.D_DATE_SK and\n                  dd.D_YEAR = 2000 and\n                  dd.D_MOY between 2 and 2+3) or \n    exists (select * \n            from catalog_sales cs, date_dim dd\n            where c.C_CUSTOMER_SK = cs.CS_SHIP_CUSTOMER_SK and\n                  cs.CS_SOLD_DATE_SK = dd.D_DATE_SK and\n                  dd.D_YEAR = 2000 and\n                  dd.D_MOY between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DD\" AS ( SELECT \"DD\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DD\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DD\".\"D_DATE\" AS \"D_DATE\" , \"DD\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DD\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DD\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DD\".\"D_YEAR\" AS \"D_YEAR\" , \"DD\".\"D_DOW\" AS \"D_DOW\" , \"DD\".\"D_MOY\" AS \"D_MOY\" , \"DD\".\"D_DOM\" AS \"D_DOM\" , \"DD\".\"D_QOY\" AS \"D_QOY\" , \"DD\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DD\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DD\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DD\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DD\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DD\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DD\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DD\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DD\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DD\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DD\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DD\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DD\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DD\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DD\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DD\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DD\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DD\" WHERE \"DD\".\"D_MOY\" <= 5 AND \"DD\".\"D_MOY\" >= 2 AND \"DD\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"DD\" AS \"DD\" ON \"DD\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" GROUP BY \"SS\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"DD\" AS \"DD\" ON \"DD\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" GROUP BY \"WS\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"DD\" AS \"DD\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"DD\".\"D_DATE_SK\" GROUP BY \"CS\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"DD\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DD\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DD\".\"D_DATE\" AS \"D_DATE\" , \"DD\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DD\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DD\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DD\".\"D_YEAR\" AS \"D_YEAR\" , \"DD\".\"D_DOW\" AS \"D_DOW\" , \"DD\".\"D_MOY\" AS \"D_MOY\" , \"DD\".\"D_DOM\" AS \"D_DOM\" , \"DD\".\"D_QOY\" AS \"D_QOY\" , \"DD\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DD\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DD\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DD\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DD\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DD\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DD\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DD\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DD\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DD\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DD\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DD\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DD\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DD\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DD\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DD\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DD\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DD\" WHERE \"DD\".\"D_MOY\" <= 5 AND \"DD\".\"D_MOY\" >= 2",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.220368,
                    "execution_time": 0.058659,
                    "compile_time": 0.000319,
                    "planning_time": 0.029569,
                    "create_size": 1116
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.285374,
                    "execution_time": 0.059192,
                    "compile_time": 0.00032,
                    "planning_time": 0.093836,
                    "create_size": 1116
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" GROUP BY \"SS\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.277235,
                    "execution_time": 0.175671,
                    "compile_time": 0.000346,
                    "planning_time": 0.02743,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.34636,
                    "execution_time": 0.17687,
                    "compile_time": 0.000349,
                    "planning_time": 0.094815,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" GROUP BY \"WS\".\"WS_BILL_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.143863,
                    "execution_time": 0.065666,
                    "compile_time": 0.000328,
                    "planning_time": 0.029048,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.21082,
                    "execution_time": 0.06558,
                    "compile_time": 0.000359,
                    "planning_time": 0.093813,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"SPEQLITE_TEMP_TABLE_18\".\"D_DATE_SK\" GROUP BY \"CS\".\"CS_SHIP_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.200804,
                    "execution_time": 0.095033,
                    "compile_time": 0.000365,
                    "planning_time": 0.029628,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.294869,
                    "execution_time": 0.127114,
                    "compile_time": 0.000343,
                    "planning_time": 0.092278,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_22\" AS SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ON \"SPEQLITE_TEMP_TABLE_20\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" ON \"SPEQLITE_TEMP_TABLE_21\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_19\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_20\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_21\".\"_U_5\" IS NULL ) GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.185868,
                    "execution_time": 0.085969,
                    "compile_time": 0.000616,
                    "planning_time": 0.051972,
                    "create_size": 136
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.271628,
                    "execution_time": 0.100531,
                    "compile_time": 0.000653,
                    "planning_time": 0.122414,
                    "create_size": 136
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" , \"CD_CREDIT_RATING\" , \"CD_DEP_COUNT\" , \"CD_DEP_EMPLOYED_COUNT\" , \"CD_DEP_COLLEGE_COUNT\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1         Low Risk     1             4     1                      3     1                     3     1\n1          F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n2          F                 D         2 yr Degree     1                  1000     1             Good     1             6     1                      3     1                     5     1\n3          F                 D         2 yr Degree     1                  1500     1             Good     1             0     1                      0     1                     1     1\n4          F                 D         2 yr Degree     1                  2000     1        High Risk     1             4     1                      3     1                     6     1\n5          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             0     1                      5     1                     4     1\n6          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             4     1                      5     1                     5     1\n7          F                 D         2 yr Degree     1                  3000     1             Good     1             2     1                      3     1                     2     1\n8          F                 D         2 yr Degree     1                  3000     1             Good     1             5     1                      4     1                     3     1\n9          F                 D         2 yr Degree     1                  3000     1          Unknown     1             6     1                      1     1                     1     1\n10         F                 D         2 yr Degree     1                  3500     1         Low Risk     1             6     1                      5     1                     2     1\n11         F                 D         2 yr Degree     1                  4000     1             Good     1             5     1                      2     1                     4     1\n12         F                 D         2 yr Degree     1                  4500     1             Good     1             0     1                      2     1                     0     1\n13         F                 D         2 yr Degree     1                  4500     1        High Risk     1             4     1                      6     1                     2     1\n14         F                 D         2 yr Degree     1                  4500     1         Low Risk     1             6     1                      2     1                     5     1\n15         F                 D         2 yr Degree     1                  5000     1        High Risk     1             4     1                      2     1                     3     1\n16         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             3     1                      4     1                     4     1\n17         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             6     1                      3     1                     3     1\n18         F                 D         2 yr Degree     1                  5500     1          Unknown     1             0     1                      6     1                     1     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021982,
                    "execution_time": 0.008807,
                    "compile_time": 8.6e-05,
                    "planning_time": 0.00604
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058522,
                    "execution_time": 0.008744,
                    "compile_time": 9.1e-05,
                    "planning_time": 0.04234
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ON \"SPEQLITE_TEMP_TABLE_20\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" ON \"SPEQLITE_TEMP_TABLE_21\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_19\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_20\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_21\".\"_U_5\" IS NULL ) GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_22\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1         Low Risk     1             4     1                      3     1                     3     1\n1          F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n2          F                 D         2 yr Degree     1                  1000     1             Good     1             6     1                      3     1                     5     1\n3          F                 D         2 yr Degree     1                  1500     1             Good     1             0     1                      0     1                     1     1\n4          F                 D         2 yr Degree     1                  2000     1        High Risk     1             4     1                      3     1                     6     1\n5          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             0     1                      5     1                     4     1\n6          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             4     1                      5     1                     5     1\n7          F                 D         2 yr Degree     1                  3000     1             Good     1             2     1                      3     1                     2     1\n8          F                 D         2 yr Degree     1                  3000     1             Good     1             5     1                      4     1                     3     1\n9          F                 D         2 yr Degree     1                  3000     1          Unknown     1             6     1                      1     1                     1     1\n10         F                 D         2 yr Degree     1                  3500     1         Low Risk     1             6     1                      5     1                     2     1\n11         F                 D         2 yr Degree     1                  4000     1             Good     1             5     1                      2     1                     4     1\n12         F                 D         2 yr Degree     1                  4500     1             Good     1             0     1                      2     1                     0     1\n13         F                 D         2 yr Degree     1                  4500     1        High Risk     1             4     1                      6     1                     2     1\n14         F                 D         2 yr Degree     1                  4500     1         Low Risk     1             6     1                      2     1                     5     1\n15         F                 D         2 yr Degree     1                  5000     1        High Risk     1             4     1                      2     1                     3     1\n16         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             3     1                      4     1                     4     1\n17         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             6     1                      3     1                     3     1\n18         F                 D         2 yr Degree     1                  5500     1          Unknown     1             0     1                      6     1                     1     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" , \"CD_CREDIT_RATING\" , \"CD_DEP_COUNT\" , \"CD_DEP_EMPLOYED_COUNT\" , \"CD_DEP_COLLEGE_COUNT\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1         Low Risk     1             4     1                      3     1                     3     1\n1          F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n2          F                 D         2 yr Degree     1                  1000     1             Good     1             6     1                      3     1                     5     1\n3          F                 D         2 yr Degree     1                  1500     1             Good     1             0     1                      0     1                     1     1\n4          F                 D         2 yr Degree     1                  2000     1        High Risk     1             4     1                      3     1                     6     1\n5          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             0     1                      5     1                     4     1\n6          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             4     1                      5     1                     5     1\n7          F                 D         2 yr Degree     1                  3000     1             Good     1             2     1                      3     1                     2     1\n8          F                 D         2 yr Degree     1                  3000     1             Good     1             5     1                      4     1                     3     1\n9          F                 D         2 yr Degree     1                  3000     1          Unknown     1             6     1                      1     1                     1     1\n10         F                 D         2 yr Degree     1                  3500     1         Low Risk     1             6     1                      5     1                     2     1\n11         F                 D         2 yr Degree     1                  4000     1             Good     1             5     1                      2     1                     4     1\n12         F                 D         2 yr Degree     1                  4500     1             Good     1             0     1                      2     1                     0     1\n13         F                 D         2 yr Degree     1                  4500     1        High Risk     1             4     1                      6     1                     2     1\n14         F                 D         2 yr Degree     1                  4500     1         Low Risk     1             6     1                      2     1                     5     1\n15         F                 D         2 yr Degree     1                  5000     1        High Risk     1             4     1                      2     1                     3     1\n16         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             3     1                      4     1                     4     1\n17         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             6     1                      3     1                     3     1\n18         F                 D         2 yr Degree     1                  5500     1          Unknown     1             0     1                      6     1                     1     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022135,
                    "execution_time": 0.008376,
                    "compile_time": 9.3e-05,
                    "planning_time": 0.00629
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.082725,
                    "execution_time": 0.008454,
                    "compile_time": 8.6e-05,
                    "planning_time": 0.066901
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1         Low Risk     1             4     1                      3     1                     3     1\n1          F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n2          F                 D         2 yr Degree     1                  1000     1             Good     1             6     1                      3     1                     5     1\n3          F                 D         2 yr Degree     1                  1500     1             Good     1             0     1                      0     1                     1     1\n4          F                 D         2 yr Degree     1                  2000     1        High Risk     1             4     1                      3     1                     6     1\n5          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             0     1                      5     1                     4     1\n6          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             4     1                      5     1                     5     1\n7          F                 D         2 yr Degree     1                  3000     1             Good     1             2     1                      3     1                     2     1\n8          F                 D         2 yr Degree     1                  3000     1             Good     1             5     1                      4     1                     3     1\n9          F                 D         2 yr Degree     1                  3000     1          Unknown     1             6     1                      1     1                     1     1\n10         F                 D         2 yr Degree     1                  3500     1         Low Risk     1             6     1                      5     1                     2     1\n11         F                 D         2 yr Degree     1                  4000     1             Good     1             5     1                      2     1                     4     1\n12         F                 D         2 yr Degree     1                  4500     1             Good     1             0     1                      2     1                     0     1\n13         F                 D         2 yr Degree     1                  4500     1        High Risk     1             4     1                      6     1                     2     1\n14         F                 D         2 yr Degree     1                  4500     1         Low Risk     1             6     1                      2     1                     5     1\n15         F                 D         2 yr Degree     1                  5000     1        High Risk     1             4     1                      2     1                     3     1\n16         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             3     1                      4     1                     4     1\n17         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             6     1                      3     1                     3     1\n18         F                 D         2 yr Degree     1                  5500     1          Unknown     1             0     1                      6     1                     1     1\n...*/"
    },
    {
        "input": "-- start template query10.tpl query 26 in stream 0\nselect /* TPC-DS query10.tpl 0.26 */\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3,\n  cd_dep_count,\n  count(*) cnt4,\n  cd_dep_employed_count,\n  count(*) cnt5,\n  cd_dep_college_count,\n  count(*) cnt6\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_county in ('Chautauqua County','Cherokee County','Bell County','Washington County','Clarke County') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2000 and\n                d_moy between 2 and 2+3) and\n   (exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 ANd 2+3) or \n    exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2000 and\n                  d_moy between 2 and 2+3))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 5 AND \"DATE_DIM\".\"D_MOY\" >= 2 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND ( NOT \"_U_2\".\"_U_3\" IS NULL OR NOT \"_U_4\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" , \"CD_CREDIT_RATING\" , \"CD_DEP_COUNT\" , \"CD_DEP_EMPLOYED_COUNT\" , \"CD_DEP_COLLEGE_COUNT\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1         Low Risk     1             4     1                      3     1                     3     1\n1          F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n2          F                 D         2 yr Degree     1                  1000     1             Good     1             6     1                      3     1                     5     1\n3          F                 D         2 yr Degree     1                  1500     1             Good     1             0     1                      0     1                     1     1\n4          F                 D         2 yr Degree     1                  2000     1        High Risk     1             4     1                      3     1                     6     1\n5          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             0     1                      5     1                     4     1\n6          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             4     1                      5     1                     5     1\n7          F                 D         2 yr Degree     1                  3000     1             Good     1             2     1                      3     1                     2     1\n8          F                 D         2 yr Degree     1                  3000     1             Good     1             5     1                      4     1                     3     1\n9          F                 D         2 yr Degree     1                  3000     1          Unknown     1             6     1                      1     1                     1     1\n10         F                 D         2 yr Degree     1                  3500     1         Low Risk     1             6     1                      5     1                     2     1\n11         F                 D         2 yr Degree     1                  4000     1             Good     1             5     1                      2     1                     4     1\n12         F                 D         2 yr Degree     1                  4500     1             Good     1             0     1                      2     1                     0     1\n13         F                 D         2 yr Degree     1                  4500     1        High Risk     1             4     1                      6     1                     2     1\n14         F                 D         2 yr Degree     1                  4500     1         Low Risk     1             6     1                      2     1                     5     1\n15         F                 D         2 yr Degree     1                  5000     1        High Risk     1             4     1                      2     1                     3     1\n16         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             3     1                      4     1                     4     1\n17         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             6     1                      3     1                     3     1\n18         F                 D         2 yr Degree     1                  5500     1          Unknown     1             0     1                      6     1                     1     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022003,
                    "execution_time": 0.00857,
                    "compile_time": 8.8e-05,
                    "planning_time": 0.006135
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.022444,
                    "execution_time": 0.008696,
                    "compile_time": 8.7e-05,
                    "planning_time": 0.006325
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT4\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT5\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT6\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" ON \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_COUNTY\" IN ( 'Chautauqua County' , 'Cherokee County' , 'Bell County' , 'Washington County' , 'Clarke County' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" IS NULL AND ( NOT \"SPEQLITE_TEMP_TABLE_15\".\"_U_3\" IS NULL OR NOT \"SPEQLITE_TEMP_TABLE_16\".\"_U_5\" IS NULL ) GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT4\" AS \"CNT4\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT5\" AS \"CNT5\" , \"SPEQLITE_TEMP_TABLE_17\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT6\" AS \"CNT6\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3  cd_dep_count  cnt4  cd_dep_employed_count  cnt5  cd_dep_college_count  cnt6\n0          F                 D         2 yr Degree     1                   500     1         Low Risk     1             4     1                      3     1                     3     1\n1          F                 D         2 yr Degree     1                   500     1          Unknown     1             4     1                      6     1                     4     1\n2          F                 D         2 yr Degree     1                  1000     1             Good     1             6     1                      3     1                     5     1\n3          F                 D         2 yr Degree     1                  1500     1             Good     1             0     1                      0     1                     1     1\n4          F                 D         2 yr Degree     1                  2000     1        High Risk     1             4     1                      3     1                     6     1\n5          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             0     1                      5     1                     4     1\n6          F                 D         2 yr Degree     1                  2500     1         Low Risk     1             4     1                      5     1                     5     1\n7          F                 D         2 yr Degree     1                  3000     1             Good     1             2     1                      3     1                     2     1\n8          F                 D         2 yr Degree     1                  3000     1             Good     1             5     1                      4     1                     3     1\n9          F                 D         2 yr Degree     1                  3000     1          Unknown     1             6     1                      1     1                     1     1\n10         F                 D         2 yr Degree     1                  3500     1         Low Risk     1             6     1                      5     1                     2     1\n11         F                 D         2 yr Degree     1                  4000     1             Good     1             5     1                      2     1                     4     1\n12         F                 D         2 yr Degree     1                  4500     1             Good     1             0     1                      2     1                     0     1\n13         F                 D         2 yr Degree     1                  4500     1        High Risk     1             4     1                      6     1                     2     1\n14         F                 D         2 yr Degree     1                  4500     1         Low Risk     1             6     1                      2     1                     5     1\n15         F                 D         2 yr Degree     1                  5000     1        High Risk     1             4     1                      2     1                     3     1\n16         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             3     1                      4     1                     4     1\n17         F                 D         2 yr Degree     1                  5500     1         Low Risk     1             6     1                      3     1                     3     1\n18         F                 D         2 yr Degree     1                  5500     1          Unknown     1             0     1                      6     1                     1     1\n...*/"
    }
]