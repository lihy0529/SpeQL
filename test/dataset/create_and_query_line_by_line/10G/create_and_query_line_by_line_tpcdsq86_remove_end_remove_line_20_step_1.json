[
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,(select d_date_sk, d_month_seq from date_dim) d1\n   ,(select i_item_sk, i_category, i_class from item) i\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i.i_item_sk  = ws_item_sk\n group by i_category,i_class\n )\nselect * from results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1216 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1216 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.142645,
                    "execution_time": 0.063536,
                    "compile_time": 0.000412,
                    "planning_time": 0.045231,
                    "create_size": 64
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.243872,
                    "execution_time": 0.083271,
                    "compile_time": 0.000421,
                    "planning_time": 0.123219,
                    "create_size": 64
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_CLASS\" AS \"G_CLASS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*      total_sum   i_category          i_class  g_category  g_class\n0   82983302.81        Women          dresses           0        0\n1   21528200.86         Home            paint           0        0\n2   80920936.29     Children          newborn           0        0\n3   80849841.28        Women         swimwear           0        0\n4   21013127.86         Home         flatware           0        0\n5   21249270.99      Jewelry       mens watch           0        0\n6   20189531.62        Books        reference           0        0\n7   83961037.44        Music          country           0        0\n8   83703579.51     Children  school-uniforms           0        0\n9   20714020.45       Sports          outdoor           0        0\n10  19757205.06  Electronics         portable           0        0\n11  21444164.70      Jewelry         pendants           0        0\n12  21034743.27  Electronics         scanners           0        0\n13  19356153.51  Electronics          musical           0        0\n14  18851443.67      Jewelry          costume           0        0\n15  18921551.81         Home            decor           0        0\n16  20619346.60  Electronics       camcorders           0        0\n17  22306849.67      Jewelry    jewelry boxes           0        0\n18  23101894.18  Electronics  dvd/vcr players           0        0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019086,
                    "execution_time": 0.007816,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.004272
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055106,
                    "execution_time": 0.007538,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039717
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_CLASS\" AS \"G_CLASS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"G_CLASS\" AS \"G_CLASS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*      total_sum   i_category          i_class  g_category  g_class\n0   82983302.81        Women          dresses           0        0\n1   21528200.86         Home            paint           0        0\n2   80920936.29     Children          newborn           0        0\n3   80849841.28        Women         swimwear           0        0\n4   21013127.86         Home         flatware           0        0\n5   21249270.99      Jewelry       mens watch           0        0\n6   20189531.62        Books        reference           0        0\n7   83961037.44        Music          country           0        0\n8   83703579.51     Children  school-uniforms           0        0\n9   20714020.45       Sports          outdoor           0        0\n10  19757205.06  Electronics         portable           0        0\n11  21444164.70      Jewelry         pendants           0        0\n12  21034743.27  Electronics         scanners           0        0\n13  19356153.51  Electronics          musical           0        0\n14  18851443.67      Jewelry          costume           0        0\n15  18921551.81         Home            decor           0        0\n16  20619346.60  Electronics       camcorders           0        0\n17  22306849.67      Jewelry    jewelry boxes           0        0\n18  23101894.18  Electronics  dvd/vcr players           0        0\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) \nselect * from results\n/*CURSOR_IDENTIFIER*/\n",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.143406,
                    "execution_time": 0.064725,
                    "compile_time": 0.000417,
                    "planning_time": 0.04501,
                    "create_size": 64
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.217056,
                    "execution_time": 0.06355,
                    "compile_time": 0.00042,
                    "planning_time": 0.120275,
                    "create_size": 64
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*      total_sum   i_category          i_class  g_category  g_class\n0   80849841.28        Women         swimwear           0        0\n1   21033829.26      Jewelry             gold           0        0\n2   21249270.99      Jewelry       mens watch           0        0\n3   18921551.81         Home            decor           0        0\n4   80920936.29     Children          newborn           0        0\n5   83961037.44        Music          country           0        0\n6   83703579.51     Children  school-uniforms           0        0\n7   21444164.70      Jewelry         pendants           0        0\n8   20714020.45       Sports          outdoor           0        0\n9   82983302.81        Women          dresses           0        0\n10  18851443.67      Jewelry          costume           0        0\n11  22306849.67      Jewelry    jewelry boxes           0        0\n12  21013127.86         Home         flatware           0        0\n13  21034743.27  Electronics         scanners           0        0\n14  21528200.86         Home            paint           0        0\n15  20189531.62        Books        reference           0        0\n16  23101894.18  Electronics  dvd/vcr players           0        0\n17  21183359.20      Jewelry           custom           0        0\n18  20619346.60  Electronics       camcorders           0        0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017387,
                    "execution_time": 0.007247,
                    "compile_time": 5e-05,
                    "planning_time": 0.003834
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05387,
                    "execution_time": 0.007686,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.039756
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*      total_sum   i_category          i_class  g_category  g_class\n0   80849841.28        Women         swimwear           0        0\n1   21033829.26      Jewelry             gold           0        0\n2   21249270.99      Jewelry       mens watch           0        0\n3   18921551.81         Home            decor           0        0\n4   80920936.29     Children          newborn           0        0\n5   83961037.44        Music          country           0        0\n6   83703579.51     Children  school-uniforms           0        0\n7   21444164.70      Jewelry         pendants           0        0\n8   20714020.45       Sports          outdoor           0        0\n9   82983302.81        Women          dresses           0        0\n10  18851443.67      Jewelry          costume           0        0\n11  22306849.67      Jewelry    jewelry boxes           0        0\n12  21013127.86         Home         flatware           0        0\n13  21034743.27  Electronics         scanners           0        0\n14  21528200.86         Home            paint           0        0\n15  20189531.62        Books        reference           0        0\n16  23101894.18  Electronics  dvd/vcr players           0        0\n17  21183359.20      Jewelry           custom           0        0\n18  20619346.60  Electronics       camcorders           0        0\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n)\nselect * from results_rollup\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*      total_sum   i_category        i_class  g_category  g_class  lochierarchy\n0   20915391.66         Home         accent           0        0             0\n1   22722681.16        Books        fiction           0        0             0\n2   80515424.41        Music           rock           0        0             0\n3   22666918.40       Sports           golf           0        0             0\n4   20512927.00  Electronics         karoke           0        0             0\n5   20209218.96         Home         tables           0        0             0\n6     480539.43       Sports                          0        0             0\n7      48209.25                   glassware           0        0             0\n8      48369.75                   reference           0        0             0\n9       6036.22                   parenting           0        0             0\n10     30781.52                        kids           0        0             0\n11  21074069.26         Home       bathroom           0        0             0\n12  17884797.39      Jewelry      bracelets           0        0             0\n13  82992812.54        Shoes         womens           0        0             0\n14  18749398.41  Electronics         stereo           0        0             0\n15  83976787.20        Women     fragrances           0        0             0\n16  19371992.92  Electronics     automotive           0        0             0\n17  19563800.92  Electronics       wireless           0        0             0\n18  17576571.95      Jewelry  semi-precious           0        0             0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017515,
                    "execution_time": 0.007283,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003971
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053864,
                    "execution_time": 0.007694,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.039629
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*      total_sum   i_category        i_class  g_category  g_class  lochierarchy\n0   20915391.66         Home         accent           0        0             0\n1   22722681.16        Books        fiction           0        0             0\n2   80515424.41        Music           rock           0        0             0\n3   22666918.40       Sports           golf           0        0             0\n4   20512927.00  Electronics         karoke           0        0             0\n5   20209218.96         Home         tables           0        0             0\n6     480539.43       Sports                          0        0             0\n7      48209.25                   glassware           0        0             0\n8      48369.75                   reference           0        0             0\n9       6036.22                   parenting           0        0             0\n10     30781.52                        kids           0        0             0\n11  21074069.26         Home       bathroom           0        0             0\n12  17884797.39      Jewelry      bracelets           0        0             0\n13  82992812.54        Shoes         womens           0        0             0\n14  18749398.41  Electronics         stereo           0        0             0\n15  83976787.20        Women     fragrances           0        0             0\n16  19371992.92  Electronics     automotive           0        0             0\n17  19563800.92  Electronics       wireless           0        0             0\n18  17576571.95      Jewelry  semi-precious           0        0             0\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n)\nselect * from results_rollup\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS_ROLLUP\".\"G_CLASS\" AS \"G_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" UNION SELECT SUM ( \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" GROUP BY \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.085542,
                    "execution_time": 0.049118,
                    "compile_time": 0.000427,
                    "planning_time": 0.007751,
                    "create_size": 9
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.132865,
                    "execution_time": 0.050106,
                    "compile_time": 0.000415,
                    "planning_time": 0.049471,
                    "create_size": 9
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category          i_class  g_category  g_class  lochierarchy\n0   2.090061e+07         Home    blinds/shades           0        0             0\n1   7.845518e+07          Men            pants           0        0             0\n2   3.297832e+08       Sports             None           0        1             1\n3   8.298859e+04                      lighting           0        0             0\n4   8.133108e+07          Men           shirts           0        0             0\n5   2.048943e+07        Books           travel           0        0             0\n6   2.133674e+07  Electronics      televisions           0        0             0\n7   4.613931e+04                        tables           0        0             0\n8   2.144416e+07      Jewelry         pendants           0        0             0\n9   8.298330e+07        Women          dresses           0        0             0\n10  1.885144e+07      Jewelry          costume           0        0             0\n11  2.103474e+07  Electronics         scanners           0        0             0\n12  4.497190e+04               curtains/drapes           0        0             0\n13  5.488134e+04                          arts           0        0             0\n14  3.343185e+08     Children             None           0        1             1\n15  2.092572e+07         Home        furniture           0        0             0\n16  8.314040e+07        Music        classical           0        0             0\n17  4.483967e+04                      portable           0        0             0\n18  8.348174e+07          Men   sports-apparel           0        0             0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01812,
                    "execution_time": 0.007735,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004076
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057167,
                    "execution_time": 0.007443,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.039965
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*       total_sum   i_category          i_class  g_category  g_class  lochierarchy\n0   2.090061e+07         Home    blinds/shades           0        0             0\n1   7.845518e+07          Men            pants           0        0             0\n2   3.297832e+08       Sports             None           0        1             1\n3   8.298859e+04                      lighting           0        0             0\n4   8.133108e+07          Men           shirts           0        0             0\n5   2.048943e+07        Books           travel           0        0             0\n6   2.133674e+07  Electronics      televisions           0        0             0\n7   4.613931e+04                        tables           0        0             0\n8   2.144416e+07      Jewelry         pendants           0        0             0\n9   8.298330e+07        Women          dresses           0        0             0\n10  1.885144e+07      Jewelry          costume           0        0             0\n11  2.103474e+07  Electronics         scanners           0        0             0\n12  4.497190e+04               curtains/drapes           0        0             0\n13  5.488134e+04                          arts           0        0             0\n14  3.343185e+08     Children             None           0        1             1\n15  2.092572e+07         Home        furniture           0        0             0\n16  8.314040e+07        Music        classical           0        0             0\n17  4.483967e+04                      portable           0        0             0\n18  8.348174e+07          Men   sports-apparel           0        0             0\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n/*CURSOR_IDENTIFIER*/\nselect * from results_rollup",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS_ROLLUP\".\"G_CLASS\" AS \"G_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" UNION SELECT SUM ( \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" GROUP BY \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" UNION SELECT SUM ( \"SPEQLITE_TEMP_TABLE_2\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.102472,
                    "execution_time": 0.057653,
                    "compile_time": 0.000559,
                    "planning_time": 0.010534,
                    "create_size": 9
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.1469,
                    "execution_time": 0.056846,
                    "compile_time": 0.000529,
                    "planning_time": 0.052867,
                    "create_size": 9
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category          i_class  g_category  g_class  lochierarchy\n0   2.090061e+07         Home    blinds/shades           0        0             0\n1   7.845518e+07          Men            pants           0        0             0\n2   3.297832e+08       Sports             None           0        1             1\n3   8.298859e+04                      lighting           0        0             0\n4   7.810756e+06                          None           0        1             1\n5   8.348174e+07          Men   sports-apparel           0        0             0\n6   2.249044e+07       Sports       basketball           0        0             0\n7   8.198465e+04                         pants           0        0             0\n8   2.092572e+07         Home        furniture           0        0             0\n9   8.314040e+07        Music        classical           0        0             0\n10  4.483967e+04                      portable           0        0             0\n11  8.133108e+07          Men           shirts           0        0             0\n12  2.048943e+07        Books           travel           0        0             0\n13  2.133674e+07  Electronics      televisions           0        0             0\n14  4.613931e+04                        tables           0        0             0\n15  2.144416e+07      Jewelry         pendants           0        0             0\n16  8.298330e+07        Women          dresses           0        0             0\n17  1.885144e+07      Jewelry          costume           0        0             0\n18  2.103474e+07  Electronics         scanners           0        0             0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017428,
                    "execution_time": 0.007141,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004027
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054914,
                    "execution_time": 0.007172,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.039776
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*       total_sum   i_category          i_class  g_category  g_class  lochierarchy\n0   2.090061e+07         Home    blinds/shades           0        0             0\n1   7.845518e+07          Men            pants           0        0             0\n2   3.297832e+08       Sports             None           0        1             1\n3   8.298859e+04                      lighting           0        0             0\n4   7.810756e+06                          None           0        1             1\n5   8.348174e+07          Men   sports-apparel           0        0             0\n6   2.249044e+07       Sports       basketball           0        0             0\n7   8.198465e+04                         pants           0        0             0\n8   2.092572e+07         Home        furniture           0        0             0\n9   8.314040e+07        Music        classical           0        0             0\n10  4.483967e+04                      portable           0        0             0\n11  8.133108e+07          Men           shirts           0        0             0\n12  2.048943e+07        Books           travel           0        0             0\n13  2.133674e+07  Electronics      televisions           0        0             0\n14  4.613931e+04                        tables           0        0             0\n15  2.144416e+07      Jewelry         pendants           0        0             0\n16  8.298330e+07        Women          dresses           0        0             0\n17  1.885144e+07      Jewelry          costume           0        0             0\n18  2.103474e+07  Electronics         scanners           0        0             0\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select * from results_rollup\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS_ROLLUP\".\"G_CLASS\" AS \"G_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category          i_class  g_category  g_class  lochierarchy\n0   2.090061e+07         Home    blinds/shades           0        0             0\n1   7.845518e+07          Men            pants           0        0             0\n2   3.297832e+08       Sports             None           0        1             1\n3   8.298859e+04                      lighting           0        0             0\n4   7.810756e+06                          None           0        1             1\n5   8.348174e+07          Men   sports-apparel           0        0             0\n6   2.249044e+07       Sports       basketball           0        0             0\n7   8.198465e+04                         pants           0        0             0\n8   2.092572e+07         Home        furniture           0        0             0\n9   8.314040e+07        Music        classical           0        0             0\n10  4.483967e+04                      portable           0        0             0\n11  8.133108e+07          Men           shirts           0        0             0\n12  2.048943e+07        Books           travel           0        0             0\n13  2.133674e+07  Electronics      televisions           0        0             0\n14  4.613931e+04                        tables           0        0             0\n15  2.144416e+07      Jewelry         pendants           0        0             0\n16  8.298330e+07        Women          dresses           0        0             0\n17  1.885144e+07      Jewelry          costume           0        0             0\n18  2.103474e+07  Electronics         scanners           0        0             0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018204,
                    "execution_time": 0.007121,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.004191
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018067,
                    "execution_time": 0.007592,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004033
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" AS \"G_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*       total_sum   i_category          i_class  g_category  g_class  lochierarchy\n0   2.090061e+07         Home    blinds/shades           0        0             0\n1   7.845518e+07          Men            pants           0        0             0\n2   3.297832e+08       Sports             None           0        1             1\n3   8.298859e+04                      lighting           0        0             0\n4   7.810756e+06                          None           0        1             1\n5   8.348174e+07          Men   sports-apparel           0        0             0\n6   2.249044e+07       Sports       basketball           0        0             0\n7   8.198465e+04                         pants           0        0             0\n8   2.092572e+07         Home        furniture           0        0             0\n9   8.314040e+07        Music        classical           0        0             0\n10  4.483967e+04                      portable           0        0             0\n11  8.133108e+07          Men           shirts           0        0             0\n12  2.048943e+07        Books           travel           0        0             0\n13  2.133674e+07  Electronics      televisions           0        0             0\n14  4.613931e+04                        tables           0        0             0\n15  2.144416e+07      Jewelry         pendants           0        0             0\n16  8.298330e+07        Women          dresses           0        0             0\n17  1.885144e+07      Jewelry          costume           0        0             0\n18  2.103474e+07  Electronics         scanners           0        0             0\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n from results_rollup\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category          i_class  lochierarchy\n0   2.090061e+07         Home    blinds/shades             0\n1   7.845518e+07          Men            pants             0\n2   3.297832e+08       Sports             None             1\n3   8.298859e+04                      lighting             0\n4   7.810756e+06                          None             1\n5   8.348174e+07          Men   sports-apparel             0\n6   2.249044e+07       Sports       basketball             0\n7   8.198465e+04                         pants             0\n8   2.092572e+07         Home        furniture             0\n9   8.314040e+07        Music        classical             0\n10  4.483967e+04                      portable             0\n11  8.133108e+07          Men           shirts             0\n12  2.048943e+07        Books           travel             0\n13  2.133674e+07  Electronics      televisions             0\n14  4.613931e+04                        tables             0\n15  2.144416e+07      Jewelry         pendants             0\n16  8.298330e+07        Women          dresses             0\n17  1.885144e+07      Jewelry          costume             0\n18  2.103474e+07  Electronics         scanners             0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019497,
                    "execution_time": 0.00777,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.003803
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054482,
                    "execution_time": 0.007405,
                    "compile_time": 5e-05,
                    "planning_time": 0.039165
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*       total_sum   i_category          i_class  lochierarchy\n0   2.090061e+07         Home    blinds/shades             0\n1   7.845518e+07          Men            pants             0\n2   3.297832e+08       Sports             None             1\n3   8.298859e+04                      lighting             0\n4   7.810756e+06                          None             1\n5   8.348174e+07          Men   sports-apparel             0\n6   2.249044e+07       Sports       basketball             0\n7   8.198465e+04                         pants             0\n8   2.092572e+07         Home        furniture             0\n9   8.314040e+07        Music        classical             0\n10  4.483967e+04                      portable             0\n11  8.133108e+07          Men           shirts             0\n12  2.048943e+07        Books           travel             0\n13  2.133674e+07  Electronics      televisions             0\n14  4.613931e+04                        tables             0\n15  2.144416e+07      Jewelry         pendants             0\n16  8.298330e+07        Women          dresses             0\n17  1.885144e+07      Jewelry          costume             0\n18  2.103474e+07  Electronics         scanners             0\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (order by total_sum desc) as total_rank\n/*CURSOR_IDENTIFIER*/\nfrom results_rollup;",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"TOTAL_RANK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"TOTAL_RANK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category          i_class  lochierarchy  total_rank\n0   3.289277e+09         None             None             2           1\n1   3.343185e+08     Children             None             1           2\n2   3.302986e+08         Home             None             1           3\n3   3.299659e+08        Music             None             1           4\n4   3.299202e+08        Women             None             1           5\n5   3.297832e+08       Sports             None             1           6\n6   3.293557e+08        Shoes             None             1           7\n7   3.278090e+08          Men             None             1           8\n8   3.275018e+08  Electronics             None             1           9\n9   3.213138e+08        Books             None             1          10\n10  3.211995e+08      Jewelry             None             1          11\n11  8.643956e+07     Children          infants             0          12\n12  8.397679e+07        Women       fragrances             0          13\n13  8.396104e+07        Music          country             0          14\n14  8.394083e+07          Men      accessories             0          15\n15  8.370358e+07     Children  school-uniforms             0          16\n16  8.348174e+07          Men   sports-apparel             0          17\n17  8.324234e+07        Shoes             kids             0          18\n18  8.314040e+07        Music        classical             0          19\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021686,
                    "execution_time": 0.009404,
                    "compile_time": 9.6e-05,
                    "planning_time": 0.004526
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.061125,
                    "execution_time": 0.010582,
                    "compile_time": 9.5e-05,
                    "planning_time": 0.040064
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"TOTAL_RANK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"TOTAL_RANK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*       total_sum   i_category          i_class  lochierarchy  total_rank\n0   3.289277e+09         None             None             2           1\n1   3.343185e+08     Children             None             1           2\n2   3.302986e+08         Home             None             1           3\n3   3.299659e+08        Music             None             1           4\n4   3.299202e+08        Women             None             1           5\n5   3.297832e+08       Sports             None             1           6\n6   3.293557e+08        Shoes             None             1           7\n7   3.278090e+08          Men             None             1           8\n8   3.275018e+08  Electronics             None             1           9\n9   3.213138e+08        Books             None             1          10\n10  3.211995e+08      Jewelry             None             1          11\n11  8.643956e+07     Children          infants             0          12\n12  8.397679e+07        Women       fragrances             0          13\n13  8.396104e+07        Music          country             0          14\n14  8.394083e+07          Men      accessories             0          15\n15  8.370358e+07     Children  school-uniforms             0          16\n16  8.348174e+07          Men   sports-apparel             0          17\n17  8.324234e+07        Shoes             kids             0          18\n18  8.314040e+07        Music        classical             0          19\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim as d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk = ws_item_sk\n group by i_category,i_class\n ) ,\n\nresults_rollup as\n( select total_sum, i_category, i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum, i_category, i_class, lochierarchy \n   ,rank() over (\n    partition by lochierarchy\n    order by total_sum desc) as rnk\n from results_rollup\n /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RNK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"RNK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category          i_class  lochierarchy  rnk\n0   3.343185e+08     Children             None             1    1\n1   3.302986e+08         Home             None             1    2\n2   3.299659e+08        Music             None             1    3\n3   3.299202e+08        Women             None             1    4\n4   3.297832e+08       Sports             None             1    5\n5   3.293557e+08        Shoes             None             1    6\n6   3.278090e+08          Men             None             1    7\n7   3.275018e+08  Electronics             None             1    8\n8   3.213138e+08        Books             None             1    9\n9   3.211995e+08      Jewelry             None             1   10\n10  7.810756e+06                          None             1   11\n11  3.289277e+09         None             None             2    1\n12  8.643956e+07     Children          infants             0    1\n13  8.397679e+07        Women       fragrances             0    2\n14  8.396104e+07        Music          country             0    3\n15  8.394083e+07          Men      accessories             0    4\n16  8.370358e+07     Children  school-uniforms             0    5\n17  8.348174e+07          Men   sports-apparel             0    6\n18  8.324234e+07        Shoes             kids             0    7\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020841,
                    "execution_time": 0.009142,
                    "compile_time": 9.8e-05,
                    "planning_time": 0.004572
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060818,
                    "execution_time": 0.009749,
                    "compile_time": 0.000104,
                    "planning_time": 0.040273
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RNK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RNK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*       total_sum   i_category          i_class  lochierarchy  rnk\n0   3.343185e+08     Children             None             1    1\n1   3.302986e+08         Home             None             1    2\n2   3.299659e+08        Music             None             1    3\n3   3.299202e+08        Women             None             1    4\n4   3.297832e+08       Sports             None             1    5\n5   3.293557e+08        Shoes             None             1    6\n6   3.278090e+08          Men             None             1    7\n7   3.275018e+08  Electronics             None             1    8\n8   3.213138e+08        Books             None             1    9\n9   3.211995e+08      Jewelry             None             1   10\n10  7.810756e+06                          None             1   11\n11  3.289277e+09         None             None             2    1\n12  8.643956e+07     Children          infants             0    1\n13  8.397679e+07        Women       fragrances             0    2\n14  8.396104e+07        Music          country             0    3\n15  8.394083e+07          Men      accessories             0    4\n16  8.370358e+07     Children  school-uniforms             0    5\n17  8.348174e+07          Men   sports-apparel             0    6\n18  8.324234e+07        Shoes             kids             0    7\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category else NULL end\n ) as rank_value /*CURSOR_IDENTIFIER*/\n from results_rollup",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" ELSE NULL END ) AS \"RANK_VALUE\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ELSE NULL END ) AS \"RANK_VALUE\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*      total_sum i_category         i_class  lochierarchy  rank_value\n0   20489429.36      Books          travel             0           1\n1   18495440.70      Books         science             0           1\n2   19400090.20      Books  entertainments             0           1\n3   19581210.93      Books       parenting             0           1\n4   22722681.16      Books         fiction             0           1\n5   19947297.60      Books       self-help             0           1\n6   20700048.90      Books          sports             0           1\n7   19624469.32      Books         cooking             0           1\n8   19528170.87      Books            arts             0           1\n9   17736785.15      Books         mystery             0           1\n10  18732875.42      Books        business             0           1\n11  20238926.17      Books       computers             0           1\n12  22438751.98      Books         history             0           1\n13  20417964.78      Books     home repair             0           1\n14  20500587.23      Books         romance             0           1\n15  20189531.62      Books       reference             0           1\n16    569529.40      Books                             0           1\n17  21444164.70    Jewelry        pendants             0           1\n18  18851443.67    Jewelry         costume             0           1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.023978,
                    "execution_time": 0.009425,
                    "compile_time": 0.000109,
                    "planning_time": 0.0054
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060005,
                    "execution_time": 0.010006,
                    "compile_time": 0.0001,
                    "planning_time": 0.040565
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ELSE NULL END ) AS \"RANK_VALUE\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ELSE NULL END ) AS \"RANK_VALUE\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*      total_sum i_category         i_class  lochierarchy  rank_value\n0   20489429.36      Books          travel             0           1\n1   18495440.70      Books         science             0           1\n2   19400090.20      Books  entertainments             0           1\n3   19581210.93      Books       parenting             0           1\n4   22722681.16      Books         fiction             0           1\n5   19947297.60      Books       self-help             0           1\n6   20700048.90      Books          sports             0           1\n7   19624469.32      Books         cooking             0           1\n8   19528170.87      Books            arts             0           1\n9   17736785.15      Books         mystery             0           1\n10  18732875.42      Books        business             0           1\n11  20238926.17      Books       computers             0           1\n12  22438751.98      Books         history             0           1\n13  20417964.78      Books     home repair             0           1\n14  20500587.23      Books         romance             0           1\n15  20189531.62      Books       reference             0           1\n16    569529.40      Books                             0           1\n17  21444164.70    Jewelry        pendants             0           1\n18  18851443.67    Jewelry         costume             0           1\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category end \n \torder by total_sum desc) as rank_within_parent\n from results_rollup\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" END ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*     total_sum i_category         i_class  lochierarchy  rank_within_parent\n0   3924596.05                                        0                   1\n1    252689.45                   swimwear             0                   2\n2    203367.81                 fragrances             0                   3\n3    189319.12                       mens             0                   4\n4    169536.62                    dresses             0                   5\n5    167950.79                   athletic             0                   6\n6    136480.66                     womens             0                   7\n7    135293.28             sports-apparel             0                   8\n8    133085.68               loose stones             0                   9\n9    117286.63                  classical             0                  10\n10   117063.90                    country             0                  11\n11   112044.91                   baseball             0                  12\n12    98563.48                     shirts             0                  13\n13    97528.59               womens watch             0                  14\n14    97120.16                   toddlers             0                  15\n15    95495.17                    newborn             0                  16\n16    86382.05                 basketball             0                  17\n17    84820.57                   business             0                  18\n18    82988.59                   lighting             0                  19\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.02272,
                    "execution_time": 0.009818,
                    "compile_time": 9.6e-05,
                    "planning_time": 0.00519
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060672,
                    "execution_time": 0.009933,
                    "compile_time": 0.000104,
                    "planning_time": 0.042734
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*     total_sum i_category         i_class  lochierarchy  rank_within_parent\n0   3924596.05                                        0                   1\n1    252689.45                   swimwear             0                   2\n2    203367.81                 fragrances             0                   3\n3    189319.12                       mens             0                   4\n4    169536.62                    dresses             0                   5\n5    167950.79                   athletic             0                   6\n6    136480.66                     womens             0                   7\n7    135293.28             sports-apparel             0                   8\n8    133085.68               loose stones             0                   9\n9    117286.63                  classical             0                  10\n10   117063.90                    country             0                  11\n11   112044.91                   baseball             0                  12\n12    98563.48                     shirts             0                  13\n13    97528.59               womens watch             0                  14\n14    97120.16                   toddlers             0                  15\n15    95495.17                    newborn             0                  16\n16    86382.05                 basketball             0                  17\n17    84820.57                   business             0                  18\n18    82988.59                   lighting             0                  19\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category end \n \torder by total_sum desc) as rank_within_parent\n from\n results_rollup\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" END ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*      total_sum i_category          i_class  lochierarchy  rank_within_parent\n0   23174489.95       Home          bedding             0                   1\n1   21528200.86       Home            paint             0                   2\n2   21386751.03       Home  curtains/drapes             0                   3\n3   21363710.34       Home        glassware             0                   4\n4   21074069.26       Home         bathroom             0                   5\n5   21013127.86       Home         flatware             0                   6\n6   20925718.74       Home        furniture             0                   7\n7   20915391.66       Home           accent             0                   8\n8   20900609.38       Home    blinds/shades             0                   9\n9   20736491.48       Home             rugs             0                  10\n10  20477343.91       Home             kids             0                  11\n11  20209218.96       Home           tables             0                  12\n12  19788500.01       Home       mattresses             0                  13\n13  19191356.03       Home         lighting             0                  14\n14  18921551.81       Home            decor             0                  15\n15  18498893.96       Home        wallpaper             0                  16\n16    193218.80       Home                              0                  17\n17  83961037.44      Music          country             0                   1\n18  83140402.61      Music        classical             0                   2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022744,
                    "execution_time": 0.009803,
                    "compile_time": 0.0001,
                    "planning_time": 0.00519
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.022953,
                    "execution_time": 0.009481,
                    "compile_time": 0.000102,
                    "planning_time": 0.005268
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*      total_sum i_category          i_class  lochierarchy  rank_within_parent\n0   23174489.95       Home          bedding             0                   1\n1   21528200.86       Home            paint             0                   2\n2   21386751.03       Home  curtains/drapes             0                   3\n3   21363710.34       Home        glassware             0                   4\n4   21074069.26       Home         bathroom             0                   5\n5   21013127.86       Home         flatware             0                   6\n6   20925718.74       Home        furniture             0                   7\n7   20915391.66       Home           accent             0                   8\n8   20900609.38       Home    blinds/shades             0                   9\n9   20736491.48       Home             rugs             0                  10\n10  20477343.91       Home             kids             0                  11\n11  20209218.96       Home           tables             0                  12\n12  19788500.01       Home       mattresses             0                  13\n13  19191356.03       Home         lighting             0                  14\n14  18921551.81       Home            decor             0                  15\n15  18498893.96       Home        wallpaper             0                  16\n16    193218.80       Home                              0                  17\n17  83961037.44      Music          country             0                   1\n18  83140402.61      Music        classical             0                   2\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category end \n \torder by total_sum desc) as rank_within_parent\n from\n results_rollup\n order by total_sum desc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" END ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ORDER BY \"TOTAL_SUM\" DESC NULLS FIRST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"TOTAL_SUM\" DESC LIMIT 21",
                "preview": "\n/*       total_sum   i_category          i_class  lochierarchy  rank_within_parent\n0   3.289277e+09         None             None             2                   1\n1   3.343185e+08     Children             None             1                   1\n2   3.302986e+08         Home             None             1                   2\n3   3.299659e+08        Music             None             1                   3\n4   3.299202e+08        Women             None             1                   4\n5   3.297832e+08       Sports             None             1                   5\n6   3.293557e+08        Shoes             None             1                   6\n7   3.278090e+08          Men             None             1                   7\n8   3.275018e+08  Electronics             None             1                   8\n9   3.213138e+08        Books             None             1                   9\n10  3.211995e+08      Jewelry             None             1                  10\n11  8.643956e+07     Children          infants             0                   1\n12  8.397679e+07        Women       fragrances             0                   1\n13  8.396104e+07        Music          country             0                   1\n14  8.394083e+07          Men      accessories             0                   1\n15  8.370358e+07     Children  school-uniforms             0                   2\n16  8.348174e+07          Men   sports-apparel             0                   2\n17  8.324234e+07        Shoes             kids             0                   1\n18  8.314040e+07        Music        classical             0                   2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.023698,
                    "execution_time": 0.010576,
                    "compile_time": 0.000123,
                    "planning_time": 0.005211
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.061462,
                    "execution_time": 0.01109,
                    "compile_time": 0.000125,
                    "planning_time": 0.040722
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"TOTAL_SUM\" DESC NULLS FIRST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"TOTAL_SUM\" DESC NULLS FIRST"
            }
        ],
        "preview": "\n/*       total_sum   i_category          i_class  lochierarchy  rank_within_parent\n0   3.289277e+09         None             None             2                   1\n1   3.343185e+08     Children             None             1                   1\n2   3.302986e+08         Home             None             1                   2\n3   3.299659e+08        Music             None             1                   3\n4   3.299202e+08        Women             None             1                   4\n5   3.297832e+08       Sports             None             1                   5\n6   3.293557e+08        Shoes             None             1                   6\n7   3.278090e+08          Men             None             1                   7\n8   3.275018e+08  Electronics             None             1                   8\n9   3.213138e+08        Books             None             1                   9\n10  3.211995e+08      Jewelry             None             1                  10\n11  8.643956e+07     Children          infants             0                   1\n12  8.397679e+07        Women       fragrances             0                   1\n13  8.396104e+07        Music          country             0                   1\n14  8.394083e+07          Men      accessories             0                   1\n15  8.370358e+07     Children  school-uniforms             0                   2\n16  8.348174e+07          Men   sports-apparel             0                   2\n17  8.324234e+07        Shoes             kids             0                   1\n18  8.314040e+07        Music        classical             0                   2\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category end \n \torder by total_sum desc) as rank_within_parent\n from\n results_rollup\n order by\n   lochierarchy desc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" END ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC LIMIT 21",
                "preview": "\n/*       total_sum   i_category          i_class  lochierarchy  rank_within_parent\n0   3.289277e+09         None             None             2                   1\n1   3.302986e+08         Home             None             1                   2\n2   3.299659e+08        Music             None             1                   3\n3   3.299202e+08        Women             None             1                   4\n4   3.297832e+08       Sports             None             1                   5\n5   3.293557e+08        Shoes             None             1                   6\n6   3.278090e+08          Men             None             1                   7\n7   3.275018e+08  Electronics             None             1                   8\n8   3.213138e+08        Books             None             1                   9\n9   3.211995e+08      Jewelry             None             1                  10\n10  7.810756e+06                          None             1                  11\n11  3.343185e+08     Children             None             1                   1\n12  8.180374e+07        Women        maternity             0                   3\n13  2.152820e+07         Home            paint             0                   2\n14  8.084984e+07        Women         swimwear             0                   4\n15  2.138675e+07         Home  curtains/drapes             0                   3\n16  3.065721e+05        Women                              0                   5\n17  2.136371e+07         Home        glassware             0                   4\n18  8.298330e+07        Women          dresses             0                   2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.024319,
                    "execution_time": 0.010991,
                    "compile_time": 0.000128,
                    "planning_time": 0.00528
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.059513,
                    "execution_time": 0.010603,
                    "compile_time": 0.000126,
                    "planning_time": 0.04085
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST"
            }
        ],
        "preview": "\n/*       total_sum   i_category          i_class  lochierarchy  rank_within_parent\n0   3.289277e+09         None             None             2                   1\n1   3.302986e+08         Home             None             1                   2\n2   3.299659e+08        Music             None             1                   3\n3   3.299202e+08        Women             None             1                   4\n4   3.297832e+08       Sports             None             1                   5\n5   3.293557e+08        Shoes             None             1                   6\n6   3.278090e+08          Men             None             1                   7\n7   3.275018e+08  Electronics             None             1                   8\n8   3.213138e+08        Books             None             1                   9\n9   3.211995e+08      Jewelry             None             1                  10\n10  7.810756e+06                          None             1                  11\n11  3.343185e+08     Children             None             1                   1\n12  8.180374e+07        Women        maternity             0                   3\n13  2.152820e+07         Home            paint             0                   2\n14  8.084984e+07        Women         swimwear             0                   4\n15  2.138675e+07         Home  curtains/drapes             0                   3\n16  3.065721e+05        Women                              0                   5\n17  2.136371e+07         Home        glassware             0                   4\n18  8.298330e+07        Women          dresses             0                   2\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim d1\n   ,item i\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i.i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category end \n \torder by total_sum desc) as rank_within_parent\n from\n results_rollup\n order by\n   lochierarchy desc,\n   case when lochierarchy = 0 then i_category end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"I\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"I\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"I\".\"I_CATEGORY\" , \"I\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" END ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"I\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"I\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"I\".\"I_CATEGORY\" , \"I\".\"I_CLASS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.142731,
                    "execution_time": 0.063621,
                    "compile_time": 0.000408,
                    "planning_time": 0.045712,
                    "create_size": 64
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.246489,
                    "execution_time": 0.064855,
                    "compile_time": 0.000445,
                    "planning_time": 0.137009,
                    "create_size": 64
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" UNION SELECT SUM ( \"SPEQLITE_TEMP_TABLE_5\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" GROUP BY \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" UNION SELECT SUM ( \"SPEQLITE_TEMP_TABLE_5\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.10291,
                    "execution_time": 0.057908,
                    "compile_time": 0.000531,
                    "planning_time": 0.01052,
                    "create_size": 9
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.1467,
                    "execution_time": 0.05918,
                    "compile_time": 0.000523,
                    "planning_time": 0.053283,
                    "create_size": 9
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_6\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"TOTAL_SUM\" DESC ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"LOCHIERARCHY\" DESC , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END LIMIT 21",
                "preview": "\n/*       total_sum   i_category         i_class  lochierarchy  rank_within_parent\n0   3.289277e+09         None            None             2                   1\n1   3.302986e+08         Home            None             1                   2\n2   3.299659e+08        Music            None             1                   3\n3   3.299202e+08        Women            None             1                   4\n4   3.297832e+08       Sports            None             1                   5\n5   3.293557e+08        Shoes            None             1                   6\n6   3.278090e+08          Men            None             1                   7\n7   3.275018e+08  Electronics            None             1                   8\n8   3.213138e+08        Books            None             1                   9\n9   3.211995e+08      Jewelry            None             1                  10\n10  7.810756e+06                         None             1                  11\n11  3.343185e+08     Children            None             1                   1\n12  2.526895e+05                     swimwear             0                   2\n13  2.033678e+05                   fragrances             0                   3\n14  1.893191e+05                         mens             0                   4\n15  1.695366e+05                      dresses             0                   5\n16  1.679508e+05                     athletic             0                   6\n17  1.364807e+05                       womens             0                   7\n18  1.352933e+05               sports-apparel             0                   8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.024549,
                    "execution_time": 0.010297,
                    "compile_time": 0.000135,
                    "planning_time": 0.0058
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.063063,
                    "execution_time": 0.012126,
                    "compile_time": 0.000159,
                    "planning_time": 0.042071
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_6\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_6\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_6\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST"
            }
        ],
        "preview": "\n/*       total_sum   i_category         i_class  lochierarchy  rank_within_parent\n0   3.289277e+09         None            None             2                   1\n1   3.302986e+08         Home            None             1                   2\n2   3.299659e+08        Music            None             1                   3\n3   3.299202e+08        Women            None             1                   4\n4   3.297832e+08       Sports            None             1                   5\n5   3.293557e+08        Shoes            None             1                   6\n6   3.278090e+08          Men            None             1                   7\n7   3.275018e+08  Electronics            None             1                   8\n8   3.213138e+08        Books            None             1                   9\n9   3.211995e+08      Jewelry            None             1                  10\n10  7.810756e+06                         None             1                  11\n11  3.343185e+08     Children            None             1                   1\n12  2.526895e+05                     swimwear             0                   2\n13  2.033678e+05                   fragrances             0                   3\n14  1.893191e+05                         mens             0                   4\n15  1.695366e+05                      dresses             0                   5\n16  1.679508e+05                     athletic             0                   6\n17  1.364807e+05                       womens             0                   7\n18  1.352933e+05               sports-apparel             0                   8\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category end \n \torder by total_sum desc) as rank_within_parent\n from\n results_rollup\n order by\n   lochierarchy desc,\n   case when lochierarchy = 0 then i_category end,\n   rank_within_parent \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" END ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST , \"RANK_WITHIN_PARENT\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END , \"RANK_WITHIN_PARENT\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category         i_class  lochierarchy  rank_within_parent\n0   3.289277e+09         None            None             2                   1\n1   3.343185e+08     Children            None             1                   1\n2   3.302986e+08         Home            None             1                   2\n3   3.299659e+08        Music            None             1                   3\n4   3.299202e+08        Women            None             1                   4\n5   3.297832e+08       Sports            None             1                   5\n6   3.293557e+08        Shoes            None             1                   6\n7   3.278090e+08          Men            None             1                   7\n8   3.275018e+08  Electronics            None             1                   8\n9   3.213138e+08        Books            None             1                   9\n10  3.211995e+08      Jewelry            None             1                  10\n11  7.810756e+06                         None             1                  11\n12  3.924596e+06                                          0                   1\n13  2.526895e+05                     swimwear             0                   2\n14  2.033678e+05                   fragrances             0                   3\n15  1.893191e+05                         mens             0                   4\n16  1.695366e+05                      dresses             0                   5\n17  1.679508e+05                     athletic             0                   6\n18  1.364807e+05                       womens             0                   7\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.024887,
                    "execution_time": 0.010219,
                    "compile_time": 0.000129,
                    "planning_time": 0.006372
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.061479,
                    "execution_time": 0.010749,
                    "compile_time": 0.000135,
                    "planning_time": 0.042204
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST , \"RANK_WITHIN_PARENT\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST , \"RANK_WITHIN_PARENT\" NULLS LAST"
            }
        ],
        "preview": "\n/*       total_sum   i_category         i_class  lochierarchy  rank_within_parent\n0   3.289277e+09         None            None             2                   1\n1   3.343185e+08     Children            None             1                   1\n2   3.302986e+08         Home            None             1                   2\n3   3.299659e+08        Music            None             1                   3\n4   3.299202e+08        Women            None             1                   4\n5   3.297832e+08       Sports            None             1                   5\n6   3.293557e+08        Shoes            None             1                   6\n7   3.278090e+08          Men            None             1                   7\n8   3.275018e+08  Electronics            None             1                   8\n9   3.213138e+08        Books            None             1                   9\n10  3.211995e+08      Jewelry            None             1                  10\n11  7.810756e+06                         None             1                  11\n12  3.924596e+06                                          0                   1\n13  2.526895e+05                     swimwear             0                   2\n14  2.033678e+05                   fragrances             0                   3\n15  1.893191e+05                         mens             0                   4\n16  1.695366e+05                      dresses             0                   5\n17  1.679508e+05                     athletic             0                   6\n18  1.364807e+05                       womens             0                   7\n...*/"
    },
    {
        "input": "-- start template query86a.tpl query 11 in stream 0\nwith /* TPC-DS query86a.tpl 0.11 */ results as\n( select sum(ws_net_paid) as total_sum, i_category, i_class, 0 as g_category, 0 as g_class \n from\n    web_sales\n   ,date_dim       d1\n   ,item\n where\n    d1.d_month_seq between 1205 and 1205+11\n and d1.d_date_sk = ws_sold_date_sk\n and i_item_sk  = ws_item_sk\n group by i_category,i_class\n ) ,\n\n results_rollup as\n( select total_sum ,i_category ,i_class, g_category, g_class, 0 as lochierarchy from results\n  union\n  select sum(total_sum) as total_sum, i_category, NULL as i_class, 0 as g_category, 1 as g_class, 1 as lochierarchy from results group by i_category\n  union\n  select sum(total_sum) as total_sum, NULL as i_category, NULL as i_class, 1 as g_category, 1 as g_class, 2 as lochierarchy from results)\n select \n total_sum ,i_category ,i_class, lochierarchy \n   ,rank() over (\n \tpartition by lochierarchy,\n \tcase when g_class = 0 then i_category end \n \torder by total_sum desc) as rank_within_parent\n from\n results_rollup\n order by\n   lochierarchy desc,\n   case when lochierarchy = 0 then i_category end,\n   rank_within_parent \n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_NET_PAID\" ) AS \"TOTAL_SUM\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 0 AS \"G_CLASS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"D1\" ON \"D1\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"D1\".\"D_MONTH_SEQ\" <= 1216 AND \"D1\".\"D_MONTH_SEQ\" >= 1205 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"G_CATEGORY\" AS \"G_CATEGORY\" , \"RESULTS\".\"G_CLASS\" AS \"G_CLASS\" , 0 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 0 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 1 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION SELECT SUM ( \"RESULTS\".\"TOTAL_SUM\" ) AS \"TOTAL_SUM\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , 1 AS \"G_CATEGORY\" , 1 AS \"G_CLASS\" , 2 AS \"LOCHIERARCHY\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"LOCHIERARCHY\" , CASE WHEN \"RESULTS_ROLLUP\".\"G_CLASS\" = 0 THEN \"RESULTS_ROLLUP\".\"I_CATEGORY\" END ORDER BY \"RESULTS_ROLLUP\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST , \"RANK_WITHIN_PARENT\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END , \"RANK_WITHIN_PARENT\" LIMIT 21",
                "preview": "\n/*       total_sum   i_category         i_class  lochierarchy  rank_within_parent\n0   3.289277e+09         None            None             2                   1\n1   3.343185e+08     Children            None             1                   1\n2   3.302986e+08         Home            None             1                   2\n3   3.299659e+08        Music            None             1                   3\n4   3.299202e+08        Women            None             1                   4\n5   3.297832e+08       Sports            None             1                   5\n6   3.293557e+08        Shoes            None             1                   6\n7   3.278090e+08          Men            None             1                   7\n8   3.275018e+08  Electronics            None             1                   8\n9   3.213138e+08        Books            None             1                   9\n10  3.211995e+08      Jewelry            None             1                  10\n11  7.810756e+06                         None             1                  11\n12  3.924596e+06                                          0                   1\n13  2.526895e+05                     swimwear             0                   2\n14  2.033678e+05                   fragrances             0                   3\n15  1.893191e+05                         mens             0                   4\n16  1.695366e+05                      dresses             0                   5\n17  1.679508e+05                     athletic             0                   6\n18  1.364807e+05                       womens             0                   7\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.025498,
                    "execution_time": 0.010825,
                    "compile_time": 0.000135,
                    "planning_time": 0.006236
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.025532,
                    "execution_time": 0.010535,
                    "compile_time": 0.00013,
                    "planning_time": 0.006454
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST , \"RANK_WITHIN_PARENT\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" AS \"TOTAL_SUM\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" AS \"LOCHIERARCHY\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"LOCHIERARCHY\" , CASE WHEN \"SPEQLITE_TEMP_TABLE_4\".\"G_CLASS\" = 0 THEN \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" END ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"TOTAL_SUM\" DESC NULLS FIRST ) AS \"RANK_WITHIN_PARENT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"LOCHIERARCHY\" DESC NULLS FIRST , CASE WHEN \"LOCHIERARCHY\" = 0 THEN \"I_CATEGORY\" END NULLS LAST , \"RANK_WITHIN_PARENT\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*       total_sum   i_category         i_class  lochierarchy  rank_within_parent\n0   3.289277e+09         None            None             2                   1\n1   3.343185e+08     Children            None             1                   1\n2   3.302986e+08         Home            None             1                   2\n3   3.299659e+08        Music            None             1                   3\n4   3.299202e+08        Women            None             1                   4\n5   3.297832e+08       Sports            None             1                   5\n6   3.293557e+08        Shoes            None             1                   6\n7   3.278090e+08          Men            None             1                   7\n8   3.275018e+08  Electronics            None             1                   8\n9   3.213138e+08        Books            None             1                   9\n10  3.211995e+08      Jewelry            None             1                  10\n11  7.810756e+06                         None             1                  11\n12  3.924596e+06                                          0                   1\n13  2.526895e+05                     swimwear             0                   2\n14  2.033678e+05                   fragrances             0                   3\n15  1.893191e+05                         mens             0                   4\n16  1.695366e+05                      dresses             0                   5\n17  1.679508e+05                     athletic             0                   6\n18  1.364807e+05                       womens             0                   7\n...*/"
    }
]