[
    {
        "input": "-- start template query44.tpl query 4 in stream 0\nselect /* TPC-DS query44.tpl 0.4 */ asceding.rnk, best_performing.i_product_name as best_performing, worst_performing.i_product_name as worst_performing\nfrom (select *\n      from (select ss_item_sk as item_sk, rank() over (order by rank_col asc) as rnk\n            from (select ss_item_sk, avg(ss_net_profit) as rank_col\n                  from store_sales\n                  where ss_store_sk = 639\n                  group by ss_item_sk\n                  having avg(ss_net_profit) > 0.90 * (select avg(ss_net_profit)\n                                                       from store_sales\n                                                       where ss_store_sk = 639\n                                                         and ss_hdemo_sk is null\n                                                       group by ss_store_sk)) V1) V11\n      ) as asceding\njoin item best_performing on asceding.item_sk = best_performing.i_item_sk\njoin item worst_performing on asceding.item_sk = worst_performing.i_item_sk\nwhere asceding.rnk = 1\nor asceding.rnk = (select max(rnk) from (select ss_item_sk, rank() over (order by avg(ss_net_profit) asc) as rnk\n                                          from store_sales\n                                          where ss_store_sk = 639\n                                          group by ss_item_sk) as temp)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_HDEMO_SK\" IS NULL AND \"STORE_SALES\".\"SS_STORE_SK\" = 639 GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" ) , \"V1\" AS ( SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"STORE_SALES\".\"SS_STORE_SK\" = 639 GROUP BY \"STORE_SALES\".\"SS_ITEM_SK\" HAVING 0.90 * MAX ( \"_U_0\".\"_COL_0\" ) < AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) ) , \"ASCEDING\" AS ( SELECT \"V1\".\"SS_ITEM_SK\" AS \"ITEM_SK\" , RANK ( ) OVER ( ORDER BY \"V1\".\"RANK_COL\" NULLS LAST ) AS \"RNK\" FROM \"V1\" AS \"V1\" ) , \"TEMP\" AS ( SELECT RANK ( ) OVER ( ORDER BY AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) NULLS LAST ) AS \"RNK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_STORE_SK\" = 639 GROUP BY \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"_U_1\" AS ( SELECT MAX ( \"TEMP\".\"RNK\" ) AS \"_COL_0\" FROM \"TEMP\" AS \"TEMP\" ) SELECT \"ASCEDING\".\"RNK\" AS \"RNK\" , \"BEST_PERFORMING\".\"I_PRODUCT_NAME\" AS \"BEST_PERFORMING\" , \"WORST_PERFORMING\".\"I_PRODUCT_NAME\" AS \"WORST_PERFORMING\" FROM \"ASCEDING\" AS \"ASCEDING\" JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"_COL_0\" = \"ASCEDING\".\"RNK\" OR \"ASCEDING\".\"RNK\" = 1 JOIN \"ITEM\" AS \"BEST_PERFORMING\" ON \"ASCEDING\".\"ITEM_SK\" = \"BEST_PERFORMING\".\"I_ITEM_SK\" JOIN \"ITEM\" AS \"WORST_PERFORMING\" ON \"ASCEDING\".\"ITEM_SK\" = \"WORST_PERFORMING\".\"I_ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_HDEMO_SK\" IS NULL AND \"STORE_SALES\".\"SS_STORE_SK\" = 639 GROUP BY \"STORE_SALES\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.120364,
                    "execution_time": 0.033082,
                    "compile_time": 0.03331,
                    "planning_time": 0.028013,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.585671,
                    "execution_time": 0.039808,
                    "compile_time": 3.402225,
                    "planning_time": 0.115499,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" WHERE \"STORE_SALES\".\"SS_STORE_SK\" = 639 GROUP BY \"STORE_SALES\".\"SS_ITEM_SK\" HAVING 0.90 * MAX ( \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" ) < AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.095529,
                    "execution_time": 0.042255,
                    "compile_time": 0.000343,
                    "planning_time": 0.027629,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.160732,
                    "execution_time": 0.040731,
                    "compile_time": 0.000303,
                    "planning_time": 0.09527,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"SS_ITEM_SK\" AS \"ITEM_SK\" , RANK ( ) OVER ( ORDER BY \"SPEQLITE_TEMP_TABLE_2\".\"RANK_COL\" NULLS LAST ) AS \"RNK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.06142,
                    "execution_time": 0.036581,
                    "compile_time": 0.000236,
                    "planning_time": 0.004715,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.121751,
                    "execution_time": 0.038026,
                    "compile_time": 0.000241,
                    "planning_time": 0.061708,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT RANK ( ) OVER ( ORDER BY AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) NULLS LAST ) AS \"RNK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_STORE_SK\" = 639 GROUP BY \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.085177,
                    "execution_time": 0.036135,
                    "compile_time": 0.000287,
                    "planning_time": 0.026659,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.163083,
                    "execution_time": 0.037013,
                    "compile_time": 0.000314,
                    "planning_time": 0.101164,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT ASCEDING.RNK , BEST_PERFORMING.I_PRODUCT_NAME AS BEST_PERFORMING , WORST_PERFORMING.I_PRODUCT_NAME AS WORST_PERFORMING FROM ( SELECT * FROM ( SELECT SS_ITEM_SK AS ITEM_SK , RANK ( ) OVER ( ORDER BY RANK_COL ASC NULLS FIRST ) AS RNK FROM ( SELECT SS_ITEM_SK , AVG ( SS_NET_PROFIT ) AS RANK_COL FROM STORE_SALES WHERE SS_STORE_SK = 639 GROUP BY SS_ITEM_SK HAVING AVG ( SS_NET_PROFIT ) > 0.90 * ( SELECT AVG ( SS_NET_PROFIT ) FROM STORE_SALES WHERE SS_STORE_SK = 639 AND SS_HDEMO_SK IS NULL GROUP BY SS_STORE_SK ) ) AS V1 ) AS V11 ) AS ASCEDING JOIN ITEM AS BEST_PERFORMING ON ASCEDING.ITEM_SK = BEST_PERFORMING.I_ITEM_SK JOIN ITEM AS WORST_PERFORMING ON ASCEDING.ITEM_SK = WORST_PERFORMING.I_ITEM_SK WHERE ASCEDING.RNK = 1 OR ASCEDING.RNK = ( SELECT MAX ( RNK ) FROM ( SELECT SS_ITEM_SK , RANK ( ) OVER ( ORDER BY AVG ( SS_NET_PROFIT ) ASC NULLS FIRST ) AS RNK FROM STORE_SALES WHERE SS_STORE_SK = 639 GROUP BY SS_ITEM_SK ) AS TEMP ) LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [rnk, best_performing, worst_performing]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.112476,
                    "execution_time": 0.027414,
                    "compile_time": 0.000555,
                    "planning_time": 0.057241
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.293173,
                    "execution_time": 0.028908,
                    "compile_time": 0.103353,
                    "planning_time": 0.131117
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"RNK\" AS \"RNK\" , \"BEST_PERFORMING\".\"I_PRODUCT_NAME\" AS \"BEST_PERFORMING\" , \"WORST_PERFORMING\".\"I_PRODUCT_NAME\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" = \"SPEQLITE_TEMP_TABLE_3\".\"RNK\" OR \"SPEQLITE_TEMP_TABLE_3\".\"RNK\" = 1 JOIN \"ITEM\" AS \"BEST_PERFORMING\" ON \"SPEQLITE_TEMP_TABLE_3\".\"ITEM_SK\" = \"BEST_PERFORMING\".\"I_ITEM_SK\" JOIN \"ITEM\" AS \"WORST_PERFORMING\" ON \"SPEQLITE_TEMP_TABLE_3\".\"ITEM_SK\" = \"WORST_PERFORMING\".\"I_ITEM_SK\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [rnk, best_performing, worst_performing]\nIndex: []*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query44.tpl query 4 in stream 0\nselect /* TPC-DS query44.tpl 0.4 */ asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\nfrom \n  (select * \n   from (select ss_item_sk as item_sk, rank() over (order by rank_col asc) as rnk\n         from (select ss_item_sk, avg(ss_net_profit) as rank_col \n               from store_sales \n               where ss_store_sk = 639\n               group by ss_item_sk\n               having avg(ss_net_profit) > 0.90 * (select avg(ss_net_profit)\n                                                   from store_sales\n                                                   where ss_store_sk = 639\n                                                     and ss_hdemo_sk is null)) V1) V11\n   where rnk  < 11) as asceding\njoin\n  (select * \n   from (select ss_item_sk as item_sk, rank() over (order by rank_col desc) as rnk\n         from (select ss_item_sk, avg(ss_net_profit) as rank_col \n               from store_sales \n               where ss_store_sk = 639\n               group by ss_item_sk\n               having avg(ss_net_profit) > 0.90 * (select avg(ss_net_profit)\n                                                   from store_sales\n                                                   where ss_store_sk = 639\n                                                     and ss_hdemo_sk is null)) V2) V22\n   where rnk < 11) as descending\non asceding.item_sk = descending.item_sk\nleft join item i1 on asceding.item_sk = i1.i_item_sk\nleft join item i2 on descending.item_sk = i2.i_item_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"_COL_0\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_HDEMO_SK\" IS NULL AND \"STORE_SALES\".\"SS_STORE_SK\" = 639 ) , \"V1\" AS ( SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"STORE_SALES\".\"SS_STORE_SK\" = 639 GROUP BY \"STORE_SALES\".\"SS_ITEM_SK\" HAVING 0.90 * MAX ( \"_U_0\".\"_COL_0\" ) < AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) ) , \"V11\" AS ( SELECT \"V1\".\"SS_ITEM_SK\" AS \"ITEM_SK\" , RANK ( ) OVER ( ORDER BY \"V1\".\"RANK_COL\" NULLS LAST ) AS \"RNK\" FROM \"V1\" AS \"V1\" ) , \"V2\" AS ( SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"_U_0\" AS \"_U_1\" WHERE \"STORE_SALES\".\"SS_STORE_SK\" = 639 GROUP BY \"STORE_SALES\".\"SS_ITEM_SK\" HAVING 0.90 * MAX ( \"_U_1\".\"_COL_0\" ) < AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) ) , \"V22\" AS ( SELECT \"V2\".\"SS_ITEM_SK\" AS \"ITEM_SK\" , RANK ( ) OVER ( ORDER BY \"V2\".\"RANK_COL\" DESC NULLS FIRST ) AS \"RNK\" FROM \"V2\" AS \"V2\" ) SELECT \"V11\".\"RNK\" AS \"RNK\" , \"I1\".\"I_PRODUCT_NAME\" AS \"BEST_PERFORMING\" , \"I2\".\"I_PRODUCT_NAME\" AS \"WORST_PERFORMING\" FROM \"V11\" AS \"V11\" JOIN \"V22\" AS \"V22\" ON \"V11\".\"ITEM_SK\" = \"V22\".\"ITEM_SK\" AND \"V22\".\"RNK\" < 11 LEFT JOIN \"ITEM\" AS \"I1\" ON \"I1\".\"I_ITEM_SK\" = \"V11\".\"ITEM_SK\" LEFT JOIN \"ITEM\" AS \"I2\" ON \"I2\".\"I_ITEM_SK\" = \"V22\".\"ITEM_SK\" WHERE \"V11\".\"RNK\" < 11"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.059576,
                    "execution_time": 0.03367,
                    "compile_time": 0.000217,
                    "planning_time": 0.003812,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.119534,
                    "execution_time": 0.03469,
                    "compile_time": 0.000205,
                    "planning_time": 0.0607,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" WHERE \"STORE_SALES\".\"SS_STORE_SK\" = 639 GROUP BY \"STORE_SALES\".\"SS_ITEM_SK\" HAVING 0.90 * MAX ( \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" ) < AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.095291,
                    "execution_time": 0.0411,
                    "compile_time": 0.000374,
                    "planning_time": 0.029162,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.162509,
                    "execution_time": 0.041458,
                    "compile_time": 0.000322,
                    "planning_time": 0.090505,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_6\".\"SS_ITEM_SK\" AS \"ITEM_SK\" , RANK ( ) OVER ( ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"RANK_COL\" NULLS LAST ) AS \"RNK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.06265,
                    "execution_time": 0.036989,
                    "compile_time": 0.000242,
                    "planning_time": 0.005415,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.118135,
                    "execution_time": 0.038095,
                    "compile_time": 0.00023,
                    "planning_time": 0.059968,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"_U_1\" WHERE \"STORE_SALES\".\"SS_STORE_SK\" = 639 GROUP BY \"STORE_SALES\".\"SS_ITEM_SK\" HAVING 0.90 * MAX ( \"_U_1\".\"_COL_0\" ) < AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.093831,
                    "execution_time": 0.040196,
                    "compile_time": 0.000289,
                    "planning_time": 0.030525,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.153894,
                    "execution_time": 0.040366,
                    "compile_time": 0.000294,
                    "planning_time": 0.090295,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SPEQLITE_TEMP_TABLE_8\".\"SS_ITEM_SK\" AS \"ITEM_SK\" , RANK ( ) OVER ( ORDER BY \"SPEQLITE_TEMP_TABLE_8\".\"RANK_COL\" DESC NULLS FIRST ) AS \"RNK\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.063001,
                    "execution_time": 0.037981,
                    "compile_time": 0.000261,
                    "planning_time": 0.004736,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.133083,
                    "execution_time": 0.050978,
                    "compile_time": 0.000238,
                    "planning_time": 0.061391,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"RNK\" AS \"RNK\" , \"I1\".\"I_PRODUCT_NAME\" AS \"BEST_PERFORMING\" , \"I2\".\"I_PRODUCT_NAME\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_SK\" AND \"SPEQLITE_TEMP_TABLE_9\".\"RNK\" < 11 LEFT JOIN \"ITEM\" AS \"I1\" ON \"I1\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_SK\" LEFT JOIN \"ITEM\" AS \"I2\" ON \"I2\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"RNK\" < 11",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.113987,
                    "execution_time": 0.043832,
                    "compile_time": 0.000408,
                    "planning_time": 0.039378,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.181451,
                    "execution_time": 0.044624,
                    "compile_time": 0.000384,
                    "planning_time": 0.103257,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"RNK\" AS \"RNK\" , \"SPEQLITE_TEMP_TABLE_10\".\"BEST_PERFORMING\" AS \"BEST_PERFORMING\" , \"SPEQLITE_TEMP_TABLE_10\".\"WORST_PERFORMING\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [rnk, best_performing, worst_performing]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017726,
                    "execution_time": 0.007516,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.00424
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054505,
                    "execution_time": 0.007454,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039473
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"RNK\" AS \"RNK\" , \"I1\".\"I_PRODUCT_NAME\" AS \"BEST_PERFORMING\" , \"I2\".\"I_PRODUCT_NAME\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_SK\" AND \"SPEQLITE_TEMP_TABLE_9\".\"RNK\" < 11 LEFT JOIN \"ITEM\" AS \"I1\" ON \"I1\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_7\".\"ITEM_SK\" LEFT JOIN \"ITEM\" AS \"I2\" ON \"I2\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_9\".\"ITEM_SK\" WHERE \"SPEQLITE_TEMP_TABLE_7\".\"RNK\" < 11",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"RNK\" AS \"RNK\" , \"SPEQLITE_TEMP_TABLE_10\".\"BEST_PERFORMING\" AS \"BEST_PERFORMING\" , \"SPEQLITE_TEMP_TABLE_10\".\"WORST_PERFORMING\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [rnk, best_performing, worst_performing]\nIndex: []*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query44.tpl query 4 in stream 0\nselect /* TPC-DS query44.tpl 0.4 */  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\nfrom(select *\n     from (select item_sk,rank() over (order by rank_col asc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \n                 from store_sales ss1\n                 where ss_store_sk = 639\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.90*(select avg(ss_net_profit) rank_col\n                                                  from store_sales\n                                                  where ss_store_sk = 639\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V1)V11\n     where rnk  < 11) asceding,\n    (select *\n     from (select item_sk,rank() over (order by rank_col desc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\n                 from store_sales ss1\n                 where ss_store_sk = 639\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.90*(select avg(ss_net_profit) rank_col\n                                                  from store_sales\n                                                  where ss_store_sk = 639\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V2)V21\n     where rnk  < 11) descending,\nitem i1,\nitem i2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_HDEMO_SK\" IS NULL AND \"STORE_SALES\".\"SS_STORE_SK\" = 639 GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" ) , \"V1\" AS ( SELECT AVG ( \"SS1\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"SS1\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"SS1\".\"SS_STORE_SK\" = 639 GROUP BY \"SS1\".\"SS_ITEM_SK\" HAVING 0.90 * MAX ( \"_U_0\".\"RANK_COL\" ) < AVG ( \"SS1\".\"SS_NET_PROFIT\" ) ) , \"V11\" AS ( SELECT RANK ( ) OVER ( ORDER BY \"V1\".\"RANK_COL\" NULLS LAST ) AS \"RNK\" FROM \"V1\" AS \"V1\" ) , \"V2\" AS ( SELECT AVG ( \"SS1\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"SS1\" CROSS JOIN \"_U_0\" AS \"_U_1\" WHERE \"SS1\".\"SS_STORE_SK\" = 639 GROUP BY \"SS1\".\"SS_ITEM_SK\" HAVING 0.90 * MAX ( \"_U_1\".\"RANK_COL\" ) < AVG ( \"SS1\".\"SS_NET_PROFIT\" ) ) , \"V21\" AS ( SELECT RANK ( ) OVER ( ORDER BY \"V2\".\"RANK_COL\" DESC NULLS FIRST ) AS \"RNK\" FROM \"V2\" AS \"V2\" ) SELECT \"V11\".\"RNK\" AS \"RNK\" , \"I1\".\"I_PRODUCT_NAME\" AS \"BEST_PERFORMING\" , \"I2\".\"I_PRODUCT_NAME\" AS \"WORST_PERFORMING\" FROM \"V11\" AS \"V11\" JOIN \"V21\" AS \"V21\" ON \"V21\".\"RNK\" < 11 CROSS JOIN \"ITEM\" AS \"I1\" CROSS JOIN \"ITEM\" AS \"I2\" WHERE \"V11\".\"RNK\" < 11"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_HDEMO_SK\" IS NULL AND \"STORE_SALES\".\"SS_STORE_SK\" = 639 GROUP BY \"STORE_SALES\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.082,
                    "execution_time": 0.032023,
                    "compile_time": 0.00026,
                    "planning_time": 0.02551,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.146651,
                    "execution_time": 0.032963,
                    "compile_time": 0.000265,
                    "planning_time": 0.088456,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT AVG ( \"SS1\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" WHERE \"SS1\".\"SS_STORE_SK\" = 639 GROUP BY \"SS1\".\"SS_ITEM_SK\" HAVING 0.90 * MAX ( \"SPEQLITE_TEMP_TABLE_11\".\"RANK_COL\" ) < AVG ( \"SS1\".\"SS_NET_PROFIT\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.094163,
                    "execution_time": 0.040877,
                    "compile_time": 0.000283,
                    "planning_time": 0.02997,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.155647,
                    "execution_time": 0.042117,
                    "compile_time": 0.000296,
                    "planning_time": 0.090341,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT RANK ( ) OVER ( ORDER BY \"SPEQLITE_TEMP_TABLE_12\".\"RANK_COL\" NULLS LAST ) AS \"RNK\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.060995,
                    "execution_time": 0.037281,
                    "compile_time": 0.000227,
                    "planning_time": 0.004188,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.120953,
                    "execution_time": 0.036947,
                    "compile_time": 0.000239,
                    "planning_time": 0.062133,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT AVG ( \"SS1\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"_U_1\" WHERE \"SS1\".\"SS_STORE_SK\" = 639 GROUP BY \"SS1\".\"SS_ITEM_SK\" HAVING 0.90 * MAX ( \"_U_1\".\"RANK_COL\" ) < AVG ( \"SS1\".\"SS_NET_PROFIT\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.09577,
                    "execution_time": 0.041429,
                    "compile_time": 0.000288,
                    "planning_time": 0.031266,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.160731,
                    "execution_time": 0.040612,
                    "compile_time": 0.000304,
                    "planning_time": 0.09574,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT RANK ( ) OVER ( ORDER BY \"SPEQLITE_TEMP_TABLE_14\".\"RANK_COL\" DESC NULLS FIRST ) AS \"RNK\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.060776,
                    "execution_time": 0.037691,
                    "compile_time": 0.000226,
                    "planning_time": 0.004172,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.117832,
                    "execution_time": 0.0376,
                    "compile_time": 0.000237,
                    "planning_time": 0.060609,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"SPEQLITE_TEMP_TABLE_13\".\"RNK\" AS \"RNK\" , \"I1\".\"I_PRODUCT_NAME\" AS \"BEST_PERFORMING\" , \"I2\".\"I_PRODUCT_NAME\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"RNK\" = 11 CROSS JOIN \"ITEM\" AS \"I1\" CROSS JOIN \"ITEM\" AS \"I2\" WHERE \"SPEQLITE_TEMP_TABLE_13\".\"RNK\" < 11",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.111258,
                    "execution_time": 0.053853,
                    "compile_time": 0.000346,
                    "planning_time": 0.03433,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.192403,
                    "execution_time": 0.054154,
                    "compile_time": 0.000348,
                    "planning_time": 0.11183,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"RNK\" AS \"RNK\" , \"SPEQLITE_TEMP_TABLE_16\".\"BEST_PERFORMING\" AS \"BEST_PERFORMING\" , \"SPEQLITE_TEMP_TABLE_16\".\"WORST_PERFORMING\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [rnk, best_performing, worst_performing]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018823,
                    "execution_time": 0.007713,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004701
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052875,
                    "execution_time": 0.006921,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039779
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"RNK\" AS \"RNK\" , \"I1\".\"I_PRODUCT_NAME\" AS \"BEST_PERFORMING\" , \"I2\".\"I_PRODUCT_NAME\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_15\".\"RNK\" < 11 CROSS JOIN \"ITEM\" AS \"I1\" CROSS JOIN \"ITEM\" AS \"I2\" WHERE \"SPEQLITE_TEMP_TABLE_13\".\"RNK\" < 11",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"RNK\" AS \"RNK\" , \"SPEQLITE_TEMP_TABLE_16\".\"BEST_PERFORMING\" AS \"BEST_PERFORMING\" , \"SPEQLITE_TEMP_TABLE_16\".\"WORST_PERFORMING\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [rnk, best_performing, worst_performing]\nIndex: []*/"
    },
    {
        "input": "-- start template query44.tpl query 4 in stream 0\nselect /* TPC-DS query44.tpl 0.4 */  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\nfrom(select *\n     from (select item_sk,rank() over (order by rank_col asc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \n                 from store_sales ss1\n                 where ss_store_sk = 639\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.90*(select avg(ss_net_profit) rank_col\n                                                  from store_sales\n                                                  where ss_store_sk = 639\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V1)V11\n     where rnk  < 11) asceding,\n    (select *\n     from (select item_sk,rank() over (order by rank_col desc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\n                 from store_sales ss1\n                 where ss_store_sk = 639\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.90*(select avg(ss_net_profit) rank_col\n                                                  from store_sales\n                                                  where ss_store_sk = 639\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V2)V21\n     where rnk  < 11) descending,\nitem i1,\nitem i2\nwhere asceding.rnk = descending.rnk \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_HDEMO_SK\" IS NULL AND \"STORE_SALES\".\"SS_STORE_SK\" = 639 GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" ) , \"V1\" AS ( SELECT AVG ( \"SS1\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"SS1\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"SS1\".\"SS_STORE_SK\" = 639 GROUP BY \"SS1\".\"SS_ITEM_SK\" HAVING 0.90 * MAX ( \"_U_0\".\"RANK_COL\" ) < AVG ( \"SS1\".\"SS_NET_PROFIT\" ) ) , \"V11\" AS ( SELECT RANK ( ) OVER ( ORDER BY \"V1\".\"RANK_COL\" NULLS LAST ) AS \"RNK\" FROM \"V1\" AS \"V1\" ) , \"V2\" AS ( SELECT AVG ( \"SS1\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"SS1\" CROSS JOIN \"_U_0\" AS \"_U_1\" WHERE \"SS1\".\"SS_STORE_SK\" = 639 GROUP BY \"SS1\".\"SS_ITEM_SK\" HAVING 0.90 * MAX ( \"_U_1\".\"RANK_COL\" ) < AVG ( \"SS1\".\"SS_NET_PROFIT\" ) ) , \"V21\" AS ( SELECT RANK ( ) OVER ( ORDER BY \"V2\".\"RANK_COL\" DESC NULLS FIRST ) AS \"RNK\" FROM \"V2\" AS \"V2\" ) SELECT \"V11\".\"RNK\" AS \"RNK\" , \"I1\".\"I_PRODUCT_NAME\" AS \"BEST_PERFORMING\" , \"I2\".\"I_PRODUCT_NAME\" AS \"WORST_PERFORMING\" FROM \"V11\" AS \"V11\" CROSS JOIN \"ITEM\" AS \"I1\" CROSS JOIN \"ITEM\" AS \"I2\" JOIN \"V21\" AS \"V21\" ON \"V11\".\"RNK\" = \"V21\".\"RNK\" AND \"V21\".\"RNK\" < 11 WHERE \"V11\".\"RNK\" < 11"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_13\".\"RNK\" AS \"RNK\" , \"I1\".\"I_PRODUCT_NAME\" AS \"BEST_PERFORMING\" , \"I2\".\"I_PRODUCT_NAME\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" CROSS JOIN \"ITEM\" AS \"I1\" CROSS JOIN \"ITEM\" AS \"I2\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_13\".\"RNK\" = \"SPEQLITE_TEMP_TABLE_15\".\"RNK\" AND \"SPEQLITE_TEMP_TABLE_15\".\"RNK\" < 11 WHERE \"SPEQLITE_TEMP_TABLE_13\".\"RNK\" < 11",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.115219,
                    "execution_time": 0.052509,
                    "compile_time": 0.000374,
                    "planning_time": 0.035544,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.190708,
                    "execution_time": 0.051725,
                    "compile_time": 0.000356,
                    "planning_time": 0.111439,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"RNK\" AS \"RNK\" , \"SPEQLITE_TEMP_TABLE_17\".\"BEST_PERFORMING\" AS \"BEST_PERFORMING\" , \"SPEQLITE_TEMP_TABLE_17\".\"WORST_PERFORMING\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [rnk, best_performing, worst_performing]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017406,
                    "execution_time": 0.007146,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.004358
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054694,
                    "execution_time": 0.007055,
                    "compile_time": 5e-05,
                    "planning_time": 0.039986
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"RNK\" AS \"RNK\" , \"I1\".\"I_PRODUCT_NAME\" AS \"BEST_PERFORMING\" , \"I2\".\"I_PRODUCT_NAME\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" CROSS JOIN \"ITEM\" AS \"I1\" CROSS JOIN \"ITEM\" AS \"I2\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_13\".\"RNK\" = \"SPEQLITE_TEMP_TABLE_15\".\"RNK\" AND \"SPEQLITE_TEMP_TABLE_15\".\"RNK\" < 11 WHERE \"SPEQLITE_TEMP_TABLE_13\".\"RNK\" < 11",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"RNK\" AS \"RNK\" , \"SPEQLITE_TEMP_TABLE_17\".\"BEST_PERFORMING\" AS \"BEST_PERFORMING\" , \"SPEQLITE_TEMP_TABLE_17\".\"WORST_PERFORMING\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [rnk, best_performing, worst_performing]\nIndex: []*/"
    },
    {
        "input": "-- start template query44.tpl query 4 in stream 0\nselect /* TPC-DS query44.tpl 0.4 */  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\nfrom(select *\n     from (select item_sk,rank() over (order by rank_col asc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \n                 from store_sales ss1\n                 where ss_store_sk = 639\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.90*(select avg(ss_net_profit) rank_col\n                                                  from store_sales\n                                                  where ss_store_sk = 639\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V1)V11\n     where rnk  < 11) asceding,\n    (select *\n     from (select item_sk,rank() over (order by rank_col desc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\n                 from store_sales ss1\n                 where ss_store_sk = 639\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.90*(select avg(ss_net_profit) rank_col\n                                                  from store_sales\n                                                  where ss_store_sk = 639\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V2)V21\n     where rnk  < 11) descending,\nitem i1,\nitem i2\nwhere asceding.rnk = descending.rnk \n  and i1.i_item_sk=asceding.item_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_HDEMO_SK\" IS NULL AND \"STORE_SALES\".\"SS_STORE_SK\" = 639 GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" ) , \"V1\" AS ( SELECT \"SS1\".\"SS_ITEM_SK\" AS \"ITEM_SK\" , AVG ( \"SS1\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"SS1\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"SS1\".\"SS_STORE_SK\" = 639 GROUP BY \"SS1\".\"SS_ITEM_SK\" HAVING 0.90 * MAX ( \"_U_0\".\"RANK_COL\" ) < AVG ( \"SS1\".\"SS_NET_PROFIT\" ) ) , \"V11\" AS ( SELECT \"V1\".\"ITEM_SK\" AS \"ITEM_SK\" , RANK ( ) OVER ( ORDER BY \"V1\".\"RANK_COL\" NULLS LAST ) AS \"RNK\" FROM \"V1\" AS \"V1\" ) , \"V2\" AS ( SELECT AVG ( \"SS1\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"SS1\" CROSS JOIN \"_U_0\" AS \"_U_1\" WHERE \"SS1\".\"SS_STORE_SK\" = 639 GROUP BY \"SS1\".\"SS_ITEM_SK\" HAVING 0.90 * MAX ( \"_U_1\".\"RANK_COL\" ) < AVG ( \"SS1\".\"SS_NET_PROFIT\" ) ) , \"V21\" AS ( SELECT RANK ( ) OVER ( ORDER BY \"V2\".\"RANK_COL\" DESC NULLS FIRST ) AS \"RNK\" FROM \"V2\" AS \"V2\" ) SELECT \"V11\".\"RNK\" AS \"RNK\" , \"I1\".\"I_PRODUCT_NAME\" AS \"BEST_PERFORMING\" , \"I2\".\"I_PRODUCT_NAME\" AS \"WORST_PERFORMING\" FROM \"V11\" AS \"V11\" CROSS JOIN \"ITEM\" AS \"I2\" JOIN \"V21\" AS \"V21\" ON \"V11\".\"RNK\" = \"V21\".\"RNK\" AND \"V21\".\"RNK\" < 11 JOIN \"ITEM\" AS \"I1\" ON \"I1\".\"I_ITEM_SK\" = \"V11\".\"ITEM_SK\" WHERE \"V11\".\"RNK\" < 11"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"SS1\".\"SS_ITEM_SK\" AS \"ITEM_SK\" , AVG ( \"SS1\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" WHERE \"SS1\".\"SS_STORE_SK\" = 639 GROUP BY \"SS1\".\"SS_ITEM_SK\" HAVING 0.90 * MAX ( \"SPEQLITE_TEMP_TABLE_11\".\"RANK_COL\" ) < AVG ( \"SS1\".\"SS_NET_PROFIT\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.092165,
                    "execution_time": 0.041592,
                    "compile_time": 0.000284,
                    "planning_time": 0.028212,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.159503,
                    "execution_time": 0.041358,
                    "compile_time": 0.0003,
                    "planning_time": 0.094959,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"SPEQLITE_TEMP_TABLE_18\".\"ITEM_SK\" AS \"ITEM_SK\" , RANK ( ) OVER ( ORDER BY \"SPEQLITE_TEMP_TABLE_18\".\"RANK_COL\" NULLS LAST ) AS \"RNK\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.063021,
                    "execution_time": 0.037809,
                    "compile_time": 0.000252,
                    "planning_time": 0.00466,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.118046,
                    "execution_time": 0.036682,
                    "compile_time": 0.000231,
                    "planning_time": 0.061546,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT \"SPEQLITE_TEMP_TABLE_19\".\"RNK\" AS \"RNK\" , \"I1\".\"I_PRODUCT_NAME\" AS \"BEST_PERFORMING\" , \"I2\".\"I_PRODUCT_NAME\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" CROSS JOIN \"ITEM\" AS \"I2\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_19\".\"RNK\" = \"SPEQLITE_TEMP_TABLE_15\".\"RNK\" AND \"SPEQLITE_TEMP_TABLE_15\".\"RNK\" < 11 JOIN \"ITEM\" AS \"I1\" ON \"I1\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_19\".\"ITEM_SK\" WHERE \"SPEQLITE_TEMP_TABLE_19\".\"RNK\" < 11",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.110084,
                    "execution_time": 0.045574,
                    "compile_time": 0.000372,
                    "planning_time": 0.036566,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.183113,
                    "execution_time": 0.045869,
                    "compile_time": 0.000519,
                    "planning_time": 0.101468,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"RNK\" AS \"RNK\" , \"SPEQLITE_TEMP_TABLE_20\".\"BEST_PERFORMING\" AS \"BEST_PERFORMING\" , \"SPEQLITE_TEMP_TABLE_20\".\"WORST_PERFORMING\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [rnk, best_performing, worst_performing]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017099,
                    "execution_time": 0.007082,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.004326
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052482,
                    "execution_time": 0.007117,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039388
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"RNK\" AS \"RNK\" , \"I1\".\"I_PRODUCT_NAME\" AS \"BEST_PERFORMING\" , \"I2\".\"I_PRODUCT_NAME\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" CROSS JOIN \"ITEM\" AS \"I2\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ON \"SPEQLITE_TEMP_TABLE_19\".\"RNK\" = \"SPEQLITE_TEMP_TABLE_15\".\"RNK\" AND \"SPEQLITE_TEMP_TABLE_15\".\"RNK\" < 11 JOIN \"ITEM\" AS \"I1\" ON \"I1\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_19\".\"ITEM_SK\" WHERE \"SPEQLITE_TEMP_TABLE_19\".\"RNK\" < 11",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"RNK\" AS \"RNK\" , \"SPEQLITE_TEMP_TABLE_20\".\"BEST_PERFORMING\" AS \"BEST_PERFORMING\" , \"SPEQLITE_TEMP_TABLE_20\".\"WORST_PERFORMING\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [rnk, best_performing, worst_performing]\nIndex: []*/"
    },
    {
        "input": "-- start template query44.tpl query 4 in stream 0\nselect /* TPC-DS query44.tpl 0.4 */  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\nfrom(select *\n     from (select item_sk,rank() over (order by rank_col asc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \n                 from store_sales ss1\n                 where ss_store_sk = 639\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.90*(select avg(ss_net_profit) rank_col\n                                                  from store_sales\n                                                  where ss_store_sk = 639\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V1)V11\n     where rnk  < 11) asceding,\n    (select *\n     from (select item_sk,rank() over (order by rank_col desc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\n                 from store_sales ss1\n                 where ss_store_sk = 639\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.90*(select avg(ss_net_profit) rank_col\n                                                  from store_sales\n                                                  where ss_store_sk = 639\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V2)V21\n     where rnk  < 11) descending,\nitem i1,\nitem i2\nwhere asceding.rnk = descending.rnk \n  and i1.i_item_sk=asceding.item_sk\n  and i2.i_item_sk=descending.item_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_HDEMO_SK\" IS NULL AND \"STORE_SALES\".\"SS_STORE_SK\" = 639 GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" ) , \"V1\" AS ( SELECT \"SS1\".\"SS_ITEM_SK\" AS \"ITEM_SK\" , AVG ( \"SS1\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"SS1\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"SS1\".\"SS_STORE_SK\" = 639 GROUP BY \"SS1\".\"SS_ITEM_SK\" HAVING 0.90 * MAX ( \"_U_0\".\"RANK_COL\" ) < AVG ( \"SS1\".\"SS_NET_PROFIT\" ) ) , \"V11\" AS ( SELECT \"V1\".\"ITEM_SK\" AS \"ITEM_SK\" , RANK ( ) OVER ( ORDER BY \"V1\".\"RANK_COL\" NULLS LAST ) AS \"RNK\" FROM \"V1\" AS \"V1\" ) , \"V2\" AS ( SELECT \"SS1\".\"SS_ITEM_SK\" AS \"ITEM_SK\" , AVG ( \"SS1\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"SS1\" CROSS JOIN \"_U_0\" AS \"_U_1\" WHERE \"SS1\".\"SS_STORE_SK\" = 639 GROUP BY \"SS1\".\"SS_ITEM_SK\" HAVING 0.90 * MAX ( \"_U_1\".\"RANK_COL\" ) < AVG ( \"SS1\".\"SS_NET_PROFIT\" ) ) , \"V21\" AS ( SELECT \"V2\".\"ITEM_SK\" AS \"ITEM_SK\" , RANK ( ) OVER ( ORDER BY \"V2\".\"RANK_COL\" DESC NULLS FIRST ) AS \"RNK\" FROM \"V2\" AS \"V2\" ) SELECT \"V11\".\"RNK\" AS \"RNK\" , \"I1\".\"I_PRODUCT_NAME\" AS \"BEST_PERFORMING\" , \"I2\".\"I_PRODUCT_NAME\" AS \"WORST_PERFORMING\" FROM \"V11\" AS \"V11\" JOIN \"V21\" AS \"V21\" ON \"V11\".\"RNK\" = \"V21\".\"RNK\" AND \"V21\".\"RNK\" < 11 JOIN \"ITEM\" AS \"I1\" ON \"I1\".\"I_ITEM_SK\" = \"V11\".\"ITEM_SK\" JOIN \"ITEM\" AS \"I2\" ON \"I2\".\"I_ITEM_SK\" = \"V21\".\"ITEM_SK\" WHERE \"V11\".\"RNK\" < 11"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"SS1\".\"SS_ITEM_SK\" AS \"ITEM_SK\" , AVG ( \"SS1\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"SS1\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"_U_1\" WHERE \"SS1\".\"SS_STORE_SK\" = 639 GROUP BY \"SS1\".\"SS_ITEM_SK\" HAVING 0.90 * MAX ( \"_U_1\".\"RANK_COL\" ) < AVG ( \"SS1\".\"SS_NET_PROFIT\" )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.096706,
                    "execution_time": 0.04111,
                    "compile_time": 0.000292,
                    "planning_time": 0.032773,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.170699,
                    "execution_time": 0.041818,
                    "compile_time": 0.000286,
                    "planning_time": 0.106586,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_22\" AS SELECT \"SPEQLITE_TEMP_TABLE_21\".\"ITEM_SK\" AS \"ITEM_SK\" , RANK ( ) OVER ( ORDER BY \"SPEQLITE_TEMP_TABLE_21\".\"RANK_COL\" DESC NULLS FIRST ) AS \"RNK\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.060339,
                    "execution_time": 0.036637,
                    "compile_time": 0.000223,
                    "planning_time": 0.004474,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.118648,
                    "execution_time": 0.039154,
                    "compile_time": 0.000226,
                    "planning_time": 0.061162,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_23\" AS SELECT \"SPEQLITE_TEMP_TABLE_19\".\"RNK\" AS \"RNK\" , \"I1\".\"I_PRODUCT_NAME\" AS \"BEST_PERFORMING\" , \"I2\".\"I_PRODUCT_NAME\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" ON \"SPEQLITE_TEMP_TABLE_19\".\"RNK\" = \"SPEQLITE_TEMP_TABLE_22\".\"RNK\" AND \"SPEQLITE_TEMP_TABLE_22\".\"RNK\" < 11 JOIN \"ITEM\" AS \"I1\" ON \"I1\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_19\".\"ITEM_SK\" JOIN \"ITEM\" AS \"I2\" ON \"I2\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_22\".\"ITEM_SK\" WHERE \"SPEQLITE_TEMP_TABLE_19\".\"RNK\" < 11",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.108297,
                    "execution_time": 0.047435,
                    "compile_time": 0.000393,
                    "planning_time": 0.032725,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.179638,
                    "execution_time": 0.046978,
                    "compile_time": 0.000396,
                    "planning_time": 0.100682,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"RNK\" AS \"RNK\" , \"SPEQLITE_TEMP_TABLE_23\".\"BEST_PERFORMING\" AS \"BEST_PERFORMING\" , \"SPEQLITE_TEMP_TABLE_23\".\"WORST_PERFORMING\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [rnk, best_performing, worst_performing]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017052,
                    "execution_time": 0.006933,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.004304
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05276,
                    "execution_time": 0.007211,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.039574
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"RNK\" AS \"RNK\" , \"I1\".\"I_PRODUCT_NAME\" AS \"BEST_PERFORMING\" , \"I2\".\"I_PRODUCT_NAME\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" ON \"SPEQLITE_TEMP_TABLE_19\".\"RNK\" = \"SPEQLITE_TEMP_TABLE_22\".\"RNK\" AND \"SPEQLITE_TEMP_TABLE_22\".\"RNK\" < 11 JOIN \"ITEM\" AS \"I1\" ON \"I1\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_19\".\"ITEM_SK\" JOIN \"ITEM\" AS \"I2\" ON \"I2\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_22\".\"ITEM_SK\" WHERE \"SPEQLITE_TEMP_TABLE_19\".\"RNK\" < 11",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"RNK\" AS \"RNK\" , \"SPEQLITE_TEMP_TABLE_23\".\"BEST_PERFORMING\" AS \"BEST_PERFORMING\" , \"SPEQLITE_TEMP_TABLE_23\".\"WORST_PERFORMING\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [rnk, best_performing, worst_performing]\nIndex: []*/"
    },
    {
        "input": "-- start template query44.tpl query 4 in stream 0\nselect /* TPC-DS query44.tpl 0.4 */  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\nfrom(select *\n     from (select item_sk,rank() over (order by rank_col asc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \n                 from store_sales ss1\n                 where ss_store_sk = 639\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.90*(select avg(ss_net_profit) rank_col\n                                                  from store_sales\n                                                  where ss_store_sk = 639\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V1)V11\n     where rnk  < 11) asceding,\n    (select *\n     from (select item_sk,rank() over (order by rank_col desc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\n                 from store_sales ss1\n                 where ss_store_sk = 639\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.90*(select avg(ss_net_profit) rank_col\n                                                  from store_sales\n                                                  where ss_store_sk = 639\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V2)V21\n     where rnk  < 11) descending,\nitem i1,\nitem i2\nwhere asceding.rnk = descending.rnk \n  and i1.i_item_sk=asceding.item_sk\n  and i2.i_item_sk=descending.item_sk\norder by asceding.rnk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_HDEMO_SK\" IS NULL AND \"STORE_SALES\".\"SS_STORE_SK\" = 639 GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" ) , \"V1\" AS ( SELECT \"SS1\".\"SS_ITEM_SK\" AS \"ITEM_SK\" , AVG ( \"SS1\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"SS1\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"SS1\".\"SS_STORE_SK\" = 639 GROUP BY \"SS1\".\"SS_ITEM_SK\" HAVING 0.90 * MAX ( \"_U_0\".\"RANK_COL\" ) < AVG ( \"SS1\".\"SS_NET_PROFIT\" ) ) , \"V11\" AS ( SELECT \"V1\".\"ITEM_SK\" AS \"ITEM_SK\" , RANK ( ) OVER ( ORDER BY \"V1\".\"RANK_COL\" NULLS LAST ) AS \"RNK\" FROM \"V1\" AS \"V1\" ) , \"V2\" AS ( SELECT \"SS1\".\"SS_ITEM_SK\" AS \"ITEM_SK\" , AVG ( \"SS1\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"SS1\" CROSS JOIN \"_U_0\" AS \"_U_1\" WHERE \"SS1\".\"SS_STORE_SK\" = 639 GROUP BY \"SS1\".\"SS_ITEM_SK\" HAVING 0.90 * MAX ( \"_U_1\".\"RANK_COL\" ) < AVG ( \"SS1\".\"SS_NET_PROFIT\" ) ) , \"V21\" AS ( SELECT \"V2\".\"ITEM_SK\" AS \"ITEM_SK\" , RANK ( ) OVER ( ORDER BY \"V2\".\"RANK_COL\" DESC NULLS FIRST ) AS \"RNK\" FROM \"V2\" AS \"V2\" ) SELECT \"V11\".\"RNK\" AS \"RNK\" , \"I1\".\"I_PRODUCT_NAME\" AS \"BEST_PERFORMING\" , \"I2\".\"I_PRODUCT_NAME\" AS \"WORST_PERFORMING\" FROM \"V11\" AS \"V11\" JOIN \"V21\" AS \"V21\" ON \"V11\".\"RNK\" = \"V21\".\"RNK\" AND \"V21\".\"RNK\" < 11 JOIN \"ITEM\" AS \"I1\" ON \"I1\".\"I_ITEM_SK\" = \"V11\".\"ITEM_SK\" JOIN \"ITEM\" AS \"I2\" ON \"I2\".\"I_ITEM_SK\" = \"V21\".\"ITEM_SK\" WHERE \"V11\".\"RNK\" < 11 ORDER BY \"V11\".\"RNK\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"RNK\" AS \"RNK\" , \"SPEQLITE_TEMP_TABLE_23\".\"BEST_PERFORMING\" AS \"BEST_PERFORMING\" , \"SPEQLITE_TEMP_TABLE_23\".\"WORST_PERFORMING\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"SPEQLITE_TEMP_TABLE_23\".\"RNK\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [rnk, best_performing, worst_performing]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01863,
                    "execution_time": 0.008268,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.004592
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.078759,
                    "execution_time": 0.007505,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.06384
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"RNK\" AS \"RNK\" , \"I1\".\"I_PRODUCT_NAME\" AS \"BEST_PERFORMING\" , \"I2\".\"I_PRODUCT_NAME\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" ON \"SPEQLITE_TEMP_TABLE_19\".\"RNK\" = \"SPEQLITE_TEMP_TABLE_22\".\"RNK\" AND \"SPEQLITE_TEMP_TABLE_22\".\"RNK\" < 11 JOIN \"ITEM\" AS \"I1\" ON \"I1\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_19\".\"ITEM_SK\" JOIN \"ITEM\" AS \"I2\" ON \"I2\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_22\".\"ITEM_SK\" WHERE \"SPEQLITE_TEMP_TABLE_19\".\"RNK\" < 11 ORDER BY \"SPEQLITE_TEMP_TABLE_19\".\"RNK\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"RNK\" AS \"RNK\" , \"SPEQLITE_TEMP_TABLE_23\".\"BEST_PERFORMING\" AS \"BEST_PERFORMING\" , \"SPEQLITE_TEMP_TABLE_23\".\"WORST_PERFORMING\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"SPEQLITE_TEMP_TABLE_23\".\"RNK\" NULLS LAST"
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [rnk, best_performing, worst_performing]\nIndex: []*/"
    },
    {
        "input": "-- start template query44.tpl query 4 in stream 0\nselect /* TPC-DS query44.tpl 0.4 */  asceding.rnk, i1.i_product_name best_performing, i2.i_product_name worst_performing\nfrom(select *\n     from (select item_sk,rank() over (order by rank_col asc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col \n                 from store_sales ss1\n                 where ss_store_sk = 639\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.90*(select avg(ss_net_profit) rank_col\n                                                  from store_sales\n                                                  where ss_store_sk = 639\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V1)V11\n     where rnk  < 11) asceding,\n    (select *\n     from (select item_sk,rank() over (order by rank_col desc) rnk\n           from (select ss_item_sk item_sk,avg(ss_net_profit) rank_col\n                 from store_sales ss1\n                 where ss_store_sk = 639\n                 group by ss_item_sk\n                 having avg(ss_net_profit) > 0.90*(select avg(ss_net_profit) rank_col\n                                                  from store_sales\n                                                  where ss_store_sk = 639\n                                                    and ss_hdemo_sk is null\n                                                  group by ss_store_sk))V2)V21\n     where rnk  < 11) descending,\nitem i1,\nitem i2\nwhere asceding.rnk = descending.rnk \n  and i1.i_item_sk=asceding.item_sk\n  and i2.i_item_sk=descending.item_sk\norder by asceding.rnk\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT AVG ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"STORE_SALES\" WHERE \"STORE_SALES\".\"SS_HDEMO_SK\" IS NULL AND \"STORE_SALES\".\"SS_STORE_SK\" = 639 GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" ) , \"V1\" AS ( SELECT \"SS1\".\"SS_ITEM_SK\" AS \"ITEM_SK\" , AVG ( \"SS1\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"SS1\" CROSS JOIN \"_U_0\" AS \"_U_0\" WHERE \"SS1\".\"SS_STORE_SK\" = 639 GROUP BY \"SS1\".\"SS_ITEM_SK\" HAVING 0.90 * MAX ( \"_U_0\".\"RANK_COL\" ) < AVG ( \"SS1\".\"SS_NET_PROFIT\" ) ) , \"V11\" AS ( SELECT \"V1\".\"ITEM_SK\" AS \"ITEM_SK\" , RANK ( ) OVER ( ORDER BY \"V1\".\"RANK_COL\" NULLS LAST ) AS \"RNK\" FROM \"V1\" AS \"V1\" ) , \"V2\" AS ( SELECT \"SS1\".\"SS_ITEM_SK\" AS \"ITEM_SK\" , AVG ( \"SS1\".\"SS_NET_PROFIT\" ) AS \"RANK_COL\" FROM \"STORE_SALES\" AS \"SS1\" CROSS JOIN \"_U_0\" AS \"_U_1\" WHERE \"SS1\".\"SS_STORE_SK\" = 639 GROUP BY \"SS1\".\"SS_ITEM_SK\" HAVING 0.90 * MAX ( \"_U_1\".\"RANK_COL\" ) < AVG ( \"SS1\".\"SS_NET_PROFIT\" ) ) , \"V21\" AS ( SELECT \"V2\".\"ITEM_SK\" AS \"ITEM_SK\" , RANK ( ) OVER ( ORDER BY \"V2\".\"RANK_COL\" DESC NULLS FIRST ) AS \"RNK\" FROM \"V2\" AS \"V2\" ) SELECT \"V11\".\"RNK\" AS \"RNK\" , \"I1\".\"I_PRODUCT_NAME\" AS \"BEST_PERFORMING\" , \"I2\".\"I_PRODUCT_NAME\" AS \"WORST_PERFORMING\" FROM \"V11\" AS \"V11\" JOIN \"V21\" AS \"V21\" ON \"V11\".\"RNK\" = \"V21\".\"RNK\" AND \"V21\".\"RNK\" < 11 JOIN \"ITEM\" AS \"I1\" ON \"I1\".\"I_ITEM_SK\" = \"V11\".\"ITEM_SK\" JOIN \"ITEM\" AS \"I2\" ON \"I2\".\"I_ITEM_SK\" = \"V21\".\"ITEM_SK\" WHERE \"V11\".\"RNK\" < 11 ORDER BY \"V11\".\"RNK\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"RNK\" AS \"RNK\" , \"SPEQLITE_TEMP_TABLE_23\".\"BEST_PERFORMING\" AS \"BEST_PERFORMING\" , \"SPEQLITE_TEMP_TABLE_23\".\"WORST_PERFORMING\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"SPEQLITE_TEMP_TABLE_23\".\"RNK\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [rnk, best_performing, worst_performing]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018798,
                    "execution_time": 0.008385,
                    "compile_time": 7.6e-05,
                    "planning_time": 0.004494
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018297,
                    "execution_time": 0.007792,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.004718
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"RNK\" AS \"RNK\" , \"I1\".\"I_PRODUCT_NAME\" AS \"BEST_PERFORMING\" , \"I2\".\"I_PRODUCT_NAME\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" JOIN \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" ON \"SPEQLITE_TEMP_TABLE_19\".\"RNK\" = \"SPEQLITE_TEMP_TABLE_22\".\"RNK\" AND \"SPEQLITE_TEMP_TABLE_22\".\"RNK\" < 11 JOIN \"ITEM\" AS \"I1\" ON \"I1\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_19\".\"ITEM_SK\" JOIN \"ITEM\" AS \"I2\" ON \"I2\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_22\".\"ITEM_SK\" WHERE \"SPEQLITE_TEMP_TABLE_19\".\"RNK\" < 11 ORDER BY \"SPEQLITE_TEMP_TABLE_19\".\"RNK\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"RNK\" AS \"RNK\" , \"SPEQLITE_TEMP_TABLE_23\".\"BEST_PERFORMING\" AS \"BEST_PERFORMING\" , \"SPEQLITE_TEMP_TABLE_23\".\"WORST_PERFORMING\" AS \"WORST_PERFORMING\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"SPEQLITE_TEMP_TABLE_23\".\"RNK\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [rnk, best_performing, worst_performing]\nIndex: []*/"
    }
]