[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n    )\n   )\ngroup by substring(r_reason_desc,1,20)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.26129,
                    "execution_time": 0.115292,
                    "compile_time": 0.000745,
                    "planning_time": 0.099174,
                    "create_size": 266
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.271434,
                    "execution_time": 3.705156,
                    "compile_time": 3.526397,
                    "planning_time": 0.09127,
                    "create_size": 266
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0   No service location       48  1711.77   55.08\n1              reason 34      46  1413.05   55.73\n2              reason 38      49  1683.97   59.62\n3             Wrong size      41  1356.85   46.96\n4   Not the product that      66  1392.88   45.16\n5   Found a better price      41  1288.18   46.79\n6              reason 27      44   765.43   49.20\n7   Does not work with a      55  1524.42   44.39\n8              reason 42      40   520.16   50.81\n9              reason 35      45  1065.49   51.41\n10  Not working any more      55  1299.37   54.47\n11             reason 25      50  1372.49   56.36\n12         Parts missing      45   698.45   54.09\n13             reason 23      42  1050.47   42.89\n14             reason 40      57  1066.46   58.65\n15  Did not like the mak      54  1491.05   53.55\n16  Did not like the col      40   834.37   51.05\n17         Gift exchange      50  1618.65   48.76\n18             reason 44      51  1320.61   53.50\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016564,
                    "execution_time": 0.007013,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003512
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056815,
                    "execution_time": 0.007997,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039343
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_1\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0   No service location       48  1711.77   55.08\n1              reason 34      46  1413.05   55.73\n2              reason 38      49  1683.97   59.62\n3             Wrong size      41  1356.85   46.96\n4   Not the product that      66  1392.88   45.16\n5   Found a better price      41  1288.18   46.79\n6              reason 27      44   765.43   49.20\n7   Does not work with a      55  1524.42   44.39\n8              reason 42      40   520.16   50.81\n9              reason 35      45  1065.49   51.41\n10  Not working any more      55  1299.37   54.47\n11             reason 25      50  1372.49   56.36\n12         Parts missing      45   698.45   54.09\n13             reason 23      42  1050.47   42.89\n14             reason 40      57  1066.46   58.65\n15  Did not like the mak      54  1491.05   53.55\n16  Did not like the col      40   834.37   51.05\n17         Gift exchange      50  1618.65   48.76\n18             reason 44      51  1320.61   53.50\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */ substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n   )\ngroup by substring(r_reason_desc,1,20)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.313451,
                    "execution_time": 0.151992,
                    "compile_time": 0.019886,
                    "planning_time": 0.095949,
                    "create_size": 77
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.630516,
                    "execution_time": 0.163481,
                    "compile_time": 3.217164,
                    "planning_time": 0.194599,
                    "create_size": 77
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_2\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_2\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_2\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0        Stopped working      47   606.29   90.32\n1              reason 37      15   917.16   40.89\n2              reason 33      22   400.59   38.96\n3            Did not fit       5    57.37   22.12\n4              reason 28      35   623.59   91.86\n5              reason 29      19  1282.35   50.00\n6   Found a better price      43   464.96   62.28\n7   Not working any more       3   128.13   28.67\n8   Did not like the col      59   544.99   30.63\n9   No service location        7     5.44   53.78\n10            Wrong size      35   618.65   74.06*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017048,
                    "execution_time": 0.007557,
                    "compile_time": 5e-05,
                    "planning_time": 0.003375
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056563,
                    "execution_time": 0.007592,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.039551
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_2\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_2\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_2\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0        Stopped working      47   606.29   90.32\n1              reason 37      15   917.16   40.89\n2              reason 33      22   400.59   38.96\n3            Did not fit       5    57.37   22.12\n4              reason 28      35   623.59   91.86\n5              reason 29      19  1282.35   50.00\n6   Found a better price      43   464.96   62.28\n7   Not working any more       3   128.13   28.67\n8   Did not like the col      59   544.99   30.63\n9   No service location        7     5.44   53.78\n10            Wrong size      35   618.65   74.06*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n   )\ngroup by substring(r_reason_desc,1,20)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"_COL_0\" AS \"_COL_0\" , \"_COL_1\" AS \"_COL_1\" , \"_COL_2\" AS \"_COL_2\" , \"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0   Found a better price      43   464.96   62.28\n1   Not working any more       3   128.13   28.67\n2   No service location        7     5.44   53.78\n3   Did not like the col      59   544.99   30.63\n4        Stopped working      47   606.29   90.32\n5              reason 28      35   623.59   91.86\n6             Wrong size      35   618.65   74.06\n7              reason 33      22   400.59   38.96\n8            Did not fit       5    57.37   22.12\n9              reason 37      15   917.16   40.89\n10             reason 29      19  1282.35   50.00*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01629,
                    "execution_time": 0.006863,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003476
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052918,
                    "execution_time": 0.007622,
                    "compile_time": 5e-05,
                    "planning_time": 0.038871
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"_COL_0\" AS \"_COL_0\", \"_COL_1\" AS \"_COL_1\", \"_COL_2\" AS \"_COL_2\", \"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0   Found a better price      43   464.96   62.28\n1   Not working any more       3   128.13   28.67\n2   No service location        7     5.44   53.78\n3   Did not like the col      59   544.99   30.63\n4        Stopped working      47   606.29   90.32\n5              reason 28      35   623.59   91.86\n6             Wrong size      35   618.65   74.06\n7              reason 33      22   400.59   38.96\n8            Did not fit       5    57.37   22.12\n9              reason 37      15   917.16   40.89\n10             reason 29      19  1282.35   50.00*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_quantity between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_quantity between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_quantity between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n   )\ngroup by substring(r_reason_desc,1,20)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 200.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 100.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 150.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 200.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 100.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 150.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.252881,
                    "execution_time": 0.110045,
                    "compile_time": 0.000713,
                    "planning_time": 0.096768,
                    "create_size": 63
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.47064,
                    "execution_time": 0.114699,
                    "compile_time": 0.109071,
                    "planning_time": 0.193811,
                    "create_size": 63
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_3\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_3\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_3\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*                 _col_0  _col_1   _col_2  _col_3\n0             reason 44      74   575.92   15.19\n1             reason 35      75  1368.27   33.33\n2  Did not like the col      59   544.99   30.63\n3  Not working any more      98     3.60   95.36\n4             reason 41      72   159.10   16.38\n5          it is a girl      73   253.56   55.63\n6             reason 39      75    29.18   90.85\n7   Package was damaged      69   534.82    5.43\n8             reason 31      70    17.25   60.94\n9             reason 33      73   114.66   45.72*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016731,
                    "execution_time": 0.007011,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003603
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056147,
                    "execution_time": 0.007607,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039185
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 200.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 100.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_QUANTITY\" <= 150.00 AND \"WEB_SALES\".\"WS_QUANTITY\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_3\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_3\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_3\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*                 _col_0  _col_1   _col_2  _col_3\n0             reason 44      74   575.92   15.19\n1             reason 35      75  1368.27   33.33\n2  Did not like the col      59   544.99   30.63\n3  Not working any more      98     3.60   95.36\n4             reason 41      72   159.10   16.38\n5          it is a girl      73   253.56   55.63\n6             reason 39      75    29.18   90.85\n7   Package was damaged      69   534.82    5.43\n8             reason 31      70    17.25   60.94\n9             reason 33      73   114.66   45.72*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n   )\ngroup by substring(r_reason_desc,1,20) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"_COL_0\" AS \"_COL_0\" , \"_COL_1\" AS \"_COL_1\" , \"_COL_2\" AS \"_COL_2\" , \"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0   Found a better price      43   464.96   62.28\n1   Not working any more       3   128.13   28.67\n2   No service location        7     5.44   53.78\n3             Wrong size      35   618.65   74.06\n4   Did not like the col      59   544.99   30.63\n5              reason 33      22   400.59   38.96\n6            Did not fit       5    57.37   22.12\n7        Stopped working      47   606.29   90.32\n8              reason 37      15   917.16   40.89\n9              reason 28      35   623.59   91.86\n10             reason 29      19  1282.35   50.00*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016956,
                    "execution_time": 0.007067,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.003547
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.016944,
                    "execution_time": 0.007131,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.003616
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"_COL_0\" AS \"_COL_0\", \"_COL_1\" AS \"_COL_1\", \"_COL_2\" AS \"_COL_2\", \"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0   Found a better price      43   464.96   62.28\n1   Not working any more       3   128.13   28.67\n2   No service location        7     5.44   53.78\n3             Wrong size      35   618.65   74.06\n4   Did not like the col      59   544.99   30.63\n5              reason 33      22   400.59   38.96\n6            Did not fit       5    57.37   22.12\n7        Stopped working      47   606.29   90.32\n8              reason 37      15   917.16   40.89\n9              reason 28      35   623.59   91.86\n10             reason 29      19  1282.35   50.00*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n   )\ngroup by substring(r_reason_desc,1,20)\n\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"_COL_0\" AS \"_COL_0\" , \"_COL_1\" AS \"_COL_1\" , \"_COL_2\" AS \"_COL_2\" , \"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0             Wrong size      35   618.65   74.06\n1   Found a better price      43   464.96   62.28\n2   Not working any more       3   128.13   28.67\n3   No service location        7     5.44   53.78\n4   Did not like the col      59   544.99   30.63\n5            Did not fit       5    57.37   22.12\n6        Stopped working      47   606.29   90.32\n7              reason 37      15   917.16   40.89\n8              reason 33      22   400.59   38.96\n9              reason 29      19  1282.35   50.00\n10             reason 28      35   623.59   91.86*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017005,
                    "execution_time": 0.007332,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003518
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.016983,
                    "execution_time": 0.007076,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003623
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"_COL_0\" AS \"_COL_0\", \"_COL_1\" AS \"_COL_1\", \"_COL_2\" AS \"_COL_2\", \"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0             Wrong size      35   618.65   74.06\n1   Found a better price      43   464.96   62.28\n2   Not working any more       3   128.13   28.67\n3   No service location        7     5.44   53.78\n4   Did not like the col      59   544.99   30.63\n5            Did not fit       5    57.37   22.12\n6        Stopped working      47   606.29   90.32\n7              reason 37      15   917.16   40.89\n8              reason 33      22   400.59   38.96\n9              reason 29      19  1282.35   50.00\n10             reason 28      35   623.59   91.86*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('NY', 'CA', 'FL')\n     and ws_net_profit between 200 and 400  \n    )\n   )\n/*CURSOR_IDENTIFIER*/\ngroup by substring(r_reason_desc,1,20)",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NY' , 'CA' , 'FL' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 400 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 200 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NY' , 'CA' , 'FL' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 400 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 200 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.517821,
                    "execution_time": 0.332653,
                    "compile_time": 0.038192,
                    "planning_time": 0.099431,
                    "create_size": 98
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.174475,
                    "execution_time": 0.334709,
                    "compile_time": 3.589811,
                    "planning_time": 0.195345,
                    "create_size": 98
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0              reason 33      22   400.59   38.96\n1              reason 29      19  1282.35   50.00\n2              reason 37      15   917.16   40.89\n3            Did not fit       5    57.37   22.12\n4        Stopped working      47   606.29   90.32\n5              reason 28      35   623.59   91.86\n6              reason 24      15   143.78   48.86\n7   No service location        7     5.44   53.78\n8   Did not like the col      59   544.99   30.63\n9   Found a better price      43   464.96   62.28\n10             reason 27       7   509.03   60.77\n11             reason 35      12   228.22   39.44\n12  Not working any more       3   128.13   28.67\n13            Wrong size      35   618.65   74.06*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01713,
                    "execution_time": 0.007626,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003545
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056038,
                    "execution_time": 0.007572,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039224
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('NY', 'CA', 'FL') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 400 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 200) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0              reason 33      22   400.59   38.96\n1              reason 29      19  1282.35   50.00\n2              reason 37      15   917.16   40.89\n3            Did not fit       5    57.37   22.12\n4        Stopped working      47   606.29   90.32\n5              reason 28      35   623.59   91.86\n6              reason 24      15   143.78   48.86\n7   No service location        7     5.44   53.78\n8   Did not like the col      59   544.99   30.63\n9   Found a better price      43   464.96   62.28\n10             reason 27       7   509.03   60.77\n11             reason 35      12   228.22   39.44\n12  Not working any more       3   128.13   28.67\n13            Wrong size      35   618.65   74.06*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity) as avg_quantity\n       ,avg(wr_refunded_cash) as avg_refunded_cash\n       ,avg(wr_fee) as avg_fee\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n   )\n   )\nGROUP BY substring(r_reason_desc,1,20) \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"AVG_QUANTITY\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"AVG_REFUNDED_CASH\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"AVG_FEE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"AVG_QUANTITY\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"AVG_REFUNDED_CASH\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"AVG_FEE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.276541,
                    "execution_time": 0.11916,
                    "compile_time": 0.000721,
                    "planning_time": 0.111098,
                    "create_size": 231
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.498706,
                    "execution_time": 0.118624,
                    "compile_time": 0.130843,
                    "planning_time": 0.196207,
                    "create_size": 231
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_QUANTITY\" AS \"AVG_QUANTITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_REFUNDED_CASH\" AS \"AVG_REFUNDED_CASH\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_FEE\" AS \"AVG_FEE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*                  _col_0  avg_quantity  avg_refunded_cash  avg_fee\n0              reason 34            26             268.65    59.79\n1   No service location              7               5.44    53.78\n2              reason 38            27             871.56    90.14\n3     duplicate purchase            23              13.95    70.65\n4          Gift exchange            56            2510.73    39.59\n5   Did not like the col            45             292.80    52.60\n6              reason 44            57             647.86    48.15\n7              reason 25            59            1037.99    58.36\n8              reason 23             7             116.72    34.68\n9           its is a boy            66            2666.93    71.77\n10  Not the product that            68            2894.59    49.29\n11  Found a better price            47            1284.85    40.43\n12             reason 27            36             245.59    46.61\n13             reason 42            47             362.94    80.87\n14             reason 35            41             940.30    38.97\n15             reason 26            89              48.34    48.30\n16  Not working any more            22             305.71    59.27\n17             reason 45            84            3641.82    69.51\n18            Wrong size            51            1200.40    76.63\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017561,
                    "execution_time": 0.007676,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.003634
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056343,
                    "execution_time": 0.007117,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039812
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"AVG_QUANTITY\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"AVG_REFUNDED_CASH\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"AVG_FEE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM')) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_QUANTITY\" AS \"AVG_QUANTITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_REFUNDED_CASH\" AS \"AVG_REFUNDED_CASH\" , \"SPEQLITE_TEMP_TABLE_5\".\"AVG_FEE\" AS \"AVG_FEE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*                  _col_0  avg_quantity  avg_refunded_cash  avg_fee\n0              reason 34            26             268.65    59.79\n1   No service location              7               5.44    53.78\n2              reason 38            27             871.56    90.14\n3     duplicate purchase            23              13.95    70.65\n4          Gift exchange            56            2510.73    39.59\n5   Did not like the col            45             292.80    52.60\n6              reason 44            57             647.86    48.15\n7              reason 25            59            1037.99    58.36\n8              reason 23             7             116.72    34.68\n9           its is a boy            66            2666.93    71.77\n10  Not the product that            68            2894.59    49.29\n11  Found a better price            47            1284.85    40.43\n12             reason 27            36             245.59    46.61\n13             reason 42            47             362.94    80.87\n14             reason 35            41             940.30    38.97\n15             reason 26            89              48.34    48.30\n16  Not working any more            22             305.71    59.27\n17             reason 45            84            3641.82    69.51\n18            Wrong size            51            1200.40    76.63\n...*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20) as reason_desc\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n   )\n   )\ngroup by reason_desc /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"REASON_DESC\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"REASON_DESC\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.52776,
                    "execution_time": 0.33813,
                    "compile_time": 0.041024,
                    "planning_time": 0.100902,
                    "create_size": 105
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.198718,
                    "execution_time": 0.337766,
                    "compile_time": 3.588694,
                    "planning_time": 0.21606,
                    "create_size": 105
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"REASON_DESC\" AS \"REASON_DESC\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*             reason_desc  _col_1   _col_2  _col_3\n0   Found a better price      43   464.96   62.28\n1   Not working any more       3   128.13   28.67\n2   No service location        7     5.44   53.78\n3             Wrong size      35   618.65   74.06\n4          Gift exchange      52  2528.89   67.12\n5   Did not like the col      45   292.80   52.60\n6   Did not like the mak      50  1442.49   43.09\n7        Stopped working      47   606.29   90.32\n8   Found a better exten      78  2233.12   41.62\n9              reason 32      55   501.55   84.70\n10             reason 33      22   400.59   38.96\n11             reason 28      35   623.59   91.86\n12             reason 24      24    72.63   11.38\n13             reason 37      15   917.16   40.89\n14           Did not fit       6    73.12   35.05\n15             reason 31      52   564.18   68.63\n16             reason 29      19  1282.35   50.00*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016467,
                    "execution_time": 0.006872,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.00361
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056262,
                    "execution_time": 0.007159,
                    "compile_time": 5e-05,
                    "planning_time": 0.039601
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"REASON_DESC\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"REASON_DESC\" AS \"REASON_DESC\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*             reason_desc  _col_1   _col_2  _col_3\n0   Found a better price      43   464.96   62.28\n1   Not working any more       3   128.13   28.67\n2   No service location        7     5.44   53.78\n3             Wrong size      35   618.65   74.06\n4          Gift exchange      52  2528.89   67.12\n5   Did not like the col      45   292.80   52.60\n6   Did not like the mak      50  1442.49   43.09\n7        Stopped working      47   606.29   90.32\n8   Found a better exten      78  2233.12   41.62\n9              reason 32      55   501.55   84.70\n10             reason 33      22   400.59   38.96\n11             reason 28      35   623.59   91.86\n12             reason 24      24    72.63   11.38\n13             reason 37      15   917.16   40.89\n14           Did not fit       6    73.12   35.05\n15             reason 31      52   564.18   68.63\n16             reason 29      19  1282.35   50.00*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20) as reason_desc\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by reason_desc /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"REASON_DESC\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"REASON_DESC\" AS \"REASON_DESC\" , \"_COL_1\" AS \"_COL_1\" , \"_COL_2\" AS \"_COL_2\" , \"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*             reason_desc  _col_1   _col_2  _col_3\n0   Found a better price      43   464.96   62.28\n1   No service location        7     5.44   53.78\n2             Wrong size      35   618.65   74.06\n3   Not working any more       3   128.13   28.67\n4          Gift exchange      52  2528.89   67.12\n5   Did not like the col      45   292.80   52.60\n6   Did not like the mak      50  1442.49   43.09\n7              reason 37      15   917.16   40.89\n8              reason 28      35   623.59   91.86\n9            Did not fit       6    73.12   35.05\n10       Stopped working      47   606.29   90.32\n11             reason 33      22   400.59   38.96\n12             reason 24      24    72.63   11.38\n13  Found a better exten      78  2233.12   41.62\n14             reason 32      55   501.55   84.70\n15             reason 29      19  1282.35   50.00\n16             reason 31      52   564.18   68.63*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016839,
                    "execution_time": 0.007001,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.003633
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052884,
                    "execution_time": 0.007627,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.038903
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"REASON_DESC\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"REASON_DESC\" AS \"REASON_DESC\", \"_COL_1\" AS \"_COL_1\", \"_COL_2\" AS \"_COL_2\", \"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*             reason_desc  _col_1   _col_2  _col_3\n0   Found a better price      43   464.96   62.28\n1   No service location        7     5.44   53.78\n2             Wrong size      35   618.65   74.06\n3   Not working any more       3   128.13   28.67\n4          Gift exchange      52  2528.89   67.12\n5   Did not like the col      45   292.80   52.60\n6   Did not like the mak      50  1442.49   43.09\n7              reason 37      15   917.16   40.89\n8              reason 28      35   623.59   91.86\n9            Did not fit       6    73.12   35.05\n10       Stopped working      47   606.29   90.32\n11             reason 33      22   400.59   38.96\n12             reason 24      24    72.63   11.38\n13  Found a better exten      78  2233.12   41.62\n14             reason 32      55   501.55   84.70\n15             reason 29      19  1282.35   50.00\n16             reason 31      52   564.18   68.63*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20) as reason_desc\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by reason_desc /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"REASON_DESC\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 )"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"REASON_DESC\" AS \"REASON_DESC\" , \"_COL_1\" AS \"_COL_1\" , \"_COL_2\" AS \"_COL_2\" , \"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*             reason_desc  _col_1   _col_2  _col_3\n0              reason 37      15   917.16   40.89\n1              reason 29      19  1282.35   50.00\n2              reason 31      52   564.18   68.63\n3            Did not fit       6    73.12   35.05\n4        Stopped working      47   606.29   90.32\n5   Found a better exten      78  2233.12   41.62\n6              reason 32      55   501.55   84.70\n7              reason 33      22   400.59   38.96\n8              reason 28      35   623.59   91.86\n9              reason 24      24    72.63   11.38\n10  Not working any more       3   128.13   28.67\n11         Gift exchange      52  2528.89   67.12\n12  Did not like the col      45   292.80   52.60\n13  Found a better price      43   464.96   62.28\n14  No service location        7     5.44   53.78\n15            Wrong size      35   618.65   74.06\n16  Did not like the mak      50  1442.49   43.09*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01718,
                    "execution_time": 0.007431,
                    "compile_time": 5e-05,
                    "planning_time": 0.003665
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.016934,
                    "execution_time": 0.00702,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003642
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"REASON_DESC\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20)",
                "rewrite": "SELECT \"REASON_DESC\" AS \"REASON_DESC\", \"_COL_1\" AS \"_COL_1\", \"_COL_2\" AS \"_COL_2\", \"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*             reason_desc  _col_1   _col_2  _col_3\n0              reason 37      15   917.16   40.89\n1              reason 29      19  1282.35   50.00\n2              reason 31      52   564.18   68.63\n3            Did not fit       6    73.12   35.05\n4        Stopped working      47   606.29   90.32\n5   Found a better exten      78  2233.12   41.62\n6              reason 32      55   501.55   84.70\n7              reason 33      22   400.59   38.96\n8              reason 28      35   623.59   91.86\n9              reason 24      24    72.63   11.38\n10  Not working any more       3   128.13   28.67\n11         Gift exchange      52  2528.89   67.12\n12  Did not like the col      45   292.80   52.60\n13  Found a better price      43   464.96   62.28\n14  No service location        7     5.44   53.78\n15            Wrong size      35   618.65   74.06\n16  Did not like the mak      50  1442.49   43.09*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY \"REASON\".\"R_REASON_DESC\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY \"REASON\".\"R_REASON_DESC\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.266684,
                    "execution_time": 0.115426,
                    "compile_time": 0.000761,
                    "planning_time": 0.101541,
                    "create_size": 49
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.607119,
                    "execution_time": 0.116977,
                    "compile_time": 0.235504,
                    "planning_time": 0.195272,
                    "create_size": 49
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0   Found a better exten      78  2233.12   41.62\n1              reason 31      52   564.18   68.63\n2        Stopped working      47   606.29   90.32\n3            Did not fit       6    73.12   35.05\n4              reason 28      35   623.59   91.86\n5   Did not like the col      45   292.80   52.60\n6              reason 29      19  1282.35   50.00\n7              reason 37      15   917.16   40.89\n8              reason 32      55   501.55   84.70\n9   Did not like the mak      50  1442.49   43.09\n10             reason 24      24    72.63   11.38\n11             reason 33      22   400.59   38.96\n12            Wrong size      35   618.65   74.06\n13  No service location        7     5.44   53.78\n14  Found a better price      43   464.96   62.28\n15         Gift exchange      52  2528.89   67.12\n16  Not working any more       3   128.13   28.67*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017367,
                    "execution_time": 0.007527,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003663
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055821,
                    "execution_time": 0.007177,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039333
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY \"REASON\".\"R_REASON_DESC\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0   Found a better exten      78  2233.12   41.62\n1              reason 31      52   564.18   68.63\n2        Stopped working      47   606.29   90.32\n3            Did not fit       6    73.12   35.05\n4              reason 28      35   623.59   91.86\n5   Did not like the col      45   292.80   52.60\n6              reason 29      19  1282.35   50.00\n7              reason 37      15   917.16   40.89\n8              reason 32      55   501.55   84.70\n9   Did not like the mak      50  1442.49   43.09\n10             reason 24      24    72.63   11.38\n11             reason 33      22   400.59   38.96\n12            Wrong size      35   618.65   74.06\n13  No service location        7     5.44   53.78\n14  Found a better price      43   464.96   62.28\n15         Gift exchange      52  2528.89   67.12\n16  Not working any more       3   128.13   28.67*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substring(r_reason_desc,1,20)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0            Did not fit       6    73.12   35.05\n1   Did not like the col      45   292.80   52.60\n2   Did not like the mak      50  1442.49   43.09\n3   Found a better exten      78  2233.12   41.62\n4   Found a better price      43   464.96   62.28\n5          Gift exchange      52  2528.89   67.12\n6   No service location        7     5.44   53.78\n7   Not working any more       3   128.13   28.67\n8        Stopped working      47   606.29   90.32\n9             Wrong size      35   618.65   74.06\n10             reason 24      24    72.63   11.38\n11             reason 28      35   623.59   91.86\n12             reason 29      19  1282.35   50.00\n13             reason 31      52   564.18   68.63\n14             reason 32      55   501.55   84.70\n15             reason 33      22   400.59   38.96\n16             reason 37      15   917.16   40.89*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018332,
                    "execution_time": 0.008478,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.003754
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057283,
                    "execution_time": 0.008756,
                    "compile_time": 7.8e-05,
                    "planning_time": 0.039065
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" NULLS LAST"
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0            Did not fit       6    73.12   35.05\n1   Did not like the col      45   292.80   52.60\n2   Did not like the mak      50  1442.49   43.09\n3   Found a better exten      78  2233.12   41.62\n4   Found a better price      43   464.96   62.28\n5          Gift exchange      52  2528.89   67.12\n6   No service location        7     5.44   53.78\n7   Not working any more       3   128.13   28.67\n8        Stopped working      47   606.29   90.32\n9             Wrong size      35   618.65   74.06\n10             reason 24      24    72.63   11.38\n11             reason 28      35   623.59   91.86\n12             reason 29      19  1282.35   50.00\n13             reason 31      52   564.18   68.63\n14             reason 32      55   501.55   84.70\n15             reason 33      22   400.59   38.96\n16             reason 37      15   917.16   40.89*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substring(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" , \"_COL_1\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0            Did not fit       6    73.12   35.05\n1   Did not like the col      45   292.80   52.60\n2   Did not like the mak      50  1442.49   43.09\n3   Found a better exten      78  2233.12   41.62\n4   Found a better price      43   464.96   62.28\n5          Gift exchange      52  2528.89   67.12\n6   No service location        7     5.44   53.78\n7   Not working any more       3   128.13   28.67\n8        Stopped working      47   606.29   90.32\n9             Wrong size      35   618.65   74.06\n10             reason 24      24    72.63   11.38\n11             reason 28      35   623.59   91.86\n12             reason 29      19  1282.35   50.00\n13             reason 31      52   564.18   68.63\n14             reason 32      55   501.55   84.70\n15             reason 33      22   400.59   38.96\n16             reason 37      15   917.16   40.89*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018155,
                    "execution_time": 0.008058,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.003955
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054844,
                    "execution_time": 0.009268,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.039321
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST, \"_COL_1\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST"
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0            Did not fit       6    73.12   35.05\n1   Did not like the col      45   292.80   52.60\n2   Did not like the mak      50  1442.49   43.09\n3   Found a better exten      78  2233.12   41.62\n4   Found a better price      43   464.96   62.28\n5          Gift exchange      52  2528.89   67.12\n6   No service location        7     5.44   53.78\n7   Not working any more       3   128.13   28.67\n8        Stopped working      47   606.29   90.32\n9             Wrong size      35   618.65   74.06\n10             reason 24      24    72.63   11.38\n11             reason 28      35   623.59   91.86\n12             reason 29      19  1282.35   50.00\n13             reason 31      52   564.18   68.63\n14             reason 32      55   501.55   84.70\n15             reason 33      22   400.59   38.96\n16             reason 37      15   917.16   40.89*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substring(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST , \"_COL_2\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" , \"_COL_1\" , \"_COL_2\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0            Did not fit       6    73.12   35.05\n1   Did not like the col      45   292.80   52.60\n2   Did not like the mak      50  1442.49   43.09\n3   Found a better exten      78  2233.12   41.62\n4   Found a better price      43   464.96   62.28\n5          Gift exchange      52  2528.89   67.12\n6   No service location        7     5.44   53.78\n7   Not working any more       3   128.13   28.67\n8        Stopped working      47   606.29   90.32\n9             Wrong size      35   618.65   74.06\n10             reason 24      24    72.63   11.38\n11             reason 28      35   623.59   91.86\n12             reason 29      19  1282.35   50.00\n13             reason 31      52   564.18   68.63\n14             reason 32      55   501.55   84.70\n15             reason 33      22   400.59   38.96\n16             reason 37      15   917.16   40.89*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01876,
                    "execution_time": 0.008524,
                    "compile_time": 7.7e-05,
                    "planning_time": 0.004044
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054264,
                    "execution_time": 0.008468,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.039447
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST, \"_COL_1\" NULLS LAST, \"_COL_2\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST , \"_COL_2\" NULLS LAST"
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0            Did not fit       6    73.12   35.05\n1   Did not like the col      45   292.80   52.60\n2   Did not like the mak      50  1442.49   43.09\n3   Found a better exten      78  2233.12   41.62\n4   Found a better price      43   464.96   62.28\n5          Gift exchange      52  2528.89   67.12\n6   No service location        7     5.44   53.78\n7   Not working any more       3   128.13   28.67\n8        Stopped working      47   606.29   90.32\n9             Wrong size      35   618.65   74.06\n10             reason 24      24    72.63   11.38\n11             reason 28      35   623.59   91.86\n12             reason 29      19  1282.35   50.00\n13             reason 31      52   564.18   68.63\n14             reason 32      55   501.55   84.70\n15             reason 33      22   400.59   38.96\n16             reason 37      15   917.16   40.89*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substring(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST , \"_COL_2\" NULLS LAST , \"_COL_3\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" , \"_COL_1\" , \"_COL_2\" , \"_COL_3\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0            Did not fit       6    73.12   35.05\n1   Did not like the col      45   292.80   52.60\n2   Did not like the mak      50  1442.49   43.09\n3   Found a better exten      78  2233.12   41.62\n4   Found a better price      43   464.96   62.28\n5          Gift exchange      52  2528.89   67.12\n6   No service location        7     5.44   53.78\n7   Not working any more       3   128.13   28.67\n8        Stopped working      47   606.29   90.32\n9             Wrong size      35   618.65   74.06\n10             reason 24      24    72.63   11.38\n11             reason 28      35   623.59   91.86\n12             reason 29      19  1282.35   50.00\n13             reason 31      52   564.18   68.63\n14             reason 32      55   501.55   84.70\n15             reason 33      22   400.59   38.96\n16             reason 37      15   917.16   40.89*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018268,
                    "execution_time": 0.008043,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.004109
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055013,
                    "execution_time": 0.009209,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.039573
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST, \"_COL_1\" NULLS LAST, \"_COL_2\" NULLS LAST, \"_COL_3\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST , \"_COL_2\" NULLS LAST , \"_COL_3\" NULLS LAST"
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0            Did not fit       6    73.12   35.05\n1   Did not like the col      45   292.80   52.60\n2   Did not like the mak      50  1442.49   43.09\n3   Found a better exten      78  2233.12   41.62\n4   Found a better price      43   464.96   62.28\n5          Gift exchange      52  2528.89   67.12\n6   No service location        7     5.44   53.78\n7   Not working any more       3   128.13   28.67\n8        Stopped working      47   606.29   90.32\n9             Wrong size      35   618.65   74.06\n10             reason 24      24    72.63   11.38\n11             reason 28      35   623.59   91.86\n12             reason 29      19  1282.35   50.00\n13             reason 31      52   564.18   68.63\n14             reason 32      55   501.55   84.70\n15             reason 33      22   400.59   38.96\n16             reason 37      15   917.16   40.89*/"
    },
    {
        "input": "-- start template query85.tpl query 33 in stream 0\nselect /* TPC-DS query85.tpl 0.33 */  substring(r_reason_desc,1,20)\n       ,avg(ws_quantity)\n       ,avg(wr_refunded_cash)\n       ,avg(wr_fee)\n from web_sales, web_returns, web_page, customer_demographics cd1,\n      customer_demographics cd2, customer_address, date_dim, reason \n where ws_web_page_sk = wp_web_page_sk\n   and ws_item_sk = wr_item_sk\n   and ws_order_number = wr_order_number\n   and ws_sold_date_sk = d_date_sk and d_year = 2000\n   and cd1.cd_demo_sk = wr_refunded_cdemo_sk \n   and cd2.cd_demo_sk = wr_returning_cdemo_sk\n   and ca_address_sk = wr_refunded_addr_sk\n   and r_reason_sk = wr_reason_sk\n   and\n   (\n    (\n     cd1.cd_marital_status = 'S'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Secondary'\n     and \n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 100.00 and 150.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'U'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = 'Advanced Degree' \n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 50.00 and 100.00\n    )\n   or\n    (\n     cd1.cd_marital_status = 'W'\n     and\n     cd1.cd_marital_status = cd2.cd_marital_status\n     and\n     cd1.cd_education_status = '4 yr Degree'\n     and\n     cd1.cd_education_status = cd2.cd_education_status\n     and\n     ws_sales_price between 150.00 and 200.00\n    )\n   )\n   and\n   (\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('VA', 'MI', 'ID')\n     and ws_net_profit between 100 and 200  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('TX', 'LA', 'KS')\n     and ws_net_profit between 150 and 300  \n    )\n    or\n    (\n     ca_country = 'United States'\n     and\n     ca_state in ('IA', 'NY', 'NM')\n     and ws_net_profit between 50 and 250  \n    )\n   )\ngroup by r_reason_desc\norder by substring(r_reason_desc,1,20)\n        ,avg(ws_quantity)\n        ,avg(wr_refunded_cash)\n        ,avg(wr_fee)\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"REASON\".\"R_REASON_DESC\" , 1 , 20 ) AS \"_COL_0\" , AVG ( \"WEB_SALES\".\"WS_QUANTITY\" ) AS \"_COL_1\" , AVG ( \"WEB_RETURNS\".\"WR_REFUNDED_CASH\" ) AS \"_COL_2\" , AVG ( \"WEB_RETURNS\".\"WR_FEE\" ) AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ( ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'IA' , 'NY' , 'NM' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'TX' , 'LA' , 'KS' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150 ) OR ( \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'VA' , 'MI' , 'ID' ) AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100 ) ) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ( ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00 ) OR ( \"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00 ) ) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST , \"_COL_2\" NULLS LAST , \"_COL_3\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" , \"_COL_1\" , \"_COL_2\" , \"_COL_3\" LIMIT 21",
                "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0            Did not fit       6    73.12   35.05\n1   Did not like the col      45   292.80   52.60\n2   Did not like the mak      50  1442.49   43.09\n3   Found a better exten      78  2233.12   41.62\n4   Found a better price      43   464.96   62.28\n5          Gift exchange      52  2528.89   67.12\n6   No service location        7     5.44   53.78\n7   Not working any more       3   128.13   28.67\n8        Stopped working      47   606.29   90.32\n9             Wrong size      35   618.65   74.06\n10             reason 24      24    72.63   11.38\n11             reason 28      35   623.59   91.86\n12             reason 29      19  1282.35   50.00\n13             reason 31      52   564.18   68.63\n14             reason 32      55   501.55   84.70\n15             reason 33      22   400.59   38.96\n16             reason 37      15   917.16   40.89*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018999,
                    "execution_time": 0.008187,
                    "compile_time": 0.000116,
                    "planning_time": 0.004289
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018657,
                    "execution_time": 0.008123,
                    "compile_time": 8e-05,
                    "planning_time": 0.004154
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"REASON\".\"R_REASON_DESC\", 1, 20) AS \"_COL_0\", AVG(\"WEB_SALES\".\"WS_QUANTITY\") AS \"_COL_1\", AVG(\"WEB_RETURNS\".\"WR_REFUNDED_CASH\") AS \"_COL_2\", AVG(\"WEB_RETURNS\".\"WR_FEE\") AS \"_COL_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 JOIN \"WEB_PAGE\" AS \"WEB_PAGE\" ON \"WEB_PAGE\".\"WP_WEB_PAGE_SK\" = \"WEB_SALES\".\"WS_WEB_PAGE_SK\" JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CD1\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_REFUNDED_ADDR_SK\" AND ((\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('IA', 'NY', 'NM') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 250 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 50) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('TX', 'LA', 'KS') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 300 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 150) OR (\"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" = 'United States' AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ('VA', 'MI', 'ID') AND \"WEB_SALES\".\"WS_NET_PROFIT\" <= 200 AND \"WEB_SALES\".\"WS_NET_PROFIT\" >= 100)) JOIN \"REASON\" AS \"REASON\" ON \"REASON\".\"R_REASON_SK\" = \"WEB_RETURNS\".\"WR_REASON_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_CDEMO_SK\" AND ((\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'W' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 200.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 150.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Advanced Degree' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'U' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 100.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 50.00) OR (\"CD1\".\"CD_EDUCATION_STATUS\" = \"CD2\".\"CD_EDUCATION_STATUS\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Secondary' AND \"CD1\".\"CD_MARITAL_STATUS\" = \"CD2\".\"CD_MARITAL_STATUS\" AND \"CD1\".\"CD_MARITAL_STATUS\" = 'S' AND \"WEB_SALES\".\"WS_SALES_PRICE\" <= 150.00 AND \"WEB_SALES\".\"WS_SALES_PRICE\" >= 100.00)) GROUP BY \"REASON\".\"R_REASON_DESC\" ORDER BY \"_COL_0\" NULLS LAST, \"_COL_1\" NULLS LAST, \"_COL_2\" NULLS LAST, \"_COL_3\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"_COL_3\" AS \"_COL_3\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"_COL_0\" NULLS LAST , \"_COL_1\" NULLS LAST , \"_COL_2\" NULLS LAST , \"_COL_3\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*                  _col_0  _col_1   _col_2  _col_3\n0            Did not fit       6    73.12   35.05\n1   Did not like the col      45   292.80   52.60\n2   Did not like the mak      50  1442.49   43.09\n3   Found a better exten      78  2233.12   41.62\n4   Found a better price      43   464.96   62.28\n5          Gift exchange      52  2528.89   67.12\n6   No service location        7     5.44   53.78\n7   Not working any more       3   128.13   28.67\n8        Stopped working      47   606.29   90.32\n9             Wrong size      35   618.65   74.06\n10             reason 24      24    72.63   11.38\n11             reason 28      35   623.59   91.86\n12             reason 29      19  1282.35   50.00\n13             reason 31      52   564.18   68.63\n14             reason 32      55   501.55   84.70\n15             reason 33      22   400.59   38.96\n16             reason 37      15   917.16   40.89*/"
    }
]