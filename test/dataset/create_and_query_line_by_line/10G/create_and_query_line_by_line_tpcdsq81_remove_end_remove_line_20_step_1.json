[
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n group by cr_returning_customer_sk, ca_state)\nselect * from customer_total_return /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH CUSTOMER_TOTAL_RETURN AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH CUSTOMER_TOTAL_RETURN AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\"",
                "rewrite": "WITH CUSTOMER_TOTAL_RETURN AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
            }
        ],
        "preview": null
    },
    {
        "input": "with /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n join date_dim on cr_returned_date_sk = d_date_sk\n join customer_address on cr_returning_customer_sk = ca_address_sk\n where d_year = 1999\n group by cr_returning_customer_sk, ca_state\n )\nselect * from customer_total_return\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.341214,
                    "execution_time": 0.098189,
                    "compile_time": 0.030735,
                    "planning_time": 0.044989,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.814613,
                    "execution_time": 0.115459,
                    "compile_time": 3.411028,
                    "planning_time": 0.113917,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0            171991        IA           4101.16\n1            228678        NE           2328.95\n2            201995        AL           1374.01\n3            166164        KY            102.03\n4            179796        LA            678.24\n5            211069        TX           1756.61\n6            211012        GA             16.27\n7            186075        TX           2243.60\n8            236657        NC            424.60\n9            168715        TN           1454.71\n10            72869        GA            156.84\n11             7588        TX             87.02\n12            22325        GA           1237.79\n13             7475        LA            149.77\n14            18308        VA           8562.81\n15            50208        IA            397.36\n16           163922        AL            757.66\n17           168361        OH             63.12\n18            35834        OH           3379.45\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017321,
                    "execution_time": 0.007859,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003416
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056262,
                    "execution_time": 0.007967,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039008
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0            171991        IA           4101.16\n1            228678        NE           2328.95\n2            201995        AL           1374.01\n3            166164        KY            102.03\n4            179796        LA            678.24\n5            211069        TX           1756.61\n6            211012        GA             16.27\n7            186075        TX           2243.60\n8            236657        NC            424.60\n9            168715        TN           1454.71\n10            72869        GA            156.84\n11             7588        TX             87.02\n12            22325        GA           1237.79\n13             7475        LA            149.77\n14            18308        VA           8562.81\n15            50208        IA            397.36\n16           163922        AL            757.66\n17           168361        OH             63.12\n18            35834        OH           3379.45\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n join date_dim on cr_returned_date_sk = d_date_sk \n join customer_address on cr_returning_addr_sk = ca_address_sk \n where d_year =1999\n group by cr_returning_customer_sk, ca_state\n)\n/*CURSOR_IDENTIFIER*/\nselect * from customer_total_return;",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.564032,
                    "execution_time": 0.117249,
                    "compile_time": 0.081602,
                    "planning_time": 0.045652,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.518096,
                    "execution_time": 0.789095,
                    "compile_time": 3.292143,
                    "planning_time": 0.115147,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0            221995        VA             88.90\n1            414052        PA            216.31\n2            112344        KY           1867.69\n3            452359        MT             26.80\n4            280307        TX           3334.50\n5             30475        AL            466.48\n6            107805        AL            306.03\n7            110420        FL             86.28\n8            461852        IN           9202.71\n9            199737        GA            105.23\n10           101400        KS           1061.35\n11           212506        KY            579.25\n12           378530        TN            140.55\n13           227099        GA            385.03\n14           141278        NV           1859.48\n15           131802        WV           5071.76\n16           280887                        5.64\n17           136551        GA            141.71\n18           496894        TX             20.47\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01677,
                    "execution_time": 0.007203,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003426
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056694,
                    "execution_time": 0.008077,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039162
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0            221995        VA             88.90\n1            414052        PA            216.31\n2            112344        KY           1867.69\n3            452359        MT             26.80\n4            280307        TX           3334.50\n5             30475        AL            466.48\n6            107805        AL            306.03\n7            110420        FL             86.28\n8            461852        IN           9202.71\n9            199737        GA            105.23\n10           101400        KS           1061.35\n11           212506        KY            579.25\n12           378530        TN            140.55\n13           227099        GA            385.03\n14           141278        NV           1859.48\n15           131802        WV           5071.76\n16           280887                        5.64\n17           136551        GA            141.71\n18           496894        TX             20.47\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year = 1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk, ca_state\n)\nselect * from customer_total_return\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0          494260.0        CA             21.42\n1           85959.0        TN           6084.51\n2          249650.0        FL           1934.71\n3          257115.0        CO           3550.41\n4          115843.0        VA            298.72\n5          322177.0        GA            286.86\n6          442545.0        CO           1985.92\n7           88348.0        LA            186.62\n8          467988.0        MI           2007.10\n9               NaN        TX         173427.10\n10         236902.0        MI            347.46\n11          43954.0        SD             68.30\n12         142914.0        IL            628.83\n13         312144.0                      522.19\n14          59470.0        IL            189.28\n15         359261.0        NE           4671.20\n16         122518.0        WI            188.38\n17         337427.0        MN             82.86\n18          70965.0        WV           2203.52\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016926,
                    "execution_time": 0.007577,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003431
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017101,
                    "execution_time": 0.007696,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003365
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0          494260.0        CA             21.42\n1           85959.0        TN           6084.51\n2          249650.0        FL           1934.71\n3          257115.0        CO           3550.41\n4          115843.0        VA            298.72\n5          322177.0        GA            286.86\n6          442545.0        CO           1985.92\n7           88348.0        LA            186.62\n8          467988.0        MI           2007.10\n9               NaN        TX         173427.10\n10         236902.0        MI            347.46\n11          43954.0        SD             68.30\n12         142914.0        IL            628.83\n13         312144.0                      522.19\n14          59470.0        IL            189.28\n15         359261.0        NE           4671.20\n16         122518.0        WI            188.38\n17         337427.0        MN             82.86\n18          70965.0        WV           2203.52\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\nselect * from customer_total_return\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0             14444        FL           7183.23\n1            371752        MO           1841.76\n2            282269        MO              0.00\n3            477954        NJ            136.55\n4            386293        IN            129.19\n5            132092        MN            111.07\n6             90369        TN            244.60\n7             65615        AR            938.21\n8            227875        TN            872.01\n9             72167        LA            323.89\n10            15487                       71.63\n11           179212        CA           2440.32\n12           130688        VA             23.24\n13           349318        NC            112.23\n14            81489                     6798.32\n15           189392        FL           1485.17\n16           230952        AR            258.01\n17           163880        WA            490.96\n18           442154        MI           1391.25\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017164,
                    "execution_time": 0.007887,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003357
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.016836,
                    "execution_time": 0.007316,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003451
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0             14444        FL           7183.23\n1            371752        MO           1841.76\n2            282269        MO              0.00\n3            477954        NJ            136.55\n4            386293        IN            129.19\n5            132092        MN            111.07\n6             90369        TN            244.60\n7             65615        AR            938.21\n8            227875        TN            872.01\n9             72167        LA            323.89\n10            15487                       71.63\n11           179212        CA           2440.32\n12           130688        VA             23.24\n13           349318        NC            112.23\n14            81489                     6798.32\n15           189392        FL           1485.17\n16           230952        AR            258.01\n17           163880        WA            490.96\n18           442154        MI           1391.25\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.277233,
                    "execution_time": 0.086469,
                    "compile_time": 0.000261,
                    "planning_time": 0.003123,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.349235,
                    "execution_time": 0.094414,
                    "compile_time": 0.000263,
                    "planning_time": 0.060655,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number ca_street_name ca_street_type ca_suite_number  ca_city          ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAKMAAAAAA          Dr.        Trena       Grant              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n1   AAAAAAAADMBAAAAA          Mr.      Richard     Mcbride              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n2   AAAAAAAALBCAAAAA          Mr.         John     Jackson              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n3   AAAAAAAAECCAAAAA          Dr.       Martha      Motley              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n4   AAAAAAAAMFCAAAAA         Mrs.        Julia    Phillips              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n5   AAAAAAAAPGCAAAAA         Mrs.      Mildred       Smith              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n6   AAAAAAAAJHCAAAAA          Dr.        Bobby        Gill              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n7   AAAAAAAAMICAAAAA          Dr.      Colleen       Davis              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n8   AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n9   AAAAAAAAAKCAAAAA          Sir       Walter         Lee              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n10  AAAAAAAAEPCAAAAA         Miss      Rebecca       Owens              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n11  AAAAAAAAJPCAAAAA          Dr.        Alvin    Buchanan              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n12  AAAAAAAAABDAAAAA          Sir       Joseph      Wilson              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n13  AAAAAAAAGCDAAAAA          Sir        Bryan     Carroll              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n14  AAAAAAAALCDAAAAA          Sir       Howard         Kay              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n15  AAAAAAAABFDAAAAA          Dr.      Marcela       Arias              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.138125,
                    "execution_time": 0.094439,
                    "compile_time": 0.017609,
                    "planning_time": 0.032365
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.612052,
                    "execution_time": 0.097152,
                    "compile_time": 3.488965,
                    "planning_time": 0.095833
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\""
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number ca_street_name ca_street_type ca_suite_number  ca_city          ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAKMAAAAAA          Dr.        Trena       Grant              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n1   AAAAAAAADMBAAAAA          Mr.      Richard     Mcbride              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n2   AAAAAAAALBCAAAAA          Mr.         John     Jackson              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n3   AAAAAAAAECCAAAAA          Dr.       Martha      Motley              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n4   AAAAAAAAMFCAAAAA         Mrs.        Julia    Phillips              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n5   AAAAAAAAPGCAAAAA         Mrs.      Mildred       Smith              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n6   AAAAAAAAJHCAAAAA          Dr.        Bobby        Gill              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n7   AAAAAAAAMICAAAAA          Dr.      Colleen       Davis              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n8   AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n9   AAAAAAAAAKCAAAAA          Sir       Walter         Lee              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n10  AAAAAAAAEPCAAAAA         Miss      Rebecca       Owens              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n11  AAAAAAAAJPCAAAAA          Dr.        Alvin    Buchanan              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n12  AAAAAAAAABDAAAAA          Sir       Joseph      Wilson              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n13  AAAAAAAAGCDAAAAA          Sir        Bryan     Carroll              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n14  AAAAAAAALCDAAAAA          Sir       Howard         Kay              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n15  AAAAAAAABFDAAAAA          Dr.      Marcela       Arias              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1981.15\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2 from customer_total_return)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT AVG ( \"SPEQLITE_TEMP_TABLE_3\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.067733,
                    "execution_time": 0.037701,
                    "compile_time": 0.000303,
                    "planning_time": 0.00363,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.155214,
                    "execution_time": 0.066387,
                    "compile_time": 0.000295,
                    "planning_time": 0.060412,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.393719,
                    "execution_time": 0.227395,
                    "compile_time": 0.134801,
                    "planning_time": 0.038842,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.166609,
                    "execution_time": 0.370008,
                    "compile_time": 6.690637,
                    "planning_time": 0.103123,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id, c_salutation, c_first_name, c_last_name, ca_street_number, ca_street_name, ca_street_type, ca_suite_number, ca_city, ca_county, ca_state, ca_zip, ca_country, ca_gmt_offset, ca_location_type, ctr_total_return]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021784,
                    "execution_time": 0.007329,
                    "compile_time": 6.9e-05,
                    "planning_time": 0.007006
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.061975,
                    "execution_time": 0.007716,
                    "compile_time": 6.6e-05,
                    "planning_time": 0.043264
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_5\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id, c_salutation, c_first_name, c_last_name, ca_street_number, ca_street_name, ca_street_type, ca_suite_number, ca_city, ca_county, ca_state, ca_zip, ca_country, ca_gmt_offset, ca_location_type, ctr_total_return]\nIndex: []*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2) \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.067907,
                    "execution_time": 0.038186,
                    "compile_time": 0.000307,
                    "planning_time": 0.003557,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.133412,
                    "execution_time": 0.037718,
                    "compile_time": 0.000311,
                    "planning_time": 0.069553,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.279854,
                    "execution_time": 0.214396,
                    "compile_time": 0.000404,
                    "planning_time": 0.034207,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.409013,
                    "execution_time": 0.21785,
                    "compile_time": 0.057706,
                    "planning_time": 0.101145,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_7\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_7\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id, c_salutation, c_first_name, c_last_name, ca_street_number, ca_street_name, ca_street_type, ca_suite_number, ca_city, ca_county, ca_state, ca_zip, ca_country, ca_gmt_offset, ca_location_type, ctr_total_return]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022306,
                    "execution_time": 0.007711,
                    "compile_time": 6.3e-05,
                    "planning_time": 0.007131
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058518,
                    "execution_time": 0.007561,
                    "compile_time": 6.6e-05,
                    "planning_time": 0.043309
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_7\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_7\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_7\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id, c_salutation, c_first_name, c_last_name, ca_street_number, ca_street_name, ca_street_type, ca_suite_number, ca_city, ca_county, ca_state, ca_zip, ca_country, ca_gmt_offset, ca_location_type, ctr_total_return]\nIndex: []*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.356703,
                    "execution_time": 0.092958,
                    "compile_time": 0.000254,
                    "planning_time": 0.003177,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.421788,
                    "execution_time": 0.104158,
                    "compile_time": 0.000259,
                    "planning_time": 0.060515,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.071203,
                    "execution_time": 0.041725,
                    "compile_time": 0.000275,
                    "planning_time": 0.003974,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.144005,
                    "execution_time": 0.042218,
                    "compile_time": 0.000263,
                    "planning_time": 0.073391,
                    "create_size": 185
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" WHERE \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" WHERE \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" WHERE \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" WHERE \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number ca_street_name ca_street_type ca_suite_number  ca_city          ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           3727.63\n1   AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           2436.78\n2   AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           5378.69\n3   AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           7645.59\n4   AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           2572.06\n5   AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           6745.85\n6   AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           2534.41\n7   AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           2610.15\n8   AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           3486.44\n9   AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           2956.59\n10  AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           4550.21\n11  AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1696.41\n12  AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1878.00\n13  AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1744.66\n14  AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1711.44\n15  AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           3514.56\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.100999,
                    "execution_time": 2.042434,
                    "compile_time": 0.000269,
                    "planning_time": 0.042943
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.707828,
                    "execution_time": 2.186133,
                    "compile_time": 4.38924,
                    "planning_time": 0.101569
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number ca_street_name ca_street_type ca_suite_number  ca_city          ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           3727.63\n1   AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           2436.78\n2   AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           5378.69\n3   AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           7645.59\n4   AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           2572.06\n5   AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           6745.85\n6   AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           2534.41\n7   AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           2610.15\n8   AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           3486.44\n9   AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           2956.59\n10  AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           4550.21\n11  AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1696.41\n12  AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1878.00\n13  AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1744.66\n14  AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           1711.44\n15  AAAAAAAAJHFCFAAA          Ms.        Edith      Madsen              314        Spring             Ct.         Suite B  Oakland  Washington County       OH  49843  United States           -5.0        apartment           3514.56\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TN'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number ca_street_name ca_street_type ca_suite_number        ca_city     ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           1758.32\n1   AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family          12625.76\n2   AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           5735.20\n3   AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           2095.78\n4   AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           1986.54\n5   AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           5104.51\n6   AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           2522.00\n7   AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           9838.37\n8   AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           1874.03\n9   AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           1608.74\n10  AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           7487.55\n11  AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           4913.65\n12  AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           5187.25\n13  AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           3052.52\n14  AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           2979.54\n15  AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           1873.20\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.156321,
                    "execution_time": 0.099383,
                    "compile_time": 0.00027,
                    "planning_time": 0.04146
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.344358,
                    "execution_time": 0.107369,
                    "compile_time": 0.114941,
                    "planning_time": 0.10346
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"CTR1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number ca_street_name ca_street_type ca_suite_number        ca_city     ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           1758.32\n1   AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family          12625.76\n2   AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           5735.20\n3   AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           2095.78\n4   AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           1986.54\n5   AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           5104.51\n6   AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           2522.00\n7   AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           9838.37\n8   AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           1874.03\n9   AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           1608.74\n10  AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           7487.55\n11  AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           4913.65\n12  AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           5187.25\n13  AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           3052.52\n14  AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           2979.54\n15  AAAAAAAAJOBAAAAA          Dr.      Kristin        Mack              682          Park              ST         Suite L  Pleasant Hill  Henry County       TN  33604  United States           -5.0    single family           1873.20\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TN'\n       and ctr1.ctr_customer_sk = c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.071318,
                    "execution_time": 0.041493,
                    "compile_time": 0.000267,
                    "planning_time": 0.003958,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.126874,
                    "execution_time": 0.040336,
                    "compile_time": 0.000274,
                    "planning_time": 0.060465,
                    "create_size": 185
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"SPEQLITE_TEMP_TABLE_10\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.16602,
                    "execution_time": 0.081647,
                    "compile_time": 0.000513,
                    "planning_time": 0.037996,
                    "create_size": 152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.817013,
                    "execution_time": 0.102077,
                    "compile_time": 4.548059,
                    "planning_time": 0.114261,
                    "create_size": 152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number   ca_street_name ca_street_type ca_suite_number           ca_city          ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAALIAAAAAA          Dr.    Catherine      Newman              876        Chestnut            Road         Suite D         Riverside  Montgomery County       TN  39231  United States           -6.0        apartment           1800.81\n1   AAAAAAAADMOAAAAA          Dr.      Kathryn     Johnson              798                                                                                            TN  39550                           NaN                            7841.08\n2   AAAAAAAAECCDAAAA          Dr.         Joel        Mims              169      Ash Dogwood           Road         Suite J        Sugar Hill       Giles County       TN  35114  United States           -5.0    single family          13741.82\n3   AAAAAAAAICJEAAAA          Sir        Jesse     Sanchez              941       8th Sunset         Circle       Suite 170          Lakeview     McNairy County       TN  38579  United States           -6.0    single family           3280.36\n4   AAAAAAAAEKOGAAAA          Dr.        Jacob   Pritchard              664          Sunset              RD       Suite 330       Five Points      Greene County       TN  36098  United States           -5.0        apartment           5182.32\n5   AAAAAAAAEGFIAAAA         Mrs.       Lorena      Hughes              560           Maple              Wy       Suite 310     Highland Park       White County       TN  36534  United States           -6.0    single family           2568.54\n6   AAAAAAAAPJMIAAAA         Mrs.      Allison       Gates              853  13th Washington         Circle       Suite 480       Brownsville    Fentress County       TN  39310  United States           -5.0    single family           2497.03\n7   AAAAAAAAAFJJAAAA          Ms.     Margaret       Brown              382            Main          Street         Suite T     Mountain View     Weakley County       TN  34466  United States           -6.0        apartment           5912.07\n8   AAAAAAAALIEKAAAA          Mr.       Hubert   Goldstein              942             9th              RD       Suite 430         Greenwood    Franklin County       TN  38828  United States           -5.0        apartment           2709.00\n9   AAAAAAAAGGHKAAAA          Ms.      Miranda     Randall              118                                       Suite 320                        Carter County       TN                                  NaN        apartment           1798.54\n10  AAAAAAAABIALAAAA         Miss      Adeline      Newman              711             5th             Way         Suite D         Oak Grove      Shelby County       TN  38370  United States           -6.0            condo           7309.31\n11  AAAAAAAAEEDOAAAA          Dr.       Sharon       Valle              938           South             Ave       Suite 330          Hopewell      Gibson County       TN  30587  United States           -5.0            condo           8648.75\n12  AAAAAAAAPAPABAAA          Dr.      Patrick  Hutchinson              688     First Second             Wy       Suite 140        Farmington     Hawkins County       TN  39145  United States           -5.0    single family           2528.03\n13  AAAAAAAALFHBBAAA          Dr.         John    Robinson              634   Sunset Lincoln         Avenue        Suite 30       Mount Olive   Robertson County       TN  38059  United States           -6.0    single family           1620.05\n14  AAAAAAAAPECPBAAA         Mrs.       Yvonne  Fredericks              984   Washington 2nd         Street       Suite 400         Jamestown      Blount County       TN  36867  United States           -5.0    single family           2284.06\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.0207,
                    "execution_time": 0.007424,
                    "compile_time": 6.2e-05,
                    "planning_time": 0.005923
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.059326,
                    "execution_time": 0.008051,
                    "compile_time": 6.4e-05,
                    "planning_time": 0.042258
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"SPEQLITE_TEMP_TABLE_10\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number   ca_street_name ca_street_type ca_suite_number           ca_city          ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAALIAAAAAA          Dr.    Catherine      Newman              876        Chestnut            Road         Suite D         Riverside  Montgomery County       TN  39231  United States           -6.0        apartment           1800.81\n1   AAAAAAAADMOAAAAA          Dr.      Kathryn     Johnson              798                                                                                            TN  39550                           NaN                            7841.08\n2   AAAAAAAAECCDAAAA          Dr.         Joel        Mims              169      Ash Dogwood           Road         Suite J        Sugar Hill       Giles County       TN  35114  United States           -5.0    single family          13741.82\n3   AAAAAAAAICJEAAAA          Sir        Jesse     Sanchez              941       8th Sunset         Circle       Suite 170          Lakeview     McNairy County       TN  38579  United States           -6.0    single family           3280.36\n4   AAAAAAAAEKOGAAAA          Dr.        Jacob   Pritchard              664          Sunset              RD       Suite 330       Five Points      Greene County       TN  36098  United States           -5.0        apartment           5182.32\n5   AAAAAAAAEGFIAAAA         Mrs.       Lorena      Hughes              560           Maple              Wy       Suite 310     Highland Park       White County       TN  36534  United States           -6.0    single family           2568.54\n6   AAAAAAAAPJMIAAAA         Mrs.      Allison       Gates              853  13th Washington         Circle       Suite 480       Brownsville    Fentress County       TN  39310  United States           -5.0    single family           2497.03\n7   AAAAAAAAAFJJAAAA          Ms.     Margaret       Brown              382            Main          Street         Suite T     Mountain View     Weakley County       TN  34466  United States           -6.0        apartment           5912.07\n8   AAAAAAAALIEKAAAA          Mr.       Hubert   Goldstein              942             9th              RD       Suite 430         Greenwood    Franklin County       TN  38828  United States           -5.0        apartment           2709.00\n9   AAAAAAAAGGHKAAAA          Ms.      Miranda     Randall              118                                       Suite 320                        Carter County       TN                                  NaN        apartment           1798.54\n10  AAAAAAAABIALAAAA         Miss      Adeline      Newman              711             5th             Way         Suite D         Oak Grove      Shelby County       TN  38370  United States           -6.0            condo           7309.31\n11  AAAAAAAAEEDOAAAA          Dr.       Sharon       Valle              938           South             Ave       Suite 330          Hopewell      Gibson County       TN  30587  United States           -5.0            condo           8648.75\n12  AAAAAAAAPAPABAAA          Dr.      Patrick  Hutchinson              688     First Second             Wy       Suite 140        Farmington     Hawkins County       TN  39145  United States           -5.0    single family           2528.03\n13  AAAAAAAALFHBBAAA          Dr.         John    Robinson              634   Sunset Lincoln         Avenue        Suite 30       Mount Olive   Robertson County       TN  38059  United States           -6.0    single family           1620.05\n14  AAAAAAAAPECPBAAA         Mrs.       Yvonne  Fredericks              984   Washington 2nd         Street       Suite 400         Jamestown      Blount County       TN  36867  United States           -5.0    single family           2284.06\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TN'\n       and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"C_CUSTOMER_ID\" , \"C_SALUTATION\" , \"C_FIRST_NAME\" , \"C_LAST_NAME\" , \"CA_STREET_NUMBER\" , \"CA_STREET_NAME\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number  ca_street_name ca_street_type ca_suite_number      ca_city         ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAEKGAAA          Dr.         Paul       Green              391        1st Park             RD         Suite T      Clinton   Cheatham County       TN  38222  United States           -5.0        apartment           3292.31\n1   AAAAAAAAAAFJGAAA          Ms.           Jo     Hibbard              903           Park              Wy       Suite 310      Oakdale      Henry County       TN  39584  United States           -5.0    single family           2088.87\n2   AAAAAAAAAAGEAAAA          Ms.        Sarah   Rodriguez              912           Lake              Wy         Suite T   Union Hill     Sumner County       TN  37746  United States           -6.0    single family           2606.35\n3   AAAAAAAAAAGJEAAA          Dr.         Dana      Lowery              885       Ridge 9th            Ave       Suite 310  Buena Vista   Franklin County       TN  35752  United States           -5.0            condo           7375.34\n4   AAAAAAAAAAKFFAAA          Sir      Bernard     Gibbons               49      Jefferson         Parkway       Suite 380     Lakeview   Sullivan County       TN  38579  United States           -6.0            condo           2713.62\n5   AAAAAAAAAAOHBAAA          Ms.         Rosa     Fleming              503       5th Cedar             ST         Suite G  Valley View     Greene County       TN  35124  United States           -5.0    single family           1828.60\n6   AAAAAAAAAAOLCAAA          Dr.        Susan   Singleton              971       Railroad            Road       Suite 130     Woodland     Shelby County       TN  34854  United States           -6.0    single family           5925.33\n7   AAAAAAAAAAPDDAAA          Dr.      Chester        King              936         Meadow              ST         Suite L    Riverside     Warren County       TN  39231  United States           -6.0        apartment           3462.17\n8   AAAAAAAAABBCBAAA          Dr.       Arthur       Palma              936        Lee Main             Ln        Suite 20    Jamestown  Van Buren County       TN  36867  United States           -6.0    single family           2390.69\n9   AAAAAAAAABBJBAAA                 Katherine      Parker              519           10th          Avenue         Suite T      Concord     Carter County       TN  34107  United States           -5.0    single family           1658.98\n10  AAAAAAAAABCGAAAA          Ms.       Glenda        Hunt                                          Street                     Wildwood    Dickson County       TN         United States            NaN            condo           2280.70\n11  AAAAAAAAABCGAAAA          Ms.       Glenda        Hunt                                          Street                     Wildwood    Dickson County       TN         United States            NaN            condo           4138.97\n12  AAAAAAAAABCLEAAA          Sir      Matthew       Morse              113      Cherry 6th             RD        Suite 60   Greenville      Henry County       TN  31387  United States           -5.0        apartment          11380.07\n13  AAAAAAAAABCLEAAA          Sir      Matthew       Morse              113      Cherry 6th             RD        Suite 60   Greenville      Henry County       TN  31387  United States           -5.0        apartment           3250.34\n14  AAAAAAAAABJMEAAA          Dr.      Earline       Jones              525     Ash Johnson          Court       Suite 250  Maple Grove    McNairy County       TN  38252  United States           -6.0        apartment           3382.78\n15  AAAAAAAAABLBCAAA          Sir         Jack      Hansen              813    Ridge Forest          Drive         Suite W     Fairview    Stewart County       TN  35709  United States           -6.0            condo           2211.85\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022684,
                    "execution_time": 0.008424,
                    "compile_time": 0.000107,
                    "planning_time": 0.006542
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.061669,
                    "execution_time": 0.009647,
                    "compile_time": 0.000111,
                    "planning_time": 0.042594
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"SPEQLITE_TEMP_TABLE_10\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number  ca_street_name ca_street_type ca_suite_number      ca_city         ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAEKGAAA          Dr.         Paul       Green              391        1st Park             RD         Suite T      Clinton   Cheatham County       TN  38222  United States           -5.0        apartment           3292.31\n1   AAAAAAAAAAFJGAAA          Ms.           Jo     Hibbard              903           Park              Wy       Suite 310      Oakdale      Henry County       TN  39584  United States           -5.0    single family           2088.87\n2   AAAAAAAAAAGEAAAA          Ms.        Sarah   Rodriguez              912           Lake              Wy         Suite T   Union Hill     Sumner County       TN  37746  United States           -6.0    single family           2606.35\n3   AAAAAAAAAAGJEAAA          Dr.         Dana      Lowery              885       Ridge 9th            Ave       Suite 310  Buena Vista   Franklin County       TN  35752  United States           -5.0            condo           7375.34\n4   AAAAAAAAAAKFFAAA          Sir      Bernard     Gibbons               49      Jefferson         Parkway       Suite 380     Lakeview   Sullivan County       TN  38579  United States           -6.0            condo           2713.62\n5   AAAAAAAAAAOHBAAA          Ms.         Rosa     Fleming              503       5th Cedar             ST         Suite G  Valley View     Greene County       TN  35124  United States           -5.0    single family           1828.60\n6   AAAAAAAAAAOLCAAA          Dr.        Susan   Singleton              971       Railroad            Road       Suite 130     Woodland     Shelby County       TN  34854  United States           -6.0    single family           5925.33\n7   AAAAAAAAAAPDDAAA          Dr.      Chester        King              936         Meadow              ST         Suite L    Riverside     Warren County       TN  39231  United States           -6.0        apartment           3462.17\n8   AAAAAAAAABBCBAAA          Dr.       Arthur       Palma              936        Lee Main             Ln        Suite 20    Jamestown  Van Buren County       TN  36867  United States           -6.0    single family           2390.69\n9   AAAAAAAAABBJBAAA                 Katherine      Parker              519           10th          Avenue         Suite T      Concord     Carter County       TN  34107  United States           -5.0    single family           1658.98\n10  AAAAAAAAABCGAAAA          Ms.       Glenda        Hunt                                          Street                     Wildwood    Dickson County       TN         United States            NaN            condo           2280.70\n11  AAAAAAAAABCGAAAA          Ms.       Glenda        Hunt                                          Street                     Wildwood    Dickson County       TN         United States            NaN            condo           4138.97\n12  AAAAAAAAABCLEAAA          Sir      Matthew       Morse              113      Cherry 6th             RD        Suite 60   Greenville      Henry County       TN  31387  United States           -5.0        apartment          11380.07\n13  AAAAAAAAABCLEAAA          Sir      Matthew       Morse              113      Cherry 6th             RD        Suite 60   Greenville      Henry County       TN  31387  United States           -5.0        apartment           3250.34\n14  AAAAAAAAABJMEAAA          Dr.      Earline       Jones              525     Ash Johnson          Court       Suite 250  Maple Grove    McNairy County       TN  38252  United States           -6.0        apartment           3382.78\n15  AAAAAAAAABLBCAAA          Sir         Jack      Hansen              813    Ridge Forest          Drive         Suite W     Fairview    Stewart County       TN  35709  United States           -6.0            condo           2211.85\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TN'\n       and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"C_CUSTOMER_ID\" , \"C_SALUTATION\" , \"C_FIRST_NAME\" , \"C_LAST_NAME\" , \"CA_STREET_NUMBER\" , \"CA_STREET_NAME\" , \"CA_STREET_TYPE\" , \"CA_SUITE_NUMBER\" , \"CA_CITY\" , \"CA_COUNTY\" , \"CA_STATE\" , \"CA_ZIP\" , \"CA_COUNTRY\" , \"CA_GMT_OFFSET\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number  ca_street_name ca_street_type ca_suite_number      ca_city         ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAEKGAAA          Dr.         Paul       Green              391        1st Park             RD         Suite T      Clinton   Cheatham County       TN  38222  United States           -5.0        apartment           3292.31\n1   AAAAAAAAAAFJGAAA          Ms.           Jo     Hibbard              903           Park              Wy       Suite 310      Oakdale      Henry County       TN  39584  United States           -5.0    single family           2088.87\n2   AAAAAAAAAAGEAAAA          Ms.        Sarah   Rodriguez              912           Lake              Wy         Suite T   Union Hill     Sumner County       TN  37746  United States           -6.0    single family           2606.35\n3   AAAAAAAAAAGJEAAA          Dr.         Dana      Lowery              885       Ridge 9th            Ave       Suite 310  Buena Vista   Franklin County       TN  35752  United States           -5.0            condo           7375.34\n4   AAAAAAAAAAKFFAAA          Sir      Bernard     Gibbons               49      Jefferson         Parkway       Suite 380     Lakeview   Sullivan County       TN  38579  United States           -6.0            condo           2713.62\n5   AAAAAAAAAAOHBAAA          Ms.         Rosa     Fleming              503       5th Cedar             ST         Suite G  Valley View     Greene County       TN  35124  United States           -5.0    single family           1828.60\n6   AAAAAAAAAAOLCAAA          Dr.        Susan   Singleton              971       Railroad            Road       Suite 130     Woodland     Shelby County       TN  34854  United States           -6.0    single family           5925.33\n7   AAAAAAAAAAPDDAAA          Dr.      Chester        King              936         Meadow              ST         Suite L    Riverside     Warren County       TN  39231  United States           -6.0        apartment           3462.17\n8   AAAAAAAAABBCBAAA          Dr.       Arthur       Palma              936        Lee Main             Ln        Suite 20    Jamestown  Van Buren County       TN  36867  United States           -6.0    single family           2390.69\n9   AAAAAAAAABBJBAAA                 Katherine      Parker              519           10th          Avenue         Suite T      Concord     Carter County       TN  34107  United States           -5.0    single family           1658.98\n10  AAAAAAAAABCGAAAA          Ms.       Glenda        Hunt                                          Street                     Wildwood    Dickson County       TN         United States            NaN            condo           2280.70\n11  AAAAAAAAABCGAAAA          Ms.       Glenda        Hunt                                          Street                     Wildwood    Dickson County       TN         United States            NaN            condo           4138.97\n12  AAAAAAAAABCLEAAA          Sir      Matthew       Morse              113      Cherry 6th             RD        Suite 60   Greenville      Henry County       TN  31387  United States           -5.0        apartment          11380.07\n13  AAAAAAAAABCLEAAA          Sir      Matthew       Morse              113      Cherry 6th             RD        Suite 60   Greenville      Henry County       TN  31387  United States           -5.0        apartment           3250.34\n14  AAAAAAAAABJMEAAA          Dr.      Earline       Jones              525     Ash Johnson          Court       Suite 250  Maple Grove    McNairy County       TN  38252  United States           -6.0        apartment           3382.78\n15  AAAAAAAAABLBCAAA          Sir         Jack      Hansen              813    Ridge Forest          Drive         Suite W     Fairview    Stewart County       TN  35709  United States           -6.0            condo           2211.85\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.0247,
                    "execution_time": 0.009157,
                    "compile_time": 0.000116,
                    "planning_time": 0.00744
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060788,
                    "execution_time": 0.009414,
                    "compile_time": 0.000117,
                    "planning_time": 0.043308
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"SPEQLITE_TEMP_TABLE_10\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST"
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number  ca_street_name ca_street_type ca_suite_number      ca_city         ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAEKGAAA          Dr.         Paul       Green              391        1st Park             RD         Suite T      Clinton   Cheatham County       TN  38222  United States           -5.0        apartment           3292.31\n1   AAAAAAAAAAFJGAAA          Ms.           Jo     Hibbard              903           Park              Wy       Suite 310      Oakdale      Henry County       TN  39584  United States           -5.0    single family           2088.87\n2   AAAAAAAAAAGEAAAA          Ms.        Sarah   Rodriguez              912           Lake              Wy         Suite T   Union Hill     Sumner County       TN  37746  United States           -6.0    single family           2606.35\n3   AAAAAAAAAAGJEAAA          Dr.         Dana      Lowery              885       Ridge 9th            Ave       Suite 310  Buena Vista   Franklin County       TN  35752  United States           -5.0            condo           7375.34\n4   AAAAAAAAAAKFFAAA          Sir      Bernard     Gibbons               49      Jefferson         Parkway       Suite 380     Lakeview   Sullivan County       TN  38579  United States           -6.0            condo           2713.62\n5   AAAAAAAAAAOHBAAA          Ms.         Rosa     Fleming              503       5th Cedar             ST         Suite G  Valley View     Greene County       TN  35124  United States           -5.0    single family           1828.60\n6   AAAAAAAAAAOLCAAA          Dr.        Susan   Singleton              971       Railroad            Road       Suite 130     Woodland     Shelby County       TN  34854  United States           -6.0    single family           5925.33\n7   AAAAAAAAAAPDDAAA          Dr.      Chester        King              936         Meadow              ST         Suite L    Riverside     Warren County       TN  39231  United States           -6.0        apartment           3462.17\n8   AAAAAAAAABBCBAAA          Dr.       Arthur       Palma              936        Lee Main             Ln        Suite 20    Jamestown  Van Buren County       TN  36867  United States           -6.0    single family           2390.69\n9   AAAAAAAAABBJBAAA                 Katherine      Parker              519           10th          Avenue         Suite T      Concord     Carter County       TN  34107  United States           -5.0    single family           1658.98\n10  AAAAAAAAABCGAAAA          Ms.       Glenda        Hunt                                          Street                     Wildwood    Dickson County       TN         United States            NaN            condo           2280.70\n11  AAAAAAAAABCGAAAA          Ms.       Glenda        Hunt                                          Street                     Wildwood    Dickson County       TN         United States            NaN            condo           4138.97\n12  AAAAAAAAABCLEAAA          Sir      Matthew       Morse              113      Cherry 6th             RD        Suite 60   Greenville      Henry County       TN  31387  United States           -5.0        apartment          11380.07\n13  AAAAAAAAABCLEAAA          Sir      Matthew       Morse              113      Cherry 6th             RD        Suite 60   Greenville      Henry County       TN  31387  United States           -5.0        apartment           3250.34\n14  AAAAAAAAABJMEAAA          Dr.      Earline       Jones              525     Ash Johnson          Court       Suite 250  Maple Grove    McNairy County       TN  38252  United States           -6.0        apartment           3382.78\n15  AAAAAAAAABLBCAAA          Sir         Jack      Hansen              813    Ridge Forest          Drive         Suite W     Fairview    Stewart County       TN  35709  United States           -6.0            condo           2211.85\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TN'\n       and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST , \"CA_LOCATION_TYPE\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"C_CUSTOMER_ID\" , \"C_SALUTATION\" , \"C_FIRST_NAME\" , \"C_LAST_NAME\" , \"CA_STREET_NUMBER\" , \"CA_STREET_NAME\" , \"CA_STREET_TYPE\" , \"CA_SUITE_NUMBER\" , \"CA_CITY\" , \"CA_COUNTY\" , \"CA_STATE\" , \"CA_ZIP\" , \"CA_COUNTRY\" , \"CA_GMT_OFFSET\" , \"CA_LOCATION_TYPE\" , \"CTR_TOTAL_RETURN\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number  ca_street_name ca_street_type ca_suite_number      ca_city         ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAEKGAAA          Dr.         Paul       Green              391        1st Park             RD         Suite T      Clinton   Cheatham County       TN  38222  United States           -5.0        apartment           3292.31\n1   AAAAAAAAAAFJGAAA          Ms.           Jo     Hibbard              903           Park              Wy       Suite 310      Oakdale      Henry County       TN  39584  United States           -5.0    single family           2088.87\n2   AAAAAAAAAAGEAAAA          Ms.        Sarah   Rodriguez              912           Lake              Wy         Suite T   Union Hill     Sumner County       TN  37746  United States           -6.0    single family           2606.35\n3   AAAAAAAAAAGJEAAA          Dr.         Dana      Lowery              885       Ridge 9th            Ave       Suite 310  Buena Vista   Franklin County       TN  35752  United States           -5.0            condo           7375.34\n4   AAAAAAAAAAKFFAAA          Sir      Bernard     Gibbons               49      Jefferson         Parkway       Suite 380     Lakeview   Sullivan County       TN  38579  United States           -6.0            condo           2713.62\n5   AAAAAAAAAAOHBAAA          Ms.         Rosa     Fleming              503       5th Cedar             ST         Suite G  Valley View     Greene County       TN  35124  United States           -5.0    single family           1828.60\n6   AAAAAAAAAAOLCAAA          Dr.        Susan   Singleton              971       Railroad            Road       Suite 130     Woodland     Shelby County       TN  34854  United States           -6.0    single family           5925.33\n7   AAAAAAAAAAPDDAAA          Dr.      Chester        King              936         Meadow              ST         Suite L    Riverside     Warren County       TN  39231  United States           -6.0        apartment           3462.17\n8   AAAAAAAAABBCBAAA          Dr.       Arthur       Palma              936        Lee Main             Ln        Suite 20    Jamestown  Van Buren County       TN  36867  United States           -6.0    single family           2390.69\n9   AAAAAAAAABBJBAAA                 Katherine      Parker              519           10th          Avenue         Suite T      Concord     Carter County       TN  34107  United States           -5.0    single family           1658.98\n10  AAAAAAAAABCGAAAA          Ms.       Glenda        Hunt                                          Street                     Wildwood    Dickson County       TN         United States            NaN            condo           2280.70\n11  AAAAAAAAABCGAAAA          Ms.       Glenda        Hunt                                          Street                     Wildwood    Dickson County       TN         United States            NaN            condo           4138.97\n12  AAAAAAAAABCLEAAA          Sir      Matthew       Morse              113      Cherry 6th             RD        Suite 60   Greenville      Henry County       TN  31387  United States           -5.0        apartment           3250.34\n13  AAAAAAAAABCLEAAA          Sir      Matthew       Morse              113      Cherry 6th             RD        Suite 60   Greenville      Henry County       TN  31387  United States           -5.0        apartment          11380.07\n14  AAAAAAAAABJMEAAA          Dr.      Earline       Jones              525     Ash Johnson          Court       Suite 250  Maple Grove    McNairy County       TN  38252  United States           -6.0        apartment           3382.78\n15  AAAAAAAAABLBCAAA          Sir         Jack      Hansen              813    Ridge Forest          Drive         Suite W     Fairview    Stewart County       TN  35709  United States           -6.0            condo           2211.85\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.024062,
                    "execution_time": 0.008432,
                    "compile_time": 0.000118,
                    "planning_time": 0.007587
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.06126,
                    "execution_time": 0.009524,
                    "compile_time": 0.000115,
                    "planning_time": 0.043653
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"SPEQLITE_TEMP_TABLE_10\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST , \"CA_LOCATION_TYPE\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST , \"CA_LOCATION_TYPE\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST"
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number  ca_street_name ca_street_type ca_suite_number      ca_city         ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAEKGAAA          Dr.         Paul       Green              391        1st Park             RD         Suite T      Clinton   Cheatham County       TN  38222  United States           -5.0        apartment           3292.31\n1   AAAAAAAAAAFJGAAA          Ms.           Jo     Hibbard              903           Park              Wy       Suite 310      Oakdale      Henry County       TN  39584  United States           -5.0    single family           2088.87\n2   AAAAAAAAAAGEAAAA          Ms.        Sarah   Rodriguez              912           Lake              Wy         Suite T   Union Hill     Sumner County       TN  37746  United States           -6.0    single family           2606.35\n3   AAAAAAAAAAGJEAAA          Dr.         Dana      Lowery              885       Ridge 9th            Ave       Suite 310  Buena Vista   Franklin County       TN  35752  United States           -5.0            condo           7375.34\n4   AAAAAAAAAAKFFAAA          Sir      Bernard     Gibbons               49      Jefferson         Parkway       Suite 380     Lakeview   Sullivan County       TN  38579  United States           -6.0            condo           2713.62\n5   AAAAAAAAAAOHBAAA          Ms.         Rosa     Fleming              503       5th Cedar             ST         Suite G  Valley View     Greene County       TN  35124  United States           -5.0    single family           1828.60\n6   AAAAAAAAAAOLCAAA          Dr.        Susan   Singleton              971       Railroad            Road       Suite 130     Woodland     Shelby County       TN  34854  United States           -6.0    single family           5925.33\n7   AAAAAAAAAAPDDAAA          Dr.      Chester        King              936         Meadow              ST         Suite L    Riverside     Warren County       TN  39231  United States           -6.0        apartment           3462.17\n8   AAAAAAAAABBCBAAA          Dr.       Arthur       Palma              936        Lee Main             Ln        Suite 20    Jamestown  Van Buren County       TN  36867  United States           -6.0    single family           2390.69\n9   AAAAAAAAABBJBAAA                 Katherine      Parker              519           10th          Avenue         Suite T      Concord     Carter County       TN  34107  United States           -5.0    single family           1658.98\n10  AAAAAAAAABCGAAAA          Ms.       Glenda        Hunt                                          Street                     Wildwood    Dickson County       TN         United States            NaN            condo           2280.70\n11  AAAAAAAAABCGAAAA          Ms.       Glenda        Hunt                                          Street                     Wildwood    Dickson County       TN         United States            NaN            condo           4138.97\n12  AAAAAAAAABCLEAAA          Sir      Matthew       Morse              113      Cherry 6th             RD        Suite 60   Greenville      Henry County       TN  31387  United States           -5.0        apartment           3250.34\n13  AAAAAAAAABCLEAAA          Sir      Matthew       Morse              113      Cherry 6th             RD        Suite 60   Greenville      Henry County       TN  31387  United States           -5.0        apartment          11380.07\n14  AAAAAAAAABJMEAAA          Dr.      Earline       Jones              525     Ash Johnson          Court       Suite 250  Maple Grove    McNairy County       TN  38252  United States           -6.0        apartment           3382.78\n15  AAAAAAAAABLBCAAA          Sir         Jack      Hansen              813    Ridge Forest          Drive         Suite W     Fairview    Stewart County       TN  35709  United States           -6.0            condo           2211.85\n...*/"
    },
    {
        "input": "-- start template query81.tpl query 37 in stream 0\nwith /* TPC-DS query81.tpl 0.37 */ customer_total_return as\n (select cr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(cr_return_amt_inc_tax) as ctr_total_return\n from catalog_returns\n     ,date_dim\n     ,customer_address\n where cr_returned_date_sk = d_date_sk \n   and d_year =1999\n   and cr_returning_addr_sk = ca_address_sk \n group by cr_returning_customer_sk\n         ,ca_state )\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TN'\n       and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,ca_street_number,ca_street_name\n                   ,ca_street_type,ca_suite_number,ca_city,ca_county,ca_state,ca_zip,ca_country,ca_gmt_offset\n                  ,ca_location_type,ctr_total_return\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"CATALOG_RETURNS\".\"CR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CATALOG_RETURNS\".\"CR_RETURNING_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"CATALOG_RETURNS\".\"CR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST , \"CA_LOCATION_TYPE\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"C_CUSTOMER_ID\" , \"C_SALUTATION\" , \"C_FIRST_NAME\" , \"C_LAST_NAME\" , \"CA_STREET_NUMBER\" , \"CA_STREET_NAME\" , \"CA_STREET_TYPE\" , \"CA_SUITE_NUMBER\" , \"CA_CITY\" , \"CA_COUNTY\" , \"CA_STATE\" , \"CA_ZIP\" , \"CA_COUNTRY\" , \"CA_GMT_OFFSET\" , \"CA_LOCATION_TYPE\" , \"CTR_TOTAL_RETURN\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number  ca_street_name ca_street_type ca_suite_number      ca_city         ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAEKGAAA          Dr.         Paul       Green              391        1st Park             RD         Suite T      Clinton   Cheatham County       TN  38222  United States           -5.0        apartment           3292.31\n1   AAAAAAAAAAFJGAAA          Ms.           Jo     Hibbard              903           Park              Wy       Suite 310      Oakdale      Henry County       TN  39584  United States           -5.0    single family           2088.87\n2   AAAAAAAAAAGEAAAA          Ms.        Sarah   Rodriguez              912           Lake              Wy         Suite T   Union Hill     Sumner County       TN  37746  United States           -6.0    single family           2606.35\n3   AAAAAAAAAAGJEAAA          Dr.         Dana      Lowery              885       Ridge 9th            Ave       Suite 310  Buena Vista   Franklin County       TN  35752  United States           -5.0            condo           7375.34\n4   AAAAAAAAAAKFFAAA          Sir      Bernard     Gibbons               49      Jefferson         Parkway       Suite 380     Lakeview   Sullivan County       TN  38579  United States           -6.0            condo           2713.62\n5   AAAAAAAAAAOHBAAA          Ms.         Rosa     Fleming              503       5th Cedar             ST         Suite G  Valley View     Greene County       TN  35124  United States           -5.0    single family           1828.60\n6   AAAAAAAAAAOLCAAA          Dr.        Susan   Singleton              971       Railroad            Road       Suite 130     Woodland     Shelby County       TN  34854  United States           -6.0    single family           5925.33\n7   AAAAAAAAAAPDDAAA          Dr.      Chester        King              936         Meadow              ST         Suite L    Riverside     Warren County       TN  39231  United States           -6.0        apartment           3462.17\n8   AAAAAAAAABBCBAAA          Dr.       Arthur       Palma              936        Lee Main             Ln        Suite 20    Jamestown  Van Buren County       TN  36867  United States           -6.0    single family           2390.69\n9   AAAAAAAAABBJBAAA                 Katherine      Parker              519           10th          Avenue         Suite T      Concord     Carter County       TN  34107  United States           -5.0    single family           1658.98\n10  AAAAAAAAABCGAAAA          Ms.       Glenda        Hunt                                          Street                     Wildwood    Dickson County       TN         United States            NaN            condo           2280.70\n11  AAAAAAAAABCGAAAA          Ms.       Glenda        Hunt                                          Street                     Wildwood    Dickson County       TN         United States            NaN            condo           4138.97\n12  AAAAAAAAABCLEAAA          Sir      Matthew       Morse              113      Cherry 6th             RD        Suite 60   Greenville      Henry County       TN  31387  United States           -5.0        apartment           3250.34\n13  AAAAAAAAABCLEAAA          Sir      Matthew       Morse              113      Cherry 6th             RD        Suite 60   Greenville      Henry County       TN  31387  United States           -5.0        apartment          11380.07\n14  AAAAAAAAABJMEAAA          Dr.      Earline       Jones              525     Ash Johnson          Court       Suite 250  Maple Grove    McNairy County       TN  38252  United States           -6.0        apartment           3382.78\n15  AAAAAAAAABLBCAAA          Sir         Jack      Hansen              813    Ridge Forest          Drive         Suite W     Fairview    Stewart County       TN  35709  United States           -6.0            condo           2211.85\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.024309,
                    "execution_time": 0.008544,
                    "compile_time": 0.000116,
                    "planning_time": 0.007698
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.024596,
                    "execution_time": 0.008693,
                    "compile_time": 0.000113,
                    "planning_time": 0.007724
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"CUSTOMER_ADDRESS\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"CUSTOMER_ADDRESS\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"CUSTOMER_ADDRESS\".\"CA_CITY\" AS \"CA_CITY\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_ZIP\" AS \"CA_ZIP\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"CUSTOMER_ADDRESS\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TN' WHERE \"SPEQLITE_TEMP_TABLE_10\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST , \"CA_LOCATION_TYPE\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_NUMBER\" AS \"CA_STREET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_NAME\" AS \"CA_STREET_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STREET_TYPE\" AS \"CA_STREET_TYPE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_SUITE_NUMBER\" AS \"CA_SUITE_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_CITY\" AS \"CA_CITY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_ZIP\" AS \"CA_ZIP\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_GMT_OFFSET\" AS \"CA_GMT_OFFSET\" , \"SPEQLITE_TEMP_TABLE_11\".\"CA_LOCATION_TYPE\" AS \"CA_LOCATION_TYPE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"CA_STREET_NUMBER\" NULLS LAST , \"CA_STREET_NAME\" NULLS LAST , \"CA_STREET_TYPE\" NULLS LAST , \"CA_SUITE_NUMBER\" NULLS LAST , \"CA_CITY\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_ZIP\" NULLS LAST , \"CA_COUNTRY\" NULLS LAST , \"CA_GMT_OFFSET\" NULLS LAST , \"CA_LOCATION_TYPE\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name ca_street_number  ca_street_name ca_street_type ca_suite_number      ca_city         ca_county ca_state ca_zip     ca_country  ca_gmt_offset ca_location_type  ctr_total_return\n0   AAAAAAAAAAEKGAAA          Dr.         Paul       Green              391        1st Park             RD         Suite T      Clinton   Cheatham County       TN  38222  United States           -5.0        apartment           3292.31\n1   AAAAAAAAAAFJGAAA          Ms.           Jo     Hibbard              903           Park              Wy       Suite 310      Oakdale      Henry County       TN  39584  United States           -5.0    single family           2088.87\n2   AAAAAAAAAAGEAAAA          Ms.        Sarah   Rodriguez              912           Lake              Wy         Suite T   Union Hill     Sumner County       TN  37746  United States           -6.0    single family           2606.35\n3   AAAAAAAAAAGJEAAA          Dr.         Dana      Lowery              885       Ridge 9th            Ave       Suite 310  Buena Vista   Franklin County       TN  35752  United States           -5.0            condo           7375.34\n4   AAAAAAAAAAKFFAAA          Sir      Bernard     Gibbons               49      Jefferson         Parkway       Suite 380     Lakeview   Sullivan County       TN  38579  United States           -6.0            condo           2713.62\n5   AAAAAAAAAAOHBAAA          Ms.         Rosa     Fleming              503       5th Cedar             ST         Suite G  Valley View     Greene County       TN  35124  United States           -5.0    single family           1828.60\n6   AAAAAAAAAAOLCAAA          Dr.        Susan   Singleton              971       Railroad            Road       Suite 130     Woodland     Shelby County       TN  34854  United States           -6.0    single family           5925.33\n7   AAAAAAAAAAPDDAAA          Dr.      Chester        King              936         Meadow              ST         Suite L    Riverside     Warren County       TN  39231  United States           -6.0        apartment           3462.17\n8   AAAAAAAAABBCBAAA          Dr.       Arthur       Palma              936        Lee Main             Ln        Suite 20    Jamestown  Van Buren County       TN  36867  United States           -6.0    single family           2390.69\n9   AAAAAAAAABBJBAAA                 Katherine      Parker              519           10th          Avenue         Suite T      Concord     Carter County       TN  34107  United States           -5.0    single family           1658.98\n10  AAAAAAAAABCGAAAA          Ms.       Glenda        Hunt                                          Street                     Wildwood    Dickson County       TN         United States            NaN            condo           2280.70\n11  AAAAAAAAABCGAAAA          Ms.       Glenda        Hunt                                          Street                     Wildwood    Dickson County       TN         United States            NaN            condo           4138.97\n12  AAAAAAAAABCLEAAA          Sir      Matthew       Morse              113      Cherry 6th             RD        Suite 60   Greenville      Henry County       TN  31387  United States           -5.0        apartment           3250.34\n13  AAAAAAAAABCLEAAA          Sir      Matthew       Morse              113      Cherry 6th             RD        Suite 60   Greenville      Henry County       TN  31387  United States           -5.0        apartment          11380.07\n14  AAAAAAAAABJMEAAA          Dr.      Earline       Jones              525     Ash Johnson          Court       Suite 250  Maple Grove    McNairy County       TN  38252  United States           -6.0        apartment           3382.78\n15  AAAAAAAAABLBCAAA          Sir         Jack      Hansen              813    Ridge Forest          Drive         Suite W     Fairview    Stewart County       TN  35709  United States           -6.0            condo           2211.85\n...*/"
    }
]