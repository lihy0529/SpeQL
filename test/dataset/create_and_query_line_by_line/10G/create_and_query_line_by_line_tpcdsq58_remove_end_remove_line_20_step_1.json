[
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(SS_EXT_SALES_PRICE) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(CS_EXT_SALES_PRICE) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(WS_EXT_SALES_PRICE) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\nselect * from ss_items  -- Added main SELECT statement\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.110605,
                    "execution_time": 0.041366,
                    "compile_time": 0.000236,
                    "planning_time": 0.028507,
                    "create_size": 480
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.167862,
                    "execution_time": 0.040499,
                    "compile_time": 0.000229,
                    "planning_time": 0.08683,
                    "create_size": 480
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.147993,
                    "execution_time": 0.04639,
                    "compile_time": 0.000222,
                    "planning_time": 0.023742,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.210384,
                    "execution_time": 0.046231,
                    "compile_time": 0.000241,
                    "planning_time": 0.085652,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.078411,
                    "execution_time": 0.030265,
                    "compile_time": 0.000229,
                    "planning_time": 0.025527,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.142791,
                    "execution_time": 0.032464,
                    "compile_time": 0.000231,
                    "planning_time": 0.087093,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.091783,
                    "execution_time": 0.039535,
                    "compile_time": 0.000295,
                    "planning_time": 0.026521,
                    "create_size": 28
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.160205,
                    "execution_time": 0.040694,
                    "compile_time": 0.000295,
                    "planning_time": 0.090825,
                    "create_size": 28
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"SPEQLITE_TEMP_TABLE_4\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.290133,
                    "execution_time": 0.077289,
                    "compile_time": 0.116014,
                    "planning_time": 0.033811,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.034376,
                    "execution_time": 0.286201,
                    "compile_time": 6.580063,
                    "planning_time": 0.098818,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev\n0   AAAAAAAACFLBAAAA        59.16\n1   AAAAAAAAHFLIAAAA      4918.41\n2   AAAAAAAAPEOBAAAA       129.90\n3   AAAAAAAAMDDFAAAA      7498.40\n4   AAAAAAAAAGKGAAAA      1030.59\n5   AAAAAAAAPMPABAAA      7254.72\n6   AAAAAAAAODKKAAAA      1867.80\n7   AAAAAAAAKILMAAAA      1120.86\n8   AAAAAAAAKJBPAAAA      3269.02\n9   AAAAAAAAJFNGBAAA      6071.67\n10  AAAAAAAAGHOEAAAA      2237.72\n11  AAAAAAAAFEPGBAAA      7402.75\n12  AAAAAAAAAHMDAAAA      1370.00\n13  AAAAAAAACDFEAAAA       390.50\n14  AAAAAAAADEJIBAAA     14467.07\n15  AAAAAAAAKKGDAAAA      6185.84\n16  AAAAAAAAMFOKAAAA      1547.00\n17  AAAAAAAAEECNAAAA      1139.82\n18  AAAAAAAAJGMDBAAA      2798.90\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015845,
                    "execution_time": 0.007119,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.002991
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054226,
                    "execution_time": 0.007395,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.038008
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev\n0   AAAAAAAACFLBAAAA        59.16\n1   AAAAAAAAHFLIAAAA      4918.41\n2   AAAAAAAAPEOBAAAA       129.90\n3   AAAAAAAAMDDFAAAA      7498.40\n4   AAAAAAAAAGKGAAAA      1030.59\n5   AAAAAAAAPMPABAAA      7254.72\n6   AAAAAAAAODKKAAAA      1867.80\n7   AAAAAAAAKILMAAAA      1120.86\n8   AAAAAAAAKJBPAAAA      3269.02\n9   AAAAAAAAJFNGBAAA      6071.67\n10  AAAAAAAAGHOEAAAA      2237.72\n11  AAAAAAAAFEPGBAAA      7402.75\n12  AAAAAAAAAHMDAAAA      1370.00\n13  AAAAAAAACDFEAAAA       390.50\n14  AAAAAAAADEJIBAAA     14467.07\n15  AAAAAAAAKKGDAAAA      6185.84\n16  AAAAAAAAMFOKAAAA      1547.00\n17  AAAAAAAAEECNAAAA      1139.82\n18  AAAAAAAAJGMDBAAA      2798.90\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select ss_item_sk item_id\n        ,sum(SS_EXT_SALES_PRICE) ss_item_rev \n from store_sales\n     ,date_dim\n where ss_sold_date_sk   = d_date_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n group by ss_item_sk),\n cs_items as\n (select cs_item_sk item_id\n        ,sum(CS_EXT_SALES_PRICE) cs_item_rev\n  from catalog_sales\n      ,date_dim\n where cs_sold_date_sk = d_date_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n group by cs_item_sk),\n ws_items as\n (select ws_item_sk item_id\n        ,sum(WS_EXT_SALES_PRICE) ws_item_rev\n  from web_sales\n      ,date_dim\n where ws_sold_date_sk   = d_date_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n group by ws_item_sk)\nselect ss_items.item_id\nfrom ss_items\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"STORE_SALES\".\"SS_ITEM_SK\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"STORE_SALES\".\"SS_ITEM_SK\" AS \"ITEM_ID\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"SPEQLITE_TEMP_TABLE_4\".\"D_DATE\" IS NULL GROUP BY \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.132262,
                    "execution_time": 0.064362,
                    "compile_time": 0.0004,
                    "planning_time": 0.031033,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.202821,
                    "execution_time": 0.064993,
                    "compile_time": 0.001327,
                    "planning_time": 0.093144,
                    "create_size": 512
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"ITEM_ID\" AS \"ITEM_ID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*    item_id\n0     92914\n1     94714\n2     67534\n3     35110\n4     35342\n5     27250\n6     35254\n7     59012\n8     97682\n9     67912\n10    13117\n11    30100\n12    39484\n13    93734\n14    53590\n15    40964\n16    90379\n17    87968\n18    17450\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015769,
                    "execution_time": 0.007442,
                    "compile_time": 3.9e-05,
                    "planning_time": 0.002762
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054428,
                    "execution_time": 0.007298,
                    "compile_time": 4.1e-05,
                    "planning_time": 0.038357
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"ITEM_ID\" AS \"ITEM_ID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"ITEM_ID\" AS \"ITEM_ID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*    item_id\n0     92914\n1     94714\n2     67534\n3     35110\n4     35342\n5     27250\n6     35254\n7     59012\n8     97682\n9     67912\n10    13117\n11    30100\n12    39484\n13    93734\n14    53590\n15    40964\n16    90379\n17    87968\n18    17450\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n, cs_item_rev, ws_item_rev from ss_items left join cs_items on ss_items.item_id = cs_items.item_id left join ws_items on ss_items.item_id = ws_items.item_id /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" LEFT JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.090023,
                    "execution_time": 0.039255,
                    "compile_time": 0.000284,
                    "planning_time": 0.025508,
                    "create_size": 28
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.157885,
                    "execution_time": 0.039244,
                    "compile_time": 0.000279,
                    "planning_time": 0.09343,
                    "create_size": 28
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.167372,
                    "execution_time": 0.07638,
                    "compile_time": 0.000449,
                    "planning_time": 0.038603,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.232707,
                    "execution_time": 0.075747,
                    "compile_time": 0.000456,
                    "planning_time": 0.101484,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.092002,
                    "execution_time": 0.039891,
                    "compile_time": 0.000293,
                    "planning_time": 0.025944,
                    "create_size": 28
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.15313,
                    "execution_time": 0.039187,
                    "compile_time": 0.000308,
                    "planning_time": 0.088451,
                    "create_size": 28
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"SPEQLITE_TEMP_TABLE_9\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.152621,
                    "execution_time": 0.074214,
                    "compile_time": 0.000444,
                    "planning_time": 0.035669,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.224376,
                    "execution_time": 0.073259,
                    "compile_time": 0.001554,
                    "planning_time": 0.103633,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.1457,
                    "execution_time": 0.06685,
                    "compile_time": 0.000298,
                    "planning_time": 0.007077,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.209793,
                    "execution_time": 0.067799,
                    "compile_time": 0.00029,
                    "planning_time": 0.06531,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_11\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_11\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  cs_item_rev  ws_item_rev\n0   AAAAAAAAFCGPAAAA       788.84      3844.62          NaN\n1   AAAAAAAACEDHBAAA      2552.96      1051.83          NaN\n2   AAAAAAAAMNDHAAAA      2419.86     15389.93       994.08\n3   AAAAAAAAABAGAAAA      1091.28          NaN          NaN\n4   AAAAAAAAOFIGBAAA     10537.95       979.20      1482.12\n5   AAAAAAAAOBODAAAA      1286.01      2869.26          NaN\n6   AAAAAAAAEPCFAAAA      3708.73       154.64          NaN\n7   AAAAAAAAKNBLAAAA      7885.02       459.54          NaN\n8   AAAAAAAACAFMAAAA       741.30      5549.76       249.92\n9   AAAAAAAALAFMAAAA       521.22      1813.75      1982.27\n10  AAAAAAAAKAAABAAA       223.47       200.88       158.88\n11  AAAAAAAACJNDBAAA       609.84          NaN          NaN\n12  AAAAAAAANKAEBAAA      9451.56          NaN          NaN\n13  AAAAAAAANMIDBAAA      1858.17      9334.00          NaN\n14  AAAAAAAAINOHBAAA          NaN      1320.66       240.02\n15  AAAAAAAAOPAFAAAA       480.76          NaN          NaN\n16  AAAAAAAAEMGBAAAA        57.12          NaN          NaN\n17  AAAAAAAAOLAEAAAA      2926.99          NaN          NaN\n18  AAAAAAAAJDNJAAAA       807.88      2446.24          NaN\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017658,
                    "execution_time": 0.008066,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003559
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056054,
                    "execution_time": 0.008067,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.038749
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_11\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_11\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  cs_item_rev  ws_item_rev\n0   AAAAAAAAFCGPAAAA       788.84      3844.62          NaN\n1   AAAAAAAACEDHBAAA      2552.96      1051.83          NaN\n2   AAAAAAAAMNDHAAAA      2419.86     15389.93       994.08\n3   AAAAAAAAABAGAAAA      1091.28          NaN          NaN\n4   AAAAAAAAOFIGBAAA     10537.95       979.20      1482.12\n5   AAAAAAAAOBODAAAA      1286.01      2869.26          NaN\n6   AAAAAAAAEPCFAAAA      3708.73       154.64          NaN\n7   AAAAAAAAKNBLAAAA      7885.02       459.54          NaN\n8   AAAAAAAACAFMAAAA       741.30      5549.76       249.92\n9   AAAAAAAALAFMAAAA       521.22      1813.75      1982.27\n10  AAAAAAAAKAAABAAA       223.47       200.88       158.88\n11  AAAAAAAACJNDBAAA       609.84          NaN          NaN\n12  AAAAAAAANKAEBAAA      9451.56          NaN          NaN\n13  AAAAAAAANMIDBAAA      1858.17      9334.00          NaN\n14  AAAAAAAAINOHBAAA          NaN      1320.66       240.02\n15  AAAAAAAAOPAFAAAA       480.76          NaN          NaN\n16  AAAAAAAAEMGBAAAA        57.12          NaN          NaN\n17  AAAAAAAAOLAEAAAA      2926.99          NaN          NaN\n18  AAAAAAAAJDNJAAAA       807.88      2446.24          NaN\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\nfrom ss_items\nleft join cs_items on ss_items.item_id = cs_items.item_id\nleft join ws_items on ss_items.item_id = ws_items.item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" LEFT JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.131505,
                    "execution_time": 0.06445,
                    "compile_time": 0.000292,
                    "planning_time": 0.007666,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.195613,
                    "execution_time": 0.064432,
                    "compile_time": 0.000292,
                    "planning_time": 0.06837,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_12\".\"SS_DEV\" AS \"SS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev\n0   AAAAAAAAIPEABAAA      6773.85     NaN\n1   AAAAAAAALMCIBAAA      3923.26  134.82\n2   AAAAAAAAKFHMAAAA      4321.62     NaN\n3   AAAAAAAAGNAHAAAA      1004.18     NaN\n4   AAAAAAAADKEOAAAA      1069.95     NaN\n5   AAAAAAAAICGDAAAA       383.66     NaN\n6   AAAAAAAAJCAIAAAA       658.88     NaN\n7   AAAAAAAACOGJAAAA      1438.44     NaN\n8   AAAAAAAAJCHBAAAA      5974.69     NaN\n9   AAAAAAAAPOJFAAAA      3042.99     NaN\n10  AAAAAAAAGOPGAAAA     10145.17  231.79\n11  AAAAAAAAALFJAAAA     12720.00     NaN\n12  AAAAAAAAOLAMAAAA       206.65     NaN\n13  AAAAAAAAMGDGBAAA        34.72     NaN\n14  AAAAAAAAFAMEBAAA      1995.40     NaN\n15  AAAAAAAANPOHAAAA      1752.59     NaN\n16  AAAAAAAAADJABAAA       257.00     NaN\n17  AAAAAAAACMBDBAAA      2690.00     NaN\n18  AAAAAAAAKFOGAAAA      5879.15     NaN\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016647,
                    "execution_time": 0.007532,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003289
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05555,
                    "execution_time": 0.008272,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.038245
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_12\".\"SS_DEV\" AS \"SS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev\n0   AAAAAAAAIPEABAAA      6773.85     NaN\n1   AAAAAAAALMCIBAAA      3923.26  134.82\n2   AAAAAAAAKFHMAAAA      4321.62     NaN\n3   AAAAAAAAGNAHAAAA      1004.18     NaN\n4   AAAAAAAADKEOAAAA      1069.95     NaN\n5   AAAAAAAAICGDAAAA       383.66     NaN\n6   AAAAAAAAJCAIAAAA       658.88     NaN\n7   AAAAAAAACOGJAAAA      1438.44     NaN\n8   AAAAAAAAJCHBAAAA      5974.69     NaN\n9   AAAAAAAAPOJFAAAA      3042.99     NaN\n10  AAAAAAAAGOPGAAAA     10145.17  231.79\n11  AAAAAAAAALFJAAAA     12720.00     NaN\n12  AAAAAAAAOLAMAAAA       206.65     NaN\n13  AAAAAAAAMGDGBAAA        34.72     NaN\n14  AAAAAAAAFAMEBAAA      1995.40     NaN\n15  AAAAAAAANPOHAAAA      1752.59     NaN\n16  AAAAAAAAADJABAAA       257.00     NaN\n17  AAAAAAAACMBDBAAA      2690.00     NaN\n18  AAAAAAAAKFOGAAAA      5879.15     NaN\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\nfrom ss_items left join cs_items on ss_items.item_id = cs_items.item_id left join ws_items on ss_items.item_id = ws_items.item_id /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" LEFT JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.142651,
                    "execution_time": 0.066835,
                    "compile_time": 0.000291,
                    "planning_time": 0.00764,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.202327,
                    "execution_time": 0.0673,
                    "compile_time": 0.000298,
                    "planning_time": 0.065696,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_13\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_13\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev\n0   AAAAAAAAHHCAAAAA      4053.06     NaN          NaN\n1   AAAAAAAAAAHBAAAA      4016.24     NaN          NaN\n2   AAAAAAAAJLBBAAAA      8064.08     NaN       859.68\n3   AAAAAAAAHNHKAAAA      1140.36     NaN     11521.16\n4   AAAAAAAAPHCGBAAA       784.30     NaN          NaN\n5   AAAAAAAAKCLPAAAA      1915.26     NaN          NaN\n6   AAAAAAAAGJJBBAAA      4239.54     NaN      1137.12\n7   AAAAAAAAKEGFAAAA       243.75     NaN       618.24\n8   AAAAAAAAIPKOAAAA       105.75     NaN          NaN\n9   AAAAAAAAHGFNAAAA      6111.39     NaN          NaN\n10  AAAAAAAAILEIAAAA      2299.69     NaN          NaN\n11  AAAAAAAAKFHGBAAA       475.20     NaN          NaN\n12  AAAAAAAAEMAGAAAA       611.64   35.25       914.30\n13  AAAAAAAAELHFBAAA      2316.50     NaN          NaN\n14  AAAAAAAAPLGEBAAA       712.60     NaN          NaN\n15  AAAAAAAAMAFOAAAA       374.40   27.89      1983.03\n16  AAAAAAAABHEEAAAA      2985.32     NaN       506.62\n17  AAAAAAAAGEGEAAAA      4184.49     NaN      7323.30\n18  AAAAAAAAKBABBAAA      1125.77     NaN          NaN\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017092,
                    "execution_time": 0.00772,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.00341
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052839,
                    "execution_time": 0.00809,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038703
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_13\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_13\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev\n0   AAAAAAAAHHCAAAAA      4053.06     NaN          NaN\n1   AAAAAAAAAAHBAAAA      4016.24     NaN          NaN\n2   AAAAAAAAJLBBAAAA      8064.08     NaN       859.68\n3   AAAAAAAAHNHKAAAA      1140.36     NaN     11521.16\n4   AAAAAAAAPHCGBAAA       784.30     NaN          NaN\n5   AAAAAAAAKCLPAAAA      1915.26     NaN          NaN\n6   AAAAAAAAGJJBBAAA      4239.54     NaN      1137.12\n7   AAAAAAAAKEGFAAAA       243.75     NaN       618.24\n8   AAAAAAAAIPKOAAAA       105.75     NaN          NaN\n9   AAAAAAAAHGFNAAAA      6111.39     NaN          NaN\n10  AAAAAAAAILEIAAAA      2299.69     NaN          NaN\n11  AAAAAAAAKFHGBAAA       475.20     NaN          NaN\n12  AAAAAAAAEMAGAAAA       611.64   35.25       914.30\n13  AAAAAAAAELHFBAAA      2316.50     NaN          NaN\n14  AAAAAAAAPLGEBAAA       712.60     NaN          NaN\n15  AAAAAAAAMAFOAAAA       374.40   27.89      1983.03\n16  AAAAAAAABHEEAAAA      2985.32     NaN       506.62\n17  AAAAAAAAGEGEAAAA      4184.49     NaN      7323.30\n18  AAAAAAAAKBABBAAA      1125.77     NaN          NaN\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+coalesce(cs_item_rev, 0)+coalesce(ws_item_rev, 0))/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+coalesce(cs_item_rev, 0)+coalesce(ws_item_rev, 0))/3) * 100 cs_dev\nfrom ss_items\nleft join cs_items on ss_items.item_id = cs_items.item_id\nleft join ws_items on ss_items.item_id = ws_items.item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + COALESCE ( \"CS_ITEMS\".\"CS_ITEM_REV\" , 0 ) + COALESCE ( \"WS_ITEMS\".\"WS_ITEM_REV\" , 0 ) ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + COALESCE ( \"CS_ITEMS\".\"CS_ITEM_REV\" , 0 ) + COALESCE ( \"WS_ITEMS\".\"WS_ITEM_REV\" , 0 ) ) / 3 ) * 100 AS \"CS_DEV\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" LEFT JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": null,
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + COALESCE ( \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" , 0 ) + COALESCE ( \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" , 0 ) ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + COALESCE ( \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" , 0 ) + COALESCE ( \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" , 0 ) ) / 3 ) * 100 AS \"CS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": null
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\nfrom ss_items left join cs_items on ss_items.item_id = cs_items.item_id left join ws_items on ss_items.item_id = ws_items.item_id /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" LEFT JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.158285,
                    "execution_time": 0.071318,
                    "compile_time": 0.000312,
                    "planning_time": 0.008887,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.338439,
                    "execution_time": 0.073121,
                    "compile_time": 0.119859,
                    "planning_time": 0.065436,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_14\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_14\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_14\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_14\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev\n0   AAAAAAAAAJHKAAAA      1636.31   67.48      2006.42   82.74      3631.78\n1   AAAAAAAANJBHBAAA       864.82     NaN       887.04     NaN          NaN\n2   AAAAAAAAODFEAAAA          NaN     NaN      1258.53     NaN        39.15\n3   AAAAAAAAKAJJAAAA      4012.10     NaN      2011.44     NaN          NaN\n4   AAAAAAAAJIAHBAAA          NaN     NaN          NaN     NaN          NaN\n5   AAAAAAAAKIFFAAAA      4741.64     NaN          NaN     NaN     17351.21\n6   AAAAAAAAAACMAAAA      1164.70     NaN          NaN     NaN          NaN\n7   AAAAAAAALNADBAAA       974.94     NaN      6108.57     NaN          NaN\n8   AAAAAAAALJMCAAAA      5062.71     NaN      2553.84     NaN          NaN\n9   AAAAAAAAMMDFAAAA       457.50     NaN      4742.90     NaN          NaN\n10  AAAAAAAADBHLAAAA       103.83     NaN      1030.96     NaN          NaN\n11  AAAAAAAAFFJCBAAA      2623.14     NaN      5636.40     NaN          NaN\n12  AAAAAAAANEHDBAAA      9003.87     NaN          NaN     NaN       122.98\n13  AAAAAAAACMAOAAAA       448.70     NaN          NaN     NaN          NaN\n14  AAAAAAAAOAFABAAA     10343.46     NaN      3006.96     NaN          NaN\n15  AAAAAAAAIACAAAAA       626.99     NaN          NaN     NaN          NaN\n16  AAAAAAAAJLIAAAAA      7396.32     NaN          NaN     NaN          NaN\n17  AAAAAAAAFCDGAAAA      3407.60     NaN          NaN     NaN          NaN\n18  AAAAAAAAIALBAAAA      4133.70     NaN          NaN     NaN      3057.85\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017289,
                    "execution_time": 0.007503,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003761
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05884,
                    "execution_time": 0.008407,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.040189
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_14\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_14\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_14\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_14\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev\n0   AAAAAAAAAJHKAAAA      1636.31   67.48      2006.42   82.74      3631.78\n1   AAAAAAAANJBHBAAA       864.82     NaN       887.04     NaN          NaN\n2   AAAAAAAAODFEAAAA          NaN     NaN      1258.53     NaN        39.15\n3   AAAAAAAAKAJJAAAA      4012.10     NaN      2011.44     NaN          NaN\n4   AAAAAAAAJIAHBAAA          NaN     NaN          NaN     NaN          NaN\n5   AAAAAAAAKIFFAAAA      4741.64     NaN          NaN     NaN     17351.21\n6   AAAAAAAAAACMAAAA      1164.70     NaN          NaN     NaN          NaN\n7   AAAAAAAALNADBAAA       974.94     NaN      6108.57     NaN          NaN\n8   AAAAAAAALJMCAAAA      5062.71     NaN      2553.84     NaN          NaN\n9   AAAAAAAAMMDFAAAA       457.50     NaN      4742.90     NaN          NaN\n10  AAAAAAAADBHLAAAA       103.83     NaN      1030.96     NaN          NaN\n11  AAAAAAAAFFJCBAAA      2623.14     NaN      5636.40     NaN          NaN\n12  AAAAAAAANEHDBAAA      9003.87     NaN          NaN     NaN       122.98\n13  AAAAAAAACMAOAAAA       448.70     NaN          NaN     NaN          NaN\n14  AAAAAAAAOAFABAAA     10343.46     NaN      3006.96     NaN          NaN\n15  AAAAAAAAIACAAAAA       626.99     NaN          NaN     NaN          NaN\n16  AAAAAAAAJLIAAAAA      7396.32     NaN          NaN     NaN          NaN\n17  AAAAAAAAFCDGAAAA      3407.60     NaN          NaN     NaN          NaN\n18  AAAAAAAAIALBAAAA      4133.70     NaN          NaN     NaN      3057.85\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\nfrom ss_items left join cs_items on ss_items.item_id = cs_items.item_id left join ws_items on ss_items.item_id = ws_items.item_id /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" LEFT JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.164244,
                    "execution_time": 0.074958,
                    "compile_time": 0.000303,
                    "planning_time": 0.009194,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.313588,
                    "execution_time": 0.074816,
                    "compile_time": 0.087765,
                    "planning_time": 0.067935,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_15\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_15\".\"WS_DEV\" AS \"WS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev\n0   AAAAAAAAHHCAAAAA      4053.06     NaN          NaN     NaN      9607.16     NaN\n1   AAAAAAAAAAHBAAAA      4016.24     NaN          NaN     NaN          NaN     NaN\n2   AAAAAAAAJLBBAAAA      8064.08     NaN       859.68     NaN          NaN     NaN\n3   AAAAAAAAHNHKAAAA      1140.36     NaN     11521.16     NaN          NaN     NaN\n4   AAAAAAAAPHCGBAAA       784.30     NaN          NaN     NaN          NaN     NaN\n5   AAAAAAAAKCLPAAAA      1915.26     NaN          NaN     NaN      1458.54     NaN\n6   AAAAAAAAGJJBBAAA      4239.54     NaN      1137.12     NaN          NaN     NaN\n7   AAAAAAAAKEGFAAAA       243.75     NaN       618.24     NaN          NaN     NaN\n8   AAAAAAAAIPKOAAAA       105.75     NaN          NaN     NaN       152.26     NaN\n9   AAAAAAAAHGFNAAAA      6111.39     NaN          NaN     NaN          NaN     NaN\n10  AAAAAAAAILEIAAAA      2299.69     NaN          NaN     NaN        47.56     NaN\n11  AAAAAAAAKFHGBAAA       475.20     NaN          NaN     NaN      2227.20     NaN\n12  AAAAAAAAEMAGAAAA       611.64   35.25       914.30   52.70      3678.62  212.04\n13  AAAAAAAAELHFBAAA      2316.50     NaN          NaN     NaN          NaN     NaN\n14  AAAAAAAAPLGEBAAA       712.60     NaN          NaN     NaN          NaN     NaN\n15  AAAAAAAAMAFOAAAA       374.40   27.89      1983.03  147.72      1669.72  124.38\n16  AAAAAAAABHEEAAAA      2985.32     NaN       506.62     NaN          NaN     NaN\n17  AAAAAAAAGEGEAAAA      4184.49     NaN      7323.30     NaN          NaN     NaN\n18  AAAAAAAAKBABBAAA      1125.77     NaN          NaN     NaN          NaN     NaN\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018927,
                    "execution_time": 0.00808,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.004182
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056988,
                    "execution_time": 0.008124,
                    "compile_time": 5e-05,
                    "planning_time": 0.039355
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_15\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_15\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_15\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_15\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_15\".\"WS_DEV\" AS \"WS_DEV\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev\n0   AAAAAAAAHHCAAAAA      4053.06     NaN          NaN     NaN      9607.16     NaN\n1   AAAAAAAAAAHBAAAA      4016.24     NaN          NaN     NaN          NaN     NaN\n2   AAAAAAAAJLBBAAAA      8064.08     NaN       859.68     NaN          NaN     NaN\n3   AAAAAAAAHNHKAAAA      1140.36     NaN     11521.16     NaN          NaN     NaN\n4   AAAAAAAAPHCGBAAA       784.30     NaN          NaN     NaN          NaN     NaN\n5   AAAAAAAAKCLPAAAA      1915.26     NaN          NaN     NaN      1458.54     NaN\n6   AAAAAAAAGJJBBAAA      4239.54     NaN      1137.12     NaN          NaN     NaN\n7   AAAAAAAAKEGFAAAA       243.75     NaN       618.24     NaN          NaN     NaN\n8   AAAAAAAAIPKOAAAA       105.75     NaN          NaN     NaN       152.26     NaN\n9   AAAAAAAAHGFNAAAA      6111.39     NaN          NaN     NaN          NaN     NaN\n10  AAAAAAAAILEIAAAA      2299.69     NaN          NaN     NaN        47.56     NaN\n11  AAAAAAAAKFHGBAAA       475.20     NaN          NaN     NaN      2227.20     NaN\n12  AAAAAAAAEMAGAAAA       611.64   35.25       914.30   52.70      3678.62  212.04\n13  AAAAAAAAELHFBAAA      2316.50     NaN          NaN     NaN          NaN     NaN\n14  AAAAAAAAPLGEBAAA       712.60     NaN          NaN     NaN          NaN     NaN\n15  AAAAAAAAMAFOAAAA       374.40   27.89      1983.03  147.72      1669.72  124.38\n16  AAAAAAAABHEEAAAA      2985.32     NaN       506.62     NaN          NaN     NaN\n17  AAAAAAAAGEGEAAAA      4184.49     NaN      7323.30     NaN          NaN     NaN\n18  AAAAAAAAKBABBAAA      1125.77     NaN          NaN     NaN          NaN     NaN\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\nfrom ss_items left join cs_items on ss_items.item_id = cs_items.item_id left join ws_items on ss_items.item_id = ws_items.item_id /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" LEFT JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" LEFT JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.170703,
                    "execution_time": 0.077231,
                    "compile_time": 0.000306,
                    "planning_time": 0.009805,
                    "create_size": 1408
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.233271,
                    "execution_time": 0.078954,
                    "compile_time": 0.000302,
                    "planning_time": 0.067246,
                    "create_size": 1408
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev    average\n0   AAAAAAAAFCGPAAAA       788.84     NaN      3844.62     NaN          NaN     NaN        NaN\n1   AAAAAAAACEDHBAAA      2552.96     NaN      1051.83     NaN          NaN     NaN        NaN\n2   AAAAAAAAMNDHAAAA      2419.86   38.60     15389.93  245.53       994.08   15.85  6267.9566\n3   AAAAAAAAABAGAAAA      1091.28     NaN          NaN     NaN          NaN     NaN        NaN\n4   AAAAAAAAOFIGBAAA     10537.95  243.19       979.20   22.59      1482.12   34.20  4333.0900\n5   AAAAAAAAOBODAAAA      1286.01     NaN      2869.26     NaN          NaN     NaN        NaN\n6   AAAAAAAAEPCFAAAA      3708.73     NaN       154.64     NaN          NaN     NaN        NaN\n7   AAAAAAAAKNBLAAAA      7885.02     NaN       459.54     NaN          NaN     NaN        NaN\n8   AAAAAAAACAFMAAAA       741.30   33.99      5549.76  254.53       249.92   11.46  2180.3266\n9   AAAAAAAALAFMAAAA       521.22   36.21      1813.75  126.03      1982.27  137.74  1439.0800\n10  AAAAAAAAKAAABAAA       223.47  114.94       200.88  103.32       158.88   81.72   194.4100\n11  AAAAAAAACJNDBAAA       609.84     NaN          NaN     NaN          NaN     NaN        NaN\n12  AAAAAAAANKAEBAAA      9451.56     NaN          NaN     NaN          NaN     NaN        NaN\n13  AAAAAAAANMIDBAAA      1858.17     NaN      9334.00     NaN          NaN     NaN        NaN\n14  AAAAAAAAINOHBAAA          NaN     NaN      1320.66     NaN       240.02     NaN        NaN\n15  AAAAAAAAOPAFAAAA       480.76     NaN          NaN     NaN          NaN     NaN        NaN\n16  AAAAAAAAEMGBAAAA        57.12     NaN          NaN     NaN          NaN     NaN        NaN\n17  AAAAAAAAOLAEAAAA      2926.99     NaN          NaN     NaN          NaN     NaN        NaN\n18  AAAAAAAAJDNJAAAA       807.88     NaN      2446.24     NaN          NaN     NaN        NaN\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018203,
                    "execution_time": 0.007651,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004237
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057395,
                    "execution_time": 0.008251,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039899
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev    average\n0   AAAAAAAAFCGPAAAA       788.84     NaN      3844.62     NaN          NaN     NaN        NaN\n1   AAAAAAAACEDHBAAA      2552.96     NaN      1051.83     NaN          NaN     NaN        NaN\n2   AAAAAAAAMNDHAAAA      2419.86   38.60     15389.93  245.53       994.08   15.85  6267.9566\n3   AAAAAAAAABAGAAAA      1091.28     NaN          NaN     NaN          NaN     NaN        NaN\n4   AAAAAAAAOFIGBAAA     10537.95  243.19       979.20   22.59      1482.12   34.20  4333.0900\n5   AAAAAAAAOBODAAAA      1286.01     NaN      2869.26     NaN          NaN     NaN        NaN\n6   AAAAAAAAEPCFAAAA      3708.73     NaN       154.64     NaN          NaN     NaN        NaN\n7   AAAAAAAAKNBLAAAA      7885.02     NaN       459.54     NaN          NaN     NaN        NaN\n8   AAAAAAAACAFMAAAA       741.30   33.99      5549.76  254.53       249.92   11.46  2180.3266\n9   AAAAAAAALAFMAAAA       521.22   36.21      1813.75  126.03      1982.27  137.74  1439.0800\n10  AAAAAAAAKAAABAAA       223.47  114.94       200.88  103.32       158.88   81.72   194.4100\n11  AAAAAAAACJNDBAAA       609.84     NaN          NaN     NaN          NaN     NaN        NaN\n12  AAAAAAAANKAEBAAA      9451.56     NaN          NaN     NaN          NaN     NaN        NaN\n13  AAAAAAAANMIDBAAA      1858.17     NaN      9334.00     NaN          NaN     NaN        NaN\n14  AAAAAAAAINOHBAAA          NaN     NaN      1320.66     NaN       240.02     NaN        NaN\n15  AAAAAAAAOPAFAAAA       480.76     NaN          NaN     NaN          NaN     NaN        NaN\n16  AAAAAAAAEMGBAAAA        57.12     NaN          NaN     NaN          NaN     NaN        NaN\n17  AAAAAAAAOLAEAAAA      2926.99     NaN          NaN     NaN          NaN     NaN        NaN\n18  AAAAAAAAJDNJAAAA       807.88     NaN      2446.24     NaN          NaN     NaN        NaN\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" CROSS JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" CROSS JOIN \"WS_ITEMS\" AS \"WS_ITEMS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.079997,
                    "execution_time": 0.04009,
                    "compile_time": 0.000243,
                    "planning_time": 0.002933,
                    "create_size": 140
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.144141,
                    "execution_time": 0.041214,
                    "compile_time": 0.000245,
                    "planning_time": 0.060939,
                    "create_size": 136
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.072884,
                    "execution_time": 0.038382,
                    "compile_time": 0.000252,
                    "planning_time": 0.002872,
                    "create_size": 80
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.132952,
                    "execution_time": 0.038043,
                    "compile_time": 0.000247,
                    "planning_time": 0.058855,
                    "create_size": 76
                }
            }
        ],
        "query": [
            {
                "query": "WITH SS_ITEMS AS ( SELECT I_ITEM_ID AS ITEM_ID , SUM ( SS_EXT_SALES_PRICE ) AS SS_ITEM_REV FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND D_DATE IN ( SELECT D_DATE FROM DATE_DIM WHERE D_WEEK_SEQ = ( SELECT D_WEEK_SEQ FROM DATE_DIM WHERE D_DATE = '1998-04-13' ) ) AND SS_SOLD_DATE_SK = D_DATE_SK GROUP BY I_ITEM_ID ) , CS_ITEMS AS ( SELECT I_ITEM_ID AS ITEM_ID , SUM ( CS_EXT_SALES_PRICE ) AS CS_ITEM_REV FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND D_DATE IN ( SELECT D_DATE FROM DATE_DIM WHERE D_WEEK_SEQ = ( SELECT D_WEEK_SEQ FROM DATE_DIM WHERE D_DATE = '1998-04-13' ) ) AND CS_SOLD_DATE_SK = D_DATE_SK GROUP BY I_ITEM_ID ) , WS_ITEMS AS ( SELECT I_ITEM_ID AS ITEM_ID , SUM ( WS_EXT_SALES_PRICE ) AS WS_ITEM_REV FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND D_DATE IN ( SELECT D_DATE FROM DATE_DIM WHERE D_WEEK_SEQ = ( SELECT D_WEEK_SEQ FROM DATE_DIM WHERE D_DATE = '1998-04-13' ) ) AND WS_SOLD_DATE_SK = D_DATE_SK GROUP BY I_ITEM_ID ) SELECT SS_ITEMS.ITEM_ID , SS_ITEM_REV , SS_ITEM_REV / ( ( SS_ITEM_REV + CS_ITEM_REV + WS_ITEM_REV ) / 3 ) * 100 AS SS_DEV , CS_ITEM_REV , CS_ITEM_REV / ( ( SS_ITEM_REV + CS_ITEM_REV + WS_ITEM_REV ) / 3 ) * 100 AS CS_DEV , WS_ITEM_REV , WS_ITEM_REV / ( ( SS_ITEM_REV + CS_ITEM_REV + WS_ITEM_REV ) / 3 ) * 100 AS WS_DEV , ( SS_ITEM_REV + CS_ITEM_REV + WS_ITEM_REV ) / 3 AS AVERAGE FROM SS_ITEMS , CS_ITEMS , WS_ITEMS LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev    average\n0   AAAAAAAANJAAAAAA     13667.88  164.83       6071.9   73.22      5136.04   61.94  8291.9400\n1   AAAAAAAAJNDAAAAA      1447.62   34.31       6071.9  143.93      5136.04  121.74  4218.5200\n2   AAAAAAAAMGFAAAAA      3967.52   78.43       6071.9  120.03      5136.04  101.53  5058.4866\n3   AAAAAAAAPHGAAAAA        48.00    1.27       6071.9  161.83      5136.04  136.88  3751.9800\n4   AAAAAAAAILHAAAAA      1510.34   35.62       6071.9  143.22      5136.04  121.14  4239.4266\n5   AAAAAAAAGJGBAAAA      3163.90   66.04       6071.9  126.74      5136.04  107.21  4790.6133\n6   AAAAAAAAGANBAAAA      5097.18   93.78       6071.9  111.71      5136.04   94.49  5435.0400\n7   AAAAAAAADCACAAAA     14453.75  168.97       6071.9   70.98      5136.04   60.04  8553.8966\n8   AAAAAAAAAJDCAAAA      3315.33   68.48       6071.9  125.42      5136.04  106.09  4841.0900\n9   AAAAAAAAJHECAAAA      3816.33   76.20       6071.9  121.24      5136.04  102.55  5008.0900\n10  AAAAAAAAKOGCAAAA         1.04    0.02       6071.9  162.50      5136.04  137.46  3736.3266\n11  AAAAAAAAELICAAAA      1246.60   30.02       6071.9  146.25      5136.04  123.71  4151.5133\n12  AAAAAAAAHOLCAAAA      3234.26   67.18       6071.9  126.12      5136.04  106.68  4814.0666\n13  AAAAAAAAEJDDAAAA      3601.95   72.96       6071.9  122.99      5136.04  104.03  4936.6300\n14  AAAAAAAAJFIDAAAA       862.20   21.42       6071.9  150.91      5136.04  127.65  4023.3800\n15  AAAAAAAAKFNDAAAA      2219.52   49.58       6071.9  135.66      5136.04  114.75  4475.8200\n16  AAAAAAAAMKNDAAAA      1986.66   45.16       6071.9  138.05      5136.04  116.77  4398.2000\n17  AAAAAAAAIHODAAAA      3918.26   77.71       6071.9  120.42      5136.04  101.86  5042.0666\n18  AAAAAAAAIKAEAAAA      4915.98   91.46       6071.9  112.97      5136.04   95.56  5374.6400\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.284081,
                    "execution_time": 0.118988,
                    "compile_time": 0.001088,
                    "planning_time": 0.161324
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 6.421637,
                    "execution_time": 0.122344,
                    "compile_time": 6.026872,
                    "planning_time": 0.259356
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_17\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev    average\n0   AAAAAAAANJAAAAAA     13667.88  164.83       6071.9   73.22      5136.04   61.94  8291.9400\n1   AAAAAAAAJNDAAAAA      1447.62   34.31       6071.9  143.93      5136.04  121.74  4218.5200\n2   AAAAAAAAMGFAAAAA      3967.52   78.43       6071.9  120.03      5136.04  101.53  5058.4866\n3   AAAAAAAAPHGAAAAA        48.00    1.27       6071.9  161.83      5136.04  136.88  3751.9800\n4   AAAAAAAAILHAAAAA      1510.34   35.62       6071.9  143.22      5136.04  121.14  4239.4266\n5   AAAAAAAAGJGBAAAA      3163.90   66.04       6071.9  126.74      5136.04  107.21  4790.6133\n6   AAAAAAAAGANBAAAA      5097.18   93.78       6071.9  111.71      5136.04   94.49  5435.0400\n7   AAAAAAAADCACAAAA     14453.75  168.97       6071.9   70.98      5136.04   60.04  8553.8966\n8   AAAAAAAAAJDCAAAA      3315.33   68.48       6071.9  125.42      5136.04  106.09  4841.0900\n9   AAAAAAAAJHECAAAA      3816.33   76.20       6071.9  121.24      5136.04  102.55  5008.0900\n10  AAAAAAAAKOGCAAAA         1.04    0.02       6071.9  162.50      5136.04  137.46  3736.3266\n11  AAAAAAAAELICAAAA      1246.60   30.02       6071.9  146.25      5136.04  123.71  4151.5133\n12  AAAAAAAAHOLCAAAA      3234.26   67.18       6071.9  126.12      5136.04  106.68  4814.0666\n13  AAAAAAAAEJDDAAAA      3601.95   72.96       6071.9  122.99      5136.04  104.03  4936.6300\n14  AAAAAAAAJFIDAAAA       862.20   21.42       6071.9  150.91      5136.04  127.65  4023.3800\n15  AAAAAAAAKFNDAAAA      2219.52   49.58       6071.9  135.66      5136.04  114.75  4475.8200\n16  AAAAAAAAMKNDAAAA      1986.66   45.16       6071.9  138.05      5136.04  116.77  4398.2000\n17  AAAAAAAAIHODAAAA      3918.26   77.71       6071.9  120.42      5136.04  101.86  5042.0666\n18  AAAAAAAAIKAEAAAA      4915.98   91.46       6071.9  112.97      5136.04   95.56  5374.6400\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" CROSS JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev    average\n0   AAAAAAAAMLGEBAAA      5651.86  157.22       776.16   21.59      4356.48  121.18  3594.8333\n1   AAAAAAAAMLGEBAAA      5651.86  215.60       776.16   29.60      1436.16   54.78  2621.3933\n2   AAAAAAAAMLGEBAAA      5651.86  209.13       776.16   28.72      1679.43   62.14  2702.4833\n3   AAAAAAAAMLGEBAAA      5651.86  184.07       776.16   25.27      2783.12   90.64  3070.3800\n4   AAAAAAAAMLGEBAAA      5651.86  168.13       776.16   23.09      3656.25  108.77  3361.4233\n5   AAAAAAAAMLGEBAAA      5651.86  263.52       776.16   36.18         6.08    0.28  2144.7000\n6   AAAAAAAAMLGEBAAA      5651.86  175.49       776.16   24.09      3233.76  100.40  3220.5933\n7   AAAAAAAAMLGEBAAA      5651.86  257.02       776.16   35.29       168.84    7.67  2198.9533\n8   AAAAAAAAMLGEBAAA      5651.86  220.23       776.16   30.24      1271.00   49.52  2566.3400\n9   AAAAAAAAMLGEBAAA      5651.86  185.90       776.16   25.53      2692.48   88.56  3040.1666\n10  AAAAAAAAMLGEBAAA      5651.86  231.54       776.16   31.79       894.80   36.65  2440.9400\n11  AAAAAAAAMLGEBAAA      5651.86  212.76       776.16   29.21      1541.32   58.02  2656.4466\n12  AAAAAAAAMLGEBAAA      5651.86  247.75       776.16   34.02       415.72   18.22  2281.2466\n13  AAAAAAAAMLGEBAAA      5651.86  217.08       776.16   29.81      1382.48   53.10  2603.5000\n14  AAAAAAAAMLGEBAAA      5651.86  257.85       776.16   35.41       147.52    6.73  2191.8466\n15  AAAAAAAAMLGEBAAA      5651.86  244.33       776.16   33.55       511.55   22.11  2313.1900\n16  AAAAAAAAMLGEBAAA      5651.86  235.66       776.16   32.36       766.80   31.97  2398.2733\n17  AAAAAAAAMLGEBAAA      5651.86  187.69       776.16   25.77      2605.80   86.53  3011.2733\n18  AAAAAAAAMLGEBAAA      5651.86  175.38       776.16   24.08      3239.52  100.52  3222.5133\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.041977,
                    "execution_time": 0.022962,
                    "compile_time": 0.000134,
                    "planning_time": 0.008587
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.082618,
                    "execution_time": 0.022541,
                    "compile_time": 0.001271,
                    "planning_time": 0.045051
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_18\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev    average\n0   AAAAAAAAMLGEBAAA      5651.86  157.22       776.16   21.59      4356.48  121.18  3594.8333\n1   AAAAAAAAMLGEBAAA      5651.86  215.60       776.16   29.60      1436.16   54.78  2621.3933\n2   AAAAAAAAMLGEBAAA      5651.86  209.13       776.16   28.72      1679.43   62.14  2702.4833\n3   AAAAAAAAMLGEBAAA      5651.86  184.07       776.16   25.27      2783.12   90.64  3070.3800\n4   AAAAAAAAMLGEBAAA      5651.86  168.13       776.16   23.09      3656.25  108.77  3361.4233\n5   AAAAAAAAMLGEBAAA      5651.86  263.52       776.16   36.18         6.08    0.28  2144.7000\n6   AAAAAAAAMLGEBAAA      5651.86  175.49       776.16   24.09      3233.76  100.40  3220.5933\n7   AAAAAAAAMLGEBAAA      5651.86  257.02       776.16   35.29       168.84    7.67  2198.9533\n8   AAAAAAAAMLGEBAAA      5651.86  220.23       776.16   30.24      1271.00   49.52  2566.3400\n9   AAAAAAAAMLGEBAAA      5651.86  185.90       776.16   25.53      2692.48   88.56  3040.1666\n10  AAAAAAAAMLGEBAAA      5651.86  231.54       776.16   31.79       894.80   36.65  2440.9400\n11  AAAAAAAAMLGEBAAA      5651.86  212.76       776.16   29.21      1541.32   58.02  2656.4466\n12  AAAAAAAAMLGEBAAA      5651.86  247.75       776.16   34.02       415.72   18.22  2281.2466\n13  AAAAAAAAMLGEBAAA      5651.86  217.08       776.16   29.81      1382.48   53.10  2603.5000\n14  AAAAAAAAMLGEBAAA      5651.86  257.85       776.16   35.41       147.52    6.73  2191.8466\n15  AAAAAAAAMLGEBAAA      5651.86  244.33       776.16   33.55       511.55   22.11  2313.1900\n16  AAAAAAAAMLGEBAAA      5651.86  235.66       776.16   32.36       766.80   31.97  2398.2733\n17  AAAAAAAAMLGEBAAA      5651.86  187.69       776.16   25.77      2605.80   86.53  3011.2733\n18  AAAAAAAAMLGEBAAA      5651.86  175.38       776.16   24.08      3239.52  100.52  3222.5133\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"SPEQLITE_TEMP_TABLE_16\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.149715,
                    "execution_time": 0.065976,
                    "compile_time": 0.000234,
                    "planning_time": 0.004182,
                    "create_size": 1408
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.382736,
                    "execution_time": 0.236903,
                    "compile_time": 0.000245,
                    "planning_time": 0.061873,
                    "create_size": 1408
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_19\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_19\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_19\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_19\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_19\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev    average\n0   AAAAAAAAOBEPAAAA      1760.37     NaN          NaN     NaN      5888.22     NaN        NaN\n1   AAAAAAAABNOPAAAA      1499.52     NaN        63.42     NaN          NaN     NaN        NaN\n2   AAAAAAAAIPOABAAA       452.10     NaN          NaN     NaN      1124.44     NaN        NaN\n3   AAAAAAAAIDHHBAAA      7262.76     NaN        65.92     NaN          NaN     NaN        NaN\n4   AAAAAAAAIDFGAAAA      1933.13     NaN          NaN     NaN          NaN     NaN        NaN\n5   AAAAAAAAOGLGAAAA      1386.66     NaN          NaN     NaN          NaN     NaN        NaN\n6   AAAAAAAAFCIHAAAA       562.72     NaN          NaN     NaN     16800.00     NaN        NaN\n7   AAAAAAAAIPEDBAAA       698.46   20.85      7120.68  212.58      2229.70   66.56  3349.6133\n8   AAAAAAAANJDIBAAA      3608.77     NaN          NaN     NaN          NaN     NaN        NaN\n9   AAAAAAAAEJBAAAAA      5957.08     NaN          NaN     NaN          NaN     NaN        NaN\n10  AAAAAAAANDAAAAAA      3124.00     NaN      6843.60     NaN          NaN     NaN        NaN\n11  AAAAAAAAMLJAAAAA      3129.06     NaN          NaN     NaN          NaN     NaN        NaN\n12  AAAAAAAAMIDCAAAA      5413.28     NaN          NaN     NaN          NaN     NaN        NaN\n13  AAAAAAAACHCIBAAA      9534.16     NaN          NaN     NaN          NaN     NaN        NaN\n14  AAAAAAAAKOKAAAAA      1887.52     NaN          NaN     NaN          NaN     NaN        NaN\n15  AAAAAAAAEPPMAAAA      6876.54     NaN      7861.50     NaN          NaN     NaN        NaN\n16  AAAAAAAAJBBIAAAA      4718.40     NaN          NaN     NaN          NaN     NaN        NaN\n17  AAAAAAAAIDCABAAA       483.84     NaN          NaN     NaN          NaN     NaN        NaN\n18  AAAAAAAAJDEMAAAA        65.55     NaN      5562.66     NaN          NaN     NaN        NaN\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01783,
                    "execution_time": 0.007351,
                    "compile_time": 5e-05,
                    "planning_time": 0.004174
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05443,
                    "execution_time": 0.008135,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039765
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_19\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_19\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_19\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_19\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_19\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_19\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev    average\n0   AAAAAAAAOBEPAAAA      1760.37     NaN          NaN     NaN      5888.22     NaN        NaN\n1   AAAAAAAABNOPAAAA      1499.52     NaN        63.42     NaN          NaN     NaN        NaN\n2   AAAAAAAAIPOABAAA       452.10     NaN          NaN     NaN      1124.44     NaN        NaN\n3   AAAAAAAAIDHHBAAA      7262.76     NaN        65.92     NaN          NaN     NaN        NaN\n4   AAAAAAAAIDFGAAAA      1933.13     NaN          NaN     NaN          NaN     NaN        NaN\n5   AAAAAAAAOGLGAAAA      1386.66     NaN          NaN     NaN          NaN     NaN        NaN\n6   AAAAAAAAFCIHAAAA       562.72     NaN          NaN     NaN     16800.00     NaN        NaN\n7   AAAAAAAAIPEDBAAA       698.46   20.85      7120.68  212.58      2229.70   66.56  3349.6133\n8   AAAAAAAANJDIBAAA      3608.77     NaN          NaN     NaN          NaN     NaN        NaN\n9   AAAAAAAAEJBAAAAA      5957.08     NaN          NaN     NaN          NaN     NaN        NaN\n10  AAAAAAAANDAAAAAA      3124.00     NaN      6843.60     NaN          NaN     NaN        NaN\n11  AAAAAAAAMLJAAAAA      3129.06     NaN          NaN     NaN          NaN     NaN        NaN\n12  AAAAAAAAMIDCAAAA      5413.28     NaN          NaN     NaN          NaN     NaN        NaN\n13  AAAAAAAACHCIBAAA      9534.16     NaN          NaN     NaN          NaN     NaN        NaN\n14  AAAAAAAAKOKAAAAA      1887.52     NaN          NaN     NaN          NaN     NaN        NaN\n15  AAAAAAAAEPPMAAAA      6876.54     NaN      7861.50     NaN          NaN     NaN        NaN\n16  AAAAAAAAJBBIAAAA      4718.40     NaN          NaN     NaN          NaN     NaN        NaN\n17  AAAAAAAAIDCABAAA       483.84     NaN          NaN     NaN          NaN     NaN        NaN\n18  AAAAAAAAJDEMAAAA        65.55     NaN      5562.66     NaN          NaN     NaN        NaN\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT \"SPEQLITE_TEMP_TABLE_16\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.869,
                    "execution_time": 3.530271,
                    "compile_time": 0.0004,
                    "planning_time": 0.006744,
                    "create_size": 2764
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.925375,
                    "execution_time": 3.510613,
                    "compile_time": 0.000443,
                    "planning_time": 0.064806,
                    "create_size": 2764
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_20\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_20\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_20\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_20\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_20\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_20\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev ss_dev  cs_item_rev cs_dev ws_item_rev ws_dev average\n0   AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n1   AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n2   AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n3   AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n4   AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n5   AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n6   AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n7   AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n8   AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n9   AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n10  AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n11  AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n12  AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n13  AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n14  AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n15  AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n16  AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n17  AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n18  AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018972,
                    "execution_time": 0.007861,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004315
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057321,
                    "execution_time": 0.007906,
                    "compile_time": 5e-05,
                    "planning_time": 0.039832
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_20\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_20\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_20\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_20\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_20\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_20\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev ss_dev  cs_item_rev cs_dev ws_item_rev ws_dev average\n0   AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n1   AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n2   AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n3   AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n4   AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n5   AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n6   AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n7   AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n8   AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n9   AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n10  AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n11  AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n12  AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n13  AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n14  AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n15  AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n16  AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n17  AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n18  AAAAAAAAFCGPAAAA       788.84   None      3844.62   None        None   None    None\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"SPEQLITE_TEMP_TABLE_16\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev ss_dev  cs_item_rev cs_dev ws_item_rev ws_dev average\n0   AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n1   AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n2   AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n3   AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n4   AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n5   AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n6   AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n7   AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n8   AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n9   AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n10  AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n11  AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n12  AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n13  AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n14  AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n15  AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n16  AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n17  AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n18  AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.042533,
                    "execution_time": 0.02448,
                    "compile_time": 0.000139,
                    "planning_time": 0.008845
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.080625,
                    "execution_time": 0.023946,
                    "compile_time": 0.000139,
                    "planning_time": 0.044461
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev ss_dev  cs_item_rev cs_dev ws_item_rev ws_dev average\n0   AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n1   AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n2   AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n3   AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n4   AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n5   AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n6   AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n7   AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n8   AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n9   AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n10  AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n11  AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n12  AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n13  AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n14  AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n15  AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n16  AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n17  AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n18  AAAAAAAAJHOBAAAA      9575.77   None      5174.52   None        None   None    None\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"SPEQLITE_TEMP_TABLE_16\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev ss_dev  cs_item_rev cs_dev ws_item_rev ws_dev average\n0   AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n1   AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n2   AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n3   AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n4   AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n5   AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n6   AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n7   AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n8   AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n9   AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n10  AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n11  AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n12  AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n13  AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n14  AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n15  AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n16  AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n17  AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n18  AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.043363,
                    "execution_time": 0.024187,
                    "compile_time": 0.000136,
                    "planning_time": 0.009673
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.082796,
                    "execution_time": 0.024819,
                    "compile_time": 0.000135,
                    "planning_time": 0.045754
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_16\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_16\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_16\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev ss_dev  cs_item_rev cs_dev ws_item_rev ws_dev average\n0   AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n1   AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n2   AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n3   AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n4   AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n5   AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n6   AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n7   AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n8   AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n9   AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n10  AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n11  AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n12  AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n13  AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n14  AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n15  AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n16  AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n17  AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n18  AAAAAAAAIPEABAAA      6773.85   None      8857.24   None        None   None    None\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.096848,
                    "execution_time": 0.05333,
                    "compile_time": 0.000329,
                    "planning_time": 0.013243,
                    "create_size": 55
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.16088,
                    "execution_time": 0.052758,
                    "compile_time": 0.000352,
                    "planning_time": 0.072419,
                    "create_size": 55
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" LIMIT 21",
                "preview": "\n/*            item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0  AAAAAAAANCCHBAAA      1238.05  104.03      1200.40  100.87      1131.48   95.08   1189.9766\n1  AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n2  AAAAAAAAMGHCBAAA       538.93   95.41       575.68  101.91       579.96  102.67    564.8566\n3  AAAAAAAAPEGCBAAA     11704.13   98.95     12033.82  101.74     11745.74   99.30  11827.8966\n4  AAAAAAAAEPICAAAA       792.12   99.63       832.59  104.72       760.32   95.63    795.0100*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01866,
                    "execution_time": 0.007424,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004667
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055868,
                    "execution_time": 0.007661,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.039898
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\""
            }
        ],
        "preview": "\n/*            item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0  AAAAAAAANCCHBAAA      1238.05  104.03      1200.40  100.87      1131.48   95.08   1189.9766\n1  AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n2  AAAAAAAAMGHCBAAA       538.93   95.41       575.68  101.91       579.96  102.67    564.8566\n3  AAAAAAAAPEGCBAAA     11704.13   98.95     12033.82  101.74     11745.74   99.30  11827.8966\n4  AAAAAAAAEPICAAAA       792.12   99.63       832.59  104.72       760.32   95.63    795.0100*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_22\" AS SELECT \"SPEQLITE_TEMP_TABLE_21\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_21\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_21\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_21\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_21\".\"SS_ITEM_REV\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.089714,
                    "execution_time": 0.047783,
                    "compile_time": 0.000324,
                    "planning_time": 0.006821,
                    "create_size": 77
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.152253,
                    "execution_time": 0.047719,
                    "compile_time": 0.000317,
                    "planning_time": 0.064757,
                    "create_size": 77
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_22\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_22\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_22\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_22\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_22\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_22\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" LIMIT 21",
                "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAEPICAAAA       792.12   99.63       832.59  104.72       760.32   95.63    795.0100\n1   AAAAAAAANCCHBAAA      1238.05  104.03      1200.40  100.87      1131.48   95.08   1189.9766\n2   AAAAAAAAEPICAAAA       792.12   99.63       832.59  104.72       760.32   95.63    795.0100\n3   AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n4   AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n5   AAAAAAAANCCHBAAA      1238.05  104.03      1200.40  100.87      1131.48   95.08   1189.9766\n6   AAAAAAAAMGHCBAAA       538.93   95.41       575.68  101.91       579.96  102.67    564.8566\n7   AAAAAAAAEPICAAAA       792.12   99.63       832.59  104.72       760.32   95.63    795.0100\n8   AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n9   AAAAAAAAPEGCBAAA     11704.13   98.95     12033.82  101.74     11745.74   99.30  11827.8966\n10  AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n11  AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n12  AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n13  AAAAAAAAPEGCBAAA     11704.13   98.95     12033.82  101.74     11745.74   99.30  11827.8966\n14  AAAAAAAAEPICAAAA       792.12   99.63       832.59  104.72       760.32   95.63    795.0100\n15  AAAAAAAANCCHBAAA      1238.05  104.03      1200.40  100.87      1131.48   95.08   1189.9766\n16  AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n17  AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n18  AAAAAAAAMGHCBAAA       538.93   95.41       575.68  101.91       579.96  102.67    564.8566\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018345,
                    "execution_time": 0.007414,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004357
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057124,
                    "execution_time": 0.007395,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.040044
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_22\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_22\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_22\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_22\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_22\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_22\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_22\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\""
            }
        ],
        "preview": "\n/*             item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0   AAAAAAAAEPICAAAA       792.12   99.63       832.59  104.72       760.32   95.63    795.0100\n1   AAAAAAAANCCHBAAA      1238.05  104.03      1200.40  100.87      1131.48   95.08   1189.9766\n2   AAAAAAAAEPICAAAA       792.12   99.63       832.59  104.72       760.32   95.63    795.0100\n3   AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n4   AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n5   AAAAAAAANCCHBAAA      1238.05  104.03      1200.40  100.87      1131.48   95.08   1189.9766\n6   AAAAAAAAMGHCBAAA       538.93   95.41       575.68  101.91       579.96  102.67    564.8566\n7   AAAAAAAAEPICAAAA       792.12   99.63       832.59  104.72       760.32   95.63    795.0100\n8   AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n9   AAAAAAAAPEGCBAAA     11704.13   98.95     12033.82  101.74     11745.74   99.30  11827.8966\n10  AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n11  AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n12  AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n13  AAAAAAAAPEGCBAAA     11704.13   98.95     12033.82  101.74     11745.74   99.30  11827.8966\n14  AAAAAAAAEPICAAAA       792.12   99.63       832.59  104.72       760.32   95.63    795.0100\n15  AAAAAAAANCCHBAAA      1238.05  104.03      1200.40  100.87      1131.48   95.08   1189.9766\n16  AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n17  AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n18  AAAAAAAAMGHCBAAA       538.93   95.41       575.68  101.91       579.96  102.67    564.8566\n...*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_23\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.182801,
                    "execution_time": 0.057122,
                    "compile_time": 0.077974,
                    "planning_time": 0.015121,
                    "create_size": 55
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.39775,
                    "execution_time": 0.056595,
                    "compile_time": 7.227522,
                    "planning_time": 0.073917,
                    "create_size": 55
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" LIMIT 21",
                "preview": "\n/*            item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0  AAAAAAAANCCHBAAA      1238.05  104.03      1200.40  100.87      1131.48   95.08   1189.9766\n1  AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n2  AAAAAAAAPEGCBAAA     11704.13   98.95     12033.82  101.74     11745.74   99.30  11827.8966\n3  AAAAAAAAMGHCBAAA       538.93   95.41       575.68  101.91       579.96  102.67    564.8566\n4  AAAAAAAAEPICAAAA       792.12   99.63       832.59  104.72       760.32   95.63    795.0100*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018089,
                    "execution_time": 0.007042,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.004318
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054997,
                    "execution_time": 0.008092,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.04012
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\""
            }
        ],
        "preview": "\n/*            item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0  AAAAAAAANCCHBAAA      1238.05  104.03      1200.40  100.87      1131.48   95.08   1189.9766\n1  AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n2  AAAAAAAAPEGCBAAA     11704.13   98.95     12033.82  101.74     11745.74   99.30  11827.8966\n3  AAAAAAAAMGHCBAAA       538.93   95.41       575.68  101.91       579.96  102.67    564.8566\n4  AAAAAAAAEPICAAAA       792.12   99.63       832.59  104.72       760.32   95.63    795.0100*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n order by item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" ORDER BY \"ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"ITEM_ID\" LIMIT 21",
                "preview": "\n/*            item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0  AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n1  AAAAAAAAEPICAAAA       792.12   99.63       832.59  104.72       760.32   95.63    795.0100\n2  AAAAAAAAMGHCBAAA       538.93   95.41       575.68  101.91       579.96  102.67    564.8566\n3  AAAAAAAANCCHBAAA      1238.05  104.03      1200.40  100.87      1131.48   95.08   1189.9766\n4  AAAAAAAAPEGCBAAA     11704.13   98.95     12033.82  101.74     11745.74   99.30  11827.8966*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019115,
                    "execution_time": 0.008013,
                    "compile_time": 8.3e-05,
                    "planning_time": 0.004421
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057534,
                    "execution_time": 0.008863,
                    "compile_time": 8.9e-05,
                    "planning_time": 0.039874
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" ORDER BY \"ITEM_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"ITEM_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*            item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0  AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n1  AAAAAAAAEPICAAAA       792.12   99.63       832.59  104.72       760.32   95.63    795.0100\n2  AAAAAAAAMGHCBAAA       538.93   95.41       575.68  101.91       579.96  102.67    564.8566\n3  AAAAAAAANCCHBAAA      1238.05  104.03      1200.40  100.87      1131.48   95.08   1189.9766\n4  AAAAAAAAPEGCBAAA     11704.13   98.95     12033.82  101.74     11745.74   99.30  11827.8966*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n order by item_id\n         ,ss_item_rev\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" ORDER BY \"ITEM_ID\" NULLS LAST , \"SS_ITEM_REV\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"ITEM_ID\" , \"SS_ITEM_REV\" LIMIT 21",
                "preview": "\n/*            item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0  AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n1  AAAAAAAAEPICAAAA       792.12   99.63       832.59  104.72       760.32   95.63    795.0100\n2  AAAAAAAAMGHCBAAA       538.93   95.41       575.68  101.91       579.96  102.67    564.8566\n3  AAAAAAAANCCHBAAA      1238.05  104.03      1200.40  100.87      1131.48   95.08   1189.9766\n4  AAAAAAAAPEGCBAAA     11704.13   98.95     12033.82  101.74     11745.74   99.30  11827.8966*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018904,
                    "execution_time": 0.007955,
                    "compile_time": 8.1e-05,
                    "planning_time": 0.004391
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055067,
                    "execution_time": 0.008341,
                    "compile_time": 7.7e-05,
                    "planning_time": 0.039951
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" ORDER BY \"ITEM_ID\" NULLS LAST , \"SS_ITEM_REV\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"ITEM_ID\" NULLS LAST , \"SS_ITEM_REV\" NULLS LAST"
            }
        ],
        "preview": "\n/*            item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0  AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n1  AAAAAAAAEPICAAAA       792.12   99.63       832.59  104.72       760.32   95.63    795.0100\n2  AAAAAAAAMGHCBAAA       538.93   95.41       575.68  101.91       579.96  102.67    564.8566\n3  AAAAAAAANCCHBAAA      1238.05  104.03      1200.40  100.87      1131.48   95.08   1189.9766\n4  AAAAAAAAPEGCBAAA     11704.13   98.95     12033.82  101.74     11745.74   99.30  11827.8966*/"
    },
    {
        "input": "-- start template query58.tpl query 19 in stream 0\nwith /* TPC-DS query58.tpl 0.19 */ ss_items as\n (select i_item_id item_id\n        ,sum(ss_ext_sales_price) ss_item_rev \n from store_sales\n     ,item\n     ,date_dim\n where ss_item_sk = i_item_sk\n   and d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n   and ss_sold_date_sk   = d_date_sk\n group by i_item_id),\n cs_items as\n (select i_item_id item_id\n        ,sum(cs_ext_sales_price) cs_item_rev\n  from catalog_sales\n      ,item\n      ,date_dim\n where cs_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq = (select d_week_seq \n                                      from date_dim\n                                      where d_date = '1998-04-13'))\n  and  cs_sold_date_sk = d_date_sk\n group by i_item_id),\n ws_items as\n (select i_item_id item_id\n        ,sum(ws_ext_sales_price) ws_item_rev\n  from web_sales\n      ,item\n      ,date_dim\n where ws_item_sk = i_item_sk\n  and  d_date in (select d_date\n                  from date_dim\n                  where d_week_seq =(select d_week_seq \n                                     from date_dim\n                                     where d_date = '1998-04-13'))\n  and ws_sold_date_sk   = d_date_sk\n group by i_item_id)\n  select  ss_items.item_id\n       ,ss_item_rev\n       ,ss_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ss_dev\n       ,cs_item_rev\n       ,cs_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 cs_dev\n       ,ws_item_rev\n       ,ws_item_rev/((ss_item_rev+cs_item_rev+ws_item_rev)/3) * 100 ws_dev\n       ,(ss_item_rev+cs_item_rev+ws_item_rev)/3 average\n from ss_items,cs_items,ws_items\n where ss_items.item_id=cs_items.item_id\n   and ss_items.item_id=ws_items.item_id \n   and ss_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n   and ss_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and cs_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and cs_item_rev between 0.9 * ws_item_rev and 1.1 * ws_item_rev\n   and ws_item_rev between 0.9 * ss_item_rev and 1.1 * ss_item_rev\n   and ws_item_rev between 0.9 * cs_item_rev and 1.1 * cs_item_rev\n order by item_id\n         ,ss_item_rev\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" = CAST ( '1998-04-13' AS DATE ) ) , \"_U_1\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"SS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"SS_ITEM_REV\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_1\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"CS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"CS_ITEM_REV\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_3\" AS \"_U_3\" ON \"_U_3\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_3\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) , \"_U_5\" AS ( SELECT \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"_U_0\" AS \"_U_4\" ON \"_U_4\".\"D_WEEK_SEQ\" = \"DATE_DIM\".\"D_WEEK_SEQ\" GROUP BY \"DATE_DIM\".\"D_DATE\" ) , \"WS_ITEMS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"ITEM_ID\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"WS_ITEM_REV\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"_U_5\" AS \"_U_5\" ON \"_U_5\".\"D_DATE\" = \"DATE_DIM\".\"D_DATE\" WHERE NOT \"_U_5\".\"D_DATE\" IS NULL GROUP BY \"ITEM\".\"I_ITEM_ID\" ) SELECT \"SS_ITEMS\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SS_ITEMS\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SS_ITEMS\".\"SS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"CS_ITEMS\".\"CS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"WS_ITEMS\".\"WS_ITEM_REV\" / ( ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SS_ITEMS\".\"SS_ITEM_REV\" + \"CS_ITEMS\".\"CS_ITEM_REV\" + \"WS_ITEMS\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SS_ITEMS\" AS \"SS_ITEMS\" JOIN \"CS_ITEMS\" AS \"CS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"CS_ITEMS\".\"ITEM_ID\" = \"SS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" JOIN \"WS_ITEMS\" AS \"WS_ITEMS\" ON \"CS_ITEMS\".\"CS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"CS_ITEMS\".\"CS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"ITEM_ID\" = \"WS_ITEMS\".\"ITEM_ID\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" <= 1.1 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"SS_ITEMS\".\"SS_ITEM_REV\" >= 0.9 * \"WS_ITEMS\".\"WS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" <= 1.1 * \"SS_ITEMS\".\"SS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"CS_ITEMS\".\"CS_ITEM_REV\" AND \"WS_ITEMS\".\"WS_ITEM_REV\" >= 0.9 * \"SS_ITEMS\".\"SS_ITEM_REV\" ORDER BY \"ITEM_ID\" NULLS LAST , \"SS_ITEM_REV\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"ITEM_ID\" , \"SS_ITEM_REV\" LIMIT 21",
                "preview": "\n/*            item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0  AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n1  AAAAAAAAEPICAAAA       792.12   99.63       832.59  104.72       760.32   95.63    795.0100\n2  AAAAAAAAMGHCBAAA       538.93   95.41       575.68  101.91       579.96  102.67    564.8566\n3  AAAAAAAANCCHBAAA      1238.05  104.03      1200.40  100.87      1131.48   95.08   1189.9766\n4  AAAAAAAAPEGCBAAA     11704.13   98.95     12033.82  101.74     11745.74   99.30  11827.8966*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020619,
                    "execution_time": 0.008842,
                    "compile_time": 8.8e-05,
                    "planning_time": 0.004586
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020505,
                    "execution_time": 0.008932,
                    "compile_time": 9.3e-05,
                    "planning_time": 0.004633
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" / ( ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 ) * 100 AS \"WS_DEV\" , ( \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" + \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" ) / 3 AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"ITEM_ID\" = \"SPEQLITE_TEMP_TABLE_10\".\"ITEM_ID\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" <= 1.1 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_8\".\"CS_ITEM_REV\" AND \"SPEQLITE_TEMP_TABLE_10\".\"WS_ITEM_REV\" >= 0.9 * \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_REV\" ORDER BY \"ITEM_ID\" NULLS LAST , \"SS_ITEM_REV\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"ITEM_ID\" AS \"ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_ITEM_REV\" AS \"SS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_DEV\" AS \"SS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_ITEM_REV\" AS \"CS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"CS_DEV\" AS \"CS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_ITEM_REV\" AS \"WS_ITEM_REV\" , \"SPEQLITE_TEMP_TABLE_23\".\"WS_DEV\" AS \"WS_DEV\" , \"SPEQLITE_TEMP_TABLE_23\".\"AVERAGE\" AS \"AVERAGE\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" ORDER BY \"ITEM_ID\" NULLS LAST , \"SS_ITEM_REV\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*            item_id  ss_item_rev  ss_dev  cs_item_rev  cs_dev  ws_item_rev  ws_dev     average\n0  AAAAAAAAEEPFAAAA      3698.38  104.69      3368.12   95.34      3531.40   99.96   3532.6333\n1  AAAAAAAAEPICAAAA       792.12   99.63       832.59  104.72       760.32   95.63    795.0100\n2  AAAAAAAAMGHCBAAA       538.93   95.41       575.68  101.91       579.96  102.67    564.8566\n3  AAAAAAAANCCHBAAA      1238.05  104.03      1200.40  100.87      1131.48   95.08   1189.9766\n4  AAAAAAAAPEGCBAAA     11704.13   98.95     12033.82  101.74     11745.74   99.30  11827.8966*/"
    }
]