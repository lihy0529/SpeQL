[
    {
        "input": "-- start template query30.tpl query 75 in stream 0\nwith /* TPC-DS query30.tpl 0.75 */ customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(wr_return_amt) as ctr_total_return\n from web_returns\n     join date_dim on wr_returned_date_sk = d_date_sk \n     join customer_address on wr_returning_addr_sk = ca_address_sk\n/*CURSOR_IDENTIFIER*/\n group by wr_returning_customer_sk, ca_state\n) \nSELECT * FROM customer_total_return;",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"CTR_TOTAL_RETURN\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_ADDR_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" GROUP BY \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"CTR_TOTAL_RETURN\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_ADDR_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" GROUP BY \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.690026,
                    "execution_time": 0.284183,
                    "compile_time": 0.034551,
                    "planning_time": 0.068807,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.177054,
                    "execution_time": 1.457186,
                    "compile_time": 3.299284,
                    "planning_time": 0.11325,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0             46793        MO           1169.94\n1            140489        MI            887.40\n2            340976        WY            422.68\n3            443466                     6090.70\n4            326460        IN           1770.66\n5             88030        WI           1565.10\n6            370068        SD              9.84\n7            459531        NE             69.99\n8             46452        TN           2027.71\n9            404989        LA           2316.63\n10             4569        OR           4869.80\n11           149629        IL            423.94\n12           308856        MA            713.79\n13           165647        OK            128.64\n14           136069        NC            884.40\n15           369765        TN           1877.22\n16           303305        KY            347.45\n17           264426        GA            574.24\n18           253742        VA           5905.55\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017217,
                    "execution_time": 0.008045,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003292
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055069,
                    "execution_time": 0.007464,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.038739
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0             46793        MO           1169.94\n1            140489        MI            887.40\n2            340976        WY            422.68\n3            443466                     6090.70\n4            326460        IN           1770.66\n5             88030        WI           1565.10\n6            370068        SD              9.84\n7            459531        NE             69.99\n8             46452        TN           2027.71\n9            404989        LA           2316.63\n10             4569        OR           4869.80\n11           149629        IL            423.94\n12           308856        MA            713.79\n13           165647        OK            128.64\n14           136069        NC            884.40\n15           369765        TN           1877.22\n16           303305        KY            347.45\n17           264426        GA            574.24\n18           253742        VA           5905.55\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query30.tpl query 75 in stream 0\nwith /* TPC-DS query30.tpl 0.75 */ customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(wr_return_amt) as ctr_total_return\n from web_returns\n     ,date_dim\n     ,customer_address\n where wr_returned_date_sk = d_date_sk \n   and d_year = 2000\n   and wr_returning_addr_sk = ca_address_sk \n group by wr_returning_customer_sk\n         ,ca_state)\n  select ctr1.ctr_customer_sk, ctr1.ctr_state, ctr1.ctr_total_return\n from customer_total_return ctr1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"CTR_TOTAL_RETURN\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_ADDR_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 GROUP BY \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CTR1\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"CTR_TOTAL_RETURN\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_ADDR_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 GROUP BY \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.46088,
                    "execution_time": 0.075896,
                    "compile_time": 0.14585,
                    "planning_time": 0.04071,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.04681,
                    "execution_time": 0.093707,
                    "compile_time": 6.636427,
                    "planning_time": 0.111412,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CTR1\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0            8994.0        ID           1353.40\n1          111666.0        NC            415.10\n2          477085.0        OK            349.69\n3          299634.0        DE             31.18\n4           55711.0        MT            128.24\n5          311387.0        OK            778.92\n6           87569.0        VA           4951.44\n7          474761.0        LA           1393.92\n8          163892.0        IN             72.50\n9          482912.0        GA            129.64\n10         480125.0        MT            354.15\n11         456167.0        UT             64.86\n12         363141.0        GA            721.82\n13         169726.0        TX            366.88\n14         233210.0        AL             19.62\n15         280661.0        VA            168.30\n16              NaN        KY          47153.19\n17         261763.0        IA              2.36\n18         423810.0        WI            176.20\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017584,
                    "execution_time": 0.007238,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003223
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054117,
                    "execution_time": 0.007881,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.038516
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CTR1\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\"",
                "rewrite": "SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CTR1\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0            8994.0        ID           1353.40\n1          111666.0        NC            415.10\n2          477085.0        OK            349.69\n3          299634.0        DE             31.18\n4           55711.0        MT            128.24\n5          311387.0        OK            778.92\n6           87569.0        VA           4951.44\n7          474761.0        LA           1393.92\n8          163892.0        IN             72.50\n9          482912.0        GA            129.64\n10         480125.0        MT            354.15\n11         456167.0        UT             64.86\n12         363141.0        GA            721.82\n13         169726.0        TX            366.88\n14         233210.0        AL             19.62\n15         280661.0        VA            168.30\n16              NaN        KY          47153.19\n17         261763.0        IA              2.36\n18         423810.0        WI            176.20\n...*/"
    },
    {
        "input": "-- start template query30.tpl query 75 in stream 0\nwith /* TPC-DS query30.tpl 0.75 */ customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(wr_return_amt) as ctr_total_return\n from web_returns\n     ,date_dim\n     ,customer_address\n where wr_returned_date_sk = d_date_sk \n   and d_year = 2000\n   and wr_returning_addr_sk = ca_address_sk \n group by wr_returning_customer_sk\n         ,ca_state)\n  select  ctr1.ctr_customer_sk, ctr1.ctr_state, ctr1.ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"CTR_TOTAL_RETURN\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_ADDR_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 GROUP BY \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CTR1\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CTR1\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CTR1\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0            230103        IN              44.0\n1            230103        IN              44.0\n2            230103        IN              44.0\n3            230103        IN              44.0\n4            230103        IN              44.0\n5            230103        IN              44.0\n6            230103        IN              44.0\n7            230103        IN              44.0\n8            230103        IN              44.0\n9            230103        IN              44.0\n10           230103        IN              44.0\n11           230103        IN              44.0\n12           230103        IN              44.0\n13           230103        IN              44.0\n14           230103        IN              44.0\n15           230103        IN              44.0\n16           230103        IN              44.0\n17           230103        IN              44.0\n18           230103        IN              44.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.045776,
                    "execution_time": 0.011408,
                    "compile_time": 9.6e-05,
                    "planning_time": 0.026821
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.18247,
                    "execution_time": 0.011873,
                    "compile_time": 3.081565,
                    "planning_time": 0.080582
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CTR1\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\"",
                "rewrite": "SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CTR1\".\"CTR_STATE\" AS \"CTR_STATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk ctr_state  ctr_total_return\n0            230103        IN              44.0\n1            230103        IN              44.0\n2            230103        IN              44.0\n3            230103        IN              44.0\n4            230103        IN              44.0\n5            230103        IN              44.0\n6            230103        IN              44.0\n7            230103        IN              44.0\n8            230103        IN              44.0\n9            230103        IN              44.0\n10           230103        IN              44.0\n11           230103        IN              44.0\n12           230103        IN              44.0\n13           230103        IN              44.0\n14           230103        IN              44.0\n15           230103        IN              44.0\n16           230103        IN              44.0\n17           230103        IN              44.0\n18           230103        IN              44.0\n...*/"
    },
    {
        "input": "-- start template query30.tpl query 75 in stream 0\nwith /* TPC-DS query30.tpl 0.75 */ customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(wr_return_amt) as ctr_total_return\n from web_returns\n     ,date_dim\n     ,customer_address\n where wr_returned_date_sk = d_date_sk \n   and d_year =2000\n   and wr_returning_addr_sk = ca_address_sk \n group by wr_returning_customer_sk\n         ,ca_state)\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n       ,NULL as c_last_review_date,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"CTR_TOTAL_RETURN\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_ADDR_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 GROUP BY \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.163415,
                    "execution_time": 0.049316,
                    "compile_time": 0.000238,
                    "planning_time": 0.002837,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.251424,
                    "execution_time": 0.075086,
                    "compile_time": 0.000241,
                    "planning_time": 0.061589,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name c_preferred_cust_flag  c_birth_day  c_birth_month  c_birth_year    c_birth_country c_login                            c_email_address c_last_review_date  ctr_total_return\n0   AAAAAAAAFAAAAAAA          Sir       Robert       Moran                     N            8              5          1956               FIJI                                Robert.Moran@Hh.edu               None             28.65\n1   AAAAAAAAOCAAAAAA         Mrs.         Jane  Stephenson                     Y           13              4          1990             TURKEY                   Jane.Stephenson@lq8ZQLAUMZhR.edu               None             28.65\n2   AAAAAAAAMDAAAAAA          Ms.       Dollie        Thao                     N           15              7          1990        SWITZERLAND                 Dollie.Thao@Xead5vagsekdHDLUkv.edu               None             28.65\n3   AAAAAAAAGFAAAAAA          Dr.       Marvin     Matlock                     Y           21             10          1983  BRUNEI DARUSSALAM                          Marvin.Matlock@0FXEZp.org               None             28.65\n4   AAAAAAAALIAAAAAA          Dr.    Catherine      Newman                     N           29              3          1938            BERMUDA              Catherine.Newman@XYU8uAboQoTY35lq.org               None             28.65\n5   AAAAAAAAHKAAAAAA          Dr.        Ricky         Lee                     Y            8              1          1948            BAHRAIN                          Ricky.Lee@6tjVJREkz3m.org               None             28.65\n6   AAAAAAAADNAAAAAA         Miss      Barbara   Hernandez                     Y           11              4          1961          NICARAGUA                            Barbara.Hernandez@S.org               None             28.65\n7   AAAAAAAAFNAAAAAA         Miss    Christene  Mccullough                     Y            8             10          1945         LUXEMBOURG          Christene.Mccullough@kalRTzJl8KjD5G7H.org               None             28.65\n8   AAAAAAAAKABAAAAA          Sir       Walter    Martinez                     Y            5              7          1968             GUYANA              Walter.Martinez@vQnVJXQ4seh9pLBDJ.com               None             28.65\n9   AAAAAAAANABAAAAA          Mr.      William       Burns                     N           23              5          1943            MAYOTTE                           William.Burns@ojrPxK.com               None             28.65\n10  AAAAAAAACDBAAAAA          Dr.        Peter       Smith                     Y            4             12          1956          SINGAPORE                                 Peter.Smith@pM.org               None             28.65\n11  AAAAAAAAEDBAAAAA          Dr.       Ashley    Thompson                     N           12              1          1973              KENYA                     Ashley.Thompson@uH34bg8ike.com               None             28.65\n12  AAAAAAAAEHBAAAAA          Ms.       Maxine     Houston                     N            3              1          1969            BELGIUM                        Maxine.Houston@A77i7oKx.com               None             28.65\n13  AAAAAAAAMIBAAAAA         Mrs.     Jennifer    Espinoza                     Y           26              2          1943            LESOTHO                            Jennifer.Espinoza@i.edu               None             28.65\n14  AAAAAAAAOMBAAAAA          Mr.     Lawrence     Guevara                     N           14              3          1934           CAMEROON                    Lawrence.Guevara@p1xmOP76PO.com               None             28.65\n15  AAAAAAAALNBAAAAA          Mr.     Fletcher      Palmer                     Y           17             10          1984            GERMANY                      Fletcher.Palmer@XJMuVd85x.com               None             28.65\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.157681,
                    "execution_time": 0.085258,
                    "compile_time": 0.034016,
                    "planning_time": 0.031195
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.275304,
                    "execution_time": 0.087842,
                    "compile_time": 3.082983,
                    "planning_time": 0.093094
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\""
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name c_preferred_cust_flag  c_birth_day  c_birth_month  c_birth_year    c_birth_country c_login                            c_email_address c_last_review_date  ctr_total_return\n0   AAAAAAAAFAAAAAAA          Sir       Robert       Moran                     N            8              5          1956               FIJI                                Robert.Moran@Hh.edu               None             28.65\n1   AAAAAAAAOCAAAAAA         Mrs.         Jane  Stephenson                     Y           13              4          1990             TURKEY                   Jane.Stephenson@lq8ZQLAUMZhR.edu               None             28.65\n2   AAAAAAAAMDAAAAAA          Ms.       Dollie        Thao                     N           15              7          1990        SWITZERLAND                 Dollie.Thao@Xead5vagsekdHDLUkv.edu               None             28.65\n3   AAAAAAAAGFAAAAAA          Dr.       Marvin     Matlock                     Y           21             10          1983  BRUNEI DARUSSALAM                          Marvin.Matlock@0FXEZp.org               None             28.65\n4   AAAAAAAALIAAAAAA          Dr.    Catherine      Newman                     N           29              3          1938            BERMUDA              Catherine.Newman@XYU8uAboQoTY35lq.org               None             28.65\n5   AAAAAAAAHKAAAAAA          Dr.        Ricky         Lee                     Y            8              1          1948            BAHRAIN                          Ricky.Lee@6tjVJREkz3m.org               None             28.65\n6   AAAAAAAADNAAAAAA         Miss      Barbara   Hernandez                     Y           11              4          1961          NICARAGUA                            Barbara.Hernandez@S.org               None             28.65\n7   AAAAAAAAFNAAAAAA         Miss    Christene  Mccullough                     Y            8             10          1945         LUXEMBOURG          Christene.Mccullough@kalRTzJl8KjD5G7H.org               None             28.65\n8   AAAAAAAAKABAAAAA          Sir       Walter    Martinez                     Y            5              7          1968             GUYANA              Walter.Martinez@vQnVJXQ4seh9pLBDJ.com               None             28.65\n9   AAAAAAAANABAAAAA          Mr.      William       Burns                     N           23              5          1943            MAYOTTE                           William.Burns@ojrPxK.com               None             28.65\n10  AAAAAAAACDBAAAAA          Dr.        Peter       Smith                     Y            4             12          1956          SINGAPORE                                 Peter.Smith@pM.org               None             28.65\n11  AAAAAAAAEDBAAAAA          Dr.       Ashley    Thompson                     N           12              1          1973              KENYA                     Ashley.Thompson@uH34bg8ike.com               None             28.65\n12  AAAAAAAAEHBAAAAA          Ms.       Maxine     Houston                     N            3              1          1969            BELGIUM                        Maxine.Houston@A77i7oKx.com               None             28.65\n13  AAAAAAAAMIBAAAAA         Mrs.     Jennifer    Espinoza                     Y           26              2          1943            LESOTHO                            Jennifer.Espinoza@i.edu               None             28.65\n14  AAAAAAAAOMBAAAAA          Mr.     Lawrence     Guevara                     N           14              3          1934           CAMEROON                    Lawrence.Guevara@p1xmOP76PO.com               None             28.65\n15  AAAAAAAALNBAAAAA          Mr.     Fletcher      Palmer                     Y           17             10          1984            GERMANY                      Fletcher.Palmer@XJMuVd85x.com               None             28.65\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query30.tpl query 75 in stream 0\nwith /* TPC-DS query30.tpl 0.75 */ customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(wr_return_amt) as ctr_total_return\n from web_returns\n     ,date_dim\n     ,customer_address\n where wr_returned_date_sk = d_date_sk \n   and d_year =2000\n   and wr_returning_addr_sk = ca_address_sk \n group by wr_returning_customer_sk\n         ,ca_state)\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n       ,NULL as c_last_review_date,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"CTR_TOTAL_RETURN\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_ADDR_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 GROUP BY \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_STATE\" AS \"CTR_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.233738,
                    "execution_time": 0.055012,
                    "compile_time": 0.016837,
                    "planning_time": 0.003068,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.351612,
                    "execution_time": 0.067015,
                    "compile_time": 3.057475,
                    "planning_time": 0.062592,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.069463,
                    "execution_time": 0.040939,
                    "compile_time": 0.000254,
                    "planning_time": 0.004054,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.131723,
                    "execution_time": 0.042624,
                    "compile_time": 0.000269,
                    "planning_time": 0.061767,
                    "create_size": 185
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query30.tpl query 75 in stream 0\nwith /* TPC-DS query30.tpl 0.75 */ customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(wr_return_amt) as ctr_total_return\n from web_returns\n     ,date_dim\n     ,customer_address\n where wr_returned_date_sk = d_date_sk \n   and d_year =2000\n   and wr_returning_addr_sk = ca_address_sk \n group by wr_returning_customer_sk\n         ,ca_state)\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n       ,NULL as c_last_review_date,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"CTR_TOTAL_RETURN\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_ADDR_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 GROUP BY \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name c_preferred_cust_flag  c_birth_day  c_birth_month  c_birth_year c_birth_country c_login               c_email_address c_last_review_date  ctr_total_return\n0   AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           3725.38\n1   AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           2143.02\n2   AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           4536.54\n3   AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           4652.48\n4   AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           2364.75\n5   AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           4020.85\n6   AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           2538.80\n7   AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           3085.32\n8   AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           2738.72\n9   AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           2112.48\n10  AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           9009.78\n11  AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           2581.25\n12  AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           6579.75\n13  AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           1677.52\n14  AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           2450.40\n15  AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           8777.25\n16  AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           3999.77\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.119273,
                    "execution_time": 0.069936,
                    "compile_time": 0.000214,
                    "planning_time": 0.036175
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.2723,
                    "execution_time": 0.078086,
                    "compile_time": 3.07418,
                    "planning_time": 0.102706
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CTR1\" CROSS JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name c_preferred_cust_flag  c_birth_day  c_birth_month  c_birth_year c_birth_country c_login               c_email_address c_last_review_date  ctr_total_return\n0   AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           3725.38\n1   AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           2143.02\n2   AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           4536.54\n3   AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           4652.48\n4   AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           2364.75\n5   AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           4020.85\n6   AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           2538.80\n7   AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           3085.32\n8   AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           2738.72\n9   AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           2112.48\n10  AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           9009.78\n11  AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           2581.25\n12  AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           6579.75\n13  AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           1677.52\n14  AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           2450.40\n15  AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           8777.25\n16  AAAAAAAALBAAAAAA          Dr.        Shawn     Prather                     N            7              3          1972     PUERTO RICO          Shawn.Prather@8BusRYegn6.org               None           3999.77\n...*/"
    },
    {
        "input": "-- start template query30.tpl query 75 in stream 0\nwith /* TPC-DS query30.tpl 0.75 */ customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(wr_return_amt) as ctr_total_return\n from web_returns\n     ,date_dim\n     ,customer_address\n where wr_returned_date_sk = d_date_sk \n   and d_year =2000\n   and wr_returning_addr_sk = ca_address_sk \n group by wr_returning_customer_sk\n         ,ca_state)\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n       ,NULL as c_last_review_date,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TX'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"CTR_TOTAL_RETURN\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_ADDR_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 GROUP BY \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TX' LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CTR1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TX' LEFT JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CTR1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TX' LEFT JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name c_preferred_cust_flag  c_birth_day  c_birth_month  c_birth_year c_birth_country c_login      c_email_address c_last_review_date  ctr_total_return\n0   AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           2170.50\n1   AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           5016.60\n2   AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           4181.76\n3   AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           4638.60\n4   AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           3961.20\n5   AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           2317.68\n6   AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           3191.72\n7   AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           5000.36\n8   AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           2349.54\n9   AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           4365.00\n10  AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           2682.75\n11  AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           2668.68\n12  AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           1642.71\n13  AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           3500.01\n14  AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           2835.14\n15  AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           5906.40\n16  AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           2711.50\n17  AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           6934.48\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.196904,
                    "execution_time": 0.143619,
                    "compile_time": 0.00025,
                    "planning_time": 0.038722
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.280891,
                    "execution_time": 0.162909,
                    "compile_time": 0.001381,
                    "planning_time": 0.099297
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CTR1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TX' LEFT JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"CTR1\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TX' LEFT JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" WHERE \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name c_preferred_cust_flag  c_birth_day  c_birth_month  c_birth_year c_birth_country c_login      c_email_address c_last_review_date  ctr_total_return\n0   AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           2170.50\n1   AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           5016.60\n2   AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           4181.76\n3   AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           4638.60\n4   AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           3961.20\n5   AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           2317.68\n6   AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           3191.72\n7   AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           5000.36\n8   AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           2349.54\n9   AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           4365.00\n10  AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           2682.75\n11  AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           2668.68\n12  AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           1642.71\n13  AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           3500.01\n14  AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           2835.14\n15  AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           5906.40\n16  AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           2711.50\n17  AAAAAAAAMJCAAAAA         Miss        Tonia      Dudley                     Y           20              6          1972      KYRGYZSTAN          Tonia.Dudley@3k.org               None           6934.48\n...*/"
    },
    {
        "input": "-- start template query30.tpl query 75 in stream 0\nwith /* TPC-DS query30.tpl 0.75 */ customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(wr_return_amt) as ctr_total_return\n from web_returns\n     ,date_dim\n     ,customer_address\n where wr_returned_date_sk = d_date_sk \n   and d_year =2000\n   and wr_returning_addr_sk = ca_address_sk \n group by wr_returning_customer_sk\n         ,ca_state)\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n       ,NULL as c_last_review_date,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TX'\n       and ctr1.ctr_customer_sk = c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"CTR_TOTAL_RETURN\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_ADDR_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 GROUP BY \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TX' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.070543,
                    "execution_time": 0.041128,
                    "compile_time": 0.000268,
                    "planning_time": 0.003986,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.127932,
                    "execution_time": 0.04071,
                    "compile_time": 0.000276,
                    "planning_time": 0.061297,
                    "create_size": 185
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TX' WHERE \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.179601,
                    "execution_time": 0.099684,
                    "compile_time": 0.000485,
                    "planning_time": 0.037004,
                    "create_size": 128
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.971827,
                    "execution_time": 0.102963,
                    "compile_time": 4.700626,
                    "planning_time": 0.107288,
                    "create_size": 128
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LOGIN\" AS \"C_LOGIN\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_REVIEW_DATE\" AS \"C_LAST_REVIEW_DATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name c_preferred_cust_flag  c_birth_day  c_birth_month  c_birth_year c_birth_country c_login                       c_email_address c_last_review_date  ctr_total_return\n0   AAAAAAAADODAAAAA          Sir       Richie       Smith                     Y           14             10          1960         BERMUDA                  Richie.Smith@Z9FqyaNxVVr.com               None           4833.20\n1   AAAAAAAAHBDFAAAA          Sir       Jerome        Maas                     Y           20              4          1988           EGYPT                            Jerome.Maas@u5.com               None           3284.40\n2   AAAAAAAAPNJHAAAA          Sir        Tyree      Santos                     N           10              2          1961         ALBANIA                    Tyree.Santos@SdhdQyoQq.edu               None           1705.00\n3   AAAAAAAAMJHIAAAA          Sir       Daniel      Graves                     N            9              5          1929            FIJI                         Daniel.Graves@tT5.com               None           2360.16\n4   AAAAAAAAGJHLAAAA         Mrs.       Anissa      Malloy                     N           28              6          1931         VANUATU          Anissa.Malloy@0cLY70uGma5y6Hz9YC.com               None           5211.10\n5   AAAAAAAAGJHLAAAA         Mrs.       Anissa      Malloy                     N           28              6          1931         VANUATU          Anissa.Malloy@0cLY70uGma5y6Hz9YC.com               None           1837.20\n6   AAAAAAAAMAPMAAAA         Mrs.        Laura      Hauser                     Y            5              2          1978      MONTSERRAT                   Laura.Hauser@z6PB01XHTr.com               None           2661.27\n7   AAAAAAAAHMNNAAAA          Sir      Jeffery      Thomas                     Y            8              3          1929      MONTSERRAT                       Jeffery.Thomas@Ld7t.org               None           4881.00\n8   AAAAAAAAMDNBBAAA          Dr.     Giuseppe      Miller                     Y            8             10          1928         IRELAND                Giuseppe.Miller@AI1VMdTNjK.org               None           1808.10\n9   AAAAAAAAENHFBAAA          Dr.       Rodney     Bennett                     N           26              9          1933         BAHAMAS                        Rodney.Bennett@Ng8.org               None           2590.70\n10  AAAAAAAAOOCHBAAA          Ms.      Anthony       Clark                     N           24             11          1979           PALAU                      Anthony.Clark@GQjja0.org               None           9761.90\n11  AAAAAAAAHCMHBAAA          Mr.        Frank     Meadows                     Y           10              8          1939         AUSTRIA                         Frank.Meadows@Bla.com               None           2039.31\n12  AAAAAAAAGLOHBAAA          Dr.       Donald    Crabtree                     Y           22              9          1929   GUINEA-BISSAU                Donald.Crabtree@7kKATYUEHU.com               None           2820.17\n13  AAAAAAAAHKAOBAAA          Ms.         Jane     Hensley                     Y           19              6          1992           NIGER                          Jane.Hensley@X1t.com               None           1646.82\n14  AAAAAAAABBIBCAAA          Dr.    Alexander     Starnes                     Y           25              7          1973          FRANCE          Alexander.Starnes@BBQ3mIhtfa841Y.org               None           6031.60\n15  AAAAAAAAFJFECAAA          Mr.          Jim       Beard                     Y           24             10          1926        SLOVENIA                     Jim.Beard@tOnLalAIJcn.org               None           1934.28\n16  AAAAAAAAACFFCAAA          Sir         Mark       Combs                     Y           31             12          1942         BAHAMAS                   Mark.Combs@7kPKEcbUPQKp.com               None           5124.92\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020271,
                    "execution_time": 0.008016,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.005205
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.059227,
                    "execution_time": 0.007681,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.041513
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TX' WHERE \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LOGIN\" AS \"C_LOGIN\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_REVIEW_DATE\" AS \"C_LAST_REVIEW_DATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name c_preferred_cust_flag  c_birth_day  c_birth_month  c_birth_year c_birth_country c_login                       c_email_address c_last_review_date  ctr_total_return\n0   AAAAAAAADODAAAAA          Sir       Richie       Smith                     Y           14             10          1960         BERMUDA                  Richie.Smith@Z9FqyaNxVVr.com               None           4833.20\n1   AAAAAAAAHBDFAAAA          Sir       Jerome        Maas                     Y           20              4          1988           EGYPT                            Jerome.Maas@u5.com               None           3284.40\n2   AAAAAAAAPNJHAAAA          Sir        Tyree      Santos                     N           10              2          1961         ALBANIA                    Tyree.Santos@SdhdQyoQq.edu               None           1705.00\n3   AAAAAAAAMJHIAAAA          Sir       Daniel      Graves                     N            9              5          1929            FIJI                         Daniel.Graves@tT5.com               None           2360.16\n4   AAAAAAAAGJHLAAAA         Mrs.       Anissa      Malloy                     N           28              6          1931         VANUATU          Anissa.Malloy@0cLY70uGma5y6Hz9YC.com               None           5211.10\n5   AAAAAAAAGJHLAAAA         Mrs.       Anissa      Malloy                     N           28              6          1931         VANUATU          Anissa.Malloy@0cLY70uGma5y6Hz9YC.com               None           1837.20\n6   AAAAAAAAMAPMAAAA         Mrs.        Laura      Hauser                     Y            5              2          1978      MONTSERRAT                   Laura.Hauser@z6PB01XHTr.com               None           2661.27\n7   AAAAAAAAHMNNAAAA          Sir      Jeffery      Thomas                     Y            8              3          1929      MONTSERRAT                       Jeffery.Thomas@Ld7t.org               None           4881.00\n8   AAAAAAAAMDNBBAAA          Dr.     Giuseppe      Miller                     Y            8             10          1928         IRELAND                Giuseppe.Miller@AI1VMdTNjK.org               None           1808.10\n9   AAAAAAAAENHFBAAA          Dr.       Rodney     Bennett                     N           26              9          1933         BAHAMAS                        Rodney.Bennett@Ng8.org               None           2590.70\n10  AAAAAAAAOOCHBAAA          Ms.      Anthony       Clark                     N           24             11          1979           PALAU                      Anthony.Clark@GQjja0.org               None           9761.90\n11  AAAAAAAAHCMHBAAA          Mr.        Frank     Meadows                     Y           10              8          1939         AUSTRIA                         Frank.Meadows@Bla.com               None           2039.31\n12  AAAAAAAAGLOHBAAA          Dr.       Donald    Crabtree                     Y           22              9          1929   GUINEA-BISSAU                Donald.Crabtree@7kKATYUEHU.com               None           2820.17\n13  AAAAAAAAHKAOBAAA          Ms.         Jane     Hensley                     Y           19              6          1992           NIGER                          Jane.Hensley@X1t.com               None           1646.82\n14  AAAAAAAABBIBCAAA          Dr.    Alexander     Starnes                     Y           25              7          1973          FRANCE          Alexander.Starnes@BBQ3mIhtfa841Y.org               None           6031.60\n15  AAAAAAAAFJFECAAA          Mr.          Jim       Beard                     Y           24             10          1926        SLOVENIA                     Jim.Beard@tOnLalAIJcn.org               None           1934.28\n16  AAAAAAAAACFFCAAA          Sir         Mark       Combs                     Y           31             12          1942         BAHAMAS                   Mark.Combs@7kPKEcbUPQKp.com               None           5124.92\n...*/"
    },
    {
        "input": "-- start template query30.tpl query 75 in stream 0\nwith /* TPC-DS query30.tpl 0.75 */ customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(wr_return_amt) as ctr_total_return\n from web_returns\n     ,date_dim\n     ,customer_address\n where wr_returned_date_sk = d_date_sk \n   and d_year =2000\n   and wr_returning_addr_sk = ca_address_sk \n group by wr_returning_customer_sk\n         ,ca_state)\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n       ,NULL as c_last_review_date,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TX'\n       and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"CTR_TOTAL_RETURN\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_ADDR_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 GROUP BY \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TX' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LOGIN\" AS \"C_LOGIN\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_REVIEW_DATE\" AS \"C_LAST_REVIEW_DATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"C_CUSTOMER_ID\" , \"C_SALUTATION\" , \"C_FIRST_NAME\" , \"C_LAST_NAME\" , \"C_PREFERRED_CUST_FLAG\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name c_preferred_cust_flag  c_birth_day  c_birth_month  c_birth_year       c_birth_country c_login                      c_email_address c_last_review_date  ctr_total_return\n0   AAAAAAAAAADACAAA          Mr.     Nicholas      Steele                     N          NaN            8.0           NaN                                                                                  None           2375.13\n1   AAAAAAAAAAFBDAAA          Sir         Eric      Yazzie                     N         25.0            6.0        1925.0    KOREA, REPUBLIC OF           Eric.Yazzie@F5AsAkOpv2fIEV1DeS.edu               None           3430.60\n2   AAAAAAAAAANPEAAA          Dr.         Dona      Lawson                     N         21.0            4.0        1931.0           ISLE OF MAN                       Dona.Lawson@DqXYGS.edu               None           7244.97\n3   AAAAAAAAAAOBEAAA                                                           N         28.0            3.0           NaN                                                                                  None           5665.36\n4   AAAAAAAAABAJDAAA          Sir         Gary   Hitchcock                     Y          4.0            7.0        1939.0            MONTENEGRO                         Gary.Hitchcock@d.com               None           1604.13\n5   AAAAAAAAABBGDAAA          Mr.          Roy       Lopez                     N          3.0            4.0        1946.0             GUATEMALA                 Roy.Lopez@a5mlm7zgMGJPyY.com               None          11088.00\n6   AAAAAAAAABCHDAAA                     Erika                                 Y          NaN            NaN           NaN                                                                                  None           3789.72\n7   AAAAAAAAABHCEAAA          Ms.         Nina       Cable                     Y          4.0            4.0        1960.0           TIMOR-LESTE                 Nina.Cable@P9pRkLxopmrVn.com               None           3586.20\n8   AAAAAAAAABIABAAA          Dr.                                                        12.0            6.0           NaN                 ITALY                                                            None           1905.25\n9   AAAAAAAAABIEDAAA          Mr.         John        Dyer                     N          4.0            8.0        1950.0            MONTENEGRO                 John.Dyer@UayFfsP2bKRnLH.edu               None           6145.20\n10  AAAAAAAAABIOGAAA         Miss      Yolanda      Cortez                     N          7.0            6.0        1980.0                  MALI          Yolanda.Cortez@I55j1uvYR6JeLF3i.edu               None           2273.04\n11  AAAAAAAAABKGEAAA          Mr.         Eric    Benjamin                     N          4.0            9.0        1934.0               ARMENIA                 Eric.Benjamin@ArG5GUOL3q.edu               None           2689.32\n12  AAAAAAAAABKOFAAA          Mr.      Cameron      Wilson                     Y          4.0           10.0        1934.0        NORFOLK ISLAND          Cameron.Wilson@x2teUyYIMPDOh9Oe.org               None           4473.84\n13  AAAAAAAAABKOFAAA          Mr.      Cameron      Wilson                     Y          4.0           10.0        1934.0        NORFOLK ISLAND          Cameron.Wilson@x2teUyYIMPDOh9Oe.org               None           1652.31\n14  AAAAAAAAABLOEAAA          Dr.      Kenneth        Mack                     N          4.0            7.0        1953.0         FAROE ISLANDS             Kenneth.Mack@Xi70nTXvXExiLFp.org               None           2148.00\n15  AAAAAAAAABMGHAAA          Dr.       Julian      Jensen                     N         28.0            6.0        1944.0  NETHERLANDS ANTILLES          Julian.Jensen@kvV6LokbutMlOJ1dB.com               None           2092.72\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021581,
                    "execution_time": 0.008412,
                    "compile_time": 9.1e-05,
                    "planning_time": 0.005849
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.061251,
                    "execution_time": 0.009104,
                    "compile_time": 9.6e-05,
                    "planning_time": 0.041887
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TX' WHERE \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LOGIN\" AS \"C_LOGIN\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_REVIEW_DATE\" AS \"C_LAST_REVIEW_DATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" NULLS LAST"
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name c_preferred_cust_flag  c_birth_day  c_birth_month  c_birth_year       c_birth_country c_login                      c_email_address c_last_review_date  ctr_total_return\n0   AAAAAAAAAADACAAA          Mr.     Nicholas      Steele                     N          NaN            8.0           NaN                                                                                  None           2375.13\n1   AAAAAAAAAAFBDAAA          Sir         Eric      Yazzie                     N         25.0            6.0        1925.0    KOREA, REPUBLIC OF           Eric.Yazzie@F5AsAkOpv2fIEV1DeS.edu               None           3430.60\n2   AAAAAAAAAANPEAAA          Dr.         Dona      Lawson                     N         21.0            4.0        1931.0           ISLE OF MAN                       Dona.Lawson@DqXYGS.edu               None           7244.97\n3   AAAAAAAAAAOBEAAA                                                           N         28.0            3.0           NaN                                                                                  None           5665.36\n4   AAAAAAAAABAJDAAA          Sir         Gary   Hitchcock                     Y          4.0            7.0        1939.0            MONTENEGRO                         Gary.Hitchcock@d.com               None           1604.13\n5   AAAAAAAAABBGDAAA          Mr.          Roy       Lopez                     N          3.0            4.0        1946.0             GUATEMALA                 Roy.Lopez@a5mlm7zgMGJPyY.com               None          11088.00\n6   AAAAAAAAABCHDAAA                     Erika                                 Y          NaN            NaN           NaN                                                                                  None           3789.72\n7   AAAAAAAAABHCEAAA          Ms.         Nina       Cable                     Y          4.0            4.0        1960.0           TIMOR-LESTE                 Nina.Cable@P9pRkLxopmrVn.com               None           3586.20\n8   AAAAAAAAABIABAAA          Dr.                                                        12.0            6.0           NaN                 ITALY                                                            None           1905.25\n9   AAAAAAAAABIEDAAA          Mr.         John        Dyer                     N          4.0            8.0        1950.0            MONTENEGRO                 John.Dyer@UayFfsP2bKRnLH.edu               None           6145.20\n10  AAAAAAAAABIOGAAA         Miss      Yolanda      Cortez                     N          7.0            6.0        1980.0                  MALI          Yolanda.Cortez@I55j1uvYR6JeLF3i.edu               None           2273.04\n11  AAAAAAAAABKGEAAA          Mr.         Eric    Benjamin                     N          4.0            9.0        1934.0               ARMENIA                 Eric.Benjamin@ArG5GUOL3q.edu               None           2689.32\n12  AAAAAAAAABKOFAAA          Mr.      Cameron      Wilson                     Y          4.0           10.0        1934.0        NORFOLK ISLAND          Cameron.Wilson@x2teUyYIMPDOh9Oe.org               None           4473.84\n13  AAAAAAAAABKOFAAA          Mr.      Cameron      Wilson                     Y          4.0           10.0        1934.0        NORFOLK ISLAND          Cameron.Wilson@x2teUyYIMPDOh9Oe.org               None           1652.31\n14  AAAAAAAAABLOEAAA          Dr.      Kenneth        Mack                     N          4.0            7.0        1953.0         FAROE ISLANDS             Kenneth.Mack@Xi70nTXvXExiLFp.org               None           2148.00\n15  AAAAAAAAABMGHAAA          Dr.       Julian      Jensen                     N         28.0            6.0        1944.0  NETHERLANDS ANTILLES          Julian.Jensen@kvV6LokbutMlOJ1dB.com               None           2092.72\n...*/"
    },
    {
        "input": "-- start template query30.tpl query 75 in stream 0\nwith /* TPC-DS query30.tpl 0.75 */ customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(wr_return_amt) as ctr_total_return\n from web_returns\n     ,date_dim\n     ,customer_address\n where wr_returned_date_sk = d_date_sk \n   and d_year =2000\n   and wr_returning_addr_sk = ca_address_sk \n group by wr_returning_customer_sk\n         ,ca_state)\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n       ,NULL as c_last_review_date,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TX'\n       and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"CTR_TOTAL_RETURN\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_ADDR_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 GROUP BY \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TX' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" NULLS LAST , \"C_BIRTH_DAY\" NULLS LAST , \"C_BIRTH_MONTH\" NULLS LAST , \"C_BIRTH_YEAR\" NULLS LAST , \"C_BIRTH_COUNTRY\" NULLS LAST , \"C_LOGIN\" NULLS LAST , \"C_EMAIL_ADDRESS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LOGIN\" AS \"C_LOGIN\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_REVIEW_DATE\" AS \"C_LAST_REVIEW_DATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"C_CUSTOMER_ID\" , \"C_SALUTATION\" , \"C_FIRST_NAME\" , \"C_LAST_NAME\" , \"C_PREFERRED_CUST_FLAG\" , \"C_BIRTH_DAY\" , \"C_BIRTH_MONTH\" , \"C_BIRTH_YEAR\" , \"C_BIRTH_COUNTRY\" , \"C_LOGIN\" , \"C_EMAIL_ADDRESS\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name c_preferred_cust_flag  c_birth_day  c_birth_month  c_birth_year       c_birth_country c_login                      c_email_address c_last_review_date  ctr_total_return\n0   AAAAAAAAAADACAAA          Mr.     Nicholas      Steele                     N          NaN            8.0           NaN                                                                                  None           2375.13\n1   AAAAAAAAAAFBDAAA          Sir         Eric      Yazzie                     N         25.0            6.0        1925.0    KOREA, REPUBLIC OF           Eric.Yazzie@F5AsAkOpv2fIEV1DeS.edu               None           3430.60\n2   AAAAAAAAAANPEAAA          Dr.         Dona      Lawson                     N         21.0            4.0        1931.0           ISLE OF MAN                       Dona.Lawson@DqXYGS.edu               None           7244.97\n3   AAAAAAAAAAOBEAAA                                                           N         28.0            3.0           NaN                                                                                  None           5665.36\n4   AAAAAAAAABAJDAAA          Sir         Gary   Hitchcock                     Y          4.0            7.0        1939.0            MONTENEGRO                         Gary.Hitchcock@d.com               None           1604.13\n5   AAAAAAAAABBGDAAA          Mr.          Roy       Lopez                     N          3.0            4.0        1946.0             GUATEMALA                 Roy.Lopez@a5mlm7zgMGJPyY.com               None          11088.00\n6   AAAAAAAAABCHDAAA                     Erika                                 Y          NaN            NaN           NaN                                                                                  None           3789.72\n7   AAAAAAAAABHCEAAA          Ms.         Nina       Cable                     Y          4.0            4.0        1960.0           TIMOR-LESTE                 Nina.Cable@P9pRkLxopmrVn.com               None           3586.20\n8   AAAAAAAAABIABAAA          Dr.                                                        12.0            6.0           NaN                 ITALY                                                            None           1905.25\n9   AAAAAAAAABIEDAAA          Mr.         John        Dyer                     N          4.0            8.0        1950.0            MONTENEGRO                 John.Dyer@UayFfsP2bKRnLH.edu               None           6145.20\n10  AAAAAAAAABIOGAAA         Miss      Yolanda      Cortez                     N          7.0            6.0        1980.0                  MALI          Yolanda.Cortez@I55j1uvYR6JeLF3i.edu               None           2273.04\n11  AAAAAAAAABKGEAAA          Mr.         Eric    Benjamin                     N          4.0            9.0        1934.0               ARMENIA                 Eric.Benjamin@ArG5GUOL3q.edu               None           2689.32\n12  AAAAAAAAABKOFAAA          Mr.      Cameron      Wilson                     Y          4.0           10.0        1934.0        NORFOLK ISLAND          Cameron.Wilson@x2teUyYIMPDOh9Oe.org               None           4473.84\n13  AAAAAAAAABKOFAAA          Mr.      Cameron      Wilson                     Y          4.0           10.0        1934.0        NORFOLK ISLAND          Cameron.Wilson@x2teUyYIMPDOh9Oe.org               None           1652.31\n14  AAAAAAAAABLOEAAA          Dr.      Kenneth        Mack                     N          4.0            7.0        1953.0         FAROE ISLANDS             Kenneth.Mack@Xi70nTXvXExiLFp.org               None           2148.00\n15  AAAAAAAAABMGHAAA          Dr.       Julian      Jensen                     N         28.0            6.0        1944.0  NETHERLANDS ANTILLES          Julian.Jensen@kvV6LokbutMlOJ1dB.com               None           2092.72\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022298,
                    "execution_time": 0.008518,
                    "compile_time": 9.3e-05,
                    "planning_time": 0.006357
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058012,
                    "execution_time": 0.008309,
                    "compile_time": 9.4e-05,
                    "planning_time": 0.04231
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TX' WHERE \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" NULLS LAST , \"C_BIRTH_DAY\" NULLS LAST , \"C_BIRTH_MONTH\" NULLS LAST , \"C_BIRTH_YEAR\" NULLS LAST , \"C_BIRTH_COUNTRY\" NULLS LAST , \"C_LOGIN\" NULLS LAST , \"C_EMAIL_ADDRESS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LOGIN\" AS \"C_LOGIN\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_REVIEW_DATE\" AS \"C_LAST_REVIEW_DATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" NULLS LAST , \"C_BIRTH_DAY\" NULLS LAST , \"C_BIRTH_MONTH\" NULLS LAST , \"C_BIRTH_YEAR\" NULLS LAST , \"C_BIRTH_COUNTRY\" NULLS LAST , \"C_LOGIN\" NULLS LAST , \"C_EMAIL_ADDRESS\" NULLS LAST"
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name c_preferred_cust_flag  c_birth_day  c_birth_month  c_birth_year       c_birth_country c_login                      c_email_address c_last_review_date  ctr_total_return\n0   AAAAAAAAAADACAAA          Mr.     Nicholas      Steele                     N          NaN            8.0           NaN                                                                                  None           2375.13\n1   AAAAAAAAAAFBDAAA          Sir         Eric      Yazzie                     N         25.0            6.0        1925.0    KOREA, REPUBLIC OF           Eric.Yazzie@F5AsAkOpv2fIEV1DeS.edu               None           3430.60\n2   AAAAAAAAAANPEAAA          Dr.         Dona      Lawson                     N         21.0            4.0        1931.0           ISLE OF MAN                       Dona.Lawson@DqXYGS.edu               None           7244.97\n3   AAAAAAAAAAOBEAAA                                                           N         28.0            3.0           NaN                                                                                  None           5665.36\n4   AAAAAAAAABAJDAAA          Sir         Gary   Hitchcock                     Y          4.0            7.0        1939.0            MONTENEGRO                         Gary.Hitchcock@d.com               None           1604.13\n5   AAAAAAAAABBGDAAA          Mr.          Roy       Lopez                     N          3.0            4.0        1946.0             GUATEMALA                 Roy.Lopez@a5mlm7zgMGJPyY.com               None          11088.00\n6   AAAAAAAAABCHDAAA                     Erika                                 Y          NaN            NaN           NaN                                                                                  None           3789.72\n7   AAAAAAAAABHCEAAA          Ms.         Nina       Cable                     Y          4.0            4.0        1960.0           TIMOR-LESTE                 Nina.Cable@P9pRkLxopmrVn.com               None           3586.20\n8   AAAAAAAAABIABAAA          Dr.                                                        12.0            6.0           NaN                 ITALY                                                            None           1905.25\n9   AAAAAAAAABIEDAAA          Mr.         John        Dyer                     N          4.0            8.0        1950.0            MONTENEGRO                 John.Dyer@UayFfsP2bKRnLH.edu               None           6145.20\n10  AAAAAAAAABIOGAAA         Miss      Yolanda      Cortez                     N          7.0            6.0        1980.0                  MALI          Yolanda.Cortez@I55j1uvYR6JeLF3i.edu               None           2273.04\n11  AAAAAAAAABKGEAAA          Mr.         Eric    Benjamin                     N          4.0            9.0        1934.0               ARMENIA                 Eric.Benjamin@ArG5GUOL3q.edu               None           2689.32\n12  AAAAAAAAABKOFAAA          Mr.      Cameron      Wilson                     Y          4.0           10.0        1934.0        NORFOLK ISLAND          Cameron.Wilson@x2teUyYIMPDOh9Oe.org               None           4473.84\n13  AAAAAAAAABKOFAAA          Mr.      Cameron      Wilson                     Y          4.0           10.0        1934.0        NORFOLK ISLAND          Cameron.Wilson@x2teUyYIMPDOh9Oe.org               None           1652.31\n14  AAAAAAAAABLOEAAA          Dr.      Kenneth        Mack                     N          4.0            7.0        1953.0         FAROE ISLANDS             Kenneth.Mack@Xi70nTXvXExiLFp.org               None           2148.00\n15  AAAAAAAAABMGHAAA          Dr.       Julian      Jensen                     N         28.0            6.0        1944.0  NETHERLANDS ANTILLES          Julian.Jensen@kvV6LokbutMlOJ1dB.com               None           2092.72\n...*/"
    },
    {
        "input": "-- start template query30.tpl query 75 in stream 0\nwith /* TPC-DS query30.tpl 0.75 */ customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(wr_return_amt) as ctr_total_return\n from web_returns\n     ,date_dim\n     ,customer_address\n where wr_returned_date_sk = d_date_sk \n   and d_year =2000\n   and wr_returning_addr_sk = ca_address_sk \n group by wr_returning_customer_sk\n         ,ca_state)\n  select  c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n       ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n       ,NULL as c_last_review_date,ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TX'\n       and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id,c_salutation,c_first_name,c_last_name,c_preferred_cust_flag\n                  ,c_birth_day,c_birth_month,c_birth_year,c_birth_country,c_login,c_email_address\n                  ,ctr_total_return\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"CTR_TOTAL_RETURN\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_ADDR_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 GROUP BY \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TX' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" NULLS LAST , \"C_BIRTH_DAY\" NULLS LAST , \"C_BIRTH_MONTH\" NULLS LAST , \"C_BIRTH_YEAR\" NULLS LAST , \"C_BIRTH_COUNTRY\" NULLS LAST , \"C_LOGIN\" NULLS LAST , \"C_EMAIL_ADDRESS\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LOGIN\" AS \"C_LOGIN\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_REVIEW_DATE\" AS \"C_LAST_REVIEW_DATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"C_CUSTOMER_ID\" , \"C_SALUTATION\" , \"C_FIRST_NAME\" , \"C_LAST_NAME\" , \"C_PREFERRED_CUST_FLAG\" , \"C_BIRTH_DAY\" , \"C_BIRTH_MONTH\" , \"C_BIRTH_YEAR\" , \"C_BIRTH_COUNTRY\" , \"C_LOGIN\" , \"C_EMAIL_ADDRESS\" , \"CTR_TOTAL_RETURN\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name c_preferred_cust_flag  c_birth_day  c_birth_month  c_birth_year       c_birth_country c_login                      c_email_address c_last_review_date  ctr_total_return\n0   AAAAAAAAAADACAAA          Mr.     Nicholas      Steele                     N          NaN            8.0           NaN                                                                                  None           2375.13\n1   AAAAAAAAAAFBDAAA          Sir         Eric      Yazzie                     N         25.0            6.0        1925.0    KOREA, REPUBLIC OF           Eric.Yazzie@F5AsAkOpv2fIEV1DeS.edu               None           3430.60\n2   AAAAAAAAAANPEAAA          Dr.         Dona      Lawson                     N         21.0            4.0        1931.0           ISLE OF MAN                       Dona.Lawson@DqXYGS.edu               None           7244.97\n3   AAAAAAAAAAOBEAAA                                                           N         28.0            3.0           NaN                                                                                  None           5665.36\n4   AAAAAAAAABAJDAAA          Sir         Gary   Hitchcock                     Y          4.0            7.0        1939.0            MONTENEGRO                         Gary.Hitchcock@d.com               None           1604.13\n5   AAAAAAAAABBGDAAA          Mr.          Roy       Lopez                     N          3.0            4.0        1946.0             GUATEMALA                 Roy.Lopez@a5mlm7zgMGJPyY.com               None          11088.00\n6   AAAAAAAAABCHDAAA                     Erika                                 Y          NaN            NaN           NaN                                                                                  None           3789.72\n7   AAAAAAAAABHCEAAA          Ms.         Nina       Cable                     Y          4.0            4.0        1960.0           TIMOR-LESTE                 Nina.Cable@P9pRkLxopmrVn.com               None           3586.20\n8   AAAAAAAAABIABAAA          Dr.                                                        12.0            6.0           NaN                 ITALY                                                            None           1905.25\n9   AAAAAAAAABIEDAAA          Mr.         John        Dyer                     N          4.0            8.0        1950.0            MONTENEGRO                 John.Dyer@UayFfsP2bKRnLH.edu               None           6145.20\n10  AAAAAAAAABIOGAAA         Miss      Yolanda      Cortez                     N          7.0            6.0        1980.0                  MALI          Yolanda.Cortez@I55j1uvYR6JeLF3i.edu               None           2273.04\n11  AAAAAAAAABKGEAAA          Mr.         Eric    Benjamin                     N          4.0            9.0        1934.0               ARMENIA                 Eric.Benjamin@ArG5GUOL3q.edu               None           2689.32\n12  AAAAAAAAABKOFAAA          Mr.      Cameron      Wilson                     Y          4.0           10.0        1934.0        NORFOLK ISLAND          Cameron.Wilson@x2teUyYIMPDOh9Oe.org               None           1652.31\n13  AAAAAAAAABKOFAAA          Mr.      Cameron      Wilson                     Y          4.0           10.0        1934.0        NORFOLK ISLAND          Cameron.Wilson@x2teUyYIMPDOh9Oe.org               None           4473.84\n14  AAAAAAAAABLOEAAA          Dr.      Kenneth        Mack                     N          4.0            7.0        1953.0         FAROE ISLANDS             Kenneth.Mack@Xi70nTXvXExiLFp.org               None           2148.00\n15  AAAAAAAAABMGHAAA          Dr.       Julian      Jensen                     N         28.0            6.0        1944.0  NETHERLANDS ANTILLES          Julian.Jensen@kvV6LokbutMlOJ1dB.com               None           2092.72\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022458,
                    "execution_time": 0.008476,
                    "compile_time": 9.5e-05,
                    "planning_time": 0.006538
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058865,
                    "execution_time": 0.009124,
                    "compile_time": 9.2e-05,
                    "planning_time": 0.04234
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TX' WHERE \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" NULLS LAST , \"C_BIRTH_DAY\" NULLS LAST , \"C_BIRTH_MONTH\" NULLS LAST , \"C_BIRTH_YEAR\" NULLS LAST , \"C_BIRTH_COUNTRY\" NULLS LAST , \"C_LOGIN\" NULLS LAST , \"C_EMAIL_ADDRESS\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LOGIN\" AS \"C_LOGIN\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_REVIEW_DATE\" AS \"C_LAST_REVIEW_DATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" NULLS LAST , \"C_BIRTH_DAY\" NULLS LAST , \"C_BIRTH_MONTH\" NULLS LAST , \"C_BIRTH_YEAR\" NULLS LAST , \"C_BIRTH_COUNTRY\" NULLS LAST , \"C_LOGIN\" NULLS LAST , \"C_EMAIL_ADDRESS\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST"
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name c_preferred_cust_flag  c_birth_day  c_birth_month  c_birth_year       c_birth_country c_login                      c_email_address c_last_review_date  ctr_total_return\n0   AAAAAAAAAADACAAA          Mr.     Nicholas      Steele                     N          NaN            8.0           NaN                                                                                  None           2375.13\n1   AAAAAAAAAAFBDAAA          Sir         Eric      Yazzie                     N         25.0            6.0        1925.0    KOREA, REPUBLIC OF           Eric.Yazzie@F5AsAkOpv2fIEV1DeS.edu               None           3430.60\n2   AAAAAAAAAANPEAAA          Dr.         Dona      Lawson                     N         21.0            4.0        1931.0           ISLE OF MAN                       Dona.Lawson@DqXYGS.edu               None           7244.97\n3   AAAAAAAAAAOBEAAA                                                           N         28.0            3.0           NaN                                                                                  None           5665.36\n4   AAAAAAAAABAJDAAA          Sir         Gary   Hitchcock                     Y          4.0            7.0        1939.0            MONTENEGRO                         Gary.Hitchcock@d.com               None           1604.13\n5   AAAAAAAAABBGDAAA          Mr.          Roy       Lopez                     N          3.0            4.0        1946.0             GUATEMALA                 Roy.Lopez@a5mlm7zgMGJPyY.com               None          11088.00\n6   AAAAAAAAABCHDAAA                     Erika                                 Y          NaN            NaN           NaN                                                                                  None           3789.72\n7   AAAAAAAAABHCEAAA          Ms.         Nina       Cable                     Y          4.0            4.0        1960.0           TIMOR-LESTE                 Nina.Cable@P9pRkLxopmrVn.com               None           3586.20\n8   AAAAAAAAABIABAAA          Dr.                                                        12.0            6.0           NaN                 ITALY                                                            None           1905.25\n9   AAAAAAAAABIEDAAA          Mr.         John        Dyer                     N          4.0            8.0        1950.0            MONTENEGRO                 John.Dyer@UayFfsP2bKRnLH.edu               None           6145.20\n10  AAAAAAAAABIOGAAA         Miss      Yolanda      Cortez                     N          7.0            6.0        1980.0                  MALI          Yolanda.Cortez@I55j1uvYR6JeLF3i.edu               None           2273.04\n11  AAAAAAAAABKGEAAA          Mr.         Eric    Benjamin                     N          4.0            9.0        1934.0               ARMENIA                 Eric.Benjamin@ArG5GUOL3q.edu               None           2689.32\n12  AAAAAAAAABKOFAAA          Mr.      Cameron      Wilson                     Y          4.0           10.0        1934.0        NORFOLK ISLAND          Cameron.Wilson@x2teUyYIMPDOh9Oe.org               None           1652.31\n13  AAAAAAAAABKOFAAA          Mr.      Cameron      Wilson                     Y          4.0           10.0        1934.0        NORFOLK ISLAND          Cameron.Wilson@x2teUyYIMPDOh9Oe.org               None           4473.84\n14  AAAAAAAAABLOEAAA          Dr.      Kenneth        Mack                     N          4.0            7.0        1953.0         FAROE ISLANDS             Kenneth.Mack@Xi70nTXvXExiLFp.org               None           2148.00\n15  AAAAAAAAABMGHAAA          Dr.       Julian      Jensen                     N         28.0            6.0        1944.0  NETHERLANDS ANTILLES          Julian.Jensen@kvV6LokbutMlOJ1dB.com               None           2092.72\n...*/"
    },
    {
        "input": "-- start template query30.tpl query 75 in stream 0\nwith /* TPC-DS query30.tpl 0.75 */ customer_total_return as\n (select wr_returning_customer_sk as ctr_customer_sk\n        ,ca_state as ctr_state, \n \tsum(wr_return_amt) as ctr_total_return\n from web_returns\n     ,date_dim\n     ,customer_address\n where wr_returned_date_sk = d_date_sk \n   and d_year = 2000\n   and wr_returning_addr_sk = ca_address_sk \n group by wr_returning_customer_sk\n         ,ca_state)\n  select  c_customer_id, c_salutation, c_first_name, c_last_name, c_preferred_cust_flag\n       ,c_birth_day, c_birth_month, c_birth_year, c_birth_country, c_login, c_email_address\n       ,null as c_last_review_date, ctr_total_return\n from customer_total_return ctr1\n     ,customer_address\n     ,customer\n where ctr1.ctr_total_return > (select avg(ctr_total_return) * 1.2\n \t\t\t  from customer_total_return ctr2 \n                  \t  where ctr1.ctr_state = ctr2.ctr_state)\n       and ca_address_sk = c_current_addr_sk\n       and ca_state = 'TX'\n       and ctr1.ctr_customer_sk = c_customer_sk\n order by c_customer_id, c_salutation, c_first_name, c_last_name, c_preferred_cust_flag\n                  ,c_birth_day, c_birth_month, c_birth_year, c_birth_country, c_login, c_email_address\n                  ,c_last_review_date, ctr_total_return\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CTR_STATE\" , SUM ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" ) AS \"CTR_TOTAL_RETURN\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" = \"WEB_RETURNS\".\"WR_RETURNING_ADDR_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2000 GROUP BY \"WEB_RETURNS\".\"WR_RETURNING_CUSTOMER_SK\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STATE\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STATE\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TX' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" NULLS LAST , \"C_BIRTH_DAY\" NULLS LAST , \"C_BIRTH_MONTH\" NULLS LAST , \"C_BIRTH_YEAR\" NULLS LAST , \"C_BIRTH_COUNTRY\" NULLS LAST , \"C_LOGIN\" NULLS LAST , \"C_EMAIL_ADDRESS\" NULLS LAST , \"C_LAST_REVIEW_DATE\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LOGIN\" AS \"C_LOGIN\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_REVIEW_DATE\" AS \"C_LAST_REVIEW_DATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"C_CUSTOMER_ID\" , \"C_SALUTATION\" , \"C_FIRST_NAME\" , \"C_LAST_NAME\" , \"C_PREFERRED_CUST_FLAG\" , \"C_BIRTH_DAY\" , \"C_BIRTH_MONTH\" , \"C_BIRTH_YEAR\" , \"C_BIRTH_COUNTRY\" , \"C_LOGIN\" , \"C_EMAIL_ADDRESS\" , \"C_LAST_REVIEW_DATE\" , \"CTR_TOTAL_RETURN\" LIMIT 21",
                "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name c_preferred_cust_flag  c_birth_day  c_birth_month  c_birth_year       c_birth_country c_login                      c_email_address c_last_review_date  ctr_total_return\n0   AAAAAAAAAADACAAA          Mr.     Nicholas      Steele                     N          NaN            8.0           NaN                                                                                  None           2375.13\n1   AAAAAAAAAAFBDAAA          Sir         Eric      Yazzie                     N         25.0            6.0        1925.0    KOREA, REPUBLIC OF           Eric.Yazzie@F5AsAkOpv2fIEV1DeS.edu               None           3430.60\n2   AAAAAAAAAANPEAAA          Dr.         Dona      Lawson                     N         21.0            4.0        1931.0           ISLE OF MAN                       Dona.Lawson@DqXYGS.edu               None           7244.97\n3   AAAAAAAAAAOBEAAA                                                           N         28.0            3.0           NaN                                                                                  None           5665.36\n4   AAAAAAAAABAJDAAA          Sir         Gary   Hitchcock                     Y          4.0            7.0        1939.0            MONTENEGRO                         Gary.Hitchcock@d.com               None           1604.13\n5   AAAAAAAAABBGDAAA          Mr.          Roy       Lopez                     N          3.0            4.0        1946.0             GUATEMALA                 Roy.Lopez@a5mlm7zgMGJPyY.com               None          11088.00\n6   AAAAAAAAABCHDAAA                     Erika                                 Y          NaN            NaN           NaN                                                                                  None           3789.72\n7   AAAAAAAAABHCEAAA          Ms.         Nina       Cable                     Y          4.0            4.0        1960.0           TIMOR-LESTE                 Nina.Cable@P9pRkLxopmrVn.com               None           3586.20\n8   AAAAAAAAABIABAAA          Dr.                                                        12.0            6.0           NaN                 ITALY                                                            None           1905.25\n9   AAAAAAAAABIEDAAA          Mr.         John        Dyer                     N          4.0            8.0        1950.0            MONTENEGRO                 John.Dyer@UayFfsP2bKRnLH.edu               None           6145.20\n10  AAAAAAAAABIOGAAA         Miss      Yolanda      Cortez                     N          7.0            6.0        1980.0                  MALI          Yolanda.Cortez@I55j1uvYR6JeLF3i.edu               None           2273.04\n11  AAAAAAAAABKGEAAA          Mr.         Eric    Benjamin                     N          4.0            9.0        1934.0               ARMENIA                 Eric.Benjamin@ArG5GUOL3q.edu               None           2689.32\n12  AAAAAAAAABKOFAAA          Mr.      Cameron      Wilson                     Y          4.0           10.0        1934.0        NORFOLK ISLAND          Cameron.Wilson@x2teUyYIMPDOh9Oe.org               None           1652.31\n13  AAAAAAAAABKOFAAA          Mr.      Cameron      Wilson                     Y          4.0           10.0        1934.0        NORFOLK ISLAND          Cameron.Wilson@x2teUyYIMPDOh9Oe.org               None           4473.84\n14  AAAAAAAAABLOEAAA          Dr.      Kenneth        Mack                     N          4.0            7.0        1953.0         FAROE ISLANDS             Kenneth.Mack@Xi70nTXvXExiLFp.org               None           2148.00\n15  AAAAAAAAABMGHAAA          Dr.       Julian      Jensen                     N         28.0            6.0        1944.0  NETHERLANDS ANTILLES          Julian.Jensen@kvV6LokbutMlOJ1dB.com               None           2092.72\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022255,
                    "execution_time": 0.008519,
                    "compile_time": 9.3e-05,
                    "planning_time": 0.006481
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058199,
                    "execution_time": 0.008362,
                    "compile_time": 9.5e-05,
                    "planning_time": 0.042303
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"CUSTOMER\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"CUSTOMER\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , NULL AS \"C_LAST_REVIEW_DATE\" , \"CTR1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_U_1\" = \"CTR1\".\"CTR_STATE\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" = 'TX' WHERE \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" NULLS LAST , \"C_BIRTH_DAY\" NULLS LAST , \"C_BIRTH_MONTH\" NULLS LAST , \"C_BIRTH_YEAR\" NULLS LAST , \"C_BIRTH_COUNTRY\" NULLS LAST , \"C_LOGIN\" NULLS LAST , \"C_EMAIL_ADDRESS\" NULLS LAST , \"C_LAST_REVIEW_DATE\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_DAY\" AS \"C_BIRTH_DAY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_MONTH\" AS \"C_BIRTH_MONTH\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_YEAR\" AS \"C_BIRTH_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LOGIN\" AS \"C_LOGIN\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_REVIEW_DATE\" AS \"C_LAST_REVIEW_DATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_LAST_NAME\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" NULLS LAST , \"C_BIRTH_DAY\" NULLS LAST , \"C_BIRTH_MONTH\" NULLS LAST , \"C_BIRTH_YEAR\" NULLS LAST , \"C_BIRTH_COUNTRY\" NULLS LAST , \"C_LOGIN\" NULLS LAST , \"C_EMAIL_ADDRESS\" NULLS LAST , \"C_LAST_REVIEW_DATE\" NULLS LAST , \"CTR_TOTAL_RETURN\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*       c_customer_id c_salutation c_first_name c_last_name c_preferred_cust_flag  c_birth_day  c_birth_month  c_birth_year       c_birth_country c_login                      c_email_address c_last_review_date  ctr_total_return\n0   AAAAAAAAAADACAAA          Mr.     Nicholas      Steele                     N          NaN            8.0           NaN                                                                                  None           2375.13\n1   AAAAAAAAAAFBDAAA          Sir         Eric      Yazzie                     N         25.0            6.0        1925.0    KOREA, REPUBLIC OF           Eric.Yazzie@F5AsAkOpv2fIEV1DeS.edu               None           3430.60\n2   AAAAAAAAAANPEAAA          Dr.         Dona      Lawson                     N         21.0            4.0        1931.0           ISLE OF MAN                       Dona.Lawson@DqXYGS.edu               None           7244.97\n3   AAAAAAAAAAOBEAAA                                                           N         28.0            3.0           NaN                                                                                  None           5665.36\n4   AAAAAAAAABAJDAAA          Sir         Gary   Hitchcock                     Y          4.0            7.0        1939.0            MONTENEGRO                         Gary.Hitchcock@d.com               None           1604.13\n5   AAAAAAAAABBGDAAA          Mr.          Roy       Lopez                     N          3.0            4.0        1946.0             GUATEMALA                 Roy.Lopez@a5mlm7zgMGJPyY.com               None          11088.00\n6   AAAAAAAAABCHDAAA                     Erika                                 Y          NaN            NaN           NaN                                                                                  None           3789.72\n7   AAAAAAAAABHCEAAA          Ms.         Nina       Cable                     Y          4.0            4.0        1960.0           TIMOR-LESTE                 Nina.Cable@P9pRkLxopmrVn.com               None           3586.20\n8   AAAAAAAAABIABAAA          Dr.                                                        12.0            6.0           NaN                 ITALY                                                            None           1905.25\n9   AAAAAAAAABIEDAAA          Mr.         John        Dyer                     N          4.0            8.0        1950.0            MONTENEGRO                 John.Dyer@UayFfsP2bKRnLH.edu               None           6145.20\n10  AAAAAAAAABIOGAAA         Miss      Yolanda      Cortez                     N          7.0            6.0        1980.0                  MALI          Yolanda.Cortez@I55j1uvYR6JeLF3i.edu               None           2273.04\n11  AAAAAAAAABKGEAAA          Mr.         Eric    Benjamin                     N          4.0            9.0        1934.0               ARMENIA                 Eric.Benjamin@ArG5GUOL3q.edu               None           2689.32\n12  AAAAAAAAABKOFAAA          Mr.      Cameron      Wilson                     Y          4.0           10.0        1934.0        NORFOLK ISLAND          Cameron.Wilson@x2teUyYIMPDOh9Oe.org               None           1652.31\n13  AAAAAAAAABKOFAAA          Mr.      Cameron      Wilson                     Y          4.0           10.0        1934.0        NORFOLK ISLAND          Cameron.Wilson@x2teUyYIMPDOh9Oe.org               None           4473.84\n14  AAAAAAAAABLOEAAA          Dr.      Kenneth        Mack                     N          4.0            7.0        1953.0         FAROE ISLANDS             Kenneth.Mack@Xi70nTXvXExiLFp.org               None           2148.00\n15  AAAAAAAAABMGHAAA          Dr.       Julian      Jensen                     N         28.0            6.0        1944.0  NETHERLANDS ANTILLES          Julian.Jensen@kvV6LokbutMlOJ1dB.com               None           2092.72\n...*/"
    }
]