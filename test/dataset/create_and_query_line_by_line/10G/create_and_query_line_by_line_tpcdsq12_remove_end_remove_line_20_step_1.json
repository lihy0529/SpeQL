[
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id, i_item_desc, i_category, i_class, i_current_price, sum(ws_ext_sales_price) as itemrevenue ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over (partition by i_class) as revenueratio\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_7\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY_COL_8\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS_COL_9\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE_COL_10\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE_COL_11\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO_COL_12\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_7\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY_COL_8\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS_COL_9\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE_COL_10\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE_COL_11\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO_COL_12\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_7\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY_COL_8\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS_COL_9\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE_COL_10\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE_COL_11\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO_COL_12\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere 1=1  \ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.343512,
                    "execution_time": 0.193998,
                    "compile_time": 0.000653,
                    "planning_time": 0.047375,
                    "create_size": 680
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.581488,
                    "execution_time": 0.195702,
                    "compile_time": 0.157256,
                    "planning_time": 0.122314,
                    "create_size": 680
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_1\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                               i_item_desc   i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAADFMIAAAA                                                                                                                                                                                                  Never mi  Electronics  portable             1.12    424488.52        0.3871\n1   AAAAAAAACNEGBAAA                              Hands withdraw en route both metropolitan days; fundamental designs make still even appropriate polls. Runs tell eyebrows. Moves must suit customs. Theories should not trac  Electronics  portable             7.63    262400.18        0.2393\n2   AAAAAAAAAHGKAAAA                                                                                                                                                                               Single pupils should show e  Electronics  portable             4.74    285695.13        0.2605\n3   AAAAAAAADBMMAAAA       More present years support realistically grateful versions. Entire stairs watch widely powers. At length general friends will not go years. Criminal sales can help roles. Large, independent weeks  Electronics  portable             8.88    474451.28        0.4326\n4   AAAAAAAAMFAPAAAA                                                                        Harsh, quiet groups browse definitely official, changing titles. Recent, live children could need in the patterns. Responsible mot  Electronics  portable             4.08    264915.03        0.2416\n5   AAAAAAAABGIBAAAA                                                                                                                            Very services would tell. Model weeks fight most. Public, rough experiments un  Electronics  portable             5.65    399150.63        0.3640\n6   AAAAAAAAAKCHBAAA                                                                                                                                                                                                      Minu  Electronics  portable             0.53    190999.32        0.1741\n7   AAAAAAAABCPNAAAA                                               Things reject clearly quickly individual colours. Courts may touch often children. All whole interviews come further for the benefits. Human attempts enabl  Electronics  portable             0.65    395931.80        0.3610\n8   AAAAAAAABEPBBAAA                                      Markets talk never warm, long readers. Other provisions shall complete again towards a responses; consistent fears used to allow now; due employers let new bits. Sh  Electronics  portable             7.81    276815.45        0.2524\n9   AAAAAAAAKMECAAAA                                                                                                                               Years ought to change perhaps neighbouring issues. Cultures regard most pot  Electronics  portable             6.35    141435.16        0.1289\n10  AAAAAAAACJELAAAA  Too able governments shall not commit unfortunately new responsibilities. Permanent americans work however other banks. Old, high tories shall explain even children. Later large-scale sales come. Othe  Electronics  portable             1.81    223181.35        0.2035\n11  AAAAAAAAKMGHAAAA                                                                                   Geographical, ideal industries see there among a units. Universities stay to the bills. Precise, great others try free,  Electronics  portable             7.45    176133.66        0.1606\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018692,
                    "execution_time": 0.007123,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.00514
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058606,
                    "execution_time": 0.00795,
                    "compile_time": 6e-05,
                    "planning_time": 0.041163
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_1\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                               i_item_desc   i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAADFMIAAAA                                                                                                                                                                                                  Never mi  Electronics  portable             1.12    424488.52        0.3871\n1   AAAAAAAACNEGBAAA                              Hands withdraw en route both metropolitan days; fundamental designs make still even appropriate polls. Runs tell eyebrows. Moves must suit customs. Theories should not trac  Electronics  portable             7.63    262400.18        0.2393\n2   AAAAAAAAAHGKAAAA                                                                                                                                                                               Single pupils should show e  Electronics  portable             4.74    285695.13        0.2605\n3   AAAAAAAADBMMAAAA       More present years support realistically grateful versions. Entire stairs watch widely powers. At length general friends will not go years. Criminal sales can help roles. Large, independent weeks  Electronics  portable             8.88    474451.28        0.4326\n4   AAAAAAAAMFAPAAAA                                                                        Harsh, quiet groups browse definitely official, changing titles. Recent, live children could need in the patterns. Responsible mot  Electronics  portable             4.08    264915.03        0.2416\n5   AAAAAAAABGIBAAAA                                                                                                                            Very services would tell. Model weeks fight most. Public, rough experiments un  Electronics  portable             5.65    399150.63        0.3640\n6   AAAAAAAAAKCHBAAA                                                                                                                                                                                                      Minu  Electronics  portable             0.53    190999.32        0.1741\n7   AAAAAAAABCPNAAAA                                               Things reject clearly quickly individual colours. Courts may touch often children. All whole interviews come further for the benefits. Human attempts enabl  Electronics  portable             0.65    395931.80        0.3610\n8   AAAAAAAABEPBBAAA                                      Markets talk never warm, long readers. Other provisions shall complete again towards a responses; consistent fears used to allow now; due employers let new bits. Sh  Electronics  portable             7.81    276815.45        0.2524\n9   AAAAAAAAKMECAAAA                                                                                                                               Years ought to change perhaps neighbouring issues. Cultures regard most pot  Electronics  portable             6.35    141435.16        0.1289\n10  AAAAAAAACJELAAAA  Too able governments shall not commit unfortunately new responsibilities. Permanent americans work however other banks. Old, high tories shall explain even children. Later large-scale sales come. Othe  Electronics  portable             1.81    223181.35        0.2035\n11  AAAAAAAAKMGHAAAA                                                                                   Geographical, ideal industries see there among a units. Universities stay to the bills. Precise, great others try free,  Electronics  portable             7.45    176133.66        0.1606\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) and cast('2001-07-29' as date) \ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2001-07-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2001-07-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.223907,
                    "execution_time": 0.081617,
                    "compile_time": 0.027967,
                    "planning_time": 0.058335,
                    "create_size": 680
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.897855,
                    "execution_time": 0.083852,
                    "compile_time": 11.62452,
                    "planning_time": 0.124657,
                    "create_size": 680
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_2\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                         i_item_desc i_category        i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAKHLMAAAA                                                                                                                                                                                       Recently usef    Jewelry  semi-precious             9.90      1676.88        0.1746\n1   AAAAAAAAFLJDAAAA                                                                                                                                                                                      Countries coul    Jewelry  semi-precious             4.07       402.48        0.0419\n2   AAAAAAAACLNMAAAA                                                                                      Different feet work thus following eyes. Once again economic decisions cannot benefit just unfair, material pr    Jewelry  semi-precious            18.77      5109.87        0.5323\n3   AAAAAAAANLGEAAAA                                                                                                                              Increasing levels achieve appropriate, religious heroes. Just scottish    Jewelry  semi-precious            19.49      9062.93        0.9441\n4   AAAAAAAADPIOAAAA                                                                                     Yet holy shareholders ought to find accordingly. Methods support exactly urgent components; formally wide plans    Jewelry  semi-precious             4.46     21346.92        2.2239\n5   AAAAAAAAKFDNAAAA  Too particular years focus groups. Tensions must understand later to a publishers. Following proceedings seek surely domestic, open representatives; as trying parts tell steps. Personal, wooden     Jewelry  semi-precious             4.01      3893.36        0.4056\n6   AAAAAAAACGPIAAAA                                                                                                                                                          Also economic patients shrug new, afraid p    Jewelry  semi-precious             7.72       995.30        0.1036\n7   AAAAAAAAHFEAAAAA                                                                                                                               Fine, right provinces take pretty. Unknown, regular events notice fro    Jewelry  semi-precious             4.13     10122.13        1.0545\n8   AAAAAAAACAHLAAAA       Other consequences avoid probably interestingly small agencies. About severe faces conserve delicate, fresh projects; inc individuals ought to show black pp.. Private, increased policemen s    Jewelry  semi-precious             0.27      3069.53        0.3197\n9   AAAAAAAADOKABAAA                             Slow, international generations let partly low companies. New, able workers should think well back minutes; etc old teachers seem. Single seats should go as well for t    Jewelry  semi-precious             9.51      5522.06        0.5752\n10  AAAAAAAAHEABBAAA                                                                                                                                                           Sophisticated, confident reasons look tod    Jewelry  semi-precious             4.42       152.64        0.0159\n11  AAAAAAAAIONBBAAA                                                                                                          Both big equations cannot join on a bills. Much comfortable powers say earlier new, large     Jewelry  semi-precious             0.71      1727.97        0.1800\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018614,
                    "execution_time": 0.006979,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.005175
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056605,
                    "execution_time": 0.007507,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.041007
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST('2001-07-29' AS DATE) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_2\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                         i_item_desc i_category        i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAKHLMAAAA                                                                                                                                                                                       Recently usef    Jewelry  semi-precious             9.90      1676.88        0.1746\n1   AAAAAAAAFLJDAAAA                                                                                                                                                                                      Countries coul    Jewelry  semi-precious             4.07       402.48        0.0419\n2   AAAAAAAACLNMAAAA                                                                                      Different feet work thus following eyes. Once again economic decisions cannot benefit just unfair, material pr    Jewelry  semi-precious            18.77      5109.87        0.5323\n3   AAAAAAAANLGEAAAA                                                                                                                              Increasing levels achieve appropriate, religious heroes. Just scottish    Jewelry  semi-precious            19.49      9062.93        0.9441\n4   AAAAAAAADPIOAAAA                                                                                     Yet holy shareholders ought to find accordingly. Methods support exactly urgent components; formally wide plans    Jewelry  semi-precious             4.46     21346.92        2.2239\n5   AAAAAAAAKFDNAAAA  Too particular years focus groups. Tensions must understand later to a publishers. Following proceedings seek surely domestic, open representatives; as trying parts tell steps. Personal, wooden     Jewelry  semi-precious             4.01      3893.36        0.4056\n6   AAAAAAAACGPIAAAA                                                                                                                                                          Also economic patients shrug new, afraid p    Jewelry  semi-precious             7.72       995.30        0.1036\n7   AAAAAAAAHFEAAAAA                                                                                                                               Fine, right provinces take pretty. Unknown, regular events notice fro    Jewelry  semi-precious             4.13     10122.13        1.0545\n8   AAAAAAAACAHLAAAA       Other consequences avoid probably interestingly small agencies. About severe faces conserve delicate, fresh projects; inc individuals ought to show black pp.. Private, increased policemen s    Jewelry  semi-precious             0.27      3069.53        0.3197\n9   AAAAAAAADOKABAAA                             Slow, international generations let partly low companies. New, able workers should think well back minutes; etc old teachers seem. Single seats should go as well for t    Jewelry  semi-precious             9.51      5522.06        0.5752\n10  AAAAAAAAHEABBAAA                                                                                                                                                           Sophisticated, confident reasons look tod    Jewelry  semi-precious             4.42       152.64        0.0159\n11  AAAAAAAAIONBBAAA                                                                                                          Both big equations cannot join on a bills. Much comfortable powers say earlier new, large     Jewelry  semi-precious             0.71      1727.97        0.1800\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                             i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAMCCBAAAA                 Doors need generally plants; a bit experimental forces see here only ready operators; so-called hands can work already between a types. Particularly male schools would not ask more na  Electronics  cameras             9.81       362.08        0.0319\n1   AAAAAAAAKFNGAAAA                                                                       Democratic forms could come constant, other resources. Social, large thoughts raise again similar thanks; prices assess. As speci  Electronics  cameras             6.95      4724.28        0.4169\n2   AAAAAAAALCCKAAAA                                                                                                                                                               Historical, human systems can respond too  Electronics  cameras            87.46       944.58        0.0833\n3   AAAAAAAAEMLLAAAA        Legal, famous lips take almost. Real, young girls would not keep etc men. Little, old decisions appeal kindly bad others. Still trying resources sound all interested pages. As general women ou  Electronics  cameras             2.91        19.24        0.0016\n4   AAAAAAAAKELFBAAA                                                                                                                  Windows stand widely very pictures. Real answers cannot run once more extraordinary da  Electronics  cameras             2.30      3394.16        0.2995\n5   AAAAAAAAHEJOAAAA                                                                                                                                                                                                Limited   Electronics  cameras            50.24      7258.90        0.6406\n6   AAAAAAAAMMECBAAA                                                                                        National, great properties could not abandon lost words. Walls care only other, rapid authorities. Ladies answer  Electronics  cameras             0.78      5192.39        0.4582\n7   AAAAAAAAPADGBAAA                                                                                                                                                   Palestinian, human conflicts get thick despite the vo  Electronics  cameras             5.28       861.44        0.0760\n8   AAAAAAAAHFEGAAAA                                                                 Labour pensioners might say presently certain banks. Previous, national tests like. Natural, maximum savings would attempt slightly wor  Electronics  cameras             2.23     12811.48        1.1307\n9   AAAAAAAACAGIAAAA                          Legal schemes keep personal, male factors. Generally perfect rats see. Games support difficulties. Capable, early ministers make off a pupils. Fast, public hands can render.   Electronics  cameras             4.89      3349.11        0.2955\n10  AAAAAAAANKDCAAAA                                                                Half original organisations allocate quite earnings. Either political parts might prove quite; statutory factors walk both new influence  Electronics  cameras             3.89      5860.38        0.5172\n11  AAAAAAAACFCFAAAA  Never important workers attempt equal devices. Sure friends explore a little only common magazines. Precious policies create by a legs; individual, current needs make problems. Extra committees cann  Electronics  cameras             0.09      1477.76        0.1304\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.094888,
                    "execution_time": 0.032649,
                    "compile_time": 0.000294,
                    "planning_time": 0.04498
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.169603,
                    "execution_time": 0.03298,
                    "compile_time": 0.000297,
                    "planning_time": 0.116398
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                             i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAMCCBAAAA                 Doors need generally plants; a bit experimental forces see here only ready operators; so-called hands can work already between a types. Particularly male schools would not ask more na  Electronics  cameras             9.81       362.08        0.0319\n1   AAAAAAAAKFNGAAAA                                                                       Democratic forms could come constant, other resources. Social, large thoughts raise again similar thanks; prices assess. As speci  Electronics  cameras             6.95      4724.28        0.4169\n2   AAAAAAAALCCKAAAA                                                                                                                                                               Historical, human systems can respond too  Electronics  cameras            87.46       944.58        0.0833\n3   AAAAAAAAEMLLAAAA        Legal, famous lips take almost. Real, young girls would not keep etc men. Little, old decisions appeal kindly bad others. Still trying resources sound all interested pages. As general women ou  Electronics  cameras             2.91        19.24        0.0016\n4   AAAAAAAAKELFBAAA                                                                                                                  Windows stand widely very pictures. Real answers cannot run once more extraordinary da  Electronics  cameras             2.30      3394.16        0.2995\n5   AAAAAAAAHEJOAAAA                                                                                                                                                                                                Limited   Electronics  cameras            50.24      7258.90        0.6406\n6   AAAAAAAAMMECBAAA                                                                                        National, great properties could not abandon lost words. Walls care only other, rapid authorities. Ladies answer  Electronics  cameras             0.78      5192.39        0.4582\n7   AAAAAAAAPADGBAAA                                                                                                                                                   Palestinian, human conflicts get thick despite the vo  Electronics  cameras             5.28       861.44        0.0760\n8   AAAAAAAAHFEGAAAA                                                                 Labour pensioners might say presently certain banks. Previous, national tests like. Natural, maximum savings would attempt slightly wor  Electronics  cameras             2.23     12811.48        1.1307\n9   AAAAAAAACAGIAAAA                          Legal schemes keep personal, male factors. Generally perfect rats see. Games support difficulties. Capable, early ministers make off a pupils. Fast, public hands can render.   Electronics  cameras             4.89      3349.11        0.2955\n10  AAAAAAAANKDCAAAA                                                                Half original organisations allocate quite earnings. Either political parts might prove quite; statutory factors walk both new influence  Electronics  cameras             3.89      5860.38        0.5172\n11  AAAAAAAACFCFAAAA  Never important workers attempt equal devices. Sure friends explore a little only common magazines. Precious policies create by a legs; individual, current needs make problems. Extra committees cann  Electronics  cameras             0.09      1477.76        0.1304\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \ni_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                              i_item_desc i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAANOMNAAAA                                                                     Simply other notes look alone ways. Entries include all tropical members. Able, social characteristics offer constan    Jewelry  diamonds             9.47      1928.52        0.1681\n1   AAAAAAAACDONAAAA  Old women break by the girls. Free animals find bare plans. African years could not like silent, practical dogs. Forward large profits would know only, military transactions. Police u    Jewelry  diamonds             4.59      1518.60        0.1323\n2   AAAAAAAABCHAAAAA                                                                                             Companies describe nationally chief, close hands. For instance opposite brothers play fairly    Jewelry  diamonds             2.98       980.95        0.0855\n3   AAAAAAAAFBNDAAAA                                                                                                                                   Estimated cases take. More nice police could go. Vario    Jewelry  diamonds             5.02      2569.16        0.2239\n4   AAAAAAAAEGLEAAAA                                                                                                                                                     Orders shall win cases; possible nee    Jewelry  diamonds             9.77     11071.95        0.9651\n5   AAAAAAAANCLIAAAA                         National officers confirm often. Girls tell terms. Simple, front directors will offer by a others. Excellent, free changes reproduce members; psychiatric, unemp    Jewelry  diamonds             1.54      4570.31        0.3984\n6   AAAAAAAAFMPIAAAA                                                                                                                             Various aims speak for the women. Beaches must imply. Diffic    Jewelry  diamonds             5.23      3215.20        0.2802\n7   AAAAAAAAGMBDBAAA                                                                                                                     Finally likely services must determine so specific texts. Suddenly f    Jewelry  diamonds             0.73      2686.05        0.2341\n8   AAAAAAAAOHMNAAAA                                                                         Base, other fragments read underlying houses; just old residents will find only european, labour objects. Maximu    Jewelry  diamonds             7.06      6136.55        0.5349\n9   AAAAAAAAPLDEBAAA                                     Producers buy sharply parents. Fixed targets get true, black requirements. Different, concerned purposes send already judicial comments. Bad, other     Jewelry  diamonds             3.82      1823.29        0.1589\n10  AAAAAAAAOGDDAAAA          Open blue farmers reach useful, old arrangements. American, short years reach now tender, heavy neighbours. Now top boundaries would not enable emotions. Effectively specific     Jewelry  diamonds             3.79      4950.24        0.4315\n11  AAAAAAAAGOLEAAAA                                                                                                                              Increases shall not prepare real effects. Indeed proud engi    Jewelry  diamonds             5.57      2108.90        0.1838\n12  AAAAAAAAEJLEAAAA      Certain, developing instruments ought to refer. Sites could make so to the periods. Days must cut shortly permanent drugs; very aware patterns must resolve heavily obvious years.     Jewelry  diamonds             1.71      1498.14        0.1305\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.092997,
                    "execution_time": 0.031433,
                    "compile_time": 0.000299,
                    "planning_time": 0.044765
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.099553,
                    "execution_time": 0.035176,
                    "compile_time": 0.000298,
                    "planning_time": 0.047053
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                              i_item_desc i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAANOMNAAAA                                                                     Simply other notes look alone ways. Entries include all tropical members. Able, social characteristics offer constan    Jewelry  diamonds             9.47      1928.52        0.1681\n1   AAAAAAAACDONAAAA  Old women break by the girls. Free animals find bare plans. African years could not like silent, practical dogs. Forward large profits would know only, military transactions. Police u    Jewelry  diamonds             4.59      1518.60        0.1323\n2   AAAAAAAABCHAAAAA                                                                                             Companies describe nationally chief, close hands. For instance opposite brothers play fairly    Jewelry  diamonds             2.98       980.95        0.0855\n3   AAAAAAAAFBNDAAAA                                                                                                                                   Estimated cases take. More nice police could go. Vario    Jewelry  diamonds             5.02      2569.16        0.2239\n4   AAAAAAAAEGLEAAAA                                                                                                                                                     Orders shall win cases; possible nee    Jewelry  diamonds             9.77     11071.95        0.9651\n5   AAAAAAAANCLIAAAA                         National officers confirm often. Girls tell terms. Simple, front directors will offer by a others. Excellent, free changes reproduce members; psychiatric, unemp    Jewelry  diamonds             1.54      4570.31        0.3984\n6   AAAAAAAAFMPIAAAA                                                                                                                             Various aims speak for the women. Beaches must imply. Diffic    Jewelry  diamonds             5.23      3215.20        0.2802\n7   AAAAAAAAGMBDBAAA                                                                                                                     Finally likely services must determine so specific texts. Suddenly f    Jewelry  diamonds             0.73      2686.05        0.2341\n8   AAAAAAAAOHMNAAAA                                                                         Base, other fragments read underlying houses; just old residents will find only european, labour objects. Maximu    Jewelry  diamonds             7.06      6136.55        0.5349\n9   AAAAAAAAPLDEBAAA                                     Producers buy sharply parents. Fixed targets get true, black requirements. Different, concerned purposes send already judicial comments. Bad, other     Jewelry  diamonds             3.82      1823.29        0.1589\n10  AAAAAAAAOGDDAAAA          Open blue farmers reach useful, old arrangements. American, short years reach now tender, heavy neighbours. Now top boundaries would not enable emotions. Effectively specific     Jewelry  diamonds             3.79      4950.24        0.4315\n11  AAAAAAAAGOLEAAAA                                                                                                                              Increases shall not prepare real effects. Indeed proud engi    Jewelry  diamonds             5.57      2108.90        0.1838\n12  AAAAAAAAEJLEAAAA      Certain, developing instruments ought to refer. Sites could make so to the periods. Days must cut shortly permanent drugs; very aware patterns must resolve heavily obvious years.     Jewelry  diamonds             1.71      1498.14        0.1305\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id, i_item_desc, i_category, i_class, i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                              i_item_desc i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAHAIEAAAA                                                                                   Forward unable directors could face cases. Theories cannot explain employers. Local, impressive men ought to perform g    Jewelry  diamonds             2.01      3194.39        0.2784\n1   AAAAAAAAGPLGAAAA                                                                                                                                                           Most golden arms survive about months. Loans f    Jewelry  diamonds             3.43      8250.19        0.7191\n2   AAAAAAAAJPJGBAAA                                                                                                                                                                              Technical, hot effects lear    Jewelry  diamonds             6.16       759.96        0.0662\n3   AAAAAAAAABADAAAA                                                                                                                                           Different, national statements tell now solar, typical strings    Jewelry  diamonds             0.59      5120.95        0.4464\n4   AAAAAAAAFFHIAAAA                                                        Branches will alter best indeed good boys; too specific languages used to review however. French, close others find short, military worlds. Forma    Jewelry  diamonds             1.73     16189.94        1.4112\n5   AAAAAAAAMFMJAAAA                                  New hands could not allow by a boys. As different cultures sleep far whole, equal pubs; other, alone police might not see quickly months. New minutes should not plan b    Jewelry  diamonds             3.05      2842.53        0.2477\n6   AAAAAAAAKLPEBAAA                                                                                                                                              Long essential months could need important reasons. Subject    Jewelry  diamonds             8.22        49.21        0.0042\n7   AAAAAAAAJICPAAAA                                                                                                          Together royal activities must imply most by a regulations. Usual members would say slightly li    Jewelry  diamonds             4.69        17.00        0.0014\n8   AAAAAAAAEHJLAAAA                                                                                                                         As harsh years shall turn short forth american variables. Particularly american     Jewelry  diamonds             2.32      2560.92        0.2232\n9   AAAAAAAAOCHOAAAA                                                                                         Americans would not play conditions. Young lights suggest already far other stages. So changing jews used to get    Jewelry  diamonds             0.15      7128.62        0.6214\n10  AAAAAAAAANPDBAAA                               Parents remind over ways. Exclusively various foreigners shall not lose quite modern, dear issues. Soon red successes arise only simple parties. Future customers must say    Jewelry  diamonds             0.34       986.10        0.0859\n11  AAAAAAAAKLNBAAAA                                                                                                                                                             Old centres tour. Big, traditional restauran    Jewelry  diamonds             0.99      3474.90        0.3029\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.093686,
                    "execution_time": 0.030764,
                    "compile_time": 0.000305,
                    "planning_time": 0.044641
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.095193,
                    "execution_time": 0.031492,
                    "compile_time": 0.000338,
                    "planning_time": 0.045473
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                              i_item_desc i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAHAIEAAAA                                                                                   Forward unable directors could face cases. Theories cannot explain employers. Local, impressive men ought to perform g    Jewelry  diamonds             2.01      3194.39        0.2784\n1   AAAAAAAAGPLGAAAA                                                                                                                                                           Most golden arms survive about months. Loans f    Jewelry  diamonds             3.43      8250.19        0.7191\n2   AAAAAAAAJPJGBAAA                                                                                                                                                                              Technical, hot effects lear    Jewelry  diamonds             6.16       759.96        0.0662\n3   AAAAAAAAABADAAAA                                                                                                                                           Different, national statements tell now solar, typical strings    Jewelry  diamonds             0.59      5120.95        0.4464\n4   AAAAAAAAFFHIAAAA                                                        Branches will alter best indeed good boys; too specific languages used to review however. French, close others find short, military worlds. Forma    Jewelry  diamonds             1.73     16189.94        1.4112\n5   AAAAAAAAMFMJAAAA                                  New hands could not allow by a boys. As different cultures sleep far whole, equal pubs; other, alone police might not see quickly months. New minutes should not plan b    Jewelry  diamonds             3.05      2842.53        0.2477\n6   AAAAAAAAKLPEBAAA                                                                                                                                              Long essential months could need important reasons. Subject    Jewelry  diamonds             8.22        49.21        0.0042\n7   AAAAAAAAJICPAAAA                                                                                                          Together royal activities must imply most by a regulations. Usual members would say slightly li    Jewelry  diamonds             4.69        17.00        0.0014\n8   AAAAAAAAEHJLAAAA                                                                                                                         As harsh years shall turn short forth american variables. Particularly american     Jewelry  diamonds             2.32      2560.92        0.2232\n9   AAAAAAAAOCHOAAAA                                                                                         Americans would not play conditions. Young lights suggest already far other stages. So changing jews used to get    Jewelry  diamonds             0.15      7128.62        0.6214\n10  AAAAAAAAANPDBAAA                               Parents remind over ways. Exclusively various foreigners shall not lose quite modern, dear issues. Soon red successes arise only simple parties. Future customers must say    Jewelry  diamonds             0.34       986.10        0.0859\n11  AAAAAAAAKLNBAAAA                                                                                                                                                             Old centres tour. Big, traditional restauran    Jewelry  diamonds             0.99      3474.90        0.3029\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                          i_item_desc i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAONPHAAAA                                                                                                                               Technologies change in a moments. Also invisible factors should estima    Jewelry  diamonds             3.84     25369.97        2.2115\n1   AAAAAAAADIFMAAAA                     Average, anxious days can make clearly with a implications. Current children know so working, high dogs; good prisons need even long, new shoulders. Dangerous systems know in a    Jewelry  diamonds             3.41       475.58        0.0414\n2   AAAAAAAAENAFAAAA                                                        More particular figures would laugh front waves. German girls ought to stop close difficult, difficult streets. Genuine, orange ministers sho    Jewelry  diamonds             4.00       175.37        0.0152\n3   AAAAAAAAHEFMAAAA                                                        There original countries could tell relatively obvious new votes. Very blue activities find worthwhile, civil writers. Tory, nasty bishops ca    Jewelry  diamonds             1.62       222.00        0.0193\n4   AAAAAAAABGEFAAAA                                                          Full, unable hours find days. Employers meet explicitly to a views. Inappropriate hours must see downstairs popular decisions. Short, extra    Jewelry  diamonds             4.96       217.40        0.0189\n5   AAAAAAAAPCCDAAAA                                                                                                                    Structural men solve so very, ready families. Wrong questions might not acknowled    Jewelry  diamonds             3.80       243.60        0.0212\n6   AAAAAAAAIFOLAAAA                                                                                                                                                                                                    C    Jewelry  diamonds             0.84      1785.24        0.1556\n7   AAAAAAAAAEPJAAAA                                                                          Teachers realise outside marine years. Applications would clean notes. Diplomatic experiences can see nevertheless open fea    Jewelry  diamonds             2.51       483.80        0.0421\n8   AAAAAAAAPEFABAAA                                                                                                  Important, prime partners can check at least subject tons. Children fall evident workers. Deep, isl    Jewelry  diamonds            76.29      2858.89        0.2492\n9   AAAAAAAAGGLFBAAA                                                                                                                                                                                      Too private nig    Jewelry  diamonds             1.64        36.09        0.0031\n10  AAAAAAAABFOCAAAA                                                                                                                                                       Separate techniques go great, legal items. Bri    Jewelry  diamonds             1.23      1763.98        0.1537\n11  AAAAAAAAEBGMAAAA                                                        Thus other children shall look urban, other practices. Deep prizes could carry on a minutes. Strong times provide never in a rooms. Perhaps s    Jewelry  diamonds             0.70      1366.20        0.1190\n12  AAAAAAAAKPEPAAAA                                                                                                             Different, comparative sentences meet from a conservatives. Literary years get more real    Jewelry  diamonds            47.11       149.05        0.0129\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.090997,
                    "execution_time": 0.030371,
                    "compile_time": 0.000314,
                    "planning_time": 0.04327
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.090721,
                    "execution_time": 0.030673,
                    "compile_time": 0.000289,
                    "planning_time": 0.0432
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                          i_item_desc i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAONPHAAAA                                                                                                                               Technologies change in a moments. Also invisible factors should estima    Jewelry  diamonds             3.84     25369.97        2.2115\n1   AAAAAAAADIFMAAAA                     Average, anxious days can make clearly with a implications. Current children know so working, high dogs; good prisons need even long, new shoulders. Dangerous systems know in a    Jewelry  diamonds             3.41       475.58        0.0414\n2   AAAAAAAAENAFAAAA                                                        More particular figures would laugh front waves. German girls ought to stop close difficult, difficult streets. Genuine, orange ministers sho    Jewelry  diamonds             4.00       175.37        0.0152\n3   AAAAAAAAHEFMAAAA                                                        There original countries could tell relatively obvious new votes. Very blue activities find worthwhile, civil writers. Tory, nasty bishops ca    Jewelry  diamonds             1.62       222.00        0.0193\n4   AAAAAAAABGEFAAAA                                                          Full, unable hours find days. Employers meet explicitly to a views. Inappropriate hours must see downstairs popular decisions. Short, extra    Jewelry  diamonds             4.96       217.40        0.0189\n5   AAAAAAAAPCCDAAAA                                                                                                                    Structural men solve so very, ready families. Wrong questions might not acknowled    Jewelry  diamonds             3.80       243.60        0.0212\n6   AAAAAAAAIFOLAAAA                                                                                                                                                                                                    C    Jewelry  diamonds             0.84      1785.24        0.1556\n7   AAAAAAAAAEPJAAAA                                                                          Teachers realise outside marine years. Applications would clean notes. Diplomatic experiences can see nevertheless open fea    Jewelry  diamonds             2.51       483.80        0.0421\n8   AAAAAAAAPEFABAAA                                                                                                  Important, prime partners can check at least subject tons. Children fall evident workers. Deep, isl    Jewelry  diamonds            76.29      2858.89        0.2492\n9   AAAAAAAAGGLFBAAA                                                                                                                                                                                      Too private nig    Jewelry  diamonds             1.64        36.09        0.0031\n10  AAAAAAAABFOCAAAA                                                                                                                                                       Separate techniques go great, legal items. Bri    Jewelry  diamonds             1.23      1763.98        0.1537\n11  AAAAAAAAEBGMAAAA                                                        Thus other children shall look urban, other practices. Deep prizes could carry on a minutes. Strong times provide never in a rooms. Perhaps s    Jewelry  diamonds             0.70      1366.20        0.1190\n12  AAAAAAAAKPEPAAAA                                                                                                             Different, comparative sentences meet from a conservatives. Literary years get more real    Jewelry  diamonds            47.11       149.05        0.0129\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category,\n        i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                             i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAADAHFBAAA                                                                                                                                                                                              Important   Electronics  cameras             7.77       721.77        0.0637\n1   AAAAAAAADIKHAAAA                                                         As responsible institutions shall not limit nevertheless poor substantial changes. Official, other drinks will not go clearly about a occasions  Electronics  cameras             0.21     11799.94        1.0414\n2   AAAAAAAANLCIAAAA                                                                                                                                               Economic, remote sides shall see about the relationships;  Electronics  cameras             8.00      6110.40        0.5393\n3   AAAAAAAAALPCBAAA                                                                                                                                                       More parliamentary persons matter. Parents reduce  Electronics  cameras             8.13       943.04        0.0832\n4   AAAAAAAAAJLFAAAA  Personal, other laws rank there so new beings. Active sections estimate widely perfect police. Managers would take please bad friends. Reasonable, recent charts sacrifice either. Current items ought  Electronics  cameras             1.05       448.00        0.0395\n5   AAAAAAAADABMAAAA                                                                                                                                                                   Please able followers measure difficu  Electronics  cameras             0.90      8417.56        0.7429\n6   AAAAAAAAJJFFAAAA            Social sums could not see more local, new weeks. Statistically main cities used to get fair; categories focus operations. Permanently proper points bring. Formal bottles attribute physical  Electronics  cameras             1.17     22272.79        1.9658\n7   AAAAAAAACNFDAAAA                                                                                                                                                                                     Again incredible ri  Electronics  cameras             9.70      1687.53        0.1489\n8   AAAAAAAAEHLEAAAA                                                                                                                      Big, good girls look yesterday. Powerful, extensive schools help instead in order   Electronics  cameras             1.99      8275.25        0.7303\n9   AAAAAAAAOPAJAAAA                                                                                                                                       Scots will not hang children. Long groups should not need also ol  Electronics  cameras             2.57      5980.99        0.5278\n10  AAAAAAAAEGPKAAAA                                                Sentences can walk to a roots. Right costs remain away. Mad chapters cannot absorb so relations. Dry individuals might trust then only decisive patients  Electronics  cameras             1.27      2032.05        0.1793\n11  AAAAAAAAKLEKAAAA                                                                                                                                         Reports could keep. Services form so in a homes; emissions will  Electronics  cameras             2.19       397.68        0.0350\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.092837,
                    "execution_time": 0.031942,
                    "compile_time": 0.000293,
                    "planning_time": 0.043837
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.089347,
                    "execution_time": 0.03026,
                    "compile_time": 0.000312,
                    "planning_time": 0.041872
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                             i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAADAHFBAAA                                                                                                                                                                                              Important   Electronics  cameras             7.77       721.77        0.0637\n1   AAAAAAAADIKHAAAA                                                         As responsible institutions shall not limit nevertheless poor substantial changes. Official, other drinks will not go clearly about a occasions  Electronics  cameras             0.21     11799.94        1.0414\n2   AAAAAAAANLCIAAAA                                                                                                                                               Economic, remote sides shall see about the relationships;  Electronics  cameras             8.00      6110.40        0.5393\n3   AAAAAAAAALPCBAAA                                                                                                                                                       More parliamentary persons matter. Parents reduce  Electronics  cameras             8.13       943.04        0.0832\n4   AAAAAAAAAJLFAAAA  Personal, other laws rank there so new beings. Active sections estimate widely perfect police. Managers would take please bad friends. Reasonable, recent charts sacrifice either. Current items ought  Electronics  cameras             1.05       448.00        0.0395\n5   AAAAAAAADABMAAAA                                                                                                                                                                   Please able followers measure difficu  Electronics  cameras             0.90      8417.56        0.7429\n6   AAAAAAAAJJFFAAAA            Social sums could not see more local, new weeks. Statistically main cities used to get fair; categories focus operations. Permanently proper points bring. Formal bottles attribute physical  Electronics  cameras             1.17     22272.79        1.9658\n7   AAAAAAAACNFDAAAA                                                                                                                                                                                     Again incredible ri  Electronics  cameras             9.70      1687.53        0.1489\n8   AAAAAAAAEHLEAAAA                                                                                                                      Big, good girls look yesterday. Powerful, extensive schools help instead in order   Electronics  cameras             1.99      8275.25        0.7303\n9   AAAAAAAAOPAJAAAA                                                                                                                                       Scots will not hang children. Long groups should not need also ol  Electronics  cameras             2.57      5980.99        0.5278\n10  AAAAAAAAEGPKAAAA                                                Sentences can walk to a roots. Right costs remain away. Mad chapters cannot absorb so relations. Dry individuals might trust then only decisive patients  Electronics  cameras             1.27      2032.05        0.1793\n11  AAAAAAAAKLEKAAAA                                                                                                                                         Reports could keep. Services form so in a homes; emissions will  Electronics  cameras             2.19       397.68        0.0350\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price \n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                      i_item_desc i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAEHBLAAAA                                                                                                                                              Only other voices could not understand facilities.     Jewelry  diamonds             0.71      7646.76        0.6665\n1   AAAAAAAALLINAAAA                                                                                                                    Hard hundreds used to affect perhaps active seeds; arms persuade variations.     Jewelry  diamonds             4.93        99.74        0.0086\n2   AAAAAAAAKFIBBAAA                                                                                                                                   Areas reach historical feet. Social, deep proposals create sho    Jewelry  diamonds             7.01     15744.23        1.3724\n3   AAAAAAAAEJLEAAAA              Certain, developing instruments ought to refer. Sites could make so to the periods. Days must cut shortly permanent drugs; very aware patterns must resolve heavily obvious years.     Jewelry  diamonds             1.71      1498.14        0.1305\n4   AAAAAAAALMGOAAAA                                                                                                                               Good states must not earn too for example following standards; so     Jewelry  diamonds             2.59     11582.18        1.0096\n5   AAAAAAAAEMIHBAAA                                                       National games may not request over into a persons; formal, new modules would get just only video-taped friends. Serious weeks could not l    Jewelry  diamonds             1.85       238.70        0.0208\n6   AAAAAAAAACMAAAAA                                      For instance similar theories ought to go at a schemes. Always political children may not hold enough blind regular hands. Minutes will know with a trades;    Jewelry  diamonds             5.75      3319.11        0.2893\n7   AAAAAAAAIBMCAAAA                                              Today new rates help little relevant rights; regardless romantic directions will vote in a facilities. Very bright feet may come definitely old, le    Jewelry  diamonds             3.63      1121.76        0.0977\n8   AAAAAAAAEGPAAAAA                                                         Candidates make conventional centres; advisory, subject parts can miss correct, small times. Words think else other, urban products. Gra    Jewelry  diamonds             4.70      2175.57        0.1896\n9   AAAAAAAAIJAFAAAA                                                                                                                                                      Traditional, legal pieces can send low; inc    Jewelry  diamonds             7.23      1659.14        0.1446\n10  AAAAAAAAPALOAAAA                                                                                            Attractive, reasonable days start actually in a structures; detailed, encouraging buildings help viol    Jewelry  diamonds             4.19      1487.13        0.1296\n11  AAAAAAAABJKEBAAA                                                                                                                              As wrong travellers exercise. Distant, foreign flowers make of cour    Jewelry  diamonds             3.87      4491.63        0.3915\n12  AAAAAAAAMFAFBAAA                Fast, vague aspects could make so precise years. Different, cultural operators must not produce together human requirements; today raw teams should prove actually hot added play    Jewelry  diamonds            97.06      3414.29        0.2976\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.093588,
                    "execution_time": 0.034068,
                    "compile_time": 0.000273,
                    "planning_time": 0.04302
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.0925,
                    "execution_time": 0.031907,
                    "compile_time": 0.000279,
                    "planning_time": 0.04393
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                      i_item_desc i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAEHBLAAAA                                                                                                                                              Only other voices could not understand facilities.     Jewelry  diamonds             0.71      7646.76        0.6665\n1   AAAAAAAALLINAAAA                                                                                                                    Hard hundreds used to affect perhaps active seeds; arms persuade variations.     Jewelry  diamonds             4.93        99.74        0.0086\n2   AAAAAAAAKFIBBAAA                                                                                                                                   Areas reach historical feet. Social, deep proposals create sho    Jewelry  diamonds             7.01     15744.23        1.3724\n3   AAAAAAAAEJLEAAAA              Certain, developing instruments ought to refer. Sites could make so to the periods. Days must cut shortly permanent drugs; very aware patterns must resolve heavily obvious years.     Jewelry  diamonds             1.71      1498.14        0.1305\n4   AAAAAAAALMGOAAAA                                                                                                                               Good states must not earn too for example following standards; so     Jewelry  diamonds             2.59     11582.18        1.0096\n5   AAAAAAAAEMIHBAAA                                                       National games may not request over into a persons; formal, new modules would get just only video-taped friends. Serious weeks could not l    Jewelry  diamonds             1.85       238.70        0.0208\n6   AAAAAAAAACMAAAAA                                      For instance similar theories ought to go at a schemes. Always political children may not hold enough blind regular hands. Minutes will know with a trades;    Jewelry  diamonds             5.75      3319.11        0.2893\n7   AAAAAAAAIBMCAAAA                                              Today new rates help little relevant rights; regardless romantic directions will vote in a facilities. Very bright feet may come definitely old, le    Jewelry  diamonds             3.63      1121.76        0.0977\n8   AAAAAAAAEGPAAAAA                                                         Candidates make conventional centres; advisory, subject parts can miss correct, small times. Words think else other, urban products. Gra    Jewelry  diamonds             4.70      2175.57        0.1896\n9   AAAAAAAAIJAFAAAA                                                                                                                                                      Traditional, legal pieces can send low; inc    Jewelry  diamonds             7.23      1659.14        0.1446\n10  AAAAAAAAPALOAAAA                                                                                            Attractive, reasonable days start actually in a structures; detailed, encouraging buildings help viol    Jewelry  diamonds             4.19      1487.13        0.1296\n11  AAAAAAAABJKEBAAA                                                                                                                              As wrong travellers exercise. Distant, foreign flowers make of cour    Jewelry  diamonds             3.87      4491.63        0.3915\n12  AAAAAAAAMFAFBAAA                Fast, vague aspects could make so precise years. Different, cultural operators must not produce together human requirements; today raw teams should prove actually hot added play    Jewelry  diamonds            97.06      3414.29        0.2976\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                            i_item_desc i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAIPHHAAAA                                                                                Only, nuclear phrases could not move banks. Once again labour discussions sit also interested, patient     Jewelry  diamonds             7.67      2137.70        0.1863\n1   AAAAAAAAIHJIAAAA                                                                                                                                                              Months shall not wish mos    Jewelry  diamonds             4.54       453.20        0.0395\n2   AAAAAAAAKMCBAAAA  Then current women would scream here american floors; wholly final feet can live onto a minerals. Women find months. Great, poor services may not confirm into a children; underlying    Jewelry  diamonds             4.81      8699.67        0.7583\n3   AAAAAAAAIGAPAAAA                        Separate resources know loans. Both following interactions divert wrong proper, social writers; white workers used to serve nevertheless. Dry, compulsory state    Jewelry  diamonds             0.74      7573.77        0.6602\n4   AAAAAAAAKCGBAAAA                 Men save largely statutory, practical eyes. Wooden, additional men enquire perhaps so right years. National children answer separately fierce protests; young, reasona    Jewelry  diamonds             3.17      1447.60        0.1261\n5   AAAAAAAAJIALAAAA                                                                                                     Good trends like about a sums. Dry, influential conditions should compare uneasily    Jewelry  diamonds             3.06     15945.24        1.3899\n6   AAAAAAAAFNGABAAA                                                                                                                                                      Urban, primary affairs may not wa    Jewelry  diamonds             0.41      1040.50        0.0907\n7   AAAAAAAAGHGDBAAA                                                         High, full women pay categories; exact, military ministers will handle already. Public positions control clearly to a women. H    Jewelry  diamonds             5.18      4432.44        0.3863\n8   AAAAAAAAGIOEAAAA                                                                     Journals must not go quite horizontal corners. Then anonymous causes might not imagine in a designers. Decades tak    Jewelry  diamonds             9.13      3908.99        0.3407\n9   AAAAAAAABDFABAAA                       Instead heavy soldiers will say too forever small programmes. Real, other wings note thereby living motives. Sufficiently right shoulders get finally below good    Jewelry  diamonds             9.87      3910.82        0.3409\n10  AAAAAAAAOOCEBAAA                                                      Anyway happy democrats may define tonight sole, physical weeks. Together clear objects spend home selective horses. Days buy reli    Jewelry  diamonds             2.36      5585.02        0.4868\n11  AAAAAAAALCPFBAAA                                                                                                                                                               Visitors will not contro    Jewelry  diamonds             9.84      4325.84        0.3770\n12  AAAAAAAAIEGBAAAA                                                                                                        Roman, conventional dogs used to help even tightly english pictures. Clear days    Jewelry  diamonds             1.85      8537.86        0.7442\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.09325,
                    "execution_time": 0.0311,
                    "compile_time": 0.000293,
                    "planning_time": 0.043653
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.090852,
                    "execution_time": 0.030897,
                    "compile_time": 0.000284,
                    "planning_time": 0.042806
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                            i_item_desc i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAIPHHAAAA                                                                                Only, nuclear phrases could not move banks. Once again labour discussions sit also interested, patient     Jewelry  diamonds             7.67      2137.70        0.1863\n1   AAAAAAAAIHJIAAAA                                                                                                                                                              Months shall not wish mos    Jewelry  diamonds             4.54       453.20        0.0395\n2   AAAAAAAAKMCBAAAA  Then current women would scream here american floors; wholly final feet can live onto a minerals. Women find months. Great, poor services may not confirm into a children; underlying    Jewelry  diamonds             4.81      8699.67        0.7583\n3   AAAAAAAAIGAPAAAA                        Separate resources know loans. Both following interactions divert wrong proper, social writers; white workers used to serve nevertheless. Dry, compulsory state    Jewelry  diamonds             0.74      7573.77        0.6602\n4   AAAAAAAAKCGBAAAA                 Men save largely statutory, practical eyes. Wooden, additional men enquire perhaps so right years. National children answer separately fierce protests; young, reasona    Jewelry  diamonds             3.17      1447.60        0.1261\n5   AAAAAAAAJIALAAAA                                                                                                     Good trends like about a sums. Dry, influential conditions should compare uneasily    Jewelry  diamonds             3.06     15945.24        1.3899\n6   AAAAAAAAFNGABAAA                                                                                                                                                      Urban, primary affairs may not wa    Jewelry  diamonds             0.41      1040.50        0.0907\n7   AAAAAAAAGHGDBAAA                                                         High, full women pay categories; exact, military ministers will handle already. Public positions control clearly to a women. H    Jewelry  diamonds             5.18      4432.44        0.3863\n8   AAAAAAAAGIOEAAAA                                                                     Journals must not go quite horizontal corners. Then anonymous causes might not imagine in a designers. Decades tak    Jewelry  diamonds             9.13      3908.99        0.3407\n9   AAAAAAAABDFABAAA                       Instead heavy soldiers will say too forever small programmes. Real, other wings note thereby living motives. Sufficiently right shoulders get finally below good    Jewelry  diamonds             9.87      3910.82        0.3409\n10  AAAAAAAAOOCEBAAA                                                      Anyway happy democrats may define tonight sole, physical weeks. Together clear objects spend home selective horses. Days buy reli    Jewelry  diamonds             2.36      5585.02        0.4868\n11  AAAAAAAALCPFBAAA                                                                                                                                                               Visitors will not contro    Jewelry  diamonds             9.84      4325.84        0.3770\n12  AAAAAAAAIEGBAAAA                                                                                                        Roman, conventional dogs used to help even tightly english pictures. Clear days    Jewelry  diamonds             1.85      8537.86        0.7442\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \nrevenueratio /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"REVENUERATIO\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY REVENUERATIO NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                            i_item_desc   i_category       i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAACMDOAAAA                                                                                                      Sweet minds cannot feel bloody wide mothers. Sometimes appropriate unions could remind main, posi  Electronics       cameras             4.54         0.00           0.0\n1   AAAAAAAAEKFDAAAA          Galleries must come closely instead objective supporters. Communications act slowly mainly british words. Nuclear, aware options ought to put even important weeks. Green, simple hundreds me  Electronics      scanners             5.65         0.00           0.0\n2   AAAAAAAAOPDCAAAA                                                                                                                      Especially local thousands withdraw as workers. Else direct teams renew long indu        Shoes          kids             8.40         2.12           0.0\n3   AAAAAAAAOFBCBAAA                                                                               Conditions shall stir new police; private, national others remain from a journals. Unions must like in a sources. Differ      Jewelry  loose stones             6.06         0.00           0.0\n4   AAAAAAAAGLAPAAAA                                                                          Please apparent sites should blame drily rural offices; further organisational days start. Civil, black companies curb possib  Electronics      personal             3.74         0.00           0.0\n5   AAAAAAAAMCNFAAAA                                          Councils can come working, prime days. Costs should not ban both years. Early objectives find too only other pictures. Patterns maintain in a events. Still w        Shoes          kids             8.62         0.00           0.0\n6   AAAAAAAAOFAIBAAA                                                                                                                                                                                             Yet availa      Jewelry  loose stones            94.95         0.00           0.0\n7   AAAAAAAAOCGHAAAA                                                                                                                                                                                     Comparative jeans   Electronics        karoke             3.28         0.00           0.0\n8   AAAAAAAALEIBBAAA  Reduced attacks may think as. Operations ought to cross exceptional, only practices. Events may allow political, high women. Bars should not keep constantly different ladies. However following cups  Electronics    automotive             7.24         0.00           0.0\n9   AAAAAAAAOKHABAAA                                                                                                                                                                                                 Probab      Jewelry         rings             7.20         0.00           0.0\n10  AAAAAAAAKFGBBAAA                                                                                                                                                       Whole, territorial eyes will go coldly criminal,  Electronics        karoke             7.80         0.00           0.0\n11  AAAAAAAAEOFCAAAA                                                                                                                                                                                                      N  Electronics      portable             5.77         0.00           0.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.138321,
                    "execution_time": 0.039183,
                    "compile_time": 0.036608,
                    "planning_time": 0.045576
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.655172,
                    "execution_time": 0.038566,
                    "compile_time": 3.483591,
                    "planning_time": 0.112308
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"REVENUERATIO\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                            i_item_desc   i_category       i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAACMDOAAAA                                                                                                      Sweet minds cannot feel bloody wide mothers. Sometimes appropriate unions could remind main, posi  Electronics       cameras             4.54         0.00           0.0\n1   AAAAAAAAEKFDAAAA          Galleries must come closely instead objective supporters. Communications act slowly mainly british words. Nuclear, aware options ought to put even important weeks. Green, simple hundreds me  Electronics      scanners             5.65         0.00           0.0\n2   AAAAAAAAOPDCAAAA                                                                                                                      Especially local thousands withdraw as workers. Else direct teams renew long indu        Shoes          kids             8.40         2.12           0.0\n3   AAAAAAAAOFBCBAAA                                                                               Conditions shall stir new police; private, national others remain from a journals. Unions must like in a sources. Differ      Jewelry  loose stones             6.06         0.00           0.0\n4   AAAAAAAAGLAPAAAA                                                                          Please apparent sites should blame drily rural offices; further organisational days start. Civil, black companies curb possib  Electronics      personal             3.74         0.00           0.0\n5   AAAAAAAAMCNFAAAA                                          Councils can come working, prime days. Costs should not ban both years. Early objectives find too only other pictures. Patterns maintain in a events. Still w        Shoes          kids             8.62         0.00           0.0\n6   AAAAAAAAOFAIBAAA                                                                                                                                                                                             Yet availa      Jewelry  loose stones            94.95         0.00           0.0\n7   AAAAAAAAOCGHAAAA                                                                                                                                                                                     Comparative jeans   Electronics        karoke             3.28         0.00           0.0\n8   AAAAAAAALEIBBAAA  Reduced attacks may think as. Operations ought to cross exceptional, only practices. Events may allow political, high women. Bars should not keep constantly different ladies. However following cups  Electronics    automotive             7.24         0.00           0.0\n9   AAAAAAAAOKHABAAA                                                                                                                                                                                                 Probab      Jewelry         rings             7.20         0.00           0.0\n10  AAAAAAAAKFGBBAAA                                                                                                                                                       Whole, territorial eyes will go coldly criminal,  Electronics        karoke             7.80         0.00           0.0\n11  AAAAAAAAEOFCAAAA                                                                                                                                                                                                      N  Electronics      portable             5.77         0.00           0.0\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                       i_item_desc   i_category     i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAJEJFBAAA                                                                                                               Alone firm officers must not seem enough wooden, active designs. Leaves may show in  Electronics     cameras            61.81       501.12        0.0442\n1   AAAAAAAACKHJAAAA                                                                                                                                                                                            Consid  Electronics  automotive             1.26     10065.05        1.0307\n2   AAAAAAAAGJCCAAAA                                                                                                             Often professional centres work in a hands. Also sufficient years shall become even c  Electronics      karoke             3.71      2476.74        0.2201\n3   AAAAAAAAMCCBAAAA           Doors need generally plants; a bit experimental forces see here only ready operators; so-called hands can work already between a types. Particularly male schools would not ask more na  Electronics     cameras             9.81       362.08        0.0319\n4   AAAAAAAAKLBDAAAA                                            Just various prices will not look furthermore maybe supreme women. Years hear somewhere from a reports. New components cannot charge as. Interests imp  Electronics  automotive             0.30     10210.47        1.0456\n5   AAAAAAAAPPJNAAAA                                                                                                                                                                              Public, certain copi  Electronics      karoke             9.62      8564.25        0.7613\n6   AAAAAAAAHEJOAAAA                                                                                                                                                                                          Limited   Electronics     cameras            50.24      7258.90        0.6406\n7   AAAAAAAAEELKAAAA                                                                                                                                                                          Open colours will die mo  Electronics  automotive             4.84      7339.89        0.7516\n8   AAAAAAAACHLMAAAA                                           Following, possible features take to a states; responsible, great exchanges fit yesterday left priorities. Applications keep workers. Holy efforts work  Electronics      karoke             4.74      2967.70        0.2638\n9   AAAAAAAAMMECBAAA                                                                                  National, great properties could not abandon lost words. Walls care only other, rapid authorities. Ladies answer  Electronics     cameras             0.78      5192.39        0.4582\n10  AAAAAAAAKELGAAAA                          Subsequent industries shall face never healthy, great units. Needs shall not resign within a hands. Difficult, old peoples used to touch desperate, ready passengers; be  Electronics  automotive             0.31      3614.12        0.3701\n11  AAAAAAAAKFGHAAAA                                                                                                                                                                   Therefore likely eyes would not  Electronics      karoke            48.86      7788.00        0.6923\n12  AAAAAAAAEMLLAAAA  Legal, famous lips take almost. Real, young girls would not keep etc men. Little, old decisions appeal kindly bad others. Still trying resources sound all interested pages. As general women ou  Electronics     cameras             2.91        19.24        0.0016\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.091928,
                    "execution_time": 0.031647,
                    "compile_time": 0.00032,
                    "planning_time": 0.043248
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.162962,
                    "execution_time": 0.033059,
                    "compile_time": 0.00036,
                    "planning_time": 0.111048
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                       i_item_desc   i_category     i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAJEJFBAAA                                                                                                               Alone firm officers must not seem enough wooden, active designs. Leaves may show in  Electronics     cameras            61.81       501.12        0.0442\n1   AAAAAAAACKHJAAAA                                                                                                                                                                                            Consid  Electronics  automotive             1.26     10065.05        1.0307\n2   AAAAAAAAGJCCAAAA                                                                                                             Often professional centres work in a hands. Also sufficient years shall become even c  Electronics      karoke             3.71      2476.74        0.2201\n3   AAAAAAAAMCCBAAAA           Doors need generally plants; a bit experimental forces see here only ready operators; so-called hands can work already between a types. Particularly male schools would not ask more na  Electronics     cameras             9.81       362.08        0.0319\n4   AAAAAAAAKLBDAAAA                                            Just various prices will not look furthermore maybe supreme women. Years hear somewhere from a reports. New components cannot charge as. Interests imp  Electronics  automotive             0.30     10210.47        1.0456\n5   AAAAAAAAPPJNAAAA                                                                                                                                                                              Public, certain copi  Electronics      karoke             9.62      8564.25        0.7613\n6   AAAAAAAAHEJOAAAA                                                                                                                                                                                          Limited   Electronics     cameras            50.24      7258.90        0.6406\n7   AAAAAAAAEELKAAAA                                                                                                                                                                          Open colours will die mo  Electronics  automotive             4.84      7339.89        0.7516\n8   AAAAAAAACHLMAAAA                                           Following, possible features take to a states; responsible, great exchanges fit yesterday left priorities. Applications keep workers. Holy efforts work  Electronics      karoke             4.74      2967.70        0.2638\n9   AAAAAAAAMMECBAAA                                                                                  National, great properties could not abandon lost words. Walls care only other, rapid authorities. Ladies answer  Electronics     cameras             0.78      5192.39        0.4582\n10  AAAAAAAAKELGAAAA                          Subsequent industries shall face never healthy, great units. Needs shall not resign within a hands. Difficult, old peoples used to touch desperate, ready passengers; be  Electronics  automotive             0.31      3614.12        0.3701\n11  AAAAAAAAKFGHAAAA                                                                                                                                                                   Therefore likely eyes would not  Electronics      karoke            48.86      7788.00        0.6923\n12  AAAAAAAAEMLLAAAA  Legal, famous lips take almost. Real, young girls would not keep etc men. Little, old decisions appeal kindly bad others. Still trying resources sound all interested pages. As general women ou  Electronics     cameras             2.91        19.24        0.0016\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                  i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGGJFAAAA                                                          Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85      4987.33       20.7407\n1   AAAAAAAAHPDFBAAA                                                                                                                                                                                               Electronics                     1.24      7508.45       31.2253\n2   AAAAAAAAGHJJAAAA                                                                                                                                                                                               Electronics                      NaN      2049.60        8.5236\n3   AAAAAAAAHGMPAAAA                                                        Available, large values prepare in a words; directly careful symptoms must know obviously here financial reports. Ministers ought to   Electronics   audio             5.29      2507.93        0.2057\n4   AAAAAAAAAINOAAAA                                                                                                                   Others help also. Simply potential services can achieve for a contribution  Electronics   audio             5.30       161.08        0.0132\n5   AAAAAAAAGLHBBAAA                                                                                                      Then practical animals take more officially external games. Elements could end then oth  Electronics   audio             1.72     21999.33        1.8045\n6   AAAAAAAAKJOEBAAA                                                                         Plants increase constantly partial teachers. Able, ambitious letters might run medical laws. Students may feed in a   Electronics   audio             6.59     19222.00        1.5767\n7   AAAAAAAAEABAAAAA                                                                                                     Guidelines might spot at least organic, big artists. Detailed carers might debate olympi  Electronics   audio             3.14       484.20        0.0397\n8   AAAAAAAAEPOFAAAA                                                                                                                               Regions wish here enough classical things. As natural windows   Electronics   audio             3.47     11474.28        0.9411\n9   AAAAAAAAIEIIAAAA                                                                                       Philosophical, real streets raise at all moving men. White, deep injuries think then black institution  Electronics   audio             0.33       364.72        0.0299\n10  AAAAAAAAAFBDBAAA     Later psychological friends produce ever. Anywhere central companies protest again capital relationships. Months can suggest fully specific names. Necessary, gentle operators could imp  Electronics   audio             0.33      7520.99        0.6169\n11  AAAAAAAAIOCHAAAA                                                               Years would not marry children. Grateful, new organisations raise soon good, involved dogs. Users shall mean again thereby loc  Electronics   audio             1.03       800.15        0.0656\n12  AAAAAAAAADPEAAAA                                                   Meetings give triumphantly left systems. British, base aspects belong well forms. At least new communities cease clearly. Presidential rai  Electronics   audio             2.68      2504.88        0.2054\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.094323,
                    "execution_time": 0.032978,
                    "compile_time": 0.000312,
                    "planning_time": 0.04446
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.168762,
                    "execution_time": 0.038268,
                    "compile_time": 0.000338,
                    "planning_time": 0.113426
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                  i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGGJFAAAA                                                          Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85      4987.33       20.7407\n1   AAAAAAAAHPDFBAAA                                                                                                                                                                                               Electronics                     1.24      7508.45       31.2253\n2   AAAAAAAAGHJJAAAA                                                                                                                                                                                               Electronics                      NaN      2049.60        8.5236\n3   AAAAAAAAHGMPAAAA                                                        Available, large values prepare in a words; directly careful symptoms must know obviously here financial reports. Ministers ought to   Electronics   audio             5.29      2507.93        0.2057\n4   AAAAAAAAAINOAAAA                                                                                                                   Others help also. Simply potential services can achieve for a contribution  Electronics   audio             5.30       161.08        0.0132\n5   AAAAAAAAGLHBBAAA                                                                                                      Then practical animals take more officially external games. Elements could end then oth  Electronics   audio             1.72     21999.33        1.8045\n6   AAAAAAAAKJOEBAAA                                                                         Plants increase constantly partial teachers. Able, ambitious letters might run medical laws. Students may feed in a   Electronics   audio             6.59     19222.00        1.5767\n7   AAAAAAAAEABAAAAA                                                                                                     Guidelines might spot at least organic, big artists. Detailed carers might debate olympi  Electronics   audio             3.14       484.20        0.0397\n8   AAAAAAAAEPOFAAAA                                                                                                                               Regions wish here enough classical things. As natural windows   Electronics   audio             3.47     11474.28        0.9411\n9   AAAAAAAAIEIIAAAA                                                                                       Philosophical, real streets raise at all moving men. White, deep injuries think then black institution  Electronics   audio             0.33       364.72        0.0299\n10  AAAAAAAAAFBDBAAA     Later psychological friends produce ever. Anywhere central companies protest again capital relationships. Months can suggest fully specific names. Necessary, gentle operators could imp  Electronics   audio             0.33      7520.99        0.6169\n11  AAAAAAAAIOCHAAAA                                                               Years would not marry children. Grateful, new organisations raise soon good, involved dogs. Users shall mean again thereby loc  Electronics   audio             1.03       800.15        0.0656\n12  AAAAAAAAADPEAAAA                                                   Meetings give triumphantly left systems. British, base aspects belong well forms. At least new communities cease clearly. Presidential rai  Electronics   audio             2.68      2504.88        0.2054\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                               i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGGJFAAAA                                                       Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85      4987.33       20.7407\n1   AAAAAAAAGHJJAAAA                                                                                                                                                                                            Electronics                      NaN      2049.60        8.5236\n2   AAAAAAAAHPDFBAAA                                                                                                                                                                                            Electronics                     1.24      7508.45       31.2253\n3   AAAAAAAAABKEBAAA                                                                                                                            Current, active churches get all in a years. Vitally british d  Electronics   audio             8.99      2913.30        0.2389\n4   AAAAAAAAABKMAAAA                                             Pupils run even arts. Domestic weeks ought to operate only aspects; champions load; areas bring however wonderful, financial dimensions. Too   Electronics   audio             3.04       127.47        0.0104\n5   AAAAAAAAABOHAAAA                                               Individual, sensitive things punish anyway. Tables shall make like a years. Outer, main applications will start; dogs ought to indicate fre  Electronics   audio             1.58      5249.26        0.4305\n6   AAAAAAAAACGGAAAA                                                                                                                                                                                         M  Electronics   audio             8.72       618.21        0.0507\n7   AAAAAAAAADDLAAAA                                                           Then public patients come in a workers. Everywhere royal groups may leave american, elderly units. As easy cases would use. Rel  Electronics   audio             2.78        45.54        0.0037\n8   AAAAAAAAADFPAAAA                                   Scales find even wild issues. Dominant functions cannot refine still to a aims. Grounds should travel once welcome aspirations. Conservative achievemen  Electronics   audio             1.80      2656.40        0.2178\n9   AAAAAAAAADMGBAAA                        Similar, regional facts would not change remaining, english problems. Of course wise children sit much top items. Officials ought to hear all chosen brothers. Ind  Electronics   audio             5.61     16206.36        1.3293\n10  AAAAAAAAADPEAAAA                                                Meetings give triumphantly left systems. British, base aspects belong well forms. At least new communities cease clearly. Presidential rai  Electronics   audio             2.68      2504.88        0.2054\n11  AAAAAAAAAEELAAAA        Sisters should not want also general men. More holy terms find into a enquiries. Critical profits support problems; actively chief demands grow years. Essential, contemporary con  Electronics   audio             0.86     20180.52        1.6553\n12  AAAAAAAAAFBDBAAA  Later psychological friends produce ever. Anywhere central companies protest again capital relationships. Months can suggest fully specific names. Necessary, gentle operators could imp  Electronics   audio             0.33      7520.99        0.6169\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.091758,
                    "execution_time": 0.032101,
                    "compile_time": 0.00031,
                    "planning_time": 0.04292
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.170609,
                    "execution_time": 0.032795,
                    "compile_time": 0.000309,
                    "planning_time": 0.120911
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                               i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGGJFAAAA                                                       Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85      4987.33       20.7407\n1   AAAAAAAAGHJJAAAA                                                                                                                                                                                            Electronics                      NaN      2049.60        8.5236\n2   AAAAAAAAHPDFBAAA                                                                                                                                                                                            Electronics                     1.24      7508.45       31.2253\n3   AAAAAAAAABKEBAAA                                                                                                                            Current, active churches get all in a years. Vitally british d  Electronics   audio             8.99      2913.30        0.2389\n4   AAAAAAAAABKMAAAA                                             Pupils run even arts. Domestic weeks ought to operate only aspects; champions load; areas bring however wonderful, financial dimensions. Too   Electronics   audio             3.04       127.47        0.0104\n5   AAAAAAAAABOHAAAA                                               Individual, sensitive things punish anyway. Tables shall make like a years. Outer, main applications will start; dogs ought to indicate fre  Electronics   audio             1.58      5249.26        0.4305\n6   AAAAAAAAACGGAAAA                                                                                                                                                                                         M  Electronics   audio             8.72       618.21        0.0507\n7   AAAAAAAAADDLAAAA                                                           Then public patients come in a workers. Everywhere royal groups may leave american, elderly units. As easy cases would use. Rel  Electronics   audio             2.78        45.54        0.0037\n8   AAAAAAAAADFPAAAA                                   Scales find even wild issues. Dominant functions cannot refine still to a aims. Grounds should travel once welcome aspirations. Conservative achievemen  Electronics   audio             1.80      2656.40        0.2178\n9   AAAAAAAAADMGBAAA                        Similar, regional facts would not change remaining, english problems. Of course wise children sit much top items. Officials ought to hear all chosen brothers. Ind  Electronics   audio             5.61     16206.36        1.3293\n10  AAAAAAAAADPEAAAA                                                Meetings give triumphantly left systems. British, base aspects belong well forms. At least new communities cease clearly. Presidential rai  Electronics   audio             2.68      2504.88        0.2054\n11  AAAAAAAAAEELAAAA        Sisters should not want also general men. More holy terms find into a enquiries. Critical profits support problems; actively chief demands grow years. Essential, contemporary con  Electronics   audio             0.86     20180.52        1.6553\n12  AAAAAAAAAFBDBAAA  Later psychological friends produce ever. Anywhere central companies protest again capital relationships. Months can suggest fully specific names. Necessary, gentle operators could imp  Electronics   audio             0.33      7520.99        0.6169\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                               i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGGJFAAAA                                                       Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85      4987.33       20.7407\n1   AAAAAAAAGHJJAAAA                                                                                                                                                                                            Electronics                      NaN      2049.60        8.5236\n2   AAAAAAAAHPDFBAAA                                                                                                                                                                                            Electronics                     1.24      7508.45       31.2253\n3   AAAAAAAAABKEBAAA                                                                                                                            Current, active churches get all in a years. Vitally british d  Electronics   audio             8.99      2913.30        0.2389\n4   AAAAAAAAABKMAAAA                                             Pupils run even arts. Domestic weeks ought to operate only aspects; champions load; areas bring however wonderful, financial dimensions. Too   Electronics   audio             3.04       127.47        0.0104\n5   AAAAAAAAABOHAAAA                                               Individual, sensitive things punish anyway. Tables shall make like a years. Outer, main applications will start; dogs ought to indicate fre  Electronics   audio             1.58      5249.26        0.4305\n6   AAAAAAAAACGGAAAA                                                                                                                                                                                         M  Electronics   audio             8.72       618.21        0.0507\n7   AAAAAAAAADDLAAAA                                                           Then public patients come in a workers. Everywhere royal groups may leave american, elderly units. As easy cases would use. Rel  Electronics   audio             2.78        45.54        0.0037\n8   AAAAAAAAADFPAAAA                                   Scales find even wild issues. Dominant functions cannot refine still to a aims. Grounds should travel once welcome aspirations. Conservative achievemen  Electronics   audio             1.80      2656.40        0.2178\n9   AAAAAAAAADMGBAAA                        Similar, regional facts would not change remaining, english problems. Of course wise children sit much top items. Officials ought to hear all chosen brothers. Ind  Electronics   audio             5.61     16206.36        1.3293\n10  AAAAAAAAADPEAAAA                                                Meetings give triumphantly left systems. British, base aspects belong well forms. At least new communities cease clearly. Presidential rai  Electronics   audio             2.68      2504.88        0.2054\n11  AAAAAAAAAEELAAAA        Sisters should not want also general men. More holy terms find into a enquiries. Critical profits support problems; actively chief demands grow years. Essential, contemporary con  Electronics   audio             0.86     20180.52        1.6553\n12  AAAAAAAAAFBDBAAA  Later psychological friends produce ever. Anywhere central companies protest again capital relationships. Months can suggest fully specific names. Necessary, gentle operators could imp  Electronics   audio             0.33      7520.99        0.6169\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.096853,
                    "execution_time": 0.034695,
                    "compile_time": 0.000344,
                    "planning_time": 0.045063
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.167678,
                    "execution_time": 0.034722,
                    "compile_time": 0.000332,
                    "planning_time": 0.115866
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                               i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGGJFAAAA                                                       Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85      4987.33       20.7407\n1   AAAAAAAAGHJJAAAA                                                                                                                                                                                            Electronics                      NaN      2049.60        8.5236\n2   AAAAAAAAHPDFBAAA                                                                                                                                                                                            Electronics                     1.24      7508.45       31.2253\n3   AAAAAAAAABKEBAAA                                                                                                                            Current, active churches get all in a years. Vitally british d  Electronics   audio             8.99      2913.30        0.2389\n4   AAAAAAAAABKMAAAA                                             Pupils run even arts. Domestic weeks ought to operate only aspects; champions load; areas bring however wonderful, financial dimensions. Too   Electronics   audio             3.04       127.47        0.0104\n5   AAAAAAAAABOHAAAA                                               Individual, sensitive things punish anyway. Tables shall make like a years. Outer, main applications will start; dogs ought to indicate fre  Electronics   audio             1.58      5249.26        0.4305\n6   AAAAAAAAACGGAAAA                                                                                                                                                                                         M  Electronics   audio             8.72       618.21        0.0507\n7   AAAAAAAAADDLAAAA                                                           Then public patients come in a workers. Everywhere royal groups may leave american, elderly units. As easy cases would use. Rel  Electronics   audio             2.78        45.54        0.0037\n8   AAAAAAAAADFPAAAA                                   Scales find even wild issues. Dominant functions cannot refine still to a aims. Grounds should travel once welcome aspirations. Conservative achievemen  Electronics   audio             1.80      2656.40        0.2178\n9   AAAAAAAAADMGBAAA                        Similar, regional facts would not change remaining, english problems. Of course wise children sit much top items. Officials ought to hear all chosen brothers. Ind  Electronics   audio             5.61     16206.36        1.3293\n10  AAAAAAAAADPEAAAA                                                Meetings give triumphantly left systems. British, base aspects belong well forms. At least new communities cease clearly. Presidential rai  Electronics   audio             2.68      2504.88        0.2054\n11  AAAAAAAAAEELAAAA        Sisters should not want also general men. More holy terms find into a enquiries. Critical profits support problems; actively chief demands grow years. Essential, contemporary con  Electronics   audio             0.86     20180.52        1.6553\n12  AAAAAAAAAFBDBAAA  Later psychological friends produce ever. Anywhere central companies protest again capital relationships. Months can suggest fully specific names. Necessary, gentle operators could imp  Electronics   audio             0.33      7520.99        0.6169\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n        ,revenueratio\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST , \"REVENUERATIO\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST , REVENUERATIO NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                               i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGGJFAAAA                                                       Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85      4987.33       20.7407\n1   AAAAAAAAGHJJAAAA                                                                                                                                                                                            Electronics                      NaN      2049.60        8.5236\n2   AAAAAAAAHPDFBAAA                                                                                                                                                                                            Electronics                     1.24      7508.45       31.2253\n3   AAAAAAAAABKEBAAA                                                                                                                            Current, active churches get all in a years. Vitally british d  Electronics   audio             8.99      2913.30        0.2389\n4   AAAAAAAAABKMAAAA                                             Pupils run even arts. Domestic weeks ought to operate only aspects; champions load; areas bring however wonderful, financial dimensions. Too   Electronics   audio             3.04       127.47        0.0104\n5   AAAAAAAAABOHAAAA                                               Individual, sensitive things punish anyway. Tables shall make like a years. Outer, main applications will start; dogs ought to indicate fre  Electronics   audio             1.58      5249.26        0.4305\n6   AAAAAAAAACGGAAAA                                                                                                                                                                                         M  Electronics   audio             8.72       618.21        0.0507\n7   AAAAAAAAADDLAAAA                                                           Then public patients come in a workers. Everywhere royal groups may leave american, elderly units. As easy cases would use. Rel  Electronics   audio             2.78        45.54        0.0037\n8   AAAAAAAAADFPAAAA                                   Scales find even wild issues. Dominant functions cannot refine still to a aims. Grounds should travel once welcome aspirations. Conservative achievemen  Electronics   audio             1.80      2656.40        0.2178\n9   AAAAAAAAADMGBAAA                        Similar, regional facts would not change remaining, english problems. Of course wise children sit much top items. Officials ought to hear all chosen brothers. Ind  Electronics   audio             5.61     16206.36        1.3293\n10  AAAAAAAAADPEAAAA                                                Meetings give triumphantly left systems. British, base aspects belong well forms. At least new communities cease clearly. Presidential rai  Electronics   audio             2.68      2504.88        0.2054\n11  AAAAAAAAAEELAAAA        Sisters should not want also general men. More holy terms find into a enquiries. Critical profits support problems; actively chief demands grow years. Essential, contemporary con  Electronics   audio             0.86     20180.52        1.6553\n12  AAAAAAAAAFBDBAAA  Later psychological friends produce ever. Anywhere central companies protest again capital relationships. Months can suggest fully specific names. Necessary, gentle operators could imp  Electronics   audio             0.33      7520.99        0.6169\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.093091,
                    "execution_time": 0.032295,
                    "compile_time": 0.000316,
                    "planning_time": 0.043621
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.227172,
                    "execution_time": 0.032349,
                    "compile_time": 0.068413,
                    "planning_time": 0.109278
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST, \"REVENUERATIO\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                               i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGGJFAAAA                                                       Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85      4987.33       20.7407\n1   AAAAAAAAGHJJAAAA                                                                                                                                                                                            Electronics                      NaN      2049.60        8.5236\n2   AAAAAAAAHPDFBAAA                                                                                                                                                                                            Electronics                     1.24      7508.45       31.2253\n3   AAAAAAAAABKEBAAA                                                                                                                            Current, active churches get all in a years. Vitally british d  Electronics   audio             8.99      2913.30        0.2389\n4   AAAAAAAAABKMAAAA                                             Pupils run even arts. Domestic weeks ought to operate only aspects; champions load; areas bring however wonderful, financial dimensions. Too   Electronics   audio             3.04       127.47        0.0104\n5   AAAAAAAAABOHAAAA                                               Individual, sensitive things punish anyway. Tables shall make like a years. Outer, main applications will start; dogs ought to indicate fre  Electronics   audio             1.58      5249.26        0.4305\n6   AAAAAAAAACGGAAAA                                                                                                                                                                                         M  Electronics   audio             8.72       618.21        0.0507\n7   AAAAAAAAADDLAAAA                                                           Then public patients come in a workers. Everywhere royal groups may leave american, elderly units. As easy cases would use. Rel  Electronics   audio             2.78        45.54        0.0037\n8   AAAAAAAAADFPAAAA                                   Scales find even wild issues. Dominant functions cannot refine still to a aims. Grounds should travel once welcome aspirations. Conservative achievemen  Electronics   audio             1.80      2656.40        0.2178\n9   AAAAAAAAADMGBAAA                        Similar, regional facts would not change remaining, english problems. Of course wise children sit much top items. Officials ought to hear all chosen brothers. Ind  Electronics   audio             5.61     16206.36        1.3293\n10  AAAAAAAAADPEAAAA                                                Meetings give triumphantly left systems. British, base aspects belong well forms. At least new communities cease clearly. Presidential rai  Electronics   audio             2.68      2504.88        0.2054\n11  AAAAAAAAAEELAAAA        Sisters should not want also general men. More holy terms find into a enquiries. Critical profits support problems; actively chief demands grow years. Essential, contemporary con  Electronics   audio             0.86     20180.52        1.6553\n12  AAAAAAAAAFBDBAAA  Later psychological friends produce ever. Anywhere central companies protest again capital relationships. Months can suggest fully specific names. Necessary, gentle operators could imp  Electronics   audio             0.33      7520.99        0.6169\n...*/"
    },
    {
        "input": "-- start template query12.tpl query 64 in stream 0\nselect /* TPC-DS query12.tpl 0.64 */  i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ws_ext_sales_price) as itemrevenue \n      ,sum(ws_ext_sales_price)*100/sum(sum(ws_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tweb_sales\n    \t,item \n    \t,date_dim\nwhere \n\tws_item_sk = i_item_sk \n  \tand i_category in ('Electronics', 'Shoes', 'Jewelry')\n  \tand ws_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-06-29' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-06-29' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n        ,revenueratio\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-06-29' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST , \"REVENUERATIO\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( WS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( WS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( WS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM WEB_SALES , ITEM , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Electronics' , 'Shoes' , 'Jewelry' ) AND WS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-06-29' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-06-29' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST , REVENUERATIO NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                               i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGGJFAAAA                                                       Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85      4987.33       20.7407\n1   AAAAAAAAGHJJAAAA                                                                                                                                                                                            Electronics                      NaN      2049.60        8.5236\n2   AAAAAAAAHPDFBAAA                                                                                                                                                                                            Electronics                     1.24      7508.45       31.2253\n3   AAAAAAAAABKEBAAA                                                                                                                            Current, active churches get all in a years. Vitally british d  Electronics   audio             8.99      2913.30        0.2389\n4   AAAAAAAAABKMAAAA                                             Pupils run even arts. Domestic weeks ought to operate only aspects; champions load; areas bring however wonderful, financial dimensions. Too   Electronics   audio             3.04       127.47        0.0104\n5   AAAAAAAAABOHAAAA                                               Individual, sensitive things punish anyway. Tables shall make like a years. Outer, main applications will start; dogs ought to indicate fre  Electronics   audio             1.58      5249.26        0.4305\n6   AAAAAAAAACGGAAAA                                                                                                                                                                                         M  Electronics   audio             8.72       618.21        0.0507\n7   AAAAAAAAADDLAAAA                                                           Then public patients come in a workers. Everywhere royal groups may leave american, elderly units. As easy cases would use. Rel  Electronics   audio             2.78        45.54        0.0037\n8   AAAAAAAAADFPAAAA                                   Scales find even wild issues. Dominant functions cannot refine still to a aims. Grounds should travel once welcome aspirations. Conservative achievemen  Electronics   audio             1.80      2656.40        0.2178\n9   AAAAAAAAADMGBAAA                        Similar, regional facts would not change remaining, english problems. Of course wise children sit much top items. Officials ought to hear all chosen brothers. Ind  Electronics   audio             5.61     16206.36        1.3293\n10  AAAAAAAAADPEAAAA                                                Meetings give triumphantly left systems. British, base aspects belong well forms. At least new communities cease clearly. Presidential rai  Electronics   audio             2.68      2504.88        0.2054\n11  AAAAAAAAAEELAAAA        Sisters should not want also general men. More holy terms find into a enquiries. Critical profits support problems; actively chief demands grow years. Essential, contemporary con  Electronics   audio             0.86     20180.52        1.6553\n12  AAAAAAAAAFBDBAAA  Later psychological friends produce ever. Anywhere central companies protest again capital relationships. Months can suggest fully specific names. Necessary, gentle operators could imp  Electronics   audio             0.33      7520.99        0.6169\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.095578,
                    "execution_time": 0.033627,
                    "compile_time": 0.000372,
                    "planning_time": 0.043926
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.098732,
                    "execution_time": 0.038042,
                    "compile_time": 0.000357,
                    "planning_time": 0.043381
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"WEB_SALES\".\"WS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-06-29' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Electronics', 'Shoes', 'Jewelry') AND \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST, \"REVENUERATIO\" NULLS LAST LIMIT 100",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                               i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGGJFAAAA                                                       Practical, old conditions could put long general effects; strictly toxic positions should not drive there straight major types. Ser  Electronics                     0.85      4987.33       20.7407\n1   AAAAAAAAGHJJAAAA                                                                                                                                                                                            Electronics                      NaN      2049.60        8.5236\n2   AAAAAAAAHPDFBAAA                                                                                                                                                                                            Electronics                     1.24      7508.45       31.2253\n3   AAAAAAAAABKEBAAA                                                                                                                            Current, active churches get all in a years. Vitally british d  Electronics   audio             8.99      2913.30        0.2389\n4   AAAAAAAAABKMAAAA                                             Pupils run even arts. Domestic weeks ought to operate only aspects; champions load; areas bring however wonderful, financial dimensions. Too   Electronics   audio             3.04       127.47        0.0104\n5   AAAAAAAAABOHAAAA                                               Individual, sensitive things punish anyway. Tables shall make like a years. Outer, main applications will start; dogs ought to indicate fre  Electronics   audio             1.58      5249.26        0.4305\n6   AAAAAAAAACGGAAAA                                                                                                                                                                                         M  Electronics   audio             8.72       618.21        0.0507\n7   AAAAAAAAADDLAAAA                                                           Then public patients come in a workers. Everywhere royal groups may leave american, elderly units. As easy cases would use. Rel  Electronics   audio             2.78        45.54        0.0037\n8   AAAAAAAAADFPAAAA                                   Scales find even wild issues. Dominant functions cannot refine still to a aims. Grounds should travel once welcome aspirations. Conservative achievemen  Electronics   audio             1.80      2656.40        0.2178\n9   AAAAAAAAADMGBAAA                        Similar, regional facts would not change remaining, english problems. Of course wise children sit much top items. Officials ought to hear all chosen brothers. Ind  Electronics   audio             5.61     16206.36        1.3293\n10  AAAAAAAAADPEAAAA                                                Meetings give triumphantly left systems. British, base aspects belong well forms. At least new communities cease clearly. Presidential rai  Electronics   audio             2.68      2504.88        0.2054\n11  AAAAAAAAAEELAAAA        Sisters should not want also general men. More holy terms find into a enquiries. Critical profits support problems; actively chief demands grow years. Essential, contemporary con  Electronics   audio             0.86     20180.52        1.6553\n12  AAAAAAAAAFBDBAAA  Later psychological friends produce ever. Anywhere central companies protest again capital relationships. Months can suggest fully specific names. Necessary, gentle operators could imp  Electronics   audio             0.33      7520.99        0.6169\n...*/"
    }
]