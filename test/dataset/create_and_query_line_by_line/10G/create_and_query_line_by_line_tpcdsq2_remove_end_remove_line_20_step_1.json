[
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select ws_sold_date_sk sold_date_sk\n        ,ws_ext_sales_price sales_price\n  from  web_sales),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n from wswscs\n where wswscs.d_week_seq in (select distinct d_week_seq from date_dim)) wswscs1\n join \n (select wswscs.d_week_seq d_week_seq2\n        ,sum(sun_sales) sun_sales2\n        ,sum(mon_sales) mon_sales2\n        ,sum(tue_sales) tue_sales2\n        ,sum(wed_sales) wed_sales2\n        ,sum(thu_sales) thu_sales2\n        ,sum(fri_sales) fri_sales2\n        ,sum(sat_sales) sat_sales2\n from wswscs\n group by wswscs.d_week_seq) wswscs2\n on wswscs1.d_week_seq1 = wswscs2.d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"WSWSCS2\" AS ( SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , SUM ( \"WSWSCS\".\"SUN_SALES\" ) AS \"SUN_SALES2\" , SUM ( \"WSWSCS\".\"MON_SALES\" ) AS \"MON_SALES2\" , SUM ( \"WSWSCS\".\"TUE_SALES\" ) AS \"TUE_SALES2\" , SUM ( \"WSWSCS\".\"WED_SALES\" ) AS \"WED_SALES2\" , SUM ( \"WSWSCS\".\"THU_SALES\" ) AS \"THU_SALES2\" , SUM ( \"WSWSCS\".\"FRI_SALES\" ) AS \"FRI_SALES2\" , SUM ( \"WSWSCS\".\"SAT_SALES\" ) AS \"SAT_SALES2\" FROM \"WSWSCS\" AS \"WSWSCS\" GROUP BY \"WSWSCS\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS2\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS2\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS2\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS2\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS2\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS2\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS2\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" JOIN \"WSWSCS2\" AS \"WSWSCS2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS2\".\"D_WEEK_SEQ2\" WHERE NOT \"_U_0\".\"D_WEEK_SEQ\" IS NULL"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.161453,
                    "execution_time": 0.089847,
                    "compile_time": 0.000356,
                    "planning_time": 0.039058,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.210188,
                    "execution_time": 0.100244,
                    "compile_time": 0.00037,
                    "planning_time": 0.040158,
                    "create_size": 1232
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT DISTINCT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.084273,
                    "execution_time": 0.033448,
                    "compile_time": 0.000248,
                    "planning_time": 0.025788,
                    "create_size": 80
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.157725,
                    "execution_time": 0.034362,
                    "compile_time": 0.000242,
                    "planning_time": 0.095178,
                    "create_size": 80
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ2\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" ) AS \"SUN_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" ) AS \"MON_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" ) AS \"TUE_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" ) AS \"WED_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" ) AS \"THU_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" ) AS \"FRI_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" ) AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.090451,
                    "execution_time": 0.05842,
                    "compile_time": 0.000243,
                    "planning_time": 0.005572,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.147948,
                    "execution_time": 0.058009,
                    "compile_time": 0.000248,
                    "planning_time": 0.061842,
                    "create_size": 1232
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ2\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" IS NULL",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.119036,
                    "execution_time": 0.076043,
                    "compile_time": 0.000375,
                    "planning_time": 0.011708,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.178947,
                    "execution_time": 0.076753,
                    "compile_time": 0.000354,
                    "planning_time": 0.069794,
                    "create_size": 1232
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5302     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1          5373     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2          5130     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3          5363     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4          5321     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5          5144     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6          5247     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7          5217     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8          5296     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9          5358     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10         5139     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11         5297     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12         5250     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13         5312     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         5281     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         5207     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         5257     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         5313     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         5181     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018562,
                    "execution_time": 0.008277,
                    "compile_time": 6e-05,
                    "planning_time": 0.003911
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056203,
                    "execution_time": 0.009013,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039206
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_3\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_3\".\"D_WEEK_SEQ2\" WHERE NOT \"SPEQLITE_TEMP_TABLE_2\".\"D_WEEK_SEQ\" IS NULL",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_4\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5302     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1          5373     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2          5130     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3          5363     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4          5321     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5          5144     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6          5247     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7          5217     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8          5296     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9          5358     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10         5139     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11         5297     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12         5250     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13         5312     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         5281     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         5207     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         5257     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         5313     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         5181     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n        ,sum(sun_sales) over () sun_sales2\n        ,sum(mon_sales) over () mon_sales2\n        ,sum(tue_sales) over () tue_sales2\n        ,sum(wed_sales) over () wed_sales2\n        ,sum(thu_sales) over () thu_sales2\n        ,sum(fri_sales) over () fri_sales2\n        ,sum(sat_sales) over () sat_sales2\n  from wswscs) sub\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"SUB\" AS ( SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSWSCS\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"WSWSCS\".\"MON_SALES\" AS \"MON_SALES1\" , \"WSWSCS\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"WSWSCS\".\"WED_SALES\" AS \"WED_SALES1\" , \"WSWSCS\".\"THU_SALES\" AS \"THU_SALES1\" , \"WSWSCS\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"WSWSCS\".\"SAT_SALES\" AS \"SAT_SALES1\" , SUM ( \"WSWSCS\".\"SUN_SALES\" ) OVER ( ) AS \"SUN_SALES2\" , SUM ( \"WSWSCS\".\"MON_SALES\" ) OVER ( ) AS \"MON_SALES2\" , SUM ( \"WSWSCS\".\"TUE_SALES\" ) OVER ( ) AS \"TUE_SALES2\" , SUM ( \"WSWSCS\".\"WED_SALES\" ) OVER ( ) AS \"WED_SALES2\" , SUM ( \"WSWSCS\".\"THU_SALES\" ) OVER ( ) AS \"THU_SALES2\" , SUM ( \"WSWSCS\".\"FRI_SALES\" ) OVER ( ) AS \"FRI_SALES2\" , SUM ( \"WSWSCS\".\"SAT_SALES\" ) OVER ( ) AS \"SAT_SALES2\" FROM \"WSWSCS\" AS \"WSWSCS\" ) SELECT \"SUB\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SUB\".\"SUN_SALES1\" / \"SUB\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SUB\".\"MON_SALES1\" / \"SUB\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SUB\".\"TUE_SALES1\" / \"SUB\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SUB\".\"WED_SALES1\" / \"SUB\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SUB\".\"THU_SALES1\" / \"SUB\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SUB\".\"FRI_SALES1\" / \"SUB\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SUB\".\"SAT_SALES1\" / \"SUB\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SUB\" AS \"SUB\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.596538,
                    "execution_time": 0.352602,
                    "compile_time": 0.000274,
                    "planning_time": 0.035954,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.673672,
                    "execution_time": 0.362764,
                    "compile_time": 0.000265,
                    "planning_time": 0.096477,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"SPEQLITE_TEMP_TABLE_5\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"SPEQLITE_TEMP_TABLE_5\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"SPEQLITE_TEMP_TABLE_5\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"SPEQLITE_TEMP_TABLE_5\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"SPEQLITE_TEMP_TABLE_5\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"SPEQLITE_TEMP_TABLE_5\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"SPEQLITE_TEMP_TABLE_5\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"SPEQLITE_TEMP_TABLE_5\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.186217,
                    "execution_time": 0.121698,
                    "compile_time": 0.000334,
                    "planning_time": 0.032999,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.254274,
                    "execution_time": 0.124371,
                    "compile_time": 0.000341,
                    "planning_time": 0.096403,
                    "create_size": 1232
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"SPEQLITE_TEMP_TABLE_6\".\"MON_SALES\" AS \"MON_SALES1\" , \"SPEQLITE_TEMP_TABLE_6\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"SPEQLITE_TEMP_TABLE_6\".\"WED_SALES\" AS \"WED_SALES1\" , \"SPEQLITE_TEMP_TABLE_6\".\"THU_SALES\" AS \"THU_SALES1\" , \"SPEQLITE_TEMP_TABLE_6\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"SPEQLITE_TEMP_TABLE_6\".\"SAT_SALES\" AS \"SAT_SALES1\" , SUM ( \"SPEQLITE_TEMP_TABLE_6\".\"SUN_SALES\" ) OVER ( ) AS \"SUN_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_6\".\"MON_SALES\" ) OVER ( ) AS \"MON_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_6\".\"TUE_SALES\" ) OVER ( ) AS \"TUE_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_6\".\"WED_SALES\" ) OVER ( ) AS \"WED_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_6\".\"THU_SALES\" ) OVER ( ) AS \"THU_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_6\".\"FRI_SALES\" ) OVER ( ) AS \"FRI_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_6\".\"SAT_SALES\" ) OVER ( ) AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.081224,
                    "execution_time": 0.042502,
                    "compile_time": 0.000306,
                    "planning_time": 0.006963,
                    "create_size": 54
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.143275,
                    "execution_time": 0.043913,
                    "compile_time": 0.000326,
                    "planning_time": 0.064471,
                    "create_size": 54
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5283    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n1          5168    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n2          5176    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n3          5301    0.01    0.00    0.00    0.00    0.00    0.01    0.01\n4          5336    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n5          5223    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n6          5262    0.01    0.01    0.00    0.01    0.01    0.01    0.01\n7          5200    0.00    0.01    0.01    0.01    0.01    0.00    0.01\n8          5145    0.01    0.00    0.01    0.00    0.00    0.00    0.01\n9          5249    0.01    0.00    0.00    0.00    0.00    0.00    0.00\n10         5281    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n11         5232    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n12         5284    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n13         5144    0.00    0.01    0.00    0.00    0.00    0.00    0.00\n14         5247    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n15         5234    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n16         5285    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n17         5203    0.01    0.00    0.01    0.01    0.01    0.01    0.00\n18         5181    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021155,
                    "execution_time": 0.007732,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.006004
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.059739,
                    "execution_time": 0.008518,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.04197
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES1\" / \"SPEQLITE_TEMP_TABLE_7\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5283    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n1          5168    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n2          5176    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n3          5301    0.01    0.00    0.00    0.00    0.00    0.01    0.01\n4          5336    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n5          5223    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n6          5262    0.01    0.01    0.00    0.01    0.01    0.01    0.01\n7          5200    0.00    0.01    0.01    0.01    0.01    0.00    0.01\n8          5145    0.01    0.00    0.01    0.00    0.00    0.00    0.01\n9          5249    0.01    0.00    0.00    0.00    0.00    0.00    0.00\n10         5281    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n11         5232    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n12         5284    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n13         5144    0.00    0.01    0.00    0.00    0.00    0.00    0.00\n14         5247    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n15         5234    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n16         5285    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n17         5203    0.01    0.00    0.01    0.01    0.01    0.01    0.00\n18         5181    0.00    0.00    0.00    0.00    0.00    0.00    0.00\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n/*CURSOR_IDENTIFIER*/\n        ,sum(sun_sales) over () sun_sales2\n        ,sum(mon_sales) over () mon_sales2\n        ,sum(tue_sales) over () tue_sales2\n        ,sum(wed_sales) over () wed_sales2\n        ,sum(thu_sales) over () thu_sales2\n        ,sum(fri_sales) over () fri_sales2\n        ,sum(sat_sales) over () sat_sales2\n  from wswscs) sub",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"WSWSCS\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"WSWSCS\".\"MON_SALES\" AS \"MON_SALES1\" , \"WSWSCS\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"WSWSCS\".\"WED_SALES\" AS \"WED_SALES1\" , \"WSWSCS\".\"THU_SALES\" AS \"THU_SALES1\" , \"WSWSCS\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"WSWSCS\".\"SAT_SALES\" AS \"SAT_SALES1\" , SUM ( \"WSWSCS\".\"SUN_SALES\" ) OVER ( ) AS \"SUN_SALES2\" , SUM ( \"WSWSCS\".\"MON_SALES\" ) OVER ( ) AS \"MON_SALES2\" , SUM ( \"WSWSCS\".\"TUE_SALES\" ) OVER ( ) AS \"TUE_SALES2\" , SUM ( \"WSWSCS\".\"WED_SALES\" ) OVER ( ) AS \"WED_SALES2\" , SUM ( \"WSWSCS\".\"THU_SALES\" ) OVER ( ) AS \"THU_SALES2\" , SUM ( \"WSWSCS\".\"FRI_SALES\" ) OVER ( ) AS \"FRI_SALES2\" , SUM ( \"WSWSCS\".\"SAT_SALES\" ) OVER ( ) AS \"SAT_SALES2\" FROM \"WSWSCS\" AS \"WSWSCS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.702635,
                    "execution_time": 0.46478,
                    "compile_time": 0.000249,
                    "planning_time": 0.034439,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.703739,
                    "execution_time": 0.458625,
                    "compile_time": 0.000275,
                    "planning_time": 0.03239,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"SPEQLITE_TEMP_TABLE_8\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"SPEQLITE_TEMP_TABLE_8\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.220975,
                    "execution_time": 0.156613,
                    "compile_time": 0.000335,
                    "planning_time": 0.032509,
                    "create_size": 1243
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.289947,
                    "execution_time": 0.158366,
                    "compile_time": 0.000341,
                    "planning_time": 0.095225,
                    "create_size": 1243
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" AS \"MON_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" AS \"WED_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" AS \"THU_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" AS \"SAT_SALES1\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" ) OVER ( ) AS \"SUN_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" ) OVER ( ) AS \"MON_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" ) OVER ( ) AS \"TUE_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" ) OVER ( ) AS \"WED_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" ) OVER ( ) AS \"THU_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" ) OVER ( ) AS \"FRI_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" ) OVER ( ) AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*    d_week_seq1   sun_sales1   mon_sales1   tue_sales1   wed_sales1   thu_sales1   fri_sales1   sat_sales1    sun_sales2    mon_sales2    tue_sales2    wed_sales2    thu_sales2    fri_sales2    sat_sales2\n0          5166  17593079.17  18191244.04  58952065.38  59536870.52  60308656.01  31840351.67  37827026.90  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n1          5292  17772185.56  17548919.64  17340729.82  17477799.82  17373573.63  17499874.64  16780754.38  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n2          5215  59712159.11  59657902.33  58287235.09  61119164.89  60308476.06  59409760.42  58933145.76  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n3          5359  39202401.24  38763643.42  38877726.18  38998135.14  39803321.14  39459678.70  39909660.53  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n4          5218  38225480.92  16987570.88  61208224.58  58777037.16  61594868.55  58822599.92  30887498.48  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n5          5237  17130094.15  17546452.88  16861303.62  17714178.77  17894857.49  17807492.82  18054444.52  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n6          5120  18021089.90  17689381.59  17558776.55  17591451.35  17684717.89  16646547.65  17012205.32  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n7          5213  61417032.05  59837726.62  59246609.02  59364251.71  59907151.13  60120230.03  59977672.30  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n8          5170  17993360.33  17646775.85  16143819.74  17474667.83  18032737.39  18360594.75  17103613.46  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n9          5274  17354599.50  17566180.06  17079416.34  16669036.77  17395230.06  17059920.14  16428158.77  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n10         5151  37576246.42  39562609.99  39513806.98  38788815.89  38745126.66  39573972.94  37904550.26  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n11         5259  38634909.29  39986435.41  39614369.43  38986617.40  39037373.86  38739561.78  38835644.85  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n12         5193  16696634.74  16862987.91  16544554.79  17672729.17  17580185.53  18338816.88  16994918.91  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n13         5318  59959544.83  60130603.02  61910345.89  58493265.78  60882833.15  60041821.69  58653455.90  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n14         5157  40206909.36  54202183.07  40216659.76  38940427.26  39892868.99  40492773.87  38397949.12  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n15         5206  37892125.94  40912841.69  39789153.95  39829925.68  39889340.57  40728030.59  39871136.73  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n16         5323  17399711.51  17756266.27  30883428.63  37034167.56  17904334.62  17634340.12  17038167.95  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n17         5246  17598969.25  16983747.57  16357711.87  16405282.94  17382660.76  16637079.33  16963457.56  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.026451,
                    "execution_time": 0.010352,
                    "compile_time": 8.3e-05,
                    "planning_time": 0.007041
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.064642,
                    "execution_time": 0.010871,
                    "compile_time": 8.3e-05,
                    "planning_time": 0.043039
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" AS \"MON_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" AS \"WED_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" AS \"THU_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" AS \"SAT_SALES1\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" ) OVER ( ) AS \"SUN_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" ) OVER ( ) AS \"MON_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" ) OVER ( ) AS \"TUE_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" ) OVER ( ) AS \"WED_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" ) OVER ( ) AS \"THU_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" ) OVER ( ) AS \"FRI_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" ) OVER ( ) AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" AS \"SUN_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" AS \"MON_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" AS \"TUE_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" AS \"WED_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" AS \"THU_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" AS \"FRI_SALES1\" , \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" AS \"SAT_SALES1\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" ) OVER ( ) AS \"SUN_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" ) OVER ( ) AS \"MON_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" ) OVER ( ) AS \"TUE_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" ) OVER ( ) AS \"WED_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" ) OVER ( ) AS \"THU_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" ) OVER ( ) AS \"FRI_SALES2\" , SUM ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" ) OVER ( ) AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*    d_week_seq1   sun_sales1   mon_sales1   tue_sales1   wed_sales1   thu_sales1   fri_sales1   sat_sales1    sun_sales2    mon_sales2    tue_sales2    wed_sales2    thu_sales2    fri_sales2    sat_sales2\n0          5166  17593079.17  18191244.04  58952065.38  59536870.52  60308656.01  31840351.67  37827026.90  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n1          5292  17772185.56  17548919.64  17340729.82  17477799.82  17373573.63  17499874.64  16780754.38  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n2          5215  59712159.11  59657902.33  58287235.09  61119164.89  60308476.06  59409760.42  58933145.76  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n3          5359  39202401.24  38763643.42  38877726.18  38998135.14  39803321.14  39459678.70  39909660.53  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n4          5218  38225480.92  16987570.88  61208224.58  58777037.16  61594868.55  58822599.92  30887498.48  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n5          5237  17130094.15  17546452.88  16861303.62  17714178.77  17894857.49  17807492.82  18054444.52  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n6          5120  18021089.90  17689381.59  17558776.55  17591451.35  17684717.89  16646547.65  17012205.32  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n7          5213  61417032.05  59837726.62  59246609.02  59364251.71  59907151.13  60120230.03  59977672.30  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n8          5170  17993360.33  17646775.85  16143819.74  17474667.83  18032737.39  18360594.75  17103613.46  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n9          5274  17354599.50  17566180.06  17079416.34  16669036.77  17395230.06  17059920.14  16428158.77  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n10         5151  37576246.42  39562609.99  39513806.98  38788815.89  38745126.66  39573972.94  37904550.26  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n11         5259  38634909.29  39986435.41  39614369.43  38986617.40  39037373.86  38739561.78  38835644.85  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n12         5193  16696634.74  16862987.91  16544554.79  17672729.17  17580185.53  18338816.88  16994918.91  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n13         5318  59959544.83  60130603.02  61910345.89  58493265.78  60882833.15  60041821.69  58653455.90  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n14         5157  40206909.36  54202183.07  40216659.76  38940427.26  39892868.99  40492773.87  38397949.12  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n15         5206  37892125.94  40912841.69  39789153.95  39829925.68  39889340.57  40728030.59  39871136.73  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n16         5323  17399711.51  17756266.27  30883428.63  37034167.56  17904334.62  17634340.12  17038167.95  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n17         5246  17598969.25  16983747.57  16357711.87  16405282.94  17382660.76  16637079.33  16963457.56  7.831369e+09  7.833593e+09  7.794975e+09  7.805738e+09  7.838915e+09  7.835007e+09  7.836805e+09\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select ws_sold_date_sk sold_date_sk\n        ,ws_ext_sales_price sales_price\n  from  web_sales),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select wswscs.d_week_seq d_week_seq1\n       ,round(sun_sales/sun_sales2,2)\n       ,round(mon_sales/mon_sales2,2)\n       ,round(tue_sales/tue_sales2,2)\n       ,round(wed_sales/wed_sales2,2)\n       ,round(thu_sales/thu_sales2,2)\n       ,round(fri_sales/fri_sales2,2)\n       ,round(sat_sales/sat_sales2,2)\n from wswscs\n -- Assuming that sun_sales2, mon_sales2, etc., are supposed to be compared against some other dataset\n join (\n     select d_week_seq as week_seq2,\n            sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales2,\n            sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales2,\n            sum(case when (d_day_name='Tuesday') then sales_price else null end) tue_sales2,\n            sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales2,\n            sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales2,\n            sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales2,\n            sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales2\n      from wscs\n          ,date_dim\n      where d_date_sk = sold_date_sk\n      group by d_week_seq\n ) as other_aggregates\n on wswscs.d_week_seq = other_aggregates.week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSCS\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"WSCS\" AS \"WSCS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WSCS\".\"SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"OTHER_AGGREGATES\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"WEEK_SEQ2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WSCS\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES2\" FROM \"WSCS\" AS \"WSCS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WSCS\".\"SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"OTHER_AGGREGATES\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"OTHER_AGGREGATES\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"OTHER_AGGREGATES\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"OTHER_AGGREGATES\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"OTHER_AGGREGATES\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"OTHER_AGGREGATES\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"OTHER_AGGREGATES\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"OTHER_AGGREGATES\" AS \"OTHER_AGGREGATES\" ON \"OTHER_AGGREGATES\".\"WEEK_SEQ2\" = \"WSWSCS\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.516516,
                    "execution_time": 0.283159,
                    "compile_time": 0.00024,
                    "planning_time": 0.025693,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.573494,
                    "execution_time": 0.275334,
                    "compile_time": 0.00025,
                    "planning_time": 0.088074,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.128467,
                    "execution_time": 0.042948,
                    "compile_time": 0.000245,
                    "planning_time": 0.024235,
                    "create_size": 576
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.196215,
                    "execution_time": 0.044626,
                    "compile_time": 0.000262,
                    "planning_time": 0.086648,
                    "create_size": 576
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.139849,
                    "execution_time": 0.097602,
                    "compile_time": 0.000345,
                    "planning_time": 0.01065,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.201966,
                    "execution_time": 0.098675,
                    "compile_time": 0.000354,
                    "planning_time": 0.069239,
                    "create_size": 1232
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"WEEK_SEQ2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES2\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"SPEQLITE_TEMP_TABLE_10\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES2\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.141229,
                    "execution_time": 0.097559,
                    "compile_time": 0.000354,
                    "planning_time": 0.010867,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.19882,
                    "execution_time": 0.098227,
                    "compile_time": 0.000368,
                    "planning_time": 0.06837,
                    "create_size": 1232
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ON \"SPEQLITE_TEMP_TABLE_13\".\"WEEK_SEQ2\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.099974,
                    "execution_time": 0.064137,
                    "compile_time": 0.000271,
                    "planning_time": 0.008489,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.161024,
                    "execution_time": 0.065763,
                    "compile_time": 0.000279,
                    "planning_time": 0.066105,
                    "create_size": 1232
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5215     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1          5237     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2          5359     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3          5218     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4          5318     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5          5193     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6          5151     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7          5259     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8          5174     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9          5156     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10         5307     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11         5368     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12         5314     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13         5311     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         5292     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         5166     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         5374     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         5123     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         5239     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019681,
                    "execution_time": 0.008683,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.00418
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054278,
                    "execution_time": 0.008663,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.03915
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"SUN_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"SUN_SALES2\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"MON_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"MON_SALES2\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"TUE_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"TUE_SALES2\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"WED_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"WED_SALES2\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"THU_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"THU_SALES2\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"FRI_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"FRI_SALES2\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_12\".\"SAT_SALES\" / \"SPEQLITE_TEMP_TABLE_13\".\"SAT_SALES2\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ON \"SPEQLITE_TEMP_TABLE_13\".\"WEEK_SEQ2\" = \"SPEQLITE_TEMP_TABLE_12\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_14\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5215     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1          5237     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2          5359     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3          5218     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4          5318     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5          5193     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6          5151     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7          5259     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8          5174     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9          5156     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10         5307     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11         5368     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12         5314     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13         5311     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         5292     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         5166     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         5374     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         5123     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         5239     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2) as ratio_sun_sales\n       ,round(mon_sales1/mon_sales2,2) as ratio_mon_sales\n       ,round(tue_sales1/tue_sales2,2) as ratio_tue_sales\n       ,round(wed_sales1/wed_sales2,2) as ratio_wed_sales\n       ,round(thu_sales1/thu_sales2,2) as ratio_thu_sales\n       ,round(fri_sales1/fri_sales2,2) as ratio_fri_sales\n       ,round(sat_sales1/sat_sales2,2) as ratio_sat_sales\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs, date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq\n  ), \n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs, date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq\n )\n where d_week_seq1 = d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"RATIO_SUN_SALES\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"RATIO_MON_SALES\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"RATIO_TUE_SALES\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"RATIO_WED_SALES\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"RATIO_THU_SALES\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"RATIO_FRI_SALES\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"RATIO_SAT_SALES\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"SPEQLITE_TEMP_TABLE_11\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.077379,
                    "execution_time": 0.041541,
                    "compile_time": 0.000236,
                    "planning_time": 0.00294,
                    "create_size": 384
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.137744,
                    "execution_time": 0.043023,
                    "compile_time": 0.000239,
                    "planning_time": 0.05947,
                    "create_size": 384
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"RATIO_SUN_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"RATIO_MON_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"RATIO_TUE_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"RATIO_WED_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"RATIO_THU_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"RATIO_FRI_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"RATIO_SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.145302,
                    "execution_time": 0.076039,
                    "compile_time": 0.000449,
                    "planning_time": 0.010952,
                    "create_size": 198
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.285206,
                    "execution_time": 0.077685,
                    "compile_time": 0.076332,
                    "planning_time": 0.069429,
                    "create_size": 198
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_SUN_SALES\" AS \"RATIO_SUN_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_MON_SALES\" AS \"RATIO_MON_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_TUE_SALES\" AS \"RATIO_TUE_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_WED_SALES\" AS \"RATIO_WED_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_THU_SALES\" AS \"RATIO_THU_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_FRI_SALES\" AS \"RATIO_FRI_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_SAT_SALES\" AS \"RATIO_SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  ratio_sun_sales  ratio_mon_sales  ratio_tue_sales  ratio_wed_sales  ratio_thu_sales  ratio_fri_sales  ratio_sat_sales\n0          5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n1          5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n2          5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n3          5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n4          5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n5          5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n6          5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n7          5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n8          5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n9          5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n10         5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n11         5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n12         5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n13         5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n14         5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n15         5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n16         5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n17         5291              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n18         5291              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018313,
                    "execution_time": 0.007894,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054689,
                    "execution_time": 0.007514,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.039467
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"RATIO_SUN_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"RATIO_MON_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"RATIO_TUE_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"RATIO_WED_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"RATIO_THU_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"RATIO_FRI_SALES\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"RATIO_SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_15\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_16\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_SUN_SALES\" AS \"RATIO_SUN_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_MON_SALES\" AS \"RATIO_MON_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_TUE_SALES\" AS \"RATIO_TUE_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_WED_SALES\" AS \"RATIO_WED_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_THU_SALES\" AS \"RATIO_THU_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_FRI_SALES\" AS \"RATIO_FRI_SALES\" , \"SPEQLITE_TEMP_TABLE_16\".\"RATIO_SAT_SALES\" AS \"RATIO_SAT_SALES\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\""
            }
        ],
        "preview": "\n/*    d_week_seq1  ratio_sun_sales  ratio_mon_sales  ratio_tue_sales  ratio_wed_sales  ratio_thu_sales  ratio_fri_sales  ratio_sat_sales\n0          5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n1          5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n2          5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n3          5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n4          5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n5          5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n6          5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n7          5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n8          5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n9          5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n10         5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n11         5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n12         5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n13         5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n14         5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n15         5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n16         5290              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n17         5291              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n18         5291              1.0              1.0              1.0              1.0              1.0              1.0              1.0\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select ws_sold_date_sk sold_date_sk\n        ,ws_ext_sales_price sales_price\n  from web_sales),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs\n  where wswscs.d_week_seq IS NOT NULL) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n  where wswscs.d_week_seq IS NOT NULL) x \n where y.d_week_seq1 = x.d_week_seq2\n/*CURSOR_IDENTIFIER*/;",
        "optimize": [
            "WITH \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND NOT \"WSWSCS_2\".\"D_WEEK_SEQ\" IS NULL WHERE NOT \"WSWSCS\".\"D_WEEK_SEQ\" IS NULL"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND NOT \"WSWSCS_2\".\"D_WEEK_SEQ\" IS NULL WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" IS NULL",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.103646,
                    "execution_time": 0.065107,
                    "compile_time": 0.0003,
                    "planning_time": 0.009737,
                    "create_size": 1232
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.161076,
                    "execution_time": 0.066022,
                    "compile_time": 0.000283,
                    "planning_time": 0.067178,
                    "create_size": 1232
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5166     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1          5292     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2          5120     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3          5170     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4          5213     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5          5274     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6          5215     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7          5218     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8          5237     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9          5359     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10         5131     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11         5126     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12         5319     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13         5311     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         5314     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         5123     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         5239     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         5374     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         5118     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019006,
                    "execution_time": 0.008306,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.004079
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053997,
                    "execution_time": 0.008321,
                    "compile_time": 5e-05,
                    "planning_time": 0.039208
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND NOT \"WSWSCS_2\".\"D_WEEK_SEQ\" IS NULL WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" IS NULL",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_17\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5166     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n1          5292     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n2          5120     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n3          5170     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n4          5213     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n5          5274     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n6          5215     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n7          5218     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n8          5237     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n9          5359     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n10         5131     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n11         5126     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n12         5319     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n13         5311     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n14         5314     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n15         5123     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n16         5239     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n17         5374     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n18         5118     1.0     1.0     1.0     1.0     1.0     1.0     1.0\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs\n  join date_dim on date_dim.d_week_seq = wswscs.d_week_seq and\n  d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n  join date_dim on date_dim.d_week_seq = wswscs.d_week_seq and\n  d_year = 2001) x\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" = 2001 ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" CROSS JOIN \"WSWSCS\" AS \"WSWSCS_2\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" = 2001",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.079926,
                    "execution_time": 0.031502,
                    "compile_time": 0.000265,
                    "planning_time": 0.024196,
                    "create_size": 20
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.146127,
                    "execution_time": 0.03177,
                    "compile_time": 0.000256,
                    "planning_time": 0.089247,
                    "create_size": 20
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.601904,
                    "execution_time": 0.111194,
                    "compile_time": 0.000527,
                    "planning_time": 0.010614,
                    "create_size": 506
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.672019,
                    "execution_time": 0.114635,
                    "compile_time": 0.000561,
                    "planning_time": 0.069776,
                    "create_size": 506
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5274    0.29    0.30    0.28    0.28    0.29    0.28    0.27\n1          5274    0.29    0.30    0.28    0.28    0.29    0.28    0.27\n2          5274    0.29    0.30    0.28    0.28    0.29    0.28    0.27\n3          5274    0.29    0.30    0.28    0.28    0.29    0.28    0.27\n4          5274    0.29    0.30    0.28    0.28    0.29    0.28    0.27\n5          5274    0.29    0.30    0.28    0.28    0.29    0.28    0.27\n6          5274    0.29    0.30    0.28    0.28    0.29    0.28    0.27\n7          5274    0.44    0.44    0.44    0.41    0.44    0.43    0.42\n8          5274    0.44    0.44    0.44    0.41    0.44    0.43    0.42\n9          5274    0.44    0.44    0.44    0.41    0.44    0.43    0.42\n10         5274    0.44    0.44    0.44    0.41    0.44    0.43    0.42\n11         5274    0.44    0.44    0.44    0.41    0.44    0.43    0.42\n12         5274    0.44    0.44    0.44    0.41    0.44    0.43    0.42\n13         5274    0.44    0.44    0.44    0.41    0.44    0.43    0.42\n14         5274    0.29    0.30    0.44    0.43    0.43    0.32    0.27\n15         5274    0.29    0.30    0.44    0.43    0.43    0.32    0.27\n16         5274    0.29    0.30    0.44    0.43    0.43    0.32    0.27\n17         5274    0.29    0.30    0.44    0.43    0.43    0.32    0.27\n18         5274    0.29    0.30    0.44    0.43    0.43    0.32    0.27\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018666,
                    "execution_time": 0.008059,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004108
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055234,
                    "execution_time": 0.007788,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.039186
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_19\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5274    0.29    0.30    0.28    0.28    0.29    0.28    0.27\n1          5274    0.29    0.30    0.28    0.28    0.29    0.28    0.27\n2          5274    0.29    0.30    0.28    0.28    0.29    0.28    0.27\n3          5274    0.29    0.30    0.28    0.28    0.29    0.28    0.27\n4          5274    0.29    0.30    0.28    0.28    0.29    0.28    0.27\n5          5274    0.29    0.30    0.28    0.28    0.29    0.28    0.27\n6          5274    0.29    0.30    0.28    0.28    0.29    0.28    0.27\n7          5274    0.44    0.44    0.44    0.41    0.44    0.43    0.42\n8          5274    0.44    0.44    0.44    0.41    0.44    0.43    0.42\n9          5274    0.44    0.44    0.44    0.41    0.44    0.43    0.42\n10         5274    0.44    0.44    0.44    0.41    0.44    0.43    0.42\n11         5274    0.44    0.44    0.44    0.41    0.44    0.43    0.42\n12         5274    0.44    0.44    0.44    0.41    0.44    0.43    0.42\n13         5274    0.44    0.44    0.44    0.41    0.44    0.43    0.42\n14         5274    0.29    0.30    0.44    0.43    0.43    0.32    0.27\n15         5274    0.29    0.30    0.44    0.43    0.43    0.32    0.27\n16         5274    0.29    0.30    0.44    0.43    0.43    0.32    0.27\n17         5274    0.29    0.30    0.44    0.43    0.43    0.32    0.27\n18         5274    0.29    0.30    0.44    0.43    0.43    0.32    0.27\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales)), -- Changed 'catalog_sales' to 'web_sales'\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        date_dim.d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs, date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        date_dim.d_year = 2002) x  -- Added complete second subquery\n /*CURSOR_IDENTIFIER*/\n where d_week_seq1 = d_week_seq2\n order by d_week_seq1;",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002 ORDER BY \"D_WEEK_SEQ1\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.104098,
                    "execution_time": 0.035324,
                    "compile_time": 0.000321,
                    "planning_time": 0.040591,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.169684,
                    "execution_time": 0.036703,
                    "compile_time": 0.000319,
                    "planning_time": 0.103566,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"D_WEEK_SEQ1\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019947,
                    "execution_time": 0.008513,
                    "compile_time": 7e-05,
                    "planning_time": 0.005239
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058008,
                    "execution_time": 0.009996,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.040316
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_6\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002 ORDER BY \"D_WEEK_SEQ1\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_20\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"D_WEEK_SEQ1\" NULLS LAST"
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2002) z\n where d_week_seq1 = d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.101015,
                    "execution_time": 0.034793,
                    "compile_time": 0.000315,
                    "planning_time": 0.038705,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.166791,
                    "execution_time": 0.033193,
                    "compile_time": 0.000331,
                    "planning_time": 0.104838,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018557,
                    "execution_time": 0.007187,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.005018
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055784,
                    "execution_time": 0.007785,
                    "compile_time": 5e-05,
                    "planning_time": 0.040067
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_21\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs, date_dim\n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2002) z\nwhere d_week_seq1 = d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_22\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.101889,
                    "execution_time": 0.033237,
                    "compile_time": 0.000337,
                    "planning_time": 0.040284,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.169609,
                    "execution_time": 0.034242,
                    "compile_time": 0.00032,
                    "planning_time": 0.103756,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018342,
                    "execution_time": 0.007191,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.004927
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05513,
                    "execution_time": 0.00805,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.040575
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_22\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_22\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2002) z\n where d_week_seq1 = d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"_COL_1\" AS \"_COL_1\" , \"_COL_2\" AS \"_COL_2\" , \"_COL_3\" AS \"_COL_3\" , \"_COL_4\" AS \"_COL_4\" , \"_COL_5\" AS \"_COL_5\" , \"_COL_6\" AS \"_COL_6\" , \"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017954,
                    "execution_time": 0.006965,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.004893
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.0538,
                    "execution_time": 0.007447,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.039983
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "rewrite": "SELECT \"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\", \"_COL_1\" AS \"_COL_1\", \"_COL_2\" AS \"_COL_2\", \"_COL_3\" AS \"_COL_3\", \"_COL_4\" AS \"_COL_4\", \"_COL_5\" AS \"_COL_5\", \"_COL_6\" AS \"_COL_6\", \"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2002) z\n where d_week_seq1 = d_week_seq2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"_COL_1\" AS \"_COL_1\" , \"_COL_2\" AS \"_COL_2\" , \"_COL_3\" AS \"_COL_3\" , \"_COL_4\" AS \"_COL_4\" , \"_COL_5\" AS \"_COL_5\" , \"_COL_6\" AS \"_COL_6\" , \"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018733,
                    "execution_time": 0.007505,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.005032
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018406,
                    "execution_time": 0.006986,
                    "compile_time": 5e-05,
                    "planning_time": 0.005137
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "rewrite": "SELECT \"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\", \"_COL_1\" AS \"_COL_1\", \"_COL_2\" AS \"_COL_2\", \"_COL_3\" AS \"_COL_3\", \"_COL_4\" AS \"_COL_4\", \"_COL_5\" AS \"_COL_5\", \"_COL_6\" AS \"_COL_6\", \"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [d_week_seq1, _col_1, _col_2, _col_3, _col_4, _col_5, _col_6, _col_7]\nIndex: []*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select ws_sold_date_sk sold_date_sk\n        ,ws_ext_sales_price sales_price\n  from web_sales),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs)\n/*CURSOR_IDENTIFIER*/;",
        "optimize": [
            "WITH \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN \"WSWSCS\" AS \"WSWSCS_2\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_23\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.497866,
                    "execution_time": 0.079061,
                    "compile_time": 0.000343,
                    "planning_time": 0.031882,
                    "create_size": 506
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.56419,
                    "execution_time": 0.081517,
                    "compile_time": 0.000347,
                    "planning_time": 0.096033,
                    "create_size": 506
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5302    2.06    2.44    2.10    2.19    2.14    2.35    2.67\n1          5302    2.35    2.49    2.14    2.49    2.68    2.33    2.46\n2          5302    1.94    2.32    2.46    2.21    2.74    2.37    2.31\n3          5302    2.09    2.65    2.41    2.46    2.46    2.20    2.55\n4          5302    2.01    2.50    2.23    2.53    2.91    2.28    2.35\n5          5302    0.60    0.69    0.64    0.63    0.65    0.65    0.63\n6          5302    2.28    2.54    2.31    2.57    2.50    2.28    2.40\n7          5302    1.92    2.54    2.23    1.91    2.57    2.00    2.54\n8          5302    1.01    1.09    0.98    1.01    1.11    0.97    1.10\n9          5302    0.89    1.01    0.92    0.97    1.07    0.97    1.02\n10         5302    2.72    2.38    2.36    2.34    2.52    2.54    2.15\n11         5302    0.94    1.22    1.01    1.08    1.00    0.99    1.00\n12         5302    0.85    1.11    0.94    0.97    1.05    1.05    1.05\n13         5302    2.31    2.36    2.13    2.57    2.52    2.22    2.33\n14         5302    0.95    0.97    0.95    0.99    1.17    1.03    0.93\n15         5302    1.00    1.15    0.90    1.02    1.06    1.11    0.92\n16         5302    2.14    2.57    2.35    2.33    2.82    2.65     NaN\n17         5302    1.99    2.68    2.41    2.25    2.55    2.23    2.31\n18         5302    1.82    2.34    2.34    2.11    2.34    2.39    1.88\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018899,
                    "execution_time": 0.008202,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004161
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054936,
                    "execution_time": 0.00749,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039383
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_1\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"WSWSCS_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_23\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5302    2.06    2.44    2.10    2.19    2.14    2.35    2.67\n1          5302    2.35    2.49    2.14    2.49    2.68    2.33    2.46\n2          5302    1.94    2.32    2.46    2.21    2.74    2.37    2.31\n3          5302    2.09    2.65    2.41    2.46    2.46    2.20    2.55\n4          5302    2.01    2.50    2.23    2.53    2.91    2.28    2.35\n5          5302    0.60    0.69    0.64    0.63    0.65    0.65    0.63\n6          5302    2.28    2.54    2.31    2.57    2.50    2.28    2.40\n7          5302    1.92    2.54    2.23    1.91    2.57    2.00    2.54\n8          5302    1.01    1.09    0.98    1.01    1.11    0.97    1.10\n9          5302    0.89    1.01    0.92    0.97    1.07    0.97    1.02\n10         5302    2.72    2.38    2.36    2.34    2.52    2.54    2.15\n11         5302    0.94    1.22    1.01    1.08    1.00    0.99    1.00\n12         5302    0.85    1.11    0.94    0.97    1.05    1.05    1.05\n13         5302    2.31    2.36    2.13    2.57    2.52    2.22    2.33\n14         5302    0.95    0.97    0.95    0.99    1.17    1.03    0.93\n15         5302    1.00    1.15    0.90    1.02    1.06    1.11    0.92\n16         5302    2.14    2.57    2.35    2.33    2.82    2.65     NaN\n17         5302    1.99    2.68    2.41    2.25    2.55    2.23    2.31\n18         5302    1.82    2.34    2.34    2.11    2.34    2.39    1.88\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n      ,date_dim \n where date_dim.d_week_seq = wswscs.d_week_seq)/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN \"WSWSCS\" AS \"WSWSCS_2\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_24\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.520046,
                    "execution_time": 0.20649,
                    "compile_time": 0.0005,
                    "planning_time": 0.037797,
                    "create_size": 506
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.597675,
                    "execution_time": 0.208895,
                    "compile_time": 0.000517,
                    "planning_time": 0.105623,
                    "create_size": 506
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_24\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5274    1.02    1.01    0.98    1.00    1.05    1.04    0.97\n1          5274    1.02    1.01    0.98    1.00    1.05    1.04    0.97\n2          5274    1.02    1.01    0.98    1.00    1.05    1.04    0.97\n3          5274    1.02    1.01    0.98    1.00    1.05    1.04    0.97\n4          5274    1.02    1.01    0.98    1.00    1.05    1.04    0.97\n5          5274    1.02    1.01    0.98    1.00    1.05    1.04    0.97\n6          5274    1.02    1.01    0.98    1.00    1.05    1.04    0.97\n7          5274    1.05    1.04    0.95    0.98    1.03    0.94    0.95\n8          5274    1.05    1.04    0.95    0.98    1.03    0.94    0.95\n9          5274    1.05    1.04    0.95    0.98    1.03    0.94    0.95\n10         5274    1.05    1.04    0.95    0.98    1.03    0.94    0.95\n11         5274    1.05    1.04    0.95    0.98    1.03    0.94    0.95\n12         5274    1.05    1.04    0.95    0.98    1.03    0.94    0.95\n13         5274    1.05    1.04    0.95    0.98    1.03    0.94    0.95\n14         5274    0.29    0.29    0.29    0.28    0.29    0.29    0.27\n15         5274    0.29    0.29    0.29    0.28    0.29    0.29    0.27\n16         5274    0.29    0.29    0.29    0.28    0.29    0.29    0.27\n17         5274    0.29    0.29    0.29    0.28    0.29    0.29    0.27\n18         5274    0.29    0.29    0.29    0.28    0.29    0.29    0.27\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018342,
                    "execution_time": 0.00801,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004026
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056982,
                    "execution_time": 0.007594,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039707
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_24\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5274    1.02    1.01    0.98    1.00    1.05    1.04    0.97\n1          5274    1.02    1.01    0.98    1.00    1.05    1.04    0.97\n2          5274    1.02    1.01    0.98    1.00    1.05    1.04    0.97\n3          5274    1.02    1.01    0.98    1.00    1.05    1.04    0.97\n4          5274    1.02    1.01    0.98    1.00    1.05    1.04    0.97\n5          5274    1.02    1.01    0.98    1.00    1.05    1.04    0.97\n6          5274    1.02    1.01    0.98    1.00    1.05    1.04    0.97\n7          5274    1.05    1.04    0.95    0.98    1.03    0.94    0.95\n8          5274    1.05    1.04    0.95    0.98    1.03    0.94    0.95\n9          5274    1.05    1.04    0.95    0.98    1.03    0.94    0.95\n10         5274    1.05    1.04    0.95    0.98    1.03    0.94    0.95\n11         5274    1.05    1.04    0.95    0.98    1.03    0.94    0.95\n12         5274    1.05    1.04    0.95    0.98    1.03    0.94    0.95\n13         5274    1.05    1.04    0.95    0.98    1.03    0.94    0.95\n14         5274    0.29    0.29    0.29    0.28    0.29    0.29    0.27\n15         5274    0.29    0.29    0.29    0.28    0.29    0.29    0.27\n16         5274    0.29    0.29    0.29    0.28    0.29    0.29    0.27\n17         5274    0.29    0.29    0.29    0.28    0.29    0.29    0.27\n18         5274    0.29    0.29    0.29    0.28    0.29    0.29    0.27\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n      ,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n    d_year = 2001\n/*CURSOR_IDENTIFIER*/\n)",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" = 2001 ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" CROSS JOIN \"WSWSCS\" AS \"WSWSCS_2\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"_COL_1\" AS \"_COL_1\" , \"_COL_2\" AS \"_COL_2\" , \"_COL_3\" AS \"_COL_3\" , \"_COL_4\" AS \"_COL_4\" , \"_COL_5\" AS \"_COL_5\" , \"_COL_6\" AS \"_COL_6\" , \"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5302    0.99    1.02    1.01    1.00    1.02    1.04    1.02\n1          5302    0.99    1.02    1.01    1.00    1.02    1.04    1.02\n2          5302    0.99    1.02    1.01    1.00    1.02    1.04    1.02\n3          5302    0.99    1.02    1.01    1.00    1.02    1.04    1.02\n4          5302    0.99    1.02    1.01    1.00    1.02    1.04    1.02\n5          5302    0.99    1.02    1.01    1.00    1.02    1.04    1.02\n6          5302    0.99    1.02    1.01    1.00    1.02    1.04    1.02\n7          5302    0.97    1.05    0.99    1.00    0.98    1.03    1.03\n8          5302    0.97    1.05    0.99    1.00    0.98    1.03    1.03\n9          5302    0.97    1.05    0.99    1.00    0.98    1.03    1.03\n10         5302    0.97    1.05    0.99    1.00    0.98    1.03    1.03\n11         5302    0.97    1.05    0.99    1.00    0.98    1.03    1.03\n12         5302    0.97    1.05    0.99    1.00    0.98    1.03    1.03\n13         5302    0.97    1.05    0.99    1.00    0.98    1.03    1.03\n14         5302    2.20    2.38    2.28    2.25    2.27    2.20    2.33\n15         5302    2.20    2.38    2.28    2.25    2.27    2.20    2.33\n16         5302    2.20    2.38    2.28    2.25    2.27    2.20    2.33\n17         5302    2.20    2.38    2.28    2.25    2.27    2.20    2.33\n18         5302    2.20    2.38    2.28    2.25    2.27    2.20    2.33\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018309,
                    "execution_time": 0.007706,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.004114
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053536,
                    "execution_time": 0.007691,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.03939
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\", \"_COL_1\" AS \"_COL_1\", \"_COL_2\" AS \"_COL_2\", \"_COL_3\" AS \"_COL_3\", \"_COL_4\" AS \"_COL_4\", \"_COL_5\" AS \"_COL_5\", \"_COL_6\" AS \"_COL_6\", \"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5302    0.99    1.02    1.01    1.00    1.02    1.04    1.02\n1          5302    0.99    1.02    1.01    1.00    1.02    1.04    1.02\n2          5302    0.99    1.02    1.01    1.00    1.02    1.04    1.02\n3          5302    0.99    1.02    1.01    1.00    1.02    1.04    1.02\n4          5302    0.99    1.02    1.01    1.00    1.02    1.04    1.02\n5          5302    0.99    1.02    1.01    1.00    1.02    1.04    1.02\n6          5302    0.99    1.02    1.01    1.00    1.02    1.04    1.02\n7          5302    0.97    1.05    0.99    1.00    0.98    1.03    1.03\n8          5302    0.97    1.05    0.99    1.00    0.98    1.03    1.03\n9          5302    0.97    1.05    0.99    1.00    0.98    1.03    1.03\n10         5302    0.97    1.05    0.99    1.00    0.98    1.03    1.03\n11         5302    0.97    1.05    0.99    1.00    0.98    1.03    1.03\n12         5302    0.97    1.05    0.99    1.00    0.98    1.03    1.03\n13         5302    0.97    1.05    0.99    1.00    0.98    1.03    1.03\n14         5302    2.20    2.38    2.28    2.25    2.27    2.20    2.33\n15         5302    2.20    2.38    2.28    2.25    2.27    2.20    2.33\n16         5302    2.20    2.38    2.28    2.25    2.27    2.20    2.33\n17         5302    2.20    2.38    2.28    2.25    2.27    2.20    2.33\n18         5302    2.20    2.38    2.28    2.25    2.27    2.20    2.33\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n      ,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001+1) z\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN \"WSWSCS\" AS \"WSWSCS_2\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_25\" AS SELECT \"SPEQLITE_TEMP_TABLE_24\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_24\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_YEAR\" = 2002 LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n1          5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n2          5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n3          5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n4          5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n5          5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n6          5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n7          5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n8          5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n9          5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n10         5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n11         5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n12         5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n13         5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n14         5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n15         5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n16         5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n17         5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n18         5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.047309,
                    "execution_time": 0.010001,
                    "compile_time": 9.4e-05,
                    "planning_time": 0.029418
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.109532,
                    "execution_time": 0.010682,
                    "compile_time": 9.9e-05,
                    "planning_time": 0.08741
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 CROSS JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_24\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_24\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_YEAR\" = 2002"
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n1          5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n2          5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n3          5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n4          5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n5          5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n6          5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n7          5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n8          5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n9          5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n10         5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n11         5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n12         5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n13         5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n14         5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n15         5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n16         5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n17         5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n18         5291    1.03    1.05    1.02     1.0    0.98    0.97    1.03\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n      ,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001+1) z\n where d_week_seq1=d_week_seq2-53\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" - 53 JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_25\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" - 53 JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.136372,
                    "execution_time": 0.05994,
                    "compile_time": 0.000393,
                    "planning_time": 0.039714,
                    "create_size": 506
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.209413,
                    "execution_time": 0.061982,
                    "compile_time": 0.000398,
                    "planning_time": 0.105296,
                    "create_size": 506
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n1          5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n2          5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n3          5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n4          5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n5          5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n6          5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n7          5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n8          5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n9          5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n10         5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n11         5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n12         5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n13         5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n14         5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n15         5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n16         5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n17         5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n18         5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.0181,
                    "execution_time": 0.00764,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004045
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05552,
                    "execution_time": 0.008291,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039339
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" - 53 JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\""
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n1          5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n2          5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n3          5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n4          5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n5          5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n6          5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n7          5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n8          5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n9          5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n10         5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n11         5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n12         5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n13         5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n14         5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n15         5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n16         5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n17         5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n18         5296    1.06    0.98    1.01    1.01    1.06    0.99    1.05\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n      ,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001+1) z\n where d_week_seq1=d_week_seq2-53\n order by d_week_seq1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" - 53 JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002 ORDER BY \"D_WEEK_SEQ1\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" ORDER BY \"D_WEEK_SEQ1\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n1          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n2          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n3          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n4          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n5          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n6          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n7          5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n8          5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n9          5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n10         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n11         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n12         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n13         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n14         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n15         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n16         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n17         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n18         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01876,
                    "execution_time": 0.008488,
                    "compile_time": 6.9e-05,
                    "planning_time": 0.004039
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056008,
                    "execution_time": 0.008741,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.03928
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" - 53 JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002 ORDER BY \"D_WEEK_SEQ1\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" ORDER BY \"D_WEEK_SEQ1\" NULLS LAST"
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n1          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n2          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n3          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n4          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n5          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n6          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n7          5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n8          5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n9          5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n10         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n11         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n12         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n13         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n14         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n15         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n16         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n17         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n18         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n...*/"
    },
    {
        "input": "-- start template query2.tpl query 84 in stream 0\nwith /* TPC-DS query2.tpl 0.84 */ wscs as\n (select sold_date_sk\n        ,sales_price\n  from  (select ws_sold_date_sk sold_date_sk\n              ,ws_ext_sales_price sales_price\n        from web_sales\n        union all\n        select cs_sold_date_sk sold_date_sk\n              ,cs_ext_sales_price sales_price\n        from catalog_sales)),\n wswscs as \n (select d_week_seq,\n        sum(case when (d_day_name='Sunday') then sales_price else null end) sun_sales,\n        sum(case when (d_day_name='Monday') then sales_price else null end) mon_sales,\n        sum(case when (d_day_name='Tuesday') then sales_price else  null end) tue_sales,\n        sum(case when (d_day_name='Wednesday') then sales_price else null end) wed_sales,\n        sum(case when (d_day_name='Thursday') then sales_price else null end) thu_sales,\n        sum(case when (d_day_name='Friday') then sales_price else null end) fri_sales,\n        sum(case when (d_day_name='Saturday') then sales_price else null end) sat_sales\n from wscs\n     ,date_dim\n where d_date_sk = sold_date_sk\n group by d_week_seq)\n select d_week_seq1\n       ,round(sun_sales1/sun_sales2,2)\n       ,round(mon_sales1/mon_sales2,2)\n       ,round(tue_sales1/tue_sales2,2)\n       ,round(wed_sales1/wed_sales2,2)\n       ,round(thu_sales1/thu_sales2,2)\n       ,round(fri_sales1/fri_sales2,2)\n       ,round(sat_sales1/sat_sales2,2)\n from\n (select wswscs.d_week_seq d_week_seq1\n        ,sun_sales sun_sales1\n        ,mon_sales mon_sales1\n        ,tue_sales tue_sales1\n        ,wed_sales wed_sales1\n        ,thu_sales thu_sales1\n        ,fri_sales fri_sales1\n        ,sat_sales sat_sales1\n  from wswscs,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001) y,\n (select wswscs.d_week_seq d_week_seq2\n        ,sun_sales sun_sales2\n        ,mon_sales mon_sales2\n        ,tue_sales tue_sales2\n        ,wed_sales wed_sales2\n        ,thu_sales thu_sales2\n        ,fri_sales fri_sales2\n        ,sat_sales sat_sales2\n  from wswscs\n      ,date_dim \n  where date_dim.d_week_seq = wswscs.d_week_seq and\n        d_year = 2001+1) z\n where d_week_seq1=d_week_seq2-53\n order by d_week_seq1\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_Q_0\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"SOLD_DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" ) , \"WSWSCS\" AS ( SELECT \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Sunday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SUN_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Monday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"MON_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Tuesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"TUE_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Wednesday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"WED_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Thursday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"THU_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Friday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"FRI_SALES\" , SUM ( CASE WHEN \"DATE_DIM\".\"D_DAY_NAME\" = 'Saturday' THEN \"_Q_0\".\"SALES_PRICE\" ELSE NULL END ) AS \"SAT_SALES\" FROM \"_Q_0\" AS \"_Q_0\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"_Q_0\".\"SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"DATE_DIM\".\"D_WEEK_SEQ\" ) SELECT \"WSWSCS\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"WSWSCS\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"WSWSCS\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"WSWSCS\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"WSWSCS\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"WSWSCS\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"WSWSCS\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"WSWSCS\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"WSWSCS\" AS \"WSWSCS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"WSWSCS\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"WSWSCS\" AS \"WSWSCS_2\" ON \"WSWSCS\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" - 53 JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002 ORDER BY \"D_WEEK_SEQ1\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" ORDER BY \"D_WEEK_SEQ1\" LIMIT 21",
                "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n1          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n2          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n3          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n4          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n5          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n6          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n7          5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n8          5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n9          5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n10         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n11         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n12         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n13         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n14         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n15         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n16         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n17         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n18         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019392,
                    "execution_time": 0.009089,
                    "compile_time": 7.1e-05,
                    "planning_time": 0.004138
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020392,
                    "execution_time": 0.009424,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.004351
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SUN_SALES\" / \"WSWSCS_2\".\"SUN_SALES\" , 2 ) AS \"_COL_1\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"MON_SALES\" / \"WSWSCS_2\".\"MON_SALES\" , 2 ) AS \"_COL_2\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"TUE_SALES\" / \"WSWSCS_2\".\"TUE_SALES\" , 2 ) AS \"_COL_3\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"WED_SALES\" / \"WSWSCS_2\".\"WED_SALES\" , 2 ) AS \"_COL_4\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"THU_SALES\" / \"WSWSCS_2\".\"THU_SALES\" , 2 ) AS \"_COL_5\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"FRI_SALES\" / \"WSWSCS_2\".\"FRI_SALES\" , 2 ) AS \"_COL_6\" , ROUND ( \"SPEQLITE_TEMP_TABLE_9\".\"SAT_SALES\" / \"WSWSCS_2\".\"SAT_SALES\" , 2 ) AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_WEEK_SEQ\" = \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"WSWSCS_2\" ON \"SPEQLITE_TEMP_TABLE_9\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" - 53 JOIN \"DATE_DIM\" AS \"DATE_DIM_2\" ON \"DATE_DIM_2\".\"D_WEEK_SEQ\" = \"WSWSCS_2\".\"D_WEEK_SEQ\" AND \"DATE_DIM_2\".\"D_YEAR\" = 2002 ORDER BY \"D_WEEK_SEQ1\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"D_WEEK_SEQ1\" AS \"D_WEEK_SEQ1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_1\" AS \"_COL_1\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_3\" AS \"_COL_3\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_4\" AS \"_COL_4\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_25\".\"_COL_7\" AS \"_COL_7\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" ORDER BY \"D_WEEK_SEQ1\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*    d_week_seq1  _col_1  _col_2  _col_3  _col_4  _col_5  _col_6  _col_7\n0          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n1          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n2          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n3          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n4          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n5          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n6          5270    3.44    1.82    1.90    1.64    3.38    3.49    3.59\n7          5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n8          5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n9          5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n10         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n11         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n12         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n13         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n14         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n15         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n16         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n17         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n18         5271    1.02    0.99    0.98    1.00    1.07    1.00    1.01\n...*/"
    }
]