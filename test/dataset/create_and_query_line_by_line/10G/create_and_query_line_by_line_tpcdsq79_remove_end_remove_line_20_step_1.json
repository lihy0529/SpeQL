[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  c_last_name, c_first_name, substring(s_city, 1, 30), ss_ticket_number, amt, profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n          ,customer.c_last_name\n          ,customer.c_first_name\n    from store_sales, date_dim, store, household_demographics, customer\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and store_sales.ss_customer_sk = customer.c_customer_sk\n    group by ss_ticket_number, ss_customer_sk, store.s_city, customer.c_last_name, customer.c_first_name\n   ) as derived_table\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DERIVED_TABLE\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" ) SELECT \"DERIVED_TABLE\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"DERIVED_TABLE\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"DERIVED_TABLE\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"DERIVED_TABLE\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DERIVED_TABLE\".\"AMT\" AS \"AMT\" , \"DERIVED_TABLE\".\"PROFIT\" AS \"PROFIT\" FROM \"DERIVED_TABLE\" AS \"DERIVED_TABLE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.266707,
                    "execution_time": 3.526669,
                    "compile_time": 0.044124,
                    "planning_time": 0.056291,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.866975,
                    "execution_time": 3.561292,
                    "compile_time": 3.50838,
                    "planning_time": 0.153999,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" FROM 1 FOR 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_1\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name         _col_2  ss_ticket_number      amt    profit\n0      Andrews    Stephanie         Midway            605221    82.71  -4875.49\n1       Talbot      Michael      Riverside            762226  1425.10  -7546.99\n2    Jefferson      Michael  Pleasant Hill            913190  1788.21 -10677.42\n3       Landis         Sean    Five Points           1211850  1479.42 -10045.24\n4       Castro      Michael    Five Points             89991  6915.82 -10738.88\n5        Moran     Gilberto  Pleasant Hill           2342276  2178.90 -17394.70\n6        Green       Gladys         Midway            168695  1729.13  -9329.61\n7       Knight      Charles      Riverside            623859  2156.08 -10943.14\n8      Gilbert         Carl      Oak Grove           2352556     0.00  -1679.32\n9        Smith      Lawanda  Pleasant Hill           1077821  1499.65 -18901.84\n10      Coburn        Ellis       Fairview           2130957  4211.20  -8176.38\n11       Penny        Nancy    Five Points           2131919     0.00  -5241.75\n12       Xiong        Pedro      Oak Grove           1016990     0.00  -9431.30\n13        Long        James  Pleasant Hill           2141699   246.06  -3585.07\n14       Henry          Amy  Pleasant Hill           2148497  1388.44 -15724.73\n15      Fields      Kenneth       Fairview            873143   450.05  -1723.33\n16     Judkins        Henry       Fairview            874318   157.17  -6616.53\n17  Richardson         Lela       Fairview           1922910  1175.13  -6917.11\n18      Walker        Pedro      Oak Grove           1405055     0.00    345.57\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018664,
                    "execution_time": 0.008033,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004144
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.059652,
                    "execution_time": 0.008896,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.041159
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_1\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_1\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_1\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name         _col_2  ss_ticket_number      amt    profit\n0      Andrews    Stephanie         Midway            605221    82.71  -4875.49\n1       Talbot      Michael      Riverside            762226  1425.10  -7546.99\n2    Jefferson      Michael  Pleasant Hill            913190  1788.21 -10677.42\n3       Landis         Sean    Five Points           1211850  1479.42 -10045.24\n4       Castro      Michael    Five Points             89991  6915.82 -10738.88\n5        Moran     Gilberto  Pleasant Hill           2342276  2178.90 -17394.70\n6        Green       Gladys         Midway            168695  1729.13  -9329.61\n7       Knight      Charles      Riverside            623859  2156.08 -10943.14\n8      Gilbert         Carl      Oak Grove           2352556     0.00  -1679.32\n9        Smith      Lawanda  Pleasant Hill           1077821  1499.65 -18901.84\n10      Coburn        Ellis       Fairview           2130957  4211.20  -8176.38\n11       Penny        Nancy    Five Points           2131919     0.00  -5241.75\n12       Xiong        Pedro      Oak Grove           1016990     0.00  -9431.30\n13        Long        James  Pleasant Hill           2141699   246.06  -3585.07\n14       Henry          Amy  Pleasant Hill           2148497  1388.44 -15724.73\n15      Fields      Kenneth       Fairview            873143   450.05  -1723.33\n16     Judkins        Henry       Fairview            874318   157.17  -6616.53\n17  Richardson         Lela       Fairview           1922910  1175.13  -6917.11\n18      Walker        Pedro      Oak Grove           1405055     0.00    345.57\n...*/"
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk, store.s_city\n   ) as derived_table",
        "optimize": [
            "WITH \"DERIVED_TABLE\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" ) SELECT SUBSTRING ( \"DERIVED_TABLE\".\"S_CITY\" , 1 , 30 ) AS \"_COL_0\" , \"DERIVED_TABLE\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DERIVED_TABLE\".\"AMT\" AS \"AMT\" , \"DERIVED_TABLE\".\"PROFIT\" AS \"PROFIT\" FROM \"DERIVED_TABLE\" AS \"DERIVED_TABLE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.951501,
                    "execution_time": 0.472838,
                    "compile_time": 0.000441,
                    "planning_time": 0.051064,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.03596,
                    "execution_time": 0.474614,
                    "compile_time": 0.000426,
                    "planning_time": 0.134397,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"SPEQLITE_TEMP_TABLE_2\".\"S_CITY\" FROM 1 FOR 30 ) AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_2\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_2\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*           _col_0  ss_ticket_number      amt    profit\n0          Midway            841326  1311.17   -433.58\n1          Midway            841326     0.00       NaN\n2   Pleasant Hill            918237  2004.94  -2534.00\n3     Five Points            844300   186.21 -10126.53\n4   Pleasant Hill            921381   579.78  -4501.50\n5   Pleasant Hill            547755     0.00  -1001.77\n6          Midway            699615  3976.61  -7769.77\n7       Riverside            328818  1058.31  -6872.39\n8        Fairview           1155636  1009.25  -7697.04\n9   Pleasant Hill           1980232     0.00  -2350.52\n10  Pleasant Hill           1086685   778.57  -6065.75\n11  Pleasant Hill           1086685     0.00   1669.72\n12      Riverside           1764847     0.00  -1605.98\n13      Riverside           2299626     0.00  -9134.24\n14      Oak Grove           1252760  1706.51  -5597.18\n15      Oak Grove           1859595  3022.18  -8284.47\n16      Oak Grove           1559455  1428.06  -4247.19\n17       Fairview           1781942   657.92  -2172.08\n18       Fairview            662253    13.85 -12199.09\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018368,
                    "execution_time": 0.008119,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003878
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.072635,
                    "execution_time": 0.008541,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.054396
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING ( \"SPEQLITE_TEMP_TABLE_2\".\"S_CITY\" , 1 , 30 ) AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_2\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_2\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT SUBSTRING ( \"SPEQLITE_TEMP_TABLE_2\".\"S_CITY\" , 1 , 30 ) AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_2\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_2\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*           _col_0  ss_ticket_number      amt    profit\n0          Midway            841326  1311.17   -433.58\n1          Midway            841326     0.00       NaN\n2   Pleasant Hill            918237  2004.94  -2534.00\n3     Five Points            844300   186.21 -10126.53\n4   Pleasant Hill            921381   579.78  -4501.50\n5   Pleasant Hill            547755     0.00  -1001.77\n6          Midway            699615  3976.61  -7769.77\n7       Riverside            328818  1058.31  -6872.39\n8        Fairview           1155636  1009.25  -7697.04\n9   Pleasant Hill           1980232     0.00  -2350.52\n10  Pleasant Hill           1086685   778.57  -6065.75\n11  Pleasant Hill           1086685     0.00   1669.72\n12      Riverside           1764847     0.00  -1605.98\n13      Riverside           2299626     0.00  -9134.24\n14      Oak Grove           1252760  1706.51  -5597.18\n15      Oak Grove           1859595  3022.18  -8284.47\n16      Oak Grove           1559455  1428.06  -4247.19\n17       Fairview           1781942   657.92  -2172.08\n18       Fairview            662253    13.85 -12199.09\n...*/"
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk, store.s_city\n   ) as derived_table",
        "optimize": [
            "WITH \"DERIVED_TABLE\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" ) SELECT SUBSTRING ( \"DERIVED_TABLE\".\"S_CITY\" , 1 , 30 ) AS \"_COL_0\" , \"DERIVED_TABLE\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DERIVED_TABLE\".\"AMT\" AS \"AMT\" , \"DERIVED_TABLE\".\"PROFIT\" AS \"PROFIT\" FROM \"DERIVED_TABLE\" AS \"DERIVED_TABLE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.498202,
                    "execution_time": 0.14354,
                    "compile_time": 0.0004,
                    "planning_time": 0.050871,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.736747,
                    "execution_time": 0.141238,
                    "compile_time": 0.13047,
                    "planning_time": 0.156168,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"SPEQLITE_TEMP_TABLE_3\".\"S_CITY\" FROM 1 FOR 30 ) AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_3\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_3\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*           _col_0  ss_ticket_number      amt    profit\n0       Oak Grove            304969  2714.67  -6403.12\n1   Pleasant Hill             46498   588.94 -23787.32\n2       Riverside            968404   547.73  -3831.97\n3   Pleasant Hill            211133     0.00   -962.74\n4       Riverside            820362   209.53 -12470.25\n5       Riverside            606186    29.99  -8129.73\n6       Oak Grove            915589  1068.16 -10713.11\n7        Fairview            769646  3235.34 -16229.09\n8        Fairview           1305712  3585.50 -21110.61\n9       Riverside           2133245  2838.52  -4588.05\n10      Riverside            570703    87.40   -898.63\n11         Midway           1852440   221.40 -10990.91\n12      Riverside           1181915   219.30  -4349.92\n13                          1109806  1037.93 -11040.19\n14      Oak Grove            510049  1248.61  -2418.72\n15  Pleasant Hill           1633688  3257.05 -11340.17\n16  Pleasant Hill           2247048     0.00  -4379.06\n17         Midway            900713  1880.49   -759.01\n18      Riverside            398141  1264.66 -11368.01\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017457,
                    "execution_time": 0.007465,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003768
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.08702,
                    "execution_time": 0.008079,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.069462
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING ( \"SPEQLITE_TEMP_TABLE_3\".\"S_CITY\" , 1 , 30 ) AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_3\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_3\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT SUBSTRING ( \"SPEQLITE_TEMP_TABLE_3\".\"S_CITY\" , 1 , 30 ) AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_3\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_3\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*           _col_0  ss_ticket_number      amt    profit\n0       Oak Grove            304969  2714.67  -6403.12\n1   Pleasant Hill             46498   588.94 -23787.32\n2       Riverside            968404   547.73  -3831.97\n3   Pleasant Hill            211133     0.00   -962.74\n4       Riverside            820362   209.53 -12470.25\n5       Riverside            606186    29.99  -8129.73\n6       Oak Grove            915589  1068.16 -10713.11\n7        Fairview            769646  3235.34 -16229.09\n8        Fairview           1305712  3585.50 -21110.61\n9       Riverside           2133245  2838.52  -4588.05\n10      Riverside            570703    87.40   -898.63\n11         Midway           1852440   221.40 -10990.91\n12      Riverside           1181915   219.30  -4349.92\n13                          1109806  1037.93 -11040.19\n14      Oak Grove            510049  1248.61  -2418.72\n15  Pleasant Hill           1633688  3257.05 -11340.17\n16  Pleasant Hill           2247048     0.00  -4379.06\n17         Midway            900713  1880.49   -759.01\n18      Riverside            398141  1264.66 -11368.01\n...*/"
    },
    {
        "input": "select /* TPC-DS query79.tpl 0.89 */ \n  c_last_name, c_first_name, substring(s_city,1,30), ss_ticket_number, amt, profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n          ,customer.c_last_name\n          ,customer.c_first_name\n    from store_sales\n    join date_dim on store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    join store on store_sales.ss_store_sk = store.s_store_sk  \n    join household_demographics on store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    join customer on store_sales.ss_customer_sk = customer.c_customer_sk\n    where (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n    and date_dim.d_year in (1999, 1999+1, 1999+2)\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk, store.s_city, customer.c_last_name, customer.c_first_name\n   ) derived_alias",
        "optimize": [
            "WITH \"DERIVED_ALIAS\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" ) SELECT \"DERIVED_ALIAS\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"DERIVED_ALIAS\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"DERIVED_ALIAS\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"DERIVED_ALIAS\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DERIVED_ALIAS\".\"AMT\" AS \"AMT\" , \"DERIVED_ALIAS\".\"PROFIT\" AS \"PROFIT\" FROM \"DERIVED_ALIAS\" AS \"DERIVED_ALIAS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.606491,
                    "execution_time": 0.148324,
                    "compile_time": 0.131199,
                    "planning_time": 0.067024,
                    "create_size": 936
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 8.754094,
                    "execution_time": 1.040436,
                    "compile_time": 7.248687,
                    "planning_time": 0.197814,
                    "create_size": 936
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_4\".\"S_CITY\" FROM 1 FOR 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_4\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_4\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_4\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name         _col_2  ss_ticket_number      amt    profit\n0        Lopez          Dan      Riverside           1149350     0.00  -9880.59\n1      Wallace        Donna       Fairview           1756203  8610.41 -14524.42\n2      Cintron       Steven      Oak Grove            871038    72.65  -4183.65\n3      Pennell         Reta      Riverside           1098150  2097.98 -15369.84\n4     Lundberg        Alvin    Five Points            354998  6806.30 -12105.37\n5                            Pleasant Hill            498611  5480.24 -24547.68\n6       Taylor      Earnest  Pleasant Hill           1569896   301.20  -4455.90\n7    Carpenter      William       Fairview           2014129  2690.98 -10718.60\n8       Shelly       Manuel       Fairview           1199828  1631.19  -2090.88\n9       Bolton         Paul    Five Points            450492   837.00 -11505.23\n10      Patten        James      Riverside            529473  5367.64  -9593.35\n11      Wright        Floyd  Pleasant Hill             81372  2881.60 -13257.95\n12         Lee       Bessie         Midway           2037473     0.00  -4144.27\n13       Yates          Sam  Pleasant Hill            541703  1517.93 -18242.23\n14        Gray       Robert  Pleasant Hill             94508     0.00 -16587.13\n15    Mayberry       Arthur       Fairview           2267681  2863.55  -8329.68\n16       Worth         Lori      Riverside           2045125  5100.56 -10003.17\n17        Carr        Debra  Pleasant Hill           1679148    10.51  -6950.61\n18      Rendon    Alexander       Fairview           1755636  4444.89 -12612.43\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018453,
                    "execution_time": 0.00729,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.004383
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.104014,
                    "execution_time": 0.007741,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.086379
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_4\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_4\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_4\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_4\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_4\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_4\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_4\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_4\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name         _col_2  ss_ticket_number      amt    profit\n0        Lopez          Dan      Riverside           1149350     0.00  -9880.59\n1      Wallace        Donna       Fairview           1756203  8610.41 -14524.42\n2      Cintron       Steven      Oak Grove            871038    72.65  -4183.65\n3      Pennell         Reta      Riverside           1098150  2097.98 -15369.84\n4     Lundberg        Alvin    Five Points            354998  6806.30 -12105.37\n5                            Pleasant Hill            498611  5480.24 -24547.68\n6       Taylor      Earnest  Pleasant Hill           1569896   301.20  -4455.90\n7    Carpenter      William       Fairview           2014129  2690.98 -10718.60\n8       Shelly       Manuel       Fairview           1199828  1631.19  -2090.88\n9       Bolton         Paul    Five Points            450492   837.00 -11505.23\n10      Patten        James      Riverside            529473  5367.64  -9593.35\n11      Wright        Floyd  Pleasant Hill             81372  2881.60 -13257.95\n12         Lee       Bessie         Midway           2037473     0.00  -4144.27\n13       Yates          Sam  Pleasant Hill            541703  1517.93 -18242.23\n14        Gray       Robert  Pleasant Hill             94508     0.00 -16587.13\n15    Mayberry       Arthur       Fairview           2267681  2863.55  -8329.68\n16       Worth         Lori      Riverside           2045125  5100.56 -10003.17\n17        Carr        Debra  Pleasant Hill           1679148    10.51  -6950.61\n18      Rendon    Alexander       Fairview           1755636  4444.89 -12612.43\n...*/"
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales\n    join date_dim on store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    join store on store_sales.ss_store_sk = store.s_store_sk  \n    join household_demographics on store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    where (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n    and date_dim.d_year in (1999,1999+1,1999+2) \n    and store.s_number_employees between 200 and 295\n    group by ss_ticket_number, ss_customer_sk, store.s_city /* Ensure non-aggregated columns are included here */\n/*CURSOR_IDENTIFIER*/) as sales_summary\njoin customer on sales_summary.ss_customer_sk = customer.c_customer_sk\n;",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SALES_SUMMARY\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"AMT\" AS \"AMT\" , \"SALES_SUMMARY\".\"PROFIT\" AS \"PROFIT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.350166,
                    "execution_time": 0.110399,
                    "compile_time": 0.00053,
                    "planning_time": 0.052131,
                    "create_size": 832
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.755632,
                    "execution_time": 0.268711,
                    "compile_time": 0.095019,
                    "planning_time": 0.19395,
                    "create_size": 832
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_5\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_5\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.402736,
                    "execution_time": 0.080132,
                    "compile_time": 0.075385,
                    "planning_time": 0.027558,
                    "create_size": 864
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.526594,
                    "execution_time": 0.076317,
                    "compile_time": 3.089142,
                    "planning_time": 0.135913,
                    "create_size": 864
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_6\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_6\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name         _col_2  ss_ticket_number       amt    profit\n0       Morgan      Stephen    Five Points            998039   1735.45  -6156.22\n1         Shaw       Eunice      Riverside           1647224    725.65  -5573.21\n2       Taylor      Charles       Fairview            463019   2424.91 -34750.68\n3         Horn    Stephanie      Oak Grove           1355154   7089.97 -20344.96\n4         Horn    Stephanie      Riverside           2319505   5627.48 -15623.22\n5         Horn    Stephanie    Five Points            298948    758.80 -13945.90\n6       Ingram      Tiffany       Fairview           1697465      0.00 -10185.41\n7      Sonnier     Michelle  Pleasant Hill           1572661   3675.74  -5630.83\n8     Whitcomb      Monique       Fairview            684771   2187.22 -14746.16\n9      Gifford    Christian       Fairview            945268   1968.97  -8858.65\n10      Horton       Albert       Fairview            434209   2042.04 -14543.92\n11      Horton       Albert  Pleasant Hill           1044655    136.25  -2413.15\n12         Cox         Kali       Fairview           1429642   4946.95 -12972.97\n13        Maes      Timothy  Pleasant Hill           1300874    380.52   2455.69\n14      Taylor      Michele      Oak Grove           1205830  11333.25 -15653.41\n15       Lopez        Edwin    Five Points            861852   1545.10  -7582.29\n16      Hardin      Francis  Pleasant Hill           2099539   2412.96 -10507.38\n17        Ball         John      Oak Grove            504708   3389.64 -11917.86\n18      Ingram       Victor      Oak Grove           1024166   1099.82  -6089.51\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018285,
                    "execution_time": 0.007944,
                    "compile_time": 5e-05,
                    "planning_time": 0.003918
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.084218,
                    "execution_time": 0.007796,
                    "compile_time": 5e-05,
                    "planning_time": 0.068403
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_5\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_5\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_6\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_6\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name         _col_2  ss_ticket_number       amt    profit\n0       Morgan      Stephen    Five Points            998039   1735.45  -6156.22\n1         Shaw       Eunice      Riverside           1647224    725.65  -5573.21\n2       Taylor      Charles       Fairview            463019   2424.91 -34750.68\n3         Horn    Stephanie      Oak Grove           1355154   7089.97 -20344.96\n4         Horn    Stephanie      Riverside           2319505   5627.48 -15623.22\n5         Horn    Stephanie    Five Points            298948    758.80 -13945.90\n6       Ingram      Tiffany       Fairview           1697465      0.00 -10185.41\n7      Sonnier     Michelle  Pleasant Hill           1572661   3675.74  -5630.83\n8     Whitcomb      Monique       Fairview            684771   2187.22 -14746.16\n9      Gifford    Christian       Fairview            945268   1968.97  -8858.65\n10      Horton       Albert       Fairview            434209   2042.04 -14543.92\n11      Horton       Albert  Pleasant Hill           1044655    136.25  -2413.15\n12         Cox         Kali       Fairview           1429642   4946.95 -12972.97\n13        Maes      Timothy  Pleasant Hill           1300874    380.52   2455.69\n14      Taylor      Michele      Oak Grove           1205830  11333.25 -15653.41\n15       Lopez        Edwin    Five Points            861852   1545.10  -7582.29\n16      Hardin      Francis  Pleasant Hill           2099539   2412.96 -10507.38\n17        Ball         John      Oak Grove            504708   3389.64 -11917.86\n18      Ingram       Victor      Oak Grove           1024166   1099.82  -6089.51\n...*/"
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n    and date_dim.d_year in (1999,1999+1,1999+2) \n    and store.s_number_employees between 200 and 295\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"MS\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ADDR_SK\" , \"STORE\".\"S_CITY\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"MS\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"MS\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"MS\".\"AMT\" AS \"AMT\" , \"MS\".\"PROFIT\" AS \"PROFIT\" FROM \"MS\" AS \"MS\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ADDR_SK\" , \"STORE\".\"S_CITY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.332955,
                    "execution_time": 0.104839,
                    "compile_time": 0.0004,
                    "planning_time": 0.053649,
                    "create_size": 749
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.435114,
                    "execution_time": 0.103153,
                    "compile_time": 0.000397,
                    "planning_time": 0.152594,
                    "create_size": 749
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_7\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_7\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_7\".\"S_CITY\" FROM 1 FOR 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_7\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name         _col_2  ss_ticket_number      amt    profit\n0                     Tonya       Fairview            452055  1154.25  -7834.09\n1                     Tonya      Oak Grove            918781  1170.10  -5960.92\n2                     Tonya    Five Points           1443221  3790.26 -13621.55\n3                     Tonya  Pleasant Hill           2215805   834.13 -12618.63\n4                     Tonya       Fairview             54201  8016.21 -12381.44\n5                     Tonya  Pleasant Hill           1568912  2848.74 -11388.06\n6                     Tonya      Oak Grove           1794490  2299.90  -3831.46\n7                     Tonya       Fairview           1675807  1994.01   2606.91\n8                     Tonya      Oak Grove           1383457    44.38  -2697.00\n9                     Tonya  Pleasant Hill            114117  2080.53   2468.29\n10                    Tonya         Midway            448405  2370.58 -16895.27\n11                    Tonya      Oak Grove           1527129   746.72  -5682.01\n12                    Tonya      Riverside           1753135  6288.97 -14334.80\n13                    Tonya  Pleasant Hill            486204   713.69 -22893.86\n14                    Tonya         Midway           2146945   772.73  -2574.76\n15                    Tonya       Fairview           2147485  1895.25 -23529.44\n16                    Tonya  Pleasant Hill           1260311   507.58  -2513.23\n17                    Tonya      Oak Grove            558930     0.00    815.93\n18                    Tonya  Pleasant Hill            411128  5383.60  -8813.37\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.051109,
                    "execution_time": 0.017603,
                    "compile_time": 9.2e-05,
                    "planning_time": 0.025873
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.114781,
                    "execution_time": 0.017345,
                    "compile_time": 9.9e-05,
                    "planning_time": 0.087821
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_7\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_7\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_7\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_7\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name         _col_2  ss_ticket_number      amt    profit\n0                     Tonya       Fairview            452055  1154.25  -7834.09\n1                     Tonya      Oak Grove            918781  1170.10  -5960.92\n2                     Tonya    Five Points           1443221  3790.26 -13621.55\n3                     Tonya  Pleasant Hill           2215805   834.13 -12618.63\n4                     Tonya       Fairview             54201  8016.21 -12381.44\n5                     Tonya  Pleasant Hill           1568912  2848.74 -11388.06\n6                     Tonya      Oak Grove           1794490  2299.90  -3831.46\n7                     Tonya       Fairview           1675807  1994.01   2606.91\n8                     Tonya      Oak Grove           1383457    44.38  -2697.00\n9                     Tonya  Pleasant Hill            114117  2080.53   2468.29\n10                    Tonya         Midway            448405  2370.58 -16895.27\n11                    Tonya      Oak Grove           1527129   746.72  -5682.01\n12                    Tonya      Riverside           1753135  6288.97 -14334.80\n13                    Tonya  Pleasant Hill            486204   713.69 -22893.86\n14                    Tonya         Midway           2146945   772.73  -2574.76\n15                    Tonya       Fairview           2147485  1895.25 -23529.44\n16                    Tonya  Pleasant Hill           1260311   507.58  -2513.23\n17                    Tonya      Oak Grove            558930     0.00    815.93\n18                    Tonya  Pleasant Hill            411128  5383.60  -8813.37\n...*/"
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n    and date_dim.d_year in (1999,1999+1,1999+2) \n    and store.s_number_employees between 200 and 295\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\n    where ss_customer_sk = c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"MS\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ADDR_SK\" , \"STORE\".\"S_CITY\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"MS\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"MS\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"MS\".\"AMT\" AS \"AMT\" , \"MS\".\"PROFIT\" AS \"PROFIT\" FROM \"MS\" AS \"MS\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"MS\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ADDR_SK\" , \"STORE\".\"S_CITY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.34745,
                    "execution_time": 0.103542,
                    "compile_time": 0.000454,
                    "planning_time": 0.053869,
                    "create_size": 856
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.428292,
                    "execution_time": 0.106232,
                    "compile_time": 0.000406,
                    "planning_time": 0.128399,
                    "create_size": 856
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.330253,
                    "execution_time": 0.077284,
                    "compile_time": 0.000335,
                    "planning_time": 0.027643,
                    "create_size": 936
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.461993,
                    "execution_time": 0.07419,
                    "compile_time": 0.066216,
                    "planning_time": 0.090692,
                    "create_size": 936
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_9\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_9\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*    c_last_name c_first_name         _col_2  ss_ticket_number      amt    profit\n0       Jackson         John    Five Points           1377579  2674.49 -13923.73\n1         Davis      Colleen      Riverside           2191363  1381.86  -9841.01\n2          Love        Jerry         Midway           2131808  1869.88  -8200.92\n3                     Shanda       Fairview           1823494  2065.16  -6468.07\n4        Wilber      Micheal      Oak Grove           1557096   122.40 -11290.00\n5      Peterson       Debbie      Riverside           1328890    36.00  -2759.79\n6         Price                   Oak Grove           2233040  3853.28  -2573.50\n7         Scott      Melanie      Riverside             44184  3637.68 -12140.61\n8     Frederick         Leon      Oak Grove            696619     0.00 -14833.98\n9        Wilson        Linda       Fairview            377623  2142.85  10506.76\n10      Edwards         Mike         Midway           2212468   437.09  -8736.27\n11      Edwards         Mike       Fairview           1013875  2919.07  -8306.12\n12      Edwards         Mike         Midway           1251035  4813.51  -9710.61\n13       Priest        Jimmy      Oak Grove           2330807   143.42   2187.08\n14         Levy   Jacqueline      Oak Grove               204     0.00 -12695.11\n15        Brown       Ronald  Pleasant Hill           2337510  3084.81 -19918.83\n16       Curtis         Alan         Midway            287511  1404.51  -7010.21\n17  Christensen        Helen  Pleasant Hill           2048421  1978.51  -9803.98\n18       Henson      Ophelia      Riverside            891313   432.65  -5754.06\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01713,
                    "execution_time": 0.007165,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003831
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056499,
                    "execution_time": 0.007703,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.03936
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"_COL_2\" AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_9\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_9\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*    c_last_name c_first_name         _col_2  ss_ticket_number      amt    profit\n0       Jackson         John    Five Points           1377579  2674.49 -13923.73\n1         Davis      Colleen      Riverside           2191363  1381.86  -9841.01\n2          Love        Jerry         Midway           2131808  1869.88  -8200.92\n3                     Shanda       Fairview           1823494  2065.16  -6468.07\n4        Wilber      Micheal      Oak Grove           1557096   122.40 -11290.00\n5      Peterson       Debbie      Riverside           1328890    36.00  -2759.79\n6         Price                   Oak Grove           2233040  3853.28  -2573.50\n7         Scott      Melanie      Riverside             44184  3637.68 -12140.61\n8     Frederick         Leon      Oak Grove            696619     0.00 -14833.98\n9        Wilson        Linda       Fairview            377623  2142.85  10506.76\n10      Edwards         Mike         Midway           2212468   437.09  -8736.27\n11      Edwards         Mike       Fairview           1013875  2919.07  -8306.12\n12      Edwards         Mike         Midway           1251035  4813.51  -9710.61\n13       Priest        Jimmy      Oak Grove           2330807   143.42   2187.08\n14         Levy   Jacqueline      Oak Grove               204     0.00 -12695.11\n15        Brown       Ronald  Pleasant Hill           2337510  3084.81 -19918.83\n16       Curtis         Alan         Midway            287511  1404.51  -7010.21\n17  Christensen        Helen  Pleasant Hill           2048421  1978.51  -9803.98\n18       Henson      Ophelia      Riverside            891313   432.65  -5754.06\n...*/"
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n    and date_dim.d_year in (1999,1999+1,1999+2) \n    and store.s_number_employees between 200 and 295\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\n    where ss_customer_sk = c_customer_sk\n order by c_last_name,c_first_name,substring(s_city,1,30), profit\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"MS\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ADDR_SK\" , \"STORE\".\"S_CITY\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"MS\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"MS\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"MS\".\"AMT\" AS \"AMT\" , \"MS\".\"PROFIT\" AS \"PROFIT\" FROM \"MS\" AS \"MS\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"MS\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , SUBSTRING ( \"MS\".\"S_CITY\" , 1 , 30 ) NULLS LAST , \"PROFIT\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" FROM 1 FOR 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" , \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" FROM 1 FOR 30 ) , \"PROFIT\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name    _col_2  ss_ticket_number       amt    profit\n0                            Fairview           2209724   8523.05 -26023.68\n1                            Fairview           1906624  10628.76 -25909.25\n2                            Fairview            651014   2427.27 -25287.40\n3                            Fairview            281061   4949.35 -24874.06\n4                            Fairview           1090412   8231.22 -24829.64\n5                            Fairview           2184148   2658.50 -24663.93\n6                            Fairview           1148501   2961.78 -23940.19\n7                            Fairview           2368307   3787.01 -23255.19\n8                            Fairview           1171035    519.37 -22496.69\n9                            Fairview              9966   4707.65 -22119.71\n10                           Fairview            122732   8490.39 -21279.11\n11                           Fairview           1820418    611.33 -21031.21\n12                           Fairview           1726108   2832.62 -20276.70\n13                           Fairview           1403165   9832.01 -20155.91\n14                           Fairview           1159434   7551.52 -19960.21\n15                           Fairview            397095   3014.67 -19522.60\n16                           Fairview           1275196   1806.31 -19022.97\n17                           Fairview            589965      0.00 -19017.61\n18                           Fairview           2367226     27.09 -18161.04\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.059559,
                    "execution_time": 0.023034,
                    "compile_time": 0.000141,
                    "planning_time": 0.026875
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.205507,
                    "execution_time": 0.02455,
                    "compile_time": 0.08735,
                    "planning_time": 0.082376
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" , 1 , 30 ) NULLS LAST , \"PROFIT\" NULLS LAST",
                "rewrite": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" , 1 , 30 ) NULLS LAST , \"PROFIT\" NULLS LAST"
            }
        ],
        "preview": "\n/*   c_last_name c_first_name    _col_2  ss_ticket_number       amt    profit\n0                            Fairview           2209724   8523.05 -26023.68\n1                            Fairview           1906624  10628.76 -25909.25\n2                            Fairview            651014   2427.27 -25287.40\n3                            Fairview            281061   4949.35 -24874.06\n4                            Fairview           1090412   8231.22 -24829.64\n5                            Fairview           2184148   2658.50 -24663.93\n6                            Fairview           1148501   2961.78 -23940.19\n7                            Fairview           2368307   3787.01 -23255.19\n8                            Fairview           1171035    519.37 -22496.69\n9                            Fairview              9966   4707.65 -22119.71\n10                           Fairview            122732   8490.39 -21279.11\n11                           Fairview           1820418    611.33 -21031.21\n12                           Fairview           1726108   2832.62 -20276.70\n13                           Fairview           1403165   9832.01 -20155.91\n14                           Fairview           1159434   7551.52 -19960.21\n15                           Fairview            397095   3014.67 -19522.60\n16                           Fairview           1275196   1806.31 -19022.97\n17                           Fairview            589965      0.00 -19017.61\n18                           Fairview           2367226     27.09 -18161.04\n...*/"
    },
    {
        "input": "-- start template query79.tpl query 89 in stream 0\nselect /* TPC-DS query79.tpl 0.89 */ \n  c_last_name,c_first_name,substring(s_city,1,30),ss_ticket_number,amt,profit\n  from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,store.s_city\n          ,sum(ss_coupon_amt) amt\n          ,sum(ss_net_profit) profit\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (household_demographics.hd_dep_count = 0 or household_demographics.hd_vehicle_count > 2)\n    and date_dim.d_dow = 1\n    and date_dim.d_year in (1999,1999+1,1999+2) \n    and store.s_number_employees between 200 and 295\n    group by ss_ticket_number,ss_customer_sk,ss_addr_sk,store.s_city) ms,customer\n    where ss_customer_sk = c_customer_sk\n order by c_last_name,c_first_name,substring(s_city,1,30), profit\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"MS\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , \"STORE\".\"S_CITY\" AS \"S_CITY\" , SUM ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AMT\" , SUM ( \"STORE_SALES\".\"SS_NET_PROFIT\" ) AS \"PROFIT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_DOW\" = 1 AND \"DATE_DIM\".\"D_YEAR\" IN ( 1999 , 2000 , 2001 ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" = 0 OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 2 ) JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_NUMBER_EMPLOYEES\" <= 295 AND \"STORE\".\"S_NUMBER_EMPLOYEES\" >= 200 AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" , \"STORE_SALES\".\"SS_ADDR_SK\" , \"STORE\".\"S_CITY\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"MS\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"MS\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"MS\".\"AMT\" AS \"AMT\" , \"MS\".\"PROFIT\" AS \"PROFIT\" FROM \"MS\" AS \"MS\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"MS\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , SUBSTRING ( \"MS\".\"S_CITY\" , 1 , 30 ) NULLS LAST , \"PROFIT\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" FROM 1 FOR 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" , \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" FROM 1 FOR 30 ) , \"PROFIT\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name    _col_2  ss_ticket_number       amt    profit\n0                            Fairview           2209724   8523.05 -26023.68\n1                            Fairview           1906624  10628.76 -25909.25\n2                            Fairview            651014   2427.27 -25287.40\n3                            Fairview            281061   4949.35 -24874.06\n4                            Fairview           1090412   8231.22 -24829.64\n5                            Fairview           2184148   2658.50 -24663.93\n6                            Fairview           1148501   2961.78 -23940.19\n7                            Fairview           2368307   3787.01 -23255.19\n8                            Fairview           1171035    519.37 -22496.69\n9                            Fairview              9966   4707.65 -22119.71\n10                           Fairview            122732   8490.39 -21279.11\n11                           Fairview           1820418    611.33 -21031.21\n12                           Fairview           1726108   2832.62 -20276.70\n13                           Fairview           1403165   9832.01 -20155.91\n14                           Fairview           1159434   7551.52 -19960.21\n15                           Fairview            397095   3014.67 -19522.60\n16                           Fairview           1275196   1806.31 -19022.97\n17                           Fairview            589965      0.00 -19017.61\n18                           Fairview           2367226     27.09 -18161.04\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.060529,
                    "execution_time": 0.024526,
                    "compile_time": 0.000141,
                    "planning_time": 0.026503
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.061023,
                    "execution_time": 0.0233,
                    "compile_time": 0.000152,
                    "planning_time": 0.027859
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" , 1 , 30 ) NULLS LAST , \"PROFIT\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" , 1 , 30 ) AS \"_COL_2\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"AMT\" AS \"AMT\" , \"SPEQLITE_TEMP_TABLE_8\".\"PROFIT\" AS \"PROFIT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\" ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , SUBSTRING ( \"SPEQLITE_TEMP_TABLE_8\".\"S_CITY\" , 1 , 30 ) NULLS LAST , \"PROFIT\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   c_last_name c_first_name    _col_2  ss_ticket_number       amt    profit\n0                            Fairview           2209724   8523.05 -26023.68\n1                            Fairview           1906624  10628.76 -25909.25\n2                            Fairview            651014   2427.27 -25287.40\n3                            Fairview            281061   4949.35 -24874.06\n4                            Fairview           1090412   8231.22 -24829.64\n5                            Fairview           2184148   2658.50 -24663.93\n6                            Fairview           1148501   2961.78 -23940.19\n7                            Fairview           2368307   3787.01 -23255.19\n8                            Fairview           1171035    519.37 -22496.69\n9                            Fairview              9966   4707.65 -22119.71\n10                           Fairview            122732   8490.39 -21279.11\n11                           Fairview           1820418    611.33 -21031.21\n12                           Fairview           1726108   2832.62 -20276.70\n13                           Fairview           1403165   9832.01 -20155.91\n14                           Fairview           1159434   7551.52 -19960.21\n15                           Fairview            397095   3014.67 -19522.60\n16                           Fairview           1275196   1806.31 -19022.97\n17                           Fairview            589965      0.00 -19017.61\n18                           Fairview           2367226     27.09 -18161.04\n...*/"
    }
]