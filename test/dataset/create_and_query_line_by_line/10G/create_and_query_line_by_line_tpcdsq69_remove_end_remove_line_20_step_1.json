[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,\n  customer_address ca,\n  customer_demographics cd\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca.ca_state in ('CO','SD','TX') and\n  cd.cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales ss, date_dim dd\n          where c.c_customer_sk = ss.ss_customer_sk and\n                ss.ss_sold_date_sk = dd.d_date_sk and\n                dd.d_year = 2002 and\n                dd.d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales ws, date_dim dd\n            where c.c_customer_sk = ws.ws_bill_customer_sk and\n                  ws.ws_sold_date_sk = dd.d_date_sk and\n                  dd.d_year = 2002 and\n                  dd.d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales cs, date_dim dd\n            where c.c_customer_sk = cs.cs_ship_customer_sk and\n                  cs.cs_sold_date_sk = dd.d_date_sk))\ngroup by cd_gender, cd_marital_status, cd_education_status, cd_purchase_estimate, cd_credit_rating\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DD\" AS ( SELECT \"DD\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DD\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DD\".\"D_DATE\" AS \"D_DATE\" , \"DD\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DD\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DD\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DD\".\"D_YEAR\" AS \"D_YEAR\" , \"DD\".\"D_DOW\" AS \"D_DOW\" , \"DD\".\"D_MOY\" AS \"D_MOY\" , \"DD\".\"D_DOM\" AS \"D_DOM\" , \"DD\".\"D_QOY\" AS \"D_QOY\" , \"DD\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DD\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DD\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DD\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DD\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DD\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DD\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DD\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DD\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DD\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DD\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DD\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DD\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DD\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DD\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DD\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DD\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DD\" WHERE \"DD\".\"D_MOY\" <= 3 AND \"DD\".\"D_MOY\" >= 1 AND \"DD\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"DD\" AS \"DD\" ON \"DD\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" GROUP BY \"SS\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"DD\" AS \"DD\" ON \"DD\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" GROUP BY \"WS\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"DATE_DIM\" AS \"DD\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"DD\".\"D_DATE_SK\" GROUP BY \"CS\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"DD\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DD\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DD\".\"D_DATE\" AS \"D_DATE\" , \"DD\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DD\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DD\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DD\".\"D_YEAR\" AS \"D_YEAR\" , \"DD\".\"D_DOW\" AS \"D_DOW\" , \"DD\".\"D_MOY\" AS \"D_MOY\" , \"DD\".\"D_DOM\" AS \"D_DOM\" , \"DD\".\"D_QOY\" AS \"D_QOY\" , \"DD\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DD\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DD\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DD\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DD\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DD\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DD\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DD\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DD\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DD\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DD\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DD\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DD\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DD\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DD\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DD\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DD\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DD\" WHERE \"DD\".\"D_MOY\" <= 3 AND \"DD\".\"D_MOY\" >= 1 AND \"DD\".\"D_YEAR\" = 2002",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.097916,
                    "execution_time": 0.037173,
                    "compile_time": 0.000313,
                    "planning_time": 0.029621,
                    "create_size": 31
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.181104,
                    "execution_time": 0.05452,
                    "compile_time": 0.000337,
                    "planning_time": 0.09248,
                    "create_size": 31
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" GROUP BY \"SS\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.139173,
                    "execution_time": 0.068734,
                    "compile_time": 0.00032,
                    "planning_time": 0.028536,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.207414,
                    "execution_time": 0.065007,
                    "compile_time": 0.000331,
                    "planning_time": 0.097817,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" GROUP BY \"WS\".\"WS_BILL_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.119958,
                    "execution_time": 0.060343,
                    "compile_time": 0.00033,
                    "planning_time": 0.029402,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.191843,
                    "execution_time": 0.063585,
                    "compile_time": 0.000335,
                    "planning_time": 0.094622,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"DATE_DIM\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"D_DATE_SK\" GROUP BY \"CS\".\"CS_SHIP_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.412897,
                    "execution_time": 0.304223,
                    "compile_time": 0.000333,
                    "planning_time": 0.033828,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.485983,
                    "execution_time": 0.302138,
                    "compile_time": 0.000345,
                    "planning_time": 0.102636,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_3\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_4\".\"_U_5\" IS NULL GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.242745,
                    "execution_time": 0.107331,
                    "compile_time": 0.045955,
                    "planning_time": 0.047594,
                    "create_size": 88
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.606659,
                    "execution_time": 0.132451,
                    "compile_time": 3.306181,
                    "planning_time": 0.119262,
                    "create_size": 88
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D         2 yr Degree     1                  9500     1        High Risk     1\n1          M                 U         2 yr Degree     1                  7500     1          Unknown     1\n2          M                 M         2 yr Degree     1                  8000     1        High Risk     1\n3          F                 M     Advanced Degree     1                  3500     1          Unknown     1\n4          M                 S     Advanced Degree     1                  5500     1             Good     1\n5          M                 W           Secondary     1                 10000     1          Unknown     1\n6          F                 M             Unknown     2                   500     2        High Risk     2\n7          F                 U             Unknown     1                  6500     1        High Risk     1\n8          M                 D             Unknown     1                  5000     1          Unknown     1\n9          F                 M             College     3                  6000     3         Low Risk     3\n10         M                 M         4 yr Degree     1                  8500     1          Unknown     1\n11         F                 W         4 yr Degree     1                  1000     1         Low Risk     1\n12         M                 U           Secondary     2                  1500     2         Low Risk     2\n13         M                 U             Unknown     2                  3500     2        High Risk     2\n14         F                 M             Unknown     1                  8000     1         Low Risk     1\n15         F                 D             Primary     1                   500     1         Low Risk     1\n16         M                 D         2 yr Degree     1                  9000     1        High Risk     1\n17         M                 D           Secondary     1                  6500     1          Unknown     1\n18         M                 U           Secondary     1                  5000     1         Low Risk     1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017491,
                    "execution_time": 0.007027,
                    "compile_time": 5e-05,
                    "planning_time": 0.004137
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057931,
                    "execution_time": 0.008179,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039893
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_3\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_4\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_2\".\"_U_1\" IS NULL GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D         2 yr Degree     1                  9500     1        High Risk     1\n1          M                 U         2 yr Degree     1                  7500     1          Unknown     1\n2          M                 M         2 yr Degree     1                  8000     1        High Risk     1\n3          F                 M     Advanced Degree     1                  3500     1          Unknown     1\n4          M                 S     Advanced Degree     1                  5500     1             Good     1\n5          M                 W           Secondary     1                 10000     1          Unknown     1\n6          F                 M             Unknown     2                   500     2        High Risk     2\n7          F                 U             Unknown     1                  6500     1        High Risk     1\n8          M                 D             Unknown     1                  5000     1          Unknown     1\n9          F                 M             College     3                  6000     3         Low Risk     3\n10         M                 M         4 yr Degree     1                  8500     1          Unknown     1\n11         F                 W         4 yr Degree     1                  1000     1         Low Risk     1\n12         M                 U           Secondary     2                  1500     2         Low Risk     2\n13         M                 U             Unknown     2                  3500     2        High Risk     2\n14         F                 M             Unknown     1                  8000     1         Low Risk     1\n15         F                 D             Primary     1                   500     1         Low Risk     1\n16         M                 D         2 yr Degree     1                  9000     1        High Risk     1\n17         M                 D           Secondary     1                  6500     1          Unknown     1\n18         M                 U           Secondary     1                  5000     1         Low Risk     1\n...*/"
    },
    {
        "input": "select /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c\n join customer_address ca on c.c_current_addr_sk = ca.ca_address_sk\n join customer_demographics cd on cd.cd_demo_sk = c.c_current_cdemo_sk\n where\n  ca_state in ('CO','SD','TX') and\n  exists (select *\n          from store_sales ss\n          join date_dim d on ss.ss_sold_date_sk = d.d_date_sk\n          where c.c_customer_sk = ss.ss_customer_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n                from web_sales ws\n                join date_dim d on ws.ws_sold_date_sk = d.d_date_sk\n                where c.c_customer_sk = ws.ws_bill_customer_sk and\n                      d_year = 2002 and\n                      d_moy between 1 and 1+2) and\n    not exists (select * \n                from catalog_sales cs\n                join date_dim d on cs.cs_sold_date_sk = d.d_date_sk\n                where c.c_customer_sk = cs.cs_ship_customer_sk and\n                      d_year = 2002 and\n                      d_moy between 1 and 1+2))\n group by\n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  cd_purchase_estimate,\n  cd_credit_rating\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"D\" AS ( SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"D\".\"D_DATE\" AS \"D_DATE\" , \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"D\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"D\".\"D_YEAR\" AS \"D_YEAR\" , \"D\".\"D_DOW\" AS \"D_DOW\" , \"D\".\"D_MOY\" AS \"D_MOY\" , \"D\".\"D_DOM\" AS \"D_DOM\" , \"D\".\"D_QOY\" AS \"D_QOY\" , \"D\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"D\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"D\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"D\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"D\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"D\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"D\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"D\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"D\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"D\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"D\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"D\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"D\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"D\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"D\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"D\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"D\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MOY\" <= 3 AND \"D\".\"D_MOY\" >= 1 AND \"D\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" GROUP BY \"SS\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"D\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" GROUP BY \"WS\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"D\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\" GROUP BY \"CS\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"D\".\"D_DATE\" AS \"D_DATE\" , \"D\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"D\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"D\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"D\".\"D_YEAR\" AS \"D_YEAR\" , \"D\".\"D_DOW\" AS \"D_DOW\" , \"D\".\"D_MOY\" AS \"D_MOY\" , \"D\".\"D_DOM\" AS \"D_DOM\" , \"D\".\"D_QOY\" AS \"D_QOY\" , \"D\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"D\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"D\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"D\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"D\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"D\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"D\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"D\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"D\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"D\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"D\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"D\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"D\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"D\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"D\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"D\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"D\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_MOY\" <= 3 AND \"D\".\"D_MOY\" >= 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.189895,
                    "execution_time": 0.053453,
                    "compile_time": 0.000323,
                    "planning_time": 0.030585,
                    "create_size": 868
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.259386,
                    "execution_time": 0.054665,
                    "compile_time": 0.000319,
                    "planning_time": 0.096908,
                    "create_size": 868
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" GROUP BY \"SS\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.241773,
                    "execution_time": 0.140495,
                    "compile_time": 0.000329,
                    "planning_time": 0.027407,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.314421,
                    "execution_time": 0.14256,
                    "compile_time": 0.000354,
                    "planning_time": 0.09159,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" GROUP BY \"WS\".\"WS_BILL_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.136706,
                    "execution_time": 0.063133,
                    "compile_time": 0.00034,
                    "planning_time": 0.028946,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.213306,
                    "execution_time": 0.062882,
                    "compile_time": 0.000328,
                    "planning_time": 0.100961,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"D_DATE_SK\" GROUP BY \"CS\".\"CS_SHIP_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.179458,
                    "execution_time": 0.080103,
                    "compile_time": 0.000328,
                    "planning_time": 0.02926,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.253504,
                    "execution_time": 0.07921,
                    "compile_time": 0.00033,
                    "planning_time": 0.098688,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_8\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_9\".\"_U_5\" IS NULL GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.189261,
                    "execution_time": 0.094119,
                    "compile_time": 0.000585,
                    "planning_time": 0.047883,
                    "create_size": 88
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.430992,
                    "execution_time": 0.094409,
                    "compile_time": 0.165057,
                    "planning_time": 0.118754,
                    "create_size": 88
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_10\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_10\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_10\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_10\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 U             College     4                  6000     4         Low Risk     4\n1          M                 D         2 yr Degree     7                  6000     7        High Risk     7\n2          M                 U           Secondary     4                  4500     4         Low Risk     4\n3          F                 W         4 yr Degree     5                  5500     5          Unknown     5\n4          F                 S           Secondary     9                  6500     9             Good     9\n5          M                 S         4 yr Degree     5                  3000     5         Low Risk     5\n6          M                 D             College     5                  7000     5         Low Risk     5\n7          F                 M         4 yr Degree    11                   500    11             Good    11\n8          F                 S             College     6                  6500     6         Low Risk     6\n9          M                 M             Unknown     7                  7500     7        High Risk     7\n10         F                 S     Advanced Degree     7                  3500     7         Low Risk     7\n11         M                 U     Advanced Degree     7                  9000     7        High Risk     7\n12         F                 M     Advanced Degree     5                  8500     5        High Risk     5\n13         F                 S             Unknown     8                  3500     8          Unknown     8\n14         M                 D           Secondary     5                  4500     5        High Risk     5\n15         M                 S         2 yr Degree     7                  9000     7             Good     7\n16         M                 D           Secondary    10                  1000    10        High Risk    10\n17         M                 D         2 yr Degree     4                  7500     4         Low Risk     4\n18         M                 M     Advanced Degree     8                  9000     8         Low Risk     8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01795,
                    "execution_time": 0.007128,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004332
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056979,
                    "execution_time": 0.007518,
                    "compile_time": 5e-05,
                    "planning_time": 0.039876
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CD\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" ON \"SPEQLITE_TEMP_TABLE_8\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_8\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_9\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL GROUP BY \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_EDUCATION_STATUS\" , \"CD\".\"CD_PURCHASE_ESTIMATE\" , \"CD\".\"CD_CREDIT_RATING\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_10\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_10\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_10\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_10\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 U             College     4                  6000     4         Low Risk     4\n1          M                 D         2 yr Degree     7                  6000     7        High Risk     7\n2          M                 U           Secondary     4                  4500     4         Low Risk     4\n3          F                 W         4 yr Degree     5                  5500     5          Unknown     5\n4          F                 S           Secondary     9                  6500     9             Good     9\n5          M                 S         4 yr Degree     5                  3000     5         Low Risk     5\n6          M                 D             College     5                  7000     5         Low Risk     5\n7          F                 M         4 yr Degree    11                   500    11             Good    11\n8          F                 S             College     6                  6500     6         Low Risk     6\n9          M                 M             Unknown     7                  7500     7        High Risk     7\n10         F                 S     Advanced Degree     7                  3500     7         Low Risk     7\n11         M                 U     Advanced Degree     7                  9000     7        High Risk     7\n12         F                 M     Advanced Degree     5                  8500     5        High Risk     5\n13         F                 S             Unknown     8                  3500     8          Unknown     8\n14         M                 D           Secondary     5                  4500     5        High Risk     5\n15         M                 S         2 yr Degree     7                  9000     7             Good     7\n16         M                 D           Secondary    10                  1000    10        High Risk    10\n17         M                 D         2 yr Degree     4                  7500     4         Low Risk     4\n18         M                 M     Advanced Degree     8                  9000     8         Low Risk     8\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','SD','TX') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status, cd_purchase_estimate, cd_credit_rating\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 3 AND \"DATE_DIM\".\"D_MOY\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 3 AND \"DATE_DIM\".\"D_MOY\" >= 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.189223,
                    "execution_time": 0.054207,
                    "compile_time": 0.000319,
                    "planning_time": 0.028856,
                    "create_size": 868
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.250719,
                    "execution_time": 0.053144,
                    "compile_time": 0.000312,
                    "planning_time": 0.091441,
                    "create_size": 868
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.241099,
                    "execution_time": 0.139417,
                    "compile_time": 0.00033,
                    "planning_time": 0.028587,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.309136,
                    "execution_time": 0.139368,
                    "compile_time": 0.000366,
                    "planning_time": 0.095516,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.136458,
                    "execution_time": 0.063599,
                    "compile_time": 0.000319,
                    "planning_time": 0.029011,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.198442,
                    "execution_time": 0.062826,
                    "compile_time": 0.000315,
                    "planning_time": 0.091323,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.180055,
                    "execution_time": 0.080842,
                    "compile_time": 0.000329,
                    "planning_time": 0.02899,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.250254,
                    "execution_time": 0.080185,
                    "compile_time": 0.000331,
                    "planning_time": 0.099265,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ON \"SPEQLITE_TEMP_TABLE_13\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_13\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_14\".\"_U_5\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.201556,
                    "execution_time": 0.090826,
                    "compile_time": 0.000581,
                    "planning_time": 0.06312,
                    "create_size": 88
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.265132,
                    "execution_time": 0.098585,
                    "compile_time": 0.000581,
                    "planning_time": 0.118954,
                    "create_size": 88
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 W             Unknown     6                  9500     6          Unknown     6\n1          M                 D           Secondary     6                  2000     6          Unknown     6\n2          F                 D             Primary     5                  5000     5          Unknown     5\n3          F                 S             Unknown     8                  5500     8        High Risk     8\n4          M                 W         4 yr Degree     4                  7500     4         Low Risk     4\n5          F                 D         2 yr Degree     7                  9500     7        High Risk     7\n6          F                 W             Primary    10                  4000    10          Unknown    10\n7          F                 W             Primary     4                  2000     4             Good     4\n8          M                 D           Secondary     7                  7000     7         Low Risk     7\n9          M                 M             Primary    10                 10000    10        High Risk    10\n10         M                 S         4 yr Degree     8                  4500     8          Unknown     8\n11         F                 S             Unknown     5                  2500     5          Unknown     5\n12         M                 M             Primary     9                  4000     9         Low Risk     9\n13         M                 U         4 yr Degree     4                  7000     4          Unknown     4\n14         F                 M     Advanced Degree     3                  3000     3             Good     3\n15         M                 M             Unknown     8                  1000     8         Low Risk     8\n16         F                 M             Primary     7                  3500     7             Good     7\n17         F                 U             College    10                  1500    10          Unknown    10\n18         M                 U         2 yr Degree     9                  6500     9        High Risk     9\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018529,
                    "execution_time": 0.007748,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004259
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05538,
                    "execution_time": 0.007792,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.040811
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ON \"SPEQLITE_TEMP_TABLE_13\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_13\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_14\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 W             Unknown     6                  9500     6          Unknown     6\n1          M                 D           Secondary     6                  2000     6          Unknown     6\n2          F                 D             Primary     5                  5000     5          Unknown     5\n3          F                 S             Unknown     8                  5500     8        High Risk     8\n4          M                 W         4 yr Degree     4                  7500     4         Low Risk     4\n5          F                 D         2 yr Degree     7                  9500     7        High Risk     7\n6          F                 W             Primary    10                  4000    10          Unknown    10\n7          F                 W             Primary     4                  2000     4             Good     4\n8          M                 D           Secondary     7                  7000     7         Low Risk     7\n9          M                 M             Primary    10                 10000    10        High Risk    10\n10         M                 S         4 yr Degree     8                  4500     8          Unknown     8\n11         F                 S             Unknown     5                  2500     5          Unknown     5\n12         M                 M             Primary     9                  4000     9         Low Risk     9\n13         M                 U         4 yr Degree     4                  7000     4          Unknown     4\n14         F                 M     Advanced Degree     3                  3000     3             Good     3\n15         M                 M             Unknown     8                  1000     8         Low Risk     8\n16         F                 M             Primary     7                  3500     7             Good     7\n17         F                 U             College    10                  1500    10          Unknown    10\n18         M                 U         2 yr Degree     9                  6500     9        High Risk     9\n...*/"
    },
    {
        "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','SD','TX') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 3 AND \"DATE_DIM\".\"D_MOY\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"SPEQLITE_TEMP_TABLE_11\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_DATE\" AS \"D_DATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_DOW\" AS \"D_DOW\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_DOM\" AS \"D_DOM\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"SPEQLITE_TEMP_TABLE_11\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.183165,
                    "execution_time": 0.066754,
                    "compile_time": 0.000327,
                    "planning_time": 0.007816,
                    "create_size": 744
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.240831,
                    "execution_time": 0.065668,
                    "compile_time": 0.000329,
                    "planning_time": 0.065349,
                    "create_size": 744
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.246291,
                    "execution_time": 0.141445,
                    "compile_time": 0.000352,
                    "planning_time": 0.029565,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.304698,
                    "execution_time": 0.139617,
                    "compile_time": 0.000341,
                    "planning_time": 0.08984,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.138581,
                    "execution_time": 0.063547,
                    "compile_time": 0.00033,
                    "planning_time": 0.030027,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.206911,
                    "execution_time": 0.063352,
                    "compile_time": 0.000374,
                    "planning_time": 0.098195,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.179648,
                    "execution_time": 0.080161,
                    "compile_time": 0.000335,
                    "planning_time": 0.029105,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.245758,
                    "execution_time": 0.081276,
                    "compile_time": 0.000342,
                    "planning_time": 0.093766,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ON \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.186275,
                    "execution_time": 0.091392,
                    "compile_time": 0.000577,
                    "planning_time": 0.047675,
                    "create_size": 88
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.257952,
                    "execution_time": 0.092881,
                    "compile_time": 0.00059,
                    "planning_time": 0.117319,
                    "create_size": 88
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 W             College     5                  2500     5          Unknown     5\n1          F                 W         2 yr Degree     8                  5500     8          Unknown     8\n2          F                 U             College     8                  3500     8          Unknown     8\n3          M                 D             Primary     3                  6500     3             Good     3\n4          M                 U             Primary     5                  2500     5             Good     5\n5          M                 M             Unknown     7                  1000     7        High Risk     7\n6          F                 W             Unknown     7                  6000     7         Low Risk     7\n7          F                 U           Secondary     2                  4000     2          Unknown     2\n8          F                 D         2 yr Degree     7                  4500     7         Low Risk     7\n9          F                 D             College     8                  3000     8        High Risk     8\n10         F                 S             Unknown     4                  9500     4          Unknown     4\n11         M                 D     Advanced Degree     7                  7000     7             Good     7\n12         F                 S         4 yr Degree     8                  8500     8             Good     8\n13         F                 S             Primary     8                  8500     8          Unknown     8\n14         M                 S             Unknown     5                  4000     5             Good     5\n15         F                 M         4 yr Degree     9                  1500     9          Unknown     9\n16         M                 W             Primary     4                  7500     4         Low Risk     4\n17         M                 M             College     9                  4000     9          Unknown     9\n18         F                 W         4 yr Degree     5                 10000     5             Good     5\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018444,
                    "execution_time": 0.007849,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004269
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05369,
                    "execution_time": 0.00741,
                    "compile_time": 5e-05,
                    "planning_time": 0.039791
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ON \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 W             College     5                  2500     5          Unknown     5\n1          F                 W         2 yr Degree     8                  5500     8          Unknown     8\n2          F                 U             College     8                  3500     8          Unknown     8\n3          M                 D             Primary     3                  6500     3             Good     3\n4          M                 U             Primary     5                  2500     5             Good     5\n5          M                 M             Unknown     7                  1000     7        High Risk     7\n6          F                 W             Unknown     7                  6000     7         Low Risk     7\n7          F                 U           Secondary     2                  4000     2          Unknown     2\n8          F                 D         2 yr Degree     7                  4500     7         Low Risk     7\n9          F                 D             College     8                  3000     8        High Risk     8\n10         F                 S             Unknown     4                  9500     4          Unknown     4\n11         M                 D     Advanced Degree     7                  7000     7             Good     7\n12         F                 S         4 yr Degree     8                  8500     8             Good     8\n13         F                 S             Primary     8                  8500     8          Unknown     8\n14         M                 S             Unknown     5                  4000     5             Good     5\n15         F                 M         4 yr Degree     9                  1500     9          Unknown     9\n16         M                 W             Primary     4                  7500     4         Low Risk     4\n17         M                 M             College     9                  4000     9          Unknown     9\n18         F                 W         4 yr Degree     5                 10000     5             Good     5\n...*/"
    },
    {
        "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','SD','TX') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 3 AND \"DATE_DIM\".\"D_MOY\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"CNT1\" AS \"CNT1\" , \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"CNT2\" AS \"CNT2\" , \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 W             College     5                  2500     5          Unknown     5\n1          F                 W         2 yr Degree     8                  5500     8          Unknown     8\n2          F                 U             College     8                  3500     8          Unknown     8\n3          M                 D             Primary     3                  6500     3             Good     3\n4          M                 U             Primary     5                  2500     5             Good     5\n5          M                 M             Unknown     7                  1000     7        High Risk     7\n6          F                 W             Unknown     7                  6000     7         Low Risk     7\n7          F                 U           Secondary     2                  4000     2          Unknown     2\n8          F                 D         2 yr Degree     7                  4500     7         Low Risk     7\n9          F                 D             College     8                  3000     8        High Risk     8\n10         F                 S             Unknown     4                  9500     4          Unknown     4\n11         M                 D     Advanced Degree     7                  7000     7             Good     7\n12         F                 S         4 yr Degree     8                  8500     8             Good     8\n13         F                 S             Primary     8                  8500     8          Unknown     8\n14         M                 S             Unknown     5                  4000     5             Good     5\n15         F                 M         4 yr Degree     9                  1500     9          Unknown     9\n16         M                 W             Primary     4                  7500     4         Low Risk     4\n17         M                 M             College     9                  4000     9          Unknown     9\n18         F                 W         4 yr Degree     5                 10000     5             Good     5\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018206,
                    "execution_time": 0.007575,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004257
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05345,
                    "execution_time": 0.007503,
                    "compile_time": 5e-05,
                    "planning_time": 0.039509
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ON \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\"",
                "rewrite": "SELECT \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\", \"CNT1\" AS \"CNT1\", \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\", \"CNT2\" AS \"CNT2\", \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\", \"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 W             College     5                  2500     5          Unknown     5\n1          F                 W         2 yr Degree     8                  5500     8          Unknown     8\n2          F                 U             College     8                  3500     8          Unknown     8\n3          M                 D             Primary     3                  6500     3             Good     3\n4          M                 U             Primary     5                  2500     5             Good     5\n5          M                 M             Unknown     7                  1000     7        High Risk     7\n6          F                 W             Unknown     7                  6000     7         Low Risk     7\n7          F                 U           Secondary     2                  4000     2          Unknown     2\n8          F                 D         2 yr Degree     7                  4500     7         Low Risk     7\n9          F                 D             College     8                  3000     8        High Risk     8\n10         F                 S             Unknown     4                  9500     4          Unknown     4\n11         M                 D     Advanced Degree     7                  7000     7             Good     7\n12         F                 S         4 yr Degree     8                  8500     8             Good     8\n13         F                 S             Primary     8                  8500     8          Unknown     8\n14         M                 S             Unknown     5                  4000     5             Good     5\n15         F                 M         4 yr Degree     9                  1500     9          Unknown     9\n16         M                 W             Primary     4                  7500     4         Low Risk     4\n17         M                 M             College     9                  4000     9          Unknown     9\n18         F                 W         4 yr Degree     5                 10000     5             Good     5\n...*/"
    },
    {
        "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','SD','TX') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 3 AND \"DATE_DIM\".\"D_MOY\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"CNT1\" AS \"CNT1\" , \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"CNT2\" AS \"CNT2\" , \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 U             Primary     9                  1500     9        High Risk     9\n1          M                 S     Advanced Degree     7                  1000     7             Good     7\n2          F                 W         4 yr Degree     6                  6000     6         Low Risk     6\n3          F                 D             Unknown     8                  8500     8        High Risk     8\n4          F                 D           Secondary     3                  4500     3        High Risk     3\n5          F                 S         4 yr Degree     7                  2500     7          Unknown     7\n6          M                 W           Secondary     6                   500     6         Low Risk     6\n7          M                 D         2 yr Degree     3                  1000     3             Good     3\n8          F                 W     Advanced Degree     5                  8000     5        High Risk     5\n9          M                 S         2 yr Degree     5                  5500     5         Low Risk     5\n10         F                 S             College     6                  9000     6         Low Risk     6\n11         F                 S             Primary     4                  2000     4        High Risk     4\n12         M                 D             Unknown    10                  4500    10        High Risk    10\n13         M                 M           Secondary     3                  6000     3         Low Risk     3\n14         F                 D         4 yr Degree     5                  8500     5             Good     5\n15         F                 M     Advanced Degree     6                  2500     6        High Risk     6\n16         F                 D             College     4                  2500     4        High Risk     4\n17         F                 U           Secondary    11                  2500    11          Unknown    11\n18         F                 W     Advanced Degree     4                  3500     4             Good     4\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.0179,
                    "execution_time": 0.007372,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004194
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.029376,
                    "execution_time": 0.007525,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004316
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ON \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\"",
                "rewrite": "SELECT \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\", \"CNT1\" AS \"CNT1\", \"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\", \"CNT2\" AS \"CNT2\", \"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\", \"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\""
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 U             Primary     9                  1500     9        High Risk     9\n1          M                 S     Advanced Degree     7                  1000     7             Good     7\n2          F                 W         4 yr Degree     6                  6000     6         Low Risk     6\n3          F                 D             Unknown     8                  8500     8        High Risk     8\n4          F                 D           Secondary     3                  4500     3        High Risk     3\n5          F                 S         4 yr Degree     7                  2500     7          Unknown     7\n6          M                 W           Secondary     6                   500     6         Low Risk     6\n7          M                 D         2 yr Degree     3                  1000     3             Good     3\n8          F                 W     Advanced Degree     5                  8000     5        High Risk     5\n9          M                 S         2 yr Degree     5                  5500     5         Low Risk     5\n10         F                 S             College     6                  9000     6         Low Risk     6\n11         F                 S             Primary     4                  2000     4        High Risk     4\n12         M                 D             Unknown    10                  4500    10        High Risk    10\n13         M                 M           Secondary     3                  6000     3         Low Risk     3\n14         F                 D         4 yr Degree     5                  8500     5             Good     5\n15         F                 M     Advanced Degree     6                  2500     6        High Risk     6\n16         F                 D             College     4                  2500     4        High Risk     4\n17         F                 U           Secondary    11                  2500    11          Unknown    11\n18         F                 W     Advanced Degree     4                  3500     4             Good     4\n...*/"
    },
    {
        "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','SD','TX') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 3 AND \"DATE_DIM\".\"D_MOY\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 S             Primary     8                  8000     8        High Risk     8\n1          F                 S             College    12                  1000    12        High Risk    12\n2          F                 M             College     8                  6500     8        High Risk     8\n3          F                 M     Advanced Degree     1                  5500     1         Low Risk     1\n4          F                 W     Advanced Degree     9                  7000     9         Low Risk     9\n5          F                 S         4 yr Degree     8                  3000     8          Unknown     8\n6          F                 M           Secondary     4                  7500     4             Good     4\n7          F                 S           Secondary     9                  7000     9         Low Risk     9\n8          F                 W             Primary     8                  8000     8         Low Risk     8\n9          F                 D           Secondary     9                  5500     9        High Risk     9\n10         F                 S     Advanced Degree    12                  7000    12          Unknown    12\n11         F                 D             Unknown     5                  6500     5          Unknown     5\n12         F                 M         2 yr Degree     7                  7000     7             Good     7\n13         F                 W         2 yr Degree     8                  5500     8          Unknown     8\n14         F                 U         2 yr Degree     7                  3500     7        High Risk     7\n15         F                 D     Advanced Degree    10                  9000    10          Unknown    10\n16         F                 M             College     6                  1000     6             Good     6\n17         F                 W             College     5                  2500     5          Unknown     5\n18         F                 D         2 yr Degree     7                 10000     7             Good     7\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018999,
                    "execution_time": 0.008166,
                    "compile_time": 7.7e-05,
                    "planning_time": 0.004397
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058679,
                    "execution_time": 0.009039,
                    "compile_time": 7.6e-05,
                    "planning_time": 0.039866
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ON \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 S             Primary     8                  8000     8        High Risk     8\n1          F                 S             College    12                  1000    12        High Risk    12\n2          F                 M             College     8                  6500     8        High Risk     8\n3          F                 M     Advanced Degree     1                  5500     1         Low Risk     1\n4          F                 W     Advanced Degree     9                  7000     9         Low Risk     9\n5          F                 S         4 yr Degree     8                  3000     8          Unknown     8\n6          F                 M           Secondary     4                  7500     4             Good     4\n7          F                 S           Secondary     9                  7000     9         Low Risk     9\n8          F                 W             Primary     8                  8000     8         Low Risk     8\n9          F                 D           Secondary     9                  5500     9        High Risk     9\n10         F                 S     Advanced Degree    12                  7000    12          Unknown    12\n11         F                 D             Unknown     5                  6500     5          Unknown     5\n12         F                 M         2 yr Degree     7                  7000     7             Good     7\n13         F                 W         2 yr Degree     8                  5500     8          Unknown     8\n14         F                 U         2 yr Degree     7                  3500     7        High Risk     7\n15         F                 D     Advanced Degree    10                  9000    10          Unknown    10\n16         F                 M             College     6                  1000     6             Good     6\n17         F                 W             College     5                  2500     5          Unknown     5\n18         F                 D         2 yr Degree     7                 10000     7             Good     7\n...*/"
    },
    {
        "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','SD','TX') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 3 AND \"DATE_DIM\".\"D_MOY\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D         4 yr Degree     7                  9500     7             Good     7\n1          F                 D         2 yr Degree     7                  6000     7             Good     7\n2          F                 D         2 yr Degree     6                  1500     6         Low Risk     6\n3          F                 D         2 yr Degree     6                   500     6         Low Risk     6\n4          F                 D             College     6                  7500     6             Good     6\n5          F                 D             Unknown     2                  9000     2          Unknown     2\n6          F                 D             College     5                   500     5             Good     5\n7          F                 D     Advanced Degree     4                  2000     4             Good     4\n8          F                 D         2 yr Degree     4                 10000     4        High Risk     4\n9          F                 D         4 yr Degree     2                  7500     2        High Risk     2\n10         F                 D             Primary     6                  6500     6             Good     6\n11         F                 D         2 yr Degree     5                  6000     5          Unknown     5\n12         F                 D         2 yr Degree     7                  9000     7             Good     7\n13         F                 D             College     8                  4000     8          Unknown     8\n14         F                 D           Secondary     5                  3500     5         Low Risk     5\n15         F                 D             Unknown     4                  6500     4             Good     4\n16         F                 D         2 yr Degree     4                  8000     4        High Risk     4\n17         F                 D     Advanced Degree     7                  4000     7        High Risk     7\n18         F                 D             Primary     6                  7000     6             Good     6\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019704,
                    "execution_time": 0.008133,
                    "compile_time": 7.8e-05,
                    "planning_time": 0.004549
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056029,
                    "execution_time": 0.00936,
                    "compile_time": 7.8e-05,
                    "planning_time": 0.039917
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ON \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D         4 yr Degree     7                  9500     7             Good     7\n1          F                 D         2 yr Degree     7                  6000     7             Good     7\n2          F                 D         2 yr Degree     6                  1500     6         Low Risk     6\n3          F                 D         2 yr Degree     6                   500     6         Low Risk     6\n4          F                 D             College     6                  7500     6             Good     6\n5          F                 D             Unknown     2                  9000     2          Unknown     2\n6          F                 D             College     5                   500     5             Good     5\n7          F                 D     Advanced Degree     4                  2000     4             Good     4\n8          F                 D         2 yr Degree     4                 10000     4        High Risk     4\n9          F                 D         4 yr Degree     2                  7500     2        High Risk     2\n10         F                 D             Primary     6                  6500     6             Good     6\n11         F                 D         2 yr Degree     5                  6000     5          Unknown     5\n12         F                 D         2 yr Degree     7                  9000     7             Good     7\n13         F                 D             College     8                  4000     8          Unknown     8\n14         F                 D           Secondary     5                  3500     5         Low Risk     5\n15         F                 D             Unknown     4                  6500     4             Good     4\n16         F                 D         2 yr Degree     4                  8000     4        High Risk     4\n17         F                 D     Advanced Degree     7                  4000     7        High Risk     7\n18         F                 D             Primary     6                  7000     6             Good     6\n...*/"
    },
    {
        "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','SD','TX') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status\n/*CURSOR_IDENTIFIER*/\n",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 3 AND \"DATE_DIM\".\"D_MOY\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D         2 yr Degree     4                  8000     4        High Risk     4\n1          F                 D         2 yr Degree     5                  6000     5          Unknown     5\n2          F                 D         2 yr Degree     6                  4000     6             Good     6\n3          F                 D         2 yr Degree     7                  2000     7             Good     7\n4          F                 D         2 yr Degree     6                  1500     6         Low Risk     6\n5          F                 D         2 yr Degree     5                  7000     5        High Risk     5\n6          F                 D         2 yr Degree     7                   500     7             Good     7\n7          F                 D         2 yr Degree     7                  6000     7             Good     7\n8          F                 D         2 yr Degree     6                  4500     6             Good     6\n9          F                 D         2 yr Degree     6                   500     6         Low Risk     6\n10         F                 D         2 yr Degree     6                  5500     6        High Risk     6\n11         F                 D         2 yr Degree     5                  5000     5             Good     5\n12         F                 D         2 yr Degree     7                  8500     7        High Risk     7\n13         F                 D         2 yr Degree     7                  4500     7         Low Risk     7\n14         F                 D         2 yr Degree     7                 10000     7             Good     7\n15         F                 D         2 yr Degree     7                  7000     7          Unknown     7\n16         F                 D         2 yr Degree     4                 10000     4        High Risk     4\n17         F                 D         2 yr Degree     4                  4000     4        High Risk     4\n18         F                 D         2 yr Degree     6                  8000     6          Unknown     6\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018982,
                    "execution_time": 0.008116,
                    "compile_time": 7.8e-05,
                    "planning_time": 0.004562
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056436,
                    "execution_time": 0.009343,
                    "compile_time": 8.1e-05,
                    "planning_time": 0.040315
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ON \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D         2 yr Degree     4                  8000     4        High Risk     4\n1          F                 D         2 yr Degree     5                  6000     5          Unknown     5\n2          F                 D         2 yr Degree     6                  4000     6             Good     6\n3          F                 D         2 yr Degree     7                  2000     7             Good     7\n4          F                 D         2 yr Degree     6                  1500     6         Low Risk     6\n5          F                 D         2 yr Degree     5                  7000     5        High Risk     5\n6          F                 D         2 yr Degree     7                   500     7             Good     7\n7          F                 D         2 yr Degree     7                  6000     7             Good     7\n8          F                 D         2 yr Degree     6                  4500     6             Good     6\n9          F                 D         2 yr Degree     6                   500     6         Low Risk     6\n10         F                 D         2 yr Degree     6                  5500     6        High Risk     6\n11         F                 D         2 yr Degree     5                  5000     5             Good     5\n12         F                 D         2 yr Degree     7                  8500     7        High Risk     7\n13         F                 D         2 yr Degree     7                  4500     7         Low Risk     7\n14         F                 D         2 yr Degree     7                 10000     7             Good     7\n15         F                 D         2 yr Degree     7                  7000     7          Unknown     7\n16         F                 D         2 yr Degree     4                 10000     4        High Risk     4\n17         F                 D         2 yr Degree     4                  4000     4        High Risk     4\n18         F                 D         2 yr Degree     6                  8000     6          Unknown     6\n...*/"
    },
    {
        "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','SD','TX') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\ncd_credit_rating\n/*CURSOR_IDENTIFIER*/\n",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 3 AND \"DATE_DIM\".\"D_MOY\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" , \"CD_CREDIT_RATING\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D         2 yr Degree     7                   500     7             Good     7\n1          F                 D         2 yr Degree     5                   500     5        High Risk     5\n2          F                 D         2 yr Degree     6                   500     6         Low Risk     6\n3          F                 D         2 yr Degree     6                   500     6          Unknown     6\n4          F                 D         2 yr Degree     8                  1000     8             Good     8\n5          F                 D         2 yr Degree     8                  1000     8        High Risk     8\n6          F                 D         2 yr Degree     4                  1000     4         Low Risk     4\n7          F                 D         2 yr Degree     2                  1000     2          Unknown     2\n8          F                 D         2 yr Degree     5                  1500     5             Good     5\n9          F                 D         2 yr Degree     7                  1500     7        High Risk     7\n10         F                 D         2 yr Degree     6                  1500     6         Low Risk     6\n11         F                 D         2 yr Degree     4                  1500     4          Unknown     4\n12         F                 D         2 yr Degree     7                  2000     7             Good     7\n13         F                 D         2 yr Degree     4                  2000     4        High Risk     4\n14         F                 D         2 yr Degree     2                  2000     2         Low Risk     2\n15         F                 D         2 yr Degree     5                  2000     5          Unknown     5\n16         F                 D         2 yr Degree     6                  2500     6             Good     6\n17         F                 D         2 yr Degree     4                  2500     4        High Risk     4\n18         F                 D         2 yr Degree     8                  2500     8         Low Risk     8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019437,
                    "execution_time": 0.008189,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.004812
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056072,
                    "execution_time": 0.008961,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.040385
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ON \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D         2 yr Degree     7                   500     7             Good     7\n1          F                 D         2 yr Degree     5                   500     5        High Risk     5\n2          F                 D         2 yr Degree     6                   500     6         Low Risk     6\n3          F                 D         2 yr Degree     6                   500     6          Unknown     6\n4          F                 D         2 yr Degree     8                  1000     8             Good     8\n5          F                 D         2 yr Degree     8                  1000     8        High Risk     8\n6          F                 D         2 yr Degree     4                  1000     4         Low Risk     4\n7          F                 D         2 yr Degree     2                  1000     2          Unknown     2\n8          F                 D         2 yr Degree     5                  1500     5             Good     5\n9          F                 D         2 yr Degree     7                  1500     7        High Risk     7\n10         F                 D         2 yr Degree     6                  1500     6         Low Risk     6\n11         F                 D         2 yr Degree     4                  1500     4          Unknown     4\n12         F                 D         2 yr Degree     7                  2000     7             Good     7\n13         F                 D         2 yr Degree     4                  2000     4        High Risk     4\n14         F                 D         2 yr Degree     2                  2000     2         Low Risk     2\n15         F                 D         2 yr Degree     5                  2000     5          Unknown     5\n16         F                 D         2 yr Degree     6                  2500     6             Good     6\n17         F                 D         2 yr Degree     4                  2500     4        High Risk     4\n18         F                 D         2 yr Degree     8                  2500     8         Low Risk     8\n...*/"
    },
    {
        "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','SD','TX') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 3 AND \"DATE_DIM\".\"D_MOY\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" , \"CD_CREDIT_RATING\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D         2 yr Degree     7                   500     7             Good     7\n1          F                 D         2 yr Degree     5                   500     5        High Risk     5\n2          F                 D         2 yr Degree     6                   500     6         Low Risk     6\n3          F                 D         2 yr Degree     6                   500     6          Unknown     6\n4          F                 D         2 yr Degree     8                  1000     8             Good     8\n5          F                 D         2 yr Degree     8                  1000     8        High Risk     8\n6          F                 D         2 yr Degree     4                  1000     4         Low Risk     4\n7          F                 D         2 yr Degree     2                  1000     2          Unknown     2\n8          F                 D         2 yr Degree     5                  1500     5             Good     5\n9          F                 D         2 yr Degree     7                  1500     7        High Risk     7\n10         F                 D         2 yr Degree     6                  1500     6         Low Risk     6\n11         F                 D         2 yr Degree     4                  1500     4          Unknown     4\n12         F                 D         2 yr Degree     7                  2000     7             Good     7\n13         F                 D         2 yr Degree     4                  2000     4        High Risk     4\n14         F                 D         2 yr Degree     2                  2000     2         Low Risk     2\n15         F                 D         2 yr Degree     5                  2000     5          Unknown     5\n16         F                 D         2 yr Degree     6                  2500     6             Good     6\n17         F                 D         2 yr Degree     4                  2500     4        High Risk     4\n18         F                 D         2 yr Degree     8                  2500     8         Low Risk     8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020745,
                    "execution_time": 0.008564,
                    "compile_time": 7.8e-05,
                    "planning_time": 0.005033
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019982,
                    "execution_time": 0.008595,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.004808
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ON \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D         2 yr Degree     7                   500     7             Good     7\n1          F                 D         2 yr Degree     5                   500     5        High Risk     5\n2          F                 D         2 yr Degree     6                   500     6         Low Risk     6\n3          F                 D         2 yr Degree     6                   500     6          Unknown     6\n4          F                 D         2 yr Degree     8                  1000     8             Good     8\n5          F                 D         2 yr Degree     8                  1000     8        High Risk     8\n6          F                 D         2 yr Degree     4                  1000     4         Low Risk     4\n7          F                 D         2 yr Degree     2                  1000     2          Unknown     2\n8          F                 D         2 yr Degree     5                  1500     5             Good     5\n9          F                 D         2 yr Degree     7                  1500     7        High Risk     7\n10         F                 D         2 yr Degree     6                  1500     6         Low Risk     6\n11         F                 D         2 yr Degree     4                  1500     4          Unknown     4\n12         F                 D         2 yr Degree     7                  2000     7             Good     7\n13         F                 D         2 yr Degree     4                  2000     4        High Risk     4\n14         F                 D         2 yr Degree     2                  2000     2         Low Risk     2\n15         F                 D         2 yr Degree     5                  2000     5          Unknown     5\n16         F                 D         2 yr Degree     6                  2500     6             Good     6\n17         F                 D         2 yr Degree     4                  2500     4        High Risk     4\n18         F                 D         2 yr Degree     8                  2500     8         Low Risk     8\n...*/"
    },
    {
        "input": "-- start template query69.tpl query 28 in stream 0\nselect /* TPC-DS query69.tpl 0.28 */  \n  cd_gender,\n  cd_marital_status,\n  cd_education_status,\n  count(*) cnt1,\n  cd_purchase_estimate,\n  count(*) cnt2,\n  cd_credit_rating,\n  count(*) cnt3\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  ca_state in ('CO','SD','TX') and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 2002 and\n                d_moy between 1 and 1+2) and\n   (not exists (select *\n            from web_sales,date_dim\n            where c.c_customer_sk = ws_bill_customer_sk and\n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2) and\n    not exists (select * \n            from catalog_sales,date_dim\n            where c.c_customer_sk = cs_ship_customer_sk and\n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 2002 and\n                  d_moy between 1 and 1+2))\n group by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n order by cd_gender,\n          cd_marital_status,\n          cd_education_status,\n          cd_purchase_estimate,\n          cd_credit_rating\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE_ID\" AS \"D_DATE_ID\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" , \"DATE_DIM\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"DATE_DIM\".\"D_QUARTER_SEQ\" AS \"D_QUARTER_SEQ\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_DOW\" AS \"D_DOW\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"DATE_DIM\".\"D_DOM\" AS \"D_DOM\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_FY_YEAR\" AS \"D_FY_YEAR\" , \"DATE_DIM\".\"D_FY_QUARTER_SEQ\" AS \"D_FY_QUARTER_SEQ\" , \"DATE_DIM\".\"D_FY_WEEK_SEQ\" AS \"D_FY_WEEK_SEQ\" , \"DATE_DIM\".\"D_DAY_NAME\" AS \"D_DAY_NAME\" , \"DATE_DIM\".\"D_QUARTER_NAME\" AS \"D_QUARTER_NAME\" , \"DATE_DIM\".\"D_HOLIDAY\" AS \"D_HOLIDAY\" , \"DATE_DIM\".\"D_WEEKEND\" AS \"D_WEEKEND\" , \"DATE_DIM\".\"D_FOLLOWING_HOLIDAY\" AS \"D_FOLLOWING_HOLIDAY\" , \"DATE_DIM\".\"D_FIRST_DOM\" AS \"D_FIRST_DOM\" , \"DATE_DIM\".\"D_LAST_DOM\" AS \"D_LAST_DOM\" , \"DATE_DIM\".\"D_SAME_DAY_LY\" AS \"D_SAME_DAY_LY\" , \"DATE_DIM\".\"D_SAME_DAY_LQ\" AS \"D_SAME_DAY_LQ\" , \"DATE_DIM\".\"D_CURRENT_DAY\" AS \"D_CURRENT_DAY\" , \"DATE_DIM\".\"D_CURRENT_WEEK\" AS \"D_CURRENT_WEEK\" , \"DATE_DIM\".\"D_CURRENT_MONTH\" AS \"D_CURRENT_MONTH\" , \"DATE_DIM\".\"D_CURRENT_QUARTER\" AS \"D_CURRENT_QUARTER\" , \"DATE_DIM\".\"D_CURRENT_YEAR\" AS \"D_CURRENT_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" <= 3 AND \"DATE_DIM\".\"D_MOY\" >= 1 AND \"DATE_DIM\".\"D_YEAR\" = 2002 ) , \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"_U_2\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"_U_3\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" ) , \"_U_4\" AS ( SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"_U_5\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" GROUP BY \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" ) SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_4\" AS \"_U_4\" ON \"_U_4\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"_U_2\".\"_U_3\" IS NULL AND \"_U_4\".\"_U_5\" IS NULL AND NOT \"_U_0\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_EDUCATION_STATUS\" , \"CD_PURCHASE_ESTIMATE\" , \"CD_CREDIT_RATING\" LIMIT 21",
                "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D         2 yr Degree     7                   500     7             Good     7\n1          F                 D         2 yr Degree     5                   500     5        High Risk     5\n2          F                 D         2 yr Degree     6                   500     6         Low Risk     6\n3          F                 D         2 yr Degree     6                   500     6          Unknown     6\n4          F                 D         2 yr Degree     8                  1000     8             Good     8\n5          F                 D         2 yr Degree     8                  1000     8        High Risk     8\n6          F                 D         2 yr Degree     4                  1000     4         Low Risk     4\n7          F                 D         2 yr Degree     2                  1000     2          Unknown     2\n8          F                 D         2 yr Degree     5                  1500     5             Good     5\n9          F                 D         2 yr Degree     7                  1500     7        High Risk     7\n10         F                 D         2 yr Degree     6                  1500     6         Low Risk     6\n11         F                 D         2 yr Degree     4                  1500     4          Unknown     4\n12         F                 D         2 yr Degree     7                  2000     7             Good     7\n13         F                 D         2 yr Degree     4                  2000     4        High Risk     4\n14         F                 D         2 yr Degree     2                  2000     2         Low Risk     2\n15         F                 D         2 yr Degree     5                  2000     5          Unknown     5\n16         F                 D         2 yr Degree     6                  2500     6             Good     6\n17         F                 D         2 yr Degree     4                  2500     4        High Risk     4\n18         F                 D         2 yr Degree     8                  2500     8         Low Risk     8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020162,
                    "execution_time": 0.008938,
                    "compile_time": 7.6e-05,
                    "planning_time": 0.004841
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.021175,
                    "execution_time": 0.009671,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.004831
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , COUNT ( * ) AS \"CNT1\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , COUNT ( * ) AS \"CNT2\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , COUNT ( * ) AS \"CNT3\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" ON \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" ON \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" ON \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" AND \"CA\".\"CA_STATE\" IN ( 'CO' , 'SD' , 'TX' ) JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE \"SPEQLITE_TEMP_TABLE_18\".\"_U_3\" IS NULL AND \"SPEQLITE_TEMP_TABLE_19\".\"_U_5\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_17\".\"_U_1\" IS NULL GROUP BY \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_PURCHASE_ESTIMATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_CREDIT_RATING\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_EDUCATION_STATUS\" AS \"CD_EDUCATION_STATUS\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_PURCHASE_ESTIMATE\" AS \"CD_PURCHASE_ESTIMATE\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_20\".\"CD_CREDIT_RATING\" AS \"CD_CREDIT_RATING\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT3\" AS \"CNT3\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_EDUCATION_STATUS\" NULLS LAST , \"CD_PURCHASE_ESTIMATE\" NULLS LAST , \"CD_CREDIT_RATING\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   cd_gender cd_marital_status cd_education_status  cnt1  cd_purchase_estimate  cnt2 cd_credit_rating  cnt3\n0          F                 D         2 yr Degree     7                   500     7             Good     7\n1          F                 D         2 yr Degree     5                   500     5        High Risk     5\n2          F                 D         2 yr Degree     6                   500     6         Low Risk     6\n3          F                 D         2 yr Degree     6                   500     6          Unknown     6\n4          F                 D         2 yr Degree     8                  1000     8             Good     8\n5          F                 D         2 yr Degree     8                  1000     8        High Risk     8\n6          F                 D         2 yr Degree     4                  1000     4         Low Risk     4\n7          F                 D         2 yr Degree     2                  1000     2          Unknown     2\n8          F                 D         2 yr Degree     5                  1500     5             Good     5\n9          F                 D         2 yr Degree     7                  1500     7        High Risk     7\n10         F                 D         2 yr Degree     6                  1500     6         Low Risk     6\n11         F                 D         2 yr Degree     4                  1500     4          Unknown     4\n12         F                 D         2 yr Degree     7                  2000     7             Good     7\n13         F                 D         2 yr Degree     4                  2000     4        High Risk     4\n14         F                 D         2 yr Degree     2                  2000     2         Low Risk     2\n15         F                 D         2 yr Degree     5                  2000     5          Unknown     5\n16         F                 D         2 yr Degree     6                  2500     6             Good     6\n17         F                 D         2 yr Degree     4                  2500     4        High Risk     4\n18         F                 D         2 yr Degree     8                  2500     8         Low Risk     8\n...*/"
    }
]