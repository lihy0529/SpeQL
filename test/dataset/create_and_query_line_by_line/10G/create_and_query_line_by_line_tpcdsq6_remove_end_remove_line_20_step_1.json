[
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n group by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" GROUP BY \"A\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\", COUNT(*) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" GROUP BY \"A\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n group by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\", COUNT(*) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n group by a.ca_state/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\", COUNT(*) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n group by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"ITEM\" AS \"I\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"ITEM\" AS \"I\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"ITEM\" AS \"I\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\", COUNT(*) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"ITEM\" AS \"I\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"CUSTOMER\" AS \"C\" CROSS JOIN \"DATE_DIM\" AS \"D\" CROSS JOIN \"ITEM\" AS \"I\" CROSS JOIN \"STORE_SALES\" AS \"S\" GROUP BY \"A\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "select /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n group by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"ITEM\" AS \"I\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"ITEM\" AS \"I\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"ITEM\" AS \"I\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" GROUP BY \"A\".\"CA_STATE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\", COUNT(*) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"ITEM\" AS \"I\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" CROSS JOIN \"ITEM\" AS \"I\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" GROUP BY \"A\".\"CA_STATE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\ngroup by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.356604,
                    "execution_time": 0.267396,
                    "compile_time": 0.000546,
                    "planning_time": 0.054137,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.338006,
                    "execution_time": 0.262581,
                    "compile_time": 5.897104,
                    "planning_time": 0.135434,
                    "create_size": 185
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   state     cnt\n0     ND  450747\n1     IA  835013\n2     SD  547938\n3     WY  191819\n4     MN  724750\n5     IN  756906\n6     NH   79495\n7     UT  240209\n8     OK  654864\n9     DC    8305\n10    RI   42420\n11    CT   65373\n12    FL  539803\n13    CO  545379\n14    ID  362659\n15    WA  329993\n16    AR  621664\n17    MO  904906\n18    WV  463533\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016491,
                    "execution_time": 0.007157,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003315
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053457,
                    "execution_time": 0.007323,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.03863
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\", COUNT(*) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   state     cnt\n0     ND  450747\n1     IA  835013\n2     SD  547938\n3     WY  191819\n4     MN  724750\n5     IN  756906\n6     NH   79495\n7     UT  240209\n8     OK  654864\n9     DC    8305\n10    RI   42420\n11    CT   65373\n12    FL  539803\n13    CO  545379\n14    ID  362659\n15    WA  329993\n16    AR  621664\n17    MO  904906\n18    WV  463533\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,date_dim d\n where       a.ca_address_sk = d.d_date_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n/*CURSOR_IDENTIFIER*/)\ngroup by a.ca_state",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"DATE_DIM\" AS \"D\" ON \"A\".\"CA_ADDRESS_SK\" = \"D\".\"D_DATE_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.082078,
                    "execution_time": 0.032346,
                    "compile_time": 0.000261,
                    "planning_time": 0.024891,
                    "create_size": 16
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.296451,
                    "execution_time": 0.179403,
                    "compile_time": 0.000266,
                    "planning_time": 0.089028,
                    "create_size": 16
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"DATE_DIM\" AS \"D\" ON \"A\".\"CA_ADDRESS_SK\" = \"D\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.111268,
                    "execution_time": 0.047222,
                    "compile_time": 0.000362,
                    "planning_time": 0.036112,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.180541,
                    "execution_time": 0.045758,
                    "compile_time": 0.000363,
                    "planning_time": 0.103919,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [state, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017625,
                    "execution_time": 0.007572,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.004137
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054417,
                    "execution_time": 0.007247,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.039681
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"DATE_DIM\" AS \"D\" ON \"A\".\"CA_ADDRESS_SK\" = \"D\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" ON \"SPEQLITE_TEMP_TABLE_2\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [state, cnt]\nIndex: []*/"
    },
    {
        "input": "select /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000)\n group by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" = 2000 ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_YEAR\" = 2000",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.080911,
                    "execution_time": 0.030746,
                    "compile_time": 0.000253,
                    "planning_time": 0.025746,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.146946,
                    "execution_time": 0.031272,
                    "compile_time": 0.000259,
                    "planning_time": 0.087723,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.923089,
                    "execution_time": 0.744916,
                    "compile_time": 0.081525,
                    "planning_time": 0.059531,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.271843,
                    "execution_time": 0.776416,
                    "compile_time": 3.315971,
                    "planning_time": 0.138053,
                    "create_size": 185
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   state     cnt\n0     WI  119486\n1     CT   13491\n2     RI    8394\n3     NH   16301\n4     IN  151687\n5     ID   73030\n6     WA   65114\n7     MD   40403\n8     GA  261322\n9     OK  131439\n10    DC    1564\n11    AR  125835\n12    ND   87880\n13    SD  109308\n14    IA  167537\n15    WY   38727\n16    WV   92625\n17    MO  181113\n18    IL  173110\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015791,
                    "execution_time": 0.006862,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003127
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051719,
                    "execution_time": 0.00703,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.038525
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   state     cnt\n0     WI  119486\n1     CT   13491\n2     RI    8394\n3     NH   16301\n4     IN  151687\n5     ID   73030\n6     WA   65114\n7     MD   40403\n8     GA  261322\n9     OK  131439\n10    DC    1564\n11    AR  125835\n12    ND   87880\n13    SD  109308\n14    IA  167537\n15    WY   38727\n16    WV   92625\n17    MO  181113\n18    IL  173110\n...*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n/*CURSOR_IDENTIFIER*/\ngroup by a.ca_state",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.082874,
                    "execution_time": 0.031518,
                    "compile_time": 0.00025,
                    "planning_time": 0.026312,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.145649,
                    "execution_time": 0.031869,
                    "compile_time": 0.000268,
                    "planning_time": 0.087309,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.17722,
                    "execution_time": 0.082991,
                    "compile_time": 0.000557,
                    "planning_time": 0.057517,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.26646,
                    "execution_time": 0.084892,
                    "compile_time": 0.002708,
                    "planning_time": 0.140671,
                    "create_size": 185
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*   state    cnt\n0     NV   1437\n1     CA   4649\n2     HI    334\n3     DE    188\n4     NM   2668\n5     VA  11336\n6     MS   6224\n7     OR   2858\n8     OH   6841\n9     MI   6292\n10    TN   7558\n11    KY   9795\n12    MA   1126\n13    NJ   1729\n14    NE   7283\n15    MD   1976\n16    VT   1176\n17    TX  19858\n18    GA  12105\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016756,
                    "execution_time": 0.007482,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003242
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052279,
                    "execution_time": 0.007754,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.038445
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*   state    cnt\n0     NV   1437\n1     CA   4649\n2     HI    334\n3     DE    188\n4     NM   2668\n5     VA  11336\n6     MS   6224\n7     OR   2858\n8     OH   6841\n9     MI   6292\n10    TN   7558\n11    KY   9795\n12    MA   1126\n13    NJ   1729\n14    NE   7283\n15    MD   1976\n16    VT   1176\n17    TX  19858\n18    GA  12105\n...*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * i.i_current_price\n/*CURSOR_IDENTIFIER*/\ngroup by a.ca_state",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"I\".\"I_CURRENT_PRICE\" AND \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"I\".\"I_CURRENT_PRICE\" AND \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.209728,
                    "execution_time": 0.074294,
                    "compile_time": 0.038927,
                    "planning_time": 0.05981,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.214567,
                    "execution_time": 0.681276,
                    "compile_time": 3.349993,
                    "planning_time": 0.144001,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [state, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017607,
                    "execution_time": 0.007282,
                    "compile_time": 5e-05,
                    "planning_time": 0.004348
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052684,
                    "execution_time": 0.006997,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039746
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"I\".\"I_CURRENT_PRICE\" AND \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_8\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [state, cnt]\nIndex: []*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * \n             (select avg(j.i_current_price) \n              from item j)\n group by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_1\" AS ( SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" FROM \"ITEM\" AS \"J\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" JOIN \"_U_1\" AS \"_U_1\" ON \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"_U_1\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" FROM \"ITEM\" AS \"J\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.087106,
                    "execution_time": 0.034494,
                    "compile_time": 0.000307,
                    "planning_time": 0.025782,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.153903,
                    "execution_time": 0.034844,
                    "compile_time": 0.000347,
                    "planning_time": 0.090902,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"I\".\"I_CURRENT_PRICE\" = 1.2 * \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.164738,
                    "execution_time": 0.063299,
                    "compile_time": 0.000623,
                    "planning_time": 0.064519,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.252995,
                    "execution_time": 0.066174,
                    "compile_time": 0.000618,
                    "planning_time": 0.146589,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [state, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017293,
                    "execution_time": 0.006859,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004409
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053067,
                    "execution_time": 0.007131,
                    "compile_time": 5e-05,
                    "planning_time": 0.039685
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [state, cnt]\nIndex: []*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * \n             (select avg(j.i_current_price) \n \t     from item j)\n/*CURSOR_IDENTIFIER*/\ngroup by a.ca_state",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_1\" AS ( SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" FROM \"ITEM\" AS \"J\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" JOIN \"_U_1\" AS \"_U_1\" ON \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"_U_1\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"STATE\" AS \"STATE\" , \"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [state, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017223,
                    "execution_time": 0.007078,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.004262
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053201,
                    "execution_time": 0.007517,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.039584
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"STATE\" AS \"STATE\", \"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [state, cnt]\nIndex: []*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * \n             (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n/*CURSOR_IDENTIFIER*/\ngroup by a.ca_state",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_1\" AS ( SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" , \"J\".\"I_CATEGORY\" AS \"_U_2\" FROM \"ITEM\" AS \"J\" GROUP BY \"J\".\"I_CATEGORY\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"_U_1\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" , \"J\".\"I_CATEGORY\" AS \"_U_2\" FROM \"ITEM\" AS \"J\" GROUP BY \"J\".\"I_CATEGORY\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.085657,
                    "execution_time": 0.035097,
                    "compile_time": 0.000271,
                    "planning_time": 0.025226,
                    "create_size": 50
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.746478,
                    "execution_time": 0.630745,
                    "compile_time": 0.000287,
                    "planning_time": 0.087307,
                    "create_size": 50
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.25279,
                    "execution_time": 0.10661,
                    "compile_time": 0.034909,
                    "planning_time": 0.072428,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.853897,
                    "execution_time": 0.10328,
                    "compile_time": 3.551139,
                    "planning_time": 0.157379,
                    "create_size": 185
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*   state   cnt\n0     OH   631\n1     TN   730\n2     CA   481\n3     NV   136\n4     HI    41\n5     MI   604\n6     KY   978\n7     MA   123\n8     MD   185\n9     NY   411\n10    ME   104\n11    VT   106\n12    TX  1980\n13    LA   439\n14    AZ   114\n15    NJ   180\n16    NE   750\n17    DE    19\n18    AL   527\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015962,
                    "execution_time": 0.006785,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003261
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052847,
                    "execution_time": 0.007365,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.038988
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*   state   cnt\n0     OH   631\n1     TN   730\n2     CA   481\n3     NV   136\n4     HI    41\n5     MI   604\n6     KY   978\n7     MA   123\n8     MD   185\n9     NY   411\n10    ME   104\n11    VT   106\n12    TX  1980\n13    LA   439\n14    AZ   114\n15    NJ   180\n16    NE   750\n17    DE    19\n18    AL   527\n...*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * \n             (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_1\" AS ( SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" , \"J\".\"I_CATEGORY\" AS \"_U_2\" FROM \"ITEM\" AS \"J\" GROUP BY \"J\".\"I_CATEGORY\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"_U_1\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"STATE\" AS \"STATE\" , \"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*   state  cnt\n0     UT  222\n1     OK  640\n2     DC    9\n3     MN  683\n4     AK  201\n5     ID  348\n6     WA  329\n7     AR  591\n8     ND  420\n9     SD  522\n10    IA  756\n11    WY  158\n12    IL  820\n13    CT   54\n14    RI   51\n15    WV  397\n16    MO  835\n17    WI  536\n18    IN  699\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016427,
                    "execution_time": 0.007469,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003122
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.050893,
                    "execution_time": 0.00685,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.038287
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\"",
                "rewrite": "SELECT \"STATE\" AS \"STATE\", \"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*   state  cnt\n0     UT  222\n1     OK  640\n2     DC    9\n3     MN  683\n4     AK  201\n5     ID  348\n6     WA  329\n7     AR  591\n8     ND  420\n9     SD  522\n10    IA  756\n11    WY  158\n12    IL  820\n13    CT   54\n14    RI   51\n15    WV  397\n16    MO  835\n17    WI  536\n18    IN  699\n...*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * \n             (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_1\" AS ( SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" , \"J\".\"I_CATEGORY\" AS \"_U_2\" FROM \"ITEM\" AS \"J\" GROUP BY \"J\".\"I_CATEGORY\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"_U_1\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\" HAVING COUNT ( * ) >= 10"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\" HAVING COUNT ( * ) >= 10",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.208242,
                    "execution_time": 0.093292,
                    "compile_time": 0.000677,
                    "planning_time": 0.074172,
                    "create_size": 185
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.492274,
                    "execution_time": 0.091583,
                    "compile_time": 0.200902,
                    "planning_time": 0.155462,
                    "create_size": 185
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*   state  cnt\n0     AR  591\n1     CO  507\n2     FL  508\n3     ID  348\n4     OK  640\n5     IA  756\n6     SD  522\n7     WY  158\n8     CT   54\n9     RI   51\n10    MN  683\n11    IN  699\n12    NH   93\n13    UT  222\n14    WA  329\n15    ND  420\n16    WV  397\n17    MO  835\n18    IL  820\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016618,
                    "execution_time": 0.007461,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003245
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054396,
                    "execution_time": 0.00693,
                    "compile_time": 5e-05,
                    "planning_time": 0.038655
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\" HAVING COUNT ( * ) >= 10",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*   state  cnt\n0     AR  591\n1     CO  507\n2     FL  508\n3     ID  348\n4     OK  640\n5     IA  756\n6     SD  522\n7     WY  158\n8     CT   54\n9     RI   51\n10    MN  683\n11    IN  699\n12    NH   93\n13    UT  222\n14    WA  329\n15    ND  420\n16    WV  397\n17    MO  835\n18    IL  820\n...*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * \n             (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt, a.ca_state \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_1\" AS ( SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" , \"J\".\"I_CATEGORY\" AS \"_U_2\" FROM \"ITEM\" AS \"J\" GROUP BY \"J\".\"I_CATEGORY\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"_U_1\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\" HAVING COUNT ( * ) >= 10 ORDER BY \"CNT\" NULLS LAST , \"STATE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"CNT\" , \"STATE\" LIMIT 21",
                "preview": "\n/*   state  cnt\n0     DE   19\n1     HI   41\n2     RI   51\n3     CT   54\n4     NH   93\n5     ME  104\n6     VT  106\n7     AZ  114\n8     MA  123\n9     NV  136\n10    WY  158\n11    NJ  180\n12    MD  185\n13    AK  201\n14    UT  222\n15    NM  251\n16    OR  297\n17    WA  329\n18    ID  348\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017805,
                    "execution_time": 0.008051,
                    "compile_time": 8.6e-05,
                    "planning_time": 0.003611
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05554,
                    "execution_time": 0.008096,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.038889
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\" HAVING COUNT ( * ) >= 10 ORDER BY \"CNT\" NULLS LAST , \"STATE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"CNT\" NULLS LAST , \"STATE\" NULLS LAST"
            }
        ],
        "preview": "\n/*   state  cnt\n0     DE   19\n1     HI   41\n2     RI   51\n3     CT   54\n4     NH   93\n5     ME  104\n6     VT  106\n7     AZ  114\n8     MA  123\n9     NV  136\n10    WY  158\n11    NJ  180\n12    MD  185\n13    AK  201\n14    UT  222\n15    NM  251\n16    OR  297\n17    WA  329\n18    ID  348\n...*/"
    },
    {
        "input": "-- start template query6.tpl query 58 in stream 0\nselect /* TPC-DS query6.tpl 0.58 */  a.ca_state state, count(*) cnt\n from customer_address a\n     ,customer c\n     ,store_sales s\n     ,date_dim d\n     ,item i\n where       a.ca_address_sk = c.c_current_addr_sk\n \tand c.c_customer_sk = s.ss_customer_sk\n \tand s.ss_sold_date_sk = d.d_date_sk\n \tand s.ss_item_sk = i.i_item_sk\n \tand d.d_month_seq = \n \t     (select distinct (d_month_seq)\n \t      from date_dim\n               where d_year = 2000\n \t        and d_moy = 6 )\n \tand i.i_current_price > 1.2 * \n             (select avg(j.i_current_price) \n \t     from item j \n \t     where j.i_category = i.i_category)\n group by a.ca_state\n having count(*) >= 10\n order by cnt, a.ca_state \n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT DISTINCT \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MOY\" = 6 AND \"DATE_DIM\".\"D_YEAR\" = 2000 ) , \"_U_1\" AS ( SELECT AVG ( \"J\".\"I_CURRENT_PRICE\" ) AS \"_COL_0\" , \"J\".\"I_CATEGORY\" AS \"_U_2\" FROM \"ITEM\" AS \"J\" GROUP BY \"J\".\"I_CATEGORY\" ) SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"_U_1\" AS \"_U_1\" ON \"_U_1\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"_U_1\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\" HAVING COUNT ( * ) >= 10 ORDER BY \"CNT\" NULLS LAST , \"STATE\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"CNT\" , \"STATE\" LIMIT 21",
                "preview": "\n/*   state  cnt\n0     DE   19\n1     HI   41\n2     RI   51\n3     CT   54\n4     NH   93\n5     ME  104\n6     VT  106\n7     AZ  114\n8     MA  123\n9     NV  136\n10    WY  158\n11    NJ  180\n12    MD  185\n13    AK  201\n14    UT  222\n15    NM  251\n16    OR  297\n17    WA  329\n18    ID  348\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017752,
                    "execution_time": 0.008568,
                    "compile_time": 6.9e-05,
                    "planning_time": 0.003322
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017213,
                    "execution_time": 0.007807,
                    "compile_time": 7e-05,
                    "planning_time": 0.003514
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A\".\"CA_STATE\" AS \"STATE\" , COUNT ( * ) AS \"CNT\" FROM \"CUSTOMER_ADDRESS\" AS \"A\" JOIN \"CUSTOMER\" AS \"C\" ON \"A\".\"CA_ADDRESS_SK\" = \"C\".\"C_CURRENT_ADDR_SK\" JOIN \"STORE_SALES\" AS \"S\" ON \"C\".\"C_CUSTOMER_SK\" = \"S\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"S\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"S\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"D_MONTH_SEQ\" = \"D\".\"D_MONTH_SEQ\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"_U_2\" = \"I\".\"I_CATEGORY\" WHERE \"I\".\"I_CURRENT_PRICE\" > 1.2 * \"SPEQLITE_TEMP_TABLE_11\".\"_COL_0\" GROUP BY \"A\".\"CA_STATE\" HAVING COUNT ( * ) >= 10 ORDER BY \"CNT\" NULLS LAST , \"STATE\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"STATE\" AS \"STATE\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" ORDER BY \"CNT\" NULLS LAST , \"STATE\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   state  cnt\n0     DE   19\n1     HI   41\n2     RI   51\n3     CT   54\n4     NH   93\n5     ME  104\n6     VT  106\n7     AZ  114\n8     MA  123\n9     NV  136\n10    WY  158\n11    NJ  180\n12    MD  185\n13    AK  201\n14    UT  222\n15    NM  251\n16    OR  297\n17    WA  329\n18    ID  348\n...*/"
    }
]