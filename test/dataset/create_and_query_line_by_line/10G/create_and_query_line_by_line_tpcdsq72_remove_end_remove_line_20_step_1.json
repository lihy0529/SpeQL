[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when cs_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when cs_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when cs_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when cs_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when cs_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when cs_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inventory.inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"CATALOG_SALES\".\"CS_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc, w_warehouse_name, d1.d_week_seq\n      \n      \n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc, w_warehouse_name, d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc, i_item_desc, w_warehouse_name, d1.d_week_seq\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \n  and d3.d_date > d1.d_date + 5\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_1\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME_COL_4\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ_COL_5\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_1\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME_COL_4\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ_COL_5\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_1\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME_COL_4\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ_COL_5\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc, w_warehouse_name, d1.d_week_seq\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \n  and d3.d_date > d1.d_date + 5\n  and hd_buy_potential = '1001-5000'\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME_COL_3\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ_COL_4\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME_COL_3\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ_COL_4\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME_COL_3\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ_COL_4\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \n  and d3.d_date > dateadd(day, 5, d1.d_date)\n  and hd_buy_potential = '1001-5000'\n  and d1.d_year = 2000\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > TS_OR_DS_ADD ( 'DAY' , 5 , D_DATE , TIMESTAMP ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_DESC , W_WAREHOUSE_NAME , D1.D_WEEK_SEQ , SUM ( CASE WHEN P_PROMO_SK IS NULL THEN 1 ELSE 0 END ) AS NO_PROMO , SUM ( CASE WHEN NOT P_PROMO_SK IS NULL THEN 1 ELSE 0 END ) AS PROMO , COUNT ( * ) AS TOTAL_CNT FROM CATALOG_SALES JOIN INVENTORY ON ( CS_ITEM_SK = INV_ITEM_SK ) JOIN WAREHOUSE ON ( W_WAREHOUSE_SK = INV_WAREHOUSE_SK ) JOIN ITEM ON ( I_ITEM_SK = CS_ITEM_SK ) JOIN CUSTOMER_DEMOGRAPHICS ON ( CS_BILL_CDEMO_SK = CD_DEMO_SK ) JOIN HOUSEHOLD_DEMOGRAPHICS ON ( CS_BILL_HDEMO_SK = HD_DEMO_SK ) JOIN DATE_DIM AS D1 ON ( CS_SOLD_DATE_SK = D1.D_DATE_SK ) JOIN DATE_DIM AS D2 ON ( INV_DATE_SK = D2.D_DATE_SK ) JOIN DATE_DIM AS D3 ON ( CS_SHIP_DATE_SK = D3.D_DATE_SK ) LEFT OUTER JOIN PROMOTION ON ( CS_PROMO_SK = P_PROMO_SK ) LEFT OUTER JOIN CATALOG_RETURNS ON ( CR_ITEM_SK = CS_ITEM_SK AND CR_ORDER_NUMBER = CS_ORDER_NUMBER ) WHERE D1.D_WEEK_SEQ = D2.D_WEEK_SEQ AND INV_QUANTITY_ON_HAND < CS_QUANTITY AND D3.D_DATE > DATEADD ( DAY , 5 , D1.D_DATE ) AND HD_BUY_POTENTIAL = '1001-5000' AND D1.D_YEAR = 2000 GROUP BY I_ITEM_DESC , W_WAREHOUSE_NAME , D1.D_WEEK_SEQ LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > TS_OR_DS_ADD('DAY', 5, D_DATE, TIMESTAMP) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": null
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk = inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk = p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \n  and d3.d_date > d1.d_date + 5\n  and hd_buy_potential = '1001-5000'\n  and d1.d_year = 2000\n  and cd_marital_status = 'D'\ngroup by i_item_desc, w_warehouse_name, d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.189191,
                    "execution_time": 0.961219,
                    "compile_time": 0.000902,
                    "planning_time": 0.13659,
                    "create_size": 504
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 12.820113,
                    "execution_time": 0.966613,
                    "compile_time": 11.510253,
                    "planning_time": 0.237525,
                    "create_size": 504
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"NO_PROMO\" AS \"NO_PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"PROMO\" AS \"PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"TOTAL_CNT\" AS \"TOTAL_CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*                                                                                                                                                                                                 i_item_desc      w_warehouse_name  d_week_seq  no_promo  promo  total_cnt\n0                                                                                                                                          Upper, necessary hands slip behind the ways. Blue, prime terms ca        Quite effectiv        5218         0      1          1\n1                                                                                     Afterwards valid governments would take seldom. Changes remember technical fingers. Passengers may survey dark vehicle      Plain, reluctant        5218         0      1          1\n2      More italian ways must experience even here eligible enemies. American enquiries work sometimes. Then mere features must not adopt easy crimes. Able, royal lives notice there working-class minutes.           Doors canno        5219         0      1          1\n3                    Right social leaders would understand in a guests. Also big policies should not ensure at once now different months. Priests used to ask notably; new men include only. Capable groups                               5219         0      1          1\n4                                                           Stable offices fall in a flowers. Then other managers will determine crucial payments; following images may play consciously little developments      Plain, reluctant        5220         0      1          1\n5                                                                               So direct offenders may not ask secondly individuals; rumours might pull now with a problems. Adult ages would work aside mo           Doors canno        5221         0      1          1\n6                                                                                      Criminal companies may emerge sometimes children. Urban, other efforts dominate policies. Very right fans drive briti      National, comple        5221         0      1          1\n7                                                                          Remains must not go intellectually long differences. Other visits charge new, scientific studies. Later various fingers can reach   Conventional childr        5222         0      1          1\n8                                                                                                Full, other trees emerge later most new techniques. Most able figures care silly, different changes. Small,   Conventional childr        5222         0      1          1\n9                    Individual men will not bid already used, scottish faces. Coherent patients ought to take also certain, hot characters. Main, soviet pictures arrange much meetings. Boys make harshly                               5222         0      1          1\n10                           Various farms would give available years. More able years make; great needs tell so children. Hours use good, sufficient quantities; bloody, mysterious meanings say certainly       Plain, reluctant        5222         0      1          1\n11                                                                                                 Wrong branches jump then down a names. Just recent owners must shoot very red, fixed answers. Colours see  Important issues liv        5224         0      1          1\n12                                                                                                                                                                                                Apparently  Bad cards must make.        5224         0      1          1\n13                                                                                                                      Male, silent women must outline over international children. Local mice should mean   Important issues liv        5225         0      1          1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01685,
                    "execution_time": 0.006982,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003738
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.26493,
                    "execution_time": 0.007589,
                    "compile_time": 0.207755,
                    "planning_time": 0.039882
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"NO_PROMO\" AS \"NO_PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"PROMO\" AS \"PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"TOTAL_CNT\" AS \"TOTAL_CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*                                                                                                                                                                                                 i_item_desc      w_warehouse_name  d_week_seq  no_promo  promo  total_cnt\n0                                                                                                                                          Upper, necessary hands slip behind the ways. Blue, prime terms ca        Quite effectiv        5218         0      1          1\n1                                                                                     Afterwards valid governments would take seldom. Changes remember technical fingers. Passengers may survey dark vehicle      Plain, reluctant        5218         0      1          1\n2      More italian ways must experience even here eligible enemies. American enquiries work sometimes. Then mere features must not adopt easy crimes. Able, royal lives notice there working-class minutes.           Doors canno        5219         0      1          1\n3                    Right social leaders would understand in a guests. Also big policies should not ensure at once now different months. Priests used to ask notably; new men include only. Capable groups                               5219         0      1          1\n4                                                           Stable offices fall in a flowers. Then other managers will determine crucial payments; following images may play consciously little developments      Plain, reluctant        5220         0      1          1\n5                                                                               So direct offenders may not ask secondly individuals; rumours might pull now with a problems. Adult ages would work aside mo           Doors canno        5221         0      1          1\n6                                                                                      Criminal companies may emerge sometimes children. Urban, other efforts dominate policies. Very right fans drive briti      National, comple        5221         0      1          1\n7                                                                          Remains must not go intellectually long differences. Other visits charge new, scientific studies. Later various fingers can reach   Conventional childr        5222         0      1          1\n8                                                                                                Full, other trees emerge later most new techniques. Most able figures care silly, different changes. Small,   Conventional childr        5222         0      1          1\n9                    Individual men will not bid already used, scottish faces. Coherent patients ought to take also certain, hot characters. Main, soviet pictures arrange much meetings. Boys make harshly                               5222         0      1          1\n10                           Various farms would give available years. More able years make; great needs tell so children. Hours use good, sufficient quantities; bloody, mysterious meanings say certainly       Plain, reluctant        5222         0      1          1\n11                                                                                                 Wrong branches jump then down a names. Just recent owners must shoot very red, fixed answers. Colours see  Important issues liv        5224         0      1          1\n12                                                                                                                                                                                                Apparently  Bad cards must make.        5224         0      1          1\n13                                                                                                                      Male, silent women must outline over international children. Local mice should mean   Important issues liv        5225         0      1          1\n...*/"
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \n  and d3.d_date > d1.d_date + 5\n  and hd_buy_potential = '1001-5000'\n  and d1.d_year = 2000\n  and cd_marital_status = 'D'\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"NO_PROMO\" AS \"NO_PROMO\" , \"PROMO\" AS \"PROMO\" , \"TOTAL_CNT\" AS \"TOTAL_CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*                                                                                                                                                                                             i_item_desc      w_warehouse_name  d_week_seq  no_promo  promo  total_cnt\n0                                                                                         Specialist, unusual windows put special pieces. Only european dreams get however english, fixed words. British      National, comple        5218         0      1          1\n1                                                                                              Western, great eyes return unknown tensions. European years might not signal asleep, reduced countries. S  Local, mass universi        5219         0      1          1\n2                                             Other, little funds advance a little both sure citizens. Tiny specialists tell patients. Fundamental steps prevent so teachers. Parliamentary, scottish pa      Plain, reluctant        5220         0      1          1\n3                                                                                                                                                                                                   Orga           Rooms cook         5220         0      1          1\n4                                                         Pale amounts might provide other, free papers; never legal men will finish; present hopes would see more personally identical contributions. S      National, comple        5223         0      1          1\n5                                                                                                                                       Reasons want. Now foreign rules claim. Policies should not forgi      National, comple        5223         0      1          1\n6                                                                                                                    As academic men ought to mind here other previous problems; years used to show brit  Bad cards must make.        5224         0      1          1\n7                                                                   Other roots cannot feel altogether teachers. Now useless funds would get tanks. Drinks look effective patients. Cases would stifle m      National, comple        5224         0      1          1\n8                                 Males shall not extract up to. Sure matches study soon early regions. Wide companies throw as off a individuals. British, tiny moments print particularly then sorry m  Bad cards must make.        5225         0      1          1\n9   Left husbands comprehend terms. Sound, anxious studies may not rob often problems. Only comparative workers might attend just old old models. More fair assessments clean so wages. Likely, alone en      Plain, reluctant        5225         0      1          1\n10                                                  Courts hear very in a shoes; fees support at least about a executives. Reliable, clear items compensate other faces. Consistently possible depths mu           Rooms cook         5225         0      1          1\n11                                     Changes find. Standards cannot give on a years. Allowances will reduce always other processes. Patients set around a temperatures; little individual items will g   Conventional childr        5226         0      1          1\n12                         Assistant, national problems shall not see late, capital others. There hot stones point doors. Appointed places catch now short, odd principles. Necessary bonds report minut   Conventional childr        5226         0      1          1\n13                Certain, political individuals must take existing knees. Delicate, new companies should not grow silly, fast values. New, historical concepts draw little effective, gradual names. Co        Quite effectiv        5226         0      1          1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017294,
                    "execution_time": 0.007305,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003724
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057509,
                    "execution_time": 0.007359,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.043766
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\"",
                "rewrite": "SELECT \"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", \"NO_PROMO\" AS \"NO_PROMO\", \"PROMO\" AS \"PROMO\", \"TOTAL_CNT\" AS \"TOTAL_CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*                                                                                                                                                                                             i_item_desc      w_warehouse_name  d_week_seq  no_promo  promo  total_cnt\n0                                                                                         Specialist, unusual windows put special pieces. Only european dreams get however english, fixed words. British      National, comple        5218         0      1          1\n1                                                                                              Western, great eyes return unknown tensions. European years might not signal asleep, reduced countries. S  Local, mass universi        5219         0      1          1\n2                                             Other, little funds advance a little both sure citizens. Tiny specialists tell patients. Fundamental steps prevent so teachers. Parliamentary, scottish pa      Plain, reluctant        5220         0      1          1\n3                                                                                                                                                                                                   Orga           Rooms cook         5220         0      1          1\n4                                                         Pale amounts might provide other, free papers; never legal men will finish; present hopes would see more personally identical contributions. S      National, comple        5223         0      1          1\n5                                                                                                                                       Reasons want. Now foreign rules claim. Policies should not forgi      National, comple        5223         0      1          1\n6                                                                                                                    As academic men ought to mind here other previous problems; years used to show brit  Bad cards must make.        5224         0      1          1\n7                                                                   Other roots cannot feel altogether teachers. Now useless funds would get tanks. Drinks look effective patients. Cases would stifle m      National, comple        5224         0      1          1\n8                                 Males shall not extract up to. Sure matches study soon early regions. Wide companies throw as off a individuals. British, tiny moments print particularly then sorry m  Bad cards must make.        5225         0      1          1\n9   Left husbands comprehend terms. Sound, anxious studies may not rob often problems. Only comparative workers might attend just old old models. More fair assessments clean so wages. Likely, alone en      Plain, reluctant        5225         0      1          1\n10                                                  Courts hear very in a shoes; fees support at least about a executives. Reliable, clear items compensate other faces. Consistently possible depths mu           Rooms cook         5225         0      1          1\n11                                     Changes find. Standards cannot give on a years. Allowances will reduce always other processes. Patients set around a temperatures; little individual items will g   Conventional childr        5226         0      1          1\n12                         Assistant, national problems shall not see late, capital others. There hot stones point doors. Appointed places catch now short, odd principles. Necessary bonds report minut   Conventional childr        5226         0      1          1\n13                Certain, political individuals must take existing knees. Delicate, new companies should not grow silly, fast values. New, historical concepts draw little effective, gradual names. Co        Quite effectiv        5226         0      1          1\n...*/"
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \n  and d3.d_date > d1.d_date + 5\n  and hd_buy_potential = '1001-5000'\n  and d1.d_year = 2000\n  and cd_marital_status = 'D'\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" ORDER BY \"TOTAL_CNT\" DESC NULLS FIRST , \"I_ITEM_DESC\" NULLS LAST , \"W_WAREHOUSE_NAME\" NULLS LAST , \"D_WEEK_SEQ\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"NO_PROMO\" AS \"NO_PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"PROMO\" AS \"PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"TOTAL_CNT\" AS \"TOTAL_CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"TOTAL_CNT\" DESC , \"I_ITEM_DESC\" , \"W_WAREHOUSE_NAME\" , \"D_WEEK_SEQ\" LIMIT 21",
                "preview": "\n/*                                                                                                                                                                                            i_item_desc      w_warehouse_name  d_week_seq  no_promo  promo  total_cnt\n0                                                                                                         English weeks say anymore police; together happy traders shall buy strongly english other lad      Plain, reluctant        5264         0      3          3\n1                                                                                                    Just acceptable personnel hear above detailed, open results. Necessary leaders seek general, certa   Conventional childr        5264         0      3          3\n2                                                                                                    Just acceptable personnel hear above detailed, open results. Necessary leaders seek general, certa           Doors canno        5264         0      3          3\n3                                                                                                    Just acceptable personnel hear above detailed, open results. Necessary leaders seek general, certa      Plain, reluctant        5264         0      3          3\n4                                                                                                                               National regulations make minutes. Left sources take easy songs; only s      Plain, reluctant        5264         0      3          3\n5                                                                                                     Soft letters mean then final, grim leads. Strategic, good forms protect straight red, good change      National, comple        5263         0      3          3\n6                                                                                                                                                                                       Users shall ach      Plain, reluctant        5264         0      3          3\n7                                                                                                                                                                                                                                    5270         0      2          2\n8                                                                                                                                                                                                        Bad cards must make.        5253         0      2          2\n9                                                                                                                                                                                                        Bad cards must make.        5263         0      2          2\n10                                                                                                                                                                                                        Conventional childr        5260         0      2          2\n11                                                                                                                                                                                                                Doors canno        5265         0      2          2\n12                                                                                                                                                                                                       Important issues liv        5246         0      2          2\n13                                                                                                                                                                                                       Important issues liv        5255         0      2          2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019299,
                    "execution_time": 0.008801,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.004296
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.152534,
                    "execution_time": 0.009016,
                    "compile_time": 0.094905,
                    "planning_time": 0.039789
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" ORDER BY \"TOTAL_CNT\" DESC NULLS FIRST, \"I_ITEM_DESC\" NULLS LAST, \"W_WAREHOUSE_NAME\" NULLS LAST, \"D_WEEK_SEQ\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"NO_PROMO\" AS \"NO_PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"PROMO\" AS \"PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"TOTAL_CNT\" AS \"TOTAL_CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"TOTAL_CNT\" DESC NULLS FIRST , \"I_ITEM_DESC\" NULLS LAST , \"W_WAREHOUSE_NAME\" NULLS LAST , \"D_WEEK_SEQ\" NULLS LAST"
            }
        ],
        "preview": "\n/*                                                                                                                                                                                            i_item_desc      w_warehouse_name  d_week_seq  no_promo  promo  total_cnt\n0                                                                                                         English weeks say anymore police; together happy traders shall buy strongly english other lad      Plain, reluctant        5264         0      3          3\n1                                                                                                    Just acceptable personnel hear above detailed, open results. Necessary leaders seek general, certa   Conventional childr        5264         0      3          3\n2                                                                                                    Just acceptable personnel hear above detailed, open results. Necessary leaders seek general, certa           Doors canno        5264         0      3          3\n3                                                                                                    Just acceptable personnel hear above detailed, open results. Necessary leaders seek general, certa      Plain, reluctant        5264         0      3          3\n4                                                                                                                               National regulations make minutes. Left sources take easy songs; only s      Plain, reluctant        5264         0      3          3\n5                                                                                                     Soft letters mean then final, grim leads. Strategic, good forms protect straight red, good change      National, comple        5263         0      3          3\n6                                                                                                                                                                                       Users shall ach      Plain, reluctant        5264         0      3          3\n7                                                                                                                                                                                                                                    5270         0      2          2\n8                                                                                                                                                                                                        Bad cards must make.        5253         0      2          2\n9                                                                                                                                                                                                        Bad cards must make.        5263         0      2          2\n10                                                                                                                                                                                                        Conventional childr        5260         0      2          2\n11                                                                                                                                                                                                                Doors canno        5265         0      2          2\n12                                                                                                                                                                                                       Important issues liv        5246         0      2          2\n13                                                                                                                                                                                                       Important issues liv        5255         0      2          2\n...*/"
    },
    {
        "input": "-- start template query72.tpl query 87 in stream 0\nselect /* TPC-DS query72.tpl 0.87 */  i_item_desc\n      ,w_warehouse_name\n      ,d1.d_week_seq\n      ,sum(case when p_promo_sk is null then 1 else 0 end) no_promo\n      ,sum(case when p_promo_sk is not null then 1 else 0 end) promo\n      ,count(*) total_cnt\nfrom catalog_sales\njoin inventory on (cs_item_sk = inv_item_sk)\njoin warehouse on (w_warehouse_sk=inv_warehouse_sk)\njoin item on (i_item_sk = cs_item_sk)\njoin customer_demographics on (cs_bill_cdemo_sk = cd_demo_sk)\njoin household_demographics on (cs_bill_hdemo_sk = hd_demo_sk)\njoin date_dim d1 on (cs_sold_date_sk = d1.d_date_sk)\njoin date_dim d2 on (inv_date_sk = d2.d_date_sk)\njoin date_dim d3 on (cs_ship_date_sk = d3.d_date_sk)\nleft outer join promotion on (cs_promo_sk=p_promo_sk)\nleft outer join catalog_returns on (cr_item_sk = cs_item_sk and cr_order_number = cs_order_number)\nwhere d1.d_week_seq = d2.d_week_seq\n  and inv_quantity_on_hand < cs_quantity \n  and d3.d_date > d1.d_date + 5\n  and hd_buy_potential = '1001-5000'\n  and d1.d_year = 2000\n  and cd_marital_status = 'D'\ngroup by i_item_desc,w_warehouse_name,d1.d_week_seq\norder by total_cnt desc, i_item_desc, w_warehouse_name, d_week_seq\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , SUM ( CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"NO_PROMO\" , SUM ( CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END ) AS \"PROMO\" , COUNT ( * ) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\" , \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"D1\".\"D_WEEK_SEQ\" ORDER BY \"TOTAL_CNT\" DESC NULLS FIRST , \"I_ITEM_DESC\" NULLS LAST , \"W_WAREHOUSE_NAME\" NULLS LAST , \"D_WEEK_SEQ\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"NO_PROMO\" AS \"NO_PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"PROMO\" AS \"PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"TOTAL_CNT\" AS \"TOTAL_CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"TOTAL_CNT\" DESC , \"I_ITEM_DESC\" , \"W_WAREHOUSE_NAME\" , \"D_WEEK_SEQ\" LIMIT 21",
                "preview": "\n/*                                                                                                                                                                                            i_item_desc      w_warehouse_name  d_week_seq  no_promo  promo  total_cnt\n0                                                                                                         English weeks say anymore police; together happy traders shall buy strongly english other lad      Plain, reluctant        5264         0      3          3\n1                                                                                                    Just acceptable personnel hear above detailed, open results. Necessary leaders seek general, certa   Conventional childr        5264         0      3          3\n2                                                                                                    Just acceptable personnel hear above detailed, open results. Necessary leaders seek general, certa           Doors canno        5264         0      3          3\n3                                                                                                    Just acceptable personnel hear above detailed, open results. Necessary leaders seek general, certa      Plain, reluctant        5264         0      3          3\n4                                                                                                                               National regulations make minutes. Left sources take easy songs; only s      Plain, reluctant        5264         0      3          3\n5                                                                                                     Soft letters mean then final, grim leads. Strategic, good forms protect straight red, good change      National, comple        5263         0      3          3\n6                                                                                                                                                                                       Users shall ach      Plain, reluctant        5264         0      3          3\n7                                                                                                                                                                                                                                    5270         0      2          2\n8                                                                                                                                                                                                        Bad cards must make.        5253         0      2          2\n9                                                                                                                                                                                                        Bad cards must make.        5263         0      2          2\n10                                                                                                                                                                                                        Conventional childr        5260         0      2          2\n11                                                                                                                                                                                                                Doors canno        5265         0      2          2\n12                                                                                                                                                                                                       Important issues liv        5246         0      2          2\n13                                                                                                                                                                                                       Important issues liv        5255         0      2          2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01911,
                    "execution_time": 0.008641,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.004272
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019821,
                    "execution_time": 0.009111,
                    "compile_time": 7.6e-05,
                    "planning_time": 0.004338
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\", SUM(CASE WHEN \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"NO_PROMO\", SUM(CASE WHEN NOT \"PROMOTION\".\"P_PROMO_SK\" IS NULL THEN 1 ELSE 0 END) AS \"PROMO\", COUNT(*) AS \"TOTAL_CNT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'D' JOIN \"DATE_DIM\" AS \"D1\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"D1\".\"D_DATE_SK\" AND \"D1\".\"D_YEAR\" = 2000 JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"CATALOG_SALES\".\"CS_BILL_HDEMO_SK\" = \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-5000' JOIN \"INVENTORY\" AS \"INVENTORY\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"INVENTORY\".\"INV_ITEM_SK\" AND \"CATALOG_SALES\".\"CS_QUANTITY\" > \"INVENTORY\".\"INV_QUANTITY_ON_HAND\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"CATALOG_SALES\".\"CS_PROMO_SK\" = \"PROMOTION\".\"P_PROMO_SK\" JOIN \"DATE_DIM\" AS \"D2\" ON \"D1\".\"D_WEEK_SEQ\" = \"D2\".\"D_WEEK_SEQ\" AND \"D2\".\"D_DATE_SK\" = \"INVENTORY\".\"INV_DATE_SK\" JOIN \"DATE_DIM\" AS \"D3\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"D3\".\"D_DATE_SK\" AND \"D3\".\"D_DATE\" > \"D1\".\"D_DATE\" + 5 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"INVENTORY\".\"INV_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY \"ITEM\".\"I_ITEM_DESC\", \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"D1\".\"D_WEEK_SEQ\" ORDER BY \"TOTAL_CNT\" DESC NULLS FIRST, \"I_ITEM_DESC\" NULLS LAST, \"W_WAREHOUSE_NAME\" NULLS LAST, \"D_WEEK_SEQ\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"W_WAREHOUSE_NAME\" AS \"W_WAREHOUSE_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_WEEK_SEQ\" AS \"D_WEEK_SEQ\" , \"SPEQLITE_TEMP_TABLE_1\".\"NO_PROMO\" AS \"NO_PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"PROMO\" AS \"PROMO\" , \"SPEQLITE_TEMP_TABLE_1\".\"TOTAL_CNT\" AS \"TOTAL_CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ORDER BY \"TOTAL_CNT\" DESC NULLS FIRST , \"I_ITEM_DESC\" NULLS LAST , \"W_WAREHOUSE_NAME\" NULLS LAST , \"D_WEEK_SEQ\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*                                                                                                                                                                                            i_item_desc      w_warehouse_name  d_week_seq  no_promo  promo  total_cnt\n0                                                                                                         English weeks say anymore police; together happy traders shall buy strongly english other lad      Plain, reluctant        5264         0      3          3\n1                                                                                                    Just acceptable personnel hear above detailed, open results. Necessary leaders seek general, certa   Conventional childr        5264         0      3          3\n2                                                                                                    Just acceptable personnel hear above detailed, open results. Necessary leaders seek general, certa           Doors canno        5264         0      3          3\n3                                                                                                    Just acceptable personnel hear above detailed, open results. Necessary leaders seek general, certa      Plain, reluctant        5264         0      3          3\n4                                                                                                                               National regulations make minutes. Left sources take easy songs; only s      Plain, reluctant        5264         0      3          3\n5                                                                                                     Soft letters mean then final, grim leads. Strategic, good forms protect straight red, good change      National, comple        5263         0      3          3\n6                                                                                                                                                                                       Users shall ach      Plain, reluctant        5264         0      3          3\n7                                                                                                                                                                                                                                    5270         0      2          2\n8                                                                                                                                                                                                        Bad cards must make.        5253         0      2          2\n9                                                                                                                                                                                                        Bad cards must make.        5263         0      2          2\n10                                                                                                                                                                                                        Conventional childr        5260         0      2          2\n11                                                                                                                                                                                                                Doors canno        5265         0      2          2\n12                                                                                                                                                                                                       Important issues liv        5246         0      2          2\n13                                                                                                                                                                                                       Important issues liv        5255         0      2          2\n...*/"
    }
]