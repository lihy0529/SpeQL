[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "select /* TPC-DS query99.tpl 0.94 */  \n   '' as w_warehouse_name\n  ,'' as sm_type\n  ,'' as cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT '' AS \"W_WAREHOUSE_NAME\" , '' AS \"SM_TYPE\" , '' AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT '' AS \"W_WAREHOUSE_NAME\" , '' AS \"SM_TYPE\" , '' AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LIMIT 21",
                "preview": "\n/*  w_warehouse_name sm_type cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                                   4658842     4815552     4819038            0            0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.073053,
                    "execution_time": 0.030969,
                    "compile_time": 0.00011,
                    "planning_time": 0.033044
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.14192,
                    "execution_time": 0.036414,
                    "compile_time": 0.000114,
                    "planning_time": 0.093123
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT '' AS \"W_WAREHOUSE_NAME\", '' AS \"SM_TYPE\", '' AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\"",
                "rewrite": "SELECT '' AS \"W_WAREHOUSE_NAME\", '' AS \"SM_TYPE\", '' AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\""
            }
        ],
        "preview": "\n/*  w_warehouse_name sm_type cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0                                   4658842     4815552     4819038            0            0*/"
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20) /* Add to GROUP BY clause */\n  , '' as sm_type\n  , '' as cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\ngroup by\n   w_warehouse_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , '' AS \"SM_TYPE\" , '' AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , '' AS \"SM_TYPE\" , '' AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.477034,
                    "execution_time": 0.376498,
                    "compile_time": 0.030266,
                    "planning_time": 0.039427,
                    "create_size": 55
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.858802,
                    "execution_time": 0.385283,
                    "compile_time": 3.329243,
                    "planning_time": 0.11007,
                    "create_size": 55
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*                 _col_0 sm_type cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0  Bad cards must make.                  4658842     4815552     4819038            0            0\n1           Rooms cook                   4658842     4815552     4819038            0            0\n2      National, comple                  4658842     4815552     4819038            0            0\n3  Important issues liv                  4658842     4815552     4819038            0            0\n4      Plain, reluctant                  4658842     4815552     4819038            0            0\n5  Local, mass universi                  4658842     4815552     4819038            0            0\n6        Quite effectiv                  4658842     4815552     4819038            0            0\n7   Conventional childr                  4658842     4815552     4819038            0            0\n8           Doors canno                  4658842     4815552     4819038            0            0\n9                                        4658842     4815552     4819038            0            0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.034436,
                    "execution_time": 0.00792,
                    "compile_time": 0.015505,
                    "planning_time": 0.004333
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.328912,
                    "execution_time": 0.00813,
                    "compile_time": 3.257168,
                    "planning_time": 0.052683
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", '' AS \"SM_TYPE\", '' AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_1\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_1\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*                 _col_0 sm_type cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0  Bad cards must make.                  4658842     4815552     4819038            0            0\n1           Rooms cook                   4658842     4815552     4819038            0            0\n2      National, comple                  4658842     4815552     4819038            0            0\n3  Important issues liv                  4658842     4815552     4819038            0            0\n4      Plain, reluctant                  4658842     4815552     4819038            0            0\n5  Local, mass universi                  4658842     4815552     4819038            0            0\n6        Quite effectiv                  4658842     4815552     4819038            0            0\n7   Conventional childr                  4658842     4815552     4819038            0            0\n8           Doors canno                  4658842     4815552     4819038            0            0\n9                                        4658842     4815552     4819038            0            0*/"
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20) /* Adding 'w_warehouse_name' to the GROUP BY clause */\n  ,sm_type\n  ,'' as cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\ngroup by\n   w_warehouse_name, sm_type\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , '' AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , '' AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , \"SHIP_MODE\".\"SM_TYPE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 9.387532,
                    "execution_time": 9.248465,
                    "compile_time": 0.065166,
                    "planning_time": 0.042664,
                    "create_size": 88
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 12.691265,
                    "execution_time": 9.209543,
                    "compile_time": 3.320336,
                    "planning_time": 0.122952,
                    "create_size": 88
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_2\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*                  _col_0    sm_type cc_name   30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0            Doors canno    EXPRESS          18635368    19262208    19276152            0            0\n1         Quite effectiv    EXPRESS          18635368    19262208    19276152            0            0\n2         Quite effectiv   NEXT DAY          18635368    19262208    19276152            0            0\n3                           LIBRARY          13976526    14446656    14457114            0            0\n4         Quite effectiv    LIBRARY          13976526    14446656    14457114            0            0\n5       Plain, reluctant    LIBRARY          13976526    14446656    14457114            0            0\n6            Rooms cook     REGULAR          13976526    14446656    14457114            0            0\n7                           EXPRESS          18635368    19262208    19276152            0            0\n8       Plain, reluctant    EXPRESS          18635368    19262208    19276152            0            0\n9   Important issues liv   NEXT DAY          18635368    19262208    19276152            0            0\n10   Conventional childr  OVERNIGHT          13976526    14446656    14457114            0            0\n11           Rooms cook   OVERNIGHT          13976526    14446656    14457114            0            0\n12                          TWO DAY          13976526    14446656    14457114            0            0\n13           Rooms cook     TWO DAY          13976526    14446656    14457114            0            0\n14           Rooms cook     LIBRARY          13976526    14446656    14457114            0            0\n15      National, comple    LIBRARY          13976526    14446656    14457114            0            0\n16      Plain, reluctant    REGULAR          13976526    14446656    14457114            0            0\n17  Bad cards must make.   NEXT DAY          18635368    19262208    19276152            0            0\n18      National, comple   NEXT DAY          18635368    19262208    19276152            0            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.035543,
                    "execution_time": 0.007202,
                    "compile_time": 0.017893,
                    "planning_time": 0.004044
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.176234,
                    "execution_time": 0.007745,
                    "compile_time": 3.117377,
                    "planning_time": 0.039985
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", '' AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY \"WAREHOUSE\".\"W_WAREHOUSE_NAME\", \"SHIP_MODE\".\"SM_TYPE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_2\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_2\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*                  _col_0    sm_type cc_name   30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0            Doors canno    EXPRESS          18635368    19262208    19276152            0            0\n1         Quite effectiv    EXPRESS          18635368    19262208    19276152            0            0\n2         Quite effectiv   NEXT DAY          18635368    19262208    19276152            0            0\n3                           LIBRARY          13976526    14446656    14457114            0            0\n4         Quite effectiv    LIBRARY          13976526    14446656    14457114            0            0\n5       Plain, reluctant    LIBRARY          13976526    14446656    14457114            0            0\n6            Rooms cook     REGULAR          13976526    14446656    14457114            0            0\n7                           EXPRESS          18635368    19262208    19276152            0            0\n8       Plain, reluctant    EXPRESS          18635368    19262208    19276152            0            0\n9   Important issues liv   NEXT DAY          18635368    19262208    19276152            0            0\n10   Conventional childr  OVERNIGHT          13976526    14446656    14457114            0            0\n11           Rooms cook   OVERNIGHT          13976526    14446656    14457114            0            0\n12                          TWO DAY          13976526    14446656    14457114            0            0\n13           Rooms cook     TWO DAY          13976526    14446656    14457114            0            0\n14           Rooms cook     LIBRARY          13976526    14446656    14457114            0            0\n15      National, comple    LIBRARY          13976526    14446656    14457114            0            0\n16      Plain, reluctant    REGULAR          13976526    14446656    14457114            0            0\n17  Bad cards must make.   NEXT DAY          18635368    19262208    19276152            0            0\n18      National, comple   NEXT DAY          18635368    19262208    19276152            0            0\n...*/"
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\ngroup by\n   substring(w_warehouse_name,1,20), sm_type, cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\ngroup by\n   substring(w_warehouse_name,1,20), sm_type, cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n/*CURSOR_IDENTIFIER*/;",
        "optimize": [
            "SELECT SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LIMIT 21",
                "preview": "\n/*   30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0  4658842     4815552     4819038            0            0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.070733,
                    "execution_time": 0.031819,
                    "compile_time": 0.00011,
                    "planning_time": 0.029921
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.129217,
                    "execution_time": 0.031569,
                    "compile_time": 0.000127,
                    "planning_time": 0.088736
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\"",
                "rewrite": "SELECT SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\""
            }
        ],
        "preview": "\n/*   30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0  4658842     4815552     4819038            0            0*/"
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\ngroup by\n   substring(w_warehouse_name,1,20), sm_type, cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\ngroup by\n   substring(w_warehouse_name,1,20), sm_type, cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" FROM 1 FOR 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\"",
                "rewrite": "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" CROSS JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\ngroup by\n   substring(w_warehouse_name,1,20), sm_type, cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 7.275939,
                    "execution_time": 7.16983,
                    "compile_time": 0.000509,
                    "planning_time": 0.06776,
                    "create_size": 88
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 12.20386,
                    "execution_time": 7.210752,
                    "compile_time": 4.79751,
                    "planning_time": 0.150874,
                    "create_size": 88
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_3\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_3\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_3\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_3\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_3\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*                  _col_0    sm_type              cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0         Quite effectiv    LIBRARY         California_1   557010      579042      574536            0            0\n1         Quite effectiv  OVERNIGHT  Pacific Northwest_1   278505      289521      287268            0            0\n2         Quite effectiv    REGULAR      North Midwest_1   835515      868563      861804            0            0\n3         Quite effectiv   NEXT DAY       Mid Atlantic_1   742680      772056      766048            0            0\n4         Quite effectiv   NEXT DAY        North Midwest  1114020     1158084     1149072            0            0\n5         Quite effectiv  OVERNIGHT        North Midwest   835515      868563      861804            0            0\n6         Quite effectiv   NEXT DAY         Mid Atlantic   742680      772056      766048            0            0\n7         Quite effectiv  OVERNIGHT         Mid Atlantic   557010      579042      574536            0            0\n8         Quite effectiv    REGULAR             NY Metro   278505      289521      287268            0            0\n9         Quite effectiv    LIBRARY             NY Metro   278505      289521      287268            0            0\n10        Quite effectiv  OVERNIGHT             NY Metro   278505      289521      287268            0            0\n11  Important issues liv    LIBRARY         California_1   558414      578748      576690            0            0\n12  Important issues liv    EXPRESS      North Midwest_1  1116828     1157496     1153380            0            0\n13  Important issues liv   NEXT DAY       Mid Atlantic_1   744552      771664      768920            0            0\n14  Important issues liv    REGULAR           NY Metro_1   279207      289374      288345            0            0\n15  Important issues liv    LIBRARY        Hawaii/Alaska   837621      868122      865035            0            0\n16  Important issues liv    LIBRARY           California   558414      578748      576690            0            0\n17  Important issues liv   NEXT DAY             NY Metro   372276      385832      384460            0            0\n18  Local, mass universi    REGULAR      Hawaii/Alaska_1   833661      865368      864378            0            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01848,
                    "execution_time": 0.007862,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004287
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05578,
                    "execution_time": 0.007324,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.040301
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" CROSS JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_3\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_3\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_3\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_3\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_3\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*                  _col_0    sm_type              cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0         Quite effectiv    LIBRARY         California_1   557010      579042      574536            0            0\n1         Quite effectiv  OVERNIGHT  Pacific Northwest_1   278505      289521      287268            0            0\n2         Quite effectiv    REGULAR      North Midwest_1   835515      868563      861804            0            0\n3         Quite effectiv   NEXT DAY       Mid Atlantic_1   742680      772056      766048            0            0\n4         Quite effectiv   NEXT DAY        North Midwest  1114020     1158084     1149072            0            0\n5         Quite effectiv  OVERNIGHT        North Midwest   835515      868563      861804            0            0\n6         Quite effectiv   NEXT DAY         Mid Atlantic   742680      772056      766048            0            0\n7         Quite effectiv  OVERNIGHT         Mid Atlantic   557010      579042      574536            0            0\n8         Quite effectiv    REGULAR             NY Metro   278505      289521      287268            0            0\n9         Quite effectiv    LIBRARY             NY Metro   278505      289521      287268            0            0\n10        Quite effectiv  OVERNIGHT             NY Metro   278505      289521      287268            0            0\n11  Important issues liv    LIBRARY         California_1   558414      578748      576690            0            0\n12  Important issues liv    EXPRESS      North Midwest_1  1116828     1157496     1153380            0            0\n13  Important issues liv   NEXT DAY       Mid Atlantic_1   744552      771664      768920            0            0\n14  Important issues liv    REGULAR           NY Metro_1   279207      289374      288345            0            0\n15  Important issues liv    LIBRARY        Hawaii/Alaska   837621      868122      865035            0            0\n16  Important issues liv    LIBRARY           California   558414      578748      576690            0            0\n17  Important issues liv   NEXT DAY             NY Metro   372276      385832      384460            0            0\n18  Local, mass universi    REGULAR      Hawaii/Alaska_1   833661      865368      864378            0            0\n...*/"
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\ngroup by\n   substring(w_warehouse_name,1,20), sm_type, cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.68942,
                    "execution_time": 0.506928,
                    "compile_time": 0.076916,
                    "planning_time": 0.067679,
                    "create_size": 88
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 12.399568,
                    "execution_time": 8.765512,
                    "compile_time": 3.314713,
                    "planning_time": 0.15829,
                    "create_size": 88
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_4\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_4\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_4\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_4\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_4\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*                  _col_0    sm_type            cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0         Quite effectiv    EXPRESS    Hawaii/Alaska_1    55380       58251       56550            0            0\n1         Quite effectiv    EXPRESS     Mid Atlantic_1    36920       38834       37700            0            0\n2         Quite effectiv    EXPRESS      North Midwest    55380       58251       56550            0            0\n3         Quite effectiv    EXPRESS           NY Metro    18460       19417       18850            0            0\n4   Important issues liv   NEXT DAY  Pacific Northwest    18785       19134       19167            0            0\n5   Important issues liv   NEXT DAY       Mid Atlantic    37570       38268       38334            0            0\n6   Local, mass universi    EXPRESS      Hawaii/Alaska    55452       57150       57093            0            0\n7            Doors canno    LIBRARY       California_1    27912       28972       28462            0            0\n8            Doors canno    LIBRARY      Hawaii/Alaska    41868       43458       42693            0            0\n9            Doors canno    LIBRARY         California    27912       28972       28462            0            0\n10  Important issues liv    LIBRARY      North Midwest    41520       42828       42471            0            0\n11  Important issues liv    LIBRARY           NY Metro    13840       14276       14157            0            0\n12   Conventional childr  OVERNIGHT    North Midwest_1    41787       43185       43428            0            0\n13   Conventional childr  OVERNIGHT      North Midwest    41787       43185       43428            0            0\n14   Conventional childr  OVERNIGHT           NY Metro    13929       14395       14476            0            0\n15      National, comple    EXPRESS       California_1    37484       38498       37984            0            0\n16      National, comple    EXPRESS     Mid Atlantic_1    37484       38498       37984            0            0\n17      National, comple    EXPRESS           NY Metro    18742       19249       18992            0            0\n18  Bad cards must make.    EXPRESS         California    36766       38702       38204            0            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017932,
                    "execution_time": 0.007211,
                    "compile_time": 5e-05,
                    "planning_time": 0.004284
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053931,
                    "execution_time": 0.007387,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.040014
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_4\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_4\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_4\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_4\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_4\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*                  _col_0    sm_type            cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0         Quite effectiv    EXPRESS    Hawaii/Alaska_1    55380       58251       56550            0            0\n1         Quite effectiv    EXPRESS     Mid Atlantic_1    36920       38834       37700            0            0\n2         Quite effectiv    EXPRESS      North Midwest    55380       58251       56550            0            0\n3         Quite effectiv    EXPRESS           NY Metro    18460       19417       18850            0            0\n4   Important issues liv   NEXT DAY  Pacific Northwest    18785       19134       19167            0            0\n5   Important issues liv   NEXT DAY       Mid Atlantic    37570       38268       38334            0            0\n6   Local, mass universi    EXPRESS      Hawaii/Alaska    55452       57150       57093            0            0\n7            Doors canno    LIBRARY       California_1    27912       28972       28462            0            0\n8            Doors canno    LIBRARY      Hawaii/Alaska    41868       43458       42693            0            0\n9            Doors canno    LIBRARY         California    27912       28972       28462            0            0\n10  Important issues liv    LIBRARY      North Midwest    41520       42828       42471            0            0\n11  Important issues liv    LIBRARY           NY Metro    13840       14276       14157            0            0\n12   Conventional childr  OVERNIGHT    North Midwest_1    41787       43185       43428            0            0\n13   Conventional childr  OVERNIGHT      North Midwest    41787       43185       43428            0            0\n14   Conventional childr  OVERNIGHT           NY Metro    13929       14395       14476            0            0\n15      National, comple    EXPRESS       California_1    37484       38498       37984            0            0\n16      National, comple    EXPRESS     Mid Atlantic_1    37484       38498       37984            0            0\n17      National, comple    EXPRESS           NY Metro    18742       19249       18992            0            0\n18  Bad cards must make.    EXPRESS         California    36766       38702       38204            0            0\n...*/"
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\n   substring(w_warehouse_name,1,20), sm_type, cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.085488,
                    "execution_time": 0.919709,
                    "compile_time": 0.059474,
                    "planning_time": 0.068666,
                    "create_size": 88
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.422752,
                    "execution_time": 0.942421,
                    "compile_time": 3.288342,
                    "planning_time": 0.150956,
                    "create_size": 88
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_5\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*                  _col_0    sm_type            cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0       National, comple   NEXT DAY       California_1     1586        1615        1578            0            0\n1   Bad cards must make.    LIBRARY      Hawaii/Alaska     1145        1185        1188            0            0\n2       National, comple    EXPRESS       Mid Atlantic     1550        1617        1598            0            0\n3    Conventional childr    EXPRESS    North Midwest_1     1532        1625        1622            0            0\n4            Doors canno    EXPRESS      Hawaii/Alaska     1562        1565        1623            0            0\n5         Quite effectiv  OVERNIGHT  Pacific Northwest     1194        1184        1214            0            0\n6                           LIBRARY       Mid Atlantic     1162        1208        1184            0            0\n7   Local, mass universi   NEXT DAY  Pacific Northwest     1535        1593        1658            0            0\n8       National, comple  OVERNIGHT    Hawaii/Alaska_1     1215        1222        1180            0            0\n9   Bad cards must make.    EXPRESS       Mid Atlantic     1523        1600        1533            0            0\n10   Conventional childr    TWO DAY       Mid Atlantic     1167        1194        1142            0            0\n11           Doors canno   NEXT DAY     Mid Atlantic_1     1520        1555        1565            0            0\n12  Local, mass universi  OVERNIGHT      Hawaii/Alaska     1075        1112        1241            0            0\n13  Bad cards must make.    LIBRARY         NY Metro_1     1158        1204        1194            0            0\n14      National, comple   NEXT DAY         California     1538        1596        1600            0            0\n15      National, comple    REGULAR    Hawaii/Alaska_1     1166        1219        1168            0            0\n16           Doors canno   NEXT DAY       Mid Atlantic     1514        1584        1540            0            0\n17                         NEXT DAY  Pacific Northwest     1555        1611        1595            0            0\n18  Bad cards must make.    EXPRESS           NY Metro     1509        1580        1523            0            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018398,
                    "execution_time": 0.007439,
                    "compile_time": 5e-05,
                    "planning_time": 0.004407
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055238,
                    "execution_time": 0.00734,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.040205
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_5\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*                  _col_0    sm_type            cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0       National, comple   NEXT DAY       California_1     1586        1615        1578            0            0\n1   Bad cards must make.    LIBRARY      Hawaii/Alaska     1145        1185        1188            0            0\n2       National, comple    EXPRESS       Mid Atlantic     1550        1617        1598            0            0\n3    Conventional childr    EXPRESS    North Midwest_1     1532        1625        1622            0            0\n4            Doors canno    EXPRESS      Hawaii/Alaska     1562        1565        1623            0            0\n5         Quite effectiv  OVERNIGHT  Pacific Northwest     1194        1184        1214            0            0\n6                           LIBRARY       Mid Atlantic     1162        1208        1184            0            0\n7   Local, mass universi   NEXT DAY  Pacific Northwest     1535        1593        1658            0            0\n8       National, comple  OVERNIGHT    Hawaii/Alaska_1     1215        1222        1180            0            0\n9   Bad cards must make.    EXPRESS       Mid Atlantic     1523        1600        1533            0            0\n10   Conventional childr    TWO DAY       Mid Atlantic     1167        1194        1142            0            0\n11           Doors canno   NEXT DAY     Mid Atlantic_1     1520        1555        1565            0            0\n12  Local, mass universi  OVERNIGHT      Hawaii/Alaska     1075        1112        1241            0            0\n13  Bad cards must make.    LIBRARY         NY Metro_1     1158        1204        1194            0            0\n14      National, comple   NEXT DAY         California     1538        1596        1600            0            0\n15      National, comple    REGULAR    Hawaii/Alaska_1     1166        1219        1168            0            0\n16           Doors canno   NEXT DAY       Mid Atlantic     1514        1584        1540            0            0\n17                         NEXT DAY  Pacific Northwest     1555        1611        1595            0            0\n18  Bad cards must make.    EXPRESS           NY Metro     1509        1580        1523            0            0\n...*/"
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\nsubstring(w_warehouse_name,1,20), sm_type, cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"_COL_0\" AS \"_COL_0\" , \"SM_TYPE\" AS \"SM_TYPE\" , \"CC_NAME\" AS \"CC_NAME\" , \"30 DAYS\" AS \"30 DAYS\" , \"31-60 DAYS\" AS \"31-60 DAYS\" , \"61-90 DAYS\" AS \"61-90 DAYS\" , \"91-120 DAYS\" AS \"91-120 DAYS\" , \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*                  _col_0    sm_type              cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0   Local, mass universi    EXPRESS         Mid Atlantic     1564        1485        1595            0            0\n1       Plain, reluctant    EXPRESS      North Midwest_1     1586        1650        1569            0            0\n2   Local, mass universi  OVERNIGHT       Mid Atlantic_1     1162        1196        1204            0            0\n3            Doors canno   NEXT DAY    Pacific Northwest     1648        1651        1645            0            0\n4       Plain, reluctant    TWO DAY           California     1163        1233        1172            0            0\n5         Quite effectiv    EXPRESS    Pacific Northwest     1544        1688        1534            0            0\n6                           EXPRESS         Mid Atlantic     1546        1628        1546            0            0\n7            Rooms cook     EXPRESS      North Midwest_1     1434        1564        1664            0            0\n8   Local, mass universi    TWO DAY       Mid Atlantic_1     1101        1174        1218            0            0\n9            Doors canno    LIBRARY       Mid Atlantic_1     1171        1239        1196            0            0\n10  Bad cards must make.   NEXT DAY           California     1563        1527        1656            0            0\n11  Important issues liv    TWO DAY           NY Metro_1     1216        1218        1168            0            0\n12  Local, mass universi   NEXT DAY        Hawaii/Alaska     1523        1630        1573            0            0\n13  Local, mass universi    EXPRESS    Pacific Northwest     1498        1606        1593            0            0\n14   Conventional childr    REGULAR    Pacific Northwest     1181        1257        1250            0            0\n15   Conventional childr    TWO DAY    Pacific Northwest     1182        1240        1185            0            0\n16           Rooms cook     REGULAR  Pacific Northwest_1     1157        1247        1174            0            0\n17  Local, mass universi   NEXT DAY      Hawaii/Alaska_1     1584        1562        1609            0            0\n18      Plain, reluctant    EXPRESS             NY Metro     1522        1594        1570            0            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018377,
                    "execution_time": 0.007683,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004314
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053689,
                    "execution_time": 0.007749,
                    "compile_time": 6.3e-05,
                    "planning_time": 0.039435
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\"",
                "rewrite": "SELECT \"_COL_0\" AS \"_COL_0\", \"SM_TYPE\" AS \"SM_TYPE\", \"CC_NAME\" AS \"CC_NAME\", \"30 DAYS\" AS \"30 DAYS\", \"31-60 DAYS\" AS \"31-60 DAYS\", \"61-90 DAYS\" AS \"61-90 DAYS\", \"91-120 DAYS\" AS \"91-120 DAYS\", \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*                  _col_0    sm_type              cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0   Local, mass universi    EXPRESS         Mid Atlantic     1564        1485        1595            0            0\n1       Plain, reluctant    EXPRESS      North Midwest_1     1586        1650        1569            0            0\n2   Local, mass universi  OVERNIGHT       Mid Atlantic_1     1162        1196        1204            0            0\n3            Doors canno   NEXT DAY    Pacific Northwest     1648        1651        1645            0            0\n4       Plain, reluctant    TWO DAY           California     1163        1233        1172            0            0\n5         Quite effectiv    EXPRESS    Pacific Northwest     1544        1688        1534            0            0\n6                           EXPRESS         Mid Atlantic     1546        1628        1546            0            0\n7            Rooms cook     EXPRESS      North Midwest_1     1434        1564        1664            0            0\n8   Local, mass universi    TWO DAY       Mid Atlantic_1     1101        1174        1218            0            0\n9            Doors canno    LIBRARY       Mid Atlantic_1     1171        1239        1196            0            0\n10  Bad cards must make.   NEXT DAY           California     1563        1527        1656            0            0\n11  Important issues liv    TWO DAY           NY Metro_1     1216        1218        1168            0            0\n12  Local, mass universi   NEXT DAY        Hawaii/Alaska     1523        1630        1573            0            0\n13  Local, mass universi    EXPRESS    Pacific Northwest     1498        1606        1593            0            0\n14   Conventional childr    REGULAR    Pacific Northwest     1181        1257        1250            0            0\n15   Conventional childr    TWO DAY    Pacific Northwest     1182        1240        1185            0            0\n16           Rooms cook     REGULAR  Pacific Northwest_1     1157        1247        1174            0            0\n17  Local, mass universi   NEXT DAY      Hawaii/Alaska_1     1584        1562        1609            0            0\n18      Plain, reluctant    EXPRESS             NY Metro     1522        1594        1570            0            0\n...*/"
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\n   substring(w_warehouse_name,1,20), sm_type, cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"_COL_0\" AS \"_COL_0\" , \"SM_TYPE\" AS \"SM_TYPE\" , \"CC_NAME\" AS \"CC_NAME\" , \"30 DAYS\" AS \"30 DAYS\" , \"31-60 DAYS\" AS \"31-60 DAYS\" , \"61-90 DAYS\" AS \"61-90 DAYS\" , \"91-120 DAYS\" AS \"91-120 DAYS\" , \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*                  _col_0    sm_type            cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0       Plain, reluctant   NEXT DAY       California_1     1559        1583        1598            0            0\n1                          NEXT DAY     Mid Atlantic_1     1535        1599        1568            0            0\n2    Conventional childr   NEXT DAY       California_1     1587        1541        1630            0            0\n3       Plain, reluctant   NEXT DAY      Hawaii/Alaska     1573        1673        1576            0            0\n4   Local, mass universi  OVERNIGHT         NY Metro_1     1176        1202        1232            0            0\n5   Important issues liv   NEXT DAY         NY Metro_1     1544        1590        1629            0            0\n6         Quite effectiv    EXPRESS    North Midwest_1     1498        1664        1604            0            0\n7            Doors canno   NEXT DAY    North Midwest_1     1566        1617        1578            0            0\n8   Local, mass universi    LIBRARY     Mid Atlantic_1     1130        1165        1177            0            0\n9   Important issues liv    TWO DAY    North Midwest_1     1219        1195        1203            0            0\n10           Doors canno    TWO DAY         NY Metro_1     1160        1166        1209            0            0\n11           Rooms cook    NEXT DAY  Pacific Northwest     1591        1667        1534            0            0\n12           Doors canno  OVERNIGHT    North Midwest_1     1190        1166        1195            0            0\n13      Plain, reluctant  OVERNIGHT     Mid Atlantic_1     1184        1133        1180            0            0\n14        Quite effectiv    LIBRARY         NY Metro_1     1192        1248        1191            0            0\n15           Doors canno    REGULAR      Hawaii/Alaska     1174        1196        1263            0            0\n16  Local, mass universi    TWO DAY    Hawaii/Alaska_1     1127        1302        1224            0            0\n17           Rooms cook     EXPRESS      North Midwest     1590        1540        1636            0            0\n18   Conventional childr  OVERNIGHT    Hawaii/Alaska_1     1160        1264        1212            0            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01754,
                    "execution_time": 0.006974,
                    "compile_time": 5e-05,
                    "planning_time": 0.004282
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018427,
                    "execution_time": 0.00741,
                    "compile_time": 6.6e-05,
                    "planning_time": 0.004388
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\"",
                "rewrite": "SELECT \"_COL_0\" AS \"_COL_0\", \"SM_TYPE\" AS \"SM_TYPE\", \"CC_NAME\" AS \"CC_NAME\", \"30 DAYS\" AS \"30 DAYS\", \"31-60 DAYS\" AS \"31-60 DAYS\", \"61-90 DAYS\" AS \"61-90 DAYS\", \"91-120 DAYS\" AS \"91-120 DAYS\", \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*                  _col_0    sm_type            cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0       Plain, reluctant   NEXT DAY       California_1     1559        1583        1598            0            0\n1                          NEXT DAY     Mid Atlantic_1     1535        1599        1568            0            0\n2    Conventional childr   NEXT DAY       California_1     1587        1541        1630            0            0\n3       Plain, reluctant   NEXT DAY      Hawaii/Alaska     1573        1673        1576            0            0\n4   Local, mass universi  OVERNIGHT         NY Metro_1     1176        1202        1232            0            0\n5   Important issues liv   NEXT DAY         NY Metro_1     1544        1590        1629            0            0\n6         Quite effectiv    EXPRESS    North Midwest_1     1498        1664        1604            0            0\n7            Doors canno   NEXT DAY    North Midwest_1     1566        1617        1578            0            0\n8   Local, mass universi    LIBRARY     Mid Atlantic_1     1130        1165        1177            0            0\n9   Important issues liv    TWO DAY    North Midwest_1     1219        1195        1203            0            0\n10           Doors canno    TWO DAY         NY Metro_1     1160        1166        1209            0            0\n11           Rooms cook    NEXT DAY  Pacific Northwest     1591        1667        1534            0            0\n12           Doors canno  OVERNIGHT    North Midwest_1     1190        1166        1195            0            0\n13      Plain, reluctant  OVERNIGHT     Mid Atlantic_1     1184        1133        1180            0            0\n14        Quite effectiv    LIBRARY         NY Metro_1     1192        1248        1191            0            0\n15           Doors canno    REGULAR      Hawaii/Alaska     1174        1196        1263            0            0\n16  Local, mass universi    TWO DAY    Hawaii/Alaska_1     1127        1302        1224            0            0\n17           Rooms cook     EXPRESS      North Midwest     1590        1540        1636            0            0\n18   Conventional childr  OVERNIGHT    Hawaii/Alaska_1     1160        1264        1212            0            0\n...*/"
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"_COL_0\" AS \"_COL_0\" , \"SM_TYPE\" AS \"SM_TYPE\" , \"CC_NAME\" AS \"CC_NAME\" , \"30 DAYS\" AS \"30 DAYS\" , \"31-60 DAYS\" AS \"31-60 DAYS\" , \"61-90 DAYS\" AS \"61-90 DAYS\" , \"91-120 DAYS\" AS \"91-120 DAYS\" , \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*                  _col_0    sm_type            cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0       Plain, reluctant   NEXT DAY       California_1     1559        1583        1598            0            0\n1                          NEXT DAY     Mid Atlantic_1     1535        1599        1568            0            0\n2    Conventional childr   NEXT DAY       California_1     1587        1541        1630            0            0\n3       Plain, reluctant   NEXT DAY      Hawaii/Alaska     1573        1673        1576            0            0\n4   Local, mass universi  OVERNIGHT         NY Metro_1     1176        1202        1232            0            0\n5   Important issues liv   NEXT DAY         NY Metro_1     1544        1590        1629            0            0\n6         Quite effectiv    EXPRESS    North Midwest_1     1498        1664        1604            0            0\n7            Doors canno   NEXT DAY    North Midwest_1     1566        1617        1578            0            0\n8   Local, mass universi    LIBRARY     Mid Atlantic_1     1130        1165        1177            0            0\n9   Important issues liv    TWO DAY    North Midwest_1     1219        1195        1203            0            0\n10           Doors canno    TWO DAY         NY Metro_1     1160        1166        1209            0            0\n11           Rooms cook    NEXT DAY  Pacific Northwest     1591        1667        1534            0            0\n12           Doors canno  OVERNIGHT    North Midwest_1     1190        1166        1195            0            0\n13      Plain, reluctant  OVERNIGHT     Mid Atlantic_1     1184        1133        1180            0            0\n14        Quite effectiv    LIBRARY         NY Metro_1     1192        1248        1191            0            0\n15           Doors canno    REGULAR      Hawaii/Alaska     1174        1196        1263            0            0\n16  Local, mass universi    TWO DAY    Hawaii/Alaska_1     1127        1302        1224            0            0\n17           Rooms cook     EXPRESS      North Midwest     1590        1540        1636            0            0\n18   Conventional childr  OVERNIGHT    Hawaii/Alaska_1     1160        1264        1212            0            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018202,
                    "execution_time": 0.007374,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.004367
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017985,
                    "execution_time": 0.007205,
                    "compile_time": 5e-05,
                    "planning_time": 0.004321
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\"",
                "rewrite": "SELECT \"_COL_0\" AS \"_COL_0\", \"SM_TYPE\" AS \"SM_TYPE\", \"CC_NAME\" AS \"CC_NAME\", \"30 DAYS\" AS \"30 DAYS\", \"31-60 DAYS\" AS \"31-60 DAYS\", \"61-90 DAYS\" AS \"61-90 DAYS\", \"91-120 DAYS\" AS \"91-120 DAYS\", \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*                  _col_0    sm_type            cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0       Plain, reluctant   NEXT DAY       California_1     1559        1583        1598            0            0\n1                          NEXT DAY     Mid Atlantic_1     1535        1599        1568            0            0\n2    Conventional childr   NEXT DAY       California_1     1587        1541        1630            0            0\n3       Plain, reluctant   NEXT DAY      Hawaii/Alaska     1573        1673        1576            0            0\n4   Local, mass universi  OVERNIGHT         NY Metro_1     1176        1202        1232            0            0\n5   Important issues liv   NEXT DAY         NY Metro_1     1544        1590        1629            0            0\n6         Quite effectiv    EXPRESS    North Midwest_1     1498        1664        1604            0            0\n7            Doors canno   NEXT DAY    North Midwest_1     1566        1617        1578            0            0\n8   Local, mass universi    LIBRARY     Mid Atlantic_1     1130        1165        1177            0            0\n9   Important issues liv    TWO DAY    North Midwest_1     1219        1195        1203            0            0\n10           Doors canno    TWO DAY         NY Metro_1     1160        1166        1209            0            0\n11           Rooms cook    NEXT DAY  Pacific Northwest     1591        1667        1534            0            0\n12           Doors canno  OVERNIGHT    North Midwest_1     1190        1166        1195            0            0\n13      Plain, reluctant  OVERNIGHT     Mid Atlantic_1     1184        1133        1180            0            0\n14        Quite effectiv    LIBRARY         NY Metro_1     1192        1248        1191            0            0\n15           Doors canno    REGULAR      Hawaii/Alaska     1174        1196        1263            0            0\n16  Local, mass universi    TWO DAY    Hawaii/Alaska_1     1127        1302        1224            0            0\n17           Rooms cook     EXPRESS      North Midwest     1590        1540        1636            0            0\n18   Conventional childr  OVERNIGHT    Hawaii/Alaska_1     1160        1264        1212            0            0\n...*/"
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"_COL_0\" AS \"_COL_0\" , \"SM_TYPE\" AS \"SM_TYPE\" , \"CC_NAME\" AS \"CC_NAME\" , \"30 DAYS\" AS \"30 DAYS\" , \"31-60 DAYS\" AS \"31-60 DAYS\" , \"61-90 DAYS\" AS \"61-90 DAYS\" , \"91-120 DAYS\" AS \"91-120 DAYS\" , \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*                  _col_0    sm_type              cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0   Important issues liv    TWO DAY         Mid Atlantic     1152        1155        1229            0            0\n1            Rooms cook     LIBRARY         Mid Atlantic     1098        1226        1228            0            0\n2   Local, mass universi    TWO DAY         Mid Atlantic     1159        1221        1232            0            0\n3       National, comple    LIBRARY        Hawaii/Alaska     1194        1193        1190            0            0\n4       Plain, reluctant    REGULAR             NY Metro     1168        1197        1131            0            0\n5   Important issues liv  OVERNIGHT         Mid Atlantic     1114        1199        1176            0            0\n6            Doors canno    REGULAR    Pacific Northwest     1171        1242        1183            0            0\n7                           REGULAR      Hawaii/Alaska_1     1167        1170        1196            0            0\n8       National, comple  OVERNIGHT         Mid Atlantic     1153        1209        1188            0            0\n9   Important issues liv    LIBRARY      North Midwest_1     1146        1168        1146            0            0\n10        Quite effectiv    REGULAR         Mid Atlantic     1129        1224        1151            0            0\n11  Important issues liv    REGULAR           California     1158        1222        1180            0            0\n12      National, comple    EXPRESS      North Midwest_1     1548        1655        1595            0            0\n13   Conventional childr    EXPRESS        Hawaii/Alaska     1543        1490        1577            0            0\n14  Important issues liv  OVERNIGHT           NY Metro_1     1153        1284        1172            0            0\n15           Rooms cook     TWO DAY      North Midwest_1     1160        1183        1258            0            0\n16      National, comple    TWO DAY       Mid Atlantic_1     1129        1148        1127            0            0\n17           Rooms cook     LIBRARY  Pacific Northwest_1     1180        1190        1265            0            0\n18        Quite effectiv   NEXT DAY  Pacific Northwest_1     1550        1664        1642            0            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018084,
                    "execution_time": 0.007299,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004327
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018561,
                    "execution_time": 0.007462,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004508
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\"",
                "rewrite": "SELECT \"_COL_0\" AS \"_COL_0\", \"SM_TYPE\" AS \"SM_TYPE\", \"CC_NAME\" AS \"CC_NAME\", \"30 DAYS\" AS \"30 DAYS\", \"31-60 DAYS\" AS \"31-60 DAYS\", \"61-90 DAYS\" AS \"61-90 DAYS\", \"91-120 DAYS\" AS \"91-120 DAYS\", \" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*                  _col_0    sm_type              cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0   Important issues liv    TWO DAY         Mid Atlantic     1152        1155        1229            0            0\n1            Rooms cook     LIBRARY         Mid Atlantic     1098        1226        1228            0            0\n2   Local, mass universi    TWO DAY         Mid Atlantic     1159        1221        1232            0            0\n3       National, comple    LIBRARY        Hawaii/Alaska     1194        1193        1190            0            0\n4       Plain, reluctant    REGULAR             NY Metro     1168        1197        1131            0            0\n5   Important issues liv  OVERNIGHT         Mid Atlantic     1114        1199        1176            0            0\n6            Doors canno    REGULAR    Pacific Northwest     1171        1242        1183            0            0\n7                           REGULAR      Hawaii/Alaska_1     1167        1170        1196            0            0\n8       National, comple  OVERNIGHT         Mid Atlantic     1153        1209        1188            0            0\n9   Important issues liv    LIBRARY      North Midwest_1     1146        1168        1146            0            0\n10        Quite effectiv    REGULAR         Mid Atlantic     1129        1224        1151            0            0\n11  Important issues liv    REGULAR           California     1158        1222        1180            0            0\n12      National, comple    EXPRESS      North Midwest_1     1548        1655        1595            0            0\n13   Conventional childr    EXPRESS        Hawaii/Alaska     1543        1490        1577            0            0\n14  Important issues liv  OVERNIGHT           NY Metro_1     1153        1284        1172            0            0\n15           Rooms cook     TWO DAY      North Midwest_1     1160        1183        1258            0            0\n16      National, comple    TWO DAY       Mid Atlantic_1     1129        1148        1127            0            0\n17           Rooms cook     LIBRARY  Pacific Northwest_1     1180        1190        1265            0            0\n18        Quite effectiv   NEXT DAY  Pacific Northwest_1     1550        1664        1642            0            0\n...*/"
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\norder by substring(w_warehouse_name,1,20)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" ORDER BY \"_COL_0\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_5\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ORDER BY \"_COL_0\" LIMIT 21",
                "preview": "\n/*   _col_0    sm_type              cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0            LIBRARY    Pacific Northwest     1168        1196        1184            0            0\n1            LIBRARY  Pacific Northwest_1     1227        1172        1231            0            0\n2            TWO DAY       Mid Atlantic_1     1148        1208        1203            0            0\n3            EXPRESS      North Midwest_1     1618        1640        1600            0            0\n4          OVERNIGHT         California_1     1165        1120        1169            0            0\n5            TWO DAY           California     1070        1176        1172            0            0\n6            REGULAR         California_1     1210        1246        1194            0            0\n7           NEXT DAY           NY Metro_1     1565        1628        1594            0            0\n8          OVERNIGHT           California     1181        1145        1177            0            0\n9          OVERNIGHT      North Midwest_1     1170        1244        1192            0            0\n10           TWO DAY      Hawaii/Alaska_1     1133        1226        1224            0            0\n11           LIBRARY        North Midwest     1179        1244        1187            0            0\n12           REGULAR           California     1106        1254        1172            0            0\n13           EXPRESS        Hawaii/Alaska     1507        1534        1568            0            0\n14           EXPRESS        North Midwest     1531        1565        1601            0            0\n15           REGULAR    Pacific Northwest     1203        1253        1201            0            0\n16           REGULAR      Hawaii/Alaska_1     1167        1170        1196            0            0\n17           TWO DAY    Pacific Northwest     1170        1164        1208            0            0\n18           LIBRARY           California     1212        1196        1160            0            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019042,
                    "execution_time": 0.008055,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.004498
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056578,
                    "execution_time": 0.008228,
                    "compile_time": 8.3e-05,
                    "planning_time": 0.040051
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" ORDER BY \"_COL_0\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_5\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ORDER BY \"_COL_0\" NULLS LAST"
            }
        ],
        "preview": "\n/*   _col_0    sm_type              cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0            LIBRARY    Pacific Northwest     1168        1196        1184            0            0\n1            LIBRARY  Pacific Northwest_1     1227        1172        1231            0            0\n2            TWO DAY       Mid Atlantic_1     1148        1208        1203            0            0\n3            EXPRESS      North Midwest_1     1618        1640        1600            0            0\n4          OVERNIGHT         California_1     1165        1120        1169            0            0\n5            TWO DAY           California     1070        1176        1172            0            0\n6            REGULAR         California_1     1210        1246        1194            0            0\n7           NEXT DAY           NY Metro_1     1565        1628        1594            0            0\n8          OVERNIGHT           California     1181        1145        1177            0            0\n9          OVERNIGHT      North Midwest_1     1170        1244        1192            0            0\n10           TWO DAY      Hawaii/Alaska_1     1133        1226        1224            0            0\n11           LIBRARY        North Midwest     1179        1244        1187            0            0\n12           REGULAR           California     1106        1254        1172            0            0\n13           EXPRESS        Hawaii/Alaska     1507        1534        1568            0            0\n14           EXPRESS        North Midwest     1531        1565        1601            0            0\n15           REGULAR    Pacific Northwest     1203        1253        1201            0            0\n16           REGULAR      Hawaii/Alaska_1     1167        1170        1196            0            0\n17           TWO DAY    Pacific Northwest     1170        1164        1208            0            0\n18           LIBRARY           California     1212        1196        1160            0            0\n...*/"
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\norder by substring(w_warehouse_name,1,20)\n        ,sm_type\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_5\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ORDER BY \"_COL_0\" , \"SM_TYPE\" LIMIT 21",
                "preview": "\n/*   _col_0  sm_type              cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          EXPRESS        North Midwest     1531        1565        1601            0            0\n1          EXPRESS      North Midwest_1     1618        1640        1600            0            0\n2          EXPRESS       Mid Atlantic_1     1507        1555        1515            0            0\n3          EXPRESS           California     1559        1518        1560            0            0\n4          EXPRESS        Hawaii/Alaska     1507        1534        1568            0            0\n5          EXPRESS           NY Metro_1     1528        1611        1621            0            0\n6          EXPRESS  Pacific Northwest_1     1505        1639        1537            0            0\n7          EXPRESS             NY Metro     1527        1591        1563            0            0\n8          EXPRESS         Mid Atlantic     1546        1628        1546            0            0\n9          EXPRESS         California_1     1552        1617        1574            0            0\n10         EXPRESS    Pacific Northwest     1555        1563        1562            0            0\n11         EXPRESS      Hawaii/Alaska_1     1634        1650        1585            0            0\n12         LIBRARY    Pacific Northwest     1168        1196        1184            0            0\n13         LIBRARY             NY Metro     1114        1219        1209            0            0\n14         LIBRARY        North Midwest     1179        1244        1187            0            0\n15         LIBRARY           NY Metro_1     1249        1262        1192            0            0\n16         LIBRARY  Pacific Northwest_1     1227        1172        1231            0            0\n17         LIBRARY       Mid Atlantic_1     1149        1137        1198            0            0\n18         LIBRARY        Hawaii/Alaska     1192        1242        1186            0            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019165,
                    "execution_time": 0.008059,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.004629
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054944,
                    "execution_time": 0.008158,
                    "compile_time": 8.2e-05,
                    "planning_time": 0.040146
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" ORDER BY \"_COL_0\" NULLS LAST, \"SM_TYPE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_5\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST"
            }
        ],
        "preview": "\n/*   _col_0  sm_type              cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          EXPRESS        North Midwest     1531        1565        1601            0            0\n1          EXPRESS      North Midwest_1     1618        1640        1600            0            0\n2          EXPRESS       Mid Atlantic_1     1507        1555        1515            0            0\n3          EXPRESS           California     1559        1518        1560            0            0\n4          EXPRESS        Hawaii/Alaska     1507        1534        1568            0            0\n5          EXPRESS           NY Metro_1     1528        1611        1621            0            0\n6          EXPRESS  Pacific Northwest_1     1505        1639        1537            0            0\n7          EXPRESS             NY Metro     1527        1591        1563            0            0\n8          EXPRESS         Mid Atlantic     1546        1628        1546            0            0\n9          EXPRESS         California_1     1552        1617        1574            0            0\n10         EXPRESS    Pacific Northwest     1555        1563        1562            0            0\n11         EXPRESS      Hawaii/Alaska_1     1634        1650        1585            0            0\n12         LIBRARY    Pacific Northwest     1168        1196        1184            0            0\n13         LIBRARY             NY Metro     1114        1219        1209            0            0\n14         LIBRARY        North Midwest     1179        1244        1187            0            0\n15         LIBRARY           NY Metro_1     1249        1262        1192            0            0\n16         LIBRARY  Pacific Northwest_1     1227        1172        1231            0            0\n17         LIBRARY       Mid Atlantic_1     1149        1137        1198            0            0\n18         LIBRARY        Hawaii/Alaska     1192        1242        1186            0            0\n...*/"
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\norder by substring(w_warehouse_name,1,20)\n        ,sm_type\n        ,cc_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST , \"CC_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_5\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ORDER BY \"_COL_0\" , \"SM_TYPE\" , \"CC_NAME\" LIMIT 21",
                "preview": "\n/*   _col_0  sm_type              cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          EXPRESS           California     1559        1518        1560            0            0\n1          EXPRESS         California_1     1552        1617        1574            0            0\n2          EXPRESS        Hawaii/Alaska     1507        1534        1568            0            0\n3          EXPRESS      Hawaii/Alaska_1     1634        1650        1585            0            0\n4          EXPRESS         Mid Atlantic     1546        1628        1546            0            0\n5          EXPRESS       Mid Atlantic_1     1507        1555        1515            0            0\n6          EXPRESS             NY Metro     1527        1591        1563            0            0\n7          EXPRESS           NY Metro_1     1528        1611        1621            0            0\n8          EXPRESS        North Midwest     1531        1565        1601            0            0\n9          EXPRESS      North Midwest_1     1618        1640        1600            0            0\n10         EXPRESS    Pacific Northwest     1555        1563        1562            0            0\n11         EXPRESS  Pacific Northwest_1     1505        1639        1537            0            0\n12         LIBRARY           California     1212        1196        1160            0            0\n13         LIBRARY         California_1     1192        1198        1137            0            0\n14         LIBRARY        Hawaii/Alaska     1192        1242        1186            0            0\n15         LIBRARY      Hawaii/Alaska_1     1246        1269        1216            0            0\n16         LIBRARY         Mid Atlantic     1162        1208        1184            0            0\n17         LIBRARY       Mid Atlantic_1     1149        1137        1198            0            0\n18         LIBRARY             NY Metro     1114        1219        1209            0            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019211,
                    "execution_time": 0.008048,
                    "compile_time": 7.8e-05,
                    "planning_time": 0.004626
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055402,
                    "execution_time": 0.008761,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.04006
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" ORDER BY \"_COL_0\" NULLS LAST, \"SM_TYPE\" NULLS LAST, \"CC_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_5\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST , \"CC_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*   _col_0  sm_type              cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          EXPRESS           California     1559        1518        1560            0            0\n1          EXPRESS         California_1     1552        1617        1574            0            0\n2          EXPRESS        Hawaii/Alaska     1507        1534        1568            0            0\n3          EXPRESS      Hawaii/Alaska_1     1634        1650        1585            0            0\n4          EXPRESS         Mid Atlantic     1546        1628        1546            0            0\n5          EXPRESS       Mid Atlantic_1     1507        1555        1515            0            0\n6          EXPRESS             NY Metro     1527        1591        1563            0            0\n7          EXPRESS           NY Metro_1     1528        1611        1621            0            0\n8          EXPRESS        North Midwest     1531        1565        1601            0            0\n9          EXPRESS      North Midwest_1     1618        1640        1600            0            0\n10         EXPRESS    Pacific Northwest     1555        1563        1562            0            0\n11         EXPRESS  Pacific Northwest_1     1505        1639        1537            0            0\n12         LIBRARY           California     1212        1196        1160            0            0\n13         LIBRARY         California_1     1192        1198        1137            0            0\n14         LIBRARY        Hawaii/Alaska     1192        1242        1186            0            0\n15         LIBRARY      Hawaii/Alaska_1     1246        1269        1216            0            0\n16         LIBRARY         Mid Atlantic     1162        1208        1184            0            0\n17         LIBRARY       Mid Atlantic_1     1149        1137        1198            0            0\n18         LIBRARY             NY Metro     1114        1219        1209            0            0\n...*/"
    },
    {
        "input": "-- start template query99.tpl query 94 in stream 0\nselect /* TPC-DS query99.tpl 0.94 */  \n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk <= 30 ) then 1 else 0 end)  as \"30 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 30) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 60) then 1 else 0 end )  as \"31-60 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 60) and \n                 (cs_ship_date_sk - cs_sold_date_sk <= 90) then 1 else 0 end)  as \"61-90 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk > 90) and\n                 (cs_ship_date_sk - cs_sold_date_sk <= 120) then 1 else 0 end)  as \"91-120 days\" \n  ,sum(case when (cs_ship_date_sk - cs_sold_date_sk  > 120) then 1 else 0 end)  as \">120 days\" \nfrom\n   catalog_sales\n  ,warehouse\n  ,ship_mode\n  ,call_center\n  ,date_dim\nwhere\n    d_month_seq between 1206 and 1206 + 11\nand cs_ship_date_sk   = d_date_sk\nand cs_warehouse_sk   = w_warehouse_sk\nand cs_ship_mode_sk   = sm_ship_mode_sk\nand cs_call_center_sk = cc_call_center_sk\ngroup by\n   substring(w_warehouse_name,1,20)\n  ,sm_type\n  ,cc_name\norder by substring(w_warehouse_name,1,20)\n        ,sm_type\n        ,cc_name\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) AS \"_COL_0\" , \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END ) AS \"30 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END ) AS \"31-60 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END ) AS \"61-90 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END ) AS \"91-120 DAYS\" , SUM ( CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END ) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING ( \"WAREHOUSE\".\"W_WAREHOUSE_NAME\" , 1 , 20 ) , \"SHIP_MODE\".\"SM_TYPE\" , \"CALL_CENTER\".\"CC_NAME\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST , \"CC_NAME\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_5\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ORDER BY \"_COL_0\" , \"SM_TYPE\" , \"CC_NAME\" LIMIT 21",
                "preview": "\n/*   _col_0  sm_type              cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          EXPRESS           California     1559        1518        1560            0            0\n1          EXPRESS         California_1     1552        1617        1574            0            0\n2          EXPRESS        Hawaii/Alaska     1507        1534        1568            0            0\n3          EXPRESS      Hawaii/Alaska_1     1634        1650        1585            0            0\n4          EXPRESS         Mid Atlantic     1546        1628        1546            0            0\n5          EXPRESS       Mid Atlantic_1     1507        1555        1515            0            0\n6          EXPRESS             NY Metro     1527        1591        1563            0            0\n7          EXPRESS           NY Metro_1     1528        1611        1621            0            0\n8          EXPRESS        North Midwest     1531        1565        1601            0            0\n9          EXPRESS      North Midwest_1     1618        1640        1600            0            0\n10         EXPRESS    Pacific Northwest     1555        1563        1562            0            0\n11         EXPRESS  Pacific Northwest_1     1505        1639        1537            0            0\n12         LIBRARY           California     1212        1196        1160            0            0\n13         LIBRARY         California_1     1192        1198        1137            0            0\n14         LIBRARY        Hawaii/Alaska     1192        1242        1186            0            0\n15         LIBRARY      Hawaii/Alaska_1     1246        1269        1216            0            0\n16         LIBRARY         Mid Atlantic     1162        1208        1184            0            0\n17         LIBRARY       Mid Atlantic_1     1149        1137        1198            0            0\n18         LIBRARY             NY Metro     1114        1219        1209            0            0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019913,
                    "execution_time": 0.008848,
                    "compile_time": 7.7e-05,
                    "planning_time": 0.004618
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019587,
                    "execution_time": 0.008182,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.004848
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20) AS \"_COL_0\", \"SHIP_MODE\".\"SM_TYPE\" AS \"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" AS \"CC_NAME\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 30 THEN 1 ELSE 0 END) AS \"30 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 60 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 30 THEN 1 ELSE 0 END) AS \"31-60 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 90 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 60 THEN 1 ELSE 0 END) AS \"61-90 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" <= 120 AND \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 90 THEN 1 ELSE 0 END) AS \"91-120 DAYS\", SUM(CASE WHEN \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" - \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" > 120 THEN 1 ELSE 0 END) AS \" > 120 DAYS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CALL_CENTER\" AS \"CALL_CENTER\" ON \"CALL_CENTER\".\"CC_CALL_CENTER_SK\" = \"CATALOG_SALES\".\"CS_CALL_CENTER_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SHIP_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1217 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1206 JOIN \"SHIP_MODE\" AS \"SHIP_MODE\" ON \"CATALOG_SALES\".\"CS_SHIP_MODE_SK\" = \"SHIP_MODE\".\"SM_SHIP_MODE_SK\" JOIN \"WAREHOUSE\" AS \"WAREHOUSE\" ON \"CATALOG_SALES\".\"CS_WAREHOUSE_SK\" = \"WAREHOUSE\".\"W_WAREHOUSE_SK\" GROUP BY SUBSTRING(\"WAREHOUSE\".\"W_WAREHOUSE_NAME\", 1, 20), \"SHIP_MODE\".\"SM_TYPE\", \"CALL_CENTER\".\"CC_NAME\" ORDER BY \"_COL_0\" NULLS LAST, \"SM_TYPE\" NULLS LAST, \"CC_NAME\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" AS \"_COL_0\" , \"SPEQLITE_TEMP_TABLE_5\".\"SM_TYPE\" AS \"SM_TYPE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CC_NAME\" AS \"CC_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"30 DAYS\" AS \"30 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"31-60 DAYS\" AS \"31-60 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"61-90 DAYS\" AS \"61-90 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\"91-120 DAYS\" AS \"91-120 DAYS\" , \"SPEQLITE_TEMP_TABLE_5\".\" > 120 DAYS\" AS \" > 120 DAYS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ORDER BY \"_COL_0\" NULLS LAST , \"SM_TYPE\" NULLS LAST , \"CC_NAME\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   _col_0  sm_type              cc_name  30 days  31-60 days  61-90 days  91-120 days   > 120 days\n0          EXPRESS           California     1559        1518        1560            0            0\n1          EXPRESS         California_1     1552        1617        1574            0            0\n2          EXPRESS        Hawaii/Alaska     1507        1534        1568            0            0\n3          EXPRESS      Hawaii/Alaska_1     1634        1650        1585            0            0\n4          EXPRESS         Mid Atlantic     1546        1628        1546            0            0\n5          EXPRESS       Mid Atlantic_1     1507        1555        1515            0            0\n6          EXPRESS             NY Metro     1527        1591        1563            0            0\n7          EXPRESS           NY Metro_1     1528        1611        1621            0            0\n8          EXPRESS        North Midwest     1531        1565        1601            0            0\n9          EXPRESS      North Midwest_1     1618        1640        1600            0            0\n10         EXPRESS    Pacific Northwest     1555        1563        1562            0            0\n11         EXPRESS  Pacific Northwest_1     1505        1639        1537            0            0\n12         LIBRARY           California     1212        1196        1160            0            0\n13         LIBRARY         California_1     1192        1198        1137            0            0\n14         LIBRARY        Hawaii/Alaska     1192        1242        1186            0            0\n15         LIBRARY      Hawaii/Alaska_1     1246        1269        1216            0            0\n16         LIBRARY         Mid Atlantic     1162        1208        1184            0            0\n17         LIBRARY       Mid Atlantic_1     1149        1137        1198            0            0\n18         LIBRARY             NY Metro     1114        1219        1209            0            0\n...*/"
    }
]