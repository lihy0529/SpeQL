[
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,ss_store_sk as s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) as sumsales\n            from store_sales, date_dim, store, item\n       where ss_sold_date_sk = d_date_sk\n          and ss_item_sk = i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, ss_store_sk)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null as i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null as i_class, null as i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category\n  union all\n  select null as i_category, null as i_class, null as i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results)\n\nselect  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n     from results_rollup) as final_results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE_SALES\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.124659,
                    "execution_time": 1.418902,
                    "compile_time": 0.000748,
                    "planning_time": 0.054753,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.225313,
                    "execution_time": 1.434483,
                    "compile_time": 0.000748,
                    "planning_time": 0.133663,
                    "create_size": 1536
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_QOY\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_MOY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_QOY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_1\".\"D_YEAR\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_BRAND\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_1\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.865726,
                    "execution_time": 2.177155,
                    "compile_time": 0.001341,
                    "planning_time": 0.039408,
                    "create_size": 1664
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.877152,
                    "execution_time": 2.135661,
                    "compile_time": 0.01912,
                    "planning_time": 0.08487,
                    "create_size": 1664
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*   i_category          i_class               i_brand            i_product_name  d_year  d_qoy  d_moy  s_store_id  sumsales\n0        Home  curtains/drapes      edu packbrand #4       prieseeingationeing    2001      4     10          32   7236.75\n1       Books   entertainments      edu packmaxi #12  antiationationationcally    2001      4     10          32   5860.84\n2       Women       fragrances       importoamalg #2       ationcallypripripri    2001      4     10           2    390.60\n3        Home           accent      amalgnameless #4       prin steingpriought    2001      4     10           2    194.50\n4      Sports          outdoor   namelessnameless #2      oughteseeingn steing    2001      4     10          61   5813.85\n5       Music             rock       amalgscholar #2    ationationbareingcally    2001      4     10          91    461.76\n6       Women        maternity       exportiamalg #2   ationoughtcallycallyese    2001      4     10           7   3445.07\n7       Music             rock       amalgscholar #2       pricallybaresecally    2001      4     10           8   1384.00\n8       Books          history       scholarmaxi #10      n stbarn stoughtable    2001      4     10           8   3832.01\n9      Sports       basketball   exportinameless #10     n stcallybarableation    2001      4     10          61     10.78\n10   Children          newborn       amalgexporti #2      antiableationbaranti    2001      4     10          61    562.08\n11      Shoes         athletic   edu packedu pack #2       priationesebarought    2001      4     10          76   1672.40\n12   Children         toddlers     exportiexporti #2  oughtoughtationeingought    2001      4     10           7    980.05\n13       Home        glassware   edu packnameless #8        ationbarbaresen st    2001      4     10          80    978.56\n14      Shoes             kids    exportiedu pack #2    oughtablecallyableanti    2001      4     10          80    365.00\n15      Shoes           womens      amalgedu pack #2         oughtn stationese    2001      4     10          40    423.68\n16      Books          fiction  scholarunivamalg #10           n stbarn stn st    2001      4     10          40   1897.16\n17    Jewelry     loose stones       exportibrand #4       n stn stableprianti    2001      4     10          40   2078.72\n18    Jewelry             gold        exporticorp #4       n stoughtbareseeing    2001      4     10          40    783.51\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018803,
                    "execution_time": 0.007735,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004467
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05944,
                    "execution_time": 0.008475,
                    "compile_time": 0.001139,
                    "planning_time": 0.039988
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*   i_category          i_class               i_brand            i_product_name  d_year  d_qoy  d_moy  s_store_id  sumsales\n0        Home  curtains/drapes      edu packbrand #4       prieseeingationeing    2001      4     10          32   7236.75\n1       Books   entertainments      edu packmaxi #12  antiationationationcally    2001      4     10          32   5860.84\n2       Women       fragrances       importoamalg #2       ationcallypripripri    2001      4     10           2    390.60\n3        Home           accent      amalgnameless #4       prin steingpriought    2001      4     10           2    194.50\n4      Sports          outdoor   namelessnameless #2      oughteseeingn steing    2001      4     10          61   5813.85\n5       Music             rock       amalgscholar #2    ationationbareingcally    2001      4     10          91    461.76\n6       Women        maternity       exportiamalg #2   ationoughtcallycallyese    2001      4     10           7   3445.07\n7       Music             rock       amalgscholar #2       pricallybaresecally    2001      4     10           8   1384.00\n8       Books          history       scholarmaxi #10      n stbarn stoughtable    2001      4     10           8   3832.01\n9      Sports       basketball   exportinameless #10     n stcallybarableation    2001      4     10          61     10.78\n10   Children          newborn       amalgexporti #2      antiableationbaranti    2001      4     10          61    562.08\n11      Shoes         athletic   edu packedu pack #2       priationesebarought    2001      4     10          76   1672.40\n12   Children         toddlers     exportiexporti #2  oughtoughtationeingought    2001      4     10           7    980.05\n13       Home        glassware   edu packnameless #8        ationbarbaresen st    2001      4     10          80    978.56\n14      Shoes             kids    exportiedu pack #2    oughtablecallyableanti    2001      4     10          80    365.00\n15      Shoes           womens      amalgedu pack #2         oughtn stationese    2001      4     10          40    423.68\n16      Books          fiction  scholarunivamalg #10           n stbarn stn st    2001      4     10          40   1897.16\n17    Jewelry     loose stones       exportibrand #4       n stn stableprianti    2001      4     10          40   2078.72\n18    Jewelry             gold        exporticorp #4       n stoughtbareseeing    2001      4     10          40    783.51\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom results_rollup\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.225349,
                    "execution_time": 1.491052,
                    "compile_time": 0.000747,
                    "planning_time": 0.053693,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.293089,
                    "execution_time": 1.46868,
                    "compile_time": 0.001943,
                    "planning_time": 0.131615,
                    "create_size": 1536
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.981219,
                    "execution_time": 2.257524,
                    "compile_time": 0.001326,
                    "planning_time": 0.03933,
                    "create_size": 1664
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.981359,
                    "execution_time": 2.210118,
                    "compile_time": 0.028328,
                    "planning_time": 0.084519,
                    "create_size": 1664
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*     i_category          i_class               i_brand            i_product_name  d_year  d_qoy  d_moy        s_store_id  sumsales\n0        Sports         baseball   importonameless #10    n stationableantically    2001      4     12  AAAAAAAAACAAAAAA   3414.06\n1      Children          infants     importoexporti #2      antibarableeingcally    2001      4     12  AAAAAAAAGFAAAAAA   1314.24\n2   Electronics         personal    brandunivamalg #10     oughteingcallyeseanti    2001      4     12  AAAAAAAAAEAAAAAA   2245.32\n3      Children  school-uniforms    edu packexporti #2    oughtantipriationought    2001      4     12  AAAAAAAADBAAAAAA   2826.38\n4      Children  school-uniforms    edu packexporti #2        anticallybarpripri    2001      4     12  AAAAAAAADBAAAAAA    593.32\n5         Shoes         athletic   edu packedu pack #2      n stn stantieseought    2001      4     12  AAAAAAAADBAAAAAA   2977.76\n6         Books          fiction   scholarunivamalg #6      prin stationeingeing    2001      4     12  AAAAAAAADBAAAAAA    604.83\n7       Jewelry    jewelry boxes          univbrand #4       antiantioughtbarese    2001      4     12  AAAAAAAADBAAAAAA    305.72\n8   Electronics           memory     univamalgamalg #3        antiationn station    2001      4     12  AAAAAAAADBAAAAAA   6154.72\n9          Home         flatware       univnameless #2  oughtableoughtoughtation    2001      4     12  AAAAAAAAHAAAAAAA     51.10\n10      Jewelry     womens watch           maxicorp #6    oughtcallyablepriought    2001      4     12  AAAAAAAAHAAAAAAA   2061.57\n11        Music              pop     exportischolar #2     n stprin stationation    2001      4     12  AAAAAAAAOFAAAAAA    415.90\n12       Sports           tennis       edu packmaxi #2   oughtcallyantieingought    2001      4     12  AAAAAAAAOCAAAAAA   8373.82\n13        Books        computers       exportimaxi #10    ationoughtableablen st    2001      4     12  AAAAAAAAOCAAAAAA   2101.90\n14        Books        computers        exportimaxi #8       antioughteseeseanti    2001      4     12  AAAAAAAAHDAAAAAA   1949.68\n15        Women       fragrances       importoamalg #2    anticallyn stcallyeing    2001      4     12  AAAAAAAAKBAAAAAA      0.00\n16          Men   sports-apparel    edu packimporto #2       prieingprin station    2001      4     12  AAAAAAAAGEAAAAAA   3449.67\n17  Electronics  dvd/vcr players  exportiunivamalg #16        oughtantin stcally    2001      4     12  AAAAAAAAIFAAAAAA   4496.88\n18        Music              pop     exportischolar #2        oughtbarablebarese    2001      4     12  AAAAAAAAJEAAAAAA    461.16\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018464,
                    "execution_time": 0.007623,
                    "compile_time": 5e-05,
                    "planning_time": 0.004355
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057664,
                    "execution_time": 0.008443,
                    "compile_time": 0.001151,
                    "planning_time": 0.039679
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*     i_category          i_class               i_brand            i_product_name  d_year  d_qoy  d_moy        s_store_id  sumsales\n0        Sports         baseball   importonameless #10    n stationableantically    2001      4     12  AAAAAAAAACAAAAAA   3414.06\n1      Children          infants     importoexporti #2      antibarableeingcally    2001      4     12  AAAAAAAAGFAAAAAA   1314.24\n2   Electronics         personal    brandunivamalg #10     oughteingcallyeseanti    2001      4     12  AAAAAAAAAEAAAAAA   2245.32\n3      Children  school-uniforms    edu packexporti #2    oughtantipriationought    2001      4     12  AAAAAAAADBAAAAAA   2826.38\n4      Children  school-uniforms    edu packexporti #2        anticallybarpripri    2001      4     12  AAAAAAAADBAAAAAA    593.32\n5         Shoes         athletic   edu packedu pack #2      n stn stantieseought    2001      4     12  AAAAAAAADBAAAAAA   2977.76\n6         Books          fiction   scholarunivamalg #6      prin stationeingeing    2001      4     12  AAAAAAAADBAAAAAA    604.83\n7       Jewelry    jewelry boxes          univbrand #4       antiantioughtbarese    2001      4     12  AAAAAAAADBAAAAAA    305.72\n8   Electronics           memory     univamalgamalg #3        antiationn station    2001      4     12  AAAAAAAADBAAAAAA   6154.72\n9          Home         flatware       univnameless #2  oughtableoughtoughtation    2001      4     12  AAAAAAAAHAAAAAAA     51.10\n10      Jewelry     womens watch           maxicorp #6    oughtcallyablepriought    2001      4     12  AAAAAAAAHAAAAAAA   2061.57\n11        Music              pop     exportischolar #2     n stprin stationation    2001      4     12  AAAAAAAAOFAAAAAA    415.90\n12       Sports           tennis       edu packmaxi #2   oughtcallyantieingought    2001      4     12  AAAAAAAAOCAAAAAA   8373.82\n13        Books        computers       exportimaxi #10    ationoughtableablen st    2001      4     12  AAAAAAAAOCAAAAAA   2101.90\n14        Books        computers        exportimaxi #8       antioughteseeseanti    2001      4     12  AAAAAAAAHDAAAAAA   1949.68\n15        Women       fragrances       importoamalg #2    anticallyn stcallyeing    2001      4     12  AAAAAAAAKBAAAAAA      0.00\n16          Men   sports-apparel    edu packimporto #2       prieingprin station    2001      4     12  AAAAAAAAGEAAAAAA   3449.67\n17  Electronics  dvd/vcr players  exportiunivamalg #16        oughtantin stcally    2001      4     12  AAAAAAAAIFAAAAAA   4496.88\n18        Music              pop     exportischolar #2        oughtbarablebarese    2001      4     12  AAAAAAAAJEAAAAAA    461.16\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,SS_STORE_SK as s_store_id\n                  ,sum(coalesce(SS_SALES_PRICE*SS_QUANTITY,0)) as sumsales\n            from store_sales ,date_dim ,store ,item\n       where  SS_SOLD_DATE_SK=d_date_sk\n          and SS_ITEM_SK=i_item_sk\n          and SS_STORE_SK = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, SS_STORE_SK)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null as i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null as i_class, null as i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results\n  group by i_category\n  union all\n  select null as i_category, null as i_class, null as i_brand, null as i_product_name, null as d_year, null as d_qoy, null as d_moy, null as s_store_id, sum(sumsales) as sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n        from results_rollup) subquery\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE_SALES\".\"SS_STORE_SK\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*     i_category          i_class                i_brand          i_product_name  d_year  d_qoy  d_moy  s_store_id  sumsales\n0          Home           accent       amalgnameless #2  oughtcallybareingought    2002      2      4          62    107.30\n1         Books          mystery       corpunivamalg #8    ationbarcallyantiese    2002      2      4          62    589.23\n2         Books          mystery       corpunivamalg #7    callyeseeingcallypri    2002      2      4          62   3417.66\n3           Men      accessories        amalgimporto #2   n steingcallyeinganti    2002      2      4          62    887.60\n4         Music             rock        amalgscholar #2     n steseantiableable    2002      2      4          43    126.27\n5          Home  curtains/drapes      edu packbrand #10        n stbarationable    2002      2      4          74     16.18\n6         Music        classical     edu packscholar #1      barableantiantipri    2002      2      4          74   3881.64\n7       Jewelry        bracelets        edu packcorp #3   ablebarableationought    2002      2      4          37   4755.51\n8          Home        glassware    edu packnameless #7   callyeseableantiought    2002      2      4          43   1459.80\n9   Electronics          musical      corpunivamalg #14  oughteingeseoughtation    2002      2      4          43   3837.03\n10        Music          country      importoscholar #2     n stn stpriableanti    2002      2      4          43   4745.79\n11        Books           sports  edu packunivamalg #10   anticallyn stableeing    2002      2      4          26   1550.34\n12  Electronics         portable   scholaramalgamalg #5  bareingationcallycally    2002      2      4          26    175.84\n13         Home            decor          brandbrand #6        antiationeseable    2002      2      4          26   1756.80\n14     Children  school-uniforms     edu packexporti #1    eingn stationn stpri    2002      2      4          56    319.80\n15      Jewelry     womens watch            maxicorp #2      antiableeseantipri    2002      2      4          80    583.96\n16          Men      accessories        amalgimporto #2     antipribarcallyanti    2002      2      4          80   1839.60\n17         Home           accent       amalgnameless #4    priantiableableought    2002      2      4          80   2436.10\n18          Men            pants      exportiimporto #1   baroughtbarationought    2002      2      4          13   2169.20\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018472,
                    "execution_time": 0.007592,
                    "compile_time": 5e-05,
                    "planning_time": 0.004406
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019929,
                    "execution_time": 0.00857,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.004591
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*     i_category          i_class                i_brand          i_product_name  d_year  d_qoy  d_moy  s_store_id  sumsales\n0          Home           accent       amalgnameless #2  oughtcallybareingought    2002      2      4          62    107.30\n1         Books          mystery       corpunivamalg #8    ationbarcallyantiese    2002      2      4          62    589.23\n2         Books          mystery       corpunivamalg #7    callyeseeingcallypri    2002      2      4          62   3417.66\n3           Men      accessories        amalgimporto #2   n steingcallyeinganti    2002      2      4          62    887.60\n4         Music             rock        amalgscholar #2     n steseantiableable    2002      2      4          43    126.27\n5          Home  curtains/drapes      edu packbrand #10        n stbarationable    2002      2      4          74     16.18\n6         Music        classical     edu packscholar #1      barableantiantipri    2002      2      4          74   3881.64\n7       Jewelry        bracelets        edu packcorp #3   ablebarableationought    2002      2      4          37   4755.51\n8          Home        glassware    edu packnameless #7   callyeseableantiought    2002      2      4          43   1459.80\n9   Electronics          musical      corpunivamalg #14  oughteingeseoughtation    2002      2      4          43   3837.03\n10        Music          country      importoscholar #2     n stn stpriableanti    2002      2      4          43   4745.79\n11        Books           sports  edu packunivamalg #10   anticallyn stableeing    2002      2      4          26   1550.34\n12  Electronics         portable   scholaramalgamalg #5  bareingationcallycally    2002      2      4          26    175.84\n13         Home            decor          brandbrand #6        antiationeseable    2002      2      4          26   1756.80\n14     Children  school-uniforms     edu packexporti #1    eingn stationn stpri    2002      2      4          56    319.80\n15      Jewelry     womens watch            maxicorp #2      antiableeseantipri    2002      2      4          80    583.96\n16          Men      accessories        amalgimporto #2     antipribarcallyanti    2002      2      4          80   1839.60\n17         Home           accent       amalgnameless #4    priantiableableought    2002      2      4          80   2436.10\n18          Men            pants      exportiimporto #1   baroughtbarationought    2002      2      4          13   2169.20\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n/*CURSOR_IDENTIFIER*/, s_store_id, sumsales\n        from results_rollup) subquery",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_MOY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_QOY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.818989,
                    "execution_time": 2.065988,
                    "compile_time": 0.07296,
                    "planning_time": 0.037553,
                    "create_size": 1536
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.297866,
                    "execution_time": 2.279881,
                    "compile_time": 3.294072,
                    "planning_time": 0.082783,
                    "create_size": 1536
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*     i_category          i_class              i_brand            i_product_name  d_year  d_qoy        s_store_id  sumsales\n0      Children         toddlers    exportiexporti #2     ationcallyablebarn st    2001      3  AAAAAAAAGFAAAAAA   5580.40\n1   Electronics      televisions     maxiunivamalg #4   oughtationcallyesecally    2001      3  AAAAAAAADBAAAAAA   4003.20\n2         Shoes             mens   importoedu pack #2    ationeingablecallyable    2001      3  AAAAAAAAHAAAAAAA   1533.51\n3         Shoes             mens   importoedu pack #2    oughtablecallycallypri    2001      3  AAAAAAAAEGAAAAAA   4089.46\n4       Jewelry        bracelets      edu packcorp #8               antiprin st    2001      3  AAAAAAAAEGAAAAAA   6330.24\n5         Books      home repair  importounivamalg #4      pribarantioughtcally    2001      3  AAAAAAAAEGAAAAAA   1251.20\n6        Sports           hockey     brandnameless #6       antiableantieseeing    2001      3  AAAAAAAAEGAAAAAA   8336.52\n7         Books        computers       exportimaxi #8     antiationeseoughtable    2001      3  AAAAAAAACGAAAAAA     42.24\n8         Shoes         athletic  edu packedu pack #2     oughtn stbareingation    2001      3  AAAAAAAAMBAAAAAA   3321.75\n9         Books          science         maximaxi #10  ationantioughtoughtation    2001      3  AAAAAAAAMBAAAAAA    273.84\n10     Children  school-uniforms   edu packexporti #2     oughtpriantiableation    2001      3  AAAAAAAAMFAAAAAA   2712.39\n11          Men           shirts    importoimporto #2       n stbareingationpri    2001      3  AAAAAAAAEBAAAAAA    450.24\n12         Home           accent    amalgnameless #10    n stationpriationought    2001      3  AAAAAAAAJBAAAAAA   9977.16\n13     Children         toddlers    exportiexporti #2   oughtableationcallyeing    2001      3  AAAAAAAADBAAAAAA   3498.79\n14      Jewelry         pendants         brandcorp #8      antianticallyeseeing    2001      3  AAAAAAAADBAAAAAA    632.40\n15        Women        maternity      exportiamalg #2      ationbareseantiation    2001      3  AAAAAAAADBAAAAAA    290.10\n16         Home           accent    amalgnameless #10     n stationcallyesen st    2001      3  AAAAAAAALFAAAAAA   7015.41\n17         Home           accent     amalgnameless #8      ationantieingbarable    2001      3  AAAAAAAALFAAAAAA   9942.80\n18        Shoes           womens     amalgedu pack #2      ationn stbarantin st    2001      3  AAAAAAAAMFAAAAAA    441.30\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.086535,
                    "execution_time": 0.008224,
                    "compile_time": 0.06786,
                    "planning_time": 0.003991
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.20712,
                    "execution_time": 0.008274,
                    "compile_time": 3.147728,
                    "planning_time": 0.039661
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_5\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*     i_category          i_class              i_brand            i_product_name  d_year  d_qoy        s_store_id  sumsales\n0      Children         toddlers    exportiexporti #2     ationcallyablebarn st    2001      3  AAAAAAAAGFAAAAAA   5580.40\n1   Electronics      televisions     maxiunivamalg #4   oughtationcallyesecally    2001      3  AAAAAAAADBAAAAAA   4003.20\n2         Shoes             mens   importoedu pack #2    ationeingablecallyable    2001      3  AAAAAAAAHAAAAAAA   1533.51\n3         Shoes             mens   importoedu pack #2    oughtablecallycallypri    2001      3  AAAAAAAAEGAAAAAA   4089.46\n4       Jewelry        bracelets      edu packcorp #8               antiprin st    2001      3  AAAAAAAAEGAAAAAA   6330.24\n5         Books      home repair  importounivamalg #4      pribarantioughtcally    2001      3  AAAAAAAAEGAAAAAA   1251.20\n6        Sports           hockey     brandnameless #6       antiableantieseeing    2001      3  AAAAAAAAEGAAAAAA   8336.52\n7         Books        computers       exportimaxi #8     antiationeseoughtable    2001      3  AAAAAAAACGAAAAAA     42.24\n8         Shoes         athletic  edu packedu pack #2     oughtn stbareingation    2001      3  AAAAAAAAMBAAAAAA   3321.75\n9         Books          science         maximaxi #10  ationantioughtoughtation    2001      3  AAAAAAAAMBAAAAAA    273.84\n10     Children  school-uniforms   edu packexporti #2     oughtpriantiableation    2001      3  AAAAAAAAMFAAAAAA   2712.39\n11          Men           shirts    importoimporto #2       n stbareingationpri    2001      3  AAAAAAAAEBAAAAAA    450.24\n12         Home           accent    amalgnameless #10    n stationpriationought    2001      3  AAAAAAAAJBAAAAAA   9977.16\n13     Children         toddlers    exportiexporti #2   oughtableationcallyeing    2001      3  AAAAAAAADBAAAAAA   3498.79\n14      Jewelry         pendants         brandcorp #8      antianticallyeseeing    2001      3  AAAAAAAADBAAAAAA    632.40\n15        Women        maternity      exportiamalg #2      ationbareseantiation    2001      3  AAAAAAAADBAAAAAA    290.10\n16         Home           accent    amalgnameless #10     n stationcallyesen st    2001      3  AAAAAAAALFAAAAAA   7015.41\n17         Home           accent     amalgnameless #8      ationantieingbarable    2001      3  AAAAAAAALFAAAAAA   9942.80\n18        Shoes           womens     amalgedu pack #2      ationn stbarantin st    2001      3  AAAAAAAAMFAAAAAA    441.30\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n/*CURSOR_IDENTIFIER*/, s_store_id, sumsales\nfrom results_rollup) subquery",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*     i_category          i_class                i_brand           i_product_name  d_year  d_qoy  d_moy        s_store_id  sumsales\n0   Electronics      disk drives    amalgamalgamalg #13    ationeingeingoughtpri    2001      3      8  AAAAAAAABGAAAAAA    546.93\n1   Electronics         monitors  importoamalgamalg #15    oughtationablebareing    2001      3      8  AAAAAAAABGAAAAAA   1188.22\n2       Jewelry          costume        importobrand #2   ationationpriationable    2001      3      8  AAAAAAAABDAAAAAA   4775.49\n3         Books      home repair   importounivamalg #10      ationantieseantipri    2001      3      8  AAAAAAAAMBAAAAAA   6610.16\n4       Jewelry           custom        scholarbrand #6      n steingprieingeing    2001      3      8  AAAAAAAAKBAAAAAA   3892.50\n5         Shoes             mens     importoedu pack #2     n stn stableableanti    2001      3      8  AAAAAAAACFAAAAAA   5317.24\n6         Books      home repair    importounivamalg #6            antiableation    2001      3      8  AAAAAAAACFAAAAAA   2453.04\n7        Sports           hockey      brandnameless #10       n stprin steingpri    2001      3      8  AAAAAAAAIDAAAAAA      0.00\n8         Women       fragrances        importoamalg #2     prin stoughtableable    2001      3      8  AAAAAAAAIDAAAAAA   1159.02\n9          Home            decor          brandbrand #8   ationanticallycallyese    2001      3      8  AAAAAAAAIDAAAAAA   3260.48\n10        Music        classical     edu packscholar #2      antiprieingesecally    2001      3      8  AAAAAAAANDAAAAAA    799.41\n11          Men      accessories        amalgimporto #2  oughtcallyationantin st    2001      3      8  AAAAAAAANDAAAAAA    450.90\n12       Sports       basketball     exportinameless #8   ationantiationantiable    2001      3      8  AAAAAAAANDAAAAAA   8463.99\n13     Children          newborn        amalgexporti #2         ationbarn stable    2001      3      8  AAAAAAAAGFAAAAAA   1640.18\n14      Jewelry         pendants           brandcorp #8       priableablebarable    2001      3      8  AAAAAAAALFAAAAAA   1183.50\n15        Books           sports  edu packunivamalg #12         ationcallypriese    2001      3      8  AAAAAAAALFAAAAAA   4436.46\n16        Music        classical     edu packscholar #2    oughtableesecallyable    2001      3      8  AAAAAAAALFAAAAAA    369.60\n17     Children         toddlers      exportiexporti #2    n stn stcallypriought    2001      3      8  AAAAAAAALFAAAAAA    538.00\n18  Electronics          cameras      amalgunivamalg #9    ationcallyprin stable    2001      3      8  AAAAAAAAACAAAAAA   1518.10\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019052,
                    "execution_time": 0.008253,
                    "compile_time": 5e-05,
                    "planning_time": 0.004234
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019429,
                    "execution_time": 0.00816,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.004446
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*     i_category          i_class                i_brand           i_product_name  d_year  d_qoy  d_moy        s_store_id  sumsales\n0   Electronics      disk drives    amalgamalgamalg #13    ationeingeingoughtpri    2001      3      8  AAAAAAAABGAAAAAA    546.93\n1   Electronics         monitors  importoamalgamalg #15    oughtationablebareing    2001      3      8  AAAAAAAABGAAAAAA   1188.22\n2       Jewelry          costume        importobrand #2   ationationpriationable    2001      3      8  AAAAAAAABDAAAAAA   4775.49\n3         Books      home repair   importounivamalg #10      ationantieseantipri    2001      3      8  AAAAAAAAMBAAAAAA   6610.16\n4       Jewelry           custom        scholarbrand #6      n steingprieingeing    2001      3      8  AAAAAAAAKBAAAAAA   3892.50\n5         Shoes             mens     importoedu pack #2     n stn stableableanti    2001      3      8  AAAAAAAACFAAAAAA   5317.24\n6         Books      home repair    importounivamalg #6            antiableation    2001      3      8  AAAAAAAACFAAAAAA   2453.04\n7        Sports           hockey      brandnameless #10       n stprin steingpri    2001      3      8  AAAAAAAAIDAAAAAA      0.00\n8         Women       fragrances        importoamalg #2     prin stoughtableable    2001      3      8  AAAAAAAAIDAAAAAA   1159.02\n9          Home            decor          brandbrand #8   ationanticallycallyese    2001      3      8  AAAAAAAAIDAAAAAA   3260.48\n10        Music        classical     edu packscholar #2      antiprieingesecally    2001      3      8  AAAAAAAANDAAAAAA    799.41\n11          Men      accessories        amalgimporto #2  oughtcallyationantin st    2001      3      8  AAAAAAAANDAAAAAA    450.90\n12       Sports       basketball     exportinameless #8   ationantiationantiable    2001      3      8  AAAAAAAANDAAAAAA   8463.99\n13     Children          newborn        amalgexporti #2         ationbarn stable    2001      3      8  AAAAAAAAGFAAAAAA   1640.18\n14      Jewelry         pendants           brandcorp #8       priableablebarable    2001      3      8  AAAAAAAALFAAAAAA   1183.50\n15        Books           sports  edu packunivamalg #12         ationcallypriese    2001      3      8  AAAAAAAALFAAAAAA   4436.46\n16        Music        classical     edu packscholar #2    oughtableesecallyable    2001      3      8  AAAAAAAALFAAAAAA    369.60\n17     Children         toddlers      exportiexporti #2    n stn stcallypriought    2001      3      8  AAAAAAAALFAAAAAA    538.00\n18  Electronics          cameras      amalgunivamalg #9    ationcallyprin stable    2001      3      8  AAAAAAAAACAAAAAA   1518.10\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n/*CURSOR_IDENTIFIER*/, sumsales\nfrom results_rollup) subquery",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*     i_category          i_class               i_brand             i_product_name  d_year  d_qoy  d_moy        s_store_id  sumsales\n0         Books   entertainments       edu packmaxi #2      priationantin stought    2001      4     11  AAAAAAAANDAAAAAA     99.19\n1          Home    blinds/shades       scholarbrand #2      oughteseationbaration    2001      4     11  AAAAAAAANDAAAAAA    110.58\n2           Men            pants     exportiimporto #2  prieingoughtoughtbarought    2001      4     11  AAAAAAAAMCAAAAAA   4271.83\n3        Sports           optics      maxinameless #10       n steingcallyeingpri    2001      4     11  AAAAAAAACDAAAAAA   3922.56\n4      Children          infants     importoexporti #2    anticallyeingcallyation    2001      4     11  AAAAAAAAEDAAAAAA   3267.95\n5        Sports          sailing        exportimaxi #6        antibareingeseought    2001      4     11  AAAAAAAAEDAAAAAA    125.84\n6        Sports            pools           univmaxi #2       oughtableprieingeing    2001      4     11  AAAAAAAAEDAAAAAA   5847.66\n7        Sports             guns        importomaxi #2     oughtableablecallyable    2001      4     11  AAAAAAAAFFAAAAAA   1031.36\n8      Children          newborn       amalgexporti #2      ationationbareseought    2001      4     11  AAAAAAAAFFAAAAAA   6546.19\n9         Shoes             mens    importoedu pack #2          ationeseablecally    2001      4     11  AAAAAAAACAAAAAAA   1746.36\n10     Children  school-uniforms    edu packexporti #2        oughtableprin stese    2001      4     11  AAAAAAAACAAAAAAA    270.75\n11      Jewelry         pendants          brandcorp #8    ationableationantiation    2001      4     11  AAAAAAAACAAAAAAA   4469.25\n12         Home             rugs          corpbrand #2      oughtn stantibaration    2001      4     11  AAAAAAAACAAAAAAA    362.56\n13         Home          bedding      importobrand #10         n steseesebaration    2001      4     11  AAAAAAAABGAAAAAA   2992.20\n14        Books        parenting           corpmaxi #4        pribarationn stable    2001      4     11  AAAAAAAABGAAAAAA    563.76\n15        Women          dresses         amalgamalg #2        antiablepribarought    2001      4     11  AAAAAAAACDAAAAAA   1780.64\n16  Electronics           stereo  exportiamalgamalg #9     oughteseationableought    2001      4     11  AAAAAAAACDAAAAAA   3747.68\n17        Books         business       importomaxi #12         antiationeingcally    2001      4     11  AAAAAAAAKBAAAAAA  14571.34\n18     Children         toddlers     exportiexporti #2       antiantieingeseation    2001      4     11  AAAAAAAAKBAAAAAA   3672.87\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018156,
                    "execution_time": 0.007626,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004131
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.018537,
                    "execution_time": 0.007583,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004265
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*     i_category          i_class               i_brand             i_product_name  d_year  d_qoy  d_moy        s_store_id  sumsales\n0         Books   entertainments       edu packmaxi #2      priationantin stought    2001      4     11  AAAAAAAANDAAAAAA     99.19\n1          Home    blinds/shades       scholarbrand #2      oughteseationbaration    2001      4     11  AAAAAAAANDAAAAAA    110.58\n2           Men            pants     exportiimporto #2  prieingoughtoughtbarought    2001      4     11  AAAAAAAAMCAAAAAA   4271.83\n3        Sports           optics      maxinameless #10       n steingcallyeingpri    2001      4     11  AAAAAAAACDAAAAAA   3922.56\n4      Children          infants     importoexporti #2    anticallyeingcallyation    2001      4     11  AAAAAAAAEDAAAAAA   3267.95\n5        Sports          sailing        exportimaxi #6        antibareingeseought    2001      4     11  AAAAAAAAEDAAAAAA    125.84\n6        Sports            pools           univmaxi #2       oughtableprieingeing    2001      4     11  AAAAAAAAEDAAAAAA   5847.66\n7        Sports             guns        importomaxi #2     oughtableablecallyable    2001      4     11  AAAAAAAAFFAAAAAA   1031.36\n8      Children          newborn       amalgexporti #2      ationationbareseought    2001      4     11  AAAAAAAAFFAAAAAA   6546.19\n9         Shoes             mens    importoedu pack #2          ationeseablecally    2001      4     11  AAAAAAAACAAAAAAA   1746.36\n10     Children  school-uniforms    edu packexporti #2        oughtableprin stese    2001      4     11  AAAAAAAACAAAAAAA    270.75\n11      Jewelry         pendants          brandcorp #8    ationableationantiation    2001      4     11  AAAAAAAACAAAAAAA   4469.25\n12         Home             rugs          corpbrand #2      oughtn stantibaration    2001      4     11  AAAAAAAACAAAAAAA    362.56\n13         Home          bedding      importobrand #10         n steseesebaration    2001      4     11  AAAAAAAABGAAAAAA   2992.20\n14        Books        parenting           corpmaxi #4        pribarationn stable    2001      4     11  AAAAAAAABGAAAAAA    563.76\n15        Women          dresses         amalgamalg #2        antiablepribarought    2001      4     11  AAAAAAAACDAAAAAA   1780.64\n16  Electronics           stereo  exportiamalgamalg #9     oughteseationableought    2001      4     11  AAAAAAAACDAAAAAA   3747.68\n17        Books         business       importomaxi #12         antiationeingcally    2001      4     11  AAAAAAAAKBAAAAAA  14571.34\n18     Children         toddlers     exportiexporti #2       antiantieingeseation    2001      4     11  AAAAAAAAKBAAAAAA   3672.87\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n/*CURSOR_IDENTIFIER*/\nfrom results_rollup) subquery",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*     i_category        i_class               i_brand            i_product_name  d_year  d_qoy  d_moy        s_store_id  sumsales\n0           Men          pants     exportiimporto #2      oughteingesebarcally    2001      4     12  AAAAAAAAKBAAAAAA   3292.10\n1         Music           rock       amalgscholar #2     ationantiprin stcally    2001      4     12  AAAAAAAAKBAAAAAA    667.20\n2      Children        infants     importoexporti #2    antiableeingoughtought    2001      4     12  AAAAAAAAEBAAAAAA    855.27\n3         Music        country     importoscholar #2      antiationeingprieing    2001      4     12  AAAAAAAABDAAAAAA   2449.32\n4          Home          paint    importonameless #8      ationeseableesecally    2001      4     12  AAAAAAAABDAAAAAA   8940.77\n5         Women        dresses         amalgamalg #2    anticallycallyn steing    2001      4     12  AAAAAAAABDAAAAAA   5010.86\n6          Home      furniture       corpnameless #8    ationationantiationpri    2001      4     12  AAAAAAAABDAAAAAA   3091.20\n7      Children        newborn       amalgexporti #2         antibarpriablepri    2001      4     12  AAAAAAAAPBAAAAAA    228.54\n8          Home      wallpaper    exportinameless #6      antioughtn steingese    2001      4     12  AAAAAAAAMCAAAAAA   2599.68\n9         Shoes           kids    exportiedu pack #2      n steingbarcallyanti    2001      4     12  AAAAAAAAMCAAAAAA    363.09\n10  Electronics       portable  scholaramalgamalg #3           n stbarprically    2001      4     12  AAAAAAAAMCAAAAAA    811.68\n11         Home  blinds/shades       scholarbrand #4       prieseantin station    2001      4     12  AAAAAAAALCAAAAAA   1911.24\n12        Women      maternity       exportiamalg #2        priationprieseanti    2001      4     12  AAAAAAAAPBAAAAAA   4558.86\n13        Music           rock       amalgscholar #2       ationbarablebaranti    2001      4     12  AAAAAAAAPBAAAAAA    190.72\n14        Books      reference          brandmaxi #2   n stcallyationableought    2001      4     12  AAAAAAAAKEAAAAAA   2431.68\n15        Books       business        importomaxi #8       n stpripriationn st    2001      4     12  AAAAAAAAKEAAAAAA   1476.00\n16         Home  blinds/shades       scholarbrand #2        oughtprin stpripri    2001      4     12  AAAAAAAAMFAAAAAA   8560.59\n17        Music        country     importoscholar #2            pripribaration    2001      4     12  AAAAAAAAOFAAAAAA   1135.44\n18          Men         shirts     importoimporto #2  oughteingoughtationought    2001      4     12  AAAAAAAAKBAAAAAA      2.74\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018661,
                    "execution_time": 0.007767,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.004234
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019551,
                    "execution_time": 0.008519,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004345
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*     i_category        i_class               i_brand            i_product_name  d_year  d_qoy  d_moy        s_store_id  sumsales\n0           Men          pants     exportiimporto #2      oughteingesebarcally    2001      4     12  AAAAAAAAKBAAAAAA   3292.10\n1         Music           rock       amalgscholar #2     ationantiprin stcally    2001      4     12  AAAAAAAAKBAAAAAA    667.20\n2      Children        infants     importoexporti #2    antiableeingoughtought    2001      4     12  AAAAAAAAEBAAAAAA    855.27\n3         Music        country     importoscholar #2      antiationeingprieing    2001      4     12  AAAAAAAABDAAAAAA   2449.32\n4          Home          paint    importonameless #8      ationeseableesecally    2001      4     12  AAAAAAAABDAAAAAA   8940.77\n5         Women        dresses         amalgamalg #2    anticallycallyn steing    2001      4     12  AAAAAAAABDAAAAAA   5010.86\n6          Home      furniture       corpnameless #8    ationationantiationpri    2001      4     12  AAAAAAAABDAAAAAA   3091.20\n7      Children        newborn       amalgexporti #2         antibarpriablepri    2001      4     12  AAAAAAAAPBAAAAAA    228.54\n8          Home      wallpaper    exportinameless #6      antioughtn steingese    2001      4     12  AAAAAAAAMCAAAAAA   2599.68\n9         Shoes           kids    exportiedu pack #2      n steingbarcallyanti    2001      4     12  AAAAAAAAMCAAAAAA    363.09\n10  Electronics       portable  scholaramalgamalg #3           n stbarprically    2001      4     12  AAAAAAAAMCAAAAAA    811.68\n11         Home  blinds/shades       scholarbrand #4       prieseantin station    2001      4     12  AAAAAAAALCAAAAAA   1911.24\n12        Women      maternity       exportiamalg #2        priationprieseanti    2001      4     12  AAAAAAAAPBAAAAAA   4558.86\n13        Music           rock       amalgscholar #2       ationbarablebaranti    2001      4     12  AAAAAAAAPBAAAAAA    190.72\n14        Books      reference          brandmaxi #2   n stcallyationableought    2001      4     12  AAAAAAAAKEAAAAAA   2431.68\n15        Books       business        importomaxi #8       n stpripriationn st    2001      4     12  AAAAAAAAKEAAAAAA   1476.00\n16         Home  blinds/shades       scholarbrand #2        oughtprin stpripri    2001      4     12  AAAAAAAAMFAAAAAA   8560.59\n17        Music        country     importoscholar #2            pripribaration    2001      4     12  AAAAAAAAOFAAAAAA   1135.44\n18          Men         shirts     importoimporto #2  oughteingoughtationought    2001      4     12  AAAAAAAAKBAAAAAA      2.74\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n/*CURSOR_IDENTIFIER*/\nfrom results_rollup) subquery",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" DESC ) AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*   i_category         i_class              i_brand i_product_name d_year d_qoy d_moy s_store_id      sumsales  rk\n0       Books            None                 None           None   None  None  None       None  9.796405e+08   1\n1       Books         fiction                 None           None   None  None  None       None  6.819282e+07   2\n2       Books          travel                 None           None   None  None  None       None  6.617882e+07   3\n3       Books          sports                 None           None   None  None  None       None  6.515965e+07   4\n4       Books         history                 None           None   None  None  None       None  6.486531e+07   5\n5       Books       computers                 None           None   None  None  None       None  6.402368e+07   6\n6       Books     home repair                 None           None   None  None  None       None  6.294916e+07   7\n7       Books         cooking                 None           None   None  None  None       None  6.287917e+07   8\n8       Books            arts                 None           None   None  None  None       None  6.136396e+07   9\n9       Books       reference                 None           None   None  None  None       None  6.113406e+07  10\n10      Books  entertainments                 None           None   None  None  None       None  5.959443e+07  11\n11      Books         romance                 None           None   None  None  None       None  5.870000e+07  12\n12      Books       parenting                 None           None   None  None  None       None  5.803470e+07  13\n13      Books         science                 None           None   None  None  None       None  5.780723e+07  14\n14      Books       self-help                 None           None   None  None  None       None  5.696694e+07  15\n15      Books        business                 None           None   None  None  None       None  5.599852e+07  16\n16      Books         mystery                 None           None   None  None  None       None  5.413968e+07  17\n17      Books     home repair  importounivamalg #2           None   None  None  None       None  1.312606e+07  18\n18      Books       reference         brandmaxi #8           None   None  None  None       None  1.260538e+07  19\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.982954,
                    "execution_time": 0.970267,
                    "compile_time": 9.6e-05,
                    "planning_time": 0.004978
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 1.006302,
                    "execution_time": 0.954055,
                    "compile_time": 0.002776,
                    "planning_time": 0.040654
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*   i_category         i_class              i_brand i_product_name d_year d_qoy d_moy s_store_id      sumsales  rk\n0       Books            None                 None           None   None  None  None       None  9.796405e+08   1\n1       Books         fiction                 None           None   None  None  None       None  6.819282e+07   2\n2       Books          travel                 None           None   None  None  None       None  6.617882e+07   3\n3       Books          sports                 None           None   None  None  None       None  6.515965e+07   4\n4       Books         history                 None           None   None  None  None       None  6.486531e+07   5\n5       Books       computers                 None           None   None  None  None       None  6.402368e+07   6\n6       Books     home repair                 None           None   None  None  None       None  6.294916e+07   7\n7       Books         cooking                 None           None   None  None  None       None  6.287917e+07   8\n8       Books            arts                 None           None   None  None  None       None  6.136396e+07   9\n9       Books       reference                 None           None   None  None  None       None  6.113406e+07  10\n10      Books  entertainments                 None           None   None  None  None       None  5.959443e+07  11\n11      Books         romance                 None           None   None  None  None       None  5.870000e+07  12\n12      Books       parenting                 None           None   None  None  None       None  5.803470e+07  13\n13      Books         science                 None           None   None  None  None       None  5.780723e+07  14\n14      Books       self-help                 None           None   None  None  None       None  5.696694e+07  15\n15      Books        business                 None           None   None  None  None       None  5.599852e+07  16\n16      Books         mystery                 None           None   None  None  None       None  5.413968e+07  17\n17      Books     home repair  importounivamalg #2           None   None  None  None       None  1.312606e+07  18\n18      Books       reference         brandmaxi #8           None   None  None  None       None  1.260538e+07  19\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" DESC ) AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*   i_category         i_class              i_brand i_product_name d_year d_qoy d_moy s_store_id      sumsales  rk\n0       Books            None                 None           None   None  None  None       None  9.796405e+08   1\n1       Books         fiction                 None           None   None  None  None       None  6.819282e+07   2\n2       Books          travel                 None           None   None  None  None       None  6.617882e+07   3\n3       Books          sports                 None           None   None  None  None       None  6.515965e+07   4\n4       Books         history                 None           None   None  None  None       None  6.486531e+07   5\n5       Books       computers                 None           None   None  None  None       None  6.402368e+07   6\n6       Books     home repair                 None           None   None  None  None       None  6.294916e+07   7\n7       Books         cooking                 None           None   None  None  None       None  6.287917e+07   8\n8       Books            arts                 None           None   None  None  None       None  6.136396e+07   9\n9       Books       reference                 None           None   None  None  None       None  6.113406e+07  10\n10      Books  entertainments                 None           None   None  None  None       None  5.959443e+07  11\n11      Books         romance                 None           None   None  None  None       None  5.870000e+07  12\n12      Books       parenting                 None           None   None  None  None       None  5.803470e+07  13\n13      Books         science                 None           None   None  None  None       None  5.780723e+07  14\n14      Books       self-help                 None           None   None  None  None       None  5.696694e+07  15\n15      Books        business                 None           None   None  None  None       None  5.599852e+07  16\n16      Books         mystery                 None           None   None  None  None       None  5.413968e+07  17\n17      Books     home repair  importounivamalg #2           None   None  None  None       None  1.312606e+07  18\n18      Books       reference         brandmaxi #8           None   None  None  None       None  1.260538e+07  19\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.947903,
                    "execution_time": 0.935202,
                    "compile_time": 9.7e-05,
                    "planning_time": 0.004956
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.96589,
                    "execution_time": 0.95238,
                    "compile_time": 9.9e-05,
                    "planning_time": 0.005098
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*   i_category         i_class              i_brand i_product_name d_year d_qoy d_moy s_store_id      sumsales  rk\n0       Books            None                 None           None   None  None  None       None  9.796405e+08   1\n1       Books         fiction                 None           None   None  None  None       None  6.819282e+07   2\n2       Books          travel                 None           None   None  None  None       None  6.617882e+07   3\n3       Books          sports                 None           None   None  None  None       None  6.515965e+07   4\n4       Books         history                 None           None   None  None  None       None  6.486531e+07   5\n5       Books       computers                 None           None   None  None  None       None  6.402368e+07   6\n6       Books     home repair                 None           None   None  None  None       None  6.294916e+07   7\n7       Books         cooking                 None           None   None  None  None       None  6.287917e+07   8\n8       Books            arts                 None           None   None  None  None       None  6.136396e+07   9\n9       Books       reference                 None           None   None  None  None       None  6.113406e+07  10\n10      Books  entertainments                 None           None   None  None  None       None  5.959443e+07  11\n11      Books         romance                 None           None   None  None  None       None  5.870000e+07  12\n12      Books       parenting                 None           None   None  None  None       None  5.803470e+07  13\n13      Books         science                 None           None   None  None  None       None  5.780723e+07  14\n14      Books       self-help                 None           None   None  None  None       None  5.696694e+07  15\n15      Books        business                 None           None   None  None  None       None  5.599852e+07  16\n16      Books         mystery                 None           None   None  None  None       None  5.413968e+07  17\n17      Books     home repair  importounivamalg #2           None   None  None  None       None  1.312606e+07  18\n18      Books       reference         brandmaxi #8           None   None  None  None       None  1.260538e+07  19\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_4\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" ORDER BY \"SPEQLITE_TEMP_TABLE_4\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.194295,
                    "execution_time": 2.134286,
                    "compile_time": 0.000543,
                    "planning_time": 0.005071,
                    "create_size": 949
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.22619,
                    "execution_time": 2.106583,
                    "compile_time": 0.004317,
                    "planning_time": 0.0611,
                    "create_size": 949
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE \"SPEQLITE_TEMP_TABLE_6\".\"RK\" <= 100",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.089623,
                    "execution_time": 0.056255,
                    "compile_time": 0.000248,
                    "planning_time": 0.006185,
                    "create_size": 286
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.378514,
                    "execution_time": 0.056439,
                    "compile_time": 0.210623,
                    "planning_time": 0.078163,
                    "create_size": 286
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*     i_category          i_class                i_brand i_product_name d_year d_qoy d_moy s_store_id      sumsales  rk\n0   Electronics             None                   None           None   None  None  None       None  1.017135e+09   1\n1   Electronics           memory                   None           None   None  None  None       None  6.777497e+07   2\n2   Electronics  dvd/vcr players                   None           None   None  None  None       None  6.769538e+07   3\n3   Electronics      disk drives                   None           None   None  None  None       None  6.754718e+07   4\n4   Electronics         monitors                   None           None   None  None  None       None  6.707208e+07   5\n5   Electronics      televisions                   None           None   None  None  None       None  6.631931e+07   6\n6   Electronics           karoke                   None           None   None  None  None       None  6.536885e+07   7\n7   Electronics         scanners                   None           None   None  None  None       None  6.402847e+07   8\n8   Electronics          musical                   None           None   None  None  None       None  6.396997e+07   9\n9   Electronics         personal                   None           None   None  None  None       None  6.354017e+07  10\n10  Electronics         portable                   None           None   None  None  None       None  6.291629e+07  11\n11  Electronics          cameras                   None           None   None  None  None       None  6.280932e+07  12\n12  Electronics       camcorders                   None           None   None  None  None       None  6.197084e+07  13\n13  Electronics            audio                   None           None   None  None  None       None  6.080906e+07  14\n14  Electronics         wireless                   None           None   None  None  None       None  5.903555e+07  15\n15  Electronics       automotive                   None           None   None  None  None       None  5.878232e+07  16\n16  Electronics           stereo                   None           None   None  None  None       None  5.694061e+07  17\n17  Electronics         portable   scholaramalgamalg #3           None   None  None  None       None  6.553743e+06  18\n18  Electronics  dvd/vcr players    exportiunivamalg #5           None   None  None  None       None  6.065029e+06  19\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019283,
                    "execution_time": 0.007231,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.005456
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.188542,
                    "execution_time": 0.007701,
                    "compile_time": 0.131643,
                    "planning_time": 0.04094
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE \"SPEQLITE_TEMP_TABLE_6\".\"RK\" <= 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*     i_category          i_class                i_brand i_product_name d_year d_qoy d_moy s_store_id      sumsales  rk\n0   Electronics             None                   None           None   None  None  None       None  1.017135e+09   1\n1   Electronics           memory                   None           None   None  None  None       None  6.777497e+07   2\n2   Electronics  dvd/vcr players                   None           None   None  None  None       None  6.769538e+07   3\n3   Electronics      disk drives                   None           None   None  None  None       None  6.754718e+07   4\n4   Electronics         monitors                   None           None   None  None  None       None  6.707208e+07   5\n5   Electronics      televisions                   None           None   None  None  None       None  6.631931e+07   6\n6   Electronics           karoke                   None           None   None  None  None       None  6.536885e+07   7\n7   Electronics         scanners                   None           None   None  None  None       None  6.402847e+07   8\n8   Electronics          musical                   None           None   None  None  None       None  6.396997e+07   9\n9   Electronics         personal                   None           None   None  None  None       None  6.354017e+07  10\n10  Electronics         portable                   None           None   None  None  None       None  6.291629e+07  11\n11  Electronics          cameras                   None           None   None  None  None       None  6.280932e+07  12\n12  Electronics       camcorders                   None           None   None  None  None       None  6.197084e+07  13\n13  Electronics            audio                   None           None   None  None  None       None  6.080906e+07  14\n14  Electronics         wireless                   None           None   None  None  None       None  5.903555e+07  15\n15  Electronics       automotive                   None           None   None  None  None       None  5.878232e+07  16\n16  Electronics           stereo                   None           None   None  None  None       None  5.694061e+07  17\n17  Electronics         portable   scholaramalgamalg #3           None   None  None  None       None  6.553743e+06  18\n18  Electronics  dvd/vcr players    exportiunivamalg #5           None   None  None  None       None  6.065029e+06  19\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" LIMIT 21",
                "preview": "\n/*   i_category   i_class            i_brand i_product_name  d_year  d_qoy  d_moy s_store_id     sumsales  rk\n0                  None               None           None     NaN    NaN    NaN       None  23582971.59   1\n1                                     None           None     NaN    NaN    NaN       None  12079544.88   2\n2                                                    None     NaN    NaN    NaN       None   5300687.52   3\n3                                                             NaN    NaN    NaN       None   3183799.45   4\n4                                                          2001.0    NaN    NaN       None   2154428.33   5\n5                                                          2001.0    4.0    NaN       None   1470196.13   6\n6                                                          2002.0    NaN    NaN       None   1029371.12   7\n7                                                          2001.0    3.0    NaN       None    684232.20   8\n8                  mens               None           None     NaN    NaN    NaN       None    600688.77   9\n9                                                          2001.0    4.0   12.0       None    579419.95  10\n10             swimwear               None           None     NaN    NaN    NaN       None    566502.45  11\n11             toddlers               None           None     NaN    NaN    NaN       None    531145.90  12\n12             toddlers  exportiexporti #2           None     NaN    NaN    NaN       None    531145.90  12\n13                                                         2001.0    4.0   11.0       None    506742.17  14\n14             athletic               None           None     NaN    NaN    NaN       None    470539.58  15\n15                                                         2002.0    1.0    NaN       None    464075.72  16\n16                       importoexporti #2           None     NaN    NaN    NaN       None    446216.44  17\n17                       importoexporti #2                    NaN    NaN    NaN       None    446216.44  17\n18                                                         2002.0    2.0    NaN       None    438438.78  19\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.026626,
                    "execution_time": 0.013263,
                    "compile_time": 6.3e-05,
                    "planning_time": 0.005568
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.279953,
                    "execution_time": 0.012134,
                    "compile_time": 0.217183,
                    "planning_time": 0.040979
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE \"SPEQLITE_TEMP_TABLE_6\".\"RK\" <= 100 ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category   i_class            i_brand i_product_name  d_year  d_qoy  d_moy s_store_id     sumsales  rk\n0                  None               None           None     NaN    NaN    NaN       None  23582971.59   1\n1                                     None           None     NaN    NaN    NaN       None  12079544.88   2\n2                                                    None     NaN    NaN    NaN       None   5300687.52   3\n3                                                             NaN    NaN    NaN       None   3183799.45   4\n4                                                          2001.0    NaN    NaN       None   2154428.33   5\n5                                                          2001.0    4.0    NaN       None   1470196.13   6\n6                                                          2002.0    NaN    NaN       None   1029371.12   7\n7                                                          2001.0    3.0    NaN       None    684232.20   8\n8                  mens               None           None     NaN    NaN    NaN       None    600688.77   9\n9                                                          2001.0    4.0   12.0       None    579419.95  10\n10             swimwear               None           None     NaN    NaN    NaN       None    566502.45  11\n11             toddlers               None           None     NaN    NaN    NaN       None    531145.90  12\n12             toddlers  exportiexporti #2           None     NaN    NaN    NaN       None    531145.90  12\n13                                                         2001.0    4.0   11.0       None    506742.17  14\n14             athletic               None           None     NaN    NaN    NaN       None    470539.58  15\n15                                                         2002.0    1.0    NaN       None    464075.72  16\n16                       importoexporti #2           None     NaN    NaN    NaN       None    446216.44  17\n17                       importoexporti #2                    NaN    NaN    NaN       None    446216.44  17\n18                                                         2002.0    2.0    NaN       None    438438.78  19\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" LIMIT 21",
                "preview": "\n/*   i_category i_class            i_brand i_product_name  d_year  d_qoy  d_moy s_store_id     sumsales  rk\n0                       edu packamalg #2           None     NaN    NaN    NaN       None    378178.11  30\n1                                                        2001.0    3.0    9.0       None    302712.47  42\n2                                   None           None     NaN    NaN    NaN       None  12079544.88   2\n3                        importoamalg #2           None     NaN    NaN    NaN       None    382897.43  29\n4                        amalgexporti #2           None     NaN    NaN    NaN       None    409753.06  22\n5                                                        2001.0    3.0    8.0       None    373261.58  31\n6                                                        2001.0    3.0    NaN       None    684232.20   8\n7                                                           NaN    NaN    NaN       None   3183799.45   4\n8                                                        2001.0    4.0   10.0       None    384034.01  27\n9                                                        2001.0    NaN    NaN       None   2154428.33   5\n10                                                       2001.0    4.0    NaN       None   1470196.13   6\n11                                                 None     NaN    NaN    NaN       None   5300687.52   3\n12                                                       2001.0    4.0   11.0       None    506742.17  14\n13                                                       2002.0    NaN    NaN       None   1029371.12   7\n14                                                       2002.0    1.0    NaN       None    464075.72  16\n15                     importoexporti #2           None     NaN    NaN    NaN       None    446216.44  17\n16                     importoexporti #2                    NaN    NaN    NaN       None    446216.44  17\n17                                                       2002.0    2.0    NaN       None    438438.78  19\n18                                                       2001.0    4.0   12.0       None    579419.95  10\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020705,
                    "execution_time": 0.0082,
                    "compile_time": 8.6e-05,
                    "planning_time": 0.005787
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.180709,
                    "execution_time": 0.0093,
                    "compile_time": 0.122501,
                    "planning_time": 0.041442
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE \"SPEQLITE_TEMP_TABLE_6\".\"RK\" <= 100 ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category i_class            i_brand i_product_name  d_year  d_qoy  d_moy s_store_id     sumsales  rk\n0                       edu packamalg #2           None     NaN    NaN    NaN       None    378178.11  30\n1                                                        2001.0    3.0    9.0       None    302712.47  42\n2                                   None           None     NaN    NaN    NaN       None  12079544.88   2\n3                        importoamalg #2           None     NaN    NaN    NaN       None    382897.43  29\n4                        amalgexporti #2           None     NaN    NaN    NaN       None    409753.06  22\n5                                                        2001.0    3.0    8.0       None    373261.58  31\n6                                                        2001.0    3.0    NaN       None    684232.20   8\n7                                                           NaN    NaN    NaN       None   3183799.45   4\n8                                                        2001.0    4.0   10.0       None    384034.01  27\n9                                                        2001.0    NaN    NaN       None   2154428.33   5\n10                                                       2001.0    4.0    NaN       None   1470196.13   6\n11                                                 None     NaN    NaN    NaN       None   5300687.52   3\n12                                                       2001.0    4.0   11.0       None    506742.17  14\n13                                                       2002.0    NaN    NaN       None   1029371.12   7\n14                                                       2002.0    1.0    NaN       None    464075.72  16\n15                     importoexporti #2           None     NaN    NaN    NaN       None    446216.44  17\n16                     importoexporti #2                    NaN    NaN    NaN       None    446216.44  17\n17                                                       2002.0    2.0    NaN       None    438438.78  19\n18                                                       2001.0    4.0   12.0       None    579419.95  10\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" LIMIT 21",
                "preview": "\n/*   i_category i_class          i_brand         i_product_name  d_year  d_qoy  d_moy s_store_id    sumsales  rk\n0                                                                 NaN    NaN    NaN       None  3183799.45   4\n1                                                              2001.0    3.0    NaN       None   684232.20   8\n2                                                              2002.0    2.0    NaN       None   438438.78  19\n3                                                              2001.0    4.0   12.0       None   579419.95  10\n4                                                              2001.0    3.0    9.0       None   302712.47  42\n5                                                              2001.0    3.0    8.0       None   373261.58  31\n6                                                              2001.0    4.0   10.0       None   384034.01  27\n7                                         prin stoughtbareing     NaN    NaN    NaN       None   222871.16  70\n8                                         n steseeseationn st     NaN    NaN    NaN       None   236657.70  64\n9                                                              2001.0    NaN    NaN       None  2154428.33   5\n10                                                             2001.0    4.0    NaN       None  1470196.13   6\n11                                                       None     NaN    NaN    NaN       None  5300687.52   3\n12                                                             2001.0    4.0   11.0       None   506742.17  14\n13                                                             2002.0    NaN    NaN       None  1029371.12   7\n14                                                             2002.0    1.0    NaN       None   464075.72  16\n15                     amalgexporti #2                   None     NaN    NaN    NaN       None   409753.06  22\n16                     amalgexporti #2   oughtableeingn stese     NaN    NaN    NaN       None   226334.22  67\n17                     amalgimporto #2                   None     NaN    NaN    NaN       None   386641.78  24\n18                     amalgimporto #2  antioughtationeseeing     NaN    NaN    NaN       None   215036.93  87\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021661,
                    "execution_time": 0.008834,
                    "compile_time": 9e-05,
                    "planning_time": 0.005931
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.167024,
                    "execution_time": 0.008261,
                    "compile_time": 0.11045,
                    "planning_time": 0.041408
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE \"SPEQLITE_TEMP_TABLE_6\".\"RK\" <= 100 ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category i_class          i_brand         i_product_name  d_year  d_qoy  d_moy s_store_id    sumsales  rk\n0                                                                 NaN    NaN    NaN       None  3183799.45   4\n1                                                              2001.0    3.0    NaN       None   684232.20   8\n2                                                              2002.0    2.0    NaN       None   438438.78  19\n3                                                              2001.0    4.0   12.0       None   579419.95  10\n4                                                              2001.0    3.0    9.0       None   302712.47  42\n5                                                              2001.0    3.0    8.0       None   373261.58  31\n6                                                              2001.0    4.0   10.0       None   384034.01  27\n7                                         prin stoughtbareing     NaN    NaN    NaN       None   222871.16  70\n8                                         n steseeseationn st     NaN    NaN    NaN       None   236657.70  64\n9                                                              2001.0    NaN    NaN       None  2154428.33   5\n10                                                             2001.0    4.0    NaN       None  1470196.13   6\n11                                                       None     NaN    NaN    NaN       None  5300687.52   3\n12                                                             2001.0    4.0   11.0       None   506742.17  14\n13                                                             2002.0    NaN    NaN       None  1029371.12   7\n14                                                             2002.0    1.0    NaN       None   464075.72  16\n15                     amalgexporti #2                   None     NaN    NaN    NaN       None   409753.06  22\n16                     amalgexporti #2   oughtableeingn stese     NaN    NaN    NaN       None   226334.22  67\n17                     amalgimporto #2                   None     NaN    NaN    NaN       None   386641.78  24\n18                     amalgimporto #2  antioughtationeseeing     NaN    NaN    NaN       None   215036.93  87\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" LIMIT 21",
                "preview": "\n/*   i_category i_class          i_brand         i_product_name  d_year  d_qoy  d_moy s_store_id    sumsales  rk\n0                                                              2001.0    4.0   11.0       None   506742.17  14\n1                                                              2002.0    1.0    NaN       None   464075.72  16\n2                                                              2001.0    3.0    NaN       None   684232.20   8\n3                                                              2002.0    NaN    NaN       None  1029371.12   7\n4                                                                 NaN    NaN    NaN       None  3183799.45   4\n5                                                              2001.0    3.0    8.0       None   373261.58  31\n6                                                              2002.0    2.0    NaN       None   438438.78  19\n7                                                              2001.0    4.0   12.0       None   579419.95  10\n8                                                              2001.0    4.0   10.0       None   384034.01  27\n9                                                              2001.0    NaN    NaN       None  2154428.33   5\n10                                                             2001.0    4.0    NaN       None  1470196.13   6\n11                                                             2001.0    3.0    9.0       None   302712.47  42\n12                                        n steseeseationn st     NaN    NaN    NaN       None   236657.70  64\n13                                        prin stoughtbareing     NaN    NaN    NaN       None   222871.16  70\n14                                                       None     NaN    NaN    NaN       None  5300687.52   3\n15                     amalgexporti #2   oughtableeingn stese     NaN    NaN    NaN       None   226334.22  67\n16                     amalgexporti #2                   None     NaN    NaN    NaN       None   409753.06  22\n17                     amalgimporto #2  antioughtationeseeing     NaN    NaN    NaN       None   215036.93  87\n18                     amalgimporto #2                   None     NaN    NaN    NaN       None   386641.78  24\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.02205,
                    "execution_time": 0.009225,
                    "compile_time": 8.6e-05,
                    "planning_time": 0.00585
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.118654,
                    "execution_time": 0.009222,
                    "compile_time": 0.060925,
                    "planning_time": 0.041644
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE \"SPEQLITE_TEMP_TABLE_6\".\"RK\" <= 100 ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category i_class          i_brand         i_product_name  d_year  d_qoy  d_moy s_store_id    sumsales  rk\n0                                                              2001.0    4.0   11.0       None   506742.17  14\n1                                                              2002.0    1.0    NaN       None   464075.72  16\n2                                                              2001.0    3.0    NaN       None   684232.20   8\n3                                                              2002.0    NaN    NaN       None  1029371.12   7\n4                                                                 NaN    NaN    NaN       None  3183799.45   4\n5                                                              2001.0    3.0    8.0       None   373261.58  31\n6                                                              2002.0    2.0    NaN       None   438438.78  19\n7                                                              2001.0    4.0   12.0       None   579419.95  10\n8                                                              2001.0    4.0   10.0       None   384034.01  27\n9                                                              2001.0    NaN    NaN       None  2154428.33   5\n10                                                             2001.0    4.0    NaN       None  1470196.13   6\n11                                                             2001.0    3.0    9.0       None   302712.47  42\n12                                        n steseeseationn st     NaN    NaN    NaN       None   236657.70  64\n13                                        prin stoughtbareing     NaN    NaN    NaN       None   222871.16  70\n14                                                       None     NaN    NaN    NaN       None  5300687.52   3\n15                     amalgexporti #2   oughtableeingn stese     NaN    NaN    NaN       None   226334.22  67\n16                     amalgexporti #2                   None     NaN    NaN    NaN       None   409753.06  22\n17                     amalgimporto #2  antioughtationeseeing     NaN    NaN    NaN       None   215036.93  87\n18                     amalgimporto #2                   None     NaN    NaN    NaN       None   386641.78  24\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST , \"DW2\".\"D_YEAR\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" LIMIT 21",
                "preview": "\n/*   i_category i_class          i_brand         i_product_name  d_year  d_qoy  d_moy s_store_id    sumsales  rk\n0                                                              2001.0    NaN    NaN       None  2154428.33   5\n1                                                              2001.0    4.0   10.0       None   384034.01  27\n2                                                              2001.0    4.0    NaN       None  1470196.13   6\n3                                                              2001.0    3.0    8.0       None   373261.58  31\n4                                                              2001.0    4.0   12.0       None   579419.95  10\n5                                                              2001.0    3.0    NaN       None   684232.20   8\n6                                                              2001.0    4.0   11.0       None   506742.17  14\n7                                                              2001.0    3.0    9.0       None   302712.47  42\n8                                                              2002.0    NaN    NaN       None  1029371.12   7\n9                                                              2002.0    1.0    NaN       None   464075.72  16\n10                                                             2002.0    2.0    NaN       None   438438.78  19\n11                                                                NaN    NaN    NaN       None  3183799.45   4\n12                                        n steseeseationn st     NaN    NaN    NaN       None   236657.70  64\n13                                        prin stoughtbareing     NaN    NaN    NaN       None   222871.16  70\n14                                                       None     NaN    NaN    NaN       None  5300687.52   3\n15                     amalgexporti #2   oughtableeingn stese     NaN    NaN    NaN       None   226334.22  67\n16                     amalgexporti #2                   None     NaN    NaN    NaN       None   409753.06  22\n17                     amalgimporto #2  antioughtationeseeing     NaN    NaN    NaN       None   215036.93  87\n18                     amalgimporto #2                   None     NaN    NaN    NaN       None   386641.78  24\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021218,
                    "execution_time": 0.008496,
                    "compile_time": 8.4e-05,
                    "planning_time": 0.005987
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.155295,
                    "execution_time": 0.008559,
                    "compile_time": 0.098167,
                    "planning_time": 0.041658
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE \"SPEQLITE_TEMP_TABLE_6\".\"RK\" <= 100 ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category i_class          i_brand         i_product_name  d_year  d_qoy  d_moy s_store_id    sumsales  rk\n0                                                              2001.0    NaN    NaN       None  2154428.33   5\n1                                                              2001.0    4.0   10.0       None   384034.01  27\n2                                                              2001.0    4.0    NaN       None  1470196.13   6\n3                                                              2001.0    3.0    8.0       None   373261.58  31\n4                                                              2001.0    4.0   12.0       None   579419.95  10\n5                                                              2001.0    3.0    NaN       None   684232.20   8\n6                                                              2001.0    4.0   11.0       None   506742.17  14\n7                                                              2001.0    3.0    9.0       None   302712.47  42\n8                                                              2002.0    NaN    NaN       None  1029371.12   7\n9                                                              2002.0    1.0    NaN       None   464075.72  16\n10                                                             2002.0    2.0    NaN       None   438438.78  19\n11                                                                NaN    NaN    NaN       None  3183799.45   4\n12                                        n steseeseationn st     NaN    NaN    NaN       None   236657.70  64\n13                                        prin stoughtbareing     NaN    NaN    NaN       None   222871.16  70\n14                                                       None     NaN    NaN    NaN       None  5300687.52   3\n15                     amalgexporti #2   oughtableeingn stese     NaN    NaN    NaN       None   226334.22  67\n16                     amalgexporti #2                   None     NaN    NaN    NaN       None   409753.06  22\n17                     amalgimporto #2  antioughtationeseeing     NaN    NaN    NaN       None   215036.93  87\n18                     amalgimporto #2                   None     NaN    NaN    NaN       None   386641.78  24\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST , \"DW2\".\"D_YEAR\" NULLS LAST , \"DW2\".\"D_QOY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" LIMIT 21",
                "preview": "\n/*   i_category i_class          i_brand         i_product_name  d_year  d_qoy  d_moy s_store_id    sumsales  rk\n0                                                              2001.0    3.0    NaN       None   684232.20   8\n1                                                              2001.0    3.0    9.0       None   302712.47  42\n2                                                              2001.0    3.0    8.0       None   373261.58  31\n3                                                              2001.0    4.0    NaN       None  1470196.13   6\n4                                                              2001.0    4.0   12.0       None   579419.95  10\n5                                                              2001.0    4.0   11.0       None   506742.17  14\n6                                                              2001.0    4.0   10.0       None   384034.01  27\n7                                                              2001.0    NaN    NaN       None  2154428.33   5\n8                                                              2002.0    1.0    NaN       None   464075.72  16\n9                                                              2002.0    2.0    NaN       None   438438.78  19\n10                                                             2002.0    NaN    NaN       None  1029371.12   7\n11                                                                NaN    NaN    NaN       None  3183799.45   4\n12                                        n steseeseationn st     NaN    NaN    NaN       None   236657.70  64\n13                                        prin stoughtbareing     NaN    NaN    NaN       None   222871.16  70\n14                                                       None     NaN    NaN    NaN       None  5300687.52   3\n15                     amalgexporti #2   oughtableeingn stese     NaN    NaN    NaN       None   226334.22  67\n16                     amalgexporti #2                   None     NaN    NaN    NaN       None   409753.06  22\n17                     amalgimporto #2  antioughtationeseeing     NaN    NaN    NaN       None   215036.93  87\n18                     amalgimporto #2                   None     NaN    NaN    NaN       None   386641.78  24\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021913,
                    "execution_time": 0.008527,
                    "compile_time": 8.9e-05,
                    "planning_time": 0.006375
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.160391,
                    "execution_time": 0.008255,
                    "compile_time": 0.103443,
                    "planning_time": 0.041838
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE \"SPEQLITE_TEMP_TABLE_6\".\"RK\" <= 100 ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category i_class          i_brand         i_product_name  d_year  d_qoy  d_moy s_store_id    sumsales  rk\n0                                                              2001.0    3.0    NaN       None   684232.20   8\n1                                                              2001.0    3.0    9.0       None   302712.47  42\n2                                                              2001.0    3.0    8.0       None   373261.58  31\n3                                                              2001.0    4.0    NaN       None  1470196.13   6\n4                                                              2001.0    4.0   12.0       None   579419.95  10\n5                                                              2001.0    4.0   11.0       None   506742.17  14\n6                                                              2001.0    4.0   10.0       None   384034.01  27\n7                                                              2001.0    NaN    NaN       None  2154428.33   5\n8                                                              2002.0    1.0    NaN       None   464075.72  16\n9                                                              2002.0    2.0    NaN       None   438438.78  19\n10                                                             2002.0    NaN    NaN       None  1029371.12   7\n11                                                                NaN    NaN    NaN       None  3183799.45   4\n12                                        n steseeseationn st     NaN    NaN    NaN       None   236657.70  64\n13                                        prin stoughtbareing     NaN    NaN    NaN       None   222871.16  70\n14                                                       None     NaN    NaN    NaN       None  5300687.52   3\n15                     amalgexporti #2   oughtableeingn stese     NaN    NaN    NaN       None   226334.22  67\n16                     amalgexporti #2                   None     NaN    NaN    NaN       None   409753.06  22\n17                     amalgimporto #2  antioughtationeseeing     NaN    NaN    NaN       None   215036.93  87\n18                     amalgimporto #2                   None     NaN    NaN    NaN       None   386641.78  24\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST , \"DW2\".\"D_YEAR\" NULLS LAST , \"DW2\".\"D_QOY\" NULLS LAST , \"DW2\".\"D_MOY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" LIMIT 21",
                "preview": "\n/*   i_category i_class          i_brand         i_product_name  d_year  d_qoy  d_moy s_store_id    sumsales  rk\n0                                                              2001.0    3.0    8.0       None   373261.58  31\n1                                                              2001.0    3.0    9.0       None   302712.47  42\n2                                                              2001.0    3.0    NaN       None   684232.20   8\n3                                                              2001.0    4.0   10.0       None   384034.01  27\n4                                                              2001.0    4.0   11.0       None   506742.17  14\n5                                                              2001.0    4.0   12.0       None   579419.95  10\n6                                                              2001.0    4.0    NaN       None  1470196.13   6\n7                                                              2001.0    NaN    NaN       None  2154428.33   5\n8                                                              2002.0    1.0    NaN       None   464075.72  16\n9                                                              2002.0    2.0    NaN       None   438438.78  19\n10                                                             2002.0    NaN    NaN       None  1029371.12   7\n11                                                                NaN    NaN    NaN       None  3183799.45   4\n12                                        n steseeseationn st     NaN    NaN    NaN       None   236657.70  64\n13                                        prin stoughtbareing     NaN    NaN    NaN       None   222871.16  70\n14                                                       None     NaN    NaN    NaN       None  5300687.52   3\n15                     amalgexporti #2   oughtableeingn stese     NaN    NaN    NaN       None   226334.22  67\n16                     amalgexporti #2                   None     NaN    NaN    NaN       None   409753.06  22\n17                     amalgimporto #2  antioughtationeseeing     NaN    NaN    NaN       None   215036.93  87\n18                     amalgimporto #2                   None     NaN    NaN    NaN       None   386641.78  24\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021272,
                    "execution_time": 0.008456,
                    "compile_time": 8.2e-05,
                    "planning_time": 0.005983
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.164995,
                    "execution_time": 0.008638,
                    "compile_time": 0.107258,
                    "planning_time": 0.042098
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE \"SPEQLITE_TEMP_TABLE_6\".\"RK\" <= 100 ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category i_class          i_brand         i_product_name  d_year  d_qoy  d_moy s_store_id    sumsales  rk\n0                                                              2001.0    3.0    8.0       None   373261.58  31\n1                                                              2001.0    3.0    9.0       None   302712.47  42\n2                                                              2001.0    3.0    NaN       None   684232.20   8\n3                                                              2001.0    4.0   10.0       None   384034.01  27\n4                                                              2001.0    4.0   11.0       None   506742.17  14\n5                                                              2001.0    4.0   12.0       None   579419.95  10\n6                                                              2001.0    4.0    NaN       None  1470196.13   6\n7                                                              2001.0    NaN    NaN       None  2154428.33   5\n8                                                              2002.0    1.0    NaN       None   464075.72  16\n9                                                              2002.0    2.0    NaN       None   438438.78  19\n10                                                             2002.0    NaN    NaN       None  1029371.12   7\n11                                                                NaN    NaN    NaN       None  3183799.45   4\n12                                        n steseeseationn st     NaN    NaN    NaN       None   236657.70  64\n13                                        prin stoughtbareing     NaN    NaN    NaN       None   222871.16  70\n14                                                       None     NaN    NaN    NaN       None  5300687.52   3\n15                     amalgexporti #2   oughtableeingn stese     NaN    NaN    NaN       None   226334.22  67\n16                     amalgexporti #2                   None     NaN    NaN    NaN       None   409753.06  22\n17                     amalgimporto #2  antioughtationeseeing     NaN    NaN    NaN       None   215036.93  87\n18                     amalgimporto #2                   None     NaN    NaN    NaN       None   386641.78  24\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n        ,s_store_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST , \"DW2\".\"D_YEAR\" NULLS LAST , \"DW2\".\"D_QOY\" NULLS LAST , \"DW2\".\"D_MOY\" NULLS LAST , \"DW2\".\"S_STORE_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" LIMIT 21",
                "preview": "\n/*   i_category i_class          i_brand         i_product_name  d_year  d_qoy  d_moy s_store_id    sumsales  rk\n0                                                              2001.0    3.0    8.0       None   373261.58  31\n1                                                              2001.0    3.0    9.0       None   302712.47  42\n2                                                              2001.0    3.0    NaN       None   684232.20   8\n3                                                              2001.0    4.0   10.0       None   384034.01  27\n4                                                              2001.0    4.0   11.0       None   506742.17  14\n5                                                              2001.0    4.0   12.0       None   579419.95  10\n6                                                              2001.0    4.0    NaN       None  1470196.13   6\n7                                                              2001.0    NaN    NaN       None  2154428.33   5\n8                                                              2002.0    1.0    NaN       None   464075.72  16\n9                                                              2002.0    2.0    NaN       None   438438.78  19\n10                                                             2002.0    NaN    NaN       None  1029371.12   7\n11                                                                NaN    NaN    NaN       None  3183799.45   4\n12                                        n steseeseationn st     NaN    NaN    NaN       None   236657.70  64\n13                                        prin stoughtbareing     NaN    NaN    NaN       None   222871.16  70\n14                                                       None     NaN    NaN    NaN       None  5300687.52   3\n15                     amalgexporti #2   oughtableeingn stese     NaN    NaN    NaN       None   226334.22  67\n16                     amalgexporti #2                   None     NaN    NaN    NaN       None   409753.06  22\n17                     amalgimporto #2  antioughtationeseeing     NaN    NaN    NaN       None   215036.93  87\n18                     amalgimporto #2                   None     NaN    NaN    NaN       None   386641.78  24\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021242,
                    "execution_time": 0.008243,
                    "compile_time": 8.5e-05,
                    "planning_time": 0.006249
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.140987,
                    "execution_time": 0.008709,
                    "compile_time": 0.082867,
                    "planning_time": 0.042403
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE \"SPEQLITE_TEMP_TABLE_6\".\"RK\" <= 100 ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category i_class          i_brand         i_product_name  d_year  d_qoy  d_moy s_store_id    sumsales  rk\n0                                                              2001.0    3.0    8.0       None   373261.58  31\n1                                                              2001.0    3.0    9.0       None   302712.47  42\n2                                                              2001.0    3.0    NaN       None   684232.20   8\n3                                                              2001.0    4.0   10.0       None   384034.01  27\n4                                                              2001.0    4.0   11.0       None   506742.17  14\n5                                                              2001.0    4.0   12.0       None   579419.95  10\n6                                                              2001.0    4.0    NaN       None  1470196.13   6\n7                                                              2001.0    NaN    NaN       None  2154428.33   5\n8                                                              2002.0    1.0    NaN       None   464075.72  16\n9                                                              2002.0    2.0    NaN       None   438438.78  19\n10                                                             2002.0    NaN    NaN       None  1029371.12   7\n11                                                                NaN    NaN    NaN       None  3183799.45   4\n12                                        n steseeseationn st     NaN    NaN    NaN       None   236657.70  64\n13                                        prin stoughtbareing     NaN    NaN    NaN       None   222871.16  70\n14                                                       None     NaN    NaN    NaN       None  5300687.52   3\n15                     amalgexporti #2   oughtableeingn stese     NaN    NaN    NaN       None   226334.22  67\n16                     amalgexporti #2                   None     NaN    NaN    NaN       None   409753.06  22\n17                     amalgimporto #2  antioughtationeseeing     NaN    NaN    NaN       None   215036.93  87\n18                     amalgimporto #2                   None     NaN    NaN    NaN       None   386641.78  24\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n        ,s_store_id\n        ,sumsales\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST , \"DW2\".\"D_YEAR\" NULLS LAST , \"DW2\".\"D_QOY\" NULLS LAST , \"DW2\".\"D_MOY\" NULLS LAST , \"DW2\".\"S_STORE_ID\" NULLS LAST , \"DW2\".\"SUMSALES\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" LIMIT 21",
                "preview": "\n/*   i_category i_class          i_brand         i_product_name  d_year  d_qoy  d_moy s_store_id    sumsales  rk\n0                                                              2001.0    3.0    8.0       None   373261.58  31\n1                                                              2001.0    3.0    9.0       None   302712.47  42\n2                                                              2001.0    3.0    NaN       None   684232.20   8\n3                                                              2001.0    4.0   10.0       None   384034.01  27\n4                                                              2001.0    4.0   11.0       None   506742.17  14\n5                                                              2001.0    4.0   12.0       None   579419.95  10\n6                                                              2001.0    4.0    NaN       None  1470196.13   6\n7                                                              2001.0    NaN    NaN       None  2154428.33   5\n8                                                              2002.0    1.0    NaN       None   464075.72  16\n9                                                              2002.0    2.0    NaN       None   438438.78  19\n10                                                             2002.0    NaN    NaN       None  1029371.12   7\n11                                                                NaN    NaN    NaN       None  3183799.45   4\n12                                        n steseeseationn st     NaN    NaN    NaN       None   236657.70  64\n13                                        prin stoughtbareing     NaN    NaN    NaN       None   222871.16  70\n14                                                       None     NaN    NaN    NaN       None  5300687.52   3\n15                     amalgexporti #2   oughtableeingn stese     NaN    NaN    NaN       None   226334.22  67\n16                     amalgexporti #2                   None     NaN    NaN    NaN       None   409753.06  22\n17                     amalgimporto #2  antioughtationeseeing     NaN    NaN    NaN       None   215036.93  87\n18                     amalgimporto #2                   None     NaN    NaN    NaN       None   386641.78  24\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021797,
                    "execution_time": 0.008944,
                    "compile_time": 8.6e-05,
                    "planning_time": 0.006202
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.141692,
                    "execution_time": 0.008316,
                    "compile_time": 0.084618,
                    "planning_time": 0.041992
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE \"SPEQLITE_TEMP_TABLE_6\".\"RK\" <= 100 ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category i_class          i_brand         i_product_name  d_year  d_qoy  d_moy s_store_id    sumsales  rk\n0                                                              2001.0    3.0    8.0       None   373261.58  31\n1                                                              2001.0    3.0    9.0       None   302712.47  42\n2                                                              2001.0    3.0    NaN       None   684232.20   8\n3                                                              2001.0    4.0   10.0       None   384034.01  27\n4                                                              2001.0    4.0   11.0       None   506742.17  14\n5                                                              2001.0    4.0   12.0       None   579419.95  10\n6                                                              2001.0    4.0    NaN       None  1470196.13   6\n7                                                              2001.0    NaN    NaN       None  2154428.33   5\n8                                                              2002.0    1.0    NaN       None   464075.72  16\n9                                                              2002.0    2.0    NaN       None   438438.78  19\n10                                                             2002.0    NaN    NaN       None  1029371.12   7\n11                                                                NaN    NaN    NaN       None  3183799.45   4\n12                                        n steseeseationn st     NaN    NaN    NaN       None   236657.70  64\n13                                        prin stoughtbareing     NaN    NaN    NaN       None   222871.16  70\n14                                                       None     NaN    NaN    NaN       None  5300687.52   3\n15                     amalgexporti #2   oughtableeingn stese     NaN    NaN    NaN       None   226334.22  67\n16                     amalgexporti #2                   None     NaN    NaN    NaN       None   409753.06  22\n17                     amalgimporto #2  antioughtationeseeing     NaN    NaN    NaN       None   215036.93  87\n18                     amalgimporto #2                   None     NaN    NaN    NaN       None   386641.78  24\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n        ,s_store_id\n        ,sumsales\n        ,rk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST , \"DW2\".\"D_YEAR\" NULLS LAST , \"DW2\".\"D_QOY\" NULLS LAST , \"DW2\".\"D_MOY\" NULLS LAST , \"DW2\".\"S_STORE_ID\" NULLS LAST , \"DW2\".\"SUMSALES\" NULLS LAST , \"DW2\".\"RK\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" LIMIT 21",
                "preview": "\n/*   i_category i_class          i_brand         i_product_name  d_year  d_qoy  d_moy s_store_id    sumsales  rk\n0                                                              2001.0    3.0    8.0       None   373261.58  31\n1                                                              2001.0    3.0    9.0       None   302712.47  42\n2                                                              2001.0    3.0    NaN       None   684232.20   8\n3                                                              2001.0    4.0   10.0       None   384034.01  27\n4                                                              2001.0    4.0   11.0       None   506742.17  14\n5                                                              2001.0    4.0   12.0       None   579419.95  10\n6                                                              2001.0    4.0    NaN       None  1470196.13   6\n7                                                              2001.0    NaN    NaN       None  2154428.33   5\n8                                                              2002.0    1.0    NaN       None   464075.72  16\n9                                                              2002.0    2.0    NaN       None   438438.78  19\n10                                                             2002.0    NaN    NaN       None  1029371.12   7\n11                                                                NaN    NaN    NaN       None  3183799.45   4\n12                                        n steseeseationn st     NaN    NaN    NaN       None   236657.70  64\n13                                        prin stoughtbareing     NaN    NaN    NaN       None   222871.16  70\n14                                                       None     NaN    NaN    NaN       None  5300687.52   3\n15                     amalgexporti #2   oughtableeingn stese     NaN    NaN    NaN       None   226334.22  67\n16                     amalgexporti #2                   None     NaN    NaN    NaN       None   409753.06  22\n17                     amalgimporto #2  antioughtationeseeing     NaN    NaN    NaN       None   215036.93  87\n18                     amalgimporto #2                   None     NaN    NaN    NaN       None   386641.78  24\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022099,
                    "execution_time": 0.009037,
                    "compile_time": 8.7e-05,
                    "planning_time": 0.00639
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.146193,
                    "execution_time": 0.009176,
                    "compile_time": 0.087877,
                    "planning_time": 0.042276
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE \"SPEQLITE_TEMP_TABLE_6\".\"RK\" <= 100 ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" NULLS LAST"
            }
        ],
        "preview": "\n/*   i_category i_class          i_brand         i_product_name  d_year  d_qoy  d_moy s_store_id    sumsales  rk\n0                                                              2001.0    3.0    8.0       None   373261.58  31\n1                                                              2001.0    3.0    9.0       None   302712.47  42\n2                                                              2001.0    3.0    NaN       None   684232.20   8\n3                                                              2001.0    4.0   10.0       None   384034.01  27\n4                                                              2001.0    4.0   11.0       None   506742.17  14\n5                                                              2001.0    4.0   12.0       None   579419.95  10\n6                                                              2001.0    4.0    NaN       None  1470196.13   6\n7                                                              2001.0    NaN    NaN       None  2154428.33   5\n8                                                              2002.0    1.0    NaN       None   464075.72  16\n9                                                              2002.0    2.0    NaN       None   438438.78  19\n10                                                             2002.0    NaN    NaN       None  1029371.12   7\n11                                                                NaN    NaN    NaN       None  3183799.45   4\n12                                        n steseeseationn st     NaN    NaN    NaN       None   236657.70  64\n13                                        prin stoughtbareing     NaN    NaN    NaN       None   222871.16  70\n14                                                       None     NaN    NaN    NaN       None  5300687.52   3\n15                     amalgexporti #2   oughtableeingn stese     NaN    NaN    NaN       None   226334.22  67\n16                     amalgexporti #2                   None     NaN    NaN    NaN       None   409753.06  22\n17                     amalgimporto #2  antioughtationeseeing     NaN    NaN    NaN       None   215036.93  87\n18                     amalgimporto #2                   None     NaN    NaN    NaN       None   386641.78  24\n...*/"
    },
    {
        "input": "-- start template query67a.tpl query 35 in stream 0\nwith /* TPC-DS query67a.tpl 0.35 */ results as\n(     select i_category ,i_class ,i_brand ,i_product_name ,d_year ,d_qoy ,d_moy ,s_store_id\n                  ,sum(coalesce(ss_sales_price*ss_quantity,0)) sumsales\n            from store_sales ,date_dim ,store ,item\n       where  ss_sold_date_sk=d_date_sk\n          and ss_item_sk=i_item_sk\n          and ss_store_sk = s_store_sk\n          and d_month_seq between 1219 and 1219 + 11\n       group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy,s_store_id)\n ,\n results_rollup as\n (select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, s_store_id, sumsales\n  from results\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy, d_moy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year, d_qoy\n  union all\n  select i_category, i_class, i_brand, i_product_name, d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name, d_year\n  union all\n  select i_category, i_class, i_brand, i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand, i_product_name\n  union all\n  select i_category, i_class, i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class, i_brand\n  union all\n  select i_category, i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category, i_class\n  union all\n  select i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results\n  group by i_category\n  union all\n  select null i_category, null i_class, null i_brand, null i_product_name, null d_year, null d_qoy, null d_moy, null s_store_id, sum(sumsales) sumsales\n  from results)\n\n select  *\nfrom (select i_category\n            ,i_class\n            ,i_brand\n            ,i_product_name\n            ,d_year\n            ,d_qoy\n            ,d_moy\n            ,s_store_id\n            ,sumsales\n            ,rank() over (partition by i_category order by sumsales desc) rk\n      from results_rollup) dw2\nwhere rk <= 100\norder by i_category\n        ,i_class\n        ,i_brand\n        ,i_product_name\n        ,d_year\n        ,d_qoy\n        ,d_moy\n        ,s_store_id\n        ,sumsales\n        ,rk\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" , \"DATE_DIM\".\"D_MOY\" AS \"D_MOY\" , \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( COALESCE ( \"STORE_SALES\".\"SS_SALES_PRICE\" * \"STORE_SALES\".\"SS_QUANTITY\" , 0 ) ) AS \"SUMSALES\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1230 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1219 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_BRAND\" , \"ITEM\".\"I_PRODUCT_NAME\" , \"DATE_DIM\".\"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" , \"DATE_DIM\".\"D_MOY\" , \"STORE\".\"S_STORE_ID\" ) , \"RESULTS_ROLLUP\" AS ( SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS\".\"SUMSALES\" AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS\".\"D_MOY\" AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" , \"RESULTS\".\"D_MOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS\".\"D_QOY\" AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" , \"RESULTS\".\"D_QOY\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" , \"RESULTS\".\"D_YEAR\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" , \"RESULTS\".\"I_PRODUCT_NAME\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS\".\"I_BRAND\" AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" , \"RESULTS\".\"I_BRAND\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" , \"RESULTS\".\"I_CLASS\" UNION ALL SELECT \"RESULTS\".\"I_CATEGORY\" AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_CATEGORY\" UNION ALL SELECT NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , NULL AS \"I_BRAND\" , NULL AS \"I_PRODUCT_NAME\" , NULL AS \"D_YEAR\" , NULL AS \"D_QOY\" , NULL AS \"D_MOY\" , NULL AS \"S_STORE_ID\" , SUM ( \"RESULTS\".\"SUMSALES\" ) AS \"SUMSALES\" FROM \"RESULTS\" AS \"RESULTS\" ) , \"DW2\" AS ( SELECT \"RESULTS_ROLLUP\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"RESULTS_ROLLUP\".\"I_CLASS\" AS \"I_CLASS\" , \"RESULTS_ROLLUP\".\"I_BRAND\" AS \"I_BRAND\" , \"RESULTS_ROLLUP\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"RESULTS_ROLLUP\".\"D_YEAR\" AS \"D_YEAR\" , \"RESULTS_ROLLUP\".\"D_QOY\" AS \"D_QOY\" , \"RESULTS_ROLLUP\".\"D_MOY\" AS \"D_MOY\" , \"RESULTS_ROLLUP\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"RESULTS_ROLLUP\".\"SUMSALES\" AS \"SUMSALES\" , RANK ( ) OVER ( PARTITION BY \"RESULTS_ROLLUP\".\"I_CATEGORY\" ORDER BY \"RESULTS_ROLLUP\".\"SUMSALES\" DESC NULLS FIRST ) AS \"RK\" FROM \"RESULTS_ROLLUP\" AS \"RESULTS_ROLLUP\" ) SELECT \"DW2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"DW2\".\"I_CLASS\" AS \"I_CLASS\" , \"DW2\".\"I_BRAND\" AS \"I_BRAND\" , \"DW2\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"DW2\".\"D_YEAR\" AS \"D_YEAR\" , \"DW2\".\"D_QOY\" AS \"D_QOY\" , \"DW2\".\"D_MOY\" AS \"D_MOY\" , \"DW2\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"DW2\".\"SUMSALES\" AS \"SUMSALES\" , \"DW2\".\"RK\" AS \"RK\" FROM \"DW2\" AS \"DW2\" WHERE \"DW2\".\"RK\" <= 100 ORDER BY \"DW2\".\"I_CATEGORY\" NULLS LAST , \"DW2\".\"I_CLASS\" NULLS LAST , \"DW2\".\"I_BRAND\" NULLS LAST , \"DW2\".\"I_PRODUCT_NAME\" NULLS LAST , \"DW2\".\"D_YEAR\" NULLS LAST , \"DW2\".\"D_QOY\" NULLS LAST , \"DW2\".\"D_MOY\" NULLS LAST , \"DW2\".\"S_STORE_ID\" NULLS LAST , \"DW2\".\"SUMSALES\" NULLS LAST , \"DW2\".\"RK\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" LIMIT 21",
                "preview": "\n/*   i_category i_class          i_brand         i_product_name  d_year  d_qoy  d_moy s_store_id    sumsales  rk\n0                                                              2001.0    3.0    8.0       None   373261.58  31\n1                                                              2001.0    3.0    9.0       None   302712.47  42\n2                                                              2001.0    3.0    NaN       None   684232.20   8\n3                                                              2001.0    4.0   10.0       None   384034.01  27\n4                                                              2001.0    4.0   11.0       None   506742.17  14\n5                                                              2001.0    4.0   12.0       None   579419.95  10\n6                                                              2001.0    4.0    NaN       None  1470196.13   6\n7                                                              2001.0    NaN    NaN       None  2154428.33   5\n8                                                              2002.0    1.0    NaN       None   464075.72  16\n9                                                              2002.0    2.0    NaN       None   438438.78  19\n10                                                             2002.0    NaN    NaN       None  1029371.12   7\n11                                                                NaN    NaN    NaN       None  3183799.45   4\n12                                        n steseeseationn st     NaN    NaN    NaN       None   236657.70  64\n13                                        prin stoughtbareing     NaN    NaN    NaN       None   222871.16  70\n14                                                       None     NaN    NaN    NaN       None  5300687.52   3\n15                     amalgexporti #2   oughtableeingn stese     NaN    NaN    NaN       None   226334.22  67\n16                     amalgexporti #2                   None     NaN    NaN    NaN       None   409753.06  22\n17                     amalgimporto #2  antioughtationeseeing     NaN    NaN    NaN       None   215036.93  87\n18                     amalgimporto #2                   None     NaN    NaN    NaN       None   386641.78  24\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021232,
                    "execution_time": 0.008229,
                    "compile_time": 8.3e-05,
                    "planning_time": 0.006307
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.022609,
                    "execution_time": 0.009155,
                    "compile_time": 8.5e-05,
                    "planning_time": 0.006609
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" WHERE \"SPEQLITE_TEMP_TABLE_6\".\"RK\" <= 100 ORDER BY \"SPEQLITE_TEMP_TABLE_6\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_QOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"D_MOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"SUMSALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_6\".\"RK\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" AS \"I_BRAND\" , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" AS \"I_PRODUCT_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" AS \"D_QOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" AS \"D_MOY\" , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" AS \"S_STORE_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" AS \"SUMSALES\" , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" AS \"RK\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ORDER BY \"SPEQLITE_TEMP_TABLE_7\".\"I_CATEGORY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_CLASS\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_BRAND\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"I_PRODUCT_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_YEAR\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_QOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"D_MOY\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"S_STORE_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"SUMSALES\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_7\".\"RK\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   i_category i_class          i_brand         i_product_name  d_year  d_qoy  d_moy s_store_id    sumsales  rk\n0                                                              2001.0    3.0    8.0       None   373261.58  31\n1                                                              2001.0    3.0    9.0       None   302712.47  42\n2                                                              2001.0    3.0    NaN       None   684232.20   8\n3                                                              2001.0    4.0   10.0       None   384034.01  27\n4                                                              2001.0    4.0   11.0       None   506742.17  14\n5                                                              2001.0    4.0   12.0       None   579419.95  10\n6                                                              2001.0    4.0    NaN       None  1470196.13   6\n7                                                              2001.0    NaN    NaN       None  2154428.33   5\n8                                                              2002.0    1.0    NaN       None   464075.72  16\n9                                                              2002.0    2.0    NaN       None   438438.78  19\n10                                                             2002.0    NaN    NaN       None  1029371.12   7\n11                                                                NaN    NaN    NaN       None  3183799.45   4\n12                                        n steseeseationn st     NaN    NaN    NaN       None   236657.70  64\n13                                        prin stoughtbareing     NaN    NaN    NaN       None   222871.16  70\n14                                                       None     NaN    NaN    NaN       None  5300687.52   3\n15                     amalgexporti #2   oughtableeingn stese     NaN    NaN    NaN       None   226334.22  67\n16                     amalgexporti #2                   None     NaN    NaN    NaN       None   409753.06  22\n17                     amalgimporto #2  antioughtationeseeing     NaN    NaN    NaN       None   215036.93  87\n18                     amalgimporto #2                   None     NaN    NaN    NaN       None   386641.78  24\n...*/"
    }
]