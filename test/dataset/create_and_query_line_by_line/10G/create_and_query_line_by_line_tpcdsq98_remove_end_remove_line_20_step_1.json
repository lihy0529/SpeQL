[
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id, i_item_desc, i_category, i_class, i_current_price\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_5\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY_COL_6\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS_COL_7\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE_COL_8\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_5\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY_COL_6\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS_COL_7\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE_COL_8\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_5\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY_COL_6\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS_COL_7\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE_COL_8\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n1=1 GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.542597,
                    "execution_time": 0.398765,
                    "compile_time": 0.00064,
                    "planning_time": 0.045629,
                    "create_size": 260
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.810358,
                    "execution_time": 0.406628,
                    "compile_time": 0.180765,
                    "planning_time": 0.118341,
                    "create_size": 260
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_1\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                               i_item_desc i_category    i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAACKKDBAAA                                                                                                                         Quite gross values should send therefore red responsible materials; still norther      Music  classical             2.63    607941.72        0.0458\n1   AAAAAAAAHGFBAAAA                                                                                     Magnetic eyes hold exotic, high points. Now particular losses give again other, previous services. Social, natural co      Music  classical             3.23   1186403.65        0.0895\n2   AAAAAAAACKHAAAAA                             Too old audiences ought to inspect. Times help then. Forces may not become. Strong fires must write. Then big shows shall not fix. Now multiple police challenge most complex      Music  classical             1.04    477249.00        0.0360\n3   AAAAAAAAMBJAAAAA                                                                                                                                                                                           Active lights s      Music  classical             5.12    439690.27        0.0331\n4   AAAAAAAAHFLBBAAA                                                               Preliminary benefits discard global shares; sudden, natural rumours pay women. Separate, ill nations would give children. Separately extens      Music  classical             2.39   1040947.24        0.0785\n5   AAAAAAAAGGJNAAAA                                                                            Confident terms must think objectives; only alternative voters respond old, grateful problems. Times receive old, dead schools      Music  classical            42.56    486700.36        0.0367\n6   AAAAAAAANOJKAAAA                                              Open, normal others encourage so necessary men. Students want at a issues. Able, old boys will drink really different things. Instead small costs used to ma      Music  classical             8.66   1052733.23        0.0794\n7   AAAAAAAAOGDHBAAA                                                                                                           Economic matters pass already in the rows. Today academic goods shall not see probably for the       Music  classical             2.67    492629.36        0.0371\n8   AAAAAAAAEEEOAAAA                                                                                              Considerable, mixed creatures feel much monetary, bright fathers. Considerable songs prefer. Horses choose h      Music  classical             0.82    628676.83        0.0474\n9   AAAAAAAAOCEDAAAA                                                                                                  Months take. Numerous, big companies will make in a papers. Atlantic minutes keep permanently american p      Music  classical            12.18    586088.70        0.0442\n10  AAAAAAAAIBOIAAAA                                                                                                                                                                 Very traditional foundations shall not ta      Music  classical             9.41    413855.86        0.0312\n11  AAAAAAAAKMNJAAAA                                                Objects see else interesting members; full, useful days might remember early. Facts provide. Determined, minor pools cannot conform ago. More given player      Music  classical             6.16    674424.37        0.0509\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019134,
                    "execution_time": 0.00737,
                    "compile_time": 5e-05,
                    "planning_time": 0.005259
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058363,
                    "execution_time": 0.007613,
                    "compile_time": 5e-05,
                    "planning_time": 0.041063
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_1\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                               i_item_desc i_category    i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAACKKDBAAA                                                                                                                         Quite gross values should send therefore red responsible materials; still norther      Music  classical             2.63    607941.72        0.0458\n1   AAAAAAAAHGFBAAAA                                                                                     Magnetic eyes hold exotic, high points. Now particular losses give again other, previous services. Social, natural co      Music  classical             3.23   1186403.65        0.0895\n2   AAAAAAAACKHAAAAA                             Too old audiences ought to inspect. Times help then. Forces may not become. Strong fires must write. Then big shows shall not fix. Now multiple police challenge most complex      Music  classical             1.04    477249.00        0.0360\n3   AAAAAAAAMBJAAAAA                                                                                                                                                                                           Active lights s      Music  classical             5.12    439690.27        0.0331\n4   AAAAAAAAHFLBBAAA                                                               Preliminary benefits discard global shares; sudden, natural rumours pay women. Separate, ill nations would give children. Separately extens      Music  classical             2.39   1040947.24        0.0785\n5   AAAAAAAAGGJNAAAA                                                                            Confident terms must think objectives; only alternative voters respond old, grateful problems. Times receive old, dead schools      Music  classical            42.56    486700.36        0.0367\n6   AAAAAAAANOJKAAAA                                              Open, normal others encourage so necessary men. Students want at a issues. Able, old boys will drink really different things. Instead small costs used to ma      Music  classical             8.66   1052733.23        0.0794\n7   AAAAAAAAOGDHBAAA                                                                                                           Economic matters pass already in the rows. Today academic goods shall not see probably for the       Music  classical             2.67    492629.36        0.0371\n8   AAAAAAAAEEEOAAAA                                                                                              Considerable, mixed creatures feel much monetary, bright fathers. Considerable songs prefer. Horses choose h      Music  classical             0.82    628676.83        0.0474\n9   AAAAAAAAOCEDAAAA                                                                                                  Months take. Numerous, big companies will make in a papers. Atlantic minutes keep permanently american p      Music  classical            12.18    586088.70        0.0442\n10  AAAAAAAAIBOIAAAA                                                                                                                                                                 Very traditional foundations shall not ta      Music  classical             9.41    413855.86        0.0312\n11  AAAAAAAAKMNJAAAA                                                Objects see else interesting members; full, useful days might remember early. Facts provide. Determined, minor pools cannot conform ago. More given player      Music  classical             6.16    674424.37        0.0509\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) and cast('2001-12-31' as date) \nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2001-12-31' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2001-12-31' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.253487,
                    "execution_time": 0.1447,
                    "compile_time": 0.000634,
                    "planning_time": 0.046361,
                    "create_size": 260
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.43985,
                    "execution_time": 0.144365,
                    "compile_time": 0.102904,
                    "planning_time": 0.121042,
                    "create_size": 260
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_2\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                              i_item_desc i_category    i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAOKOPAAAA                                                                                                                                                                         Inland facts get continually. Av      Music  classical             3.03    168689.43        0.0747\n1   AAAAAAAAIALGAAAA                                                                                                         Separate words lead. Political, british banks expect entirely at all natural police. Ready agent      Music  classical             5.15    150464.44        0.0666\n2   AAAAAAAAHAONAAAA                                                                                    Months demonstrate especially factors. Carers act large companies. Predominantly large decades become directly about       Music  classical             0.33    154099.15        0.0682\n3   AAAAAAAAHDOGBAAA      Uncomfortably modern factors start. Almost serious comparisons create appropriate police. Yet happy users must pay general, electronic views. Good, working areas add never scenes. Lines should no      Music  classical             2.60    151661.20        0.0672\n4   AAAAAAAAEPPEAAAA                                                                                                                                 Systems need fully previous, forward barriers. Powerful, young islands i      Music  classical             4.52    173675.32        0.0769\n5   AAAAAAAAAFMHBAAA                                         Pink, other experiences could remember here wings. Recent developments could tell rigid, american organizations. Results must not compete; right american langua      Music  classical             8.22    194574.87        0.0862\n6   AAAAAAAANLPEAAAA  Now free parents determine pretty rates. Weeks offset current women. New, cultural places take systematic, widespread events. Big, young pupils shall not extend adult, level women. Sure judges save a      Music  classical             8.64    121845.23        0.0539\n7   AAAAAAAAMAAHAAAA                                                                                                                                                                                         Especially finan      Music  classical             3.74    187086.24        0.0829\n8   AAAAAAAAJKMIBAAA                                                                                                      Only women would not knock at least social characters. Best popular strengths would win compulsory,      Music  classical            49.68    131272.12        0.0581\n9   AAAAAAAAMEIHBAAA                                                                                                                                                                                                        C      Music  classical             1.74    178540.27        0.0791\n10  AAAAAAAAPFOMAAAA                                                                                                  Large instances shall hunt films. Interests may not speak most on a families. Old, joint languages die       Music  classical            77.70    157293.05        0.0697\n11  AAAAAAAABGNBBAAA                                                            Able institutions will expect usually criminal, likely shares. Miraculously new organisers consider genuinely administrative wives. Just init      Music  classical             5.13    149755.53        0.0663\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.0188,
                    "execution_time": 0.007173,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.005244
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05867,
                    "execution_time": 0.007889,
                    "compile_time": 5e-05,
                    "planning_time": 0.04126
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST('2001-12-31' AS DATE) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_2\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                              i_item_desc i_category    i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAOKOPAAAA                                                                                                                                                                         Inland facts get continually. Av      Music  classical             3.03    168689.43        0.0747\n1   AAAAAAAAIALGAAAA                                                                                                         Separate words lead. Political, british banks expect entirely at all natural police. Ready agent      Music  classical             5.15    150464.44        0.0666\n2   AAAAAAAAHAONAAAA                                                                                    Months demonstrate especially factors. Carers act large companies. Predominantly large decades become directly about       Music  classical             0.33    154099.15        0.0682\n3   AAAAAAAAHDOGBAAA      Uncomfortably modern factors start. Almost serious comparisons create appropriate police. Yet happy users must pay general, electronic views. Good, working areas add never scenes. Lines should no      Music  classical             2.60    151661.20        0.0672\n4   AAAAAAAAEPPEAAAA                                                                                                                                 Systems need fully previous, forward barriers. Powerful, young islands i      Music  classical             4.52    173675.32        0.0769\n5   AAAAAAAAAFMHBAAA                                         Pink, other experiences could remember here wings. Recent developments could tell rigid, american organizations. Results must not compete; right american langua      Music  classical             8.22    194574.87        0.0862\n6   AAAAAAAANLPEAAAA  Now free parents determine pretty rates. Weeks offset current women. New, cultural places take systematic, widespread events. Big, young pupils shall not extend adult, level women. Sure judges save a      Music  classical             8.64    121845.23        0.0539\n7   AAAAAAAAMAAHAAAA                                                                                                                                                                                         Especially finan      Music  classical             3.74    187086.24        0.0829\n8   AAAAAAAAJKMIBAAA                                                                                                      Only women would not knock at least social characters. Best popular strengths would win compulsory,      Music  classical            49.68    131272.12        0.0581\n9   AAAAAAAAMEIHBAAA                                                                                                                                                                                                        C      Music  classical             1.74    178540.27        0.0791\n10  AAAAAAAAPFOMAAAA                                                                                                  Large instances shall hunt films. Interests may not speak most on a families. Old, joint languages die       Music  classical            77.70    157293.05        0.0697\n11  AAAAAAAABGNBBAAA                                                            Able institutions will expect usually criminal, likely shares. Miraculously new organisers consider genuinely administrative wives. Just init      Music  classical             5.13    149755.53        0.0663\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAALEEBAAA                                                                                                                                                   Later left spirits must not upgrade certainly as      Music                     4.87     16839.32        5.6081\n1   AAAAAAAAEEPDAAAA  Illegal, southern circumstances constitute. Schemes may see. Organizations survive to a objects. Soldiers can cause foundations. Naval, aware scientists may generate big big honours; all natura      Shoes                     7.02      3777.98        1.2582\n2   AAAAAAAAEGEFAAAA                                           Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN     24314.74        8.0977\n3   AAAAAAAAODKFAAAA                                                                                                                                                                                                         Music                      NaN     11801.96        3.9304\n4   AAAAAAAAPHCHAAAA                                                                                                                                                                                                           Men                      NaN     20533.50        6.8384\n5   AAAAAAAANOHAAAAA                                                                                                  Goods will not comply for the facts; social, true girls ought to know now for a topics. Babies wo      Music                      NaN      9989.20        3.3267\n6   AAAAAAAAOGDMAAAA                                                                                                                                                                                                         Music                     9.32     11717.02        3.9022\n7   AAAAAAAAIFDJAAAA                                                                                                                                                                                                         Music                      NaN      5089.80        1.6950\n8   AAAAAAAAGIGEBAAA                                                                                                                                                                                        At least sm        Men                      NaN     22643.83        7.5412\n9   AAAAAAAAKDPABAAA                                                                                                                                                                                                 Fu      Shoes                      NaN     13686.42        4.5580\n10  AAAAAAAANIFFAAAA                                                                                                                                                                        Years could follow local, s      Music                      NaN     12209.40        4.0661\n11  AAAAAAAAABLKAAAA                                          Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43      4990.88        1.6621\n12  AAAAAAAAKGCBAAAA                                                                                         Always industrial systems should not believe of course hard fingers. Either overall drawings appear increa      Music                     4.44     11074.23        3.6881\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.101844,
                    "execution_time": 0.044141,
                    "compile_time": 0.000266,
                    "planning_time": 0.041984
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.175001,
                    "execution_time": 0.046737,
                    "compile_time": 0.000279,
                    "planning_time": 0.110337
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAALEEBAAA                                                                                                                                                   Later left spirits must not upgrade certainly as      Music                     4.87     16839.32        5.6081\n1   AAAAAAAAEEPDAAAA  Illegal, southern circumstances constitute. Schemes may see. Organizations survive to a objects. Soldiers can cause foundations. Naval, aware scientists may generate big big honours; all natura      Shoes                     7.02      3777.98        1.2582\n2   AAAAAAAAEGEFAAAA                                           Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN     24314.74        8.0977\n3   AAAAAAAAODKFAAAA                                                                                                                                                                                                         Music                      NaN     11801.96        3.9304\n4   AAAAAAAAPHCHAAAA                                                                                                                                                                                                           Men                      NaN     20533.50        6.8384\n5   AAAAAAAANOHAAAAA                                                                                                  Goods will not comply for the facts; social, true girls ought to know now for a topics. Babies wo      Music                      NaN      9989.20        3.3267\n6   AAAAAAAAOGDMAAAA                                                                                                                                                                                                         Music                     9.32     11717.02        3.9022\n7   AAAAAAAAIFDJAAAA                                                                                                                                                                                                         Music                      NaN      5089.80        1.6950\n8   AAAAAAAAGIGEBAAA                                                                                                                                                                                        At least sm        Men                      NaN     22643.83        7.5412\n9   AAAAAAAAKDPABAAA                                                                                                                                                                                                 Fu      Shoes                      NaN     13686.42        4.5580\n10  AAAAAAAANIFFAAAA                                                                                                                                                                        Years could follow local, s      Music                      NaN     12209.40        4.0661\n11  AAAAAAAAABLKAAAA                                          Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43      4990.88        1.6621\n12  AAAAAAAAKGCBAAAA                                                                                         Always industrial systems should not believe of course hard fingers. Either overall drawings appear increa      Music                     4.44     11074.23        3.6881\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAEGEFAAAA                                           Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN     24314.74        8.0977\n1   AAAAAAAAODKFAAAA                                                                                                                                                                                                         Music                      NaN     11801.96        3.9304\n2   AAAAAAAAMIDLAAAA                                                                                                                                                                                                           Men                     2.56      7203.27        2.3989\n3   AAAAAAAAEEPDAAAA  Illegal, southern circumstances constitute. Schemes may see. Organizations survive to a objects. Soldiers can cause foundations. Naval, aware scientists may generate big big honours; all natura      Shoes                     7.02      3777.98        1.2582\n4   AAAAAAAADGOLAAAA                                                                                                                                                                                    Over new wars g      Music                      NaN      5088.04        1.6945\n5   AAAAAAAAIFDJAAAA                                                                                                                                                                                                         Music                      NaN      5089.80        1.6950\n6   AAAAAAAAEJDJAAAA                                                                            More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN     17492.25        5.8255\n7   AAAAAAAAHOEPAAAA                                                              Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     10433.22        3.4746\n8   AAAAAAAADJBFBAAA                                                                                                   Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     18363.26        6.1156\n9   AAAAAAAAOGDMAAAA                                                                                                                                                                                                         Music                     9.32     11717.02        3.9022\n10  AAAAAAAAGAKDAAAA                                   Left, recent restrictions result only other forms. Agents ensure likely points. Signs could not seem more than free hours. Forces make black, christian arrangem      Music                      NaN     17916.54        5.9668\n11  AAAAAAAAPHCHAAAA                                                                                                                                                                                                           Men                      NaN     20533.50        6.8384\n12  AAAAAAAAALEEBAAA                                                                                                                                                   Later left spirits must not upgrade certainly as      Music                     4.87     16839.32        5.6081\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.102778,
                    "execution_time": 0.044379,
                    "compile_time": 0.000288,
                    "planning_time": 0.042228
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.10405,
                    "execution_time": 0.04545,
                    "compile_time": 0.000279,
                    "planning_time": 0.04228
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAEGEFAAAA                                           Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN     24314.74        8.0977\n1   AAAAAAAAODKFAAAA                                                                                                                                                                                                         Music                      NaN     11801.96        3.9304\n2   AAAAAAAAMIDLAAAA                                                                                                                                                                                                           Men                     2.56      7203.27        2.3989\n3   AAAAAAAAEEPDAAAA  Illegal, southern circumstances constitute. Schemes may see. Organizations survive to a objects. Soldiers can cause foundations. Naval, aware scientists may generate big big honours; all natura      Shoes                     7.02      3777.98        1.2582\n4   AAAAAAAADGOLAAAA                                                                                                                                                                                    Over new wars g      Music                      NaN      5088.04        1.6945\n5   AAAAAAAAIFDJAAAA                                                                                                                                                                                                         Music                      NaN      5089.80        1.6950\n6   AAAAAAAAEJDJAAAA                                                                            More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN     17492.25        5.8255\n7   AAAAAAAAHOEPAAAA                                                              Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     10433.22        3.4746\n8   AAAAAAAADJBFBAAA                                                                                                   Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     18363.26        6.1156\n9   AAAAAAAAOGDMAAAA                                                                                                                                                                                                         Music                     9.32     11717.02        3.9022\n10  AAAAAAAAGAKDAAAA                                   Left, recent restrictions result only other forms. Agents ensure likely points. Signs could not seem more than free hours. Forces make black, christian arrangem      Music                      NaN     17916.54        5.9668\n11  AAAAAAAAPHCHAAAA                                                                                                                                                                                                           Men                      NaN     20533.50        6.8384\n12  AAAAAAAAALEEBAAA                                                                                                                                                   Later left spirits must not upgrade certainly as      Music                     4.87     16839.32        5.6081\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id, i_item_desc, i_category, i_class, i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAANOHAAAAA                                                                                                  Goods will not comply for the facts; social, true girls ought to know now for a topics. Babies wo      Music                      NaN      9989.20        3.3267\n1   AAAAAAAAEGEFAAAA                                           Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN     24314.74        8.0977\n2   AAAAAAAAALEEBAAA                                                                                                                                                   Later left spirits must not upgrade certainly as      Music                     4.87     16839.32        5.6081\n3   AAAAAAAADJBFBAAA                                                                                                   Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     18363.26        6.1156\n4   AAAAAAAAEEPDAAAA  Illegal, southern circumstances constitute. Schemes may see. Organizations survive to a objects. Soldiers can cause foundations. Naval, aware scientists may generate big big honours; all natura      Shoes                     7.02      3777.98        1.2582\n5   AAAAAAAAODKFAAAA                                                                                                                                                                                                         Music                      NaN     11801.96        3.9304\n6   AAAAAAAAPHCHAAAA                                                                                                                                                                                                           Men                      NaN     20533.50        6.8384\n7   AAAAAAAAEJDJAAAA                                                                            More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN     17492.25        5.8255\n8   AAAAAAAAMIDLAAAA                                                                                                                                                                                                           Men                     2.56      7203.27        2.3989\n9   AAAAAAAAHOEPAAAA                                                              Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     10433.22        3.4746\n10  AAAAAAAAIFDJAAAA                                                                                                                                                                                                         Music                      NaN      5089.80        1.6950\n11  AAAAAAAAABLKAAAA                                          Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43      4990.88        1.6621\n12  AAAAAAAAOAEABAAA                                                                                                                                                                                                         Shoes                    60.87      8369.25        2.7872\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.102775,
                    "execution_time": 0.042079,
                    "compile_time": 0.000285,
                    "planning_time": 0.044111
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.103813,
                    "execution_time": 0.045574,
                    "compile_time": 0.000279,
                    "planning_time": 0.042003
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAANOHAAAAA                                                                                                  Goods will not comply for the facts; social, true girls ought to know now for a topics. Babies wo      Music                      NaN      9989.20        3.3267\n1   AAAAAAAAEGEFAAAA                                           Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN     24314.74        8.0977\n2   AAAAAAAAALEEBAAA                                                                                                                                                   Later left spirits must not upgrade certainly as      Music                     4.87     16839.32        5.6081\n3   AAAAAAAADJBFBAAA                                                                                                   Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     18363.26        6.1156\n4   AAAAAAAAEEPDAAAA  Illegal, southern circumstances constitute. Schemes may see. Organizations survive to a objects. Soldiers can cause foundations. Naval, aware scientists may generate big big honours; all natura      Shoes                     7.02      3777.98        1.2582\n5   AAAAAAAAODKFAAAA                                                                                                                                                                                                         Music                      NaN     11801.96        3.9304\n6   AAAAAAAAPHCHAAAA                                                                                                                                                                                                           Men                      NaN     20533.50        6.8384\n7   AAAAAAAAEJDJAAAA                                                                            More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN     17492.25        5.8255\n8   AAAAAAAAMIDLAAAA                                                                                                                                                                                                           Men                     2.56      7203.27        2.3989\n9   AAAAAAAAHOEPAAAA                                                              Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     10433.22        3.4746\n10  AAAAAAAAIFDJAAAA                                                                                                                                                                                                         Music                      NaN      5089.80        1.6950\n11  AAAAAAAAABLKAAAA                                          Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43      4990.88        1.6621\n12  AAAAAAAAOAEABAAA                                                                                                                                                                                                         Shoes                    60.87      8369.25        2.7872\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAEEPDAAAA  Illegal, southern circumstances constitute. Schemes may see. Organizations survive to a objects. Soldiers can cause foundations. Naval, aware scientists may generate big big honours; all natura      Shoes                     7.02      3777.98        1.2582\n1   AAAAAAAAEGEFAAAA                                           Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN     24314.74        8.0977\n2   AAAAAAAAODKFAAAA                                                                                                                                                                                                         Music                      NaN     11801.96        3.9304\n3   AAAAAAAAPHCHAAAA                                                                                                                                                                                                           Men                      NaN     20533.50        6.8384\n4   AAAAAAAAGIGEBAAA                                                                                                                                                                                        At least sm        Men                      NaN     22643.83        7.5412\n5   AAAAAAAAMIDLAAAA                                                                                                                                                                                                           Men                     2.56      7203.27        2.3989\n6   AAAAAAAADGOLAAAA                                                                                                                                                                                    Over new wars g      Music                      NaN      5088.04        1.6945\n7   AAAAAAAAEJDJAAAA                                                                            More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN     17492.25        5.8255\n8   AAAAAAAAIFDJAAAA                                                                                                                                                                                                         Music                      NaN      5089.80        1.6950\n9   AAAAAAAAALEEBAAA                                                                                                                                                   Later left spirits must not upgrade certainly as      Music                     4.87     16839.32        5.6081\n10  AAAAAAAAGAKDAAAA                                   Left, recent restrictions result only other forms. Agents ensure likely points. Signs could not seem more than free hours. Forces make black, christian arrangem      Music                      NaN     17916.54        5.9668\n11  AAAAAAAAABLKAAAA                                          Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43      4990.88        1.6621\n12  AAAAAAAAOAEABAAA                                                                                                                                                                                                         Shoes                    60.87      8369.25        2.7872\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.103015,
                    "execution_time": 0.043476,
                    "compile_time": 0.000281,
                    "planning_time": 0.043323
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.107434,
                    "execution_time": 0.042796,
                    "compile_time": 0.000293,
                    "planning_time": 0.047856
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAEEPDAAAA  Illegal, southern circumstances constitute. Schemes may see. Organizations survive to a objects. Soldiers can cause foundations. Naval, aware scientists may generate big big honours; all natura      Shoes                     7.02      3777.98        1.2582\n1   AAAAAAAAEGEFAAAA                                           Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN     24314.74        8.0977\n2   AAAAAAAAODKFAAAA                                                                                                                                                                                                         Music                      NaN     11801.96        3.9304\n3   AAAAAAAAPHCHAAAA                                                                                                                                                                                                           Men                      NaN     20533.50        6.8384\n4   AAAAAAAAGIGEBAAA                                                                                                                                                                                        At least sm        Men                      NaN     22643.83        7.5412\n5   AAAAAAAAMIDLAAAA                                                                                                                                                                                                           Men                     2.56      7203.27        2.3989\n6   AAAAAAAADGOLAAAA                                                                                                                                                                                    Over new wars g      Music                      NaN      5088.04        1.6945\n7   AAAAAAAAEJDJAAAA                                                                            More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN     17492.25        5.8255\n8   AAAAAAAAIFDJAAAA                                                                                                                                                                                                         Music                      NaN      5089.80        1.6950\n9   AAAAAAAAALEEBAAA                                                                                                                                                   Later left spirits must not upgrade certainly as      Music                     4.87     16839.32        5.6081\n10  AAAAAAAAGAKDAAAA                                   Left, recent restrictions result only other forms. Agents ensure likely points. Signs could not seem more than free hours. Forces make black, christian arrangem      Music                      NaN     17916.54        5.9668\n11  AAAAAAAAABLKAAAA                                          Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43      4990.88        1.6621\n12  AAAAAAAAOAEABAAA                                                                                                                                                                                                         Shoes                    60.87      8369.25        2.7872\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class \n        ,i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAEGEFAAAA                                           Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN     24314.74        8.0977\n1   AAAAAAAAODKFAAAA                                                                                                                                                                                                         Music                      NaN     11801.96        3.9304\n2   AAAAAAAAIFDJAAAA                                                                                                                                                                                                         Music                      NaN      5089.80        1.6950\n3   AAAAAAAAGIGEBAAA                                                                                                                                                                                        At least sm        Men                      NaN     22643.83        7.5412\n4   AAAAAAAAEJDJAAAA                                                                            More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN     17492.25        5.8255\n5   AAAAAAAAABLKAAAA                                          Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43      4990.88        1.6621\n6   AAAAAAAAHOEPAAAA                                                              Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     10433.22        3.4746\n7   AAAAAAAADJBFBAAA                                                                                                   Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     18363.26        6.1156\n8   AAAAAAAADGOLAAAA                                                                                                                                                                                    Over new wars g      Music                      NaN      5088.04        1.6945\n9   AAAAAAAAEOEIBAAA                                                                                                                                                                                     Total, very fo        Men                    12.72      7023.47        2.3390\n10  AAAAAAAAGAKDAAAA                                   Left, recent restrictions result only other forms. Agents ensure likely points. Signs could not seem more than free hours. Forces make black, christian arrangem      Music                      NaN     17916.54        5.9668\n11  AAAAAAAAOAEABAAA                                                                                                                                                                                                         Shoes                    60.87      8369.25        2.7872\n12  AAAAAAAAKKIFBAAA                                                                                                                                                                                                           Men                      NaN      4496.24        1.4974\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.105475,
                    "execution_time": 0.04415,
                    "compile_time": 0.000284,
                    "planning_time": 0.044698
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.10588,
                    "execution_time": 0.046241,
                    "compile_time": 0.000288,
                    "planning_time": 0.042929
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAEGEFAAAA                                           Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN     24314.74        8.0977\n1   AAAAAAAAODKFAAAA                                                                                                                                                                                                         Music                      NaN     11801.96        3.9304\n2   AAAAAAAAIFDJAAAA                                                                                                                                                                                                         Music                      NaN      5089.80        1.6950\n3   AAAAAAAAGIGEBAAA                                                                                                                                                                                        At least sm        Men                      NaN     22643.83        7.5412\n4   AAAAAAAAEJDJAAAA                                                                            More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN     17492.25        5.8255\n5   AAAAAAAAABLKAAAA                                          Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43      4990.88        1.6621\n6   AAAAAAAAHOEPAAAA                                                              Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     10433.22        3.4746\n7   AAAAAAAADJBFBAAA                                                                                                   Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     18363.26        6.1156\n8   AAAAAAAADGOLAAAA                                                                                                                                                                                    Over new wars g      Music                      NaN      5088.04        1.6945\n9   AAAAAAAAEOEIBAAA                                                                                                                                                                                     Total, very fo        Men                    12.72      7023.47        2.3390\n10  AAAAAAAAGAKDAAAA                                   Left, recent restrictions result only other forms. Agents ensure likely points. Signs could not seem more than free hours. Forces make black, christian arrangem      Music                      NaN     17916.54        5.9668\n11  AAAAAAAAOAEABAAA                                                                                                                                                                                                         Shoes                    60.87      8369.25        2.7872\n12  AAAAAAAAKKIFBAAA                                                                                                                                                                                                           Men                      NaN      4496.24        1.4974\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAALEEBAAA                                                                                                                                                   Later left spirits must not upgrade certainly as      Music                     4.87     16839.32        5.6081\n1   AAAAAAAAEGEFAAAA                                           Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN     24314.74        8.0977\n2   AAAAAAAAEEPDAAAA  Illegal, southern circumstances constitute. Schemes may see. Organizations survive to a objects. Soldiers can cause foundations. Naval, aware scientists may generate big big honours; all natura      Shoes                     7.02      3777.98        1.2582\n3   AAAAAAAADJBFBAAA                                                                                                   Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     18363.26        6.1156\n4   AAAAAAAAPHCHAAAA                                                                                                                                                                                                           Men                      NaN     20533.50        6.8384\n5   AAAAAAAAIFDJAAAA                                                                                                                                                                                                         Music                      NaN      5089.80        1.6950\n6   AAAAAAAAHOEPAAAA                                                              Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     10433.22        3.4746\n7   AAAAAAAANOHAAAAA                                                                                                  Goods will not comply for the facts; social, true girls ought to know now for a topics. Babies wo      Music                      NaN      9989.20        3.3267\n8   AAAAAAAAODKFAAAA                                                                                                                                                                                                         Music                      NaN     11801.96        3.9304\n9   AAAAAAAAEOEIBAAA                                                                                                                                                                                     Total, very fo        Men                    12.72      7023.47        2.3390\n10  AAAAAAAAOGDMAAAA                                                                                                                                                                                                         Music                     9.32     11717.02        3.9022\n11  AAAAAAAADGOLAAAA                                                                                                                                                                                    Over new wars g      Music                      NaN      5088.04        1.6945\n12  AAAAAAAAGIGEBAAA                                                                                                                                                                                        At least sm        Men                      NaN     22643.83        7.5412\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.10076,
                    "execution_time": 0.040556,
                    "compile_time": 0.000285,
                    "planning_time": 0.04388
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.117516,
                    "execution_time": 0.042625,
                    "compile_time": 0.0003,
                    "planning_time": 0.058169
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAALEEBAAA                                                                                                                                                   Later left spirits must not upgrade certainly as      Music                     4.87     16839.32        5.6081\n1   AAAAAAAAEGEFAAAA                                           Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN     24314.74        8.0977\n2   AAAAAAAAEEPDAAAA  Illegal, southern circumstances constitute. Schemes may see. Organizations survive to a objects. Soldiers can cause foundations. Naval, aware scientists may generate big big honours; all natura      Shoes                     7.02      3777.98        1.2582\n3   AAAAAAAADJBFBAAA                                                                                                   Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     18363.26        6.1156\n4   AAAAAAAAPHCHAAAA                                                                                                                                                                                                           Men                      NaN     20533.50        6.8384\n5   AAAAAAAAIFDJAAAA                                                                                                                                                                                                         Music                      NaN      5089.80        1.6950\n6   AAAAAAAAHOEPAAAA                                                              Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     10433.22        3.4746\n7   AAAAAAAANOHAAAAA                                                                                                  Goods will not comply for the facts; social, true girls ought to know now for a topics. Babies wo      Music                      NaN      9989.20        3.3267\n8   AAAAAAAAODKFAAAA                                                                                                                                                                                                         Music                      NaN     11801.96        3.9304\n9   AAAAAAAAEOEIBAAA                                                                                                                                                                                     Total, very fo        Men                    12.72      7023.47        2.3390\n10  AAAAAAAAOGDMAAAA                                                                                                                                                                                                         Music                     9.32     11717.02        3.9022\n11  AAAAAAAADGOLAAAA                                                                                                                                                                                    Over new wars g      Music                      NaN      5088.04        1.6945\n12  AAAAAAAAGIGEBAAA                                                                                                                                                                                        At least sm        Men                      NaN     22643.83        7.5412\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAEGEFAAAA                                           Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN     24314.74        8.0977\n1   AAAAAAAAIFDJAAAA                                                                                                                                                                                                         Music                      NaN      5089.80        1.6950\n2   AAAAAAAAPHCHAAAA                                                                                                                                                                                                           Men                      NaN     20533.50        6.8384\n3   AAAAAAAAABLKAAAA                                          Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43      4990.88        1.6621\n4   AAAAAAAAEEPDAAAA  Illegal, southern circumstances constitute. Schemes may see. Organizations survive to a objects. Soldiers can cause foundations. Naval, aware scientists may generate big big honours; all natura      Shoes                     7.02      3777.98        1.2582\n5   AAAAAAAAHOEPAAAA                                                              Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     10433.22        3.4746\n6   AAAAAAAADJBFBAAA                                                                                                   Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     18363.26        6.1156\n7   AAAAAAAAEOEIBAAA                                                                                                                                                                                     Total, very fo        Men                    12.72      7023.47        2.3390\n8   AAAAAAAAALEEBAAA                                                                                                                                                   Later left spirits must not upgrade certainly as      Music                     4.87     16839.32        5.6081\n9   AAAAAAAAOGDMAAAA                                                                                                                                                                                                         Music                     9.32     11717.02        3.9022\n10  AAAAAAAAMIDLAAAA                                                                                                                                                                                                           Men                     2.56      7203.27        2.3989\n11  AAAAAAAADGOLAAAA                                                                                                                                                                                    Over new wars g      Music                      NaN      5088.04        1.6945\n12  AAAAAAAAODKFAAAA                                                                                                                                                                                                         Music                      NaN     11801.96        3.9304\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.103853,
                    "execution_time": 0.042989,
                    "compile_time": 0.000293,
                    "planning_time": 0.044127
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.106755,
                    "execution_time": 0.042723,
                    "compile_time": 0.000292,
                    "planning_time": 0.047337
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAEGEFAAAA                                           Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN     24314.74        8.0977\n1   AAAAAAAAIFDJAAAA                                                                                                                                                                                                         Music                      NaN      5089.80        1.6950\n2   AAAAAAAAPHCHAAAA                                                                                                                                                                                                           Men                      NaN     20533.50        6.8384\n3   AAAAAAAAABLKAAAA                                          Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43      4990.88        1.6621\n4   AAAAAAAAEEPDAAAA  Illegal, southern circumstances constitute. Schemes may see. Organizations survive to a objects. Soldiers can cause foundations. Naval, aware scientists may generate big big honours; all natura      Shoes                     7.02      3777.98        1.2582\n5   AAAAAAAAHOEPAAAA                                                              Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN     10433.22        3.4746\n6   AAAAAAAADJBFBAAA                                                                                                   Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN     18363.26        6.1156\n7   AAAAAAAAEOEIBAAA                                                                                                                                                                                     Total, very fo        Men                    12.72      7023.47        2.3390\n8   AAAAAAAAALEEBAAA                                                                                                                                                   Later left spirits must not upgrade certainly as      Music                     4.87     16839.32        5.6081\n9   AAAAAAAAOGDMAAAA                                                                                                                                                                                                         Music                     9.32     11717.02        3.9022\n10  AAAAAAAAMIDLAAAA                                                                                                                                                                                                           Men                     2.56      7203.27        2.3989\n11  AAAAAAAADGOLAAAA                                                                                                                                                                                    Over new wars g      Music                      NaN      5088.04        1.6945\n12  AAAAAAAAODKFAAAA                                                                                                                                                                                                         Music                      NaN     11801.96        3.9304\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n    i_item_id /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_ITEM_ID NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category         i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAAAABAAA        Outside waste minutes make for a men. Grand, suitable citizens raise merely within the officials. Minutes may not represent in part with a officials. Old, social resources may not catch r        Men          shirts             7.87       902.55        0.0070\n1   AAAAAAAAAAADBAAA                      Always video-taped parties talk recently junior students. Special, principal cases hurt. Exciting results mean then following circumstances. Payments can fail much with a sy      Shoes        athletic             3.23     18770.32        0.1523\n2   AAAAAAAAAAAEBAAA                                                                                                                                             Industrial, free movies add more; contributions explai        Men          shirts             5.93      8477.78        0.0660\n3   AAAAAAAAAAAGBAAA                          Oddly social creditors could become twice supposed original writers. Members play there. For instance electoral firms will not understand too literary, underlying prices        Men           pants             4.88      8716.09        0.0727\n4   AAAAAAAAAAALAAAA                                                                                                                                              Now major examples show. Products would not lobby the      Shoes          womens             1.66     18702.08        0.1414\n5   AAAAAAAAAABBAAAA                                                                                                                                                                                    Recent discussi      Music         country             5.37      8912.25        0.0730\n6   AAAAAAAAAABDAAAA                                                                                                 Extended, central centuries ought to predict thus early controls; so financial years shall not see        Men  sports-apparel             1.36      6383.63        0.0518\n7   AAAAAAAAAABEAAAA                                                                                                       New meetings discuss also occasional, corporate approaches. Specialist, mixed groups ought t      Music       classical             8.23     14120.80        0.1117\n8   AAAAAAAAAABIBAAA                Major scientists can see other windows. Free, small holes shall safeguard just total, strange shares. Blue cats ask however. Mysterious, corporate days would pass. French lives ex        Men  sports-apparel             1.17     13427.35        0.1090\n9   AAAAAAAAAABJAAAA                                                                                                                                                      Specified topics accept british values. Fierc      Shoes            mens             7.54      6939.31        0.0539\n10  AAAAAAAAAABKAAAA                                               Then total travellers shall not want only employers. Deep relatives will rectify completely growing, other camps. Concerned, social members would no        Men           pants             3.42     17082.05        0.1425\n11  AAAAAAAAAACAAAAA                                                     Magnetic years should not interpret then at the fingers. Bright stands could work yesterday supreme, reasonable details. Scientific, great lev      Shoes          womens             3.34     12575.89        0.0951\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.102379,
                    "execution_time": 0.043405,
                    "compile_time": 0.000354,
                    "planning_time": 0.042051
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.172645,
                    "execution_time": 0.044615,
                    "compile_time": 0.000322,
                    "planning_time": 0.110364
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_ITEM_ID\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category         i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAAAABAAA        Outside waste minutes make for a men. Grand, suitable citizens raise merely within the officials. Minutes may not represent in part with a officials. Old, social resources may not catch r        Men          shirts             7.87       902.55        0.0070\n1   AAAAAAAAAAADBAAA                      Always video-taped parties talk recently junior students. Special, principal cases hurt. Exciting results mean then following circumstances. Payments can fail much with a sy      Shoes        athletic             3.23     18770.32        0.1523\n2   AAAAAAAAAAAEBAAA                                                                                                                                             Industrial, free movies add more; contributions explai        Men          shirts             5.93      8477.78        0.0660\n3   AAAAAAAAAAAGBAAA                          Oddly social creditors could become twice supposed original writers. Members play there. For instance electoral firms will not understand too literary, underlying prices        Men           pants             4.88      8716.09        0.0727\n4   AAAAAAAAAAALAAAA                                                                                                                                              Now major examples show. Products would not lobby the      Shoes          womens             1.66     18702.08        0.1414\n5   AAAAAAAAAABBAAAA                                                                                                                                                                                    Recent discussi      Music         country             5.37      8912.25        0.0730\n6   AAAAAAAAAABDAAAA                                                                                                 Extended, central centuries ought to predict thus early controls; so financial years shall not see        Men  sports-apparel             1.36      6383.63        0.0518\n7   AAAAAAAAAABEAAAA                                                                                                       New meetings discuss also occasional, corporate approaches. Specialist, mixed groups ought t      Music       classical             8.23     14120.80        0.1117\n8   AAAAAAAAAABIBAAA                Major scientists can see other windows. Free, small holes shall safeguard just total, strange shares. Blue cats ask however. Mysterious, corporate days would pass. French lives ex        Men  sports-apparel             1.17     13427.35        0.1090\n9   AAAAAAAAAABJAAAA                                                                                                                                                      Specified topics accept british values. Fierc      Shoes            mens             7.54      6939.31        0.0539\n10  AAAAAAAAAABKAAAA                                               Then total travellers shall not want only employers. Deep relatives will rectify completely growing, other camps. Concerned, social members would no        Men           pants             3.42     17082.05        0.1425\n11  AAAAAAAAAACAAAAA                                                     Magnetic years should not interpret then at the fingers. Bright stands could work yesterday supreme, reasonable details. Scientific, great lev      Shoes          womens             3.34     12575.89        0.0951\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                           i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAPLHEAAAA                                                   Years find almost. Thus blue signs identify suddenly. Minor communications can prepare about rapidly electrical aspects. Massive changes please rep        Men  accessories             4.76      4011.36        0.0305\n1   AAAAAAAAOIGBAAAA                                                                           Financial, firm parents listen rough, other facilities. Common, bad miles could not recall therefore then central streets.         Men        pants             9.00      8608.70        0.0718\n2   AAAAAAAACKBPAAAA                    Universities may get with a ways. Short organs say. Once growing times ought to stand systems. Subjective, apparent laws refuse unfortunately whole injuries. Concerned organisms         Men  accessories             6.41      3669.29        0.0279\n3   AAAAAAAAPADDBAAA                                                                                                     Premier, white divisions would not leave local, able reports. Towns could cost widely often sound        Men        pants             4.82     17006.52        0.1419\n4   AAAAAAAAIMJLAAAA                                                                                      Nerves remember generally; never new windows remind low, long branches. Too generous hands leave somewhere parti        Men  accessories            30.94     13109.09        0.0997\n5   AAAAAAAAKAJCBAAA                                                                         Unlikely, european requirements will fill too; powerful tests sell literally on a concerns. Gmt little police need far ultima        Men        pants             8.73      5091.73        0.0424\n6   AAAAAAAAFCAAAAAA  Clearly due proceedings should compensate particular, main agreements. Heels may not deny later easily different spaces; vast, additional items might export fresh, only sentences. Patients expand         Men  accessories             2.42      3628.38        0.0276\n7   AAAAAAAAJBECAAAA                                                                                                                                                                             Workers could reveal more        Men        pants             6.04      7736.74        0.0645\n8   AAAAAAAABONGAAAA                                                      Social results would take boundaries; purposes make also. Traders shall perform all industrial, economic groups. Keys must not attend distinct c        Men  accessories             1.55      2749.24        0.0209\n9   AAAAAAAAIFIEBAAA                                                                                        Perhaps sick examples could not increase also fundamentally wonderful ears. There neighbouring techniques go a        Men        pants             4.18     25754.82        0.2149\n10  AAAAAAAAIIFDBAAA                                                                      Continuous times may involve easily french activities; as remote effects will say never; already senior children used to challen        Men  accessories             5.26     11956.88        0.0909\n11  AAAAAAAADMLEBAAA                                     Backs put to the patients. European, scottish women might restrict once big relatives; black lips can last usually. Busy products would feel here powerful, clear        Men        pants             1.84     19409.16        0.1619\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.106634,
                    "execution_time": 0.046142,
                    "compile_time": 0.000332,
                    "planning_time": 0.043529
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.174956,
                    "execution_time": 0.046367,
                    "compile_time": 0.000332,
                    "planning_time": 0.110795
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                           i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAPLHEAAAA                                                   Years find almost. Thus blue signs identify suddenly. Minor communications can prepare about rapidly electrical aspects. Massive changes please rep        Men  accessories             4.76      4011.36        0.0305\n1   AAAAAAAAOIGBAAAA                                                                           Financial, firm parents listen rough, other facilities. Common, bad miles could not recall therefore then central streets.         Men        pants             9.00      8608.70        0.0718\n2   AAAAAAAACKBPAAAA                    Universities may get with a ways. Short organs say. Once growing times ought to stand systems. Subjective, apparent laws refuse unfortunately whole injuries. Concerned organisms         Men  accessories             6.41      3669.29        0.0279\n3   AAAAAAAAPADDBAAA                                                                                                     Premier, white divisions would not leave local, able reports. Towns could cost widely often sound        Men        pants             4.82     17006.52        0.1419\n4   AAAAAAAAIMJLAAAA                                                                                      Nerves remember generally; never new windows remind low, long branches. Too generous hands leave somewhere parti        Men  accessories            30.94     13109.09        0.0997\n5   AAAAAAAAKAJCBAAA                                                                         Unlikely, european requirements will fill too; powerful tests sell literally on a concerns. Gmt little police need far ultima        Men        pants             8.73      5091.73        0.0424\n6   AAAAAAAAFCAAAAAA  Clearly due proceedings should compensate particular, main agreements. Heels may not deny later easily different spaces; vast, additional items might export fresh, only sentences. Patients expand         Men  accessories             2.42      3628.38        0.0276\n7   AAAAAAAAJBECAAAA                                                                                                                                                                             Workers could reveal more        Men        pants             6.04      7736.74        0.0645\n8   AAAAAAAABONGAAAA                                                      Social results would take boundaries; purposes make also. Traders shall perform all industrial, economic groups. Keys must not attend distinct c        Men  accessories             1.55      2749.24        0.0209\n9   AAAAAAAAIFIEBAAA                                                                                        Perhaps sick examples could not increase also fundamentally wonderful ears. There neighbouring techniques go a        Men        pants             4.18     25754.82        0.2149\n10  AAAAAAAAIIFDBAAA                                                                      Continuous times may involve easily french activities; as remote effects will say never; already senior children used to challen        Men  accessories             5.26     11956.88        0.0909\n11  AAAAAAAADMLEBAAA                                     Backs put to the patients. European, scottish women might restrict once big relatives; black lips can last usually. Busy products would feel here powerful, clear        Men        pants             1.84     19409.16        0.1619\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                          i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAMIDLAAAA                                                                                                                                                                                             Men                          2.56      7203.27        2.3989\n1   AAAAAAAAABLKAAAA                            Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                          3.43      4990.88        1.6621\n2   AAAAAAAAEGEFAAAA                             Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                           NaN     24314.74        8.0977\n3   AAAAAAAAGIGEBAAA                                                                                                                                                                          At least sm        Men                           NaN     22643.83        7.5412\n4   AAAAAAAAPHCHAAAA                                                                                                                                                                                             Men                           NaN     20533.50        6.8384\n5   AAAAAAAAEOEIBAAA                                                                                                                                                                       Total, very fo        Men                         12.72      7023.47        2.3390\n6   AAAAAAAAAMLDAAAA                                                                                                                                                                                             Men                           NaN     13270.71        4.4196\n7   AAAAAAAAKKIFBAAA                                                                                                                                                                                             Men                           NaN      4496.24        1.4974\n8   AAAAAAAAHOAABAAA                                                                                                          Protests can notice neither from a leads. Parameters train therefore. Commo        Men  accessories             5.32      8307.19        0.0631\n9   AAAAAAAAEFJEBAAA                                                            Ethnic, emotional conflicts pass waters. Deep times stay apparent pp.. Industrial, various hours may show so women. Terri        Men  accessories             2.26      9227.69        0.0701\n10  AAAAAAAACDECAAAA  Patterns should say more personal indicators. Unlike, ready posts will go less able, left trades. Minerals cost in a incomes. Small, military details must make further in a servic        Men  accessories             7.17      6944.67        0.0528\n11  AAAAAAAAJLJFAAAA                                                    Badly leading police used to see specialist, different months. High goods could not examine in a ladies. Eventually separate grou        Men  accessories             1.52      8618.80        0.0655\n12  AAAAAAAAANEMAAAA                                                                                                          However immediate comparisons count at large little meetings. Suddenly smal        Men  accessories             4.51      7005.02        0.0532\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.104178,
                    "execution_time": 0.044966,
                    "compile_time": 0.000331,
                    "planning_time": 0.042402
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.199534,
                    "execution_time": 0.049793,
                    "compile_time": 0.000316,
                    "planning_time": 0.133267
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                          i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAMIDLAAAA                                                                                                                                                                                             Men                          2.56      7203.27        2.3989\n1   AAAAAAAAABLKAAAA                            Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                          3.43      4990.88        1.6621\n2   AAAAAAAAEGEFAAAA                             Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                           NaN     24314.74        8.0977\n3   AAAAAAAAGIGEBAAA                                                                                                                                                                          At least sm        Men                           NaN     22643.83        7.5412\n4   AAAAAAAAPHCHAAAA                                                                                                                                                                                             Men                           NaN     20533.50        6.8384\n5   AAAAAAAAEOEIBAAA                                                                                                                                                                       Total, very fo        Men                         12.72      7023.47        2.3390\n6   AAAAAAAAAMLDAAAA                                                                                                                                                                                             Men                           NaN     13270.71        4.4196\n7   AAAAAAAAKKIFBAAA                                                                                                                                                                                             Men                           NaN      4496.24        1.4974\n8   AAAAAAAAHOAABAAA                                                                                                          Protests can notice neither from a leads. Parameters train therefore. Commo        Men  accessories             5.32      8307.19        0.0631\n9   AAAAAAAAEFJEBAAA                                                            Ethnic, emotional conflicts pass waters. Deep times stay apparent pp.. Industrial, various hours may show so women. Terri        Men  accessories             2.26      9227.69        0.0701\n10  AAAAAAAACDECAAAA  Patterns should say more personal indicators. Unlike, ready posts will go less able, left trades. Minerals cost in a incomes. Small, military details must make further in a servic        Men  accessories             7.17      6944.67        0.0528\n11  AAAAAAAAJLJFAAAA                                                    Badly leading police used to see specialist, different months. High goods could not examine in a ladies. Eventually separate grou        Men  accessories             1.52      8618.80        0.0655\n12  AAAAAAAAANEMAAAA                                                                                                          However immediate comparisons count at large little meetings. Suddenly smal        Men  accessories             4.51      7005.02        0.0532\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                               i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                                                 Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                          3.43      4990.88        1.6621\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                                                  Men                           NaN     13270.71        4.4196\n2   AAAAAAAAEGEFAAAA                                                  Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                           NaN     24314.74        8.0977\n3   AAAAAAAAEOEIBAAA                                                                                                                                                                                            Total, very fo        Men                         12.72      7023.47        2.3390\n4   AAAAAAAAGIGEBAAA                                                                                                                                                                                               At least sm        Men                           NaN     22643.83        7.5412\n5   AAAAAAAAKKIFBAAA                                                                                                                                                                                                                  Men                           NaN      4496.24        1.4974\n6   AAAAAAAAMIDLAAAA                                                                                                                                                                                                                  Men                          2.56      7203.27        2.3989\n7   AAAAAAAAPHCHAAAA                                                                                                                                                                                                                  Men                           NaN     20533.50        6.8384\n8   AAAAAAAAAAKPAAAA              Affairs bother highly darling, historic men. Criminal, substantial ways shall decide much visible lessons. Especially similar parents will discuss surely very american circumstances. More         Men  accessories             4.55     14698.46        0.1118\n9   AAAAAAAAAALBBAAA    Cruel forces find operations. Psychological eyes cannot educate conservative, experienced services. Shadows used to wish simply following police. Internal, only girls used to get important, large se        Men  accessories             3.01      6208.86        0.0472\n10  AAAAAAAAAAMNAAAA                                                          Drugs could not send steadily industrial interests; quite senior operations will fetch really. More small procedures might give over new, likely        Men  accessories             3.20     10087.43        0.0767\n11  AAAAAAAAAAOGAAAA                                                                         Inadequate visitors used to stop frequently old individuals. Wonderful, concerned sources want justly excellent odds. Clear knees        Men  accessories             4.15      5886.57        0.0447\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.107698,
                    "execution_time": 0.044854,
                    "compile_time": 0.000341,
                    "planning_time": 0.045878
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.182701,
                    "execution_time": 0.04493,
                    "compile_time": 0.00032,
                    "planning_time": 0.120904
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                               i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                                                 Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                          3.43      4990.88        1.6621\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                                                  Men                           NaN     13270.71        4.4196\n2   AAAAAAAAEGEFAAAA                                                  Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                           NaN     24314.74        8.0977\n3   AAAAAAAAEOEIBAAA                                                                                                                                                                                            Total, very fo        Men                         12.72      7023.47        2.3390\n4   AAAAAAAAGIGEBAAA                                                                                                                                                                                               At least sm        Men                           NaN     22643.83        7.5412\n5   AAAAAAAAKKIFBAAA                                                                                                                                                                                                                  Men                           NaN      4496.24        1.4974\n6   AAAAAAAAMIDLAAAA                                                                                                                                                                                                                  Men                          2.56      7203.27        2.3989\n7   AAAAAAAAPHCHAAAA                                                                                                                                                                                                                  Men                           NaN     20533.50        6.8384\n8   AAAAAAAAAAKPAAAA              Affairs bother highly darling, historic men. Criminal, substantial ways shall decide much visible lessons. Especially similar parents will discuss surely very american circumstances. More         Men  accessories             4.55     14698.46        0.1118\n9   AAAAAAAAAALBBAAA    Cruel forces find operations. Psychological eyes cannot educate conservative, experienced services. Shadows used to wish simply following police. Internal, only girls used to get important, large se        Men  accessories             3.01      6208.86        0.0472\n10  AAAAAAAAAAMNAAAA                                                          Drugs could not send steadily industrial interests; quite senior operations will fetch really. More small procedures might give over new, likely        Men  accessories             3.20     10087.43        0.0767\n11  AAAAAAAAAAOGAAAA                                                                         Inadequate visitors used to stop frequently old individuals. Wonderful, concerned sources want justly excellent odds. Clear knees        Men  accessories             4.15      5886.57        0.0447\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                               i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                                                 Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                          3.43      4990.88        1.6621\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                                                  Men                           NaN     13270.71        4.4196\n2   AAAAAAAAEGEFAAAA                                                  Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                           NaN     24314.74        8.0977\n3   AAAAAAAAEOEIBAAA                                                                                                                                                                                            Total, very fo        Men                         12.72      7023.47        2.3390\n4   AAAAAAAAGIGEBAAA                                                                                                                                                                                               At least sm        Men                           NaN     22643.83        7.5412\n5   AAAAAAAAKKIFBAAA                                                                                                                                                                                                                  Men                           NaN      4496.24        1.4974\n6   AAAAAAAAMIDLAAAA                                                                                                                                                                                                                  Men                          2.56      7203.27        2.3989\n7   AAAAAAAAPHCHAAAA                                                                                                                                                                                                                  Men                           NaN     20533.50        6.8384\n8   AAAAAAAAAAKPAAAA              Affairs bother highly darling, historic men. Criminal, substantial ways shall decide much visible lessons. Especially similar parents will discuss surely very american circumstances. More         Men  accessories             4.55     14698.46        0.1118\n9   AAAAAAAAAALBBAAA    Cruel forces find operations. Psychological eyes cannot educate conservative, experienced services. Shadows used to wish simply following police. Internal, only girls used to get important, large se        Men  accessories             3.01      6208.86        0.0472\n10  AAAAAAAAAAMNAAAA                                                          Drugs could not send steadily industrial interests; quite senior operations will fetch really. More small procedures might give over new, likely        Men  accessories             3.20     10087.43        0.0767\n11  AAAAAAAAAAOGAAAA                                                                         Inadequate visitors used to stop frequently old individuals. Wonderful, concerned sources want justly excellent odds. Clear knees        Men  accessories             4.15      5886.57        0.0447\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.104673,
                    "execution_time": 0.043323,
                    "compile_time": 0.000325,
                    "planning_time": 0.044706
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.181851,
                    "execution_time": 0.047103,
                    "compile_time": 0.000332,
                    "planning_time": 0.117898
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                               i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                                                 Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                          3.43      4990.88        1.6621\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                                                  Men                           NaN     13270.71        4.4196\n2   AAAAAAAAEGEFAAAA                                                  Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                           NaN     24314.74        8.0977\n3   AAAAAAAAEOEIBAAA                                                                                                                                                                                            Total, very fo        Men                         12.72      7023.47        2.3390\n4   AAAAAAAAGIGEBAAA                                                                                                                                                                                               At least sm        Men                           NaN     22643.83        7.5412\n5   AAAAAAAAKKIFBAAA                                                                                                                                                                                                                  Men                           NaN      4496.24        1.4974\n6   AAAAAAAAMIDLAAAA                                                                                                                                                                                                                  Men                          2.56      7203.27        2.3989\n7   AAAAAAAAPHCHAAAA                                                                                                                                                                                                                  Men                           NaN     20533.50        6.8384\n8   AAAAAAAAAAKPAAAA              Affairs bother highly darling, historic men. Criminal, substantial ways shall decide much visible lessons. Especially similar parents will discuss surely very american circumstances. More         Men  accessories             4.55     14698.46        0.1118\n9   AAAAAAAAAALBBAAA    Cruel forces find operations. Psychological eyes cannot educate conservative, experienced services. Shadows used to wish simply following police. Internal, only girls used to get important, large se        Men  accessories             3.01      6208.86        0.0472\n10  AAAAAAAAAAMNAAAA                                                          Drugs could not send steadily industrial interests; quite senior operations will fetch really. More small procedures might give over new, likely        Men  accessories             3.20     10087.43        0.0767\n11  AAAAAAAAAAOGAAAA                                                                         Inadequate visitors used to stop frequently old individuals. Wonderful, concerned sources want justly excellent odds. Clear knees        Men  accessories             4.15      5886.57        0.0447\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n        ,revenueratio\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST , \"REVENUERATIO\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST , REVENUERATIO NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                               i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                                                 Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                          3.43      4990.88        1.6621\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                                                  Men                           NaN     13270.71        4.4196\n2   AAAAAAAAEGEFAAAA                                                  Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                           NaN     24314.74        8.0977\n3   AAAAAAAAEOEIBAAA                                                                                                                                                                                            Total, very fo        Men                         12.72      7023.47        2.3390\n4   AAAAAAAAGIGEBAAA                                                                                                                                                                                               At least sm        Men                           NaN     22643.83        7.5412\n5   AAAAAAAAKKIFBAAA                                                                                                                                                                                                                  Men                           NaN      4496.24        1.4974\n6   AAAAAAAAMIDLAAAA                                                                                                                                                                                                                  Men                          2.56      7203.27        2.3989\n7   AAAAAAAAPHCHAAAA                                                                                                                                                                                                                  Men                           NaN     20533.50        6.8384\n8   AAAAAAAAAAKPAAAA              Affairs bother highly darling, historic men. Criminal, substantial ways shall decide much visible lessons. Especially similar parents will discuss surely very american circumstances. More         Men  accessories             4.55     14698.46        0.1118\n9   AAAAAAAAAALBBAAA    Cruel forces find operations. Psychological eyes cannot educate conservative, experienced services. Shadows used to wish simply following police. Internal, only girls used to get important, large se        Men  accessories             3.01      6208.86        0.0472\n10  AAAAAAAAAAMNAAAA                                                          Drugs could not send steadily industrial interests; quite senior operations will fetch really. More small procedures might give over new, likely        Men  accessories             3.20     10087.43        0.0767\n11  AAAAAAAAAAOGAAAA                                                                         Inadequate visitors used to stop frequently old individuals. Wonderful, concerned sources want justly excellent odds. Clear knees        Men  accessories             4.15      5886.57        0.0447\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.112441,
                    "execution_time": 0.046204,
                    "compile_time": 0.000335,
                    "planning_time": 0.048787
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.339617,
                    "execution_time": 0.049812,
                    "compile_time": 0.141976,
                    "planning_time": 0.130327
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST, \"REVENUERATIO\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                               i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                                                 Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                          3.43      4990.88        1.6621\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                                                  Men                           NaN     13270.71        4.4196\n2   AAAAAAAAEGEFAAAA                                                  Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                           NaN     24314.74        8.0977\n3   AAAAAAAAEOEIBAAA                                                                                                                                                                                            Total, very fo        Men                         12.72      7023.47        2.3390\n4   AAAAAAAAGIGEBAAA                                                                                                                                                                                               At least sm        Men                           NaN     22643.83        7.5412\n5   AAAAAAAAKKIFBAAA                                                                                                                                                                                                                  Men                           NaN      4496.24        1.4974\n6   AAAAAAAAMIDLAAAA                                                                                                                                                                                                                  Men                          2.56      7203.27        2.3989\n7   AAAAAAAAPHCHAAAA                                                                                                                                                                                                                  Men                           NaN     20533.50        6.8384\n8   AAAAAAAAAAKPAAAA              Affairs bother highly darling, historic men. Criminal, substantial ways shall decide much visible lessons. Especially similar parents will discuss surely very american circumstances. More         Men  accessories             4.55     14698.46        0.1118\n9   AAAAAAAAAALBBAAA    Cruel forces find operations. Psychological eyes cannot educate conservative, experienced services. Shadows used to wish simply following police. Internal, only girls used to get important, large se        Men  accessories             3.01      6208.86        0.0472\n10  AAAAAAAAAAMNAAAA                                                          Drugs could not send steadily industrial interests; quite senior operations will fetch really. More small procedures might give over new, likely        Men  accessories             3.20     10087.43        0.0767\n11  AAAAAAAAAAOGAAAA                                                                         Inadequate visitors used to stop frequently old individuals. Wonderful, concerned sources want justly excellent odds. Clear knees        Men  accessories             4.15      5886.57        0.0447\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n        ,revenueratio\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST , \"REVENUERATIO\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST , REVENUERATIO NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                               i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                                                 Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                          3.43      4990.88        1.6621\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                                                  Men                           NaN     13270.71        4.4196\n2   AAAAAAAAEGEFAAAA                                                  Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                           NaN     24314.74        8.0977\n3   AAAAAAAAEOEIBAAA                                                                                                                                                                                            Total, very fo        Men                         12.72      7023.47        2.3390\n4   AAAAAAAAGIGEBAAA                                                                                                                                                                                               At least sm        Men                           NaN     22643.83        7.5412\n5   AAAAAAAAKKIFBAAA                                                                                                                                                                                                                  Men                           NaN      4496.24        1.4974\n6   AAAAAAAAMIDLAAAA                                                                                                                                                                                                                  Men                          2.56      7203.27        2.3989\n7   AAAAAAAAPHCHAAAA                                                                                                                                                                                                                  Men                           NaN     20533.50        6.8384\n8   AAAAAAAAAAKPAAAA              Affairs bother highly darling, historic men. Criminal, substantial ways shall decide much visible lessons. Especially similar parents will discuss surely very american circumstances. More         Men  accessories             4.55     14698.46        0.1118\n9   AAAAAAAAAALBBAAA    Cruel forces find operations. Psychological eyes cannot educate conservative, experienced services. Shadows used to wish simply following police. Internal, only girls used to get important, large se        Men  accessories             3.01      6208.86        0.0472\n10  AAAAAAAAAAMNAAAA                                                          Drugs could not send steadily industrial interests; quite senior operations will fetch really. More small procedures might give over new, likely        Men  accessories             3.20     10087.43        0.0767\n11  AAAAAAAAAAOGAAAA                                                                         Inadequate visitors used to stop frequently old individuals. Wonderful, concerned sources want justly excellent odds. Clear knees        Men  accessories             4.15      5886.57        0.0447\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.107784,
                    "execution_time": 0.046398,
                    "compile_time": 0.000355,
                    "planning_time": 0.043974
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.109618,
                    "execution_time": 0.048314,
                    "compile_time": 0.000341,
                    "planning_time": 0.043809
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST, \"REVENUERATIO\" NULLS LAST LIMIT 100",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                               i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                                                 Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                          3.43      4990.88        1.6621\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                                                  Men                           NaN     13270.71        4.4196\n2   AAAAAAAAEGEFAAAA                                                  Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                           NaN     24314.74        8.0977\n3   AAAAAAAAEOEIBAAA                                                                                                                                                                                            Total, very fo        Men                         12.72      7023.47        2.3390\n4   AAAAAAAAGIGEBAAA                                                                                                                                                                                               At least sm        Men                           NaN     22643.83        7.5412\n5   AAAAAAAAKKIFBAAA                                                                                                                                                                                                                  Men                           NaN      4496.24        1.4974\n6   AAAAAAAAMIDLAAAA                                                                                                                                                                                                                  Men                          2.56      7203.27        2.3989\n7   AAAAAAAAPHCHAAAA                                                                                                                                                                                                                  Men                           NaN     20533.50        6.8384\n8   AAAAAAAAAAKPAAAA              Affairs bother highly darling, historic men. Criminal, substantial ways shall decide much visible lessons. Especially similar parents will discuss surely very american circumstances. More         Men  accessories             4.55     14698.46        0.1118\n9   AAAAAAAAAALBBAAA    Cruel forces find operations. Psychological eyes cannot educate conservative, experienced services. Shadows used to wish simply following police. Internal, only girls used to get important, large se        Men  accessories             3.01      6208.86        0.0472\n10  AAAAAAAAAAMNAAAA                                                          Drugs could not send steadily industrial interests; quite senior operations will fetch really. More small procedures might give over new, likely        Men  accessories             3.20     10087.43        0.0767\n11  AAAAAAAAAAOGAAAA                                                                         Inadequate visitors used to stop frequently old individuals. Wonderful, concerned sources want justly excellent odds. Clear knees        Men  accessories             4.15      5886.57        0.0447\n...*/"
    }
]