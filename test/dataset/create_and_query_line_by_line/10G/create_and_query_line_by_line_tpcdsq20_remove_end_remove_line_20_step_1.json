[
    {
        "input": "select /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over () as percentage_of_total_sales\n/*CURSOR_IDENTIFIER*/\nfrom item\njoin catalog_sales on cs_item_sk = i_item_sk\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( ) AS \"PERCENTAGE_OF_TOTAL_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( ) AS \"PERCENTAGE_OF_TOTAL_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.062227,
                    "execution_time": 0.696752,
                    "compile_time": 0.000552,
                    "planning_time": 0.036829,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.141889,
                    "execution_time": 0.700918,
                    "compile_time": 0.000547,
                    "planning_time": 0.106238,
                    "create_size": 1280
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_1\".\"PERCENTAGE_OF_TOTAL_SALES\" AS \"PERCENTAGE_OF_TOTAL_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                               i_item_desc   i_category         i_class  i_current_price  itemrevenue  percentage_of_total_sales\n0   AAAAAAAAIGPPAAAA                                             Public pages used to tell often terrible, joint months. Organisational plans pull. Principal, obvious times shall go forth. Indignantly other books would tes  Electronics        monitors             7.59    480188.53                     0.0013\n1   AAAAAAAAACOGAAAA                                                  Identical, bad officials carry prices. Qualities speak. Officers seek eyes. Mines can speak twice relations. False empty authors help regular, quiet mon       Sports         fitness             4.05    308344.69                     0.0008\n2   AAAAAAAADHGJAAAA                              Sexual, old resources divide. Churches may drink difficult, new women. Hugely local sources tell. Other models may not begin already skills. Social years get rarely slowly         Music         country             0.65    627219.54                     0.0017\n3   AAAAAAAAEDCNAAAA         Unaware studies remind; ancient, lovely losses should not need since a houses. Police draft instead large-scale, rich effects. Single talks get very events. Probably poor sales keep never on a        Sports      basketball             8.51    283948.84                     0.0007\n4   AAAAAAAAGHCEAAAA                                                                                          Important hours complain. Now necessary applications mean so yet private observers. Academic, new tactics would         Music         country             7.67    278439.96                     0.0007\n5   AAAAAAAAPFDFAAAA                                                                                                 Important, extreme workers discover and so on. Home remarkable americans make monetary plants. Ever small       Sports            guns             1.83    652013.36                     0.0017\n6   AAAAAAAAIONAAAAA                                                                                                                             Most physical windows could emphasise always only free reports. Current citie  Electronics         musical            84.44    318440.03                     0.0008\n7   AAAAAAAALCELAAAA                                          Electronic years go only perhaps united countries. National categories will know slowly; little years investigate only. Continental, daily acids could ship soci         Home        bathroom             6.29    734281.51                     0.0020\n8   AAAAAAAAIBNIBAAA                                                                                Only social children analyse within results. Thereby german activities think negative, historical sisters. New, red accide     Children         newborn             0.92    303204.39                     0.0008\n9   AAAAAAAAMKNJAAAA                                                                                                    Creative differences could take most creative animals. Sometimes independent items may resign; women s  Electronics          karoke             2.98    392278.23                     0.0010\n10  AAAAAAAAEHLDAAAA                                                                                                                                                                                      Obvious, afraid poli         Home         bedding             4.05    293141.89                     0.0008\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018499,
                    "execution_time": 0.008006,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.0043
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056422,
                    "execution_time": 0.007717,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039457
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER () AS \"PERCENTAGE_OF_TOTAL_SALES\" FROM \"ITEM\" AS \"ITEM\" JOIN \"CATALOG_SALES\" AS \"CATALOG_SALES\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_1\".\"PERCENTAGE_OF_TOTAL_SALES\" AS \"PERCENTAGE_OF_TOTAL_SALES\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                               i_item_desc   i_category         i_class  i_current_price  itemrevenue  percentage_of_total_sales\n0   AAAAAAAAIGPPAAAA                                             Public pages used to tell often terrible, joint months. Organisational plans pull. Principal, obvious times shall go forth. Indignantly other books would tes  Electronics        monitors             7.59    480188.53                     0.0013\n1   AAAAAAAAACOGAAAA                                                  Identical, bad officials carry prices. Qualities speak. Officers seek eyes. Mines can speak twice relations. False empty authors help regular, quiet mon       Sports         fitness             4.05    308344.69                     0.0008\n2   AAAAAAAADHGJAAAA                              Sexual, old resources divide. Churches may drink difficult, new women. Hugely local sources tell. Other models may not begin already skills. Social years get rarely slowly         Music         country             0.65    627219.54                     0.0017\n3   AAAAAAAAEDCNAAAA         Unaware studies remind; ancient, lovely losses should not need since a houses. Police draft instead large-scale, rich effects. Single talks get very events. Probably poor sales keep never on a        Sports      basketball             8.51    283948.84                     0.0007\n4   AAAAAAAAGHCEAAAA                                                                                          Important hours complain. Now necessary applications mean so yet private observers. Academic, new tactics would         Music         country             7.67    278439.96                     0.0007\n5   AAAAAAAAPFDFAAAA                                                                                                 Important, extreme workers discover and so on. Home remarkable americans make monetary plants. Ever small       Sports            guns             1.83    652013.36                     0.0017\n6   AAAAAAAAIONAAAAA                                                                                                                             Most physical windows could emphasise always only free reports. Current citie  Electronics         musical            84.44    318440.03                     0.0008\n7   AAAAAAAALCELAAAA                                          Electronic years go only perhaps united countries. National categories will know slowly; little years investigate only. Continental, daily acids could ship soci         Home        bathroom             6.29    734281.51                     0.0020\n8   AAAAAAAAIBNIBAAA                                                                                Only social children analyse within results. Thereby german activities think negative, historical sisters. New, red accide     Children         newborn             0.92    303204.39                     0.0008\n9   AAAAAAAAMKNJAAAA                                                                                                    Creative differences could take most creative animals. Sometimes independent items may resign; women s  Electronics          karoke             2.98    392278.23                     0.0010\n10  AAAAAAAAEHLDAAAA                                                                                                                                                                                      Obvious, afraid poli         Home         bedding             4.05    293141.89                     0.0008\n...*/"
    },
    {
        "input": "SELECT /* TPC-DS query20.tpl 0.65 */ i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,SUM(cs_ext_sales_price) AS itemrevenue \n       ,SUM(cs_ext_sales_price) * 100 / SUM(SUM(cs_ext_sales_price)) OVER\n           (PARTITION BY i_class) AS revenueratio\n/*CURSOR_IDENTIFIER*/\nFROM catalog_sales cs\nJOIN item i ON cs.cs_item_sk = i.i_item_sk\nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price;",
        "optimize": [
            "SELECT \"I\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"I\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"I\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"I\".\"I_CLASS\" AS \"I_CLASS\" , \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"I\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"ITEM\" AS \"I\" ON \"CS\".\"CS_ITEM_SK\" = \"I\".\"I_ITEM_SK\" GROUP BY \"I\".\"I_ITEM_ID\" , \"I\".\"I_ITEM_DESC\" , \"I\".\"I_CATEGORY\" , \"I\".\"I_CLASS\" , \"I\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"I\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"I\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"I\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"I\".\"I_CLASS\" AS \"I_CLASS\" , \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CS\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"I\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"ITEM\" AS \"I\" ON \"CS\".\"CS_ITEM_SK\" = \"I\".\"I_ITEM_SK\" GROUP BY \"I\".\"I_ITEM_ID\" , \"I\".\"I_ITEM_DESC\" , \"I\".\"I_CATEGORY\" , \"I\".\"I_CLASS\" , \"I\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.02813,
                    "execution_time": 0.698967,
                    "compile_time": 0.000592,
                    "planning_time": 0.037425,
                    "create_size": 1300
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.091738,
                    "execution_time": 0.691261,
                    "compile_time": 0.000593,
                    "planning_time": 0.105168,
                    "create_size": 1300
                }
            }
        ],
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT \"I\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"I\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"I\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"I\".\"I_CLASS\" AS \"I_CLASS\", \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CS\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CS\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CS\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"I\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"ITEM\" AS \"I\" ON \"CS\".\"CS_ITEM_SK\" = \"I\".\"I_ITEM_SK\" GROUP BY \"I\".\"I_ITEM_ID\", \"I\".\"I_ITEM_DESC\", \"I\".\"I_CATEGORY\", \"I\".\"I_CLASS\", \"I\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_2\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  CS_ITEM_SK as i_item_id\n       ,null as i_item_desc \n       ,null as i_category \n       ,null as i_class \n       ,CS_SALES_PRICE as i_current_price\n       ,sum(CS_EXT_SALES_PRICE) as itemrevenue \n       ,sum(CS_EXT_SALES_PRICE)*100/sum(sum(CS_EXT_SALES_PRICE)) over\n           (partition by CS_ITEM_SK) as revenueratio\n from\tcatalog_sales\n group by CS_ITEM_SK, CS_SALES_PRICE\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"I_ITEM_ID\" , NULL AS \"I_ITEM_DESC\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"I_ITEM_ID\" , NULL AS \"I_ITEM_DESC\" , NULL AS \"I_CATEGORY\" , NULL AS \"I_CLASS\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"CATALOG_SALES\".\"CS_ITEM_SK\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 3.281248,
                    "execution_time": 2.774158,
                    "compile_time": 0.00055,
                    "planning_time": 0.028877,
                    "create_size": 2816
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.47418,
                    "execution_time": 2.758487,
                    "compile_time": 0.149434,
                    "planning_time": 0.091675,
                    "create_size": 2816
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_3\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_3\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*    i_item_id i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0          56        None       None    None           244.63     24463.00        5.4727\n1          56        None       None    None           129.31     11249.97        2.5167\n2          56        None       None    None            20.90      1065.90        0.2384\n3          56        None       None    None            95.01      7030.74        1.5728\n4          56        None       None    None           106.37       106.37        0.0237\n5          56        None       None    None             8.24       387.28        0.0866\n6          56        None       None    None             6.79       122.22        0.0273\n7          56        None       None    None            42.64       170.56        0.0381\n8          56        None       None    None            11.39       660.62        0.1477\n9          56        None       None    None           153.44      8285.76        1.8536\n10         56        None       None    None            36.84      2836.68        0.6346\n11         56        None       None    None            35.41      1735.09        0.3881\n12         56        None       None    None            45.29      4393.13        0.9828\n13         56        None       None    None            25.58      2097.56        0.4692\n14         56        None       None    None            40.90      2126.80        0.4757\n15         56        None       None    None            17.86      1482.38        0.3316\n16         56        None       None    None            71.48      3788.44        0.8475\n17         56        None       None    None             4.55       104.65        0.0234\n18         56        None       None    None            27.97      1873.99        0.4192\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.070601,
                    "execution_time": 0.008766,
                    "compile_time": 0.049686,
                    "planning_time": 0.005501
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.375503,
                    "execution_time": 0.008901,
                    "compile_time": 3.31471,
                    "planning_time": 0.040777
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CATALOG_SALES\".\"CS_ITEM_SK\" AS \"I_ITEM_ID\", NULL AS \"I_ITEM_DESC\", NULL AS \"I_CATEGORY\", NULL AS \"I_CLASS\", \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"CATALOG_SALES\".\"CS_ITEM_SK\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" GROUP BY \"CATALOG_SALES\".\"CS_ITEM_SK\", \"CATALOG_SALES\".\"CS_SALES_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_3\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_3\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*    i_item_id i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0          56        None       None    None           244.63     24463.00        5.4727\n1          56        None       None    None           129.31     11249.97        2.5167\n2          56        None       None    None            20.90      1065.90        0.2384\n3          56        None       None    None            95.01      7030.74        1.5728\n4          56        None       None    None           106.37       106.37        0.0237\n5          56        None       None    None             8.24       387.28        0.0866\n6          56        None       None    None             6.79       122.22        0.0273\n7          56        None       None    None            42.64       170.56        0.0381\n8          56        None       None    None            11.39       660.62        0.1477\n9          56        None       None    None           153.44      8285.76        1.8536\n10         56        None       None    None            36.84      2836.68        0.6346\n11         56        None       None    None            35.41      1735.09        0.3881\n12         56        None       None    None            45.29      4393.13        0.9828\n13         56        None       None    None            25.58      2097.56        0.4692\n14         56        None       None    None            40.90      2126.80        0.4757\n15         56        None       None    None            17.86      1482.38        0.3316\n16         56        None       None    None            71.48      3788.44        0.8475\n17         56        None       None    None             4.55       104.65        0.0234\n18         56        None       None    None            27.97      1873.99        0.4192\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n group by i_item_id, i_item_desc, i_category, i_class, i_current_price/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n group by i_item_id, i_item_desc, i_category, i_class, i_current_price/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n group by i_item_id, i_item_desc, i_category, i_class, i_current_price/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.448245,
                    "execution_time": 0.302595,
                    "compile_time": 0.000614,
                    "planning_time": 0.04675,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.691288,
                    "execution_time": 0.299152,
                    "compile_time": 0.159324,
                    "planning_time": 0.12846,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_4\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_4\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                              i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAALEPABAAA                                                                                                                                                          Services would not interact therefore following     Sports    guns             0.13    697987.12        0.2964\n1   AAAAAAAAOPMPAAAA                   Short, royal sanctions will keep even real enterprises. Identical, national subsidies will not come more. Others get leaves. Actually responsible pressures remain currently chief par     Sports    guns             2.97    484747.95        0.2059\n2   AAAAAAAANBMIAAAA     Great teachers talk normally swiftly friendly men. Linguistic words talk under a beans. Therefore following terms execute of course public, financial songs. And so on clear authorities must get so     Sports    guns             9.70    667599.03        0.2835\n3   AAAAAAAAPJMNAAAA                                                       Willing, philosophical terms would enter winners; all new police work clear bars. Terrible weekends resist certainly more artificial pages. Months     Sports    guns             8.79    657463.74        0.2792\n4   AAAAAAAAIMDFAAAA                                                                                                                                                                                Controversial, good shows     Sports    guns             5.89    289850.71        0.1231\n5   AAAAAAAAINHHAAAA                                                                                                                                                                                       Mainly western wor     Sports    guns             7.92    469734.07        0.1995\n6   AAAAAAAACHLGAAAA                                                                                                                                                                                    Specific miles used t     Sports    guns             8.59    428873.88        0.1821\n7   AAAAAAAAAPLFBAAA                                                Demands ought to appreciate tightly labour bits. Literary, useful taxes should not judge oddly before the expenses. International, expected benefits coul     Sports    guns            61.68    402304.05        0.1708\n8   AAAAAAAAMEIEAAAA                                                           So new feet show too to a legs. Large, usual nurses should not report. Adequate, bright levels contain systems; best scottish woods agree simp     Sports    guns            82.39    265566.19        0.1128\n9   AAAAAAAAEDHHBAAA                                                                         Ideas send gains; hours contrast too by a farmers. White, running components will make very important critics; beautifully medic     Sports    guns             0.79    303439.68        0.1288\n10  AAAAAAAAFDNKAAAA       Economic methods might suggest prices. Likely, soft areas could help regulatory, specific facilities. Persons shall switch available eyes. About big appeals might not fight positions. Lives incr     Sports    guns             3.58    758277.08        0.3220\n11  AAAAAAAAAFHEBAAA                                                                                                   So scottish months determine as elections. Nowadays alone years would break; subsidies will respond at     Sports    guns             4.64    436329.72        0.1853\n12  AAAAAAAAFKOFAAAA                                                                                      Characters take tall, professional sources; increasing, similar rooms like forever. Ill years see again surfaces. O     Sports    guns             7.44    764864.55        0.3248\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01927,
                    "execution_time": 0.007783,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.005113
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057765,
                    "execution_time": 0.007571,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.040906
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_4\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_4\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                              i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAALEPABAAA                                                                                                                                                          Services would not interact therefore following     Sports    guns             0.13    697987.12        0.2964\n1   AAAAAAAAOPMPAAAA                   Short, royal sanctions will keep even real enterprises. Identical, national subsidies will not come more. Others get leaves. Actually responsible pressures remain currently chief par     Sports    guns             2.97    484747.95        0.2059\n2   AAAAAAAANBMIAAAA     Great teachers talk normally swiftly friendly men. Linguistic words talk under a beans. Therefore following terms execute of course public, financial songs. And so on clear authorities must get so     Sports    guns             9.70    667599.03        0.2835\n3   AAAAAAAAPJMNAAAA                                                       Willing, philosophical terms would enter winners; all new police work clear bars. Terrible weekends resist certainly more artificial pages. Months     Sports    guns             8.79    657463.74        0.2792\n4   AAAAAAAAIMDFAAAA                                                                                                                                                                                Controversial, good shows     Sports    guns             5.89    289850.71        0.1231\n5   AAAAAAAAINHHAAAA                                                                                                                                                                                       Mainly western wor     Sports    guns             7.92    469734.07        0.1995\n6   AAAAAAAACHLGAAAA                                                                                                                                                                                    Specific miles used t     Sports    guns             8.59    428873.88        0.1821\n7   AAAAAAAAAPLFBAAA                                                Demands ought to appreciate tightly labour bits. Literary, useful taxes should not judge oddly before the expenses. International, expected benefits coul     Sports    guns            61.68    402304.05        0.1708\n8   AAAAAAAAMEIEAAAA                                                           So new feet show too to a legs. Large, usual nurses should not report. Adequate, bright levels contain systems; best scottish woods agree simp     Sports    guns            82.39    265566.19        0.1128\n9   AAAAAAAAEDHHBAAA                                                                         Ideas send gains; hours contrast too by a farmers. White, running components will make very important critics; beautifully medic     Sports    guns             0.79    303439.68        0.1288\n10  AAAAAAAAFDNKAAAA       Economic methods might suggest prices. Likely, soft areas could help regulatory, specific facilities. Persons shall switch available eyes. About big appeals might not fight positions. Lives incr     Sports    guns             3.58    758277.08        0.3220\n11  AAAAAAAAAFHEBAAA                                                                                                   So scottish months determine as elections. Nowadays alone years would break; subsidies will respond at     Sports    guns             4.64    436329.72        0.1853\n12  AAAAAAAAFKOFAAAA                                                                                      Characters take tall, professional sources; increasing, similar rooms like forever. Ill years see again surfaces. O     Sports    guns             7.44    764864.55        0.3248\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) and cast('1998-05-20' as date) \ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= CAST ( '1998-05-20' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= CAST ( '1998-05-20' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.174451,
                    "execution_time": 0.079312,
                    "compile_time": 0.000495,
                    "planning_time": 0.049224,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.547989,
                    "execution_time": 0.078673,
                    "compile_time": 0.293106,
                    "planning_time": 0.123511,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_5\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_5\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                              i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAOBLDAAAA                                                                                                                                           Unable pairs must think more successfully nearby families. Fed     Sports    guns             9.08       790.08        0.1291\n1   AAAAAAAAINHHAAAA                                                                                                                                                                                       Mainly western wor     Sports    guns             7.92      5391.50        0.8811\n2   AAAAAAAAFDMIAAAA                                   Presents would tour considerations. Men would deny most mad, certain women. Brothers will not conclude in a years. Likely, right losses should not affect into the eye     Sports    guns             3.77      5026.72        0.8215\n3   AAAAAAAAJHDFBAAA                                                                                                                                  Real manufacturers cannot walk quite available services. Suitable cases     Sports    guns             0.83      8628.84        1.4102\n4   AAAAAAAAKIGHBAAA                                                                                                                                                                               Steps ought to continue pl     Sports    guns             6.32      2710.35        0.4429\n5   AAAAAAAAIBDLAAAA           Nuclear, sufficient men play. Important, strange categories might obtain ago in a drugs; questions carry enough. Only annual songs would penetrate also in a results. False, bad hours can acc     Sports    guns            81.51      2403.41        0.3927\n6   AAAAAAAAECICAAAA                                                                                                                                                                                                   Old, n     Sports    guns             1.37      3158.13        0.5161\n7   AAAAAAAAFKOFAAAA                                                                                      Characters take tall, professional sources; increasing, similar rooms like forever. Ill years see again surfaces. O     Sports    guns             7.44      2771.04        0.4528\n8   AAAAAAAAMEHAAAAA                                                          So married arts must not land somewhat. Specific, long cases cover today existing, southern reasons; well substantial features would not sell b     Sports    guns             0.86      2150.01        0.3513\n9   AAAAAAAAEGCOAAAA                Sufficient levels destroy low at a teachers. Possible kids compromise enough rich sections. Again social years may test also already satisfied words. Skills find even. British, private      Sports    guns             3.85      7315.38        1.1955\n10  AAAAAAAAIPFKAAAA                                                                                                                                                          Early leaves laugh again difficult reductions.      Sports    guns             7.45      2070.90        0.3384\n11  AAAAAAAAAFHEBAAA                                                                                                   So scottish months determine as elections. Nowadays alone years would break; subsidies will respond at     Sports    guns             4.64      2664.58        0.4354\n12  AAAAAAAAGMEDAAAA                                                              Blind, real systems may not intervene even later real standards. Unnecessarily other others might clarify in a doors. Here catholic manager     Sports    guns             3.81       271.31        0.0443\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019582,
                    "execution_time": 0.007765,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.005261
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057238,
                    "execution_time": 0.00756,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.040645
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= CAST('1998-05-20' AS DATE) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_5\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_5\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                              i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAOBLDAAAA                                                                                                                                           Unable pairs must think more successfully nearby families. Fed     Sports    guns             9.08       790.08        0.1291\n1   AAAAAAAAINHHAAAA                                                                                                                                                                                       Mainly western wor     Sports    guns             7.92      5391.50        0.8811\n2   AAAAAAAAFDMIAAAA                                   Presents would tour considerations. Men would deny most mad, certain women. Brothers will not conclude in a years. Likely, right losses should not affect into the eye     Sports    guns             3.77      5026.72        0.8215\n3   AAAAAAAAJHDFBAAA                                                                                                                                  Real manufacturers cannot walk quite available services. Suitable cases     Sports    guns             0.83      8628.84        1.4102\n4   AAAAAAAAKIGHBAAA                                                                                                                                                                               Steps ought to continue pl     Sports    guns             6.32      2710.35        0.4429\n5   AAAAAAAAIBDLAAAA           Nuclear, sufficient men play. Important, strange categories might obtain ago in a drugs; questions carry enough. Only annual songs would penetrate also in a results. False, bad hours can acc     Sports    guns            81.51      2403.41        0.3927\n6   AAAAAAAAECICAAAA                                                                                                                                                                                                   Old, n     Sports    guns             1.37      3158.13        0.5161\n7   AAAAAAAAFKOFAAAA                                                                                      Characters take tall, professional sources; increasing, similar rooms like forever. Ill years see again surfaces. O     Sports    guns             7.44      2771.04        0.4528\n8   AAAAAAAAMEHAAAAA                                                          So married arts must not land somewhat. Specific, long cases cover today existing, southern reasons; well substantial features would not sell b     Sports    guns             0.86      2150.01        0.3513\n9   AAAAAAAAEGCOAAAA                Sufficient levels destroy low at a teachers. Possible kids compromise enough rich sections. Again social years may test also already satisfied words. Skills find even. British, private      Sports    guns             3.85      7315.38        1.1955\n10  AAAAAAAAIPFKAAAA                                                                                                                                                          Early leaves laugh again difficult reductions.      Sports    guns             7.45      2070.90        0.3384\n11  AAAAAAAAAFHEBAAA                                                                                                   So scottish months determine as elections. Nowadays alone years would break; subsidies will respond at     Sports    guns             4.64      2664.58        0.4354\n12  AAAAAAAAGMEDAAAA                                                              Blind, real systems may not intervene even later real standards. Unnecessarily other others might clarify in a doors. Here catholic manager     Sports    guns             3.81       271.31        0.0443\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                              i_item_desc i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAEAPDBAAA                                                                                                                                                                                           Various, shall     Sports  baseball             1.69     15998.66        0.6839\n1   AAAAAAAAJEKHBAAA                                                                                                                     Happy, unique amounts establish quite others. Also visual years must spread however      Sports  baseball             7.67      2120.14        0.0906\n2   AAAAAAAAMJDEBAAA                                                                                                                   Bodies can present also either full numbers. Bad, flexible opportunities cannot tell p     Sports  baseball             2.81      7111.35        0.3040\n3   AAAAAAAADGHPAAAA                                                                                                                                              Lives go old, black principles. Armed, high police could ob     Sports  baseball             8.20       261.44        0.0111\n4   AAAAAAAADJIOAAAA                                                                                                                 Economic mothers use perfectly for the weekends. Here appointed opportunities inform cel     Sports  baseball             1.22      6369.57        0.2723\n5   AAAAAAAAFEGNAAAA               Houses ask ostensibly just military organizations; scientific powers might intervene there full products. Quite young teachers know in a organisations. Consistently contrary homes rescue     Sports  baseball             1.15     12705.59        0.5431\n6   AAAAAAAABIHJAAAA                                                                                                                                                                               Always capital conditions      Sports  baseball             3.13     16666.47        0.7125\n7   AAAAAAAAAFECAAAA      Secondary, middle arms make social, light aims. So as mysterious police take final, other cards. Used ways can happen nearly different prices. Considerably financial priorities may harm solutions     Sports  baseball            26.35     22773.27        0.9735\n8   AAAAAAAAOGKOAAAA  Equations feel now international gods. Explicit, sufficient effects may perform again permanent, inadequate months. Customers drop usually tomorrow correct images. So overall members could lead impos     Sports  baseball             4.50      3655.80        0.1562\n9   AAAAAAAAINFCBAAA                                                                                         New numbers use above families. Even royal adults ought to allow flexible, due drivers. Usual, male weeks confir     Sports  baseball             3.72      4629.79        0.1979\n10  AAAAAAAAPFOAAAAA                                                   Less western communities make nearer customs; now potential speakers would get separate, unchanged homes. Conditions help elderly, high votes. Souther     Sports  baseball             8.65     12211.21        0.5220\n11  AAAAAAAAIOBMAAAA                                                                                                       Fully certain territories would lend new, main systems. Asleep, organic threats ought to reach chi     Sports  baseball             0.88     11199.92        0.4788\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.099534,
                    "execution_time": 0.037321,
                    "compile_time": 0.000347,
                    "planning_time": 0.042539
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.175483,
                    "execution_time": 0.042164,
                    "compile_time": 0.000325,
                    "planning_time": 0.113263
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                              i_item_desc i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAEAPDBAAA                                                                                                                                                                                           Various, shall     Sports  baseball             1.69     15998.66        0.6839\n1   AAAAAAAAJEKHBAAA                                                                                                                     Happy, unique amounts establish quite others. Also visual years must spread however      Sports  baseball             7.67      2120.14        0.0906\n2   AAAAAAAAMJDEBAAA                                                                                                                   Bodies can present also either full numbers. Bad, flexible opportunities cannot tell p     Sports  baseball             2.81      7111.35        0.3040\n3   AAAAAAAADGHPAAAA                                                                                                                                              Lives go old, black principles. Armed, high police could ob     Sports  baseball             8.20       261.44        0.0111\n4   AAAAAAAADJIOAAAA                                                                                                                 Economic mothers use perfectly for the weekends. Here appointed opportunities inform cel     Sports  baseball             1.22      6369.57        0.2723\n5   AAAAAAAAFEGNAAAA               Houses ask ostensibly just military organizations; scientific powers might intervene there full products. Quite young teachers know in a organisations. Consistently contrary homes rescue     Sports  baseball             1.15     12705.59        0.5431\n6   AAAAAAAABIHJAAAA                                                                                                                                                                               Always capital conditions      Sports  baseball             3.13     16666.47        0.7125\n7   AAAAAAAAAFECAAAA      Secondary, middle arms make social, light aims. So as mysterious police take final, other cards. Used ways can happen nearly different prices. Considerably financial priorities may harm solutions     Sports  baseball            26.35     22773.27        0.9735\n8   AAAAAAAAOGKOAAAA  Equations feel now international gods. Explicit, sufficient effects may perform again permanent, inadequate months. Customers drop usually tomorrow correct images. So overall members could lead impos     Sports  baseball             4.50      3655.80        0.1562\n9   AAAAAAAAINFCBAAA                                                                                         New numbers use above families. Even royal adults ought to allow flexible, due drivers. Usual, male weeks confir     Sports  baseball             3.72      4629.79        0.1979\n10  AAAAAAAAPFOAAAAA                                                   Less western communities make nearer customs; now potential speakers would get separate, unchanged homes. Conditions help elderly, high votes. Souther     Sports  baseball             8.65     12211.21        0.5220\n11  AAAAAAAAIOBMAAAA                                                                                                       Fully certain territories would lend new, main systems. Asleep, organic threats ought to reach chi     Sports  baseball             0.88     11199.92        0.4788\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id, i_item_desc, i_category, i_class, i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                              i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAMBLBAAAA                                                                                                                                                                              Studies rus  Electronics  cameras             0.79     20748.15        1.0095\n1   AAAAAAAAEBIDBAAA                                                                                                                                                                                        T  Electronics  cameras             2.16      3625.75        0.1764\n2   AAAAAAAAAOHHAAAA                                                    Intellectual objects would prevent; clear, revolutionary negotiations plan here profoundly big services. National police shoot betwee  Electronics  cameras             4.07     11858.61        0.5769\n3   AAAAAAAAGDNPAAAA                                                                                                                            Present ministers used to hear much as well able deposits. Pa  Electronics  cameras             2.50     10324.99        0.5023\n4   AAAAAAAADJILAAAA                 Economic comparisons obtain overall in a sales; local, national aspects may govern arab days; girls could take certainly at a patients. Unique pressures hear by a pp..   Electronics  cameras             4.88       908.81        0.0442\n5   AAAAAAAAAKDNAAAA                                                                                                                                               Visitors cannot know young, spanish pages;  Electronics  cameras             4.16      8714.87        0.4240\n6   AAAAAAAAJLFAAAAA                                       Economic, ready words appear more. New, good statements must not save high, emotional notes. Attractive classes carry maybe really unknown electio  Electronics  cameras             8.94      1544.79        0.0751\n7   AAAAAAAAANCLAAAA  National terms can pursue strangely supreme feet; chairs shall injure too best effective sources. Games sense also however political men. Local, early standards can remember great, bl  Electronics  cameras             3.49     12721.31        0.6189\n8   AAAAAAAAGPACAAAA                                                                                                                                                                                Trends wo  Electronics  cameras             1.34      1144.09        0.0556\n9   AAAAAAAAODDBBAAA                                                                                                     Neat, relative races leave at least now urban reasons. Always fundamental children u  Electronics  cameras             6.60       590.47        0.0287\n10  AAAAAAAAGFECAAAA                                                                                                                                                                             Ready direct  Electronics  cameras            54.53      3963.36        0.1928\n11  AAAAAAAAFBJGBAAA                                                                                                                              Ago automatic females avoid sharply different parents. Funn  Electronics  cameras             9.60      5076.74        0.2470\n12  AAAAAAAALPAHBAAA                                                                                                                                                                        Again national so  Electronics  cameras             0.11      1425.61        0.0693\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.101293,
                    "execution_time": 0.039434,
                    "compile_time": 0.000326,
                    "planning_time": 0.044319
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.100478,
                    "execution_time": 0.037195,
                    "compile_time": 0.000344,
                    "planning_time": 0.045457
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                              i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAMBLBAAAA                                                                                                                                                                              Studies rus  Electronics  cameras             0.79     20748.15        1.0095\n1   AAAAAAAAEBIDBAAA                                                                                                                                                                                        T  Electronics  cameras             2.16      3625.75        0.1764\n2   AAAAAAAAAOHHAAAA                                                    Intellectual objects would prevent; clear, revolutionary negotiations plan here profoundly big services. National police shoot betwee  Electronics  cameras             4.07     11858.61        0.5769\n3   AAAAAAAAGDNPAAAA                                                                                                                            Present ministers used to hear much as well able deposits. Pa  Electronics  cameras             2.50     10324.99        0.5023\n4   AAAAAAAADJILAAAA                 Economic comparisons obtain overall in a sales; local, national aspects may govern arab days; girls could take certainly at a patients. Unique pressures hear by a pp..   Electronics  cameras             4.88       908.81        0.0442\n5   AAAAAAAAAKDNAAAA                                                                                                                                               Visitors cannot know young, spanish pages;  Electronics  cameras             4.16      8714.87        0.4240\n6   AAAAAAAAJLFAAAAA                                       Economic, ready words appear more. New, good statements must not save high, emotional notes. Attractive classes carry maybe really unknown electio  Electronics  cameras             8.94      1544.79        0.0751\n7   AAAAAAAAANCLAAAA  National terms can pursue strangely supreme feet; chairs shall injure too best effective sources. Games sense also however political men. Local, early standards can remember great, bl  Electronics  cameras             3.49     12721.31        0.6189\n8   AAAAAAAAGPACAAAA                                                                                                                                                                                Trends wo  Electronics  cameras             1.34      1144.09        0.0556\n9   AAAAAAAAODDBBAAA                                                                                                     Neat, relative races leave at least now urban reasons. Always fundamental children u  Electronics  cameras             6.60       590.47        0.0287\n10  AAAAAAAAGFECAAAA                                                                                                                                                                             Ready direct  Electronics  cameras            54.53      3963.36        0.1928\n11  AAAAAAAAFBJGBAAA                                                                                                                              Ago automatic females avoid sharply different parents. Funn  Electronics  cameras             9.60      5076.74        0.2470\n12  AAAAAAAALPAHBAAA                                                                                                                                                                        Again national so  Electronics  cameras             0.11      1425.61        0.0693\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                               i_item_desc i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGPHDAAAA                                                                           Brilliant ships see individually also small ministers. Expected, competitive attitudes may send there gross metres; units used      Sports  baseball             2.00     10399.81        0.4446\n1   AAAAAAAAEAJFBAAA                                                                                                                       Reforms revive inherent, french consequences. New, continuing systems would pop the     Sports  baseball             5.38      8796.54        0.3760\n2   AAAAAAAAMLDMAAAA                                                                                      Figures used to come inside real, black women. Naked players should scratch correctly good reasons. Things protect a     Sports  baseball             0.97     17185.47        0.7346\n3   AAAAAAAABBDBBAAA                                                                                                                                                                      Working guests try for a players. Ma     Sports  baseball             4.52      2673.35        0.1142\n4   AAAAAAAAECACAAAA                                                                                                                                                   Comments must not offer; valuable, annual centres shoul     Sports  baseball             9.51      4469.56        0.1910\n5   AAAAAAAALIIDBAAA                                                                                                                                   Much magnificent grounds know here social camps. Clients will determine     Sports  baseball             2.94       593.90        0.0253\n6   AAAAAAAANNJIAAAA  As industrial procedures will not discuss extra refugees. Then impossible years need meanwhile. Available, detailed letters tell. Other, worthwhile boundaries might not work angry, numerous miles. Rec     Sports  baseball             2.23      5261.57        0.2249\n7   AAAAAAAAKBPOAAAA                                           Flexible, sorry prices select letters; elements must not enforce legal, top sheets; still red votes get less massive areas. There forward properties show far f     Sports  baseball             2.04     14156.34        0.6051\n8   AAAAAAAACAAMAAAA                                          Mad shares enter alone aside domestic developments. Neither good movements damage odd, significant drugs. New, sensitive notes would not enhance provisions; ava     Sports  baseball             1.93      4475.63        0.1913\n9   AAAAAAAABDDJAAAA                                                                                                                                                                    Small, associated hands cannot feel he     Sports  baseball             2.90      1236.90        0.0528\n10  AAAAAAAAKMFCAAAA                                                                                                                                                                                    Usual, little copies j     Sports  baseball             5.06     18711.43        0.7999\n11  AAAAAAAAFMFIBAAA                                                                                                             Years cannot support rows; royal, german statements could become again for a policies. Social     Sports  baseball             4.63     13678.62        0.5847\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.097433,
                    "execution_time": 0.035843,
                    "compile_time": 0.000325,
                    "planning_time": 0.044155
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.100067,
                    "execution_time": 0.038909,
                    "compile_time": 0.000327,
                    "planning_time": 0.043587
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                               i_item_desc i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGPHDAAAA                                                                           Brilliant ships see individually also small ministers. Expected, competitive attitudes may send there gross metres; units used      Sports  baseball             2.00     10399.81        0.4446\n1   AAAAAAAAEAJFBAAA                                                                                                                       Reforms revive inherent, french consequences. New, continuing systems would pop the     Sports  baseball             5.38      8796.54        0.3760\n2   AAAAAAAAMLDMAAAA                                                                                      Figures used to come inside real, black women. Naked players should scratch correctly good reasons. Things protect a     Sports  baseball             0.97     17185.47        0.7346\n3   AAAAAAAABBDBBAAA                                                                                                                                                                      Working guests try for a players. Ma     Sports  baseball             4.52      2673.35        0.1142\n4   AAAAAAAAECACAAAA                                                                                                                                                   Comments must not offer; valuable, annual centres shoul     Sports  baseball             9.51      4469.56        0.1910\n5   AAAAAAAALIIDBAAA                                                                                                                                   Much magnificent grounds know here social camps. Clients will determine     Sports  baseball             2.94       593.90        0.0253\n6   AAAAAAAANNJIAAAA  As industrial procedures will not discuss extra refugees. Then impossible years need meanwhile. Available, detailed letters tell. Other, worthwhile boundaries might not work angry, numerous miles. Rec     Sports  baseball             2.23      5261.57        0.2249\n7   AAAAAAAAKBPOAAAA                                           Flexible, sorry prices select letters; elements must not enforce legal, top sheets; still red votes get less massive areas. There forward properties show far f     Sports  baseball             2.04     14156.34        0.6051\n8   AAAAAAAACAAMAAAA                                          Mad shares enter alone aside domestic developments. Neither good movements damage odd, significant drugs. New, sensitive notes would not enhance provisions; ava     Sports  baseball             1.93      4475.63        0.1913\n9   AAAAAAAABDDJAAAA                                                                                                                                                                    Small, associated hands cannot feel he     Sports  baseball             2.90      1236.90        0.0528\n10  AAAAAAAAKMFCAAAA                                                                                                                                                                                    Usual, little copies j     Sports  baseball             5.06     18711.43        0.7999\n11  AAAAAAAAFMFIBAAA                                                                                                             Years cannot support rows; royal, german statements could become again for a policies. Social     Sports  baseball             4.63     13678.62        0.5847\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAANJOABAAA                                                                                                                                                               Religious l  Electronics  cameras             1.97     13468.06        0.6553\n1   AAAAAAAAHEJOAAAA                                                                                                                                                                  Limited   Electronics  cameras            50.24      2690.16        0.1308\n2   AAAAAAAALONIAAAA                                                        Documents would go high; at least real methods shall choose remarkably social new words. Good, additional figures   Electronics  cameras             1.61     19433.33        0.9455\n3   AAAAAAAAKMLHBAAA                                                                                               Nationally important colleagues appear please exact terms; eyes stir partic  Electronics  cameras             1.76      1723.60        0.0838\n4   AAAAAAAAICGEAAAA                                                       Key women may not complete great relations. Italian, important friends would not go forward giant cases. Strange pl  Electronics  cameras             9.05     33533.20        1.6315\n5   AAAAAAAANKDCAAAA                                  Half original organisations allocate quite earnings. Either political parts might prove quite; statutory factors walk both new influence  Electronics  cameras             3.89      2004.80        0.0975\n6   AAAAAAAAHJOKAAAA                                                                                                                  Connections see independently communities. New, ready ye  Electronics  cameras             8.33     13239.36        0.6441\n7   AAAAAAAAEIKEAAAA                                                                             Young, simple pictures ought to achieve. Short, necessary parties used to speak so current he  Electronics  cameras             5.39      2100.24        0.1021\n8   AAAAAAAAMKFIAAAA                                 Provisions stamp no longer. Great, other opinions may not diversify recent, close centres. Different words will not translate levels. Min  Electronics  cameras             2.38      8791.14        0.4277\n9   AAAAAAAAMHKOAAAA                                                                                                                                            International, financial condi  Electronics  cameras             8.54      2408.68        0.1171\n10  AAAAAAAAEIJHAAAA                      Tiny, new pupils rest great shareholders. Elderly difficulties maintain. Potential results will work; commercial ideas will invest popular, spanish   Electronics  cameras             5.64     12895.06        0.6274\n11  AAAAAAAAPADGBAAA                                                                                                                     Palestinian, human conflicts get thick despite the vo  Electronics  cameras             5.28     11936.80        0.5807\n12  AAAAAAAALCCKAAAA                                                                                                                                 Historical, human systems can respond too  Electronics  cameras            87.46       830.21        0.0403\n13  AAAAAAAADJILAAAA  Economic comparisons obtain overall in a sales; local, national aspects may govern arab days; girls could take certainly at a patients. Unique pressures hear by a pp..   Electronics  cameras             4.88       908.81        0.0442\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.106996,
                    "execution_time": 0.044674,
                    "compile_time": 0.000333,
                    "planning_time": 0.04459
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.100794,
                    "execution_time": 0.037971,
                    "compile_time": 0.000334,
                    "planning_time": 0.044875
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc   i_category  i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAANJOABAAA                                                                                                                                                               Religious l  Electronics  cameras             1.97     13468.06        0.6553\n1   AAAAAAAAHEJOAAAA                                                                                                                                                                  Limited   Electronics  cameras            50.24      2690.16        0.1308\n2   AAAAAAAALONIAAAA                                                        Documents would go high; at least real methods shall choose remarkably social new words. Good, additional figures   Electronics  cameras             1.61     19433.33        0.9455\n3   AAAAAAAAKMLHBAAA                                                                                               Nationally important colleagues appear please exact terms; eyes stir partic  Electronics  cameras             1.76      1723.60        0.0838\n4   AAAAAAAAICGEAAAA                                                       Key women may not complete great relations. Italian, important friends would not go forward giant cases. Strange pl  Electronics  cameras             9.05     33533.20        1.6315\n5   AAAAAAAANKDCAAAA                                  Half original organisations allocate quite earnings. Either political parts might prove quite; statutory factors walk both new influence  Electronics  cameras             3.89      2004.80        0.0975\n6   AAAAAAAAHJOKAAAA                                                                                                                  Connections see independently communities. New, ready ye  Electronics  cameras             8.33     13239.36        0.6441\n7   AAAAAAAAEIKEAAAA                                                                             Young, simple pictures ought to achieve. Short, necessary parties used to speak so current he  Electronics  cameras             5.39      2100.24        0.1021\n8   AAAAAAAAMKFIAAAA                                 Provisions stamp no longer. Great, other opinions may not diversify recent, close centres. Different words will not translate levels. Min  Electronics  cameras             2.38      8791.14        0.4277\n9   AAAAAAAAMHKOAAAA                                                                                                                                            International, financial condi  Electronics  cameras             8.54      2408.68        0.1171\n10  AAAAAAAAEIJHAAAA                      Tiny, new pupils rest great shareholders. Elderly difficulties maintain. Potential results will work; commercial ideas will invest popular, spanish   Electronics  cameras             5.64     12895.06        0.6274\n11  AAAAAAAAPADGBAAA                                                                                                                     Palestinian, human conflicts get thick despite the vo  Electronics  cameras             5.28     11936.80        0.5807\n12  AAAAAAAALCCKAAAA                                                                                                                                 Historical, human systems can respond too  Electronics  cameras            87.46       830.21        0.0403\n13  AAAAAAAADJILAAAA  Economic comparisons obtain overall in a sales; local, national aspects may govern arab days; girls could take certainly at a patients. Unique pressures hear by a pp..   Electronics  cameras             4.88       908.81        0.0442\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                             i_item_desc i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAFFHAAAA                                                                                                                                                 Fully coastal rooms might not tell basic gardens; ordin     Sports  baseball             6.30     21772.78        0.9308\n1   AAAAAAAAIMGLAAAA                                                                                                                                                                                    Quite long prices mu     Sports  baseball             3.37      6088.11        0.2602\n2   AAAAAAAAIBJDBAAA                                                                                               Necessary, careful duties run today within a trees. Workers pull fine, early schools; therefore difficult     Sports  baseball             4.18      4806.90        0.2054\n3   AAAAAAAALJGIAAAA  Russian figures must look from a years. Ideas would not take running, short clergy. Public men must take model, single arts. Unaware attitudes prevail just later simple years; often different firms      Sports  baseball            78.58      2235.81        0.0955\n4   AAAAAAAACNIDAAAA                                                     Major faces cannot support now all official parties. Recent, popular rows might not regret with the prices. More large items argue. Schools purchas     Sports  baseball            97.49      1313.90        0.0561\n5   AAAAAAAAKFMEAAAA                           Only blue writings may require now black professionals. Firms ought to see ridiculous, particular interests. High, excellent standards may ensure so assistant officers. Now      Sports  baseball             3.15      8465.32        0.3618\n6   AAAAAAAAAPHBAAAA                                     Suitable, historical workers sign too always different boxes. Good, unique lessons remain facilities; increasingly old persons find very nervous hills; small provi     Sports  baseball             8.00     16816.68        0.7189\n7   AAAAAAAAMFODBAAA                                         Women might establish recent, annual years. Further industrial users ensure only because of a families. Almost competitive boundaries would make. Today whole n     Sports  baseball             0.49     24406.43        1.0433\n8   AAAAAAAAADHFBAAA                                                                                                  Americans should not see more in a companies; others think neither newspapers; attractive customers wi     Sports  baseball            73.82      7530.05        0.3219\n9   AAAAAAAALPHNAAAA                                                                                                                           Apparent subjects can get children. New, double pairs may define indeed ordin     Sports  baseball             9.44      2265.16        0.0968\n10  AAAAAAAAMOKHBAAA                                                                           Refugees hit later into a dollars. Certain, industrial cells might pass of course public feet. Cars would know traditional, l     Sports  baseball             2.32      6645.23        0.2840\n11  AAAAAAAAGIMIBAAA                               Speakers know with the students. Effective, light sessions should play too perfectly english teachers. Here right habits die even similar considerations; there familiar      Sports  baseball             1.36     13180.25        0.5634\n12  AAAAAAAAENBOAAAA                                                                                                                                                                                  General, top females s     Sports  baseball             3.40      3010.05        0.1286\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.099452,
                    "execution_time": 0.036447,
                    "compile_time": 0.000339,
                    "planning_time": 0.04505
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.102262,
                    "execution_time": 0.042208,
                    "compile_time": 0.000321,
                    "planning_time": 0.0428
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                             i_item_desc i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAFFHAAAA                                                                                                                                                 Fully coastal rooms might not tell basic gardens; ordin     Sports  baseball             6.30     21772.78        0.9308\n1   AAAAAAAAIMGLAAAA                                                                                                                                                                                    Quite long prices mu     Sports  baseball             3.37      6088.11        0.2602\n2   AAAAAAAAIBJDBAAA                                                                                               Necessary, careful duties run today within a trees. Workers pull fine, early schools; therefore difficult     Sports  baseball             4.18      4806.90        0.2054\n3   AAAAAAAALJGIAAAA  Russian figures must look from a years. Ideas would not take running, short clergy. Public men must take model, single arts. Unaware attitudes prevail just later simple years; often different firms      Sports  baseball            78.58      2235.81        0.0955\n4   AAAAAAAACNIDAAAA                                                     Major faces cannot support now all official parties. Recent, popular rows might not regret with the prices. More large items argue. Schools purchas     Sports  baseball            97.49      1313.90        0.0561\n5   AAAAAAAAKFMEAAAA                           Only blue writings may require now black professionals. Firms ought to see ridiculous, particular interests. High, excellent standards may ensure so assistant officers. Now      Sports  baseball             3.15      8465.32        0.3618\n6   AAAAAAAAAPHBAAAA                                     Suitable, historical workers sign too always different boxes. Good, unique lessons remain facilities; increasingly old persons find very nervous hills; small provi     Sports  baseball             8.00     16816.68        0.7189\n7   AAAAAAAAMFODBAAA                                         Women might establish recent, annual years. Further industrial users ensure only because of a families. Almost competitive boundaries would make. Today whole n     Sports  baseball             0.49     24406.43        1.0433\n8   AAAAAAAAADHFBAAA                                                                                                  Americans should not see more in a companies; others think neither newspapers; attractive customers wi     Sports  baseball            73.82      7530.05        0.3219\n9   AAAAAAAALPHNAAAA                                                                                                                           Apparent subjects can get children. New, double pairs may define indeed ordin     Sports  baseball             9.44      2265.16        0.0968\n10  AAAAAAAAMOKHBAAA                                                                           Refugees hit later into a dollars. Certain, industrial cells might pass of course public feet. Cars would know traditional, l     Sports  baseball             2.32      6645.23        0.2840\n11  AAAAAAAAGIMIBAAA                               Speakers know with the students. Effective, light sessions should play too perfectly english teachers. Here right habits die even similar considerations; there familiar      Sports  baseball             1.36     13180.25        0.5634\n12  AAAAAAAAENBOAAAA                                                                                                                                                                                  General, top females s     Sports  baseball             3.40      3010.05        0.1286\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                         i_item_desc i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAEAJNAAAA                                                                                                                                                                                  Possible schools t     Sports  baseball             3.06     11007.83        0.4705\n1   AAAAAAAANAIEAAAA  Therefore manufacturing subjects wait at a processes. Pregnant shares should exclude almost months. Less essential phrases may kill approaches. Now reasonable concerns ought to blame slowly for      Sports  baseball             3.69      9180.46        0.3924\n2   AAAAAAAAAPEABAAA                                                                                                                                                           Plans give still linguistic, unfair detai     Sports  baseball             4.27     22142.89        0.9466\n3   AAAAAAAANODKAAAA                                                                                                  European, future firms may write barely in the conditions. Customers could win rarely in the words     Sports  baseball             2.41      7312.98        0.3126\n4   AAAAAAAAIBIIAAAA                                                                                   Years say almost by a subjects; urban, inner areas create again intently sure symptoms. Continuing police get als     Sports  baseball             4.92      3068.25        0.1311\n5   AAAAAAAAIGNEAAAA                                                                                                                         Present, happy lives stay wrong structures. Police use actually brothers. H     Sports  baseball             2.69      6743.24        0.2882\n6   AAAAAAAAOLHDAAAA                                                                                                                                                   All dead months consent recently open schemes. Ph     Sports  baseball             3.96      3748.76        0.1602\n7   AAAAAAAAIJNBAAAA                                                                                                                                      Equal situations write very in the tears. Long representative      Sports  baseball             4.24     10323.99        0.4413\n8   AAAAAAAAAOJGAAAA         Possible, clear records will produce over hours. Rich, working-class accounts used to justify. Substantially compatible clouds appear however public forces. All actual purposes could not      Sports  baseball             1.40      4393.92        0.1878\n9   AAAAAAAACPKHAAAA                                                                                                             Boards should put. Initial products appeal mildly as black organizations. Artists find      Sports  baseball            97.60      5975.13        0.2554\n10  AAAAAAAAMNNOAAAA                                                                                                                                                                      Linear, common years should qu     Sports  baseball             1.00      7782.84        0.3327\n11  AAAAAAAAMMBCBAAA                                                                                            Often possible meetings ought to get practices. Social, original events ought to lose just indeed increa     Sports  baseball             1.75     10482.62        0.4481\n12  AAAAAAAAGDDEBAAA                                                                                                                       Mere substances hear gravely dutch companies; public islands follow indeed ot     Sports  baseball            49.97      4848.69        0.2072\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.100094,
                    "execution_time": 0.037965,
                    "compile_time": 0.000327,
                    "planning_time": 0.044687
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.099388,
                    "execution_time": 0.037634,
                    "compile_time": 0.00034,
                    "planning_time": 0.043807
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                         i_item_desc i_category   i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAEAJNAAAA                                                                                                                                                                                  Possible schools t     Sports  baseball             3.06     11007.83        0.4705\n1   AAAAAAAANAIEAAAA  Therefore manufacturing subjects wait at a processes. Pregnant shares should exclude almost months. Less essential phrases may kill approaches. Now reasonable concerns ought to blame slowly for      Sports  baseball             3.69      9180.46        0.3924\n2   AAAAAAAAAPEABAAA                                                                                                                                                           Plans give still linguistic, unfair detai     Sports  baseball             4.27     22142.89        0.9466\n3   AAAAAAAANODKAAAA                                                                                                  European, future firms may write barely in the conditions. Customers could win rarely in the words     Sports  baseball             2.41      7312.98        0.3126\n4   AAAAAAAAIBIIAAAA                                                                                   Years say almost by a subjects; urban, inner areas create again intently sure symptoms. Continuing police get als     Sports  baseball             4.92      3068.25        0.1311\n5   AAAAAAAAIGNEAAAA                                                                                                                         Present, happy lives stay wrong structures. Police use actually brothers. H     Sports  baseball             2.69      6743.24        0.2882\n6   AAAAAAAAOLHDAAAA                                                                                                                                                   All dead months consent recently open schemes. Ph     Sports  baseball             3.96      3748.76        0.1602\n7   AAAAAAAAIJNBAAAA                                                                                                                                      Equal situations write very in the tears. Long representative      Sports  baseball             4.24     10323.99        0.4413\n8   AAAAAAAAAOJGAAAA         Possible, clear records will produce over hours. Rich, working-class accounts used to justify. Substantially compatible clouds appear however public forces. All actual purposes could not      Sports  baseball             1.40      4393.92        0.1878\n9   AAAAAAAACPKHAAAA                                                                                                             Boards should put. Initial products appeal mildly as black organizations. Artists find      Sports  baseball            97.60      5975.13        0.2554\n10  AAAAAAAAMNNOAAAA                                                                                                                                                                      Linear, common years should qu     Sports  baseball             1.00      7782.84        0.3327\n11  AAAAAAAAMMBCBAAA                                                                                            Often possible meetings ought to get practices. Social, original events ought to lose just indeed increa     Sports  baseball             1.75     10482.62        0.4481\n12  AAAAAAAAGDDEBAAA                                                                                                                       Mere substances hear gravely dutch companies; public islands follow indeed ot     Sports  baseball            49.97      4848.69        0.2072\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n order by i_category\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                            i_item_desc   i_category     i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAILCBAAA               Areas will give tomorrow things. Well genetic rights think almost injuries. Months go well young years; perhaps single points believe at a publications. Otherwise golden christians see  Electronics     cameras             1.97      1705.72        0.0829\n1   AAAAAAAAEDKFBAAA  Tall eyes can score free, normal problems; ideas maintain from a children. Else disciplinary libraries should attack most fiscal great things. Together afraid affairs will not say as fashionable re  Electronics  automotive             7.36      5175.36        0.2565\n2   AAAAAAAAIMHKAAAA                                                                                                                                                                           Factors may not persuade lit  Electronics      karoke             2.53      5567.21        0.2554\n3   AAAAAAAAOLLKAAAA                                                                                         Shoulders see as small things. Good, quiet roots might not stand right large businessmen. Inc, double boots mu  Electronics     cameras             4.70     12363.02        0.6015\n4   AAAAAAAAGONEBAAA                                                                                              International proteins could feel always fiscal theories. So local systems treat; times pass. Aware effec  Electronics  automotive            11.20      3044.90        0.1509\n5   AAAAAAAAAOBBBAAA                                                              Details may not die with a tonnes. Cars ought to ring agencies. Weeks make in an minerals. However potential characteristics would like p  Electronics      karoke             4.57      7282.47        0.3341\n6   AAAAAAAALGMHBAAA                                                                                                                                                                                     Alternatively blin  Electronics     cameras             6.53      8567.50        0.4168\n7   AAAAAAAAGJFIAAAA                                                                                                                                               Hands learn below crowds. Tasks practise on the sites. T  Electronics  automotive             0.10     12728.31        0.6309\n8   AAAAAAAAIDHBAAAA                                                Precise techniques must not take. Orange, illegal issues pay more new issues. Only positive rights might not fast perhaps difficult hot agents. Police   Electronics      karoke             2.21      9942.42        0.4561\n9   AAAAAAAAGFKBAAAA           Only young colleges will get nearly more major structures. Pink colleagues will employ fairly wooden objections. Leaders react around powers. Accounts might manifest northern varieties; im  Electronics     cameras             3.15      2878.53        0.1400\n10  AAAAAAAAIEABAAAA                                                                                                                                             Then real weeks pay sharp, new procedures; personal occasi  Electronics  automotive             5.54     25185.14        1.2483\n11  AAAAAAAALDCMAAAA                                                                                             Detailed scholars get however birds. Continually likely inches try closely special companies. Sons say mor  Electronics      karoke            26.08     19965.52        0.9160\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.101154,
                    "execution_time": 0.039461,
                    "compile_time": 0.000354,
                    "planning_time": 0.044424
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.170951,
                    "execution_time": 0.040459,
                    "compile_time": 0.000377,
                    "planning_time": 0.111166
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                            i_item_desc   i_category     i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAILCBAAA               Areas will give tomorrow things. Well genetic rights think almost injuries. Months go well young years; perhaps single points believe at a publications. Otherwise golden christians see  Electronics     cameras             1.97      1705.72        0.0829\n1   AAAAAAAAEDKFBAAA  Tall eyes can score free, normal problems; ideas maintain from a children. Else disciplinary libraries should attack most fiscal great things. Together afraid affairs will not say as fashionable re  Electronics  automotive             7.36      5175.36        0.2565\n2   AAAAAAAAIMHKAAAA                                                                                                                                                                           Factors may not persuade lit  Electronics      karoke             2.53      5567.21        0.2554\n3   AAAAAAAAOLLKAAAA                                                                                         Shoulders see as small things. Good, quiet roots might not stand right large businessmen. Inc, double boots mu  Electronics     cameras             4.70     12363.02        0.6015\n4   AAAAAAAAGONEBAAA                                                                                              International proteins could feel always fiscal theories. So local systems treat; times pass. Aware effec  Electronics  automotive            11.20      3044.90        0.1509\n5   AAAAAAAAAOBBBAAA                                                              Details may not die with a tonnes. Cars ought to ring agencies. Weeks make in an minerals. However potential characteristics would like p  Electronics      karoke             4.57      7282.47        0.3341\n6   AAAAAAAALGMHBAAA                                                                                                                                                                                     Alternatively blin  Electronics     cameras             6.53      8567.50        0.4168\n7   AAAAAAAAGJFIAAAA                                                                                                                                               Hands learn below crowds. Tasks practise on the sites. T  Electronics  automotive             0.10     12728.31        0.6309\n8   AAAAAAAAIDHBAAAA                                                Precise techniques must not take. Orange, illegal issues pay more new issues. Only positive rights might not fast perhaps difficult hot agents. Police   Electronics      karoke             2.21      9942.42        0.4561\n9   AAAAAAAAGFKBAAAA           Only young colleges will get nearly more major structures. Pink colleagues will employ fairly wooden objections. Leaders react around powers. Accounts might manifest northern varieties; im  Electronics     cameras             3.15      2878.53        0.1400\n10  AAAAAAAAIEABAAAA                                                                                                                                             Then real weeks pay sharp, new procedures; personal occasi  Electronics  automotive             5.54     25185.14        1.2483\n11  AAAAAAAALDCMAAAA                                                                                             Detailed scholars get however birds. Continually likely inches try closely special companies. Sons say mor  Electronics      karoke            26.08     19965.52        0.9160\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n order by i_category\n         ,i_class\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAHPDFBAAA                                                                                                                                                                            Electronics                     1.24     24283.24       18.4890\n1   AAAAAAAAAHJKAAAA                                                                                                                                                                       Sma  Electronics                      NaN      1233.30        0.9390\n2   AAAAAAAAOFEJAAAA                                                                                                                                                                        Be  Electronics                    49.14      1829.24        1.3927\n3   AAAAAAAAGCDEBAAA                                                                                                                                                                            Electronics                      NaN     10704.96        8.1506\n4   AAAAAAAAEOGIAAAA                                                                                                                                                                            Electronics                      NaN       477.54        0.3635\n5   AAAAAAAAMBLLAAAA                              Little new years buy things; head institutions may score then images. Dark years remember offences; terms talk casually deep aims. Much wide  Electronics   audio             8.91     16327.98        0.6411\n6   AAAAAAAAMIEDBAAA                                                            Centres issue all pp.. Healthy, industrial complaints used to hope of course red others; excellent, new centur  Electronics   audio             2.78     13681.70        0.5372\n7   AAAAAAAAIBHDAAAA    Years might not limit possibly resources. Components might achieve however formidable poles. Wild weeks want both certain factors. Cultural days shall take difficult,  Electronics   audio             9.42     19461.69        0.7642\n8   AAAAAAAADEDFBAAA                              New, national needs show necessarily. Relatively international years get now national years. Models expect mainly really national bands. Wel  Electronics   audio             0.67      9630.72        0.3781\n9   AAAAAAAADLPEBAAA                                                                                                    Conscious relationships might refer good, single increases. Coming, ba  Electronics   audio             1.87      2945.58        0.1156\n10  AAAAAAAABLEPAAAA                                                                              Sorry, certain roots will love stiffly political, familiar personnel. Still blue men come fa  Electronics   audio             1.46      9583.96        0.3763\n11  AAAAAAAAEAGDBAAA                                                                                                               Clearly possible reasons call. Charming substances rate spe  Electronics   audio             0.88      5476.53        0.2150\n12  AAAAAAAAHLHIBAAA                                 Successful, alternative effects glance leaves. Central, similar companies smile necessary machines. Then true computers help as a service  Electronics   audio             1.46     18085.20        0.7101\n13  AAAAAAAAOGBBAAAA                                                                                                           Common, big performances look often directly dead offices; inst  Electronics   audio             0.09     13687.29        0.5374\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.101998,
                    "execution_time": 0.0387,
                    "compile_time": 0.000362,
                    "planning_time": 0.04509
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.163491,
                    "execution_time": 0.036011,
                    "compile_time": 0.000359,
                    "planning_time": 0.110261
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAHPDFBAAA                                                                                                                                                                            Electronics                     1.24     24283.24       18.4890\n1   AAAAAAAAAHJKAAAA                                                                                                                                                                       Sma  Electronics                      NaN      1233.30        0.9390\n2   AAAAAAAAOFEJAAAA                                                                                                                                                                        Be  Electronics                    49.14      1829.24        1.3927\n3   AAAAAAAAGCDEBAAA                                                                                                                                                                            Electronics                      NaN     10704.96        8.1506\n4   AAAAAAAAEOGIAAAA                                                                                                                                                                            Electronics                      NaN       477.54        0.3635\n5   AAAAAAAAMBLLAAAA                              Little new years buy things; head institutions may score then images. Dark years remember offences; terms talk casually deep aims. Much wide  Electronics   audio             8.91     16327.98        0.6411\n6   AAAAAAAAMIEDBAAA                                                            Centres issue all pp.. Healthy, industrial complaints used to hope of course red others; excellent, new centur  Electronics   audio             2.78     13681.70        0.5372\n7   AAAAAAAAIBHDAAAA    Years might not limit possibly resources. Components might achieve however formidable poles. Wild weeks want both certain factors. Cultural days shall take difficult,  Electronics   audio             9.42     19461.69        0.7642\n8   AAAAAAAADEDFBAAA                              New, national needs show necessarily. Relatively international years get now national years. Models expect mainly really national bands. Wel  Electronics   audio             0.67      9630.72        0.3781\n9   AAAAAAAADLPEBAAA                                                                                                    Conscious relationships might refer good, single increases. Coming, ba  Electronics   audio             1.87      2945.58        0.1156\n10  AAAAAAAABLEPAAAA                                                                              Sorry, certain roots will love stiffly political, familiar personnel. Still blue men come fa  Electronics   audio             1.46      9583.96        0.3763\n11  AAAAAAAAEAGDBAAA                                                                                                               Clearly possible reasons call. Charming substances rate spe  Electronics   audio             0.88      5476.53        0.2150\n12  AAAAAAAAHLHIBAAA                                 Successful, alternative effects glance leaves. Central, similar companies smile necessary machines. Then true computers help as a service  Electronics   audio             1.46     18085.20        0.7101\n13  AAAAAAAAOGBBAAAA                                                                                                           Common, big performances look often directly dead offices; inst  Electronics   audio             0.09     13687.29        0.5374\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n order by i_category\n         ,i_class\n         ,i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                           i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAHJKAAAA                                                                                                                                                                                                   Sma  Electronics                      NaN      1233.30        0.9390\n1   AAAAAAAAEOGIAAAA                                                                                                                                                                                                        Electronics                      NaN       477.54        0.3635\n2   AAAAAAAAGCDEBAAA                                                                                                                                                                                                        Electronics                      NaN     10704.96        8.1506\n3   AAAAAAAAHPDFBAAA                                                                                                                                                                                                        Electronics                     1.24     24283.24       18.4890\n4   AAAAAAAAOFEJAAAA                                                                                                                                                                                                    Be  Electronics                    49.14      1829.24        1.3927\n5   AAAAAAAAABGIBAAA                        Social members could not feed in a principles. Coins reduce unduly even social wives; single proteins shall appeal falls. Upper, awkward others present official boys. Still m  Electronics   audio             4.32      9324.22        0.3661\n6   AAAAAAAAACJGAAAA                                               Sometimes inc measurements avoid otherwise. Modern payments appear quite nuclear faces. Positive, american records permit at no devices. Convincing, fo  Electronics   audio             7.83      1062.84        0.0417\n7   AAAAAAAAACNDBAAA                                                                            Ever total minutes must not call; words should say currently small girls. Jobs eat merely. Golden, political eyes should k  Electronics   audio             1.13      4015.13        0.1576\n8   AAAAAAAAAEFABAAA                                                                                                                                                      There wrong polls will not transform above a mod  Electronics   audio             0.69      6946.48        0.2727\n9   AAAAAAAAAFAFAAAA                                                                                                                                                 Democratic, old markets shall not hear at least in a   Electronics   audio             3.28      5807.56        0.2280\n10  AAAAAAAAAFCFBAAA                                                                                                                                                          Linear friends cannot deliver as with a peop  Electronics   audio             8.97     21343.86        0.8381\n11  AAAAAAAAAGLDAAAA                                                                                          Disciplinary colleges increase in the managers. Ministers stand. Important years carry never charming intere  Electronics   audio             2.58     13137.65        0.5158\n12  AAAAAAAAAGMBBAAA                                                                                                                         Likely cases prove just men. In addition key changes make recent words. Socia  Electronics   audio             1.33      6084.45        0.2389\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.100992,
                    "execution_time": 0.038645,
                    "compile_time": 0.000369,
                    "planning_time": 0.0452
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.168162,
                    "execution_time": 0.038317,
                    "compile_time": 0.000357,
                    "planning_time": 0.112316
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                           i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAHJKAAAA                                                                                                                                                                                                   Sma  Electronics                      NaN      1233.30        0.9390\n1   AAAAAAAAEOGIAAAA                                                                                                                                                                                                        Electronics                      NaN       477.54        0.3635\n2   AAAAAAAAGCDEBAAA                                                                                                                                                                                                        Electronics                      NaN     10704.96        8.1506\n3   AAAAAAAAHPDFBAAA                                                                                                                                                                                                        Electronics                     1.24     24283.24       18.4890\n4   AAAAAAAAOFEJAAAA                                                                                                                                                                                                    Be  Electronics                    49.14      1829.24        1.3927\n5   AAAAAAAAABGIBAAA                        Social members could not feed in a principles. Coins reduce unduly even social wives; single proteins shall appeal falls. Upper, awkward others present official boys. Still m  Electronics   audio             4.32      9324.22        0.3661\n6   AAAAAAAAACJGAAAA                                               Sometimes inc measurements avoid otherwise. Modern payments appear quite nuclear faces. Positive, american records permit at no devices. Convincing, fo  Electronics   audio             7.83      1062.84        0.0417\n7   AAAAAAAAACNDBAAA                                                                            Ever total minutes must not call; words should say currently small girls. Jobs eat merely. Golden, political eyes should k  Electronics   audio             1.13      4015.13        0.1576\n8   AAAAAAAAAEFABAAA                                                                                                                                                      There wrong polls will not transform above a mod  Electronics   audio             0.69      6946.48        0.2727\n9   AAAAAAAAAFAFAAAA                                                                                                                                                 Democratic, old markets shall not hear at least in a   Electronics   audio             3.28      5807.56        0.2280\n10  AAAAAAAAAFCFBAAA                                                                                                                                                          Linear friends cannot deliver as with a peop  Electronics   audio             8.97     21343.86        0.8381\n11  AAAAAAAAAGLDAAAA                                                                                          Disciplinary colleges increase in the managers. Ministers stand. Important years carry never charming intere  Electronics   audio             2.58     13137.65        0.5158\n12  AAAAAAAAAGMBBAAA                                                                                                                         Likely cases prove just men. In addition key changes make recent words. Socia  Electronics   audio             1.33      6084.45        0.2389\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n order by i_category\n         ,i_class\n         ,i_item_id\n         ,i_item_desc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                           i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAHJKAAAA                                                                                                                                                                                                   Sma  Electronics                      NaN      1233.30        0.9390\n1   AAAAAAAAEOGIAAAA                                                                                                                                                                                                        Electronics                      NaN       477.54        0.3635\n2   AAAAAAAAGCDEBAAA                                                                                                                                                                                                        Electronics                      NaN     10704.96        8.1506\n3   AAAAAAAAHPDFBAAA                                                                                                                                                                                                        Electronics                     1.24     24283.24       18.4890\n4   AAAAAAAAOFEJAAAA                                                                                                                                                                                                    Be  Electronics                    49.14      1829.24        1.3927\n5   AAAAAAAAABGIBAAA                        Social members could not feed in a principles. Coins reduce unduly even social wives; single proteins shall appeal falls. Upper, awkward others present official boys. Still m  Electronics   audio             4.32      9324.22        0.3661\n6   AAAAAAAAACJGAAAA                                               Sometimes inc measurements avoid otherwise. Modern payments appear quite nuclear faces. Positive, american records permit at no devices. Convincing, fo  Electronics   audio             7.83      1062.84        0.0417\n7   AAAAAAAAACNDBAAA                                                                            Ever total minutes must not call; words should say currently small girls. Jobs eat merely. Golden, political eyes should k  Electronics   audio             1.13      4015.13        0.1576\n8   AAAAAAAAAEFABAAA                                                                                                                                                      There wrong polls will not transform above a mod  Electronics   audio             0.69      6946.48        0.2727\n9   AAAAAAAAAFAFAAAA                                                                                                                                                 Democratic, old markets shall not hear at least in a   Electronics   audio             3.28      5807.56        0.2280\n10  AAAAAAAAAFCFBAAA                                                                                                                                                          Linear friends cannot deliver as with a peop  Electronics   audio             8.97     21343.86        0.8381\n11  AAAAAAAAAGLDAAAA                                                                                          Disciplinary colleges increase in the managers. Ministers stand. Important years carry never charming intere  Electronics   audio             2.58     13137.65        0.5158\n12  AAAAAAAAAGMBBAAA                                                                                                                         Likely cases prove just men. In addition key changes make recent words. Socia  Electronics   audio             1.33      6084.45        0.2389\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.100626,
                    "execution_time": 0.038298,
                    "compile_time": 0.000364,
                    "planning_time": 0.044815
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.166682,
                    "execution_time": 0.03819,
                    "compile_time": 0.000371,
                    "planning_time": 0.110557
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                           i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAHJKAAAA                                                                                                                                                                                                   Sma  Electronics                      NaN      1233.30        0.9390\n1   AAAAAAAAEOGIAAAA                                                                                                                                                                                                        Electronics                      NaN       477.54        0.3635\n2   AAAAAAAAGCDEBAAA                                                                                                                                                                                                        Electronics                      NaN     10704.96        8.1506\n3   AAAAAAAAHPDFBAAA                                                                                                                                                                                                        Electronics                     1.24     24283.24       18.4890\n4   AAAAAAAAOFEJAAAA                                                                                                                                                                                                    Be  Electronics                    49.14      1829.24        1.3927\n5   AAAAAAAAABGIBAAA                        Social members could not feed in a principles. Coins reduce unduly even social wives; single proteins shall appeal falls. Upper, awkward others present official boys. Still m  Electronics   audio             4.32      9324.22        0.3661\n6   AAAAAAAAACJGAAAA                                               Sometimes inc measurements avoid otherwise. Modern payments appear quite nuclear faces. Positive, american records permit at no devices. Convincing, fo  Electronics   audio             7.83      1062.84        0.0417\n7   AAAAAAAAACNDBAAA                                                                            Ever total minutes must not call; words should say currently small girls. Jobs eat merely. Golden, political eyes should k  Electronics   audio             1.13      4015.13        0.1576\n8   AAAAAAAAAEFABAAA                                                                                                                                                      There wrong polls will not transform above a mod  Electronics   audio             0.69      6946.48        0.2727\n9   AAAAAAAAAFAFAAAA                                                                                                                                                 Democratic, old markets shall not hear at least in a   Electronics   audio             3.28      5807.56        0.2280\n10  AAAAAAAAAFCFBAAA                                                                                                                                                          Linear friends cannot deliver as with a peop  Electronics   audio             8.97     21343.86        0.8381\n11  AAAAAAAAAGLDAAAA                                                                                          Disciplinary colleges increase in the managers. Ministers stand. Important years carry never charming intere  Electronics   audio             2.58     13137.65        0.5158\n12  AAAAAAAAAGMBBAAA                                                                                                                         Likely cases prove just men. In addition key changes make recent words. Socia  Electronics   audio             1.33      6084.45        0.2389\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n order by i_category\n         ,i_class\n         ,i_item_id\n         ,i_item_desc\n         ,revenueratio\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST , \"REVENUERATIO\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST , REVENUERATIO NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                           i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAHJKAAAA                                                                                                                                                                                                   Sma  Electronics                      NaN      1233.30        0.9390\n1   AAAAAAAAEOGIAAAA                                                                                                                                                                                                        Electronics                      NaN       477.54        0.3635\n2   AAAAAAAAGCDEBAAA                                                                                                                                                                                                        Electronics                      NaN     10704.96        8.1506\n3   AAAAAAAAHPDFBAAA                                                                                                                                                                                                        Electronics                     1.24     24283.24       18.4890\n4   AAAAAAAAOFEJAAAA                                                                                                                                                                                                    Be  Electronics                    49.14      1829.24        1.3927\n5   AAAAAAAAABGIBAAA                        Social members could not feed in a principles. Coins reduce unduly even social wives; single proteins shall appeal falls. Upper, awkward others present official boys. Still m  Electronics   audio             4.32      9324.22        0.3661\n6   AAAAAAAAACJGAAAA                                               Sometimes inc measurements avoid otherwise. Modern payments appear quite nuclear faces. Positive, american records permit at no devices. Convincing, fo  Electronics   audio             7.83      1062.84        0.0417\n7   AAAAAAAAACNDBAAA                                                                            Ever total minutes must not call; words should say currently small girls. Jobs eat merely. Golden, political eyes should k  Electronics   audio             1.13      4015.13        0.1576\n8   AAAAAAAAAEFABAAA                                                                                                                                                      There wrong polls will not transform above a mod  Electronics   audio             0.69      6946.48        0.2727\n9   AAAAAAAAAFAFAAAA                                                                                                                                                 Democratic, old markets shall not hear at least in a   Electronics   audio             3.28      5807.56        0.2280\n10  AAAAAAAAAFCFBAAA                                                                                                                                                          Linear friends cannot deliver as with a peop  Electronics   audio             8.97     21343.86        0.8381\n11  AAAAAAAAAGLDAAAA                                                                                          Disciplinary colleges increase in the managers. Ministers stand. Important years carry never charming intere  Electronics   audio             2.58     13137.65        0.5158\n12  AAAAAAAAAGMBBAAA                                                                                                                         Likely cases prove just men. In addition key changes make recent words. Socia  Electronics   audio             1.33      6084.45        0.2389\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.157182,
                    "execution_time": 0.041729,
                    "compile_time": 0.053557,
                    "planning_time": 0.044291
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.278223,
                    "execution_time": 0.05351,
                    "compile_time": 3.092348,
                    "planning_time": 0.112481
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST, \"REVENUERATIO\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                           i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAHJKAAAA                                                                                                                                                                                                   Sma  Electronics                      NaN      1233.30        0.9390\n1   AAAAAAAAEOGIAAAA                                                                                                                                                                                                        Electronics                      NaN       477.54        0.3635\n2   AAAAAAAAGCDEBAAA                                                                                                                                                                                                        Electronics                      NaN     10704.96        8.1506\n3   AAAAAAAAHPDFBAAA                                                                                                                                                                                                        Electronics                     1.24     24283.24       18.4890\n4   AAAAAAAAOFEJAAAA                                                                                                                                                                                                    Be  Electronics                    49.14      1829.24        1.3927\n5   AAAAAAAAABGIBAAA                        Social members could not feed in a principles. Coins reduce unduly even social wives; single proteins shall appeal falls. Upper, awkward others present official boys. Still m  Electronics   audio             4.32      9324.22        0.3661\n6   AAAAAAAAACJGAAAA                                               Sometimes inc measurements avoid otherwise. Modern payments appear quite nuclear faces. Positive, american records permit at no devices. Convincing, fo  Electronics   audio             7.83      1062.84        0.0417\n7   AAAAAAAAACNDBAAA                                                                            Ever total minutes must not call; words should say currently small girls. Jobs eat merely. Golden, political eyes should k  Electronics   audio             1.13      4015.13        0.1576\n8   AAAAAAAAAEFABAAA                                                                                                                                                      There wrong polls will not transform above a mod  Electronics   audio             0.69      6946.48        0.2727\n9   AAAAAAAAAFAFAAAA                                                                                                                                                 Democratic, old markets shall not hear at least in a   Electronics   audio             3.28      5807.56        0.2280\n10  AAAAAAAAAFCFBAAA                                                                                                                                                          Linear friends cannot deliver as with a peop  Electronics   audio             8.97     21343.86        0.8381\n11  AAAAAAAAAGLDAAAA                                                                                          Disciplinary colleges increase in the managers. Ministers stand. Important years carry never charming intere  Electronics   audio             2.58     13137.65        0.5158\n12  AAAAAAAAAGMBBAAA                                                                                                                         Likely cases prove just men. In addition key changes make recent words. Socia  Electronics   audio             1.33      6084.45        0.2389\n...*/"
    },
    {
        "input": "-- start template query20.tpl query 65 in stream 0\nselect /* TPC-DS query20.tpl 0.65 */  i_item_id\n       ,i_item_desc \n       ,i_category \n       ,i_class \n       ,i_current_price\n       ,sum(cs_ext_sales_price) as itemrevenue \n       ,sum(cs_ext_sales_price)*100/sum(sum(cs_ext_sales_price)) over\n           (partition by i_class) as revenueratio\n from\tcatalog_sales\n     ,item \n     ,date_dim\n where cs_item_sk = i_item_sk \n   and i_category in ('Shoes', 'Sports', 'Electronics')\n   and cs_sold_date_sk = d_date_sk\n and d_date between cast('1998-05-13' as date) \n \t\t\t\tand dateadd(day,30,cast('1998-05-13' as date))\n group by i_item_id\n         ,i_item_desc \n         ,i_category\n         ,i_class\n         ,i_current_price\n order by i_category\n         ,i_class\n         ,i_item_id\n         ,i_item_desc\n         ,revenueratio\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-05-13' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ( 'Shoes' , 'Sports' , 'Electronics' ) GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST , \"REVENUERATIO\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( CS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( CS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( CS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM CATALOG_SALES , ITEM , DATE_DIM WHERE CS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Shoes' , 'Sports' , 'Electronics' ) AND CS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-05-13' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '1998-05-13' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST , REVENUERATIO NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                           i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAHJKAAAA                                                                                                                                                                                                   Sma  Electronics                      NaN      1233.30        0.9390\n1   AAAAAAAAEOGIAAAA                                                                                                                                                                                                        Electronics                      NaN       477.54        0.3635\n2   AAAAAAAAGCDEBAAA                                                                                                                                                                                                        Electronics                      NaN     10704.96        8.1506\n3   AAAAAAAAHPDFBAAA                                                                                                                                                                                                        Electronics                     1.24     24283.24       18.4890\n4   AAAAAAAAOFEJAAAA                                                                                                                                                                                                    Be  Electronics                    49.14      1829.24        1.3927\n5   AAAAAAAAABGIBAAA                        Social members could not feed in a principles. Coins reduce unduly even social wives; single proteins shall appeal falls. Upper, awkward others present official boys. Still m  Electronics   audio             4.32      9324.22        0.3661\n6   AAAAAAAAACJGAAAA                                               Sometimes inc measurements avoid otherwise. Modern payments appear quite nuclear faces. Positive, american records permit at no devices. Convincing, fo  Electronics   audio             7.83      1062.84        0.0417\n7   AAAAAAAAACNDBAAA                                                                            Ever total minutes must not call; words should say currently small girls. Jobs eat merely. Golden, political eyes should k  Electronics   audio             1.13      4015.13        0.1576\n8   AAAAAAAAAEFABAAA                                                                                                                                                      There wrong polls will not transform above a mod  Electronics   audio             0.69      6946.48        0.2727\n9   AAAAAAAAAFAFAAAA                                                                                                                                                 Democratic, old markets shall not hear at least in a   Electronics   audio             3.28      5807.56        0.2280\n10  AAAAAAAAAFCFBAAA                                                                                                                                                          Linear friends cannot deliver as with a peop  Electronics   audio             8.97     21343.86        0.8381\n11  AAAAAAAAAGLDAAAA                                                                                          Disciplinary colleges increase in the managers. Ministers stand. Important years carry never charming intere  Electronics   audio             2.58     13137.65        0.5158\n12  AAAAAAAAAGMBBAAA                                                                                                                         Likely cases prove just men. In addition key changes make recent words. Socia  Electronics   audio             1.33      6084.45        0.2389\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.116204,
                    "execution_time": 0.052428,
                    "compile_time": 0.000363,
                    "planning_time": 0.045829
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.108862,
                    "execution_time": 0.045101,
                    "compile_time": 0.000384,
                    "planning_time": 0.045192
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-05-13' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" AND \"ITEM\".\"I_CATEGORY\" IN ('Shoes', 'Sports', 'Electronics') GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST, \"REVENUERATIO\" NULLS LAST LIMIT 100",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                           i_item_desc   i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAHJKAAAA                                                                                                                                                                                                   Sma  Electronics                      NaN      1233.30        0.9390\n1   AAAAAAAAEOGIAAAA                                                                                                                                                                                                        Electronics                      NaN       477.54        0.3635\n2   AAAAAAAAGCDEBAAA                                                                                                                                                                                                        Electronics                      NaN     10704.96        8.1506\n3   AAAAAAAAHPDFBAAA                                                                                                                                                                                                        Electronics                     1.24     24283.24       18.4890\n4   AAAAAAAAOFEJAAAA                                                                                                                                                                                                    Be  Electronics                    49.14      1829.24        1.3927\n5   AAAAAAAAABGIBAAA                        Social members could not feed in a principles. Coins reduce unduly even social wives; single proteins shall appeal falls. Upper, awkward others present official boys. Still m  Electronics   audio             4.32      9324.22        0.3661\n6   AAAAAAAAACJGAAAA                                               Sometimes inc measurements avoid otherwise. Modern payments appear quite nuclear faces. Positive, american records permit at no devices. Convincing, fo  Electronics   audio             7.83      1062.84        0.0417\n7   AAAAAAAAACNDBAAA                                                                            Ever total minutes must not call; words should say currently small girls. Jobs eat merely. Golden, political eyes should k  Electronics   audio             1.13      4015.13        0.1576\n8   AAAAAAAAAEFABAAA                                                                                                                                                      There wrong polls will not transform above a mod  Electronics   audio             0.69      6946.48        0.2727\n9   AAAAAAAAAFAFAAAA                                                                                                                                                 Democratic, old markets shall not hear at least in a   Electronics   audio             3.28      5807.56        0.2280\n10  AAAAAAAAAFCFBAAA                                                                                                                                                          Linear friends cannot deliver as with a peop  Electronics   audio             8.97     21343.86        0.8381\n11  AAAAAAAAAGLDAAAA                                                                                          Disciplinary colleges increase in the managers. Ministers stand. Important years carry never charming intere  Electronics   audio             2.58     13137.65        0.5158\n12  AAAAAAAAAGMBBAAA                                                                                                                         Likely cases prove just men. In addition key changes make recent words. Socia  Electronics   audio             1.33      6084.45        0.2389\n...*/"
    }
]