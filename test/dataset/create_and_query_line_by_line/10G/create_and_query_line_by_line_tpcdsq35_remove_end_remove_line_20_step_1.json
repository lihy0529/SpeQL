[
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\nfrom\n  customer c, customer_address ca, customer_demographics cd\nwhere\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd.cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales ss, date_dim d\n          where c.c_customer_sk = ss.ss_customer_sk and\n                ss.ss_sold_date_sk = d.d_date_sk and\n                d.d_year = 1999 and\n                d.d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk as customsk\n            from web_sales ws, date_dim d\n            where \n                  ws.ws_sold_date_sk = d.d_date_sk and\n                  d.d_year = 1999 and\n                  d.d_qoy < 4\n\t    union all \n            select cs_bill_customer_sk as customsk\n            from catalog_sales cs, date_dim d\n            where \n                  cs.cs_sold_date_sk = d.d_date_sk and\n                  d.d_year = 1999 and\n                  d.d_qoy < 4\n           ) x\n           where customsk = c.c_customer_sk)\ngroup by\n  ca_state, \n  cd_gender, \n  cd_marital_status, \n  cd_dep_count, \n  cd_dep_employed_count, \n  cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" AND \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999 GROUP BY \"SS\".\"SS_CUSTOMER_SK\" ) , \"D_2\" AS ( SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_YEAR\" AS \"D_YEAR\" , \"D\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"D_2\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CS\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"D_2\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" AND \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999 GROUP BY \"SS\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.186668,
                    "execution_time": 0.076462,
                    "compile_time": 0.000356,
                    "planning_time": 0.034151,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.256102,
                    "execution_time": 0.079051,
                    "compile_time": 0.000328,
                    "planning_time": 0.098258,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_YEAR\" AS \"D_YEAR\" , \"D\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.081936,
                    "execution_time": 0.031481,
                    "compile_time": 0.000242,
                    "planning_time": 0.026274,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.144672,
                    "execution_time": 0.031217,
                    "compile_time": 0.000258,
                    "planning_time": 0.087239,
                    "create_size": 18
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CS\".\"CS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.34084,
                    "execution_time": 0.236802,
                    "compile_time": 0.000399,
                    "planning_time": 0.038265,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.431719,
                    "execution_time": 0.242571,
                    "compile_time": 0.000414,
                    "planning_time": 0.121126,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_3\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"CUSTOMSK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.133955,
                    "execution_time": 0.060472,
                    "compile_time": 0.000267,
                    "planning_time": 0.003251,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.197468,
                    "execution_time": 0.060658,
                    "compile_time": 0.00033,
                    "planning_time": 0.061092,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.519328,
                    "execution_time": 0.129046,
                    "compile_time": 0.103805,
                    "planning_time": 0.050713,
                    "create_size": 1659
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.339188,
                    "execution_time": 0.193014,
                    "compile_time": 6.850814,
                    "planning_time": 0.04664,
                    "create_size": 1659
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        OK         M                 W             2     1       2       2       2                      5     1        5        5        5                     1     1        1        1        1\n1        KS         F                 M             4     4       4       4       4                      4     4        4        4        4                     0     4        0        0        0\n2        KS         F                 D             4     1       4       4       4                      1     1        1        1        1                     0     1        0        0        0\n3        ID         F                 M             3     1       3       3       3                      2     1        2        2        2                     6     1        6        6        6\n4        TX         F                 D             3     3       3       3       3                      2     3        2        2        2                     6     3        6        6        6\n5        NY         M                 U             1     1       1       1       1                      0     1        0        0        0                     0     1        0        0        0\n6        VA         F                 U             3     1       3       3       3                      1     1        1        1        1                     2     1        2        2        2\n7                   M                 S             3     1       3       3       3                      2     1        2        2        2                     6     1        6        6        6\n8        LA         M                 U             3     1       3       3       3                      2     1        2        2        2                     6     1        6        6        6\n9        FL         F                 D             4     1       4       4       4                      2     1        2        2        2                     6     1        6        6        6\n10       MI         F                 M             1     1       1       1       1                      6     1        6        6        6                     0     1        0        0        0\n11       TX         M                 M             4     3       4       4       4                      3     3        3        3        3                     3     3        3        3        3\n12       NE         M                 W             5     1       5       5       5                      4     1        4        4        4                     5     1        5        5        5\n13       FL         M                 U             1     1       1       1       1                      0     1        0        0        0                     5     1        5        5        5\n14       NV         F                 S             5     1       5       5       5                      1     1        1        1        1                     0     1        0        0        0\n15       MT         F                 S             2     1       2       2       2                      5     1        5        5        5                     1     1        1        1        1\n16       LA         M                 M             1     1       1       1       1                      4     1        4        4        4                     4     1        4        4        4\n17       MO         M                 W             2     1       2       2       2                      4     1        4        4        4                     2     1        2        2        2\n18       GA         F                 U             3     2       3       3       3                      4     2        4        4        4                     2     2        2        2        2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.02169,
                    "execution_time": 0.008724,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.005639
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060518,
                    "execution_time": 0.008413,
                    "compile_time": 6.2e-05,
                    "planning_time": 0.041746
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_4\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_5\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_5\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        OK         M                 W             2     1       2       2       2                      5     1        5        5        5                     1     1        1        1        1\n1        KS         F                 M             4     4       4       4       4                      4     4        4        4        4                     0     4        0        0        0\n2        KS         F                 D             4     1       4       4       4                      1     1        1        1        1                     0     1        0        0        0\n3        ID         F                 M             3     1       3       3       3                      2     1        2        2        2                     6     1        6        6        6\n4        TX         F                 D             3     3       3       3       3                      2     3        2        2        2                     6     3        6        6        6\n5        NY         M                 U             1     1       1       1       1                      0     1        0        0        0                     0     1        0        0        0\n6        VA         F                 U             3     1       3       3       3                      1     1        1        1        1                     2     1        2        2        2\n7                   M                 S             3     1       3       3       3                      2     1        2        2        2                     6     1        6        6        6\n8        LA         M                 U             3     1       3       3       3                      2     1        2        2        2                     6     1        6        6        6\n9        FL         F                 D             4     1       4       4       4                      2     1        2        2        2                     6     1        6        6        6\n10       MI         F                 M             1     1       1       1       1                      6     1        6        6        6                     0     1        0        0        0\n11       TX         M                 M             4     3       4       4       4                      3     3        3        3        3                     3     3        3        3        3\n12       NE         M                 W             5     1       5       5       5                      4     1        4        4        4                     5     1        5        5        5\n13       FL         M                 U             1     1       1       1       1                      0     1        0        0        0                     5     1        5        5        5\n14       NV         F                 S             5     1       5       5       5                      1     1        1        1        1                     0     1        0        0        0\n15       MT         F                 S             2     1       2       2       2                      5     1        5        5        5                     1     1        1        1        1\n16       LA         M                 M             1     1       1       1       1                      4     1        4        4        4                     4     1        4        4        4\n17       MO         M                 W             2     1       2       2       2                      4     1        4        4        4                     2     1        2        2        2\n18       GA         F                 U             3     2       3       3       3                      4     2        4        4        4                     2     2        2        2        2\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales, date_dim\n            where \n/*CURSOR_IDENTIFIER*/ d_date_sk = cs_sold_date_sk and d_year = 1999 and d_qoy < 4\n)\n) group by ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count \n",
        "optimize": [
            "SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.306122,
                    "execution_time": 0.201542,
                    "compile_time": 0.000292,
                    "planning_time": 0.035232,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.388642,
                    "execution_time": 0.208656,
                    "compile_time": 0.000299,
                    "planning_time": 0.103553,
                    "create_size": 512
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*    customsk\n0      23070\n1      23070\n2      23070\n3      23070\n4      23070\n5      23399\n6      23399\n7      23399\n8      23399\n9     323923\n10    323923\n11    323923\n12    323923\n13    323923\n14    323923\n15    323923\n16    323923\n17     64666\n18     64666\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016177,
                    "execution_time": 0.007384,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.002897
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053452,
                    "execution_time": 0.008325,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.037751
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*    customsk\n0      23070\n1      23070\n2      23070\n3      23070\n4      23070\n5      23399\n6      23399\n7      23399\n8      23399\n9     323923\n10    323923\n11    323923\n12    323923\n13    323923\n14    323923\n15    323923\n16    323923\n17     64666\n18     64666\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state, cd_gender, cd_marital_status, cd_dep_count, cd_dep_employed_count, cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.221208,
                    "execution_time": 0.075105,
                    "compile_time": 0.000349,
                    "planning_time": 0.07186,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.252937,
                    "execution_time": 0.076182,
                    "compile_time": 0.000318,
                    "planning_time": 0.102983,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.082434,
                    "execution_time": 0.031292,
                    "compile_time": 0.000245,
                    "planning_time": 0.026021,
                    "create_size": 18
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.147616,
                    "execution_time": 0.03134,
                    "compile_time": 0.000254,
                    "planning_time": 0.090198,
                    "create_size": 18
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.338171,
                    "execution_time": 0.232379,
                    "compile_time": 0.000451,
                    "planning_time": 0.038727,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.422629,
                    "execution_time": 0.231983,
                    "compile_time": 0.000411,
                    "planning_time": 0.124454,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" GROUP BY \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMSK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.132476,
                    "execution_time": 0.059253,
                    "compile_time": 0.000276,
                    "planning_time": 0.003258,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.194817,
                    "execution_time": 0.059724,
                    "compile_time": 0.000269,
                    "planning_time": 0.063439,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.406946,
                    "execution_time": 0.119812,
                    "compile_time": 0.000718,
                    "planning_time": 0.049906,
                    "create_size": 1659
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.537363,
                    "execution_time": 0.119832,
                    "compile_time": 0.056291,
                    "planning_time": 0.119228,
                    "create_size": 1659
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        OH         M                 S             4     2       4       4       4                      0     2        0        0        0                     5     2        5        5        5\n1        WV         F                 M             2     1       2       2       2                      5     1        5        5        5                     0     1        0        0        0\n2        OH         M                 S             1     1       1       1       1                      1     1        1        1        1                     1     1        1        1        1\n3        OH         M                 M             4     2       4       4       4                      0     2        0        0        0                     0     2        0        0        0\n4        WV         F                 U             4     1       4       4       4                      0     1        0        0        0                     0     1        0        0        0\n5        NE         F                 W             0     2       0       0       0                      2     2        2        2        2                     0     2        0        0        0\n6        WA         F                 D             6     1       6       6       6                      5     1        5        5        5                     1     1        1        1        1\n7        LA         M                 W             6     2       6       6       6                      5     2        5        5        5                     1     2        1        1        1\n8        FL         F                 W             0     1       0       0       0                      1     1        1        1        1                     3     1        3        3        3\n9        MN         M                 U             6     1       6       6       6                      5     1        5        5        5                     1     1        1        1        1\n10       ID         F                 U             5     1       5       5       5                      6     1        6        6        6                     2     1        2        2        2\n11       WI         F                 U             2     1       2       2       2                      0     1        0        0        0                     2     1        2        2        2\n12       AL         F                 U             4     1       4       4       4                      6     1        6        6        6                     0     1        0        0        0\n13       TX         F                 W             5     2       5       5       5                      6     2        6        6        6                     0     2        0        0        0\n14       TX         F                 M             2     2       2       2       2                      2     2        2        2        2                     5     2        5        5        5\n15       MI         F                 U             2     1       2       2       2                      1     1        1        1        1                     1     1        1        1        1\n16       MS         F                 U             0     2       0       0       0                      4     2        4        4        4                     3     2        3        3        3\n17       MN         F                 S             0     1       0       0       0                      4     1        4        4        4                     3     1        3        3        3\n18       NC         M                 W             1     1       1       1       1                      3     1        3        3        3                     6     1        6        6        6\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020537,
                    "execution_time": 0.007447,
                    "compile_time": 5.9e-05,
                    "planning_time": 0.005686
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.059552,
                    "execution_time": 0.008582,
                    "compile_time": 6e-05,
                    "planning_time": 0.041745
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        OH         M                 S             4     2       4       4       4                      0     2        0        0        0                     5     2        5        5        5\n1        WV         F                 M             2     1       2       2       2                      5     1        5        5        5                     0     1        0        0        0\n2        OH         M                 S             1     1       1       1       1                      1     1        1        1        1                     1     1        1        1        1\n3        OH         M                 M             4     2       4       4       4                      0     2        0        0        0                     0     2        0        0        0\n4        WV         F                 U             4     1       4       4       4                      0     1        0        0        0                     0     1        0        0        0\n5        NE         F                 W             0     2       0       0       0                      2     2        2        2        2                     0     2        0        0        0\n6        WA         F                 D             6     1       6       6       6                      5     1        5        5        5                     1     1        1        1        1\n7        LA         M                 W             6     2       6       6       6                      5     2        5        5        5                     1     2        1        1        1\n8        FL         F                 W             0     1       0       0       0                      1     1        1        1        1                     3     1        3        3        3\n9        MN         M                 U             6     1       6       6       6                      5     1        5        5        5                     1     1        1        1        1\n10       ID         F                 U             5     1       5       5       5                      6     1        6        6        6                     2     1        2        2        2\n11       WI         F                 U             2     1       2       2       2                      0     1        0        0        0                     2     1        2        2        2\n12       AL         F                 U             4     1       4       4       4                      6     1        6        6        6                     0     1        0        0        0\n13       TX         F                 W             5     2       5       5       5                      6     2        6        6        6                     0     2        0        0        0\n14       TX         F                 M             2     2       2       2       2                      2     2        2        2        2                     5     2        5        5        5\n15       MI         F                 U             2     1       2       2       2                      1     1        1        1        1                     1     1        1        1        1\n16       MS         F                 U             0     2       0       0       0                      4     2        4        4        4                     3     2        3        3        3\n17       MN         F                 S             0     1       0       0       0                      4     1        4        4        4                     3     1        3        3        3\n18       NC         M                 W             1     1       1       1       1                      3     1        3        3        3                     6     1        6        6        6\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/\n",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CA_STATE\" AS \"CA_STATE\" , \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"CNT1\" AS \"CNT1\" , \"_COL_5\" AS \"_COL_5\" , \"_COL_6\" AS \"_COL_6\" , \"_COL_7\" AS \"_COL_7\" , \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"CNT2\" AS \"CNT2\" , \"_COL_10\" AS \"_COL_10\" , \"_COL_11\" AS \"_COL_11\" , \"_COL_12\" AS \"_COL_12\" , \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"CNT3\" AS \"CNT3\" , \"_COL_15\" AS \"_COL_15\" , \"_COL_16\" AS \"_COL_16\" , \"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        MT         M                 U             2     2       2       2       2                      5     2        5        5        5                     1     2        1        1        1\n1        NE         M                 S             2     2       2       2       2                      1     2        1        1        1                     2     2        2        2        2\n2        AR         F                 M             2     1       2       2       2                      1     1        1        1        1                     2     1        2        2        2\n3        CO         M                 S             2     5       2       2       2                      1     5        1        1        1                     2     5        2        2        2\n4                   F                 M             0     3       0       0       0                      2     3        2        2        2                     3     3        3        3        3\n5        GA         M                 S             4     2       4       4       4                      4     2        4        4        4                     0     2        0        0        0\n6        MO         F                 W             4     1       4       4       4                      4     1        4        4        4                     0     1        0        0        0\n7        PA         F                 W             5     1       5       5       5                      4     1        4        4        4                     0     1        0        0        0\n8        NE         M                 M             5     1       5       5       5                      4     1        4        4        4                     0     1        0        0        0\n9        CO         F                 U             0     2       0       0       0                      0     2        0        0        0                     0     2        0        0        0\n10       MO         F                 S             3     3       3       3       3                      2     3        2        2        2                     6     3        6        6        6\n11                  M                 M             6     2       6       6       6                      5     2        5        5        5                     2     2        2        2        2\n12       NC         M                 D             6     1       6       6       6                      5     1        5        5        5                     2     1        2        2        2\n13       OH         M                 U             0     2       0       0       0                      1     2        1        1        1                     4     2        4        4        4\n14       NE         M                 S             1     2       1       1       1                      1     2        1        1        1                     4     2        4        4        4\n15       FL         M                 S             1     2       1       1       1                      1     2        1        1        1                     4     2        4        4        4\n16       WI         F                 D             1     1       1       1       1                      1     1        1        1        1                     4     1        4        4        4\n17       OK         F                 W             3     4       3       3       3                      1     4        1        1        1                     2     4        2        2        2\n18       KY         F                 S             0     1       0       0       0                      6     1        6        6        6                     0     1        0        0        0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020705,
                    "execution_time": 0.007845,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.005652
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056693,
                    "execution_time": 0.008133,
                    "compile_time": 6e-05,
                    "planning_time": 0.041019
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"CA_STATE\" AS \"CA_STATE\", \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\", \"CNT1\" AS \"CNT1\", \"_COL_5\" AS \"_COL_5\", \"_COL_6\" AS \"_COL_6\", \"_COL_7\" AS \"_COL_7\", \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\", \"CNT2\" AS \"CNT2\", \"_COL_10\" AS \"_COL_10\", \"_COL_11\" AS \"_COL_11\", \"_COL_12\" AS \"_COL_12\", \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\", \"CNT3\" AS \"CNT3\", \"_COL_15\" AS \"_COL_15\", \"_COL_16\" AS \"_COL_16\", \"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        MT         M                 U             2     2       2       2       2                      5     2        5        5        5                     1     2        1        1        1\n1        NE         M                 S             2     2       2       2       2                      1     2        1        1        1                     2     2        2        2        2\n2        AR         F                 M             2     1       2       2       2                      1     1        1        1        1                     2     1        2        2        2\n3        CO         M                 S             2     5       2       2       2                      1     5        1        1        1                     2     5        2        2        2\n4                   F                 M             0     3       0       0       0                      2     3        2        2        2                     3     3        3        3        3\n5        GA         M                 S             4     2       4       4       4                      4     2        4        4        4                     0     2        0        0        0\n6        MO         F                 W             4     1       4       4       4                      4     1        4        4        4                     0     1        0        0        0\n7        PA         F                 W             5     1       5       5       5                      4     1        4        4        4                     0     1        0        0        0\n8        NE         M                 M             5     1       5       5       5                      4     1        4        4        4                     0     1        0        0        0\n9        CO         F                 U             0     2       0       0       0                      0     2        0        0        0                     0     2        0        0        0\n10       MO         F                 S             3     3       3       3       3                      2     3        2        2        2                     6     3        6        6        6\n11                  M                 M             6     2       6       6       6                      5     2        5        5        5                     2     2        2        2        2\n12       NC         M                 D             6     1       6       6       6                      5     1        5        5        5                     2     1        2        2        2\n13       OH         M                 U             0     2       0       0       0                      1     2        1        1        1                     4     2        4        4        4\n14       NE         M                 S             1     2       1       1       1                      1     2        1        1        1                     4     2        4        4        4\n15       FL         M                 S             1     2       1       1       1                      1     2        1        1        1                     4     2        4        4        4\n16       WI         F                 D             1     1       1       1       1                      1     1        1        1        1                     4     1        4        4        4\n17       OK         F                 W             3     4       3       3       3                      1     4        1        1        1                     2     4        2        2        2\n18       KY         F                 S             0     1       0       0       0                      6     1        6        6        6                     0     1        0        0        0\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics cd\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/\n",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.411263,
                    "execution_time": 0.127386,
                    "compile_time": 0.000754,
                    "planning_time": 0.047081,
                    "create_size": 1659
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.475538,
                    "execution_time": 0.118662,
                    "compile_time": 0.000709,
                    "planning_time": 0.119969,
                    "create_size": 1659
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        TN         M                 U             2     1       2       2       2                      1     1        1        1        1                     2     1        2        2        2\n1        FL         F                 U             4     1       4       4       4                      4     1        4        4        4                     0     1        0        0        0\n2        TX         F                 S             0     3       0       0       0                      6     3        6        6        6                     2     3        2        2        2\n3        MS         M                 W             0     1       0       0       0                      1     1        1        1        1                     4     1        4        4        4\n4        IN         F                 S             1     1       1       1       1                      1     1        1        1        1                     4     1        4        4        4\n5        GA         M                 W             1     1       1       1       1                      1     1        1        1        1                     4     1        4        4        4\n6        IL         F                 D             1     4       1       1       1                      0     4        0        0        0                     0     4        0        0        0\n7        OH         M                 M             1     4       1       1       1                      6     4        6        6        6                     2     4        2        2        2\n8        NY         F                 M             4     1       4       4       4                      2     1        2        2        2                     6     1        6        6        6\n9        IA         F                 S             2     1       2       2       2                      0     1        0        0        0                     5     1        5        5        5\n10       CA         M                 W             5     1       5       5       5                      1     1        1        1        1                     0     1        0        0        0\n11       MI         M                 S             0     1       0       0       0                      5     1        5        5        5                     5     1        5        5        5\n12                  M                 W             5     2       5       5       5                      1     2        1        1        1                     5     2        5        5        5\n13                  F                 S             3     3       3       3       3                      0     3        0        0        0                     3     3        3        3        3\n14       CA         M                 S             5     1       5       5       5                      3     1        3        3        3                     1     1        1        1        1\n15       VA         M                 U             5     1       5       5       5                      3     1        3        3        3                     1     1        1        1        1\n16       IN         F                 W             5     2       5       5       5                      3     2        3        3        3                     1     2        1        1        1\n17       SD         M                 D             0     1       0       0       0                      4     1        4        4        4                     6     1        6        6        6\n18       ID         F                 U             4     1       4       4       4                      4     1        4        4        4                     2     1        2        2        2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.02171,
                    "execution_time": 0.008526,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.005717
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057122,
                    "execution_time": 0.008014,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.041658
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_12\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_12\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        TN         M                 U             2     1       2       2       2                      1     1        1        1        1                     2     1        2        2        2\n1        FL         F                 U             4     1       4       4       4                      4     1        4        4        4                     0     1        0        0        0\n2        TX         F                 S             0     3       0       0       0                      6     3        6        6        6                     2     3        2        2        2\n3        MS         M                 W             0     1       0       0       0                      1     1        1        1        1                     4     1        4        4        4\n4        IN         F                 S             1     1       1       1       1                      1     1        1        1        1                     4     1        4        4        4\n5        GA         M                 W             1     1       1       1       1                      1     1        1        1        1                     4     1        4        4        4\n6        IL         F                 D             1     4       1       1       1                      0     4        0        0        0                     0     4        0        0        0\n7        OH         M                 M             1     4       1       1       1                      6     4        6        6        6                     2     4        2        2        2\n8        NY         F                 M             4     1       4       4       4                      2     1        2        2        2                     6     1        6        6        6\n9        IA         F                 S             2     1       2       2       2                      0     1        0        0        0                     5     1        5        5        5\n10       CA         M                 W             5     1       5       5       5                      1     1        1        1        1                     0     1        0        0        0\n11       MI         M                 S             0     1       0       0       0                      5     1        5        5        5                     5     1        5        5        5\n12                  M                 W             5     2       5       5       5                      1     2        1        1        1                     5     2        5        5        5\n13                  F                 S             3     3       3       3       3                      0     3        0        0        0                     3     3        3        3        3\n14       CA         M                 S             5     1       5       5       5                      3     1        3        3        3                     1     1        1        1        1\n15       VA         M                 U             5     1       5       5       5                      3     1        3        3        3                     1     1        1        1        1\n16       IN         F                 W             5     2       5       5       5                      3     2        3        3        3                     1     2        1        1        1\n17       SD         M                 D             0     1       0       0       0                      4     1        4        4        4                     6     1        6        6        6\n18       ID         F                 U             4     1       4       4       4                      4     1        4        4        4                     2     1        2        2        2\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca.ca_state,\n  cd.cd_gender,\n  cd.cd_marital_status,\n  cd.cd_dep_count,\n  count(*) cnt1,\n  max(cd.cd_dep_count),\n  min(cd.cd_dep_count),\n  max(cd.cd_dep_count),\n  cd.cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd.cd_dep_employed_count),\n  min(cd.cd_dep_employed_count),\n  max(cd.cd_dep_employed_count),\n  cd.cd_dep_college_count,\n  count(*) cnt3,\n  max(cd.cd_dep_college_count),\n  min(cd.cd_dep_college_count),\n  max(cd.cd_dep_college_count)\n from\n  customer c, customer_address ca, customer_demographics cd\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd.cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales ss, date_dim d\n          where c.c_customer_sk = ss.ss_customer_sk and\n                ss.ss_sold_date_sk = d.d_date_sk and\n                d.d_year = 1999 and\n                d.d_qoy < 4) and\n   exists (select * from\n\t   (select ws.ws_bill_customer_sk customsk\n            from web_sales ws, date_dim d\n            where \n                  ws.ws_sold_date_sk = d.d_date_sk and\n                  d.d_year = 1999 and\n                  d.d_qoy < 4\n\t    union all \n    \t    select cs.cs_ship_customer_sk customsk\n            from catalog_sales cs, date_dim d\n            where \n                  cs.cs_sold_date_sk = d.d_date_sk and\n                  d.d_year = 1999 and\n                  d.d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca.ca_state,\n          cd.cd_gender,\n          cd.cd_marital_status,\n          cd.cd_dep_count,\n          cd.cd_dep_employed_count,\n          cd.cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" AND \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999 GROUP BY \"SS\".\"SS_CUSTOMER_SK\" ) , \"D_2\" AS ( SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_YEAR\" AS \"D_YEAR\" , \"D\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"D_2\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"D_2\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.337568,
                    "execution_time": 0.232622,
                    "compile_time": 0.000433,
                    "planning_time": 0.038416,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.419723,
                    "execution_time": 0.234405,
                    "compile_time": 0.000408,
                    "planning_time": 0.118263,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" GROUP BY \"SPEQLITE_TEMP_TABLE_13\".\"CUSTOMSK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.132693,
                    "execution_time": 0.059938,
                    "compile_time": 0.000273,
                    "planning_time": 0.003233,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.18925,
                    "execution_time": 0.059197,
                    "compile_time": 0.000268,
                    "planning_time": 0.060492,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_14\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.40575,
                    "execution_time": 0.121483,
                    "compile_time": 0.000711,
                    "planning_time": 0.04745,
                    "create_size": 1659
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.474178,
                    "execution_time": 0.122308,
                    "compile_time": 0.000698,
                    "planning_time": 0.114723,
                    "create_size": 1659
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        AL         F                 W             2     1       2       2       2                      5     1        5        5        5                     1     1        1        1        1\n1        KS         M                 W             2     1       2       2       2                      5     1        5        5        5                     1     1        1        1        1\n2        CO         M                 W             2     2       2       2       2                      1     2        1        1        1                     2     2        2        2        2\n3        MS         F                 U             4     2       4       4       4                      1     2        1        1        1                     0     2        0        0        0\n4        MI         F                 S             4     1       4       4       4                      1     1        1        1        1                     0     1        0        0        0\n5        IN         M                 S             2     1       2       2       2                      6     1        6        6        6                     5     1        5        5        5\n6        CA         M                 S             2     1       2       2       2                      6     1        6        6        6                     5     1        5        5        5\n7        CO         M                 M             3     1       3       3       3                      2     1        2        2        2                     6     1        6        6        6\n8        PA         M                 S             3     1       3       3       3                      2     1        2        2        2                     6     1        6        6        6\n9        TN         M                 W             3     2       3       3       3                      2     2        2        2        2                     6     2        6        6        6\n10       OH         M                 S             0     1       0       0       0                      6     1        6        6        6                     2     1        2        2        2\n11       IA         F                 D             1     4       1       1       1                      0     4        0        0        0                     0     4        0        0        0\n12       KS         M                 M             1     1       1       1       1                      6     1        6        6        6                     0     1        0        0        0\n13       TN         F                 D             1     2       1       1       1                      6     2        6        6        6                     0     2        0        0        0\n14       NJ         M                 D             1     1       1       1       1                      6     1        6        6        6                     0     1        0        0        0\n15       ME         M                 S             4     1       4       4       4                      2     1        2        2        2                     6     1        6        6        6\n16       WA         F                 D             3     1       3       3       3                      3     1        3        3        3                     3     1        3        3        3\n17       TX         M                 S             3     1       3       3       3                      1     1        1        1        1                     2     1        2        2        2\n18       TX         M                 D             1     2       1       1       1                      0     2        0        0        0                     5     2        5        5        5\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.02083,
                    "execution_time": 0.00775,
                    "compile_time": 6e-05,
                    "planning_time": 0.005764
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057785,
                    "execution_time": 0.008417,
                    "compile_time": 6.6e-05,
                    "planning_time": 0.041795
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_14\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        AL         F                 W             2     1       2       2       2                      5     1        5        5        5                     1     1        1        1        1\n1        KS         M                 W             2     1       2       2       2                      5     1        5        5        5                     1     1        1        1        1\n2        CO         M                 W             2     2       2       2       2                      1     2        1        1        1                     2     2        2        2        2\n3        MS         F                 U             4     2       4       4       4                      1     2        1        1        1                     0     2        0        0        0\n4        MI         F                 S             4     1       4       4       4                      1     1        1        1        1                     0     1        0        0        0\n5        IN         M                 S             2     1       2       2       2                      6     1        6        6        6                     5     1        5        5        5\n6        CA         M                 S             2     1       2       2       2                      6     1        6        6        6                     5     1        5        5        5\n7        CO         M                 M             3     1       3       3       3                      2     1        2        2        2                     6     1        6        6        6\n8        PA         M                 S             3     1       3       3       3                      2     1        2        2        2                     6     1        6        6        6\n9        TN         M                 W             3     2       3       3       3                      2     2        2        2        2                     6     2        6        6        6\n10       OH         M                 S             0     1       0       0       0                      6     1        6        6        6                     2     1        2        2        2\n11       IA         F                 D             1     4       1       1       1                      0     4        0        0        0                     0     4        0        0        0\n12       KS         M                 M             1     1       1       1       1                      6     1        6        6        6                     0     1        0        0        0\n13       TN         F                 D             1     2       1       1       1                      6     2        6        6        6                     0     2        0        0        0\n14       NJ         M                 D             1     1       1       1       1                      6     1        6        6        6                     0     1        0        0        0\n15       ME         M                 S             4     1       4       4       4                      2     1        2        2        2                     6     1        6        6        6\n16       WA         F                 D             3     1       3       3       3                      3     1        3        3        3                     3     1        3        3        3\n17       TX         M                 S             3     1       3       3       3                      1     1        1        1        1                     2     1        2        2        2\n18       TX         M                 D             1     2       1       1       1                      0     2        0        0        0                     5     2        5        5        5\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c, customer_address ca, customer_demographics cd\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd.cd_demo_sk = c.c_current_cdemo_sk and\n  exists (select *\n          from store_sales, date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * \n           from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales, date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales, date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4) x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CA_STATE\" AS \"CA_STATE\" , \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"CNT1\" AS \"CNT1\" , \"_COL_5\" AS \"_COL_5\" , \"_COL_6\" AS \"_COL_6\" , \"_COL_7\" AS \"_COL_7\" , \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"CNT2\" AS \"CNT2\" , \"_COL_10\" AS \"_COL_10\" , \"_COL_11\" AS \"_COL_11\" , \"_COL_12\" AS \"_COL_12\" , \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"CNT3\" AS \"CNT3\" , \"_COL_15\" AS \"_COL_15\" , \"_COL_16\" AS \"_COL_16\" , \"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        IN         F                 M             4     1       4       4       4                      1     1        1        1        1                     0     1        0        0        0\n1        NM         M                 S             6     2       6       6       6                      4     2        4        4        4                     5     2        5        5        5\n2        MD         M                 D             5     2       5       5       5                      3     2        3        3        3                     1     2        1        1        1\n3        WI         F                 D             1     2       1       1       1                      2     2        2        2        2                     1     2        1        1        1\n4        VA         F                 U             6     1       6       6       6                      3     1        3        3        3                     6     1        6        6        6\n5        OK         F                 D             2     1       2       2       2                      4     1        4        4        4                     2     1        2        2        2\n6        NE         M                 U             4     1       4       4       4                      6     1        6        6        6                     5     1        5        5        5\n7        MI         M                 W             0     1       0       0       0                      5     1        5        5        5                     3     1        3        3        3\n8        GA         F                 S             1     1       1       1       1                      2     1        2        2        2                     3     1        3        3        3\n9        IL         M                 W             2     1       2       2       2                      3     1        3        3        3                     5     1        5        5        5\n10       FL         M                 D             2     2       2       2       2                      3     2        3        3        3                     5     2        5        5        5\n11       SC         F                 W             5     2       5       5       5                      5     2        5        5        5                     4     2        4        4        4\n12       TN         F                 W             0     1       0       0       0                      4     1        4        4        4                     6     1        6        6        6\n13       GA         F                 W             3     1       3       3       3                      3     1        3        3        3                     5     1        5        5        5\n14       KS         M                 U             5     2       5       5       5                      1     2        1        1        1                     5     2        5        5        5\n15       NC         M                 U             5     2       5       5       5                      5     2        5        5        5                     4     2        4        4        4\n16       TX         M                 U             5     2       5       5       5                      5     2        5        5        5                     4     2        4        4        4\n17                  M                 M             1     1       1       1       1                      0     1        0        0        0                     0     1        0        0        0\n18       VA         M                 M             3     2       3       3       3                      6     2        6        6        6                     3     2        3        3        3\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021054,
                    "execution_time": 0.0084,
                    "compile_time": 5.7e-05,
                    "planning_time": 0.005578
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056555,
                    "execution_time": 0.007957,
                    "compile_time": 6e-05,
                    "planning_time": 0.041147
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"CA_STATE\" AS \"CA_STATE\", \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\", \"CNT1\" AS \"CNT1\", \"_COL_5\" AS \"_COL_5\", \"_COL_6\" AS \"_COL_6\", \"_COL_7\" AS \"_COL_7\", \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\", \"CNT2\" AS \"CNT2\", \"_COL_10\" AS \"_COL_10\", \"_COL_11\" AS \"_COL_11\", \"_COL_12\" AS \"_COL_12\", \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\", \"CNT3\" AS \"CNT3\", \"_COL_15\" AS \"_COL_15\", \"_COL_16\" AS \"_COL_16\", \"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        IN         F                 M             4     1       4       4       4                      1     1        1        1        1                     0     1        0        0        0\n1        NM         M                 S             6     2       6       6       6                      4     2        4        4        4                     5     2        5        5        5\n2        MD         M                 D             5     2       5       5       5                      3     2        3        3        3                     1     2        1        1        1\n3        WI         F                 D             1     2       1       1       1                      2     2        2        2        2                     1     2        1        1        1\n4        VA         F                 U             6     1       6       6       6                      3     1        3        3        3                     6     1        6        6        6\n5        OK         F                 D             2     1       2       2       2                      4     1        4        4        4                     2     1        2        2        2\n6        NE         M                 U             4     1       4       4       4                      6     1        6        6        6                     5     1        5        5        5\n7        MI         M                 W             0     1       0       0       0                      5     1        5        5        5                     3     1        3        3        3\n8        GA         F                 S             1     1       1       1       1                      2     1        2        2        2                     3     1        3        3        3\n9        IL         M                 W             2     1       2       2       2                      3     1        3        3        3                     5     1        5        5        5\n10       FL         M                 D             2     2       2       2       2                      3     2        3        3        3                     5     2        5        5        5\n11       SC         F                 W             5     2       5       5       5                      5     2        5        5        5                     4     2        4        4        4\n12       TN         F                 W             0     1       0       0       0                      4     1        4        4        4                     6     1        6        6        6\n13       GA         F                 W             3     1       3       3       3                      3     1        3        3        3                     5     1        5        5        5\n14       KS         M                 U             5     2       5       5       5                      1     2        1        1        1                     5     2        5        5        5\n15       NC         M                 U             5     2       5       5       5                      5     2        5        5        5                     4     2        4        4        4\n16       TX         M                 U             5     2       5       5       5                      5     2        5        5        5                     4     2        4        4        4\n17                  M                 M             1     1       1       1       1                      0     1        0        0        0                     0     1        0        0        0\n18       VA         M                 M             3     2       3       3       3                      6     2        6        6        6                     3     2        3        3        3\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"CA_STATE\" AS \"CA_STATE\" , \"CD_GENDER\" AS \"CD_GENDER\" , \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"CNT1\" AS \"CNT1\" , \"_COL_5\" AS \"_COL_5\" , \"_COL_6\" AS \"_COL_6\" , \"_COL_7\" AS \"_COL_7\" , \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"CNT2\" AS \"CNT2\" , \"_COL_10\" AS \"_COL_10\" , \"_COL_11\" AS \"_COL_11\" , \"_COL_12\" AS \"_COL_12\" , \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"CNT3\" AS \"CNT3\" , \"_COL_15\" AS \"_COL_15\" , \"_COL_16\" AS \"_COL_16\" , \"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        SD         F                 U             3     1       3       3       3                      2     1        2        2        2                     6     1        6        6        6\n1        KS         M                 M             3     1       3       3       3                      2     1        2        2        2                     6     1        6        6        6\n2        TX         M                 D             3     2       3       3       3                      1     2        1        1        1                     2     2        2        2        2\n3        AR         F                 M             1     1       1       1       1                      0     1        0        0        0                     0     1        0        0        0\n4        KS         F                 W             1     1       1       1       1                      0     1        0        0        0                     0     1        0        0        0\n5        IL         F                 W             1     2       1       1       1                      6     2        6        6        6                     0     2        0        0        0\n6        WV         M                 S             5     1       5       5       5                      4     1        4        4        4                     5     1        5        5        5\n7        OK         M                 S             1     1       1       1       1                      0     1        0        0        0                     5     1        5        5        5\n8        LA         F                 M             4     1       4       4       4                      1     1        1        1        1                     0     1        0        0        0\n9        MO         F                 U             1     2       1       1       1                      4     2        4        4        4                     4     2        4        4        4\n10       MD         F                 S             1     3       1       1       1                      4     3        4        4        4                     4     3        4        4        4\n11       MA         M                 U             3     1       3       3       3                      0     1        0        0        0                     3     1        3        3        3\n12       SD         F                 M             5     1       5       5       5                      3     1        3        3        3                     1     1        1        1        1\n13       IL         M                 S             5     2       5       5       5                      3     2        3        3        3                     1     2        1        1        1\n14       WI         M                 W             5     1       5       5       5                      3     1        3        3        3                     1     1        1        1        1\n15       MN         F                 W             6     2       6       6       6                      3     2        3        3        3                     6     2        6        6        6\n16       UT         F                 U             1     1       1       1       1                      2     1        2        2        2                     1     1        1        1        1\n17       NY         F                 S             2     1       2       2       2                      5     1        5        5        5                     1     1        1        1        1\n18       NC         F                 S             3     2       3       3       3                      5     2        5        5        5                     1     2        1        1        1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021255,
                    "execution_time": 0.008381,
                    "compile_time": 5.8e-05,
                    "planning_time": 0.005607
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.021181,
                    "execution_time": 0.007784,
                    "compile_time": 6.1e-05,
                    "planning_time": 0.005889
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\"",
                "rewrite": "SELECT \"CA_STATE\" AS \"CA_STATE\", \"CD_GENDER\" AS \"CD_GENDER\", \"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\", \"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\", \"CNT1\" AS \"CNT1\", \"_COL_5\" AS \"_COL_5\", \"_COL_6\" AS \"_COL_6\", \"_COL_7\" AS \"_COL_7\", \"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\", \"CNT2\" AS \"CNT2\", \"_COL_10\" AS \"_COL_10\", \"_COL_11\" AS \"_COL_11\", \"_COL_12\" AS \"_COL_12\", \"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\", \"CNT3\" AS \"CNT3\", \"_COL_15\" AS \"_COL_15\", \"_COL_16\" AS \"_COL_16\", \"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0        SD         F                 U             3     1       3       3       3                      2     1        2        2        2                     6     1        6        6        6\n1        KS         M                 M             3     1       3       3       3                      2     1        2        2        2                     6     1        6        6        6\n2        TX         M                 D             3     2       3       3       3                      1     2        1        1        1                     2     2        2        2        2\n3        AR         F                 M             1     1       1       1       1                      0     1        0        0        0                     0     1        0        0        0\n4        KS         F                 W             1     1       1       1       1                      0     1        0        0        0                     0     1        0        0        0\n5        IL         F                 W             1     2       1       1       1                      6     2        6        6        6                     0     2        0        0        0\n6        WV         M                 S             5     1       5       5       5                      4     1        4        4        4                     5     1        5        5        5\n7        OK         M                 S             1     1       1       1       1                      0     1        0        0        0                     5     1        5        5        5\n8        LA         F                 M             4     1       4       4       4                      1     1        1        1        1                     0     1        0        0        0\n9        MO         F                 U             1     2       1       1       1                      4     2        4        4        4                     4     2        4        4        4\n10       MD         F                 S             1     3       1       1       1                      4     3        4        4        4                     4     3        4        4        4\n11       MA         M                 U             3     1       3       3       3                      0     1        0        0        0                     3     1        3        3        3\n12       SD         F                 M             5     1       5       5       5                      3     1        3        3        3                     1     1        1        1        1\n13       IL         M                 S             5     2       5       5       5                      3     2        3        3        3                     1     2        1        1        1\n14       WI         M                 W             5     1       5       5       5                      3     1        3        3        3                     1     1        1        1        1\n15       MN         F                 W             6     2       6       6       6                      3     2        3        3        3                     6     2        6        6        6\n16       UT         F                 U             1     1       1       1       1                      2     1        2        2        2                     1     1        1        1        1\n17       NY         F                 S             2     1       2       2       2                      5     1        5        5        5                     1     1        1        1        1\n18       NC         F                 S             3     2       3       3       3                      5     2        5        5        5                     1     2        1        1        1\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by ca_state\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 S             2     2       2       2       2                      4     2        4        4        4                     1     2        1        1        1\n1                   M                 W             3     2       3       3       3                      5     2        5        5        5                     6     2        6        6        6\n2                   M                 U             6     1       6       6       6                      4     1        4        4        4                     4     1        4        4        4\n3                   F                 S             4     2       4       4       4                      5     2        5        5        5                     5     2        5        5        5\n4                   M                 S             2     3       2       2       2                      2     3        2        2        2                     5     3        5        5        5\n5                   M                 U             0     2       0       0       0                      0     2        0        0        0                     5     2        5        5        5\n6                   M                 W             5     2       5       5       5                      2     2        2        2        2                     0     2        0        0        0\n7                   M                 U             0     2       0       0       0                      3     2        3        3        3                     1     2        1        1        1\n8                   M                 D             1     2       1       1       1                      2     2        2        2        2                     2     2        2        2        2\n9                   F                 D             3     2       3       3       3                      0     2        0        0        0                     3     2        3        3        3\n10                  F                 W             0     3       0       0       0                      6     3        6        6        6                     6     3        6        6        6\n11                  F                 W             3     1       3       3       3                      3     1        3        3        3                     0     1        0        0        0\n12                  F                 U             1     1       1       1       1                      3     1        3        3        3                     0     1        0        0        0\n13                  M                 S             3     3       3       3       3                      0     3        0        0        0                     6     3        6        6        6\n14                  M                 W             5     1       5       5       5                      0     1        0        0        0                     1     1        1        1        1\n15                  F                 D             5     3       5       5       5                      0     3        0        0        0                     4     3        4        4        4\n16                  F                 M             3     1       3       3       3                      0     1        0        0        0                     0     1        0        0        0\n17                  M                 M             3     1       3       3       3                      3     1        3        3        3                     1     1        1        1        1\n18                  M                 S             6     3       6       6       6                      6     3        6        6        6                     4     3        4        4        4\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.024567,
                    "execution_time": 0.011057,
                    "compile_time": 8.9e-05,
                    "planning_time": 0.006042
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.06226,
                    "execution_time": 0.011605,
                    "compile_time": 8.7e-05,
                    "planning_time": 0.041554
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" NULLS LAST"
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 S             2     2       2       2       2                      4     2        4        4        4                     1     2        1        1        1\n1                   M                 W             3     2       3       3       3                      5     2        5        5        5                     6     2        6        6        6\n2                   M                 U             6     1       6       6       6                      4     1        4        4        4                     4     1        4        4        4\n3                   F                 S             4     2       4       4       4                      5     2        5        5        5                     5     2        5        5        5\n4                   M                 S             2     3       2       2       2                      2     3        2        2        2                     5     3        5        5        5\n5                   M                 U             0     2       0       0       0                      0     2        0        0        0                     5     2        5        5        5\n6                   M                 W             5     2       5       5       5                      2     2        2        2        2                     0     2        0        0        0\n7                   M                 U             0     2       0       0       0                      3     2        3        3        3                     1     2        1        1        1\n8                   M                 D             1     2       1       1       1                      2     2        2        2        2                     2     2        2        2        2\n9                   F                 D             3     2       3       3       3                      0     2        0        0        0                     3     2        3        3        3\n10                  F                 W             0     3       0       0       0                      6     3        6        6        6                     6     3        6        6        6\n11                  F                 W             3     1       3       3       3                      3     1        3        3        3                     0     1        0        0        0\n12                  F                 U             1     1       1       1       1                      3     1        3        3        3                     0     1        0        0        0\n13                  M                 S             3     3       3       3       3                      0     3        0        0        0                     6     3        6        6        6\n14                  M                 W             5     1       5       5       5                      0     1        0        0        0                     1     1        1        1        1\n15                  F                 D             5     3       5       5       5                      0     3        0        0        0                     4     3        4        4        4\n16                  F                 M             3     1       3       3       3                      0     1        0        0        0                     0     1        0        0        0\n17                  M                 M             3     1       3       3       3                      3     1        3        3        3                     1     1        1        1        1\n18                  M                 S             6     3       6       6       6                      6     3        6        6        6                     4     3        4        4        4\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c, customer_address ca, customer_demographics cd\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd.cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales ss, date_dim d\n          where c.c_customer_sk = ss.ss_customer_sk and\n                ss.ss_sold_date_sk = d.d_date_sk and\n                d.d_year = 1999 and\n                d.d_qoy < 4) and\n   exists (select * from\n\t   (select ws.ws_bill_customer_sk customsk\n            from web_sales ws, date_dim d\n            where \n                  ws.ws_sold_date_sk = d.d_date_sk and\n                  d.d_year = 1999 and\n                  d.d_qoy < 4\n\t    union all \n    \t    select cs.cs_ship_customer_sk customsk\n            from catalog_sales cs, date_dim d\n            where \n                  cs.cs_sold_date_sk = d.d_date_sk and\n                  d.d_year = 1999 and\n                  d.d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by ca_state,\n          cd_gender,\n/*CURSOR_IDENTIFIER*/\n          cd_marital_status",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"SS\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"SS\" JOIN \"DATE_DIM\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"SS\".\"SS_SOLD_DATE_SK\" AND \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999 GROUP BY \"SS\".\"SS_CUSTOMER_SK\" ) , \"D_2\" AS ( SELECT \"D\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"D\".\"D_YEAR\" AS \"D_YEAR\" , \"D\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"D\" WHERE \"D\".\"D_QOY\" < 4 AND \"D\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WS\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WS\" JOIN \"D_2\" AS \"D\" ON \"D\".\"D_DATE_SK\" = \"WS\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CS\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CS\" JOIN \"D_2\" AS \"D\" ON \"CS\".\"CS_SOLD_DATE_SK\" = \"D\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ORDER BY \"CA_STATE\" , \"CD_GENDER\" , \"CD_MARITAL_STATUS\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             2     1       2       2       2                      4     1        4        4        4                     1     1        1        1        1\n1                   F                 D             3     1       3       3       3                      6     1        6        6        6                     5     1        5        5        5\n2                   F                 D             2     2       2       2       2                      4     2        4        4        4                     0     2        0        0        0\n3                   F                 D             3     1       3       3       3                      6     1        6        6        6                     1     1        1        1        1\n4                   F                 D             0     2       0       0       0                      0     2        0        0        0                     5     2        5        5        5\n5                   F                 D             1     1       1       1       1                      5     1        5        5        5                     3     1        3        3        3\n6                   F                 D             0     1       0       0       0                      0     1        0        0        0                     3     1        3        3        3\n7                   F                 D             4     1       4       4       4                      0     1        0        0        0                     2     1        2        2        2\n8                   F                 D             4     1       4       4       4                      5     1        5        5        5                     5     1        5        5        5\n9                   F                 D             3     1       3       3       3                      2     1        2        2        2                     0     1        0        0        0\n10                  F                 D             0     1       0       0       0                      4     1        4        4        4                     0     1        0        0        0\n11                  F                 D             2     1       2       2       2                      2     1        2        2        2                     5     1        5        5        5\n12                  F                 D             3     1       3       3       3                      3     1        3        3        3                     4     1        4        4        4\n13                  F                 D             6     2       6       6       6                      5     2        5        5        5                     5     2        5        5        5\n14                  F                 D             5     2       5       5       5                      1     2        1        1        1                     1     2        1        1        1\n15                  F                 D             3     3       3       3       3                      6     3        6        6        6                     4     3        4        4        4\n16                  F                 D             6     2       6       6       6                      5     2        5        5        5                     6     2        6        6        6\n17                  F                 D             0     1       0       0       0                      4     1        4        4        4                     2     1        2        2        2\n18                  F                 D             0     3       0       0       0                      6     3        6        6        6                     1     3        1        1        1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.025357,
                    "execution_time": 0.011421,
                    "compile_time": 9.3e-05,
                    "planning_time": 0.006194
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060646,
                    "execution_time": 0.011284,
                    "compile_time": 9.1e-05,
                    "planning_time": 0.041658
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CD\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CD\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CD\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CD\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" ON \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CD\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_1\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_14\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CD\".\"CD_GENDER\" , \"CD\".\"CD_MARITAL_STATUS\" , \"CD\".\"CD_DEP_COUNT\" , \"CD\".\"CD_DEP_EMPLOYED_COUNT\" , \"CD\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_15\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_15\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST"
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             2     1       2       2       2                      4     1        4        4        4                     1     1        1        1        1\n1                   F                 D             3     1       3       3       3                      6     1        6        6        6                     5     1        5        5        5\n2                   F                 D             2     2       2       2       2                      4     2        4        4        4                     0     2        0        0        0\n3                   F                 D             3     1       3       3       3                      6     1        6        6        6                     1     1        1        1        1\n4                   F                 D             0     2       0       0       0                      0     2        0        0        0                     5     2        5        5        5\n5                   F                 D             1     1       1       1       1                      5     1        5        5        5                     3     1        3        3        3\n6                   F                 D             0     1       0       0       0                      0     1        0        0        0                     3     1        3        3        3\n7                   F                 D             4     1       4       4       4                      0     1        0        0        0                     2     1        2        2        2\n8                   F                 D             4     1       4       4       4                      5     1        5        5        5                     5     1        5        5        5\n9                   F                 D             3     1       3       3       3                      2     1        2        2        2                     0     1        0        0        0\n10                  F                 D             0     1       0       0       0                      4     1        4        4        4                     0     1        0        0        0\n11                  F                 D             2     1       2       2       2                      2     1        2        2        2                     5     1        5        5        5\n12                  F                 D             3     1       3       3       3                      3     1        3        3        3                     4     1        4        4        4\n13                  F                 D             6     2       6       6       6                      5     2        5        5        5                     5     2        5        5        5\n14                  F                 D             5     2       5       5       5                      1     2        1        1        1                     1     2        1        1        1\n15                  F                 D             3     3       3       3       3                      6     3        6        6        6                     4     3        4        4        4\n16                  F                 D             6     2       6       6       6                      5     2        5        5        5                     6     2        6        6        6\n17                  F                 D             0     1       0       0       0                      4     1        4        4        4                     2     1        2        2        2\n18                  F                 D             0     3       0       0       0                      6     3        6        6        6                     1     3        1        1        1\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by ca_state,\n          cd_gender,\n          cd_marital_status\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" , \"CD_GENDER\" , \"CD_MARITAL_STATUS\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             0     1       0       0       0                      5     1        5        5        5                     4     1        4        4        4\n1                   F                 D             2     1       2       2       2                      2     1        2        2        2                     3     1        3        3        3\n2                   F                 D             5     1       5       5       5                      1     1        1        1        1                     6     1        6        6        6\n3                   F                 D             3     1       3       3       3                      3     1        3        3        3                     3     1        3        3        3\n4                   F                 D             0     1       0       0       0                      5     1        5        5        5                     1     1        1        1        1\n5                   F                 D             3     1       3       3       3                      4     1        4        4        4                     2     1        2        2        2\n6                   F                 D             6     1       6       6       6                      0     1        0        0        0                     1     1        1        1        1\n7                   F                 D             2     3       2       2       2                      6     3        6        6        6                     5     3        5        5        5\n8                   F                 D             3     2       3       3       3                      0     2        0        0        0                     6     2        6        6        6\n9                   F                 D             6     1       6       6       6                      4     1        4        4        4                     6     1        6        6        6\n10                  F                 D             0     1       0       0       0                      4     1        4        4        4                     2     1        2        2        2\n11                  F                 D             1     1       1       1       1                      0     1        0        0        0                     2     1        2        2        2\n12                  F                 D             3     1       3       3       3                      6     1        6        6        6                     6     1        6        6        6\n13                  F                 D             5     1       5       5       5                      4     1        4        4        4                     4     1        4        4        4\n14                  F                 D             5     1       5       5       5                      1     1        1        1        1                     2     1        2        2        2\n15                  F                 D             4     1       4       4       4                      0     1        0        0        0                     2     1        2        2        2\n16                  F                 D             5     1       5       5       5                      0     1        0        0        0                     1     1        1        1        1\n17                  F                 D             3     1       3       3       3                      6     1        6        6        6                     5     1        5        5        5\n18                  F                 D             4     1       4       4       4                      4     1        4        4        4                     2     1        2        2        2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.024825,
                    "execution_time": 0.01085,
                    "compile_time": 9.2e-05,
                    "planning_time": 0.006303
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060681,
                    "execution_time": 0.010864,
                    "compile_time": 0.000102,
                    "planning_time": 0.041975
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST"
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             0     1       0       0       0                      5     1        5        5        5                     4     1        4        4        4\n1                   F                 D             2     1       2       2       2                      2     1        2        2        2                     3     1        3        3        3\n2                   F                 D             5     1       5       5       5                      1     1        1        1        1                     6     1        6        6        6\n3                   F                 D             3     1       3       3       3                      3     1        3        3        3                     3     1        3        3        3\n4                   F                 D             0     1       0       0       0                      5     1        5        5        5                     1     1        1        1        1\n5                   F                 D             3     1       3       3       3                      4     1        4        4        4                     2     1        2        2        2\n6                   F                 D             6     1       6       6       6                      0     1        0        0        0                     1     1        1        1        1\n7                   F                 D             2     3       2       2       2                      6     3        6        6        6                     5     3        5        5        5\n8                   F                 D             3     2       3       3       3                      0     2        0        0        0                     6     2        6        6        6\n9                   F                 D             6     1       6       6       6                      4     1        4        4        4                     6     1        6        6        6\n10                  F                 D             0     1       0       0       0                      4     1        4        4        4                     2     1        2        2        2\n11                  F                 D             1     1       1       1       1                      0     1        0        0        0                     2     1        2        2        2\n12                  F                 D             3     1       3       3       3                      6     1        6        6        6                     6     1        6        6        6\n13                  F                 D             5     1       5       5       5                      4     1        4        4        4                     4     1        4        4        4\n14                  F                 D             5     1       5       5       5                      1     1        1        1        1                     2     1        2        2        2\n15                  F                 D             4     1       4       4       4                      0     1        0        0        0                     2     1        2        2        2\n16                  F                 D             5     1       5       5       5                      0     1        0        0        0                     1     1        1        1        1\n17                  F                 D             3     1       3       3       3                      6     1        6        6        6                     5     1        5        5        5\n18                  F                 D             4     1       4       4       4                      4     1        4        4        4                     2     1        2        2        2\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" , \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_DEP_COUNT\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             0     1       0       0       0                      5     1        5        5        5                     4     1        4        4        4\n1                   F                 D             0     2       0       0       0                      0     2        0        0        0                     6     2        6        6        6\n2                   F                 D             0     1       0       0       0                      4     1        4        4        4                     0     1        0        0        0\n3                   F                 D             0     3       0       0       0                      6     3        6        6        6                     3     3        3        3        3\n4                   F                 D             0     1       0       0       0                      5     1        5        5        5                     5     1        5        5        5\n5                   F                 D             0     1       0       0       0                      5     1        5        5        5                     1     1        1        1        1\n6                   F                 D             0     2       0       0       0                      0     2        0        0        0                     0     2        0        0        0\n7                   F                 D             0     3       0       0       0                      1     3        1        1        1                     1     3        1        1        1\n8                   F                 D             0     1       0       0       0                      4     1        4        4        4                     2     1        2        2        2\n9                   F                 D             0     1       0       0       0                      4     1        4        4        4                     6     1        6        6        6\n10                  F                 D             0     3       0       0       0                      6     3        6        6        6                     1     3        1        1        1\n11                  F                 D             0     2       0       0       0                      3     2        3        3        3                     5     2        5        5        5\n12                  F                 D             0     1       0       0       0                      5     1        5        5        5                     3     1        3        3        3\n13                  F                 D             0     2       0       0       0                      4     2        4        4        4                     4     2        4        4        4\n14                  F                 D             0     1       0       0       0                      0     1        0        0        0                     3     1        3        3        3\n15                  F                 D             0     1       0       0       0                      4     1        4        4        4                     3     1        3        3        3\n16                  F                 D             0     2       0       0       0                      0     2        0        0        0                     5     2        5        5        5\n17                  F                 D             0     1       0       0       0                      0     1        0        0        0                     4     1        4        4        4\n18                  F                 D             0     4       0       0       0                      3     4        3        3        3                     0     4        0        0        0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.024656,
                    "execution_time": 0.010657,
                    "compile_time": 9.4e-05,
                    "planning_time": 0.006339
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.060625,
                    "execution_time": 0.010921,
                    "compile_time": 9.1e-05,
                    "planning_time": 0.042025
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST"
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             0     1       0       0       0                      5     1        5        5        5                     4     1        4        4        4\n1                   F                 D             0     2       0       0       0                      0     2        0        0        0                     6     2        6        6        6\n2                   F                 D             0     1       0       0       0                      4     1        4        4        4                     0     1        0        0        0\n3                   F                 D             0     3       0       0       0                      6     3        6        6        6                     3     3        3        3        3\n4                   F                 D             0     1       0       0       0                      5     1        5        5        5                     5     1        5        5        5\n5                   F                 D             0     1       0       0       0                      5     1        5        5        5                     1     1        1        1        1\n6                   F                 D             0     2       0       0       0                      0     2        0        0        0                     0     2        0        0        0\n7                   F                 D             0     3       0       0       0                      1     3        1        1        1                     1     3        1        1        1\n8                   F                 D             0     1       0       0       0                      4     1        4        4        4                     2     1        2        2        2\n9                   F                 D             0     1       0       0       0                      4     1        4        4        4                     6     1        6        6        6\n10                  F                 D             0     3       0       0       0                      6     3        6        6        6                     1     3        1        1        1\n11                  F                 D             0     2       0       0       0                      3     2        3        3        3                     5     2        5        5        5\n12                  F                 D             0     1       0       0       0                      5     1        5        5        5                     3     1        3        3        3\n13                  F                 D             0     2       0       0       0                      4     2        4        4        4                     4     2        4        4        4\n14                  F                 D             0     1       0       0       0                      0     1        0        0        0                     3     1        3        3        3\n15                  F                 D             0     1       0       0       0                      4     1        4        4        4                     3     1        3        3        3\n16                  F                 D             0     2       0       0       0                      0     2        0        0        0                     5     2        5        5        5\n17                  F                 D             0     1       0       0       0                      0     1        0        0        0                     4     1        4        4        4\n18                  F                 D             0     4       0       0       0                      3     4        3        3        3                     0     4        0        0        0\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" , \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_DEP_COUNT\" , \"CD_DEP_EMPLOYED_COUNT\" , \"CD_DEP_COLLEGE_COUNT\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             0     2       0       0       0                      0     2        0        0        0                     0     2        0        0        0\n1                   F                 D             0     1       0       0       0                      0     1        0        0        0                     3     1        3        3        3\n2                   F                 D             0     1       0       0       0                      0     1        0        0        0                     4     1        4        4        4\n3                   F                 D             0     2       0       0       0                      0     2        0        0        0                     5     2        5        5        5\n4                   F                 D             0     2       0       0       0                      0     2        0        0        0                     6     2        6        6        6\n5                   F                 D             0     3       0       0       0                      1     3        1        1        1                     1     3        1        1        1\n6                   F                 D             0     4       0       0       0                      3     4        3        3        3                     0     4        0        0        0\n7                   F                 D             0     1       0       0       0                      3     1        3        3        3                     2     1        2        2        2\n8                   F                 D             0     2       0       0       0                      3     2        3        3        3                     5     2        5        5        5\n9                   F                 D             0     1       0       0       0                      4     1        4        4        4                     0     1        0        0        0\n10                  F                 D             0     1       0       0       0                      4     1        4        4        4                     2     1        2        2        2\n11                  F                 D             0     1       0       0       0                      4     1        4        4        4                     3     1        3        3        3\n12                  F                 D             0     2       0       0       0                      4     2        4        4        4                     4     2        4        4        4\n13                  F                 D             0     1       0       0       0                      4     1        4        4        4                     6     1        6        6        6\n14                  F                 D             0     1       0       0       0                      5     1        5        5        5                     1     1        1        1        1\n15                  F                 D             0     1       0       0       0                      5     1        5        5        5                     3     1        3        3        3\n16                  F                 D             0     1       0       0       0                      5     1        5        5        5                     4     1        4        4        4\n17                  F                 D             0     1       0       0       0                      5     1        5        5        5                     5     1        5        5        5\n18                  F                 D             0     3       0       0       0                      6     3        6        6        6                     1     3        1        1        1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.02551,
                    "execution_time": 0.0114,
                    "compile_time": 9e-05,
                    "planning_time": 0.006502
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.061363,
                    "execution_time": 0.011532,
                    "compile_time": 9e-05,
                    "planning_time": 0.042008
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST"
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             0     2       0       0       0                      0     2        0        0        0                     0     2        0        0        0\n1                   F                 D             0     1       0       0       0                      0     1        0        0        0                     3     1        3        3        3\n2                   F                 D             0     1       0       0       0                      0     1        0        0        0                     4     1        4        4        4\n3                   F                 D             0     2       0       0       0                      0     2        0        0        0                     5     2        5        5        5\n4                   F                 D             0     2       0       0       0                      0     2        0        0        0                     6     2        6        6        6\n5                   F                 D             0     3       0       0       0                      1     3        1        1        1                     1     3        1        1        1\n6                   F                 D             0     4       0       0       0                      3     4        3        3        3                     0     4        0        0        0\n7                   F                 D             0     1       0       0       0                      3     1        3        3        3                     2     1        2        2        2\n8                   F                 D             0     2       0       0       0                      3     2        3        3        3                     5     2        5        5        5\n9                   F                 D             0     1       0       0       0                      4     1        4        4        4                     0     1        0        0        0\n10                  F                 D             0     1       0       0       0                      4     1        4        4        4                     2     1        2        2        2\n11                  F                 D             0     1       0       0       0                      4     1        4        4        4                     3     1        3        3        3\n12                  F                 D             0     2       0       0       0                      4     2        4        4        4                     4     2        4        4        4\n13                  F                 D             0     1       0       0       0                      4     1        4        4        4                     6     1        6        6        6\n14                  F                 D             0     1       0       0       0                      5     1        5        5        5                     1     1        1        1        1\n15                  F                 D             0     1       0       0       0                      5     1        5        5        5                     3     1        3        3        3\n16                  F                 D             0     1       0       0       0                      5     1        5        5        5                     4     1        4        4        4\n17                  F                 D             0     1       0       0       0                      5     1        5        5        5                     5     1        5        5        5\n18                  F                 D             0     3       0       0       0                      6     3        6        6        6                     1     3        1        1        1\n...*/"
    },
    {
        "input": "-- start template query35a.tpl query 47 in stream 0\nselect /* TPC-DS query35a.tpl 0.47 */   \n  ca_state,\n  cd_gender,\n  cd_marital_status,\n  cd_dep_count,\n  count(*) cnt1,\n  max(cd_dep_count),\n  min(cd_dep_count),\n  max(cd_dep_count),\n  cd_dep_employed_count,\n  count(*) cnt2,\n  max(cd_dep_employed_count),\n  min(cd_dep_employed_count),\n  max(cd_dep_employed_count),\n  cd_dep_college_count,\n  count(*) cnt3,\n  max(cd_dep_college_count),\n  min(cd_dep_college_count),\n  max(cd_dep_college_count)\n from\n  customer c,customer_address ca,customer_demographics\n where\n  c.c_current_addr_sk = ca.ca_address_sk and\n  cd_demo_sk = c.c_current_cdemo_sk and \n  exists (select *\n          from store_sales,date_dim\n          where c.c_customer_sk = ss_customer_sk and\n                ss_sold_date_sk = d_date_sk and\n                d_year = 1999 and\n                d_qoy < 4) and\n   exists (select * from\n\t   (select ws_bill_customer_sk customsk\n            from web_sales,date_dim\n            where \n                  ws_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4\n\t    union all \n    \t    select cs_ship_customer_sk customsk\n            from catalog_sales,date_dim\n            where \n                  cs_sold_date_sk = d_date_sk and\n                  d_year = 1999 and\n                  d_qoy < 4)x \n           where x.customsk = c.c_customer_sk)\n group by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n order by ca_state,\n          cd_gender,\n          cd_marital_status,\n          cd_dep_count,\n          cd_dep_employed_count,\n          cd_dep_college_count\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"_U_1\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) , \"DATE_DIM_3\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"DATE_DIM\".\"D_QOY\" AS \"D_QOY\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_QOY\" < 4 AND \"DATE_DIM\".\"D_YEAR\" = 1999 ) , \"X\" AS ( SELECT \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" UNION ALL SELECT \"CATALOG_SALES\".\"CS_SHIP_CUSTOMER_SK\" AS \"CUSTOMSK\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"DATE_DIM_3\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" ) , \"_U_2\" AS ( SELECT \"X\".\"CUSTOMSK\" AS \"CUSTOMSK\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CUSTOMSK\" ) SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"_U_2\" AS \"_U_2\" ON \"_U_2\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"_U_0\".\"_U_1\" IS NULL AND NOT \"_U_2\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" , \"CD_GENDER\" , \"CD_MARITAL_STATUS\" , \"CD_DEP_COUNT\" , \"CD_DEP_EMPLOYED_COUNT\" , \"CD_DEP_COLLEGE_COUNT\" LIMIT 21",
                "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             0     2       0       0       0                      0     2        0        0        0                     0     2        0        0        0\n1                   F                 D             0     1       0       0       0                      0     1        0        0        0                     3     1        3        3        3\n2                   F                 D             0     1       0       0       0                      0     1        0        0        0                     4     1        4        4        4\n3                   F                 D             0     2       0       0       0                      0     2        0        0        0                     5     2        5        5        5\n4                   F                 D             0     2       0       0       0                      0     2        0        0        0                     6     2        6        6        6\n5                   F                 D             0     3       0       0       0                      1     3        1        1        1                     1     3        1        1        1\n6                   F                 D             0     4       0       0       0                      3     4        3        3        3                     0     4        0        0        0\n7                   F                 D             0     1       0       0       0                      3     1        3        3        3                     2     1        2        2        2\n8                   F                 D             0     2       0       0       0                      3     2        3        3        3                     5     2        5        5        5\n9                   F                 D             0     1       0       0       0                      4     1        4        4        4                     0     1        0        0        0\n10                  F                 D             0     1       0       0       0                      4     1        4        4        4                     2     1        2        2        2\n11                  F                 D             0     1       0       0       0                      4     1        4        4        4                     3     1        3        3        3\n12                  F                 D             0     2       0       0       0                      4     2        4        4        4                     4     2        4        4        4\n13                  F                 D             0     1       0       0       0                      4     1        4        4        4                     6     1        6        6        6\n14                  F                 D             0     1       0       0       0                      5     1        5        5        5                     1     1        1        1        1\n15                  F                 D             0     1       0       0       0                      5     1        5        5        5                     3     1        3        3        3\n16                  F                 D             0     1       0       0       0                      5     1        5        5        5                     4     1        4        4        4\n17                  F                 D             0     1       0       0       0                      5     1        5        5        5                     5     1        5        5        5\n18                  F                 D             0     3       0       0       0                      6     3        6        6        6                     1     3        1        1        1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.025109,
                    "execution_time": 0.010715,
                    "compile_time": 9e-05,
                    "planning_time": 0.006417
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.027201,
                    "execution_time": 0.011643,
                    "compile_time": 9.1e-05,
                    "planning_time": 0.006663
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CA\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" AS \"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , COUNT ( * ) AS \"CNT1\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_5\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_6\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" ) AS \"_COL_7\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , COUNT ( * ) AS \"CNT2\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_10\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_11\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" ) AS \"_COL_12\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , COUNT ( * ) AS \"CNT3\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_15\" , MIN ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_16\" , MAX ( \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ) AS \"_COL_17\" FROM \"CUSTOMER\" AS \"C\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" = \"C\".\"C_CUSTOMER_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" = \"C\".\"C_CUSTOMER_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CA\" ON \"C\".\"C_CURRENT_ADDR_SK\" = \"CA\".\"CA_ADDRESS_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"C\".\"C_CURRENT_CDEMO_SK\" = \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" WHERE NOT \"SPEQLITE_TEMP_TABLE_7\".\"_U_1\" IS NULL AND NOT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMSK\" IS NULL GROUP BY \"CA\".\"CA_STATE\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_EMPLOYED_COUNT\" , \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEP_COLLEGE_COUNT\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_GENDER\" AS \"CD_GENDER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_MARITAL_STATUS\" AS \"CD_MARITAL_STATUS\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COUNT\" AS \"CD_DEP_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT1\" AS \"CNT1\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_5\" AS \"_COL_5\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_6\" AS \"_COL_6\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_7\" AS \"_COL_7\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_EMPLOYED_COUNT\" AS \"CD_DEP_EMPLOYED_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT2\" AS \"CNT2\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_10\" AS \"_COL_10\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_11\" AS \"_COL_11\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_12\" AS \"_COL_12\" , \"SPEQLITE_TEMP_TABLE_11\".\"CD_DEP_COLLEGE_COUNT\" AS \"CD_DEP_COLLEGE_COUNT\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT3\" AS \"CNT3\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_15\" AS \"_COL_15\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_16\" AS \"_COL_16\" , \"SPEQLITE_TEMP_TABLE_11\".\"_COL_17\" AS \"_COL_17\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"CA_STATE\" NULLS LAST , \"CD_GENDER\" NULLS LAST , \"CD_MARITAL_STATUS\" NULLS LAST , \"CD_DEP_COUNT\" NULLS LAST , \"CD_DEP_EMPLOYED_COUNT\" NULLS LAST , \"CD_DEP_COLLEGE_COUNT\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   ca_state cd_gender cd_marital_status  cd_dep_count  cnt1  _col_5  _col_6  _col_7  cd_dep_employed_count  cnt2  _col_10  _col_11  _col_12  cd_dep_college_count  cnt3  _col_15  _col_16  _col_17\n0                   F                 D             0     2       0       0       0                      0     2        0        0        0                     0     2        0        0        0\n1                   F                 D             0     1       0       0       0                      0     1        0        0        0                     3     1        3        3        3\n2                   F                 D             0     1       0       0       0                      0     1        0        0        0                     4     1        4        4        4\n3                   F                 D             0     2       0       0       0                      0     2        0        0        0                     5     2        5        5        5\n4                   F                 D             0     2       0       0       0                      0     2        0        0        0                     6     2        6        6        6\n5                   F                 D             0     3       0       0       0                      1     3        1        1        1                     1     3        1        1        1\n6                   F                 D             0     4       0       0       0                      3     4        3        3        3                     0     4        0        0        0\n7                   F                 D             0     1       0       0       0                      3     1        3        3        3                     2     1        2        2        2\n8                   F                 D             0     2       0       0       0                      3     2        3        3        3                     5     2        5        5        5\n9                   F                 D             0     1       0       0       0                      4     1        4        4        4                     0     1        0        0        0\n10                  F                 D             0     1       0       0       0                      4     1        4        4        4                     2     1        2        2        2\n11                  F                 D             0     1       0       0       0                      4     1        4        4        4                     3     1        3        3        3\n12                  F                 D             0     2       0       0       0                      4     2        4        4        4                     4     2        4        4        4\n13                  F                 D             0     1       0       0       0                      4     1        4        4        4                     6     1        6        6        6\n14                  F                 D             0     1       0       0       0                      5     1        5        5        5                     1     1        1        1        1\n15                  F                 D             0     1       0       0       0                      5     1        5        5        5                     3     1        3        3        3\n16                  F                 D             0     1       0       0       0                      5     1        5        5        5                     4     1        4        4        4\n17                  F                 D             0     1       0       0       0                      5     1        5        5        5                     5     1        5        5        5\n18                  F                 D             0     3       0       0       0                      6     3        6        6        6                     1     3        1        1        1\n...*/"
    }
]