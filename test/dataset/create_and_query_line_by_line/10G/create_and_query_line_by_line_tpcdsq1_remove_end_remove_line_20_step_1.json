[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n-- Assuming date_dim is part of the schema, fixing missed join syntax\njoin date_dim on sr_returned_date_sk = d_date_sk\nwhere d_year = 1999\ngroup by sr_customer_sk, sr_store_sk\n) /* End of CTE */\nselect *\nfrom customer_total_return\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.500123,
                    "execution_time": 0.212673,
                    "compile_time": 0.000352,
                    "planning_time": 0.032975,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.208473,
                    "execution_time": 3.806707,
                    "compile_time": 0.000389,
                    "planning_time": 0.034746,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk  ctr_store_sk  ctr_total_return\n0            304694             8            106.54\n1            423645             4             43.14\n2            215806            76           3132.86\n3            133797            85           3724.28\n4            450463            43            267.85\n5             75493            56             94.83\n6            179677            80           3196.94\n7             67058            76             49.60\n8            139299            67             95.04\n9            293750            68              0.00\n10           400418            86            693.03\n11            57260            80           1307.92\n12           330184            49            697.44\n13           446479             1            136.67\n14           145848            61           1104.38\n15           153888           100              3.06\n16           231319            74           3863.85\n17            95209            34            319.54\n18           167305            49           3745.44\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016388,
                    "execution_time": 0.007368,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.00313
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053887,
                    "execution_time": 0.007802,
                    "compile_time": 5e-05,
                    "planning_time": 0.038186
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk  ctr_store_sk  ctr_total_return\n0            304694             8            106.54\n1            423645             4             43.14\n2            215806            76           3132.86\n3            133797            85           3724.28\n4            450463            43            267.85\n5             75493            56             94.83\n6            179677            80           3196.94\n7             67058            76             49.60\n8            139299            67             95.04\n9            293750            68              0.00\n10           400418            86            693.03\n11            57260            80           1307.92\n12           330184            49            697.44\n13           446479             1            136.67\n14           145848            61           1104.38\n15           153888           100              3.06\n16           231319            74           3863.85\n17            95209            34            319.54\n18           167305            49           3745.44\n...*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\nselect * from customer_total_return /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk  ctr_store_sk  ctr_total_return\n0            304694             8            106.54\n1            423645             4             43.14\n2            215806            76           3132.86\n3            133797            85           3724.28\n4            450463            43            267.85\n5             75493            56             94.83\n6            179677            80           3196.94\n7             67058            76             49.60\n8            139299            67             95.04\n9            293750            68              0.00\n10           400418            86            693.03\n11            57260            80           1307.92\n12           330184            49            697.44\n13           446479             1            136.67\n14           145848            61           1104.38\n15           153888           100              3.06\n16           231319            74           3863.85\n17            95209            34            319.54\n18           167305            49           3745.44\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016403,
                    "execution_time": 0.007259,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003196
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.016706,
                    "execution_time": 0.007692,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003191
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk  ctr_store_sk  ctr_total_return\n0            304694             8            106.54\n1            423645             4             43.14\n2            215806            76           3132.86\n3            133797            85           3724.28\n4            450463            43            267.85\n5             75493            56             94.83\n6            179677            80           3196.94\n7             67058            76             49.60\n8            139299            67             95.04\n9            293750            68              0.00\n10           400418            86            693.03\n11            57260            80           1307.92\n12           330184            49            697.44\n13           446479             1            136.67\n14           145848            61           1104.38\n15           153888           100              3.06\n16           231319            74           3863.85\n17            95209            34            319.54\n18           167305            49           3745.44\n...*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n-- Assuming date_dim is a valid table with the necessary columns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select ctr_customer_sk\nfrom customer_total_return\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) SELECT \"CUSTOMER_TOTAL_RETURN\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.263473,
                    "execution_time": 0.189293,
                    "compile_time": 0.000233,
                    "planning_time": 0.002659,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.605328,
                    "execution_time": 0.187803,
                    "compile_time": 0.000248,
                    "planning_time": 0.34196,
                    "create_size": 512
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk\n0          293899.0\n1          240506.0\n2          328137.0\n3          496527.0\n4               NaN\n5          352040.0\n6          254267.0\n7          273089.0\n8           45992.0\n9          226144.0\n10          47143.0\n11          38553.0\n12         190320.0\n13         158526.0\n14         373483.0\n15         473973.0\n16         381372.0\n17         136027.0\n18         436091.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015737,
                    "execution_time": 0.007491,
                    "compile_time": 4e-05,
                    "planning_time": 0.00271
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053514,
                    "execution_time": 0.007565,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.037726
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk\n0          293899.0\n1          240506.0\n2          328137.0\n3          496527.0\n4               NaN\n5          352040.0\n6          254267.0\n7          273089.0\n8           45992.0\n9          226144.0\n10          47143.0\n11          38553.0\n12         190320.0\n13         158526.0\n14         373483.0\n15         473973.0\n16         381372.0\n17         136027.0\n18         436091.0\n...*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select ctr_customer_sk, ctr_store_sk\nfrom customer_total_return ctr1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CTR1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.303785,
                    "execution_time": 0.190314,
                    "compile_time": 0.000234,
                    "planning_time": 0.002834,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.367914,
                    "execution_time": 0.19266,
                    "compile_time": 0.000234,
                    "planning_time": 0.059581,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CTR1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk  ctr_store_sk\n0            438417             1\n1             65483            50\n2            126864            26\n3            482148            80\n4            218582            76\n5            372032            62\n6             49784            16\n7            241532            86\n8            407714            26\n9            434559            55\n10           221200            74\n11            99734            38\n12           227495            10\n13           181066            38\n14           190898            44\n15           203411            32\n16           226153            56\n17            37923            91\n18           151940            28\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015817,
                    "execution_time": 0.007139,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.002976
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053816,
                    "execution_time": 0.007599,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.037846
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CTR1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\"",
                "rewrite": "SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"CTR1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"CTR1\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk  ctr_store_sk\n0            438417             1\n1             65483            50\n2            126864            26\n3            482148            80\n4            218582            76\n5            372032            62\n6             49784            16\n7            241532            86\n8            407714            26\n9            434559            55\n10           221200            74\n11            99734            38\n12           227495            10\n13           181066            38\n14           190898            44\n15           203411            32\n16           226153            56\n17            37923            91\n18           151940            28\n...*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  ctr_customer_sk\nfrom customer_total_return ctr1\n,store\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"STORE\" AS \"STORE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" CROSS JOIN \"STORE\" AS \"STORE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.783956,
                    "execution_time": 0.665809,
                    "compile_time": 0.000282,
                    "planning_time": 0.025852,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.877835,
                    "execution_time": 0.785736,
                    "compile_time": 0.000296,
                    "planning_time": 0.024637,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*    ctr_customer_sk\n0            320378\n1            320378\n2            320378\n3            320378\n4            320378\n5            320378\n6            320378\n7            320378\n8            127717\n9            127717\n10           127717\n11           127717\n12           127717\n13           127717\n14           127717\n15           127717\n16           127717\n17           127717\n18           127717\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015713,
                    "execution_time": 0.007356,
                    "compile_time": 4.1e-05,
                    "planning_time": 0.002757
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05417,
                    "execution_time": 0.008183,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.037592
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CTR1\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"CTR1\" CROSS JOIN \"STORE\" AS \"STORE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"CTR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*    ctr_customer_sk\n0            320378\n1            320378\n2            320378\n3            320378\n4            320378\n5            320378\n6            320378\n7            320378\n8            127717\n9            127717\n10           127717\n11           127717\n12           127717\n13           127717\n14           127717\n15           127717\n16           127717\n17           127717\n18           127717\n...*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT MAX ( 1 ) AS \"_\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT MAX ( 1 ) AS \"_\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.27957,
                    "execution_time": 0.198749,
                    "compile_time": 0.000344,
                    "planning_time": 0.031698,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.360432,
                    "execution_time": 0.209956,
                    "compile_time": 0.000362,
                    "planning_time": 0.099079,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" LIMIT 21",
                "preview": "\n/*       c_customer_id\n0   AAAAAAAAEBAAAAAA\n1   AAAAAAAAEBAAAAAA\n2   AAAAAAAAEBAAAAAA\n3   AAAAAAAAEBAAAAAA\n4   AAAAAAAAEBAAAAAA\n5   AAAAAAAAEBAAAAAA\n6   AAAAAAAAEBAAAAAA\n7   AAAAAAAAEBAAAAAA\n8   AAAAAAAAEBAAAAAA\n9   AAAAAAAAEBAAAAAA\n10  AAAAAAAAEBAAAAAA\n11  AAAAAAAAEBAAAAAA\n12  AAAAAAAAEBAAAAAA\n13  AAAAAAAAEBAAAAAA\n14  AAAAAAAAEBAAAAAA\n15  AAAAAAAAEBAAAAAA\n16  AAAAAAAAEBAAAAAA\n17  AAAAAAAAEBAAAAAA\n18  AAAAAAAAEBAAAAAA\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.055981,
                    "execution_time": 0.015744,
                    "compile_time": 0.000125,
                    "planning_time": 0.032287
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.11747,
                    "execution_time": 0.01496,
                    "compile_time": 0.000149,
                    "planning_time": 0.092436
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\""
            }
        ],
        "preview": "\n/*       c_customer_id\n0   AAAAAAAAEBAAAAAA\n1   AAAAAAAAEBAAAAAA\n2   AAAAAAAAEBAAAAAA\n3   AAAAAAAAEBAAAAAA\n4   AAAAAAAAEBAAAAAA\n5   AAAAAAAAEBAAAAAA\n6   AAAAAAAAEBAAAAAA\n7   AAAAAAAAEBAAAAAA\n8   AAAAAAAAEBAAAAAA\n9   AAAAAAAAEBAAAAAA\n10  AAAAAAAAEBAAAAAA\n11  AAAAAAAAEBAAAAAA\n12  AAAAAAAAEBAAAAAA\n13  AAAAAAAAEBAAAAAA\n14  AAAAAAAAEBAAAAAA\n15  AAAAAAAAEBAAAAAA\n16  AAAAAAAAEBAAAAAA\n17  AAAAAAAAEBAAAAAA\n18  AAAAAAAAEBAAAAAA\n...*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CUSTOMER_TOTAL_RETURN\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CUSTOMER_TOTAL_RETURN\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.367253,
                    "execution_time": 0.198852,
                    "compile_time": 0.000265,
                    "planning_time": 0.002868,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.436378,
                    "execution_time": 0.204801,
                    "compile_time": 0.000244,
                    "planning_time": 0.058771,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT AVG ( \"SPEQLITE_TEMP_TABLE_6\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.068762,
                    "execution_time": 0.038257,
                    "compile_time": 0.000327,
                    "planning_time": 0.003412,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.1254,
                    "execution_time": 0.0381,
                    "compile_time": 0.00029,
                    "planning_time": 0.060689,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.398428,
                    "execution_time": 1.269992,
                    "compile_time": 0.067105,
                    "planning_time": 0.034237,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.406728,
                    "execution_time": 1.692981,
                    "compile_time": 3.58017,
                    "planning_time": 0.102277,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017385,
                    "execution_time": 0.007357,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004066
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052869,
                    "execution_time": 0.006873,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038748
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" ON \"SPEQLITE_TEMP_TABLE_7\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR2\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.068514,
                    "execution_time": 0.039007,
                    "compile_time": 0.000314,
                    "planning_time": 0.003288,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.127224,
                    "execution_time": 0.037765,
                    "compile_time": 0.000308,
                    "planning_time": 0.06363,
                    "create_size": 4
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" = \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.245146,
                    "execution_time": 1.184426,
                    "compile_time": 0.000383,
                    "planning_time": 0.03333,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.314446,
                    "execution_time": 1.186815,
                    "compile_time": 0.000392,
                    "planning_time": 0.099619,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016364,
                    "execution_time": 0.006657,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.004014
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.051343,
                    "execution_time": 0.006879,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.0388
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"CTR_STORE_SK\" AS \"CTR_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"CTR_TOTAL_RETURN\" AS \"CTR_TOTAL_RETURN\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.416807,
                    "execution_time": 0.197112,
                    "compile_time": 0.000253,
                    "planning_time": 0.002926,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.472003,
                    "execution_time": 0.195592,
                    "compile_time": 0.000285,
                    "planning_time": 0.060859,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.069378,
                    "execution_time": 0.04135,
                    "compile_time": 0.000259,
                    "planning_time": 0.003625,
                    "create_size": 195
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.155386,
                    "execution_time": 0.04361,
                    "compile_time": 0.000268,
                    "planning_time": 0.08421,
                    "create_size": 195
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" CROSS JOIN \"STORE\" AS \"STORE\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" LIMIT 21",
                "preview": "\n/*       c_customer_id\n0   AAAAAAAAKMAAAAAA\n1   AAAAAAAAKMAAAAAA\n2   AAAAAAAAKMAAAAAA\n3   AAAAAAAAKMAAAAAA\n4   AAAAAAAAKMAAAAAA\n5   AAAAAAAAKMAAAAAA\n6   AAAAAAAAKMAAAAAA\n7   AAAAAAAAKMAAAAAA\n8   AAAAAAAAKMAAAAAA\n9   AAAAAAAAKMAAAAAA\n10  AAAAAAAAKMAAAAAA\n11  AAAAAAAAKMAAAAAA\n12  AAAAAAAAKMAAAAAA\n13  AAAAAAAAKMAAAAAA\n14  AAAAAAAAKMAAAAAA\n15  AAAAAAAAKMAAAAAA\n16  AAAAAAAAKMAAAAAA\n17  AAAAAAAAKMAAAAAA\n18  AAAAAAAAKMAAAAAA\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.520192,
                    "execution_time": 0.472129,
                    "compile_time": 0.000202,
                    "planning_time": 0.036476
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.547377,
                    "execution_time": 0.435619,
                    "compile_time": 0.000211,
                    "planning_time": 0.097356
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
            }
        ],
        "preview": "\n/*       c_customer_id\n0   AAAAAAAAKMAAAAAA\n1   AAAAAAAAKMAAAAAA\n2   AAAAAAAAKMAAAAAA\n3   AAAAAAAAKMAAAAAA\n4   AAAAAAAAKMAAAAAA\n5   AAAAAAAAKMAAAAAA\n6   AAAAAAAAKMAAAAAA\n7   AAAAAAAAKMAAAAAA\n8   AAAAAAAAKMAAAAAA\n9   AAAAAAAAKMAAAAAA\n10  AAAAAAAAKMAAAAAA\n11  AAAAAAAAKMAAAAAA\n12  AAAAAAAAKMAAAAAA\n13  AAAAAAAAKMAAAAAA\n14  AAAAAAAAKMAAAAAA\n15  AAAAAAAAKMAAAAAA\n16  AAAAAAAAKMAAAAAA\n17  AAAAAAAAKMAAAAAA\n18  AAAAAAAAKMAAAAAA\n...*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'VT'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.10527,
                    "execution_time": 0.041094,
                    "compile_time": 0.00036,
                    "planning_time": 0.037137,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.349331,
                    "execution_time": 0.199513,
                    "compile_time": 0.000395,
                    "planning_time": 0.119042,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017258,
                    "execution_time": 0.007397,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003947
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052328,
                    "execution_time": 0.007501,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.038993
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"CTR1\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ON \"SPEQLITE_TEMP_TABLE_12\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"SPEQLITE_TEMP_TABLE_12\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'VT'\nand ctr1.ctr_customer_sk = c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.071057,
                    "execution_time": 0.042556,
                    "compile_time": 0.00027,
                    "planning_time": 0.003821,
                    "create_size": 195
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.128812,
                    "execution_time": 0.041596,
                    "compile_time": 0.000275,
                    "planning_time": 0.061332,
                    "create_size": 195
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"SPEQLITE_TEMP_TABLE_14\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.103134,
                    "execution_time": 0.037956,
                    "compile_time": 0.000386,
                    "planning_time": 0.036213,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.397036,
                    "execution_time": 0.261021,
                    "compile_time": 0.00041,
                    "planning_time": 0.104819,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017605,
                    "execution_time": 0.007523,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004152
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052498,
                    "execution_time": 0.007518,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.039147
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"SPEQLITE_TEMP_TABLE_14\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'VT'\nand ctr1.ctr_customer_sk = c_customer_sk\norder by c_customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ORDER BY \"C_CUSTOMER_ID\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017521,
                    "execution_time": 0.007671,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.004152
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05522,
                    "execution_time": 0.00852,
                    "compile_time": 7.1e-05,
                    "planning_time": 0.039326
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"SPEQLITE_TEMP_TABLE_14\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/"
    },
    {
        "input": "-- start template query1.tpl query 12 in stream 0\nwith /* TPC-DS query1.tpl 0.12 */ customer_total_return as\n(select sr_customer_sk as ctr_customer_sk\n,sr_store_sk as ctr_store_sk\n,sum(SR_RETURN_AMT_INC_TAX) as ctr_total_return\nfrom store_returns\n,date_dim\nwhere sr_returned_date_sk = d_date_sk\nand d_year =1999\ngroup by sr_customer_sk\n,sr_store_sk)\n select  c_customer_id\nfrom customer_total_return ctr1\n,store\n,customer\nwhere ctr1.ctr_total_return > (select avg(ctr_total_return)*1.2\nfrom customer_total_return ctr2\nwhere ctr1.ctr_store_sk = ctr2.ctr_store_sk)\nand s_store_sk = ctr1.ctr_store_sk\nand s_state = 'VT'\nand ctr1.ctr_customer_sk = c_customer_sk\norder by c_customer_id\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_TOTAL_RETURN\" AS ( SELECT \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" AS \"CTR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"CTR_STORE_SK\" , SUM ( \"STORE_RETURNS\".\"SR_RETURN_AMT_INC_TAX\" ) AS \"CTR_TOTAL_RETURN\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 GROUP BY \"STORE_RETURNS\".\"SR_CUSTOMER_SK\" , \"STORE_RETURNS\".\"SR_STORE_SK\" ) , \"_U_0\" AS ( SELECT AVG ( \"CTR2\".\"CTR_TOTAL_RETURN\" ) * 1.2 AS \"_COL_0\" , \"CTR2\".\"CTR_STORE_SK\" AS \"_U_1\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR2\" GROUP BY \"CTR2\".\"CTR_STORE_SK\" ) SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"CUSTOMER_TOTAL_RETURN\" AS \"CTR1\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"_U_0\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ORDER BY \"C_CUSTOMER_ID\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017726,
                    "execution_time": 0.007832,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.004242
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.017774,
                    "execution_time": 0.007789,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.004354
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CTR1\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" ON \"SPEQLITE_TEMP_TABLE_14\".\"_U_1\" = \"CTR1\".\"CTR_STORE_SK\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CTR1\".\"CTR_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" JOIN \"STORE\" AS \"STORE\" ON \"CTR1\".\"CTR_STORE_SK\" = \"STORE\".\"S_STORE_SK\" AND \"STORE\".\"S_STATE\" = 'VT' WHERE \"SPEQLITE_TEMP_TABLE_14\".\"_COL_0\" < \"CTR1\".\"CTR_TOTAL_RETURN\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" ORDER BY \"C_CUSTOMER_ID\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_customer_id]\nIndex: []*/"
    }
]