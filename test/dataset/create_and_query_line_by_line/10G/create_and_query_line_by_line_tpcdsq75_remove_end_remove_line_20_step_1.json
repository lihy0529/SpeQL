[
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\nSELECT * FROM all_sales /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"ALL_SALES\".\"D_YEAR\" AS \"D_YEAR\" , \"ALL_SALES\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ALL_SALES\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ALL_SALES\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ALL_SALES\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"ALL_SALES\".\"SALES_CNT\" AS \"SALES_CNT\" , \"ALL_SALES\".\"SALES_AMT\" AS \"SALES_AMT\" FROM \"ALL_SALES\" AS \"ALL_SALES\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.11215,
                    "execution_time": 0.041367,
                    "compile_time": 0.00027,
                    "planning_time": 0.024608,
                    "create_size": 480
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.171399,
                    "execution_time": 0.042939,
                    "compile_time": 0.000239,
                    "planning_time": 0.086779,
                    "create_size": 480
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.128841,
                    "execution_time": 0.063486,
                    "compile_time": 0.00026,
                    "planning_time": 0.025691,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.211298,
                    "execution_time": 0.086788,
                    "compile_time": 0.00026,
                    "planning_time": 0.087618,
                    "create_size": 1152
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.555718,
                    "execution_time": 1.055313,
                    "compile_time": 0.001141,
                    "planning_time": 0.096877,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.909479,
                    "execution_time": 1.262208,
                    "compile_time": 0.006759,
                    "planning_time": 0.234122,
                    "create_size": 1280
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SPEQLITE_TEMP_TABLE_3\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.156455,
                    "execution_time": 0.085545,
                    "compile_time": 0.000316,
                    "planning_time": 0.005578,
                    "create_size": 330
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.223569,
                    "execution_time": 0.085817,
                    "compile_time": 0.004362,
                    "planning_time": 0.064456,
                    "create_size": 330
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SALES_CNT\" AS \"SALES_CNT\" , \"SPEQLITE_TEMP_TABLE_4\".\"SALES_AMT\" AS \"SALES_AMT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*    d_year  i_brand_id  i_class_id  i_category_id  i_manufact_id  sales_cnt   sales_amt\n0     2001     7015007          15              4            206       7525   322153.55\n1     2001     4004002           4              4            118      17718   829398.12\n2     2001     4001002           1              4            133       8126   370660.38\n3     2001     4003002           3              4             76      10093   436251.06\n4     2001     4004002          11              4            938       8534   359010.62\n5     2001     5002001           2              4            407       9462   395970.30\n6     2001     9006005           3              4             38      10208   468497.93\n7     2001     1001001           4              4            837       8885   439866.24\n8     2001     5003001           3              4            202       9501   396995.57\n9     2001     2002001           2              4            420       8100   367193.62\n10    2001     4004002           4              4            162      17044   765905.30\n11    2001     4004002           4              4            669       7608   359827.74\n12    2001     4001001           3              4            231       8049   347454.79\n13    2001     4003002          14              4            302       9196   377689.25\n14    2001     4004002           4              4            834       7354   334031.37\n15    2001     4004002           4              4            313      17546   774391.57\n16    2001     4001002           1              4            647       9893   388449.16\n17    2001     4001001           1              4            330       8955   414888.39\n18    1999     4001002           1              4            205       8710   369751.89\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017643,
                    "execution_time": 0.007179,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.004112
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.277376,
                    "execution_time": 0.008281,
                    "compile_time": 0.220884,
                    "planning_time": 0.040042
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SALES_CNT\" AS \"SALES_CNT\" , \"SPEQLITE_TEMP_TABLE_4\".\"SALES_AMT\" AS \"SALES_AMT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"SALES_CNT\" AS \"SALES_CNT\" , \"SPEQLITE_TEMP_TABLE_4\".\"SALES_AMT\" AS \"SALES_AMT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*    d_year  i_brand_id  i_class_id  i_category_id  i_manufact_id  sales_cnt   sales_amt\n0     2001     7015007          15              4            206       7525   322153.55\n1     2001     4004002           4              4            118      17718   829398.12\n2     2001     4001002           1              4            133       8126   370660.38\n3     2001     4003002           3              4             76      10093   436251.06\n4     2001     4004002          11              4            938       8534   359010.62\n5     2001     5002001           2              4            407       9462   395970.30\n6     2001     9006005           3              4             38      10208   468497.93\n7     2001     1001001           4              4            837       8885   439866.24\n8     2001     5003001           3              4            202       9501   396995.57\n9     2001     2002001           2              4            420       8100   367193.62\n10    2001     4004002           4              4            162      17044   765905.30\n11    2001     4004002           4              4            669       7608   359827.74\n12    2001     4001001           3              4            231       8049   347454.79\n13    2001     4003002          14              4            302       9196   377689.25\n14    2001     4004002           4              4            834       7354   334031.37\n15    2001     4004002           4              4            313      17546   774391.57\n16    2001     4001002           1              4            647       9893   388449.16\n17    2001     4001001           1              4            330       8955   414888.39\n18    1999     4001002           1              4            205       8710   369751.89\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON item.i_item_sk=catalog_sales.cs_item_sk\n                          JOIN date_dim ON date_dim.d_date_sk=catalog_sales.cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (catalog_sales.cs_order_number=catalog_returns.cr_order_number \n                                                    AND catalog_sales.cs_item_sk=catalog_returns.cr_item_sk)\n       WHERE item.i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON item.i_item_sk=store_sales.ss_item_sk\n                        JOIN date_dim ON date_dim.d_date_sk=store_sales.ss_sold_date_sk\n                        LEFT JOIN store_returns ON (store_sales.ss_ticket_number=store_returns.sr_ticket_number \n                                                AND store_sales.ss_item_sk=store_returns.sr_item_sk)\n       WHERE item.i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON item.i_item_sk=web_sales.ws_item_sk\n                      JOIN date_dim ON date_dim.d_date_sk=web_sales.ws_sold_date_sk\n                      LEFT JOIN web_returns ON (web_sales.ws_order_number=web_returns.wr_order_number \n                                            AND web_sales.ws_item_sk=web_returns.wr_item_sk)\n       WHERE item.i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  all_sales.d_year AS prev_year\n/*CURSOR_IDENTIFIER*/ FROM all_sales",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"ALL_SALES\".\"D_YEAR\" AS \"PREV_YEAR\" FROM \"ALL_SALES\" AS \"ALL_SALES\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.576608,
                    "execution_time": 1.079205,
                    "compile_time": 0.001055,
                    "planning_time": 0.096246,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.709746,
                    "execution_time": 1.076388,
                    "compile_time": 0.004736,
                    "planning_time": 0.224533,
                    "create_size": 1280
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" AS \"D_YEAR\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" GROUP BY \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.101644,
                    "execution_time": 0.066227,
                    "compile_time": 0.000317,
                    "planning_time": 0.004353,
                    "create_size": 132
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.165206,
                    "execution_time": 0.064576,
                    "compile_time": 0.002223,
                    "planning_time": 0.062284,
                    "create_size": 132
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"PREV_YEAR\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*    prev_year\n0        2001\n1        2001\n2        2001\n3        2001\n4        2001\n5        2001\n6        2001\n7        1998\n8        1998\n9        1998\n10       1998\n11       1998\n12       1998\n13       1998\n14       1998\n15       1999\n16       1999\n17       1999\n18       1999\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016295,
                    "execution_time": 0.006953,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003301
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054987,
                    "execution_time": 0.007536,
                    "compile_time": 4.1e-05,
                    "planning_time": 0.038507
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"PREV_YEAR\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"D_YEAR\" AS \"PREV_YEAR\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*    prev_year\n0        2001\n1        2001\n2        2001\n3        2001\n4        2001\n5        2001\n6        2001\n7        1998\n8        1998\n9        1998\n10       1998\n11       1998\n12       1998\n13       1998\n14       1998\n15       1999\n16       1999\n17       1999\n18       1999\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\nSELECT prev_yr.d_year AS prev_year\n      ,curr_yr.d_year AS year\n/*CURSOR_IDENTIFIER*/\nFROM all_sales prev_yr\n     JOIN all_sales curr_yr ON prev_yr.i_brand_id = curr_yr.i_brand_id\n                              AND prev_yr.i_class_id = curr_yr.i_class_id\n                              AND prev_yr.i_category_id = curr_yr.i_category_id\n                              AND prev_yr.i_manufact_id = curr_yr.i_manufact_id\n                              AND prev_yr.d_year = curr_yr.d_year - 1",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" FROM \"ALL_SALES\" AS \"PREV_YR\" JOIN \"ALL_SALES\" AS \"CURR_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = \"CURR_YR\".\"D_YEAR\" - 1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" GROUP BY \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.134521,
                    "execution_time": 0.070946,
                    "compile_time": 0.000335,
                    "planning_time": 0.004854,
                    "create_size": 264
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.183688,
                    "execution_time": 0.069205,
                    "compile_time": 0.003301,
                    "planning_time": 0.061918,
                    "create_size": 264
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"PREV_YR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"CURR_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = \"CURR_YR\".\"D_YEAR\" - 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.128374,
                    "execution_time": 0.053491,
                    "compile_time": 0.032551,
                    "planning_time": 0.007265,
                    "create_size": 110
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.471732,
                    "execution_time": 0.054619,
                    "compile_time": 3.308593,
                    "planning_time": 0.064767,
                    "create_size": 115
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_8\".\"YEAR\" AS \"YEAR\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" LIMIT 21",
                "preview": "\n/*    prev_year  year\n0        1999  2000\n1        1999  2000\n2        1999  2000\n3        1999  2000\n4        1999  2000\n5        1999  2000\n6        1999  2000\n7        1999  2000\n8        1999  2000\n9        2001  2002\n10       2001  2002\n11       2001  2002\n12       2001  2002\n13       2001  2002\n14       2001  2002\n15       2001  2002\n16       2001  2002\n17       1999  2000\n18       2000  2001\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016084,
                    "execution_time": 0.006753,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003318
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057421,
                    "execution_time": 0.00836,
                    "compile_time": 7.6e-05,
                    "planning_time": 0.038775
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"PREV_YR\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"CURR_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = \"CURR_YR\".\"D_YEAR\" - 1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_8\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_8\".\"YEAR\" AS \"YEAR\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\""
            }
        ],
        "preview": "\n/*    prev_year  year\n0        1999  2000\n1        1999  2000\n2        1999  2000\n3        1999  2000\n4        1999  2000\n5        1999  2000\n6        1999  2000\n7        1999  2000\n8        1999  2000\n9        2001  2002\n10       2001  2002\n11       2001  2002\n12       2001  2002\n13       2001  2002\n14       2001  2002\n15       2001  2002\n16       2001  2002\n17       1999  2000\n18       2000  2001\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\nSELECT a1.d_year - 1 AS prev_year\n      ,a1.d_year AS year\n      ,a1.i_brand_id\n/*CURSOR_IDENTIFIER*/\nFROM all_sales a1\nJOIN all_sales a2 ON a1.i_brand_id = a2.i_brand_id\n                 AND a1.i_class_id = a2.i_class_id\n                 AND a1.i_category_id = a2.i_category_id\n                 AND a1.i_manufact_id = a2.i_manufact_id\n                 AND a1.d_year = a2.d_year - 1;",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"A1\".\"D_YEAR\" - 1 AS \"PREV_YEAR\" , \"A1\".\"D_YEAR\" AS \"YEAR\" , \"A1\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" FROM \"ALL_SALES\" AS \"A1\" JOIN \"ALL_SALES\" AS \"A2\" ON \"A1\".\"D_YEAR\" = \"A2\".\"D_YEAR\" - 1 AND \"A1\".\"I_BRAND_ID\" = \"A2\".\"I_BRAND_ID\" AND \"A1\".\"I_CATEGORY_ID\" = \"A2\".\"I_CATEGORY_ID\" AND \"A1\".\"I_CLASS_ID\" = \"A2\".\"I_CLASS_ID\" AND \"A1\".\"I_MANUFACT_ID\" = \"A2\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"A1\".\"D_YEAR\" - 1 AS \"PREV_YEAR\" , \"A1\".\"D_YEAR\" AS \"YEAR\" , \"A1\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"A1\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"A2\" ON \"A1\".\"D_YEAR\" = \"A2\".\"D_YEAR\" - 1 AND \"A1\".\"I_BRAND_ID\" = \"A2\".\"I_BRAND_ID\" AND \"A1\".\"I_CATEGORY_ID\" = \"A2\".\"I_CATEGORY_ID\" AND \"A1\".\"I_CLASS_ID\" = \"A2\".\"I_CLASS_ID\" AND \"A1\".\"I_MANUFACT_ID\" = \"A2\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.138146,
                    "execution_time": 0.054755,
                    "compile_time": 0.037551,
                    "planning_time": 0.00719,
                    "create_size": 156
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.46099,
                    "execution_time": 0.053782,
                    "compile_time": 3.30038,
                    "planning_time": 0.06506,
                    "create_size": 150
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id\n0        2000  2001     4003002\n1        2000  2001     3001001\n2        2000  2001     4003002\n3        1997  1998     4002001\n4        1997  1998     4002001\n5        1997  1998     4002001\n6        1997  1998     4001001\n7        1997  1998     4004001\n8        1997  1998     4002002\n9        1997  1998     4002001\n10       1998  1999     4001001\n11       1998  1999     4001001\n12       1998  1999     4002001\n13       1998  1999     4002002\n14       1998  1999     4004001\n15       2001  2002     4003002\n16       2001  2002     4002002\n17       2001  2002     4001002\n18       2001  2002     4001001\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016713,
                    "execution_time": 0.007035,
                    "compile_time": 5e-05,
                    "planning_time": 0.003493
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.198906,
                    "execution_time": 0.007257,
                    "compile_time": 0.143538,
                    "planning_time": 0.038778
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"A1\".\"D_YEAR\" - 1 AS \"PREV_YEAR\" , \"A1\".\"D_YEAR\" AS \"YEAR\" , \"A1\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"A1\" JOIN \"SPEQLITE_TEMP_TABLE_7\" AS \"A2\" ON \"A1\".\"D_YEAR\" = \"A2\".\"D_YEAR\" - 1 AND \"A1\".\"I_BRAND_ID\" = \"A2\".\"I_BRAND_ID\" AND \"A1\".\"I_CATEGORY_ID\" = \"A2\".\"I_CATEGORY_ID\" AND \"A1\".\"I_CLASS_ID\" = \"A2\".\"I_CLASS_ID\" AND \"A1\".\"I_MANUFACT_ID\" = \"A2\".\"I_MANUFACT_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_9\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id\n0        2000  2001     4003002\n1        2000  2001     3001001\n2        2000  2001     4003002\n3        1997  1998     4002001\n4        1997  1998     4002001\n5        1997  1998     4002001\n6        1997  1998     4001001\n7        1997  1998     4004001\n8        1997  1998     4002002\n9        1997  1998     4002001\n10       1998  1999     4001001\n11       1998  1999     4001001\n12       1998  1999     4002001\n13       1998  1999     4002002\n14       1998  1999     4004001\n15       2001  2002     4003002\n16       2001  2002     4002002\n17       2001  2002     4001002\n18       2001  2002     4001001\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  NULL AS prev_year\n                          ,NULL AS year\n                          ,NULL AS i_brand_id\n                          ,NULL AS i_class_id\n                          ,NULL AS i_category_id\n                          ,NULL AS i_manufact_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) SELECT NULL AS \"PREV_YEAR\" , NULL AS \"YEAR\" , NULL AS \"I_BRAND_ID\" , NULL AS \"I_CLASS_ID\" , NULL AS \"I_CATEGORY_ID\" , NULL AS \"I_MANUFACT_ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT NULL AS \"PREV_YEAR\" , NULL AS \"YEAR\" , NULL AS \"I_BRAND_ID\" , NULL AS \"I_CLASS_ID\" , NULL AS \"I_CATEGORY_ID\" , NULL AS \"I_MANUFACT_ID\" LIMIT 21",
                "preview": "\n/*  prev_year  year i_brand_id i_class_id i_category_id i_manufact_id\n0      None  None       None       None          None          None*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.774765,
                    "execution_time": 0.50196,
                    "compile_time": 0.000381,
                    "planning_time": 0.075504
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.784025,
                    "execution_time": 0.511833,
                    "compile_time": 0.000375,
                    "planning_time": 0.074867
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT NULL AS \"PREV_YEAR\" , NULL AS \"YEAR\" , NULL AS \"I_BRAND_ID\" , NULL AS \"I_CLASS_ID\" , NULL AS \"I_CATEGORY_ID\" , NULL AS \"I_MANUFACT_ID\"",
                "rewrite": "SELECT NULL AS \"PREV_YEAR\" , NULL AS \"YEAR\" , NULL AS \"I_BRAND_ID\" , NULL AS \"I_CLASS_ID\" , NULL AS \"I_CATEGORY_ID\" , NULL AS \"I_MANUFACT_ID\""
            }
        ],
        "preview": "\n/*  prev_year  year i_brand_id i_class_id i_category_id i_manufact_id\n0      None  None       None       None          None          None*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category_id IN (SELECT I_CATEGORY_ID FROM item WHERE I_CATEGORY='Shoes')\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category_id IN (SELECT I_CATEGORY_ID FROM item WHERE I_CATEGORY='Shoes')\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category_id IN (SELECT I_CATEGORY_ID FROM item WHERE I_CATEGORY='Shoes')) sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  lag(d_year, 1) over (PARTITION BY i_brand_id, i_class_id, i_category_id, i_manufact_id ORDER BY d_year) AS prev_year\n                          ,d_year AS year\n                          ,i_brand_id\n                          ,i_class_id\n                          ,i_category_id\n                          ,i_manufact_id\n                          ,SUM(sales_cnt) AS prev_yr_cnt\nFROM all_sales\nGROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' GROUP BY \"ITEM\".\"I_CATEGORY_ID\" ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" WHERE NOT \"_U_0\".\"I_CATEGORY_ID\" IS NULL UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" LEFT JOIN \"_U_0\" AS \"_U_1\" ON \"_U_1\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" WHERE NOT \"_U_1\".\"I_CATEGORY_ID\" IS NULL UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" LEFT JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" WHERE NOT \"_U_2\".\"I_CATEGORY_ID\" IS NULL ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT LAG ( \"ALL_SALES\".\"D_YEAR\" , 1 ) OVER ( PARTITION BY \"ALL_SALES\".\"I_BRAND_ID\" , \"ALL_SALES\".\"I_CLASS_ID\" , \"ALL_SALES\".\"I_CATEGORY_ID\" , \"ALL_SALES\".\"I_MANUFACT_ID\" ORDER BY \"ALL_SALES\".\"D_YEAR\" NULLS LAST ) AS \"PREV_YEAR\" , \"ALL_SALES\".\"D_YEAR\" AS \"YEAR\" , \"ALL_SALES\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ALL_SALES\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ALL_SALES\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ALL_SALES\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"ALL_SALES\".\"SALES_CNT\" ) AS \"PREV_YR_CNT\" FROM \"ALL_SALES\" AS \"ALL_SALES\" GROUP BY \"ALL_SALES\".\"D_YEAR\" , \"ALL_SALES\".\"I_BRAND_ID\" , \"ALL_SALES\".\"I_CLASS_ID\" , \"ALL_SALES\".\"I_CATEGORY_ID\" , \"ALL_SALES\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.194697,
                    "execution_time": 0.051449,
                    "compile_time": 0.00028,
                    "planning_time": 0.025438,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.269229,
                    "execution_time": 0.052298,
                    "compile_time": 0.000274,
                    "planning_time": 0.093583,
                    "create_size": 1024
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' GROUP BY \"ITEM\".\"I_CATEGORY_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.085912,
                    "execution_time": 0.034697,
                    "compile_time": 0.000274,
                    "planning_time": 0.025154,
                    "create_size": 8
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.156741,
                    "execution_time": 0.035669,
                    "compile_time": 0.000281,
                    "planning_time": 0.091131,
                    "create_size": 8
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ON \"SPEQLITE_TEMP_TABLE_11\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" WHERE NOT \"SPEQLITE_TEMP_TABLE_11\".\"I_CATEGORY_ID\" IS NULL UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"_U_1\" ON \"_U_1\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" WHERE NOT \"_U_1\".\"I_CATEGORY_ID\" IS NULL UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_1\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" LEFT JOIN \"SPEQLITE_TEMP_TABLE_11\" AS \"_U_2\" ON \"_U_2\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" WHERE NOT \"_U_2\".\"I_CATEGORY_ID\" IS NULL",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.656216,
                    "execution_time": 1.111149,
                    "compile_time": 0.001334,
                    "planning_time": 0.122913,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.776157,
                    "execution_time": 1.103605,
                    "compile_time": 0.003572,
                    "planning_time": 0.246963,
                    "create_size": 1280
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"SPEQLITE_TEMP_TABLE_12\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_12\".\"SALES_CNT\" ) AS \"SALES_CNT\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" GROUP BY \"SPEQLITE_TEMP_TABLE_12\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.327957,
                    "execution_time": 0.176467,
                    "compile_time": 0.095196,
                    "planning_time": 0.005118,
                    "create_size": 297
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.112156,
                    "execution_time": 0.176474,
                    "compile_time": 3.598989,
                    "planning_time": 0.274031,
                    "create_size": 297
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT LAG ( \"SPEQLITE_TEMP_TABLE_13\".\"D_YEAR\" , 1 ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_13\".\"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_MANUFACT_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_13\".\"D_YEAR\" NULLS LAST ) AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_13\".\"D_YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_13\".\"SALES_CNT\" ) AS \"PREV_YR_CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" GROUP BY \"SPEQLITE_TEMP_TABLE_13\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.259436,
                    "execution_time": 0.062316,
                    "compile_time": 0.145312,
                    "planning_time": 0.005857,
                    "create_size": 330
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.905546,
                    "execution_time": 0.065436,
                    "compile_time": 6.720884,
                    "planning_time": 0.064626,
                    "create_size": 330
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt\n0      2002.0  2003     1001001           1              4             43           23\n1      2001.0  2002     1001001           1              4             43         8114\n2         NaN  2001     1001001           1              4             43         7756\n3      2000.0  2001     1001001           1              4            110         8755\n4         NaN  2000     1001001           1              4            110         9766\n5      2002.0  2003     1001001           1              4            251           93\n6      2001.0  2002     1001001           1              4            251         9544\n7         NaN  2001     1001001           1              4            251         9128\n8      2002.0  2003     1001001           1              4            418          150\n9      2001.0  2002     1001001           1              4            418         7995\n10        NaN  2001     1001001           1              4            418         9586\n11     2001.0  2002     1002001           2              4            658         8562\n12        NaN  2001     1002001           2              4            658         9237\n13     2000.0  2001     1003001           1              4             76         8196\n14        NaN  2000     1003001           1              4             76         9545\n15     2002.0  2003     1003001           1              4            161           99\n16     2001.0  2002     1003001           1              4            161         8821\n17        NaN  2001     1003001           1              4            161         9539\n18     2002.0  2003     1003001           2              4            274           19\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.040911,
                    "execution_time": 0.013856,
                    "compile_time": 0.015888,
                    "planning_time": 0.004254
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.132067,
                    "execution_time": 0.007981,
                    "compile_time": 3.073975,
                    "planning_time": 0.039259
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT LAG ( \"SPEQLITE_TEMP_TABLE_13\".\"D_YEAR\" , 1 ) OVER ( PARTITION BY \"SPEQLITE_TEMP_TABLE_13\".\"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_MANUFACT_ID\" ORDER BY \"SPEQLITE_TEMP_TABLE_13\".\"D_YEAR\" NULLS LAST ) AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_13\".\"D_YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_13\".\"SALES_CNT\" ) AS \"PREV_YR_CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" GROUP BY \"SPEQLITE_TEMP_TABLE_13\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_13\".\"I_MANUFACT_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_14\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_14\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\""
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt\n0      2002.0  2003     1001001           1              4             43           23\n1      2001.0  2002     1001001           1              4             43         8114\n2         NaN  2001     1001001           1              4             43         7756\n3      2000.0  2001     1001001           1              4            110         8755\n4         NaN  2000     1001001           1              4            110         9766\n5      2002.0  2003     1001001           1              4            251           93\n6      2001.0  2002     1001001           1              4            251         9544\n7         NaN  2001     1001001           1              4            251         9128\n8      2002.0  2003     1001001           1              4            418          150\n9      2001.0  2002     1001001           1              4            418         7995\n10        NaN  2001     1001001           1              4            418         9586\n11     2001.0  2002     1002001           2              4            658         8562\n12        NaN  2001     1002001           2              4            658         9237\n13     2000.0  2001     1003001           1              4             76         8196\n14        NaN  2000     1003001           1              4             76         9545\n15     2002.0  2003     1003001           1              4            161           99\n16     2001.0  2002     1003001           1              4            161         8821\n17        NaN  2001     1003001           1              4            161         9539\n18     2002.0  2003     1003001           2              4            274           19\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category_id = (SELECT I_CATEGORY_ID FROM item WHERE I_CATEGORY='Shoes' LIMIT 1)\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category_id = (SELECT I_CATEGORY_ID FROM item WHERE I_CATEGORY='Shoes' LIMIT 1)\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category_id = (SELECT I_CATEGORY_ID FROM item WHERE I_CATEGORY='Shoes' LIMIT 1)) sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id),\n prev_yr AS (\n   SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, sales_cnt\n   FROM all_sales \n   WHERE d_year = (SELECT MAX(d_year) FROM all_sales) - 1\n ), \n curr_yr AS (\n   SELECT d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id, sales_cnt\n   FROM all_sales \n   WHERE d_year = (SELECT MAX(d_year) FROM all_sales)\n )\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n/*CURSOR_IDENTIFIER*/ \nFROM prev_yr \nJOIN curr_yr \nON prev_yr.i_brand_id = curr_yr.i_brand_id \nAND prev_yr.i_class_id = curr_yr.i_class_id \nAND prev_yr.i_category_id = curr_yr.i_category_id \nAND prev_yr.i_manufact_id = curr_yr.i_manufact_id",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" ) , \"_U_0\" AS ( SELECT \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' LIMIT 1 ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" JOIN \"_U_0\" AS \"_U_1\" ON \"_U_1\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" JOIN \"_U_0\" AS \"_U_2\" ON \"_U_2\".\"I_CATEGORY_ID\" = \"ITEM\".\"I_CATEGORY_ID\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) , \"_U_3\" AS ( SELECT MAX ( \"ALL_SALES\".\"D_YEAR\" ) AS \"_COL_0\" FROM \"ALL_SALES\" AS \"ALL_SALES\" ) SELECT \"ALL_SALES\".\"D_YEAR\" AS \"PREV_YEAR\" , \"ALL_SALES_2\".\"D_YEAR\" AS \"YEAR\" , \"ALL_SALES_2\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ALL_SALES_2\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ALL_SALES_2\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ALL_SALES_2\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"ALL_SALES\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"ALL_SALES_2\".\"SALES_CNT\" AS \"CURR_YR_CNT\" FROM \"ALL_SALES\" AS \"ALL_SALES\" JOIN \"_U_3\" AS \"_U_3\" ON \"ALL_SALES\".\"D_YEAR\" = \"_U_3\".\"_COL_0\" - 1 JOIN \"ALL_SALES\" AS \"ALL_SALES_2\" ON \"ALL_SALES\".\"I_BRAND_ID\" = \"ALL_SALES_2\".\"I_BRAND_ID\" AND \"ALL_SALES\".\"I_CATEGORY_ID\" = \"ALL_SALES_2\".\"I_CATEGORY_ID\" AND \"ALL_SALES\".\"I_CLASS_ID\" = \"ALL_SALES_2\".\"I_CLASS_ID\" AND \"ALL_SALES\".\"I_MANUFACT_ID\" = \"ALL_SALES_2\".\"I_MANUFACT_ID\" JOIN \"_U_3\" AS \"_U_4\" ON \"_U_4\".\"_COL_0\" = \"ALL_SALES_2\".\"D_YEAR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"SPEQLITE_TEMP_TABLE_11\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.063635,
                    "execution_time": 0.035966,
                    "compile_time": 0.000262,
                    "planning_time": 0.002968,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.123232,
                    "execution_time": 0.035899,
                    "compile_time": 0.000253,
                    "planning_time": 0.060988,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "WITH ALL_SALES AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SUM ( SALES_CNT ) AS SALES_CNT , SUM ( SALES_AMT ) AS SALES_AMT FROM ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , CS_QUANTITY - COALESCE ( CR_RETURN_QUANTITY , 0 ) AS SALES_CNT , CS_EXT_SALES_PRICE - COALESCE ( CR_RETURN_AMOUNT , 0.0 ) AS SALES_AMT FROM CATALOG_SALES JOIN ITEM ON I_ITEM_SK = CS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = CS_SOLD_DATE_SK LEFT JOIN CATALOG_RETURNS ON ( CS_ORDER_NUMBER = CR_ORDER_NUMBER AND CS_ITEM_SK = CR_ITEM_SK ) WHERE I_CATEGORY_ID = ( SELECT I_CATEGORY_ID FROM ITEM WHERE I_CATEGORY = 'Shoes' LIMIT 1 ) UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SS_QUANTITY - COALESCE ( SR_RETURN_QUANTITY , 0 ) AS SALES_CNT , SS_EXT_SALES_PRICE - COALESCE ( SR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM STORE_SALES JOIN ITEM ON I_ITEM_SK = SS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = SS_SOLD_DATE_SK LEFT JOIN STORE_RETURNS ON ( SS_TICKET_NUMBER = SR_TICKET_NUMBER AND SS_ITEM_SK = SR_ITEM_SK ) WHERE I_CATEGORY_ID = ( SELECT I_CATEGORY_ID FROM ITEM WHERE I_CATEGORY = 'Shoes' LIMIT 1 ) UNION SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , WS_QUANTITY - COALESCE ( WR_RETURN_QUANTITY , 0 ) AS SALES_CNT , WS_EXT_SALES_PRICE - COALESCE ( WR_RETURN_AMT , 0.0 ) AS SALES_AMT FROM WEB_SALES JOIN ITEM ON I_ITEM_SK = WS_ITEM_SK JOIN DATE_DIM ON D_DATE_SK = WS_SOLD_DATE_SK LEFT JOIN WEB_RETURNS ON ( WS_ORDER_NUMBER = WR_ORDER_NUMBER AND WS_ITEM_SK = WR_ITEM_SK ) WHERE I_CATEGORY_ID = ( SELECT I_CATEGORY_ID FROM ITEM WHERE I_CATEGORY = 'Shoes' LIMIT 1 ) ) AS SALES_DETAIL GROUP BY D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID ) , PREV_YR AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SALES_CNT FROM ALL_SALES WHERE D_YEAR = ( SELECT MAX ( D_YEAR ) FROM ALL_SALES ) - 1 ) , CURR_YR AS ( SELECT D_YEAR , I_BRAND_ID , I_CLASS_ID , I_CATEGORY_ID , I_MANUFACT_ID , SALES_CNT FROM ALL_SALES WHERE D_YEAR = ( SELECT MAX ( D_YEAR ) FROM ALL_SALES ) ) SELECT PREV_YR.D_YEAR AS PREV_YEAR , CURR_YR.D_YEAR AS YEAR , CURR_YR.I_BRAND_ID , CURR_YR.I_CLASS_ID , CURR_YR.I_CATEGORY_ID , CURR_YR.I_MANUFACT_ID , PREV_YR.SALES_CNT AS PREV_YR_CNT , CURR_YR.SALES_CNT AS CURR_YR_CNT FROM PREV_YR JOIN CURR_YR ON PREV_YR.I_BRAND_ID = CURR_YR.I_BRAND_ID AND PREV_YR.I_CLASS_ID = CURR_YR.I_CLASS_ID AND PREV_YR.I_CATEGORY_ID = CURR_YR.I_CATEGORY_ID AND PREV_YR.I_MANUFACT_ID = CURR_YR.I_MANUFACT_ID",
                "preview": "\n/*      prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt\n0          2002  2003     4001002           1              4            559         9017        273.0\n1          2002  2003     4003001           4              4            505        10101        172.0\n2          2002  2003     4004002           4              4            894        18405        118.0\n3          2002  2003     9013006           1              4            286        10981        256.0\n4          2002  2003     4001002           1              4              8         8783        107.0\n5          2002  2003     4003002           3              4            569        18028        146.0\n6          2002  2003     4002002           2              4            212        10225          1.0\n7          2002  2003     4003001           2              4            170         9661        127.0\n8          2002  2003     4003002           3              4            309        26882        339.0\n9          2002  2003     4003002           3              4             34        16169        607.0\n10         2002  2003     4003002           3              4            109         9797        196.0\n11         2002  2003     4004002           6              4            399         9235         48.0\n12         2002  2003     4001002           1              4            332        10364         92.0\n13         2002  2003     5004001           4              4            255         8536        108.0\n14         2002  2003     2003001           4              4            179         7913        252.0\n15         2002  2003     4004001           4              4            420         9806        261.0\n16         2002  2003     4002001           8              4             94        10298        177.0\n17         2002  2003     1004001           2              4            289        17973        246.0\n18         2002  2003     8006001           3              4             80         7732        151.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.585769,
                    "execution_time": 1.257898,
                    "compile_time": 0.002152,
                    "planning_time": 2.518222
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 2.69815,
                    "execution_time": 1.244795,
                    "compile_time": 0.015047,
                    "planning_time": 2.618631
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*      prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt\n0          2002  2003     4001002           1              4            559         9017        273.0\n1          2002  2003     4003001           4              4            505        10101        172.0\n2          2002  2003     4004002           4              4            894        18405        118.0\n3          2002  2003     9013006           1              4            286        10981        256.0\n4          2002  2003     4001002           1              4              8         8783        107.0\n5          2002  2003     4003002           3              4            569        18028        146.0\n6          2002  2003     4002002           2              4            212        10225          1.0\n7          2002  2003     4003001           2              4            170         9661        127.0\n8          2002  2003     4003002           3              4            309        26882        339.0\n9          2002  2003     4003002           3              4             34        16169        607.0\n10         2002  2003     4003002           3              4            109         9797        196.0\n11         2002  2003     4004002           6              4            399         9235         48.0\n12         2002  2003     4001002           1              4            332        10364         92.0\n13         2002  2003     5004001           4              4            255         8536        108.0\n14         2002  2003     2003001           4              4            179         7913        252.0\n15         2002  2003     4004001           4              4            420         9806        261.0\n16         2002  2003     4002001           8              4             94        10298        177.0\n17         2002  2003     1004001           2              4            289        17973        246.0\n18         2002  2003     8006001           3              4             80         7732        151.0\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" CROSS JOIN \"ALL_SALES\" AS \"PREV_YR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" AS \"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SPEQLITE_TEMP_TABLE_5\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SPEQLITE_TEMP_TABLE_5\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" GROUP BY \"SPEQLITE_TEMP_TABLE_5\".\"D_YEAR\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.157916,
                    "execution_time": 0.087047,
                    "compile_time": 0.000312,
                    "planning_time": 0.005473,
                    "create_size": 330
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.219989,
                    "execution_time": 0.087813,
                    "compile_time": 0.000309,
                    "planning_time": 0.066784,
                    "create_size": 330
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"CURR_YR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"CURR_YR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2001     3002001           2              4            278         8888         8604            -284         6747.72\n1        1999  2001     3002001           2              4            278         8433         8604             171        -5232.97\n2        1999  2001     3002001           2              4            278         8872         8604            -268        53721.32\n3        1999  2001     3002001           2              4            278        27148         8604          -18544      -735446.61\n4        1999  2001     3002001           2              4            278         9229         8604            -625        -7104.01\n5        1999  2001     3002001           2              4            278         9922         8604           -1318       -26102.81\n6        1999  2001     3002001           2              4            278        45022         8604          -36418     -1552636.13\n7        1999  2001     3002001           2              4            278        16628         8604           -8024      -308268.00\n8        2001  2001     3002001           2              4            278        17688         8604           -9084      -424614.96\n9        1998  2001     3002001           2              4            278        28497         8604          -19893      -790738.74\n10       1998  2001     3002001           2              4            278        18229         8604           -9625      -412910.01\n11       1998  2001     3002001           2              4            278        17488         8604           -8884      -314138.50\n12       1998  2001     3002001           2              4            278         9265         8604            -661       -36581.10\n13       1998  2001     3002001           2              4            278         7993         8604             611        27567.77\n14       1998  2001     3002001           2              4            278         9262         8604            -658       -13166.03\n15       1998  2001     3002001           2              4            278        27107         8604          -18503      -750818.39\n16       1998  2001     3002001           2              4            278         8679         8604             -75        -3801.44\n17       1998  2001     3002001           2              4            278        26518         8604          -17914      -762213.32\n18       2001  2001     3002001           2              4            278         8450         8604             154       -10901.41\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.030553,
                    "execution_time": 0.016026,
                    "compile_time": 9.7e-05,
                    "planning_time": 0.006526
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.072559,
                    "execution_time": 0.018071,
                    "compile_time": 0.001342,
                    "planning_time": 0.042055
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"CURR_YR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\"",
                "rewrite": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"CURR_YR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\""
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2001     3002001           2              4            278         8888         8604            -284         6747.72\n1        1999  2001     3002001           2              4            278         8433         8604             171        -5232.97\n2        1999  2001     3002001           2              4            278         8872         8604            -268        53721.32\n3        1999  2001     3002001           2              4            278        27148         8604          -18544      -735446.61\n4        1999  2001     3002001           2              4            278         9229         8604            -625        -7104.01\n5        1999  2001     3002001           2              4            278         9922         8604           -1318       -26102.81\n6        1999  2001     3002001           2              4            278        45022         8604          -36418     -1552636.13\n7        1999  2001     3002001           2              4            278        16628         8604           -8024      -308268.00\n8        2001  2001     3002001           2              4            278        17688         8604           -9084      -424614.96\n9        1998  2001     3002001           2              4            278        28497         8604          -19893      -790738.74\n10       1998  2001     3002001           2              4            278        18229         8604           -9625      -412910.01\n11       1998  2001     3002001           2              4            278        17488         8604           -8884      -314138.50\n12       1998  2001     3002001           2              4            278         9265         8604            -661       -36581.10\n13       1998  2001     3002001           2              4            278         7993         8604             611        27567.77\n14       1998  2001     3002001           2              4            278         9262         8604            -658       -13166.03\n15       1998  2001     3002001           2              4            278        27107         8604          -18503      -750818.39\n16       1998  2001     3002001           2              4            278         8679         8604             -75        -3801.44\n17       1998  2001     3002001           2              4            278        26518         8604          -17914      -762213.32\n18       2001  2001     3002001           2              4            278         8450         8604             154       -10901.41\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" AND \"PREV_YR\".\"I_BRAND_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" AND \"PREV_YR\".\"I_BRAND_ID\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        2001  1999     4001001           1              4            371         9049         8888            -161       -16908.07\n1        2001  1999     4001001           1              4            371         8478         8888             410       -40308.22\n2        2001  1999     4001001           1              4            371         8570         8888             318       -71696.89\n3        2001  1999     4001001           1              4            371         9147         8888            -259       -30776.75\n4        2001  1999     4001001           1              4            371         8299         8888             589         8509.53\n5        2001  1999     4001001           1              4            371         8462         8888             426          222.61\n6        2001  1999     4001001           1              4            371        19073         8888          -10185      -428789.78\n7        2001  1999     4001001           1              4            371        27440         8888          -18552      -818299.45\n8        2001  1999     4001001           1              4            371        28052         8888          -19164      -923037.27\n9        2001  1999     4001001           1              4            371         8487         8888             401        -4949.16\n10       1999  1999     4001001           1              4            371         8975         8888             -87        26279.88\n11       1999  1999     4001001           1              4            371        27442         8888          -18554      -727381.62\n12       1999  1999     4001001           1              4            371        29365         8888          -20477      -950636.11\n13       1999  1999     4001001           1              4            371         9201         8888            -313       -60896.34\n14       1999  1999     4001001           1              4            371        17495         8888           -8607      -417394.42\n15       1998  1999     4001001           1              4            371        18223         8888           -9335      -434052.89\n16       1998  1999     4001001           1              4            371        27585         8888          -18697      -795481.06\n17       2000  1999     4001001           1              4            371        16860         8888           -7972      -346687.40\n18       2000  1999     4001001           1              4            371        10685         8888           -1797      -139580.63\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.031115,
                    "execution_time": 0.015554,
                    "compile_time": 0.000101,
                    "planning_time": 0.00725
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.176469,
                    "execution_time": 0.016465,
                    "compile_time": 0.111019,
                    "planning_time": 0.043817
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\"",
                "rewrite": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" AND \"PREV_YR\".\"I_BRAND_ID\""
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        2001  1999     4001001           1              4            371         9049         8888            -161       -16908.07\n1        2001  1999     4001001           1              4            371         8478         8888             410       -40308.22\n2        2001  1999     4001001           1              4            371         8570         8888             318       -71696.89\n3        2001  1999     4001001           1              4            371         9147         8888            -259       -30776.75\n4        2001  1999     4001001           1              4            371         8299         8888             589         8509.53\n5        2001  1999     4001001           1              4            371         8462         8888             426          222.61\n6        2001  1999     4001001           1              4            371        19073         8888          -10185      -428789.78\n7        2001  1999     4001001           1              4            371        27440         8888          -18552      -818299.45\n8        2001  1999     4001001           1              4            371        28052         8888          -19164      -923037.27\n9        2001  1999     4001001           1              4            371         8487         8888             401        -4949.16\n10       1999  1999     4001001           1              4            371         8975         8888             -87        26279.88\n11       1999  1999     4001001           1              4            371        27442         8888          -18554      -727381.62\n12       1999  1999     4001001           1              4            371        29365         8888          -20477      -950636.11\n13       1999  1999     4001001           1              4            371         9201         8888            -313       -60896.34\n14       1999  1999     4001001           1              4            371        17495         8888           -8607      -417394.42\n15       1998  1999     4001001           1              4            371        18223         8888           -9335      -434052.89\n16       1998  1999     4001001           1              4            371        27585         8888          -18697      -795481.06\n17       2000  1999     4001001           1              4            371        16860         8888           -7972      -346687.40\n18       2000  1999     4001001           1              4            371        10685         8888           -1797      -139580.63\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.929656,
                    "execution_time": 2.38616,
                    "compile_time": 0.000605,
                    "planning_time": 0.00811,
                    "create_size": 3712
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.927304,
                    "execution_time": 2.316162,
                    "compile_time": 0.00462,
                    "planning_time": 0.065813,
                    "create_size": 3712
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        2003  2001     4002002           2              4            320           99        19073           18974       800078.41\n1        2003  2001     4002002           2              4            320           63        19073           19010       800566.03\n2        2003  2001     4002002           2              4            320           62        19073           19011       798701.46\n3        2003  2001     4002002           2              4            320          110        19073           18963       796160.82\n4        2003  2001     4002002           2              4            320          133        19073           18940       801448.78\n5        2003  2001     4002002           2              4            320          256        19073           18817       772570.60\n6        2003  2001     4002002           2              4            320           84        19073           18989       799463.95\n7        2003  2001     4002002           2              4            320          361        19073           18712       778019.34\n8        2003  2001     4002002           2              4            320          184        19073           18889       796219.64\n9        2003  2001     4002002           2              4            320          194        19073           18879       776716.14\n10       2003  2001     4002002           2              4            320          137        19073           18936       800505.01\n11       1998  2001     4002002           2              4            320         8272        19073           10801       450537.15\n12       2002  2001     4002002           2              4            320         8650        19073           10423       424478.71\n13       2002  2001     4002002           2              4            320         8897        19073           10176       413671.09\n14       2000  2001     4002002           2              4            320         8167        19073           10906       431070.34\n15       1999  2001     4002002           2              4            320         7082        19073           11991       529569.40\n16       2002  2001     4002002           2              4            320         9222        19073            9851       385909.16\n17       2002  2001     4002002           2              4            320         8580        19073           10493       429624.42\n18       2002  2001     4002002           2              4            320         9911        19073            9162       440476.91\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019723,
                    "execution_time": 0.008535,
                    "compile_time": 5e-05,
                    "planning_time": 0.004554
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.072063,
                    "execution_time": 0.00844,
                    "compile_time": 0.001182,
                    "planning_time": 0.040542
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        2003  2001     4002002           2              4            320           99        19073           18974       800078.41\n1        2003  2001     4002002           2              4            320           63        19073           19010       800566.03\n2        2003  2001     4002002           2              4            320           62        19073           19011       798701.46\n3        2003  2001     4002002           2              4            320          110        19073           18963       796160.82\n4        2003  2001     4002002           2              4            320          133        19073           18940       801448.78\n5        2003  2001     4002002           2              4            320          256        19073           18817       772570.60\n6        2003  2001     4002002           2              4            320           84        19073           18989       799463.95\n7        2003  2001     4002002           2              4            320          361        19073           18712       778019.34\n8        2003  2001     4002002           2              4            320          184        19073           18889       796219.64\n9        2003  2001     4002002           2              4            320          194        19073           18879       776716.14\n10       2003  2001     4002002           2              4            320          137        19073           18936       800505.01\n11       1998  2001     4002002           2              4            320         8272        19073           10801       450537.15\n12       2002  2001     4002002           2              4            320         8650        19073           10423       424478.71\n13       2002  2001     4002002           2              4            320         8897        19073           10176       413671.09\n14       2000  2001     4002002           2              4            320         8167        19073           10906       431070.34\n15       1999  2001     4002002           2              4            320         7082        19073           11991       529569.40\n16       2002  2001     4002002           2              4            320         9222        19073            9851       385909.16\n17       2002  2001     4002002           2              4            320         8580        19073           10493       429624.42\n18       2002  2001     4002002           2              4            320         9911        19073            9162       440476.91\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" ON \"SPEQLITE_TEMP_TABLE_17\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" ON \"SPEQLITE_TEMP_TABLE_17\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n1        2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n2        2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n3        2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n4        2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n5        2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n6        2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n7        2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n8        2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n9        2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n10       2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n11       2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n12       2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n13       2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n14       2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n15       2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n16       2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n17       2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n18       2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.033592,
                    "execution_time": 0.016809,
                    "compile_time": 0.000112,
                    "planning_time": 0.006914
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.182618,
                    "execution_time": 0.016977,
                    "compile_time": 0.109577,
                    "planning_time": 0.042551
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" ON \"SPEQLITE_TEMP_TABLE_17\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\""
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n1        2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n2        2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n3        2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n4        2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n5        2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n6        2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n7        2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n8        2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n9        2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n10       2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n11       2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n12       2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n13       2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n14       2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n15       2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n16       2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n17       2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n18       2001  2001     4001002           1              4            245         7371         9049            1678         56431.7\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" ON \"SPEQLITE_TEMP_TABLE_17\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"SPEQLITE_TEMP_TABLE_17\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" ON \"SPEQLITE_TEMP_TABLE_17\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"SPEQLITE_TEMP_TABLE_17\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n1        2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n2        2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n3        2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n4        2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n5        2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n6        2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n7        2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n8        2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n9        2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n10       2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n11       2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n12       2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n13       2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n14       2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n15       2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n16       2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n17       2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n18       2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.033613,
                    "execution_time": 0.015856,
                    "compile_time": 0.000121,
                    "planning_time": 0.007432
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.075064,
                    "execution_time": 0.016828,
                    "compile_time": 0.001176,
                    "planning_time": 0.043198
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_17\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_17\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" ON \"SPEQLITE_TEMP_TABLE_17\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"SPEQLITE_TEMP_TABLE_17\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\""
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n1        2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n2        2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n3        2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n4        2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n5        2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n6        2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n7        2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n8        2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n9        2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n10       2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n11       2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n12       2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n13       2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n14       2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n15       2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n16       2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n17       2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n18       2002  2001     4001002           1              4            245        10069         9049           -1020         1052.03\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n   AND curr_yr.d_year=2000\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" WHERE \"CURR_YR\".\"D_YEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" WHERE \"CURR_YR\".\"D_YEAR\" = 2000",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.12871,
                    "execution_time": 0.056678,
                    "compile_time": 0.00036,
                    "planning_time": 0.009183,
                    "create_size": 325
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.208733,
                    "execution_time": 0.05623,
                    "compile_time": 0.004399,
                    "planning_time": 0.077003,
                    "create_size": 325
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_18\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_18\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_18\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_18\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_18\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_18\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_18\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_18\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_18\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_18\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        2001  2000     4001002           1              4            245         9049         8953             -96       -13860.27\n1        2001  2000     4003002           3              4            364         8478         8706             228       -43751.84\n2        2001  2000     3002001           1              4            667         8570         8035            -535      -114782.74\n3        2001  2000     4003002           4              4            297         8299         9615            1316        69733.11\n4        2001  2000     4002002           2              4            320        19073        17588           -1485        14086.59\n5        2001  2000     4003002           3              4             54        27440        20399           -7041      -321547.48\n6        2001  2000     4001002           1              4            458        28052        26259           -1793      -214869.70\n7        2001  2000     4002002           1              4            125         8487         8529              42       -21174.40\n8        1999  2000     4001002           1              4             36         8975         9167             192        79108.27\n9        1999  2000     4004001           4              4            447        27442         8273          -19169      -771070.60\n10       1999  2000     4001001           1              4            107        29365        18254          -11111      -571865.35\n11       1999  2000     4001001           1              4            193         9201        17497            8296       314003.38\n12       1999  2000     4004002           4              4             48        17495        19507            2012        89314.56\n13       1998  2000     4001001           1              4            358        18223         9563           -8660      -424657.93\n14       1998  2000     4004001           4              4            447        27585         8273          -19312      -839170.04\n15       2000  2000     4001002           1              4            319        16860        16860               0            0.00\n16       2000  2000     4001001           1              4            557        10685        10685               0            0.00\n17       2000  2000     4004001           4              4            414         7580         7580               0            0.00\n18       2001  2000     4001002           1              4            218        10810         9348           -1462        42123.11\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018443,
                    "execution_time": 0.007331,
                    "compile_time": 5e-05,
                    "planning_time": 0.004559
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.058018,
                    "execution_time": 0.007766,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.040461
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" WHERE \"CURR_YR\".\"D_YEAR\" = 2000",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_18\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_18\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_18\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_18\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_18\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_18\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_18\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_18\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_18\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_18\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\""
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        2001  2000     4001002           1              4            245         9049         8953             -96       -13860.27\n1        2001  2000     4003002           3              4            364         8478         8706             228       -43751.84\n2        2001  2000     3002001           1              4            667         8570         8035            -535      -114782.74\n3        2001  2000     4003002           4              4            297         8299         9615            1316        69733.11\n4        2001  2000     4002002           2              4            320        19073        17588           -1485        14086.59\n5        2001  2000     4003002           3              4             54        27440        20399           -7041      -321547.48\n6        2001  2000     4001002           1              4            458        28052        26259           -1793      -214869.70\n7        2001  2000     4002002           1              4            125         8487         8529              42       -21174.40\n8        1999  2000     4001002           1              4             36         8975         9167             192        79108.27\n9        1999  2000     4004001           4              4            447        27442         8273          -19169      -771070.60\n10       1999  2000     4001001           1              4            107        29365        18254          -11111      -571865.35\n11       1999  2000     4001001           1              4            193         9201        17497            8296       314003.38\n12       1999  2000     4004002           4              4             48        17495        19507            2012        89314.56\n13       1998  2000     4001001           1              4            358        18223         9563           -8660      -424657.93\n14       1998  2000     4004001           4              4            447        27585         8273          -19312      -839170.04\n15       2000  2000     4001002           1              4            319        16860        16860               0            0.00\n16       2000  2000     4001001           1              4            557        10685        10685               0            0.00\n17       2000  2000     4004001           4              4            414         7580         7580               0            0.00\n18       2001  2000     4001002           1              4            218        10810         9348           -1462        42123.11\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n   AND curr_yr.d_year=2000\n   AND prev_yr.d_year=2000-1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = 1999 WHERE \"CURR_YR\".\"D_YEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"SPEQLITE_TEMP_TABLE_18\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_18\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_18\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_18\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_18\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_18\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_18\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_18\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_18\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_18\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" ON \"PREV_YR\".\"D_YEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 4.346514,
                    "execution_time": 3.633717,
                    "compile_time": 0.193355,
                    "planning_time": 0.006874,
                    "create_size": 4352
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 11.019664,
                    "execution_time": 4.07351,
                    "compile_time": 6.366935,
                    "planning_time": 0.064309,
                    "create_size": 4352
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_19\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_19\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_19\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_19\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_19\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_19\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_19\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1998  2000     4001002           1              4            233         8652        18877           10225       387122.05\n1        1998  2000     4003002           3              4            703         8386         8853             467        17351.33\n2        2000  2000     4001001           1              4            663        10344        10344               0            0.00\n3        1999  2000     4002002           2              4            576         9386        10749            1363       -36674.91\n4        2002  2000     4001002           1              4            299        17402         7485           -9917      -487882.93\n5        2000  2000     7015005           2              4            813         8864         8864               0            0.00\n6        1999  2000     4002001           2              4            335         9668         8706            -962       -63443.79\n7        1999  2000     4004001           4              4              6         9015          128           -8887      -340576.76\n8        1999  2000     4004001           4              4            649         8504         8642             138        42518.66\n9        2001  2000     4003002           3              4            438         8767         9032             265       -21451.38\n10       2001  2000     8005001           5              4            326         7508         8951            1443        71283.72\n11       2002  2000     4002001           2              4            111         8774          295           -8479      -303943.00\n12       2000  2000     8009001           2              4            315         9239         9239               0            0.00\n13       2000  2000     4004002           3              4             36         8944         8944               0            0.00\n14       2002  2000     4002002           3              4            249         7933         8845             912        22419.50\n15       2002  2000     4002002           2              4            178         8884        17536            8652       373761.47\n16       2003  2000     4003002           3              4            162          122         8629            8507       360577.19\n17       2003  2000     4003002           3              4            871          167         8533            8366       363570.39\n18       2000  2000     4004001           4              4            901          101          101               0            0.00\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020104,
                    "execution_time": 0.008659,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.00471
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.059608,
                    "execution_time": 0.009069,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.040521
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = 1999 WHERE \"CURR_YR\".\"D_YEAR\" = 2000",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_19\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_19\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_19\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_19\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_19\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_19\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_19\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_19\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\""
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1998  2000     4001002           1              4            233         8652        18877           10225       387122.05\n1        1998  2000     4003002           3              4            703         8386         8853             467        17351.33\n2        2000  2000     4001001           1              4            663        10344        10344               0            0.00\n3        1999  2000     4002002           2              4            576         9386        10749            1363       -36674.91\n4        2002  2000     4001002           1              4            299        17402         7485           -9917      -487882.93\n5        2000  2000     7015005           2              4            813         8864         8864               0            0.00\n6        1999  2000     4002001           2              4            335         9668         8706            -962       -63443.79\n7        1999  2000     4004001           4              4              6         9015          128           -8887      -340576.76\n8        1999  2000     4004001           4              4            649         8504         8642             138        42518.66\n9        2001  2000     4003002           3              4            438         8767         9032             265       -21451.38\n10       2001  2000     8005001           5              4            326         7508         8951            1443        71283.72\n11       2002  2000     4002001           2              4            111         8774          295           -8479      -303943.00\n12       2000  2000     8009001           2              4            315         9239         9239               0            0.00\n13       2000  2000     4004002           3              4             36         8944         8944               0            0.00\n14       2002  2000     4002002           3              4            249         7933         8845             912        22419.50\n15       2002  2000     4002002           2              4            178         8884        17536            8652       373761.47\n16       2003  2000     4003002           3              4            162          122         8629            8507       360577.19\n17       2003  2000     4003002           3              4            871          167         8533            8366       363570.39\n18       2000  2000     4004001           4              4            901          101          101               0            0.00\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n   AND curr_yr.d_year=2000\n   AND prev_yr.d_year=2000-1\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = 1999 AND CAST ( \"CURR_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) / CAST ( \"PREV_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) < 0.9 WHERE \"CURR_YR\".\"D_YEAR\" = 2000"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = 1999 AND CAST ( \"CURR_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) / CAST ( \"PREV_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) < 0.9 WHERE \"CURR_YR\".\"D_YEAR\" = 2000",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.09287,
                    "execution_time": 0.047369,
                    "compile_time": 0.000385,
                    "planning_time": 0.010476,
                    "create_size": 52
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.327311,
                    "execution_time": 0.047943,
                    "compile_time": 0.169418,
                    "planning_time": 0.069589,
                    "create_size": 52
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_20\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_20\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_20\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_20\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2000     4004001           4              4            291        27715         9506          -18209      -819498.44\n1        1999  2000     4003001           3              4            514         9397         8051           -1346       -12372.13\n2        1999  2000     4001001           1              4            228        46514        26622          -19892      -792421.71\n3        1999  2000     4003001           3              4            115        37795        18512          -19283     -1062055.50\n4        1999  2000     4002001           2              4            113        28040        17619          -10421      -519055.42\n5        1999  2000     4004001           4              4             51        17843         8873           -8970      -357442.82\n6        1999  2000     4002001           2              4            599        16068         8290           -7778      -305724.35\n7        1999  2000     4004001           4              4            321        26012        19859           -6153      -282532.70\n8        1999  2000     4001001           1              4            566        18674         8319          -10355      -445080.73\n9        1999  2000     4002001           2              4            505        18287         9442           -8845      -476293.27\n10       1999  2000     4002002           2              4            784        10232         8559           -1673      -125219.64\n11       1999  2000     4002001           2              4             23        25332         9573          -15759      -615143.53\n12       1999  2000     4002001           2              4             12         9179         7775           -1404       -35972.83\n13       1999  2000     4003002           3              4            362        18683        16706           -1977      -155795.95\n14       1999  2000     4001001           1              4              5        17506         8957           -8549      -318207.49\n15       1999  2000     4004001           4              4            232        18358         8205          -10153      -384802.13\n16       1999  2000     4002001           2              4            301        19363         9878           -9485      -374912.75\n17       1999  2000     4004001           4              4            758         8575         7333           -1242       -28094.18\n18       1999  2000     4001001           1              4             66        17031         8048           -8983      -401838.24\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018186,
                    "execution_time": 0.007136,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.004528
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05743,
                    "execution_time": 0.007401,
                    "compile_time": 5e-05,
                    "planning_time": 0.040332
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = 1999 AND CAST ( \"CURR_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) / CAST ( \"PREV_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) < 0.9 WHERE \"CURR_YR\".\"D_YEAR\" = 2000",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_20\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_20\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_20\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_20\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\""
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2000     4004001           4              4            291        27715         9506          -18209      -819498.44\n1        1999  2000     4003001           3              4            514         9397         8051           -1346       -12372.13\n2        1999  2000     4001001           1              4            228        46514        26622          -19892      -792421.71\n3        1999  2000     4003001           3              4            115        37795        18512          -19283     -1062055.50\n4        1999  2000     4002001           2              4            113        28040        17619          -10421      -519055.42\n5        1999  2000     4004001           4              4             51        17843         8873           -8970      -357442.82\n6        1999  2000     4002001           2              4            599        16068         8290           -7778      -305724.35\n7        1999  2000     4004001           4              4            321        26012        19859           -6153      -282532.70\n8        1999  2000     4001001           1              4            566        18674         8319          -10355      -445080.73\n9        1999  2000     4002001           2              4            505        18287         9442           -8845      -476293.27\n10       1999  2000     4002002           2              4            784        10232         8559           -1673      -125219.64\n11       1999  2000     4002001           2              4             23        25332         9573          -15759      -615143.53\n12       1999  2000     4002001           2              4             12         9179         7775           -1404       -35972.83\n13       1999  2000     4003002           3              4            362        18683        16706           -1977      -155795.95\n14       1999  2000     4001001           1              4              5        17506         8957           -8549      -318207.49\n15       1999  2000     4004001           4              4            232        18358         8205          -10153      -384802.13\n16       1999  2000     4002001           2              4            301        19363         9878           -9485      -374912.75\n17       1999  2000     4004001           4              4            758         8575         7333           -1242       -28094.18\n18       1999  2000     4001001           1              4             66        17031         8048           -8983      -401838.24\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n   AND curr_yr.d_year=2000\n   AND prev_yr.d_year=2000-1\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\n ORDER BY sales_cnt_diff,sales_amt_diff\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = 1999 AND CAST ( \"CURR_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) / CAST ( \"PREV_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) < 0.9 WHERE \"CURR_YR\".\"D_YEAR\" = 2000 ORDER BY \"SALES_CNT_DIFF\" NULLS LAST , \"SALES_AMT_DIFF\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_20\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_20\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_20\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_20\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"SALES_CNT_DIFF\" , \"SALES_AMT_DIFF\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2000     4003001           3              4            325        66561          538          -66023     -2978272.71\n1        1999  2000     4002001           2              4            145        56922           68          -56854     -2339826.44\n2        1999  2000     4004001           4              4            304        38397          253          -38144     -1713716.56\n3        1999  2000     4001001           1              4             98        46659         9896          -36763     -1601721.76\n4        1999  2000     4003001           3              4            158        36534          245          -36289     -1624687.24\n5        1999  2000     4003001           3              4            184        45121         8927          -36194     -1755028.84\n6        1999  2000     4002001           2              4            642        36280          285          -35995     -1528886.82\n7        1999  2000     4002001           2              4             82        35748           68          -35680     -1554586.43\n8        1999  2000     4002001           2              4            295        34764          125          -34639     -1450831.10\n9        1999  2000     4004001           4              4              1        64083        30504          -33579     -1529756.64\n10       1999  2000     4003001           3              4            216        30927          313          -30614     -1380127.73\n11       1999  2000     4003001           3              4            640        30196           65          -30131     -1276106.05\n12       1999  2000     4002001           2              4            119        39365        10124          -29241     -1434791.59\n13       1999  2000     4002001           2              4             62        29281           68          -29213     -1339248.55\n14       1999  2000     4004001           4              4            147        28927           88          -28839     -1323201.60\n15       1999  2000     4003001           3              4            308        39235        10720          -28515     -1198801.53\n16       1999  2000     4001001           1              4            202        28534          107          -28427     -1316331.79\n17       1999  2000     4003001           3              4            614        45675        17335          -28340     -1301008.37\n18       1999  2000     4003001           3              4            331        37379         9042          -28337     -1261983.37\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019554,
                    "execution_time": 0.00801,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.004931
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.156995,
                    "execution_time": 0.008796,
                    "compile_time": 0.09934,
                    "planning_time": 0.040403
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = 1999 AND CAST ( \"CURR_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) / CAST ( \"PREV_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) < 0.9 WHERE \"CURR_YR\".\"D_YEAR\" = 2000 ORDER BY \"SALES_CNT_DIFF\" NULLS LAST , \"SALES_AMT_DIFF\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_20\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_20\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_20\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_20\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"SALES_CNT_DIFF\" NULLS LAST , \"SALES_AMT_DIFF\" NULLS LAST"
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2000     4003001           3              4            325        66561          538          -66023     -2978272.71\n1        1999  2000     4002001           2              4            145        56922           68          -56854     -2339826.44\n2        1999  2000     4004001           4              4            304        38397          253          -38144     -1713716.56\n3        1999  2000     4001001           1              4             98        46659         9896          -36763     -1601721.76\n4        1999  2000     4003001           3              4            158        36534          245          -36289     -1624687.24\n5        1999  2000     4003001           3              4            184        45121         8927          -36194     -1755028.84\n6        1999  2000     4002001           2              4            642        36280          285          -35995     -1528886.82\n7        1999  2000     4002001           2              4             82        35748           68          -35680     -1554586.43\n8        1999  2000     4002001           2              4            295        34764          125          -34639     -1450831.10\n9        1999  2000     4004001           4              4              1        64083        30504          -33579     -1529756.64\n10       1999  2000     4003001           3              4            216        30927          313          -30614     -1380127.73\n11       1999  2000     4003001           3              4            640        30196           65          -30131     -1276106.05\n12       1999  2000     4002001           2              4            119        39365        10124          -29241     -1434791.59\n13       1999  2000     4002001           2              4             62        29281           68          -29213     -1339248.55\n14       1999  2000     4004001           4              4            147        28927           88          -28839     -1323201.60\n15       1999  2000     4003001           3              4            308        39235        10720          -28515     -1198801.53\n16       1999  2000     4001001           1              4            202        28534          107          -28427     -1316331.79\n17       1999  2000     4003001           3              4            614        45675        17335          -28340     -1301008.37\n18       1999  2000     4003001           3              4            331        37379         9042          -28337     -1261983.37\n...*/"
    },
    {
        "input": "-- start template query75.tpl query 3 in stream 0\nWITH /* TPC-DS query75.tpl 0.3 */ all_sales AS (\n SELECT d_year\n       ,i_brand_id\n       ,i_class_id\n       ,i_category_id\n       ,i_manufact_id\n       ,SUM(sales_cnt) AS sales_cnt\n       ,SUM(sales_amt) AS sales_amt\n FROM (SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,cs_quantity - COALESCE(cr_return_quantity,0) AS sales_cnt\n             ,cs_ext_sales_price - COALESCE(cr_return_amount,0.0) AS sales_amt\n       FROM catalog_sales JOIN item ON i_item_sk=cs_item_sk\n                          JOIN date_dim ON d_date_sk=cs_sold_date_sk\n                          LEFT JOIN catalog_returns ON (cs_order_number=cr_order_number \n                                                    AND cs_item_sk=cr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ss_quantity - COALESCE(sr_return_quantity,0) AS sales_cnt\n             ,ss_ext_sales_price - COALESCE(sr_return_amt,0.0) AS sales_amt\n       FROM store_sales JOIN item ON i_item_sk=ss_item_sk\n                        JOIN date_dim ON d_date_sk=ss_sold_date_sk\n                        LEFT JOIN store_returns ON (ss_ticket_number=sr_ticket_number \n                                                AND ss_item_sk=sr_item_sk)\n       WHERE i_category='Shoes'\n       UNION\n       SELECT d_year\n             ,i_brand_id\n             ,i_class_id\n             ,i_category_id\n             ,i_manufact_id\n             ,ws_quantity - COALESCE(wr_return_quantity,0) AS sales_cnt\n             ,ws_ext_sales_price - COALESCE(wr_return_amt,0.0) AS sales_amt\n       FROM web_sales JOIN item ON i_item_sk=ws_item_sk\n                      JOIN date_dim ON d_date_sk=ws_sold_date_sk\n                      LEFT JOIN web_returns ON (ws_order_number=wr_order_number \n                                            AND ws_item_sk=wr_item_sk)\n       WHERE i_category='Shoes') sales_detail\n GROUP BY d_year, i_brand_id, i_class_id, i_category_id, i_manufact_id)\n SELECT  prev_yr.d_year AS prev_year\n                          ,curr_yr.d_year AS year\n                          ,curr_yr.i_brand_id\n                          ,curr_yr.i_class_id\n                          ,curr_yr.i_category_id\n                          ,curr_yr.i_manufact_id\n                          ,prev_yr.sales_cnt AS prev_yr_cnt\n                          ,curr_yr.sales_cnt AS curr_yr_cnt\n                          ,curr_yr.sales_cnt-prev_yr.sales_cnt AS sales_cnt_diff\n                          ,curr_yr.sales_amt-prev_yr.sales_amt AS sales_amt_diff\n FROM all_sales curr_yr, all_sales prev_yr\n WHERE curr_yr.i_brand_id=prev_yr.i_brand_id\n   AND curr_yr.i_class_id=prev_yr.i_class_id\n   AND curr_yr.i_category_id=prev_yr.i_category_id\n   AND curr_yr.i_manufact_id=prev_yr.i_manufact_id\n   AND curr_yr.d_year=2000\n   AND prev_yr.d_year=2000-1\n   AND CAST(curr_yr.sales_cnt AS DECIMAL(17,2))/CAST(prev_yr.sales_cnt AS DECIMAL(17,2))<0.9\n ORDER BY sales_cnt_diff,sales_amt_diff\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"ITEM_2\" AS ( SELECT \"ITEM\".\"I_ITEM_SK\" AS \"I_ITEM_SK\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" FROM \"ITEM\" AS \"ITEM\" WHERE \"ITEM\".\"I_CATEGORY\" = 'Shoes' ) , \"SALES_DETAIL\" AS ( SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"CATALOG_SALES\".\"CS_QUANTITY\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" - COALESCE ( \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" , 0.0 ) AS \"SALES_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" LEFT JOIN \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ON \"CATALOG_RETURNS\".\"CR_ITEM_SK\" = \"CATALOG_SALES\".\"CS_ITEM_SK\" AND \"CATALOG_RETURNS\".\"CR_ORDER_NUMBER\" = \"CATALOG_SALES\".\"CS_ORDER_NUMBER\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"STORE_SALES\".\"SS_QUANTITY\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" - COALESCE ( \"STORE_RETURNS\".\"SR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" LEFT JOIN \"STORE_RETURNS\" AS \"STORE_RETURNS\" ON \"STORE_RETURNS\".\"SR_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" AND \"STORE_RETURNS\".\"SR_TICKET_NUMBER\" = \"STORE_SALES\".\"SS_TICKET_NUMBER\" UNION SELECT \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" , \"ITEM\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"ITEM\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"ITEM\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"ITEM\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"WEB_SALES\".\"WS_QUANTITY\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_QUANTITY\" , 0 ) AS \"SALES_CNT\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" - COALESCE ( \"WEB_RETURNS\".\"WR_RETURN_AMT\" , 0.0 ) AS \"SALES_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM_2\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" LEFT JOIN \"WEB_RETURNS\" AS \"WEB_RETURNS\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"ALL_SALES\" AS ( SELECT \"SALES_DETAIL\".\"D_YEAR\" AS \"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , SUM ( \"SALES_DETAIL\".\"SALES_CNT\" ) AS \"SALES_CNT\" , SUM ( \"SALES_DETAIL\".\"SALES_AMT\" ) AS \"SALES_AMT\" FROM \"SALES_DETAIL\" AS \"SALES_DETAIL\" GROUP BY \"SALES_DETAIL\".\"D_YEAR\" , \"SALES_DETAIL\".\"I_BRAND_ID\" , \"SALES_DETAIL\".\"I_CLASS_ID\" , \"SALES_DETAIL\".\"I_CATEGORY_ID\" , \"SALES_DETAIL\".\"I_MANUFACT_ID\" ) SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"ALL_SALES\" AS \"CURR_YR\" JOIN \"ALL_SALES\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = 1999 AND CAST ( \"CURR_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) / CAST ( \"PREV_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) < 0.9 WHERE \"CURR_YR\".\"D_YEAR\" = 2000 ORDER BY \"SALES_CNT_DIFF\" NULLS LAST , \"SALES_AMT_DIFF\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_20\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_20\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_20\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_20\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"SALES_CNT_DIFF\" , \"SALES_AMT_DIFF\" LIMIT 21",
                "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2000     4003001           3              4            325        66561          538          -66023     -2978272.71\n1        1999  2000     4002001           2              4            145        56922           68          -56854     -2339826.44\n2        1999  2000     4004001           4              4            304        38397          253          -38144     -1713716.56\n3        1999  2000     4001001           1              4             98        46659         9896          -36763     -1601721.76\n4        1999  2000     4003001           3              4            158        36534          245          -36289     -1624687.24\n5        1999  2000     4003001           3              4            184        45121         8927          -36194     -1755028.84\n6        1999  2000     4002001           2              4            642        36280          285          -35995     -1528886.82\n7        1999  2000     4002001           2              4             82        35748           68          -35680     -1554586.43\n8        1999  2000     4002001           2              4            295        34764          125          -34639     -1450831.10\n9        1999  2000     4004001           4              4              1        64083        30504          -33579     -1529756.64\n10       1999  2000     4003001           3              4            216        30927          313          -30614     -1380127.73\n11       1999  2000     4003001           3              4            640        30196           65          -30131     -1276106.05\n12       1999  2000     4002001           2              4            119        39365        10124          -29241     -1434791.59\n13       1999  2000     4002001           2              4             62        29281           68          -29213     -1339248.55\n14       1999  2000     4004001           4              4            147        28927           88          -28839     -1323201.60\n15       1999  2000     4003001           3              4            308        39235        10720          -28515     -1198801.53\n16       1999  2000     4001001           1              4            202        28534          107          -28427     -1316331.79\n17       1999  2000     4003001           3              4            614        45675        17335          -28340     -1301008.37\n18       1999  2000     4003001           3              4            331        37379         9042          -28337     -1261983.37\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020368,
                    "execution_time": 0.008912,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.004859
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020433,
                    "execution_time": 0.008717,
                    "compile_time": 7.8e-05,
                    "planning_time": 0.00496
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"PREV_YR\".\"D_YEAR\" AS \"PREV_YEAR\" , \"CURR_YR\".\"D_YEAR\" AS \"YEAR\" , \"CURR_YR\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"CURR_YR\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"CURR_YR\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"CURR_YR\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"PREV_YR\".\"SALES_CNT\" AS \"PREV_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" AS \"CURR_YR_CNT\" , \"CURR_YR\".\"SALES_CNT\" - \"PREV_YR\".\"SALES_CNT\" AS \"SALES_CNT_DIFF\" , \"CURR_YR\".\"SALES_AMT\" - \"PREV_YR\".\"SALES_AMT\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"CURR_YR\" JOIN \"SPEQLITE_TEMP_TABLE_16\" AS \"PREV_YR\" ON \"CURR_YR\".\"I_BRAND_ID\" = \"PREV_YR\".\"I_BRAND_ID\" AND \"CURR_YR\".\"I_CATEGORY_ID\" = \"PREV_YR\".\"I_CATEGORY_ID\" AND \"CURR_YR\".\"I_CLASS_ID\" = \"PREV_YR\".\"I_CLASS_ID\" AND \"CURR_YR\".\"I_MANUFACT_ID\" = \"PREV_YR\".\"I_MANUFACT_ID\" AND \"PREV_YR\".\"D_YEAR\" = 1999 AND CAST ( \"CURR_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) / CAST ( \"PREV_YR\".\"SALES_CNT\" AS DECIMAL ( 17 , 2 ) ) < 0.9 WHERE \"CURR_YR\".\"D_YEAR\" = 2000 ORDER BY \"SALES_CNT_DIFF\" NULLS LAST , \"SALES_AMT_DIFF\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_20\".\"PREV_YEAR\" AS \"PREV_YEAR\" , \"SPEQLITE_TEMP_TABLE_20\".\"YEAR\" AS \"YEAR\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_BRAND_ID\" AS \"I_BRAND_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_CLASS_ID\" AS \"I_CLASS_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_CATEGORY_ID\" AS \"I_CATEGORY_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"I_MANUFACT_ID\" AS \"I_MANUFACT_ID\" , \"SPEQLITE_TEMP_TABLE_20\".\"PREV_YR_CNT\" AS \"PREV_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_20\".\"CURR_YR_CNT\" AS \"CURR_YR_CNT\" , \"SPEQLITE_TEMP_TABLE_20\".\"SALES_CNT_DIFF\" AS \"SALES_CNT_DIFF\" , \"SPEQLITE_TEMP_TABLE_20\".\"SALES_AMT_DIFF\" AS \"SALES_AMT_DIFF\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" ORDER BY \"SALES_CNT_DIFF\" NULLS LAST , \"SALES_AMT_DIFF\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*    prev_year  year  i_brand_id  i_class_id  i_category_id  i_manufact_id  prev_yr_cnt  curr_yr_cnt  sales_cnt_diff  sales_amt_diff\n0        1999  2000     4003001           3              4            325        66561          538          -66023     -2978272.71\n1        1999  2000     4002001           2              4            145        56922           68          -56854     -2339826.44\n2        1999  2000     4004001           4              4            304        38397          253          -38144     -1713716.56\n3        1999  2000     4001001           1              4             98        46659         9896          -36763     -1601721.76\n4        1999  2000     4003001           3              4            158        36534          245          -36289     -1624687.24\n5        1999  2000     4003001           3              4            184        45121         8927          -36194     -1755028.84\n6        1999  2000     4002001           2              4            642        36280          285          -35995     -1528886.82\n7        1999  2000     4002001           2              4             82        35748           68          -35680     -1554586.43\n8        1999  2000     4002001           2              4            295        34764          125          -34639     -1450831.10\n9        1999  2000     4004001           4              4              1        64083        30504          -33579     -1529756.64\n10       1999  2000     4003001           3              4            216        30927          313          -30614     -1380127.73\n11       1999  2000     4003001           3              4            640        30196           65          -30131     -1276106.05\n12       1999  2000     4002001           2              4            119        39365        10124          -29241     -1434791.59\n13       1999  2000     4002001           2              4             62        29281           68          -29213     -1339248.55\n14       1999  2000     4004001           4              4            147        28927           88          -28839     -1323201.60\n15       1999  2000     4003001           3              4            308        39235        10720          -28515     -1198801.53\n16       1999  2000     4001001           1              4            202        28534          107          -28427     -1316331.79\n17       1999  2000     4003001           3              4            614        45675        17335          -28340     -1301008.37\n18       1999  2000     4003001           3              4            331        37379         9042          -28337     -1261983.37\n...*/"
    }
]