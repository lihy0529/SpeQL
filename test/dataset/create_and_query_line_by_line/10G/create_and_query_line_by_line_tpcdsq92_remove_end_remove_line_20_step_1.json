[
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere  1=1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\"",
                "rewrite": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 992 LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_MANUFACT_ID\" = 992"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.17027,
                    "execution_time": 0.098162,
                    "compile_time": 0.000426,
                    "planning_time": 0.042909,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.253186,
                    "execution_time": 0.100182,
                    "compile_time": 0.000412,
                    "planning_time": 0.119865,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            2.891899e+11*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015854,
                    "execution_time": 0.00711,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003071
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052942,
                    "execution_time": 0.007989,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.0386
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*   excess discount amount\n0            2.891899e+11*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and '1998-02-28'  \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '1998-02-28' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '1998-02-28' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.090356,
                    "execution_time": 0.037841,
                    "compile_time": 0.00028,
                    "planning_time": 0.028638,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.156247,
                    "execution_time": 0.03833,
                    "compile_time": 0.000291,
                    "planning_time": 0.09085,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*    excess discount amount\n0             2.891899e+11\n1             2.891899e+11\n2             2.891899e+11\n3             2.891899e+11\n4             2.891899e+11\n5             2.891899e+11\n6             2.891899e+11\n7             2.891899e+11\n8             2.891899e+11\n9             2.891899e+11\n10            2.891899e+11\n11            2.891899e+11\n12            2.891899e+11\n13            2.891899e+11\n14            2.891899e+11\n15            2.891899e+11\n16            2.891899e+11\n17            2.891899e+11\n18            2.891899e+11\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.015603,
                    "execution_time": 0.006872,
                    "compile_time": 4.2e-05,
                    "planning_time": 0.003003
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053025,
                    "execution_time": 0.007063,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.038395
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST('1998-02-28' AS DATE) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-02-02' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"EXCESS DISCOUNT AMOUNT\" AS \"EXCESS DISCOUNT AMOUNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*    excess discount amount\n0             2.891899e+11\n1             2.891899e+11\n2             2.891899e+11\n3             2.891899e+11\n4             2.891899e+11\n5             2.891899e+11\n6             2.891899e+11\n7             2.891899e+11\n8             2.891899e+11\n9             2.891899e+11\n10            2.891899e+11\n11            2.891899e+11\n12            2.891899e+11\n13            2.891899e+11\n14            2.891899e+11\n15            2.891899e+11\n16            2.891899e+11\n17            2.891899e+11\n18            2.891899e+11\n...*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            3.602552e+08*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.071051,
                    "execution_time": 0.0184,
                    "compile_time": 0.000212,
                    "planning_time": 0.041427
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.137238,
                    "execution_time": 0.016649,
                    "compile_time": 0.000198,
                    "planning_time": 0.10818
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 90, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-02-02' AS DATE) JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0            3.602552e+08*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK LIMIT 21",
                "preview": "\n/*   excess discount amount\n0               140397.79*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.069383,
                    "execution_time": 0.015574,
                    "compile_time": 0.000208,
                    "planning_time": 0.042421
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.137957,
                    "execution_time": 0.017423,
                    "compile_time": 0.000204,
                    "planning_time": 0.107726
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 90, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-02-02' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0               140397.79*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 WHERE \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" > 0"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > 0 LIMIT 21",
                "preview": "\n/*   excess discount amount\n0               140397.79*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.070819,
                    "execution_time": 0.01809,
                    "compile_time": 0.000202,
                    "planning_time": 0.041296
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.141803,
                    "execution_time": 0.018147,
                    "compile_time": 0.000199,
                    "planning_time": 0.10925
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM(\"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\") AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 90, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('1998-02-02' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 WHERE \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" > 0",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0               140397.79*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n/*CURSOR_IDENTIFIER*/ \n         0\n         )",
        "optimize": [
            "SELECT 0 AS \"0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT 0 AS \"0\" LIMIT 21",
                "preview": "\n/*   0\n0  0*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.930398,
                    "execution_time": 0.658322,
                    "compile_time": 0.000335,
                    "planning_time": 0.07715
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.81451,
                    "execution_time": 0.545539,
                    "compile_time": 0.000341,
                    "planning_time": 0.076162
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT 0 AS \"0\"",
                "rewrite": "SELECT 0 AS \"0\""
            }
        ],
        "preview": "\n/*   0\n0  0*/"
    },
    {
        "input": "select /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_item_sk = ws_item_sk \nand d_date_sk = ws_sold_date_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales\n         WHERE \n            ws_ext_discount_amt IS NOT NULL\n       ) /* Closing the open subquery */\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" WHERE NOT \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" IS NULL ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" WHERE NOT \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" IS NULL",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.091345,
                    "execution_time": 0.038911,
                    "compile_time": 0.00029,
                    "planning_time": 0.026683,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.171944,
                    "execution_time": 0.039319,
                    "compile_time": 0.000313,
                    "planning_time": 0.102822,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_ITEM_SK = WS_ITEM_SK AND D_DATE_SK = WS_SOLD_DATE_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES WHERE NOT WS_EXT_DISCOUNT_AMT IS NULL ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            3.668582e+08*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.089377,
                    "execution_time": 0.027545,
                    "compile_time": 0.000295,
                    "planning_time": 0.046844
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.15997,
                    "execution_time": 0.027326,
                    "compile_time": 0.000299,
                    "planning_time": 0.114492
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" ON \"SPEQLITE_TEMP_TABLE_3\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0            3.668582e+08*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\nitem.i_manufact_id = 992\nand item.i_item_sk = ws_item_sk \nand date_dim.d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand date_dim.d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n         web_sales\n/*CURSOR_IDENTIFIER*/  )",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.089652,
                    "execution_time": 0.037887,
                    "compile_time": 0.000281,
                    "planning_time": 0.026907,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.156365,
                    "execution_time": 0.037256,
                    "compile_time": 0.000296,
                    "planning_time": 0.090029,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE ITEM.I_MANUFACT_ID = 992 AND ITEM.I_ITEM_SK = WS_ITEM_SK AND DATE_DIM.D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND DATE_DIM.D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0               106475.57*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.086271,
                    "execution_time": 0.024825,
                    "compile_time": 0.000311,
                    "planning_time": 0.046404
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.163913,
                    "execution_time": 0.026186,
                    "compile_time": 0.000302,
                    "planning_time": 0.119184
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"SPEQLITE_TEMP_TABLE_4\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0               106475.57*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n    ,date_dim\nwhere\nd_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n         where ws_ext_discount_amt > 0\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" WHERE \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" > 0 ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" WHERE \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" > 0",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.092199,
                    "execution_time": 0.038192,
                    "compile_time": 0.0003,
                    "planning_time": 0.028467,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.16297,
                    "execution_time": 0.039883,
                    "compile_time": 0.000306,
                    "planning_time": 0.093596,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , DATE_DIM WHERE D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES WHERE WS_EXT_DISCOUNT_AMT > 0 ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0            3.650557e+08*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.076579,
                    "execution_time": 0.022202,
                    "compile_time": 0.000231,
                    "planning_time": 0.041147
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.150702,
                    "execution_time": 0.023377,
                    "compile_time": 0.000251,
                    "planning_time": 0.110689
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_5\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0            3.650557e+08*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n           WHERE d_date_sk = ws_sold_date_sk)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.112308,
                    "execution_time": 0.049395,
                    "compile_time": 0.000333,
                    "planning_time": 0.035897,
                    "create_size": 4
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.188894,
                    "execution_time": 0.048994,
                    "compile_time": 0.000345,
                    "planning_time": 0.108887,
                    "create_size": 4
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE D_DATE_SK = WS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0               106475.57*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.102336,
                    "execution_time": 0.036921,
                    "compile_time": 0.00036,
                    "planning_time": 0.048803
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.183723,
                    "execution_time": 0.043992,
                    "compile_time": 0.000341,
                    "planning_time": 0.120036
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0               106475.57*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE d_date_sk = ws_sold_date_sk\n/*CURSOR_IDENTIFIER*/\n         )",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE D_DATE_SK = WS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0               106475.57*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.105378,
                    "execution_time": 0.036932,
                    "compile_time": 0.000345,
                    "planning_time": 0.051672
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.10252,
                    "execution_time": 0.036472,
                    "compile_time": 0.000338,
                    "planning_time": 0.049373
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ON \"SPEQLITE_TEMP_TABLE_6\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992",
                "rewrite": null
            }
        ],
        "preview": "\n/*   excess discount amount\n0               106475.57*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE \n              ws_item_sk = i_item_sk \n/*CURSOR_IDENTIFIER*/\n         )",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": null,
        "rewrite_main_query": [
            {
                "script": "WITH _U_0 AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\"",
                "rewrite": "WITH _U_0 AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WEB_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE \n              ws_item_sk = i_item_sk \n          and d_date between '1998-02-02' and\n         dateadd(day,90,cast('1998-02-02' as date))\n         )\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0               112888.91*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.126284,
                    "execution_time": 0.036102,
                    "compile_time": 0.000476,
                    "planning_time": 0.069198
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.20315,
                    "execution_time": 0.035804,
                    "compile_time": 0.000468,
                    "planning_time": 0.143165
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0               112888.91*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE \n              ws_item_sk = i_item_sk \n          and d_date between '1998-02-02' and\n                             dateadd(day,90,cast('1998-02-02' as date))\n/*CURSOR_IDENTIFIER*/\n         )",
        "optimize": [
            "WITH \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0               112888.91*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.126712,
                    "execution_time": 0.035465,
                    "compile_time": 0.000474,
                    "planning_time": 0.070695
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.130752,
                    "execution_time": 0.038286,
                    "compile_time": 0.000463,
                    "planning_time": 0.071553
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0               112888.91*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE \n              ws_item_sk = i_item_sk \n          and d_date between '1998-02-02' and\n                             dateadd(day,90,cast('1998-02-02' as date))\n          and d_date_sk = ws_sold_date_sk \n/*CURSOR_IDENTIFIER*/\n         )",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"WS_SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"WS_ITEM_SK\" , \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" AS \"WS_EXT_DISCOUNT_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"WS_SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"WS_ITEM_SK\" , \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" AS \"WS_EXT_DISCOUNT_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.579227,
                    "execution_time": 0.303908,
                    "compile_time": 0.000258,
                    "planning_time": 0.026996,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.646007,
                    "execution_time": 0.300268,
                    "compile_time": 0.00025,
                    "planning_time": 0.089165,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0                97926.74*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.129469,
                    "execution_time": 0.036093,
                    "compile_time": 0.000441,
                    "planning_time": 0.072032
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.203324,
                    "execution_time": 0.03543,
                    "compile_time": 0.001503,
                    "planning_time": 0.14433
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0                97926.74*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE \n              ws_item_sk = i_item_sk \n          and d_date between '1998-02-02' and\n                             dateadd(day,90,cast('1998-02-02' as date))\n          and d_date_sk = ws_sold_date_sk \n      ) \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"WS_SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"WS_ITEM_SK\" , \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" AS \"WS_EXT_DISCOUNT_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK ) LIMIT 21",
                "preview": "\n/*   excess discount amount\n0                97926.74*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.128867,
                    "execution_time": 0.034405,
                    "compile_time": 0.000463,
                    "planning_time": 0.072307
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.126049,
                    "execution_time": 0.034182,
                    "compile_time": 0.000454,
                    "planning_time": 0.070237
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0                97926.74*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE \n              ws_item_sk = i_item_sk \n          and d_date between '1998-02-02' and\n                             dateadd(day,90,cast('1998-02-02' as date))\n          and d_date_sk = ws_sold_date_sk \n      ) \norder by sum(ws_ext_discount_amt)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"WS_SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"WS_ITEM_SK\" , \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" AS \"WS_EXT_DISCOUNT_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ORDER BY SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK ) ORDER BY SUM ( WS_EXT_DISCOUNT_AMT ) NULLS FIRST LIMIT 21",
                "preview": "\n/*   excess discount amount\n0                97926.74*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.131207,
                    "execution_time": 0.035101,
                    "compile_time": 0.000437,
                    "planning_time": 0.074773
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.204352,
                    "execution_time": 0.035906,
                    "compile_time": 0.000462,
                    "planning_time": 0.146862
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0                97926.74*/"
    },
    {
        "input": "-- start template query92.tpl query 44 in stream 0\nselect /* TPC-DS query92.tpl 0.44 */  \n   sum(ws_ext_discount_amt)  as \"Excess Discount Amount\" \nfrom \n    web_sales \n   ,item \n   ,date_dim\nwhere\ni_manufact_id = 992\nand i_item_sk = ws_item_sk \nand d_date between '1998-02-02' and \n        dateadd(day,90,cast('1998-02-02' as date))\nand d_date_sk = ws_sold_date_sk \nand ws_ext_discount_amt  \n     > ( \n         SELECT \n            1.3 * avg(ws_ext_discount_amt) \n         FROM \n            web_sales \n           ,date_dim\n         WHERE \n              ws_item_sk = i_item_sk \n          and d_date between '1998-02-02' and\n                             dateadd(day,90,cast('1998-02-02' as date))\n          and d_date_sk = ws_sold_date_sk \n      ) \norder by sum(ws_ext_discount_amt)\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"WEB_SALES_2\" AS ( SELECT \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"WS_SOLD_DATE_SK\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"WS_ITEM_SK\" , \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" AS \"WS_EXT_DISCOUNT_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 90 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-02-02' AS DATE ) ) , \"_U_0\" AS ( SELECT 1.3 * AVG ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"_COL_0\" , \"WEB_SALES\".\"WS_ITEM_SK\" AS \"_U_1\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"WEB_SALES\".\"WS_ITEM_SK\" ) SELECT SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"EXCESS DISCOUNT AMOUNT\" FROM \"WEB_SALES_2\" AS \"WEB_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"ITEM\".\"I_MANUFACT_ID\" = 992 LEFT JOIN \"_U_0\" AS \"_U_0\" ON \"_U_0\".\"_U_1\" = \"ITEM\".\"I_ITEM_SK\" WHERE \"_U_0\".\"_COL_0\" < \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ORDER BY SUM ( \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT SUM ( WS_EXT_DISCOUNT_AMT ) AS \"EXCESS DISCOUNT AMOUNT\" FROM WEB_SALES , ITEM , DATE_DIM WHERE I_MANUFACT_ID = 992 AND I_ITEM_SK = WS_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK AND WS_EXT_DISCOUNT_AMT > ( SELECT 1.3 * AVG ( WS_EXT_DISCOUNT_AMT ) FROM WEB_SALES , DATE_DIM WHERE WS_ITEM_SK = I_ITEM_SK AND D_DATE BETWEEN '1998-02-02' AND DATEADD ( DAY , 90 , CAST ( '1998-02-02' AS DATE ) ) AND D_DATE_SK = WS_SOLD_DATE_SK ) ORDER BY SUM ( WS_EXT_DISCOUNT_AMT ) NULLS FIRST LIMIT 21",
                "preview": "\n/*   excess discount amount\n0                97926.74*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.12841,
                    "execution_time": 0.033971,
                    "compile_time": 0.000457,
                    "planning_time": 0.073153
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.128729,
                    "execution_time": 0.03606,
                    "compile_time": 0.000465,
                    "planning_time": 0.071269
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   excess discount amount\n0                97926.74*/"
    }
]