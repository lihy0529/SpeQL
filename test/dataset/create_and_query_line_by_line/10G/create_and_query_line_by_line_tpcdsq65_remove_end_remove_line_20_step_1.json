[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n/*CURSOR_IDENTIFIER*/ \n    where ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217 + 11\n    group by ss_store_sk, ss_item_sk) sc\nwhere s_store_sk = sc.ss_store_sk\n  and i_item_sk = sc.ss_item_sk\n  and s_store_sk = sb.ss_store_sk\n  and sc.revenue <= 0.1 * sb.ave\norder by s_store_name, i_item_desc;",
        "optimize": [
            "SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.666014,
                    "execution_time": 0.367737,
                    "compile_time": 0.000379,
                    "planning_time": 0.034938,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.743268,
                    "execution_time": 0.370212,
                    "compile_time": 0.001241,
                    "planning_time": 0.103608,
                    "create_size": 768
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"REVENUE\" AS \"REVENUE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*    ss_store_sk  ss_item_sk  revenue\n0            56        4679   120.39\n1            94       97861     8.23\n2           100        9105   151.33\n3           100       62441    96.04\n4           100       69711   188.63\n5            64       28185   111.05\n6            13       28459    71.57\n7            16       76597    25.77\n8            16       57465    66.45\n9            16       99955   119.08\n10           16       75689   187.92\n11            8       90419   201.09\n12           16       88587     0.89\n13           16       29017    99.32\n14           40       80497   204.50\n15           40       37543   228.41\n16           40       13735    61.44\n17           46       52005   117.86\n18           46       38825    60.35\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017132,
                    "execution_time": 0.007722,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003383
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055898,
                    "execution_time": 0.007817,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038748
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\", \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\", SUM(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"REVENUE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 GROUP BY \"STORE_SALES\".\"SS_STORE_SK\", \"STORE_SALES\".\"SS_ITEM_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"SPEQLITE_TEMP_TABLE_1\".\"REVENUE\" AS \"REVENUE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*    ss_store_sk  ss_item_sk  revenue\n0            56        4679   120.39\n1            94       97861     8.23\n2           100        9105   151.33\n3           100       62441    96.04\n4           100       69711   188.63\n5            64       28185   111.05\n6            13       28459    71.57\n7            16       76597    25.77\n8            16       57465    66.45\n9            16       99955   119.08\n10           16       75689   187.92\n11            8       90419   201.09\n12           16       88587     0.89\n13           16       29017    99.32\n14           40       80497   204.50\n15           40       37543   228.41\n16           40       13735    61.44\n17           46       52005   117.86\n18           46       38825    60.35\n...*/"
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store s, item i,\n     (select sa.ss_store_sk, avg(sa.revenue) as ave\n \tfrom\n \t    (select ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by sa.ss_store_sk) sb,\n     (select ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n    group by ss_store_sk, ss_item_sk) sc\nwhere s.s_store_sk = sb.ss_store_sk\n    and s.s_store_sk = sc.ss_store_sk\n    and i.i_item_sk = sc.ss_item_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SA\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SB\" AS ( SELECT \"SA\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"SA\" AS \"SA\" GROUP BY \"SA\".\"SS_STORE_SK\" ) , \"SC\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) SELECT \"S\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"I\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"I\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"I\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"S\" JOIN \"SB\" AS \"SB\" ON \"S\".\"S_STORE_SK\" = \"SB\".\"SS_STORE_SK\" JOIN \"SC\" AS \"SC\" ON \"S\".\"S_STORE_SK\" = \"SC\".\"SS_STORE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.081027,
                    "execution_time": 0.031631,
                    "compile_time": 0.000242,
                    "planning_time": 0.02522,
                    "create_size": 20
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.145303,
                    "execution_time": 0.032812,
                    "compile_time": 0.000248,
                    "planning_time": 0.088023,
                    "create_size": 20
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.396045,
                    "execution_time": 0.302411,
                    "compile_time": 0.000347,
                    "planning_time": 0.026041,
                    "create_size": 512
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.488976,
                    "execution_time": 0.322008,
                    "compile_time": 0.001294,
                    "planning_time": 0.092563,
                    "create_size": 512
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" GROUP BY \"SPEQLITE_TEMP_TABLE_3\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.067832,
                    "execution_time": 0.040578,
                    "compile_time": 0.000258,
                    "planning_time": 0.003189,
                    "create_size": 156
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.127404,
                    "execution_time": 0.041139,
                    "compile_time": 0.000241,
                    "planning_time": 0.059567,
                    "create_size": 156
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.674106,
                    "execution_time": 0.382413,
                    "compile_time": 0.000377,
                    "planning_time": 0.028031,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.712174,
                    "execution_time": 0.366284,
                    "compile_time": 0.000359,
                    "planning_time": 0.088781,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"S\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"I\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_5\".\"REVENUE\" AS \"REVENUE\" , \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"I\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"I\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"S\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"S\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"S\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_STORE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.304744,
                    "execution_time": 0.599494,
                    "compile_time": 0.079067,
                    "planning_time": 0.035624,
                    "create_size": 1362
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.368299,
                    "execution_time": 1.317233,
                    "compile_time": 3.323381,
                    "planning_time": 0.115751,
                    "create_size": 1359
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_6\".\"REVENUE\" AS \"REVENUE\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*   s_store_name                                                                                                                                                                                       i_item_desc  revenue  i_current_price  i_wholesale_cost               i_brand\n0          able                                                                                                     Strong, possible votes find also; again past children injure facts. True, royal taxes say. So   330.79             2.09              1.73     importoexporti #2\n1          able  Years spread also effective, academic responsibilities; significant, free funds shall not sell new years. Products see in a holes. Possible careers could not start still also cold proceedings.   218.21             0.21              1.46       amalgscholar #2\n2          able                                                                                                              Interesting, large things can perform better rewards. Classical sciences offer often   224.48             5.35             42.42           maxicorp #2\n3          able                                                                                                              Long psychiatric classes feel always in the relatives. Causes could fly so so formal   229.37             1.81              1.44      edu packamalg #2\n4          able                                                                                                                                                                       Possible accidents shall mi    51.63             3.95              1.42    edu packimporto #2\n5           pri                                                                                                                                                          Normal, true difficulties may show there    85.15            39.86              3.15     importoexporti #2\n6           pri                                                    True, spiritual uses choose there rural rights. Major issues shall not remain well much strict instruments. Blank times might not advise fully     3.80             0.45              0.34     importoimporto #2\n7           pri                                                                                                                           Inevitable plants light in a appointments. Important, bold pictures mea   105.22            44.33             36.79       corpnameless #4\n8           bar                                                                                                        Subsidies assume there real villages. Years ask too through a men. Small years adapt here     79.21             5.14              3.23  importoamalgamalg #4\n9           bar                                                                                                                                                                  Interested, different parties ap   145.23            12.08              5.55   edu packedu pack #2\n10          bar                                                                                                                                                               Well steep companies may not say mo     8.99             1.42              0.48       importoamalg #2\n11          bar                                                                  Northern responses could know more within a affairs. Equal savings lay shortly; simple earnings ask occupational, little develop     2.12             2.45              1.22        importocorp #6\n12          bar                                        American, evolutionary circles will sell files. Services increase surely by a functions. Great ways will not deny events. Strong, explicit months see very   186.39             3.11              2.73    importonameless #2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017995,
                    "execution_time": 0.00791,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003801
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056945,
                    "execution_time": 0.008206,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039345
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"S\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"I\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_5\".\"REVENUE\" AS \"REVENUE\" , \"I\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"I\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"I\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"S\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ON \"S\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"SS_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"S\".\"S_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_STORE_SK\" JOIN \"ITEM\" AS \"I\" ON \"I\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_6\".\"REVENUE\" AS \"REVENUE\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"SPEQLITE_TEMP_TABLE_6\".\"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*   s_store_name                                                                                                                                                                                       i_item_desc  revenue  i_current_price  i_wholesale_cost               i_brand\n0          able                                                                                                     Strong, possible votes find also; again past children injure facts. True, royal taxes say. So   330.79             2.09              1.73     importoexporti #2\n1          able  Years spread also effective, academic responsibilities; significant, free funds shall not sell new years. Products see in a holes. Possible careers could not start still also cold proceedings.   218.21             0.21              1.46       amalgscholar #2\n2          able                                                                                                              Interesting, large things can perform better rewards. Classical sciences offer often   224.48             5.35             42.42           maxicorp #2\n3          able                                                                                                              Long psychiatric classes feel always in the relatives. Causes could fly so so formal   229.37             1.81              1.44      edu packamalg #2\n4          able                                                                                                                                                                       Possible accidents shall mi    51.63             3.95              1.42    edu packimporto #2\n5           pri                                                                                                                                                          Normal, true difficulties may show there    85.15            39.86              3.15     importoexporti #2\n6           pri                                                    True, spiritual uses choose there rural rights. Major issues shall not remain well much strict instruments. Blank times might not advise fully     3.80             0.45              0.34     importoimporto #2\n7           pri                                                                                                                           Inevitable plants light in a appointments. Important, bold pictures mea   105.22            44.33             36.79       corpnameless #4\n8           bar                                                                                                        Subsidies assume there real villages. Years ask too through a men. Small years adapt here     79.21             5.14              3.23  importoamalgamalg #4\n9           bar                                                                                                                                                                  Interested, different parties ap   145.23            12.08              5.55   edu packedu pack #2\n10          bar                                                                                                                                                               Well steep companies may not say mo     8.99             1.42              0.48       importoamalg #2\n11          bar                                                                  Northern responses could know more within a affairs. Equal savings lay shortly; simple earnings ask occupational, little develop     2.12             2.45              1.22        importocorp #6\n12          bar                                        American, evolutionary circles will sell files. Services increase surely by a functions. Great ways will not deny events. Strong, explicit months see very   186.39             3.11              2.73    importonameless #2\n...*/"
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SC\" AS ( SELECT SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"SC\" AS \"SC\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT S_STORE_NAME , I_ITEM_DESC , SC.REVENUE , I_CURRENT_PRICE , I_WHOLESALE_COST , I_BRAND FROM STORE , ITEM , ( SELECT SS_STORE_SK , AVG ( REVENUE ) AS AVE FROM ( SELECT SS_STORE_SK , SS_ITEM_SK , SUM ( SS_SALES_PRICE ) AS REVENUE FROM STORE_SALES , DATE_DIM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_MONTH_SEQ BETWEEN 1217 AND 1217 + 11 GROUP BY SS_STORE_SK , SS_ITEM_SK ) AS SA GROUP BY SS_STORE_SK ) AS SB , ( SELECT SS_STORE_SK , SS_ITEM_SK , SUM ( SS_SALES_PRICE ) AS REVENUE FROM STORE_SALES , DATE_DIM WHERE SS_SOLD_DATE_SK = D_DATE_SK AND D_MONTH_SEQ BETWEEN 1217 AND 1217 + 11 GROUP BY SS_STORE_SK , SS_ITEM_SK ) AS SC LIMIT 21",
                "preview": "\n/*   s_store_name                                         i_item_desc  revenue  i_current_price  i_wholesale_cost            i_brand\n0         ought  Teachers carry by the children; old democrats enco    81.84             2.57              0.59  importoscholar #2\n1         ought  Teachers carry by the children; old democrats enco    33.62             2.57              0.59  importoscholar #2\n2         ought  Teachers carry by the children; old democrats enco    81.87             2.57              0.59  importoscholar #2\n3         ought  Teachers carry by the children; old democrats enco   238.98             2.57              0.59  importoscholar #2\n4         ought  Teachers carry by the children; old democrats enco   171.87             2.57              0.59  importoscholar #2\n5         ought  Teachers carry by the children; old democrats enco    76.46             2.57              0.59  importoscholar #2\n6         ought  Teachers carry by the children; old democrats enco   201.15             2.57              0.59  importoscholar #2\n7         ought  Teachers carry by the children; old democrats enco   150.74             2.57              0.59  importoscholar #2\n8         ought  Teachers carry by the children; old democrats enco   196.41             2.57              0.59  importoscholar #2\n9         ought  Teachers carry by the children; old democrats enco    37.38             2.57              0.59  importoscholar #2\n10        ought  Teachers carry by the children; old democrats enco   162.00             2.57              0.59  importoscholar #2\n11        ought  Teachers carry by the children; old democrats enco   190.09             2.57              0.59  importoscholar #2\n12        ought  Teachers carry by the children; old democrats enco   245.48             2.57              0.59  importoscholar #2\n13        ought  Teachers carry by the children; old democrats enco    60.03             2.57              0.59  importoscholar #2\n14        ought  Teachers carry by the children; old democrats enco   147.34             2.57              0.59  importoscholar #2\n15        ought  Teachers carry by the children; old democrats enco    47.10             2.57              0.59  importoscholar #2\n16        ought  Teachers carry by the children; old democrats enco    57.38             2.57              0.59  importoscholar #2\n17        ought  Teachers carry by the children; old democrats enco   328.19             2.57              0.59  importoscholar #2\n18        ought  Teachers carry by the children; old democrats enco   142.85             2.57              0.59  importoscholar #2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.405002,
                    "execution_time": 0.327214,
                    "compile_time": 0.000421,
                    "planning_time": 0.056097
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.504942,
                    "execution_time": 0.334471,
                    "compile_time": 0.005949,
                    "planning_time": 0.141961
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*   s_store_name                                         i_item_desc  revenue  i_current_price  i_wholesale_cost            i_brand\n0         ought  Teachers carry by the children; old democrats enco    81.84             2.57              0.59  importoscholar #2\n1         ought  Teachers carry by the children; old democrats enco    33.62             2.57              0.59  importoscholar #2\n2         ought  Teachers carry by the children; old democrats enco    81.87             2.57              0.59  importoscholar #2\n3         ought  Teachers carry by the children; old democrats enco   238.98             2.57              0.59  importoscholar #2\n4         ought  Teachers carry by the children; old democrats enco   171.87             2.57              0.59  importoscholar #2\n5         ought  Teachers carry by the children; old democrats enco    76.46             2.57              0.59  importoscholar #2\n6         ought  Teachers carry by the children; old democrats enco   201.15             2.57              0.59  importoscholar #2\n7         ought  Teachers carry by the children; old democrats enco   150.74             2.57              0.59  importoscholar #2\n8         ought  Teachers carry by the children; old democrats enco   196.41             2.57              0.59  importoscholar #2\n9         ought  Teachers carry by the children; old democrats enco    37.38             2.57              0.59  importoscholar #2\n10        ought  Teachers carry by the children; old democrats enco   162.00             2.57              0.59  importoscholar #2\n11        ought  Teachers carry by the children; old democrats enco   190.09             2.57              0.59  importoscholar #2\n12        ought  Teachers carry by the children; old democrats enco   245.48             2.57              0.59  importoscholar #2\n13        ought  Teachers carry by the children; old democrats enco    60.03             2.57              0.59  importoscholar #2\n14        ought  Teachers carry by the children; old democrats enco   147.34             2.57              0.59  importoscholar #2\n15        ought  Teachers carry by the children; old democrats enco    47.10             2.57              0.59  importoscholar #2\n16        ought  Teachers carry by the children; old democrats enco    57.38             2.57              0.59  importoscholar #2\n17        ought  Teachers carry by the children; old democrats enco   328.19             2.57              0.59  importoscholar #2\n18        ought  Teachers carry by the children; old democrats enco   142.85             2.57              0.59  importoscholar #2\n...*/"
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and sc.ss_item_sk = sc.ss_item_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SA\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SB\" AS ( SELECT \"SA\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" FROM \"SA\" AS \"SA\" GROUP BY \"SA\".\"SS_STORE_SK\" ) , \"SC\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"SB\" AS \"SB\" JOIN \"SC\" AS \"SC\" ON \"SB\".\"SS_STORE_SK\" = \"SC\".\"SS_STORE_SK\" AND \"SC\".\"SS_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_5\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_4\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_5\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_4\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_5\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_4\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\"",
                "rewrite": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_5\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" JOIN \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" ON \"SPEQLITE_TEMP_TABLE_4\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_5\".\"SS_ITEM_SK\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and \n       sc.revenue <= 0.1 * sb.ave and\n      sc.ss_item_sk = sc.ss_item_sk\n      and store.s_store_sk = sb.ss_store_sk\n      and item.i_item_sk = sc.ss_item_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"STORE_SALES_2\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"SS_SALES_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SA\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SB\" AS ( SELECT \"SA\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , AVG ( \"SA\".\"REVENUE\" ) AS \"AVE\" FROM \"SA\" AS \"SA\" GROUP BY \"SA\".\"SS_STORE_SK\" ) , \"SC\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SB\" AS \"SB\" ON \"SB\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"SC\" AS \"SC\" ON \"SB\".\"SS_STORE_SK\" = \"SC\".\"SS_STORE_SK\" AND \"SC\".\"REVENUE\" <= 0.1 * \"SB\".\"AVE\" AND \"SC\".\"SS_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"SS_SALES_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.00431,
                    "execution_time": 0.712008,
                    "compile_time": 0.00026,
                    "planning_time": 0.023325,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.093782,
                    "execution_time": 0.730027,
                    "compile_time": 0.000264,
                    "planning_time": 0.086553,
                    "create_size": 1024
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.615901,
                    "execution_time": 0.405384,
                    "compile_time": 0.000349,
                    "planning_time": 0.005597,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.662683,
                    "execution_time": 0.38719,
                    "compile_time": 0.002168,
                    "planning_time": 0.063811,
                    "create_size": 640
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"SPEQLITE_TEMP_TABLE_8\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , AVG ( \"SPEQLITE_TEMP_TABLE_8\".\"REVENUE\" ) AS \"AVE\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" GROUP BY \"SPEQLITE_TEMP_TABLE_8\".\"SS_STORE_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.083452,
                    "execution_time": 0.043429,
                    "compile_time": 0.000281,
                    "planning_time": 0.003697,
                    "create_size": 195
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.364798,
                    "execution_time": 0.043603,
                    "compile_time": 0.23311,
                    "planning_time": 0.060661,
                    "create_size": 195
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"STORE_SALES\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.670423,
                    "execution_time": 0.408124,
                    "compile_time": 0.000362,
                    "planning_time": 0.005567,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.73312,
                    "execution_time": 0.411916,
                    "compile_time": 0.002177,
                    "planning_time": 0.064167,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_9\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" <= 0.1 * \"SPEQLITE_TEMP_TABLE_9\".\"AVE\" AND \"SPEQLITE_TEMP_TABLE_10\".\"SS_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_ITEM_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.942783,
                    "execution_time": 0.150424,
                    "compile_time": 0.156128,
                    "planning_time": 0.040321,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.346861,
                    "execution_time": 0.27635,
                    "compile_time": 6.35689,
                    "planning_time": 0.106235,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_11\".\"REVENUE\" AS \"REVENUE\" , \"SPEQLITE_TEMP_TABLE_11\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_11\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"SPEQLITE_TEMP_TABLE_11\".\"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   s_store_name                                                                                                                                                                                         i_item_desc  revenue  i_current_price  i_wholesale_cost                i_brand\n0          able                                                                                                                             Possibly existing minutes operate also. Systems cope standards. As pers     4.27             4.85              2.08          brandmaxi #10\n1           ese                       Sexual notes date. Remaining films disturb. High days ought to go and so on with a skills. Questions might not see large vehicles. Strong, final reasons appreciate just majo     0.00             1.02              0.68     edu packscholar #1\n2           pri                                                                                                                                                                              Whole, random feet oug     6.80             7.29              4.30    scholarunivamalg #7\n3         cally                                                                                                                                   So good workers allow even out of a universities. Workers used to     3.36             2.10             27.37      exportischolar #1\n4          n st                                                                      Corporate, public police can offer today with the policies. Too other powers should not hide very logical, local things. Short     7.50             9.95             33.14   importounivamalg #17\n5           ese                                                                                                               Local acids might not create. Texts assume easily now terrible students. Enough small     2.91             4.08              3.14        amalgscholar #2\n6         ought                                                                                                     Now similar sales may visit exactly glorious islands. Leading carers seem still documents. Shy,     0.12             4.80              4.17    importounivamalg #2\n7         ation                                                                                                                                                           Then chief movements spend fully into a m     2.72             9.33              5.31        amalgimporto #2\n8           pri                                                                                                                                                                                                  Ol     4.75             5.86              4.51     exportiedu pack #2\n9           pri                              Able, other politicians get either institutions; for example busy equations supply ever old banks; soviet, right books could not reply thanks to the roads. Old limits     4.58             9.79              3.56     exportiedu pack #2\n10        ation                                                                                                                                                                       Indeed other articles find. A     7.53             8.68              4.34     importoedu pack #2\n11          bar                                                                                                    Usually dark materials would ask times. Particularly main workers serve up a forms. Aware manufa     2.37             5.99              2.51       amalgedu pack #2\n12        ought                                                                                                                                          Common eyes will develop actually successful forces; home      4.23             9.04              0.77          amalgamalg #1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017625,
                    "execution_time": 0.007547,
                    "compile_time": 5e-05,
                    "planning_time": 0.003817
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056738,
                    "execution_time": 0.007718,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.039441
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_9\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" <= 0.1 * \"SPEQLITE_TEMP_TABLE_9\".\"AVE\" AND \"SPEQLITE_TEMP_TABLE_10\".\"SS_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_ITEM_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_ITEM_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_11\".\"REVENUE\" AS \"REVENUE\" , \"SPEQLITE_TEMP_TABLE_11\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_11\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"SPEQLITE_TEMP_TABLE_11\".\"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   s_store_name                                                                                                                                                                                         i_item_desc  revenue  i_current_price  i_wholesale_cost                i_brand\n0          able                                                                                                                             Possibly existing minutes operate also. Systems cope standards. As pers     4.27             4.85              2.08          brandmaxi #10\n1           ese                       Sexual notes date. Remaining films disturb. High days ought to go and so on with a skills. Questions might not see large vehicles. Strong, final reasons appreciate just majo     0.00             1.02              0.68     edu packscholar #1\n2           pri                                                                                                                                                                              Whole, random feet oug     6.80             7.29              4.30    scholarunivamalg #7\n3         cally                                                                                                                                   So good workers allow even out of a universities. Workers used to     3.36             2.10             27.37      exportischolar #1\n4          n st                                                                      Corporate, public police can offer today with the policies. Too other powers should not hide very logical, local things. Short     7.50             9.95             33.14   importounivamalg #17\n5           ese                                                                                                               Local acids might not create. Texts assume easily now terrible students. Enough small     2.91             4.08              3.14        amalgscholar #2\n6         ought                                                                                                     Now similar sales may visit exactly glorious islands. Leading carers seem still documents. Shy,     0.12             4.80              4.17    importounivamalg #2\n7         ation                                                                                                                                                           Then chief movements spend fully into a m     2.72             9.33              5.31        amalgimporto #2\n8           pri                                                                                                                                                                                                  Ol     4.75             5.86              4.51     exportiedu pack #2\n9           pri                              Able, other politicians get either institutions; for example busy equations supply ever old banks; soviet, right books could not reply thanks to the roads. Old limits     4.58             9.79              3.56     exportiedu pack #2\n10        ation                                                                                                                                                                       Indeed other articles find. A     7.53             8.68              4.34     importoedu pack #2\n11          bar                                                                                                    Usually dark materials would ask times. Particularly main workers serve up a forms. Aware manufa     2.37             5.99              2.51       amalgedu pack #2\n12        ought                                                                                                                                          Common eyes will develop actually successful forces; home      4.23             9.04              0.77          amalgamalg #1\n...*/"
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and \n       sc.revenue <= 0.1 * sb.ave and\n       store.s_store_sk = sc.ss_store_sk and\n      item.i_item_sk = sc.ss_item_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"STORE_SALES_2\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"SS_SALES_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SC\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SA\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SB\" AS ( SELECT \"SA\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , AVG ( \"SA\".\"REVENUE\" ) AS \"AVE\" FROM \"SA\" AS \"SA\" GROUP BY \"SA\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SC\" AS \"SC\" ON \"SC\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\" JOIN \"SB\" AS \"SB\" ON \"SB\".\"SS_STORE_SK\" = \"SC\".\"SS_STORE_SK\" AND \"SC\".\"REVENUE\" <= 0.1 * \"SB\".\"AVE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" <= 0.1 * \"SPEQLITE_TEMP_TABLE_9\".\"AVE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.857693,
                    "execution_time": 0.155609,
                    "compile_time": 0.071144,
                    "planning_time": 0.04378,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.282065,
                    "execution_time": 0.270618,
                    "compile_time": 3.310074,
                    "planning_time": 0.106783,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_12\".\"REVENUE\" AS \"REVENUE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*   s_store_name                                                                                                                                                                                         i_item_desc  revenue  i_current_price  i_wholesale_cost                i_brand\n0          able                                                                                                                             Possibly existing minutes operate also. Systems cope standards. As pers     4.27             4.85              2.08          brandmaxi #10\n1           ese                       Sexual notes date. Remaining films disturb. High days ought to go and so on with a skills. Questions might not see large vehicles. Strong, final reasons appreciate just majo     0.00             1.02              0.68     edu packscholar #1\n2           pri                                                                                                                                                                              Whole, random feet oug     6.80             7.29              4.30    scholarunivamalg #7\n3         cally                                                                                                                                   So good workers allow even out of a universities. Workers used to     3.36             2.10             27.37      exportischolar #1\n4          n st                                                                      Corporate, public police can offer today with the policies. Too other powers should not hide very logical, local things. Short     7.50             9.95             33.14   importounivamalg #17\n5           ese                                                                                                               Local acids might not create. Texts assume easily now terrible students. Enough small     2.91             4.08              3.14        amalgscholar #2\n6         ought                                                                                                     Now similar sales may visit exactly glorious islands. Leading carers seem still documents. Shy,     0.12             4.80              4.17    importounivamalg #2\n7         ation                                                                                                                                                           Then chief movements spend fully into a m     2.72             9.33              5.31        amalgimporto #2\n8           pri                                                                                                                                                                                                  Ol     4.75             5.86              4.51     exportiedu pack #2\n9           pri                              Able, other politicians get either institutions; for example busy equations supply ever old banks; soviet, right books could not reply thanks to the roads. Old limits     4.58             9.79              3.56     exportiedu pack #2\n10        ation                                                                                                                                                                       Indeed other articles find. A     7.53             8.68              4.34     importoedu pack #2\n11          bar                                                                                                    Usually dark materials would ask times. Particularly main workers serve up a forms. Aware manufa     2.37             5.99              2.51       amalgedu pack #2\n12        ought                                                                                                                                          Common eyes will develop actually successful forces; home      4.23             9.04              0.77          amalgamalg #1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017086,
                    "execution_time": 0.007326,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003631
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054768,
                    "execution_time": 0.007722,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.039111
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" <= 0.1 * \"SPEQLITE_TEMP_TABLE_9\".\"AVE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_12\".\"REVENUE\" AS \"REVENUE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*   s_store_name                                                                                                                                                                                         i_item_desc  revenue  i_current_price  i_wholesale_cost                i_brand\n0          able                                                                                                                             Possibly existing minutes operate also. Systems cope standards. As pers     4.27             4.85              2.08          brandmaxi #10\n1           ese                       Sexual notes date. Remaining films disturb. High days ought to go and so on with a skills. Questions might not see large vehicles. Strong, final reasons appreciate just majo     0.00             1.02              0.68     edu packscholar #1\n2           pri                                                                                                                                                                              Whole, random feet oug     6.80             7.29              4.30    scholarunivamalg #7\n3         cally                                                                                                                                   So good workers allow even out of a universities. Workers used to     3.36             2.10             27.37      exportischolar #1\n4          n st                                                                      Corporate, public police can offer today with the policies. Too other powers should not hide very logical, local things. Short     7.50             9.95             33.14   importounivamalg #17\n5           ese                                                                                                               Local acids might not create. Texts assume easily now terrible students. Enough small     2.91             4.08              3.14        amalgscholar #2\n6         ought                                                                                                     Now similar sales may visit exactly glorious islands. Leading carers seem still documents. Shy,     0.12             4.80              4.17    importounivamalg #2\n7         ation                                                                                                                                                           Then chief movements spend fully into a m     2.72             9.33              5.31        amalgimporto #2\n8           pri                                                                                                                                                                                                  Ol     4.75             5.86              4.51     exportiedu pack #2\n9           pri                              Able, other politicians get either institutions; for example busy equations supply ever old banks; soviet, right books could not reply thanks to the roads. Old limits     4.58             9.79              3.56     exportiedu pack #2\n10        ation                                                                                                                                                                       Indeed other articles find. A     7.53             8.68              4.34     importoedu pack #2\n11          bar                                                                                                    Usually dark materials would ask times. Particularly main workers serve up a forms. Aware manufa     2.37             5.99              2.51       amalgedu pack #2\n12        ought                                                                                                                                          Common eyes will develop actually successful forces; home      4.23             9.04              0.77          amalgamalg #1\n...*/"
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and \n       sc.revenue <= 0.1 * sb.ave and\n       s_store_sk = sc.ss_store_sk and\n       i_item_sk = sc.ss_item_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"STORE_SALES_2\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"SS_SALES_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SC\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SA\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SB\" AS ( SELECT \"SA\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , AVG ( \"SA\".\"REVENUE\" ) AS \"AVE\" FROM \"SA\" AS \"SA\" GROUP BY \"SA\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SC\" AS \"SC\" ON \"SC\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\" JOIN \"SB\" AS \"SB\" ON \"SB\".\"SS_STORE_SK\" = \"SC\".\"SS_STORE_SK\" AND \"SC\".\"REVENUE\" <= 0.1 * \"SB\".\"AVE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"REVENUE\" AS \"REVENUE\" , \"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" LIMIT 21",
                "preview": "\n/*   s_store_name                                                                                                                                                                                         i_item_desc  revenue  i_current_price  i_wholesale_cost                i_brand\n0         ought                                               Rapid, cognitive reactions supply automatically members. White letters draw always old, particular definitions. Similarly old books think so slow wat     1.29             7.46              3.42      exportiexporti #2\n1          eing  As huge types see conservative, main years. As it were separate groups may not lift soon on a studies. Dependent, due aspects shall count just environmental, national years. Damages shall allow      0.81            77.79             65.34      importoimporto #2\n2          n st                                                                                          Requests might name good servants. Present types stay much aims. Long, major animals shall not improve ide     0.78            31.15              0.43       amalgedu pack #2\n3           ese                                                             Outstanding shots would not free meanwhile easy wounds. For instance sole women will study low lacking social years; good colours feel      6.87             6.90              2.53     scholarnameless #8\n4         ought                                                            Different years will remain liable, italian countries. Small children support general, bad firms. Strong children may sign again consequ     0.52             1.34              0.71     univamalgamalg #12\n5         ation                                                                                                                                                   Outer, complete improvements could not fancy well     5.86             6.03              4.76     exportinameless #8\n6          eing                                            Relevant years develop apparent, english stages. Young eyes lift sometimes at the complaints; high, initial funds should not protect certainly full, ann     5.81             4.45              0.21     edu packscholar #2\n7          able                         Rates laugh technical members. Likely, large settings discuss provisions. Neither political details lead. Then physical bodies should win that however rapid profits. Argum     3.42             2.61              1.07    exportiunivamalg #2\n8           ese                                                                                                                                                                                             Main, i     5.43             6.08              1.86     scholarnameless #8\n9         cally                                                            Under aware facilities would form lists. Mass, high targets can break then open paintings. Invisible hands would not distinguish also co     6.93             2.97              1.00          amalgamalg #2\n10         able                              Results must know so easy, popular services. Large, british organisations give. Complete police used to achieve already; cities come bad buildings. Relations get circ     2.72             2.98              4.51          amalgamalg #2\n11        cally                                           Passive actions used to face more. Institutions could see to the dreams. Points could not increase much flights. High, thin effects must not appear full      6.84             4.95              1.53        exportiamalg #1\n12         eing                                                                                  Ready, irrelevant planes hire eyes. Always considerable traders may aid sincerely central single experiences. Over     3.25             4.60              3.31       edu packamalg #1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.01697,
                    "execution_time": 0.007378,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003447
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052816,
                    "execution_time": 0.007866,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.038784
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" <= 0.1 * \"SPEQLITE_TEMP_TABLE_9\".\"AVE\"",
                "rewrite": "SELECT \"S_STORE_NAME\" AS \"S_STORE_NAME\", \"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"REVENUE\" AS \"REVENUE\", \"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", \"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\", \"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\""
            }
        ],
        "preview": "\n/*   s_store_name                                                                                                                                                                                         i_item_desc  revenue  i_current_price  i_wholesale_cost                i_brand\n0         ought                                               Rapid, cognitive reactions supply automatically members. White letters draw always old, particular definitions. Similarly old books think so slow wat     1.29             7.46              3.42      exportiexporti #2\n1          eing  As huge types see conservative, main years. As it were separate groups may not lift soon on a studies. Dependent, due aspects shall count just environmental, national years. Damages shall allow      0.81            77.79             65.34      importoimporto #2\n2          n st                                                                                          Requests might name good servants. Present types stay much aims. Long, major animals shall not improve ide     0.78            31.15              0.43       amalgedu pack #2\n3           ese                                                             Outstanding shots would not free meanwhile easy wounds. For instance sole women will study low lacking social years; good colours feel      6.87             6.90              2.53     scholarnameless #8\n4         ought                                                            Different years will remain liable, italian countries. Small children support general, bad firms. Strong children may sign again consequ     0.52             1.34              0.71     univamalgamalg #12\n5         ation                                                                                                                                                   Outer, complete improvements could not fancy well     5.86             6.03              4.76     exportinameless #8\n6          eing                                            Relevant years develop apparent, english stages. Young eyes lift sometimes at the complaints; high, initial funds should not protect certainly full, ann     5.81             4.45              0.21     edu packscholar #2\n7          able                         Rates laugh technical members. Likely, large settings discuss provisions. Neither political details lead. Then physical bodies should win that however rapid profits. Argum     3.42             2.61              1.07    exportiunivamalg #2\n8           ese                                                                                                                                                                                             Main, i     5.43             6.08              1.86     scholarnameless #8\n9         cally                                                            Under aware facilities would form lists. Mass, high targets can break then open paintings. Invisible hands would not distinguish also co     6.93             2.97              1.00          amalgamalg #2\n10         able                              Results must know so easy, popular services. Large, british organisations give. Complete police used to achieve already; cities come bad buildings. Relations get circ     2.72             2.98              4.51          amalgamalg #2\n11        cally                                           Passive actions used to face more. Institutions could see to the dreams. Points could not increase much flights. High, thin effects must not appear full      6.84             4.95              1.53        exportiamalg #1\n12         eing                                                                                  Ready, irrelevant planes hire eyes. Always considerable traders may aid sincerely central single experiences. Over     3.25             4.60              3.31       edu packamalg #1\n...*/"
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and \n       sc.revenue <= 0.1 * sb.ave and\n       s_store_sk = sc.ss_store_sk and\n       i_item_sk = sc.ss_item_sk\n order by s_store_name, i_item_desc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"STORE_SALES_2\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"SS_SALES_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SC\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SA\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SB\" AS ( SELECT \"SA\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , AVG ( \"SA\".\"REVENUE\" ) AS \"AVE\" FROM \"SA\" AS \"SA\" GROUP BY \"SA\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SC\" AS \"SC\" ON \"SC\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\" JOIN \"SB\" AS \"SB\" ON \"SB\".\"SS_STORE_SK\" = \"SC\".\"SS_STORE_SK\" AND \"SC\".\"REVENUE\" <= 0.1 * \"SB\".\"AVE\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_12\".\"REVENUE\" AS \"REVENUE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"S_STORE_NAME\" , \"I_ITEM_DESC\" LIMIT 21",
                "preview": "\n/*   s_store_name i_item_desc  revenue  i_current_price  i_wholesale_cost               i_brand\n0          able                 2.54              NaN              2.91       amalgimporto #2\n1          able                 5.84             5.12              2.15         amalgbrand #4\n2          able                 2.25             2.58              1.67                      \n3          able                 1.88             1.97              0.61         amalgbrand #4\n4          able                 3.11             2.32               NaN     exportiimporto #1\n5          able                 0.80             9.99               NaN                      \n6          able                 4.56              NaN              5.07                      \n7          able                 2.35             0.69              0.57    importoedu pack #1\n8          able                 0.63             3.29              2.69                      \n9          able                 2.00            82.97              4.06                      \n10         able                 1.60            82.97              4.06                      \n11         able                 5.47              NaN              0.54                      \n12         able                 0.06             3.82              6.81        importomaxi #6\n13         able                 7.26              NaN              1.46                      \n14         able                 3.89              NaN              1.46                      \n15         able                 1.12              NaN              6.07     exportiimporto #1\n16         able                 6.01             6.00              2.88     importoscholar #1\n17         able                 0.27              NaN               NaN  edu packunivamalg #1\n18         able                 0.79              NaN             44.96           univmaxi #2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021028,
                    "execution_time": 0.010973,
                    "compile_time": 7.1e-05,
                    "planning_time": 0.003966
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.222655,
                    "execution_time": 0.011586,
                    "compile_time": 0.163775,
                    "planning_time": 0.039518
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" <= 0.1 * \"SPEQLITE_TEMP_TABLE_9\".\"AVE\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_12\".\"REVENUE\" AS \"REVENUE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST"
            }
        ],
        "preview": "\n/*   s_store_name i_item_desc  revenue  i_current_price  i_wholesale_cost               i_brand\n0          able                 2.54              NaN              2.91       amalgimporto #2\n1          able                 5.84             5.12              2.15         amalgbrand #4\n2          able                 2.25             2.58              1.67                      \n3          able                 1.88             1.97              0.61         amalgbrand #4\n4          able                 3.11             2.32               NaN     exportiimporto #1\n5          able                 0.80             9.99               NaN                      \n6          able                 4.56              NaN              5.07                      \n7          able                 2.35             0.69              0.57    importoedu pack #1\n8          able                 0.63             3.29              2.69                      \n9          able                 2.00            82.97              4.06                      \n10         able                 1.60            82.97              4.06                      \n11         able                 5.47              NaN              0.54                      \n12         able                 0.06             3.82              6.81        importomaxi #6\n13         able                 7.26              NaN              1.46                      \n14         able                 3.89              NaN              1.46                      \n15         able                 1.12              NaN              6.07     exportiimporto #1\n16         able                 6.01             6.00              2.88     importoscholar #1\n17         able                 0.27              NaN               NaN  edu packunivamalg #1\n18         able                 0.79              NaN             44.96           univmaxi #2\n...*/"
    },
    {
        "input": "-- start template query65.tpl query 71 in stream 0\nselect /* TPC-DS query65.tpl 0.71 */ \n\ts_store_name,\n\ti_item_desc,\n\tsc.revenue,\n\ti_current_price,\n\ti_wholesale_cost,\n\ti_brand\n from store, item,\n     (select ss_store_sk, avg(revenue) as ave\n \tfrom\n \t    (select  ss_store_sk, ss_item_sk, \n \t\t     sum(ss_sales_price) as revenue\n \t\tfrom store_sales, date_dim\n \t\twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \t\tgroup by ss_store_sk, ss_item_sk) sa\n \tgroup by ss_store_sk) sb,\n     (select  ss_store_sk, ss_item_sk, sum(ss_sales_price) as revenue\n \tfrom store_sales, date_dim\n \twhere ss_sold_date_sk = d_date_sk and d_month_seq between 1217 and 1217+11\n \tgroup by ss_store_sk, ss_item_sk) sc\n where sb.ss_store_sk = sc.ss_store_sk and \n       sc.revenue <= 0.1 * sb.ave and\n       s_store_sk = sc.ss_store_sk and\n       i_item_sk = sc.ss_item_sk\n order by s_store_name, i_item_desc\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"STORE_SALES_2\" AS ( SELECT \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"SS_SOLD_DATE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_SALES_PRICE\" AS \"SS_SALES_PRICE\" FROM \"STORE_SALES\" AS \"STORE_SALES\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_MONTH_SEQ\" AS \"D_MONTH_SEQ\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_MONTH_SEQ\" <= 1228 AND \"DATE_DIM\".\"D_MONTH_SEQ\" >= 1217 ) , \"SC\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" AS \"SS_ITEM_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SA\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , SUM ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"REVENUE\" FROM \"STORE_SALES_2\" AS \"STORE_SALES\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_STORE_SK\" , \"STORE_SALES\".\"SS_ITEM_SK\" ) , \"SB\" AS ( SELECT \"SA\".\"SS_STORE_SK\" AS \"SS_STORE_SK\" , AVG ( \"SA\".\"REVENUE\" ) AS \"AVE\" FROM \"SA\" AS \"SA\" GROUP BY \"SA\".\"SS_STORE_SK\" ) SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SC\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SC\" AS \"SC\" ON \"SC\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SC\".\"SS_ITEM_SK\" JOIN \"SB\" AS \"SB\" ON \"SB\".\"SS_STORE_SK\" = \"SC\".\"SS_STORE_SK\" AND \"SC\".\"REVENUE\" <= 0.1 * \"SB\".\"AVE\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_12\".\"REVENUE\" AS \"REVENUE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"S_STORE_NAME\" , \"I_ITEM_DESC\" LIMIT 21",
                "preview": "\n/*   s_store_name i_item_desc  revenue  i_current_price  i_wholesale_cost               i_brand\n0          able                 2.54              NaN              2.91       amalgimporto #2\n1          able                 5.84             5.12              2.15         amalgbrand #4\n2          able                 2.25             2.58              1.67                      \n3          able                 1.88             1.97              0.61         amalgbrand #4\n4          able                 3.11             2.32               NaN     exportiimporto #1\n5          able                 0.80             9.99               NaN                      \n6          able                 4.56              NaN              5.07                      \n7          able                 2.35             0.69              0.57    importoedu pack #1\n8          able                 0.63             3.29              2.69                      \n9          able                 2.00            82.97              4.06                      \n10         able                 1.60            82.97              4.06                      \n11         able                 5.47              NaN              0.54                      \n12         able                 0.06             3.82              6.81        importomaxi #6\n13         able                 7.26              NaN              1.46                      \n14         able                 3.89              NaN              1.46                      \n15         able                 1.12              NaN              6.07     exportiimporto #1\n16         able                 6.01             6.00              2.88     importoscholar #1\n17         able                 0.27              NaN               NaN  edu packunivamalg #1\n18         able                 0.79              NaN             44.96           univmaxi #2\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.021184,
                    "execution_time": 0.011089,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.003926
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.022021,
                    "execution_time": 0.011499,
                    "compile_time": 7.7e-05,
                    "planning_time": 0.004111
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"STORE\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" AS \"REVENUE\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"ITEM\".\"I_BRAND\" AS \"I_BRAND\" FROM \"STORE\" AS \"STORE\" JOIN \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" ON \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" = \"STORE\".\"S_STORE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_ITEM_SK\" JOIN \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" ON \"SPEQLITE_TEMP_TABLE_9\".\"SS_STORE_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_STORE_SK\" AND \"SPEQLITE_TEMP_TABLE_10\".\"REVENUE\" <= 0.1 * \"SPEQLITE_TEMP_TABLE_9\".\"AVE\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_12\".\"S_STORE_NAME\" AS \"S_STORE_NAME\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_12\".\"REVENUE\" AS \"REVENUE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_WHOLESALE_COST\" AS \"I_WHOLESALE_COST\" , \"SPEQLITE_TEMP_TABLE_12\".\"I_BRAND\" AS \"I_BRAND\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" ORDER BY \"S_STORE_NAME\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*   s_store_name i_item_desc  revenue  i_current_price  i_wholesale_cost               i_brand\n0          able                 2.54              NaN              2.91       amalgimporto #2\n1          able                 5.84             5.12              2.15         amalgbrand #4\n2          able                 2.25             2.58              1.67                      \n3          able                 1.88             1.97              0.61         amalgbrand #4\n4          able                 3.11             2.32               NaN     exportiimporto #1\n5          able                 0.80             9.99               NaN                      \n6          able                 4.56              NaN              5.07                      \n7          able                 2.35             0.69              0.57    importoedu pack #1\n8          able                 0.63             3.29              2.69                      \n9          able                 2.00            82.97              4.06                      \n10         able                 1.60            82.97              4.06                      \n11         able                 5.47              NaN              0.54                      \n12         able                 0.06             3.82              6.81        importomaxi #6\n13         able                 7.26              NaN              1.46                      \n14         able                 3.89              NaN              1.46                      \n15         able                 1.12              NaN              6.07     exportiimporto #1\n16         able                 6.01             6.00              2.88     importoscholar #1\n17         able                 0.27              NaN               NaN  edu packunivamalg #1\n18         able                 0.79              NaN             44.96           univmaxi #2\n...*/"
    }
]