[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "select /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n group by i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" GROUP BY \"ITEM\".\"I_ITEM_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and 1=1\n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"ITEM\" AS \"ITEM\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       1=1\n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and 1=1\n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"PROMOTION\" AS \"PROMOTION\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "select /* TPC-DS query7.tpl 0.2 */ i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk\n group by i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.862251,
                    "execution_time": 0.657834,
                    "compile_time": 0.000534,
                    "planning_time": 0.05831,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 9.422379,
                    "execution_time": 2.591497,
                    "compile_time": 6.544833,
                    "planning_time": 0.132398,
                    "create_size": 1024
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAAOMFBAAA    49  75.68  202.80  38.94\n1   AAAAAAAAMGLBBAAA    50  76.30  189.50  36.36\n2   AAAAAAAABNOPAAAA    51  76.20  205.03  40.23\n3   AAAAAAAAMEINAAAA    48  73.03  149.33  36.52\n4   AAAAAAAABNBKAAAA    50  76.70  216.58  38.19\n5   AAAAAAAANMEFAAAA    53  75.53  162.01  37.29\n6   AAAAAAAAGBKGAAAA    49  75.32  227.89  37.54\n7   AAAAAAAAIKLFBAAA    51  80.07  151.00  38.14\n8   AAAAAAAAKDLBAAAA    50  74.34  210.80  37.34\n9   AAAAAAAAPHHHBAAA    50  77.30  267.83  41.18\n10  AAAAAAAAJLACAAAA    49  73.22  163.99  34.89\n11  AAAAAAAALPGOAAAA    50  76.91  155.94  38.75\n12  AAAAAAAAOMODAAAA    51  70.87  193.49  33.98\n13  AAAAAAAABDIHAAAA    50  81.91  189.00  42.13\n14  AAAAAAAAGNGNAAAA    50  70.38  203.56  34.28\n15  AAAAAAAAHIBMAAAA    50  76.45  186.71  38.78\n16  AAAAAAAAIIFNAAAA    49  73.47  194.78  36.10\n17  AAAAAAAAJKHIAAAA    51  76.43  172.54  39.05\n18  AAAAAAAAGECHBAAA    49  76.78  183.93  37.63\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016844,
                    "execution_time": 0.007333,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.003552
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054492,
                    "execution_time": 0.007686,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.039081
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAAOMFBAAA    49  75.68  202.80  38.94\n1   AAAAAAAAMGLBBAAA    50  76.30  189.50  36.36\n2   AAAAAAAABNOPAAAA    51  76.20  205.03  40.23\n3   AAAAAAAAMEINAAAA    48  73.03  149.33  36.52\n4   AAAAAAAABNBKAAAA    50  76.70  216.58  38.19\n5   AAAAAAAANMEFAAAA    53  75.53  162.01  37.29\n6   AAAAAAAAGBKGAAAA    49  75.32  227.89  37.54\n7   AAAAAAAAIKLFBAAA    51  80.07  151.00  38.14\n8   AAAAAAAAKDLBAAAA    50  74.34  210.80  37.34\n9   AAAAAAAAPHHHBAAA    50  77.30  267.83  41.18\n10  AAAAAAAAJLACAAAA    49  73.22  163.99  34.89\n11  AAAAAAAALPGOAAAA    50  76.91  155.94  38.75\n12  AAAAAAAAOMODAAAA    51  70.87  193.49  33.98\n13  AAAAAAAABDIHAAAA    50  81.91  189.00  42.13\n14  AAAAAAAAGNGNAAAA    50  70.38  203.56  34.28\n15  AAAAAAAAHIBMAAAA    50  76.45  186.71  38.78\n16  AAAAAAAAIIFNAAAA    49  73.47  194.78  36.10\n17  AAAAAAAAJKHIAAAA    51  76.43  172.54  39.05\n18  AAAAAAAAGECHBAAA    49  76.78  183.93  37.63\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M'\n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.693881,
                    "execution_time": 0.490931,
                    "compile_time": 0.000521,
                    "planning_time": 0.055316,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.335139,
                    "execution_time": 1.050213,
                    "compile_time": 0.00055,
                    "planning_time": 0.134685,
                    "create_size": 1024
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAADEBOAAAA    49  74.21  224.08  39.35\n1   AAAAAAAAIBNMAAAA    51  79.06  175.24  39.89\n2   AAAAAAAAEPHDAAAA    51  78.45  255.32  39.46\n3   AAAAAAAAECNMAAAA    51  78.99  171.09  40.48\n4   AAAAAAAABOCIAAAA    51  74.26  143.40  37.99\n5   AAAAAAAAAABJAAAA    53  73.33  285.60  36.98\n6   AAAAAAAAPFFMAAAA    50  75.78  238.10  37.90\n7   AAAAAAAAMEEPAAAA    48  79.44  228.41  38.20\n8   AAAAAAAAGDAFAAAA    52  75.50  216.72  37.71\n9   AAAAAAAAEMJDAAAA    52  74.04  188.79  37.23\n10  AAAAAAAABNPOAAAA    49  73.70  174.67  39.87\n11  AAAAAAAAAIBABAAA    50  77.69  211.83  38.82\n12  AAAAAAAAENENAAAA    52  72.62  209.70  36.06\n13  AAAAAAAAPOCDAAAA    49  77.26  237.75  36.78\n14  AAAAAAAAJGMDBAAA    51  79.47  164.41  39.31\n15  AAAAAAAAPEEEBAAA    50  73.14  282.86  34.21\n16  AAAAAAAAFIPMAAAA    52  66.43  161.38  32.86\n17  AAAAAAAACHKBAAAA    50  76.75  272.92  38.88\n18  AAAAAAAAGPKNAAAA    52  78.46  214.84  40.59\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017816,
                    "execution_time": 0.008087,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003659
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052925,
                    "execution_time": 0.007646,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.039101
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAADEBOAAAA    49  74.21  224.08  39.35\n1   AAAAAAAAIBNMAAAA    51  79.06  175.24  39.89\n2   AAAAAAAAEPHDAAAA    51  78.45  255.32  39.46\n3   AAAAAAAAECNMAAAA    51  78.99  171.09  40.48\n4   AAAAAAAABOCIAAAA    51  74.26  143.40  37.99\n5   AAAAAAAAAABJAAAA    53  73.33  285.60  36.98\n6   AAAAAAAAPFFMAAAA    50  75.78  238.10  37.90\n7   AAAAAAAAMEEPAAAA    48  79.44  228.41  38.20\n8   AAAAAAAAGDAFAAAA    52  75.50  216.72  37.71\n9   AAAAAAAAEMJDAAAA    52  74.04  188.79  37.23\n10  AAAAAAAABNPOAAAA    49  73.70  174.67  39.87\n11  AAAAAAAAAIBABAAA    50  77.69  211.83  38.82\n12  AAAAAAAAENENAAAA    52  72.62  209.70  36.06\n13  AAAAAAAAPOCDAAAA    49  77.26  237.75  36.78\n14  AAAAAAAAJGMDBAAA    51  79.47  164.41  39.31\n15  AAAAAAAAPEEEBAAA    50  73.14  282.86  34.21\n16  AAAAAAAAFIPMAAAA    52  66.43  161.38  32.86\n17  AAAAAAAACHKBAAAA    50  76.75  272.92  38.88\n18  AAAAAAAAGPKNAAAA    52  78.46  214.84  40.59\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M' and \n       cd_marital_status = 'M'\n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.503357,
                    "execution_time": 0.299722,
                    "compile_time": 0.000519,
                    "planning_time": 0.056951,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.240931,
                    "execution_time": 0.950156,
                    "compile_time": 0.000537,
                    "planning_time": 0.136144,
                    "create_size": 1024
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAMKFFAAAA    47  81.75  110.71  36.20\n1   AAAAAAAABHPLAAAA    48  74.07  323.63  34.64\n2   AAAAAAAAEOMOAAAA    56  73.23   73.22  32.44\n3   AAAAAAAAKKGEBAAA    50  75.15  106.65  38.12\n4   AAAAAAAACEGEAAAA    52  75.39  326.07  33.37\n5   AAAAAAAAPMPABAAA    44  69.24  128.49  42.27\n6   AAAAAAAAGNKOAAAA    48  77.82  494.09  45.52\n7   AAAAAAAANMADAAAA    51  66.64  228.02  35.48\n8   AAAAAAAAACJBBAAA    43  74.49  150.69  42.56\n9   AAAAAAAABNEDBAAA    49  88.00  162.75  41.25\n10  AAAAAAAAOEALAAAA    51  76.23  374.83  45.92\n11  AAAAAAAAICIHAAAA    53  81.20  417.68  39.88\n12  AAAAAAAAAFGFAAAA    56  96.13  196.07  42.61\n13  AAAAAAAALLDIBAAA    49  76.99  170.34  40.88\n14  AAAAAAAAPFFMAAAA    46  73.41  235.12  34.71\n15  AAAAAAAAKNJCBAAA    46  74.97   47.00  35.04\n16  AAAAAAAACKFFAAAA    49  81.86  106.15  34.73\n17  AAAAAAAAGMOMAAAA    52  75.74   44.83  34.07\n18  AAAAAAAAOHKGBAAA    47  72.01  176.68  30.71\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017049,
                    "execution_time": 0.007454,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.003601
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053883,
                    "execution_time": 0.007791,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039394
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*           i_item_id  agg1   agg2    agg3   agg4\n0   AAAAAAAAMKFFAAAA    47  81.75  110.71  36.20\n1   AAAAAAAABHPLAAAA    48  74.07  323.63  34.64\n2   AAAAAAAAEOMOAAAA    56  73.23   73.22  32.44\n3   AAAAAAAAKKGEBAAA    50  75.15  106.65  38.12\n4   AAAAAAAACEGEAAAA    52  75.39  326.07  33.37\n5   AAAAAAAAPMPABAAA    44  69.24  128.49  42.27\n6   AAAAAAAAGNKOAAAA    48  77.82  494.09  45.52\n7   AAAAAAAANMADAAAA    51  66.64  228.02  35.48\n8   AAAAAAAAACJBBAAA    43  74.49  150.69  42.56\n9   AAAAAAAABNEDBAAA    49  88.00  162.75  41.25\n10  AAAAAAAAOEALAAAA    51  76.23  374.83  45.92\n11  AAAAAAAAICIHAAAA    53  81.20  417.68  39.88\n12  AAAAAAAAAFGFAAAA    56  96.13  196.07  42.61\n13  AAAAAAAALLDIBAAA    49  76.99  170.34  40.88\n14  AAAAAAAAPFFMAAAA    46  73.41  235.12  34.71\n15  AAAAAAAAKNJCBAAA    46  74.97   47.00  35.04\n16  AAAAAAAACKFFAAAA    49  81.86  106.15  34.73\n17  AAAAAAAAGMOMAAAA    52  75.74   44.83  34.07\n18  AAAAAAAAOHKGBAAA    47  72.01  176.68  30.71\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M' and \n       cd_marital_status = 'M' and\n       cd_education_status = '4 yr Degree'\n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.372907,
                    "execution_time": 0.166569,
                    "compile_time": 0.000522,
                    "planning_time": 0.059223,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.035644,
                    "execution_time": 0.741687,
                    "compile_time": 0.000523,
                    "planning_time": 0.140887,
                    "create_size": 1024
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1    agg2    agg3   agg4\n0   AAAAAAAABEJFAAAA    59   70.04    4.50  31.41\n1   AAAAAAAABECAAAAA    49   75.49    0.00  41.52\n2   AAAAAAAAHBHHAAAA    56   43.23   73.27  18.10\n3   AAAAAAAAPMEPAAAA    30   61.36   60.97  38.88\n4   AAAAAAAAONGEAAAA    43   57.04    0.00  13.31\n5   AAAAAAAAKIPABAAA    51   69.37   33.48  19.73\n6   AAAAAAAAGNLABAAA    50   71.77  198.76  31.23\n7   AAAAAAAAPFCAAAAA    29  101.45   16.86  66.71\n8   AAAAAAAAPBGCBAAA    52   82.15  227.42  31.22\n9   AAAAAAAABBPBBAAA    76   84.52  601.39  44.96\n10  AAAAAAAANODKAAAA    61   81.96   42.82  55.49\n11  AAAAAAAAOADOAAAA    38   74.71   53.64  44.12\n12  AAAAAAAADJBJAAAA    43   74.20   16.01  38.06\n13  AAAAAAAAKBCDBAAA    37   93.93  558.56  44.95\n14  AAAAAAAAGDIAAAAA    42   87.99   67.22  58.11\n15  AAAAAAAAEIFAAAAA    57   89.99  613.86  50.48\n16  AAAAAAAAAOFDAAAA    57   54.33  197.53  26.84\n17  AAAAAAAACGAOAAAA    59   72.65    0.00  36.36\n18  AAAAAAAABAJJAAAA    42   80.74   94.42  23.31\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017194,
                    "execution_time": 0.007553,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003608
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056038,
                    "execution_time": 0.008042,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038964
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*           i_item_id  agg1    agg2    agg3   agg4\n0   AAAAAAAABEJFAAAA    59   70.04    4.50  31.41\n1   AAAAAAAABECAAAAA    49   75.49    0.00  41.52\n2   AAAAAAAAHBHHAAAA    56   43.23   73.27  18.10\n3   AAAAAAAAPMEPAAAA    30   61.36   60.97  38.88\n4   AAAAAAAAONGEAAAA    43   57.04    0.00  13.31\n5   AAAAAAAAKIPABAAA    51   69.37   33.48  19.73\n6   AAAAAAAAGNLABAAA    50   71.77  198.76  31.23\n7   AAAAAAAAPFCAAAAA    29  101.45   16.86  66.71\n8   AAAAAAAAPBGCBAAA    52   82.15  227.42  31.22\n9   AAAAAAAABBPBBAAA    76   84.52  601.39  44.96\n10  AAAAAAAANODKAAAA    61   81.96   42.82  55.49\n11  AAAAAAAAOADOAAAA    38   74.71   53.64  44.12\n12  AAAAAAAADJBJAAAA    43   74.20   16.01  38.06\n13  AAAAAAAAKBCDBAAA    37   93.93  558.56  44.95\n14  AAAAAAAAGDIAAAAA    42   87.99   67.22  58.11\n15  AAAAAAAAEIFAAAAA    57   89.99  613.86  50.48\n16  AAAAAAAAAOFDAAAA    57   54.33  197.53  26.84\n17  AAAAAAAACGAOAAAA    59   72.65    0.00  36.36\n18  AAAAAAAABAJJAAAA    42   80.74   94.42  23.31\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M' and \n       cd_marital_status = 'M' and\n       cd_education_status = '4 yr Degree' and\n       (p_channel_email = 'N' or p_channel_event = 'N')\n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON ( \"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N' ) AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON ( \"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N' ) AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.357853,
                    "execution_time": 0.151973,
                    "compile_time": 0.000515,
                    "planning_time": 0.058651,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.780169,
                    "execution_time": 0.494922,
                    "compile_time": 0.001609,
                    "planning_time": 0.138295,
                    "create_size": 1024
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1    agg2    agg3   agg4\n0   AAAAAAAAPMLHBAAA    36  106.11    0.00  78.43\n1   AAAAAAAABDGIBAAA    63   44.80    0.00  15.45\n2   AAAAAAAAOGNFAAAA    53   62.79    1.72  28.37\n3   AAAAAAAAJHGFBAAA    42   83.68  133.12  39.68\n4   AAAAAAAALIEBBAAA    62  101.09  255.52  47.92\n5   AAAAAAAAACIKAAAA    49   92.07  350.04  34.65\n6   AAAAAAAAIDIGBAAA    45   61.92   92.75  33.49\n7   AAAAAAAAKLLLAAAA    41   75.70   94.66  31.60\n8   AAAAAAAAEONABAAA    56   71.40  248.89  27.98\n9   AAAAAAAALGFJAAAA    55   57.44    0.00  25.16\n10  AAAAAAAAHKFPAAAA    67   61.08    0.15  23.85\n11  AAAAAAAAIHHABAAA    29   55.06  214.33  29.50\n12  AAAAAAAAOCIABAAA    58  101.72  116.08  41.27\n13  AAAAAAAALDKNAAAA    47   78.43  965.97  29.45\n14  AAAAAAAAJOPHBAAA    37   77.34  325.51  52.13\n15  AAAAAAAACJPPAAAA    38   78.25    0.00  48.73\n16  AAAAAAAAIAJOAAAA    53   58.56   49.95  33.67\n17  AAAAAAAAJJANAAAA    41  115.10    0.00  29.47\n18  AAAAAAAAOEHKAAAA    56   86.50  246.38  55.41\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017574,
                    "execution_time": 0.007571,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003724
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053196,
                    "execution_time": 0.00786,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039092
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON (\"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N') AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_5\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*           i_item_id  agg1    agg2    agg3   agg4\n0   AAAAAAAAPMLHBAAA    36  106.11    0.00  78.43\n1   AAAAAAAABDGIBAAA    63   44.80    0.00  15.45\n2   AAAAAAAAOGNFAAAA    53   62.79    1.72  28.37\n3   AAAAAAAAJHGFBAAA    42   83.68  133.12  39.68\n4   AAAAAAAALIEBBAAA    62  101.09  255.52  47.92\n5   AAAAAAAAACIKAAAA    49   92.07  350.04  34.65\n6   AAAAAAAAIDIGBAAA    45   61.92   92.75  33.49\n7   AAAAAAAAKLLLAAAA    41   75.70   94.66  31.60\n8   AAAAAAAAEONABAAA    56   71.40  248.89  27.98\n9   AAAAAAAALGFJAAAA    55   57.44    0.00  25.16\n10  AAAAAAAAHKFPAAAA    67   61.08    0.15  23.85\n11  AAAAAAAAIHHABAAA    29   55.06  214.33  29.50\n12  AAAAAAAAOCIABAAA    58  101.72  116.08  41.27\n13  AAAAAAAALDKNAAAA    47   78.43  965.97  29.45\n14  AAAAAAAAJOPHBAAA    37   77.34  325.51  52.13\n15  AAAAAAAACJPPAAAA    38   78.25    0.00  48.73\n16  AAAAAAAAIAJOAAAA    53   58.56   49.95  33.67\n17  AAAAAAAAJJANAAAA    41  115.10    0.00  29.47\n18  AAAAAAAAOEHKAAAA    56   86.50  246.38  55.41\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M' and \n       cd_marital_status = 'M' and\n       cd_education_status = '4 yr Degree' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 2001 \n/*CURSOR_IDENTIFIER*/\ngroup by i_item_id",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON ( \"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N' ) AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON ( \"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N' ) AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.55219,
                    "execution_time": 0.33622,
                    "compile_time": 0.040715,
                    "planning_time": 0.060981,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.950704,
                    "execution_time": 0.349349,
                    "compile_time": 3.336825,
                    "planning_time": 0.141687,
                    "create_size": 1024
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1    agg2    agg3   agg4\n0   AAAAAAAACPOBAAAA    48   80.36    0.00  41.78\n1   AAAAAAAAKBCCBAAA    13   46.96    0.00  37.14\n2   AAAAAAAAGNCGBAAA    43   98.41    0.00  37.75\n3   AAAAAAAAFEPGBAAA    52   68.18  492.94  17.53\n4   AAAAAAAAELPBBAAA    72   91.05    0.00  70.28\n5   AAAAAAAAPFALAAAA    68   73.52   61.06  58.14\n6   AAAAAAAAMDDFAAAA    65   84.67    0.00  13.54\n7   AAAAAAAAIFMPAAAA    36    2.11    0.00   0.16\n8   AAAAAAAAAFDAAAAA    25   34.08    0.00   9.62\n9   AAAAAAAAEIHNAAAA    43  172.82    0.00  50.06\n10  AAAAAAAAAKBHBAAA    20   74.43    2.24  50.98\n11  AAAAAAAACDFAAAAA    85  126.99    0.00  30.59\n12  AAAAAAAAHENEAAAA     7   16.29    0.00   4.88\n13  AAAAAAAAPPOEBAAA    78   76.14    0.00  24.36\n14  AAAAAAAAEMJDAAAA    68   45.65   25.68  29.73\n15  AAAAAAAANEOAAAAA    51   41.39   93.21   7.03\n16  AAAAAAAAPNJMAAAA    89   31.59    0.00  24.95\n17  AAAAAAAAOFJFBAAA    28  106.00    0.00  42.55\n18  AAAAAAAAMICBAAAA    62  124.43    0.00  51.26\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016775,
                    "execution_time": 0.007566,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003373
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05506,
                    "execution_time": 0.007718,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.039288
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON (\"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N') AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*           i_item_id  agg1    agg2    agg3   agg4\n0   AAAAAAAACPOBAAAA    48   80.36    0.00  41.78\n1   AAAAAAAAKBCCBAAA    13   46.96    0.00  37.14\n2   AAAAAAAAGNCGBAAA    43   98.41    0.00  37.75\n3   AAAAAAAAFEPGBAAA    52   68.18  492.94  17.53\n4   AAAAAAAAELPBBAAA    72   91.05    0.00  70.28\n5   AAAAAAAAPFALAAAA    68   73.52   61.06  58.14\n6   AAAAAAAAMDDFAAAA    65   84.67    0.00  13.54\n7   AAAAAAAAIFMPAAAA    36    2.11    0.00   0.16\n8   AAAAAAAAAFDAAAAA    25   34.08    0.00   9.62\n9   AAAAAAAAEIHNAAAA    43  172.82    0.00  50.06\n10  AAAAAAAAAKBHBAAA    20   74.43    2.24  50.98\n11  AAAAAAAACDFAAAAA    85  126.99    0.00  30.59\n12  AAAAAAAAHENEAAAA     7   16.29    0.00   4.88\n13  AAAAAAAAPPOEBAAA    78   76.14    0.00  24.36\n14  AAAAAAAAEMJDAAAA    68   45.65   25.68  29.73\n15  AAAAAAAANEOAAAAA    51   41.39   93.21   7.03\n16  AAAAAAAAPNJMAAAA    89   31.59    0.00  24.95\n17  AAAAAAAAOFJFBAAA    28  106.00    0.00  42.55\n18  AAAAAAAAMICBAAAA    62  124.43    0.00  51.26\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M' and \n       cd_marital_status = 'M' and\n       cd_education_status = '4 yr Degree' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 2001 \n group by i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON ( \"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N' ) AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"AGG1\" AS \"AGG1\" , \"AGG2\" AS \"AGG2\" , \"AGG3\" AS \"AGG3\" , \"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_6\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1    agg2     agg3   agg4\n0   AAAAAAAAOALGAAAA    57   34.83     0.00   9.05\n1   AAAAAAAAKDJPAAAA    98  187.57     0.00  11.25\n2   AAAAAAAAMHFFAAAA    25   75.01     0.00  45.63\n3   AAAAAAAAEDELAAAA    63   30.63     0.00  19.60\n4   AAAAAAAAPGJDBAAA    51   53.01   459.17  38.30\n5   AAAAAAAACBDOAAAA    17   15.75     0.45   4.49\n6   AAAAAAAALDPCAAAA    69   95.46     0.00  15.87\n7   AAAAAAAAKJHFAAAA    31   89.12     0.00  15.15\n8   AAAAAAAAEPLHAAAA    69   38.57  1098.92  22.35\n9   AAAAAAAADABDAAAA    39    9.71     0.00   9.51\n10  AAAAAAAAMFFDAAAA    66   20.94   853.28  19.89\n11  AAAAAAAACBKHAAAA    72   23.46     0.00   4.22\n12  AAAAAAAAGLDJAAAA    88   49.13   466.85  44.21\n13  AAAAAAAAEKHBBAAA    25   59.06     0.00   8.36\n14  AAAAAAAAHDMMAAAA    41  104.97     0.00  37.78\n15  AAAAAAAANLHJAAAA    51  111.01   201.39  22.08\n16  AAAAAAAAFMBABAAA    13   48.05    19.29  29.44\n17  AAAAAAAAEDHJAAAA    37   76.34   150.64  36.30\n18  AAAAAAAABICCAAAA    44  145.06     0.00  51.64\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018546,
                    "execution_time": 0.008209,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.003792
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.052971,
                    "execution_time": 0.008072,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.038765
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON (\"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N') AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\"",
                "rewrite": "SELECT \"I_ITEM_ID\" AS \"I_ITEM_ID\", \"AGG1\" AS \"AGG1\", \"AGG2\" AS \"AGG2\", \"AGG3\" AS \"AGG3\", \"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_6\""
            }
        ],
        "preview": "\n/*           i_item_id  agg1    agg2     agg3   agg4\n0   AAAAAAAAOALGAAAA    57   34.83     0.00   9.05\n1   AAAAAAAAKDJPAAAA    98  187.57     0.00  11.25\n2   AAAAAAAAMHFFAAAA    25   75.01     0.00  45.63\n3   AAAAAAAAEDELAAAA    63   30.63     0.00  19.60\n4   AAAAAAAAPGJDBAAA    51   53.01   459.17  38.30\n5   AAAAAAAACBDOAAAA    17   15.75     0.45   4.49\n6   AAAAAAAALDPCAAAA    69   95.46     0.00  15.87\n7   AAAAAAAAKJHFAAAA    31   89.12     0.00  15.15\n8   AAAAAAAAEPLHAAAA    69   38.57  1098.92  22.35\n9   AAAAAAAADABDAAAA    39    9.71     0.00   9.51\n10  AAAAAAAAMFFDAAAA    66   20.94   853.28  19.89\n11  AAAAAAAACBKHAAAA    72   23.46     0.00   4.22\n12  AAAAAAAAGLDJAAAA    88   49.13   466.85  44.21\n13  AAAAAAAAEKHBBAAA    25   59.06     0.00   8.36\n14  AAAAAAAAHDMMAAAA    41  104.97     0.00  37.78\n15  AAAAAAAANLHJAAAA    51  111.01   201.39  22.08\n16  AAAAAAAAFMBABAAA    13   48.05    19.29  29.44\n17  AAAAAAAAEDHJAAAA    37   76.34   150.64  36.30\n18  AAAAAAAABICCAAAA    44  145.06     0.00  51.64\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M' and \n       cd_marital_status = 'M' and\n       cd_education_status = '4 yr Degree' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 2001 \n group by i_item_id\n order by i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON ( \"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N' ) AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" ORDER BY \"I_ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"I_ITEM_ID\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1    agg2     agg3    agg4\n0   AAAAAAAAAAAABAAA  21.0   45.87   370.51   32.62\n1   AAAAAAAAAAABAAAA  34.0   80.71     0.00   28.07\n2   AAAAAAAAAAABBAAA  75.0   53.83   537.90   28.06\n3   AAAAAAAAAAACAAAA  32.0  116.83   250.59   75.29\n4   AAAAAAAAAAAEBAAA   NaN     NaN     0.00     NaN\n5   AAAAAAAAAAAGBAAA  70.0   79.99     0.00   23.99\n6   AAAAAAAAAAAHAAAA  68.0  138.60     0.00  101.17\n7   AAAAAAAAAAAHBAAA  26.0   26.55     0.00    7.91\n8   AAAAAAAAAAAIAAAA  65.0   75.72     0.00   46.18\n9   AAAAAAAAAAAKAAAA  53.0   89.10     0.00   41.36\n10  AAAAAAAAAAALAAAA  46.0   73.88     0.00   64.19\n11  AAAAAAAAAAAOAAAA  27.0   47.34     0.00   42.13\n12  AAAAAAAAAABAAAAA  62.0  114.32   813.58   94.92\n13  AAAAAAAAAABBAAAA  61.0   69.45     2.02   48.62\n14  AAAAAAAAAABCBAAA  41.0   45.08     0.00   13.52\n15  AAAAAAAAAABDAAAA  37.0   56.12     0.00   16.83\n16  AAAAAAAAAABDBAAA  57.0   11.16     0.00    4.91\n17  AAAAAAAAAABEAAAA  88.0   46.95  2230.90   35.21\n18  AAAAAAAAAABFBAAA  40.0   22.40     0.00    1.53\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019913,
                    "execution_time": 0.009362,
                    "compile_time": 7.7e-05,
                    "planning_time": 0.00405
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057037,
                    "execution_time": 0.009844,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.039255
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON (\"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N') AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" ORDER BY \"I_ITEM_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"I_ITEM_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*           i_item_id  agg1    agg2     agg3    agg4\n0   AAAAAAAAAAAABAAA  21.0   45.87   370.51   32.62\n1   AAAAAAAAAAABAAAA  34.0   80.71     0.00   28.07\n2   AAAAAAAAAAABBAAA  75.0   53.83   537.90   28.06\n3   AAAAAAAAAAACAAAA  32.0  116.83   250.59   75.29\n4   AAAAAAAAAAAEBAAA   NaN     NaN     0.00     NaN\n5   AAAAAAAAAAAGBAAA  70.0   79.99     0.00   23.99\n6   AAAAAAAAAAAHAAAA  68.0  138.60     0.00  101.17\n7   AAAAAAAAAAAHBAAA  26.0   26.55     0.00    7.91\n8   AAAAAAAAAAAIAAAA  65.0   75.72     0.00   46.18\n9   AAAAAAAAAAAKAAAA  53.0   89.10     0.00   41.36\n10  AAAAAAAAAAALAAAA  46.0   73.88     0.00   64.19\n11  AAAAAAAAAAAOAAAA  27.0   47.34     0.00   42.13\n12  AAAAAAAAAABAAAAA  62.0  114.32   813.58   94.92\n13  AAAAAAAAAABBAAAA  61.0   69.45     2.02   48.62\n14  AAAAAAAAAABCBAAA  41.0   45.08     0.00   13.52\n15  AAAAAAAAAABDAAAA  37.0   56.12     0.00   16.83\n16  AAAAAAAAAABDBAAA  57.0   11.16     0.00    4.91\n17  AAAAAAAAAABEAAAA  88.0   46.95  2230.90   35.21\n18  AAAAAAAAAABFBAAA  40.0   22.40     0.00    1.53\n...*/"
    },
    {
        "input": "-- start template query7.tpl query 2 in stream 0\nselect /* TPC-DS query7.tpl 0.2 */  i_item_id, \n        avg(ss_quantity) agg1,\n        avg(ss_list_price) agg2,\n        avg(ss_coupon_amt) agg3,\n        avg(ss_sales_price) agg4 \n from store_sales, customer_demographics, date_dim, item, promotion\n where ss_sold_date_sk = d_date_sk and\n       ss_item_sk = i_item_sk and\n       ss_cdemo_sk = cd_demo_sk and\n       ss_promo_sk = p_promo_sk and\n       cd_gender = 'M' and \n       cd_marital_status = 'M' and\n       cd_education_status = '4 yr Degree' and\n       (p_channel_email = 'N' or p_channel_event = 'N') and\n       d_year = 2001 \n group by i_item_id\n order by i_item_id\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , AVG ( \"STORE_SALES\".\"SS_QUANTITY\" ) AS \"AGG1\" , AVG ( \"STORE_SALES\".\"SS_LIST_PRICE\" ) AS \"AGG2\" , AVG ( \"STORE_SALES\".\"SS_COUPON_AMT\" ) AS \"AGG3\" , AVG ( \"STORE_SALES\".\"SS_SALES_PRICE\" ) AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON ( \"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N' ) AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" ORDER BY \"I_ITEM_ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"I_ITEM_ID\" LIMIT 21",
                "preview": "\n/*           i_item_id  agg1    agg2     agg3    agg4\n0   AAAAAAAAAAAABAAA  21.0   45.87   370.51   32.62\n1   AAAAAAAAAAABAAAA  34.0   80.71     0.00   28.07\n2   AAAAAAAAAAABBAAA  75.0   53.83   537.90   28.06\n3   AAAAAAAAAAACAAAA  32.0  116.83   250.59   75.29\n4   AAAAAAAAAAAEBAAA   NaN     NaN     0.00     NaN\n5   AAAAAAAAAAAGBAAA  70.0   79.99     0.00   23.99\n6   AAAAAAAAAAAHAAAA  68.0  138.60     0.00  101.17\n7   AAAAAAAAAAAHBAAA  26.0   26.55     0.00    7.91\n8   AAAAAAAAAAAIAAAA  65.0   75.72     0.00   46.18\n9   AAAAAAAAAAAKAAAA  53.0   89.10     0.00   41.36\n10  AAAAAAAAAAALAAAA  46.0   73.88     0.00   64.19\n11  AAAAAAAAAAAOAAAA  27.0   47.34     0.00   42.13\n12  AAAAAAAAAABAAAAA  62.0  114.32   813.58   94.92\n13  AAAAAAAAAABBAAAA  61.0   69.45     2.02   48.62\n14  AAAAAAAAAABCBAAA  41.0   45.08     0.00   13.52\n15  AAAAAAAAAABDAAAA  37.0   56.12     0.00   16.83\n16  AAAAAAAAAABDBAAA  57.0   11.16     0.00    4.91\n17  AAAAAAAAAABEAAAA  88.0   46.95  2230.90   35.21\n18  AAAAAAAAAABFBAAA  40.0   22.40     0.00    1.53\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019165,
                    "execution_time": 0.009287,
                    "compile_time": 7e-05,
                    "planning_time": 0.003862
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019723,
                    "execution_time": 0.009598,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.003756
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", AVG(\"STORE_SALES\".\"SS_QUANTITY\") AS \"AGG1\", AVG(\"STORE_SALES\".\"SS_LIST_PRICE\") AS \"AGG2\", AVG(\"STORE_SALES\".\"SS_COUPON_AMT\") AS \"AGG3\", AVG(\"STORE_SALES\".\"SS_SALES_PRICE\") AS \"AGG4\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CUSTOMER_DEMOGRAPHICS\" ON \"CUSTOMER_DEMOGRAPHICS\".\"CD_DEMO_SK\" = \"STORE_SALES\".\"SS_CDEMO_SK\" AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_EDUCATION_STATUS\" = '4 yr Degree' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_GENDER\" = 'M' AND \"CUSTOMER_DEMOGRAPHICS\".\"CD_MARITAL_STATUS\" = 'M' JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 2001 JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" JOIN \"PROMOTION\" AS \"PROMOTION\" ON (\"PROMOTION\".\"P_CHANNEL_EMAIL\" = 'N' OR \"PROMOTION\".\"P_CHANNEL_EVENT\" = 'N') AND \"PROMOTION\".\"P_PROMO_SK\" = \"STORE_SALES\".\"SS_PROMO_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" ORDER BY \"I_ITEM_ID\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_6\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_6\".\"AGG4\" AS \"AGG4\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" ORDER BY \"I_ITEM_ID\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*           i_item_id  agg1    agg2     agg3    agg4\n0   AAAAAAAAAAAABAAA  21.0   45.87   370.51   32.62\n1   AAAAAAAAAAABAAAA  34.0   80.71     0.00   28.07\n2   AAAAAAAAAAABBAAA  75.0   53.83   537.90   28.06\n3   AAAAAAAAAAACAAAA  32.0  116.83   250.59   75.29\n4   AAAAAAAAAAAEBAAA   NaN     NaN     0.00     NaN\n5   AAAAAAAAAAAGBAAA  70.0   79.99     0.00   23.99\n6   AAAAAAAAAAAHAAAA  68.0  138.60     0.00  101.17\n7   AAAAAAAAAAAHBAAA  26.0   26.55     0.00    7.91\n8   AAAAAAAAAAAIAAAA  65.0   75.72     0.00   46.18\n9   AAAAAAAAAAAKAAAA  53.0   89.10     0.00   41.36\n10  AAAAAAAAAAALAAAA  46.0   73.88     0.00   64.19\n11  AAAAAAAAAAAOAAAA  27.0   47.34     0.00   42.13\n12  AAAAAAAAAABAAAAA  62.0  114.32   813.58   94.92\n13  AAAAAAAAAABBAAAA  61.0   69.45     2.02   48.62\n14  AAAAAAAAAABCBAAA  41.0   45.08     0.00   13.52\n15  AAAAAAAAAABDAAAA  37.0   56.12     0.00   16.83\n16  AAAAAAAAAABDBAAA  57.0   11.16     0.00    4.91\n17  AAAAAAAAAABEAAAA  88.0   46.95  2230.90   35.21\n18  AAAAAAAAAABFBAAA  40.0   22.40     0.00    1.53\n...*/"
    }
]