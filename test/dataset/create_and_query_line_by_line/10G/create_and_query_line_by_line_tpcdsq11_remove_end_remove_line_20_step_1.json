[
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.024358,
                    "execution_time": 0.405209,
                    "compile_time": 0.000402,
                    "planning_time": 0.023796,
                    "create_size": 1408
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.026604,
                    "execution_time": 0.40281,
                    "compile_time": 0.0004,
                    "planning_time": 0.025088,
                    "create_size": 1408
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.105936,
                    "execution_time": 0.039654,
                    "compile_time": 0.000234,
                    "planning_time": 0.025807,
                    "create_size": 480
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.105858,
                    "execution_time": 0.040644,
                    "compile_time": 0.000228,
                    "planning_time": 0.025148,
                    "create_size": 480
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.592512,
                    "execution_time": 1.148179,
                    "compile_time": 0.000811,
                    "planning_time": 0.04591,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.696126,
                    "execution_time": 1.166676,
                    "compile_time": 0.000785,
                    "planning_time": 0.130139,
                    "create_size": 896
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name customer_email_address\n0   AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n1   AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n2   AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n3   AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n4   AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n5   AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n6   AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n7   AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n8   AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n9   AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n10  AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n11  AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n12  AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n13  AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n14  AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n15  AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n16  AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n17  AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n18  AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.070885,
                    "execution_time": 0.054922,
                    "compile_time": 0.000188,
                    "planning_time": 0.007116
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.107047,
                    "execution_time": 0.055008,
                    "compile_time": 0.000156,
                    "planning_time": 0.041898
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name customer_email_address\n0   AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n1   AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n2   AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n3   AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n4   AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n5   AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n6   AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n7   AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n8   AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n9   AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n10  AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n11  AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n12  AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n13  AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n14  AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n15  AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n16  AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n17  AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n18  AAAAAAAAGNKHGAAA               Nancy          Gustafson  Nancy.Gustafson@f.com\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" CROSS JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name         customer_email_address\n0   AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n1   AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n2   AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n3   AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n4   AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n5   AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n6   AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n7   AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n8   AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n9   AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n10  AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n11  AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n12  AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n13  AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n14  AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n15  AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n16  AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n17  AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n18  AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.169784,
                    "execution_time": 0.149821,
                    "compile_time": 0.000224,
                    "planning_time": 0.00759
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.209263,
                    "execution_time": 0.149896,
                    "compile_time": 0.00023,
                    "planning_time": 0.043111
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\"",
                "rewrite": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_3\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name         customer_email_address\n0   AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n1   AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n2   AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n3   AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n4   AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n5   AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n6   AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n7   AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n8   AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n9   AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n10  AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n11  AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n12  AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n13  AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n14  AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n15  AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n16  AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n17  AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n18  AAAAAAAAKJCHDAAA               James             Martin  James.Martin@MDSBJHkj75qX.edu\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.856575,
                    "execution_time": 1.352172,
                    "compile_time": 0.000899,
                    "planning_time": 0.045028,
                    "create_size": 1024
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.86115,
                    "execution_time": 1.278763,
                    "compile_time": 0.000913,
                    "planning_time": 0.128794,
                    "create_size": 1024
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 5.582707,
                    "execution_time": 5.185545,
                    "compile_time": 0.000568,
                    "planning_time": 0.009063,
                    "create_size": 13873
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 5.637123,
                    "execution_time": 5.177659,
                    "compile_time": 0.000573,
                    "planning_time": 0.069327,
                    "create_size": 13873
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name          customer_email_address\n0   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n1   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n2   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n3   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n4   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n5   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n6   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n7   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n8   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n9   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n10  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n11  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n12  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n13  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n14  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n15  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n16  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n17  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n18  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017487,
                    "execution_time": 0.007734,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.003536
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056487,
                    "execution_time": 0.008281,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.038715
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name          customer_email_address\n0   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n1   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n2   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n3   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n4   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n5   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n6   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n7   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n8   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n9   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n10  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n11  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n12  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n13  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n14  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n15  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n16  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n17  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n18  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name          customer_email_address\n0   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n1   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n2   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n3   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n4   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n5   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n6   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n7   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n8   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n9   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n10  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n11  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n12  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n13  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n14  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n15  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n16  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n17  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n18  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.031334,
                    "execution_time": 0.01878,
                    "compile_time": 8.6e-05,
                    "planning_time": 0.005064
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.07366,
                    "execution_time": 0.019231,
                    "compile_time": 9.4e-05,
                    "planning_time": 0.040618
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w'"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name          customer_email_address\n0   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n1   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n2   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n3   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n4   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n5   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n6   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n7   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n8   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n9   AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n10  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n11  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n12  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n13  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n14  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n15  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n16  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n17  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n18  AAAAAAAAJPHICAAA            Stephani               Yoon  Stephani.Yoon@onUlvhQcZK2i.com\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w'"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_4\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w'"
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 1.803912,
                    "execution_time": 1.279558,
                    "compile_time": 0.000934,
                    "planning_time": 0.04692,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 1.993128,
                    "execution_time": 1.365579,
                    "compile_time": 0.000916,
                    "planning_time": 0.131309,
                    "create_size": 1152
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.781535,
                    "execution_time": 0.383495,
                    "compile_time": 0.000485,
                    "planning_time": 0.011331,
                    "create_size": 896
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.843614,
                    "execution_time": 0.387118,
                    "compile_time": 0.000464,
                    "planning_time": 0.070646,
                    "create_size": 896
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name               customer_email_address\n0   AAAAAAAAGBLPGAAA             Leonard             Brooks  Leonard.Brooks@IXSCKaYlTRXzIShc.com\n1   AAAAAAAAGBLPGAAA             Leonard             Brooks  Leonard.Brooks@IXSCKaYlTRXzIShc.com\n2   AAAAAAAAGBLPGAAA             Leonard             Brooks  Leonard.Brooks@IXSCKaYlTRXzIShc.com\n3   AAAAAAAAGBLPGAAA             Leonard             Brooks  Leonard.Brooks@IXSCKaYlTRXzIShc.com\n4   AAAAAAAANCAIAAAA             Deborah             Hanson              Deborah.Hanson@C0Rn.org\n5   AAAAAAAAGBMJFAAA                Gina            Bullock     Gina.Bullock@kur0BuHHoHcomiF.edu\n6   AAAAAAAAMNJACAAA               Chase               Ring                Chase.Ring@iBFqyM.com\n7   AAAAAAAAMLADCAAA              Vernon             Larson                 Vernon.Larson@OJ.edu\n8   AAAAAAAAMLADCAAA              Vernon             Larson                 Vernon.Larson@OJ.edu\n9   AAAAAAAAMLADCAAA              Vernon             Larson                 Vernon.Larson@OJ.edu\n10  AAAAAAAAMLADCAAA              Vernon             Larson                 Vernon.Larson@OJ.edu\n11  AAAAAAAAMLADCAAA              Vernon             Larson                 Vernon.Larson@OJ.edu\n12  AAAAAAAAMLADCAAA              Vernon             Larson                 Vernon.Larson@OJ.edu\n13  AAAAAAAAMLADCAAA              Vernon             Larson                 Vernon.Larson@OJ.edu\n14  AAAAAAAAMLADCAAA              Vernon             Larson                 Vernon.Larson@OJ.edu\n15  AAAAAAAAMLADCAAA              Vernon             Larson                 Vernon.Larson@OJ.edu\n16  AAAAAAAAMJEMDAAA                 Joe            Stanley          Joe.Stanley@sXZjxfpujFK.edu\n17  AAAAAAAAMJEMDAAA                 Joe            Stanley          Joe.Stanley@sXZjxfpujFK.edu\n18  AAAAAAAAMJEMDAAA                 Joe            Stanley          Joe.Stanley@sXZjxfpujFK.edu\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016997,
                    "execution_time": 0.007399,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003501
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054289,
                    "execution_time": 0.007743,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.038679
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name               customer_email_address\n0   AAAAAAAAGBLPGAAA             Leonard             Brooks  Leonard.Brooks@IXSCKaYlTRXzIShc.com\n1   AAAAAAAAGBLPGAAA             Leonard             Brooks  Leonard.Brooks@IXSCKaYlTRXzIShc.com\n2   AAAAAAAAGBLPGAAA             Leonard             Brooks  Leonard.Brooks@IXSCKaYlTRXzIShc.com\n3   AAAAAAAAGBLPGAAA             Leonard             Brooks  Leonard.Brooks@IXSCKaYlTRXzIShc.com\n4   AAAAAAAANCAIAAAA             Deborah             Hanson              Deborah.Hanson@C0Rn.org\n5   AAAAAAAAGBMJFAAA                Gina            Bullock     Gina.Bullock@kur0BuHHoHcomiF.edu\n6   AAAAAAAAMNJACAAA               Chase               Ring                Chase.Ring@iBFqyM.com\n7   AAAAAAAAMLADCAAA              Vernon             Larson                 Vernon.Larson@OJ.edu\n8   AAAAAAAAMLADCAAA              Vernon             Larson                 Vernon.Larson@OJ.edu\n9   AAAAAAAAMLADCAAA              Vernon             Larson                 Vernon.Larson@OJ.edu\n10  AAAAAAAAMLADCAAA              Vernon             Larson                 Vernon.Larson@OJ.edu\n11  AAAAAAAAMLADCAAA              Vernon             Larson                 Vernon.Larson@OJ.edu\n12  AAAAAAAAMLADCAAA              Vernon             Larson                 Vernon.Larson@OJ.edu\n13  AAAAAAAAMLADCAAA              Vernon             Larson                 Vernon.Larson@OJ.edu\n14  AAAAAAAAMLADCAAA              Vernon             Larson                 Vernon.Larson@OJ.edu\n15  AAAAAAAAMLADCAAA              Vernon             Larson                 Vernon.Larson@OJ.edu\n16  AAAAAAAAMJEMDAAA                 Joe            Stanley          Joe.Stanley@sXZjxfpujFK.edu\n17  AAAAAAAAMJEMDAAA                 Joe            Stanley          Joe.Stanley@sXZjxfpujFK.edu\n18  AAAAAAAAMJEMDAAA                 Joe            Stanley          Joe.Stanley@sXZjxfpujFK.edu\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name  customer_email_address\n0   AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n1   AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n2   AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n3   AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n4   AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n5   AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n6   AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n7   AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n8   AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n9   AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n10  AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n11  AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n12  AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n13  AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n14  AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n15  AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n16  AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n17  AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n18  AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.029417,
                    "execution_time": 0.016648,
                    "compile_time": 8.9e-05,
                    "planning_time": 0.005327
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.067369,
                    "execution_time": 0.016131,
                    "compile_time": 9.1e-05,
                    "planning_time": 0.040417
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name  customer_email_address\n0   AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n1   AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n2   AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n3   AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n4   AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n5   AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n6   AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n7   AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n8   AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n9   AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n10  AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n11  AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n12  AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n13  AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n14  AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n15  AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n16  AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n17  AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n18  AAAAAAAAOEMMBAAA                Gary                Roy  Gary.Roy@EBGc87fz5.org\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name            customer_email_address\n0   AAAAAAAAOEMMBAAA                Gary                Roy            Gary.Roy@EBGc87fz5.org\n1   AAAAAAAAOEMMBAAA                Gary                Roy            Gary.Roy@EBGc87fz5.org\n2   AAAAAAAAOEMMBAAA                Gary                Roy            Gary.Roy@EBGc87fz5.org\n3   AAAAAAAAOEMMBAAA                Gary                Roy            Gary.Roy@EBGc87fz5.org\n4   AAAAAAAAIAICGAAA              Robert            Cummins             Robert.Cummins@Li.edu\n5   AAAAAAAAIAICGAAA              Robert            Cummins             Robert.Cummins@Li.edu\n6   AAAAAAAAIAICGAAA              Robert            Cummins             Robert.Cummins@Li.edu\n7   AAAAAAAAIAICGAAA              Robert            Cummins             Robert.Cummins@Li.edu\n8   AAAAAAAAOMNFDAAA              Pamela              Davis       Pamela.Davis@gLUQ9JhlnQ.org\n9   AAAAAAAAMCGMBAAA              Dianne           Gonzalez       Dianne.Gonzalez@rdI65Fg.com\n10  AAAAAAAACHMCFAAA             Zachary               Ward   Zachary.Ward@U7YnMEllMTN3Va.com\n11  AAAAAAAACHMCFAAA             Zachary               Ward   Zachary.Ward@U7YnMEllMTN3Va.com\n12  AAAAAAAACHMCFAAA             Zachary               Ward   Zachary.Ward@U7YnMEllMTN3Va.com\n13  AAAAAAAACHMCFAAA             Zachary               Ward   Zachary.Ward@U7YnMEllMTN3Va.com\n14  AAAAAAAADGGOEAAA                              Fernandez                                  \n15  AAAAAAAALOMDBAAA               Larry            Samuels  Larry.Samuels@qpjtSaZAZoT1vQ.edu\n16  AAAAAAAADLLDBAAA               Erica             Blanco      Erica.Blanco@7Nf7RsrI7g2.com\n17  AAAAAAAADLLDBAAA               Erica             Blanco      Erica.Blanco@7Nf7RsrI7g2.com\n18  AAAAAAAADLLDBAAA               Erica             Blanco      Erica.Blanco@7Nf7RsrI7g2.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.223096,
                    "execution_time": 0.207546,
                    "compile_time": 0.000144,
                    "planning_time": 0.006806
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.304766,
                    "execution_time": 0.238779,
                    "compile_time": 0.000159,
                    "planning_time": 0.042417
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name            customer_email_address\n0   AAAAAAAAOEMMBAAA                Gary                Roy            Gary.Roy@EBGc87fz5.org\n1   AAAAAAAAOEMMBAAA                Gary                Roy            Gary.Roy@EBGc87fz5.org\n2   AAAAAAAAOEMMBAAA                Gary                Roy            Gary.Roy@EBGc87fz5.org\n3   AAAAAAAAOEMMBAAA                Gary                Roy            Gary.Roy@EBGc87fz5.org\n4   AAAAAAAAIAICGAAA              Robert            Cummins             Robert.Cummins@Li.edu\n5   AAAAAAAAIAICGAAA              Robert            Cummins             Robert.Cummins@Li.edu\n6   AAAAAAAAIAICGAAA              Robert            Cummins             Robert.Cummins@Li.edu\n7   AAAAAAAAIAICGAAA              Robert            Cummins             Robert.Cummins@Li.edu\n8   AAAAAAAAOMNFDAAA              Pamela              Davis       Pamela.Davis@gLUQ9JhlnQ.org\n9   AAAAAAAAMCGMBAAA              Dianne           Gonzalez       Dianne.Gonzalez@rdI65Fg.com\n10  AAAAAAAACHMCFAAA             Zachary               Ward   Zachary.Ward@U7YnMEllMTN3Va.com\n11  AAAAAAAACHMCFAAA             Zachary               Ward   Zachary.Ward@U7YnMEllMTN3Va.com\n12  AAAAAAAACHMCFAAA             Zachary               Ward   Zachary.Ward@U7YnMEllMTN3Va.com\n13  AAAAAAAACHMCFAAA             Zachary               Ward   Zachary.Ward@U7YnMEllMTN3Va.com\n14  AAAAAAAADGGOEAAA                              Fernandez                                  \n15  AAAAAAAALOMDBAAA               Larry            Samuels  Larry.Samuels@qpjtSaZAZoT1vQ.edu\n16  AAAAAAAADLLDBAAA               Erica             Blanco      Erica.Blanco@7Nf7RsrI7g2.com\n17  AAAAAAAADLLDBAAA               Erica             Blanco      Erica.Blanco@7Nf7RsrI7g2.com\n18  AAAAAAAADLLDBAAA               Erica             Blanco      Erica.Blanco@7Nf7RsrI7g2.com\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n         and t_w_secyear.dyear = 1998+1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"DYEAR\" = 1999",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"DYEAR\" = 1999 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name       customer_email_address\n0   AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n1   AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n2   AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n3   AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n4   AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n5   AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n6   AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n7   AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n8   AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n9   AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n10  AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n11  AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n12  AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n13  AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n14  AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n15  AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n16  AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n17  AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n18  AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.061764,
                    "execution_time": 0.041965,
                    "compile_time": 0.000205,
                    "planning_time": 0.008471
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.098874,
                    "execution_time": 0.040149,
                    "compile_time": 0.0002,
                    "planning_time": 0.044187
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_S_SECYEAR\" ON \"T_S_SECYEAR\".\"DYEAR\" = 1999 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 JOIN \"SPEQLITE_TEMP_TABLE_6\" AS \"T_W_SECYEAR\" ON \"T_W_SECYEAR\".\"DYEAR\" = 1999"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name       customer_email_address\n0   AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n1   AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n2   AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n3   AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n4   AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n5   AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n6   AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n7   AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n8   AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n9   AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n10  AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n11  AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n12  AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n13  AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n14  AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n15  AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n16  AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n17  AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n18  AAAAAAAAGCPHGAAA           Stephanie              James  Stephanie.James@iPtckQc.com\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n         and t_w_secyear.dyear = 1998+1\n         and t_s_firstyear.year_total > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"SPEQLITE_TEMP_TABLE_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 2.139162,
                    "execution_time": 1.465434,
                    "compile_time": 0.000934,
                    "planning_time": 0.048645,
                    "create_size": 1280
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 2.248866,
                    "execution_time": 1.483482,
                    "compile_time": 0.000947,
                    "planning_time": 0.132787,
                    "create_size": 1280
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.150127,
                    "execution_time": 0.093406,
                    "compile_time": 0.00044,
                    "planning_time": 0.013458,
                    "create_size": 84
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.217846,
                    "execution_time": 0.097552,
                    "compile_time": 0.000448,
                    "planning_time": 0.072552,
                    "create_size": 91
                }
            }
        ],
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n         and t_w_secyear.dyear = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name              customer_email_address\n0   AAAAAAAAHKKEHAAA              Bonnie           Gonzalez         Bonnie.Gonzalez@ZtuEj0Q.org\n1   AAAAAAAAOEKBEAAA                Lily           Kendrick             Lily.Kendrick@nRAdq.org\n2   AAAAAAAAONEJGAAA              Sandra             Whaley  Sandra.Whaley@02NK2Yt3Q07gYe3E.com\n3   AAAAAAAAONEGFAAA                Seth            Simmons             Seth.Simmons@zOgkpH.org\n4   AAAAAAAAHKNJDAAA               James            Carlson       James.Carlson@zu5UmFVhBH4.com\n5   AAAAAAAADFBJGAAA               Jacob             Howard        Jacob.Howard@Zc2i3c431bX.com\n6   AAAAAAAAGNNBDAAA              Andrew              Smith        Andrew.Smith@RiNmIvP7dCs.edu\n7   AAAAAAAAMINIFAAA                 Amy             Garvin   Amy.Garvin@p82V4V2oPmIkcB8nj7.org\n8   AAAAAAAADIANGAAA              Leland            Frazier           Leland.Frazier@1tGBS6.org\n9   AAAAAAAAKILJAAAA            Virginia          Christian    Virginia.Christian@tatMUp513.com\n10  AAAAAAAABNFACAAA              Monica               Gray          Monica.Gray@OjziL9juCv.com\n11  AAAAAAAAPJAEDAAA             Joaquin                           Joaquin.Garza@D4rzauZvdy.org\n12  AAAAAAAAFHMLCAAA               Norma              White       Norma.White@JQC4aLDolTL5B.org\n13  AAAAAAAAEFDEBAAA               Keith              James               Keith.James@7AcRy.com\n14  AAAAAAAANCBJFAAA              Lorena             Dorman      Lorena.Dorman@4LM5TkmtGFKl.edu\n15  AAAAAAAAPJOFDAAA               James            Valerio              James.Valerio@KhMQ.edu\n16  AAAAAAAAPOIEDAAA             Melanie               Vera             Melanie.Vera@PjOouB.com\n17  AAAAAAAAKJHACAAA              Dennis         Mclaughlin     Dennis.Mclaughlin@6NZnCiZNb.com\n18  AAAAAAAALJAAFAAA                Nina          Partridge          Nina.Partridge@kC2GeRF.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.063885,
                    "execution_time": 0.01573,
                    "compile_time": 0.041669,
                    "planning_time": 0.005517
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 3.143653,
                    "execution_time": 0.016071,
                    "compile_time": 3.081255,
                    "planning_time": 0.040734
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name              customer_email_address\n0   AAAAAAAAHKKEHAAA              Bonnie           Gonzalez         Bonnie.Gonzalez@ZtuEj0Q.org\n1   AAAAAAAAOEKBEAAA                Lily           Kendrick             Lily.Kendrick@nRAdq.org\n2   AAAAAAAAONEJGAAA              Sandra             Whaley  Sandra.Whaley@02NK2Yt3Q07gYe3E.com\n3   AAAAAAAAONEGFAAA                Seth            Simmons             Seth.Simmons@zOgkpH.org\n4   AAAAAAAAHKNJDAAA               James            Carlson       James.Carlson@zu5UmFVhBH4.com\n5   AAAAAAAADFBJGAAA               Jacob             Howard        Jacob.Howard@Zc2i3c431bX.com\n6   AAAAAAAAGNNBDAAA              Andrew              Smith        Andrew.Smith@RiNmIvP7dCs.edu\n7   AAAAAAAAMINIFAAA                 Amy             Garvin   Amy.Garvin@p82V4V2oPmIkcB8nj7.org\n8   AAAAAAAADIANGAAA              Leland            Frazier           Leland.Frazier@1tGBS6.org\n9   AAAAAAAAKILJAAAA            Virginia          Christian    Virginia.Christian@tatMUp513.com\n10  AAAAAAAABNFACAAA              Monica               Gray          Monica.Gray@OjziL9juCv.com\n11  AAAAAAAAPJAEDAAA             Joaquin                           Joaquin.Garza@D4rzauZvdy.org\n12  AAAAAAAAFHMLCAAA               Norma              White       Norma.White@JQC4aLDolTL5B.org\n13  AAAAAAAAEFDEBAAA               Keith              James               Keith.James@7AcRy.com\n14  AAAAAAAANCBJFAAA              Lorena             Dorman      Lorena.Dorman@4LM5TkmtGFKl.edu\n15  AAAAAAAAPJOFDAAA               James            Valerio              James.Valerio@KhMQ.edu\n16  AAAAAAAAPOIEDAAA             Melanie               Vera             Melanie.Vera@PjOouB.com\n17  AAAAAAAAKJHACAAA              Dennis         Mclaughlin     Dennis.Mclaughlin@6NZnCiZNb.com\n18  AAAAAAAALJAAFAAA                Nina          Partridge          Nina.Partridge@kC2GeRF.org\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n         and t_w_secyear.dyear = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and (case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end) > 0\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END > 0 WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END > 0 WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.24263,
                    "execution_time": 0.111087,
                    "compile_time": 0.084684,
                    "planning_time": 0.015035,
                    "create_size": 91
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 6.856373,
                    "execution_time": 0.129343,
                    "compile_time": 6.624807,
                    "planning_time": 0.077252,
                    "create_size": 91
                }
            }
        ],
        "query": null,
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END > 0 WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_10\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n         and t_w_secyear.dyear = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's'",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.157418,
                    "execution_time": 0.103047,
                    "compile_time": 0.000449,
                    "planning_time": 0.016305,
                    "create_size": 56
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.227483,
                    "execution_time": 0.105288,
                    "compile_time": 0.004873,
                    "planning_time": 0.07446,
                    "create_size": 56
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name                 customer_email_address\n0   AAAAAAAAFLJPDAAA               Linda           Stephens           Linda.Stephens@eYUtdrVvS.edu\n1   AAAAAAAAPICKCAAA            Meredith             Melton         Meredith.Melton@Tk2ZVIiZGh.com\n2   AAAAAAAAFMECHAAA                                  Smith                                       \n3   AAAAAAAAGLHACAAA             Darlene             Griggs         Darlene.Griggs@OmoMCaELkur.org\n4   AAAAAAAAJOGECAAA               Grace              Jones          Grace.Jones@HBNoiT33g8mBb.com\n5   AAAAAAAAIGDOCAAA              Teresa            Jackson         Teresa.Jackson@M8KvNU8qsYR.edu\n6   AAAAAAAAPBJPBAAA              Nelson            Watkins            Nelson.Watkins@9Mlxioab.com\n7   AAAAAAAAFFOMCAAA             William           Williams       William.Williams@L5bYiOZgAag.org\n8   AAAAAAAALONCGAAA              Thomas            Spruill   Thomas.Spruill@sj0cykC4Nkv2DbFm0.org\n9   AAAAAAAANNEAGAAA                Jung              Couch          Jung.Couch@YshSOtlGPVYOUb.com\n10  AAAAAAAALMBNEAAA                Ruth           Gonzalez          Ruth.Gonzalez@103qXbNQ6uE.com\n11  AAAAAAAALEDCBAAA             Charles              Perez      Charles.Perez@IMZk8QYfgcKExoM.com\n12  AAAAAAAAOELMCAAA               Wilma              Green                   Wilma.Green@OdB3.edu\n13  AAAAAAAAGMDICAAA               Jason             Cuevas                  Jason.Cuevas@ACFq.edu\n14  AAAAAAAACMJOBAAA              Gerald              Slade                 Gerald.Slade@sFrI3.com\n15  AAAAAAAAOKEKEAAA               Frank            Bradley    Frank.Bradley@OvMz5KdDFykhRIaZ5.org\n16  AAAAAAAAPPKHCAAA              Joseph          Delatorre             Joseph.Delatorre@QpB6j.com\n17  AAAAAAAADEIIGAAA               Andre                                        Andre.Clark@DX.com\n18  AAAAAAAAKNKHBAAA             Russell             Harris    Russell.Harris@3kD4OY51fumMJbsq.com\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.0164,
                    "execution_time": 0.006836,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.003482
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054918,
                    "execution_time": 0.007245,
                    "compile_time": 4.4e-05,
                    "planning_time": 0.038368
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name                 customer_email_address\n0   AAAAAAAAFLJPDAAA               Linda           Stephens           Linda.Stephens@eYUtdrVvS.edu\n1   AAAAAAAAPICKCAAA            Meredith             Melton         Meredith.Melton@Tk2ZVIiZGh.com\n2   AAAAAAAAFMECHAAA                                  Smith                                       \n3   AAAAAAAAGLHACAAA             Darlene             Griggs         Darlene.Griggs@OmoMCaELkur.org\n4   AAAAAAAAJOGECAAA               Grace              Jones          Grace.Jones@HBNoiT33g8mBb.com\n5   AAAAAAAAIGDOCAAA              Teresa            Jackson         Teresa.Jackson@M8KvNU8qsYR.edu\n6   AAAAAAAAPBJPBAAA              Nelson            Watkins            Nelson.Watkins@9Mlxioab.com\n7   AAAAAAAAFFOMCAAA             William           Williams       William.Williams@L5bYiOZgAag.org\n8   AAAAAAAALONCGAAA              Thomas            Spruill   Thomas.Spruill@sj0cykC4Nkv2DbFm0.org\n9   AAAAAAAANNEAGAAA                Jung              Couch          Jung.Couch@YshSOtlGPVYOUb.com\n10  AAAAAAAALMBNEAAA                Ruth           Gonzalez          Ruth.Gonzalez@103qXbNQ6uE.com\n11  AAAAAAAALEDCBAAA             Charles              Perez      Charles.Perez@IMZk8QYfgcKExoM.com\n12  AAAAAAAAOELMCAAA               Wilma              Green                   Wilma.Green@OdB3.edu\n13  AAAAAAAAGMDICAAA               Jason             Cuevas                  Jason.Cuevas@ACFq.edu\n14  AAAAAAAACMJOBAAA              Gerald              Slade                 Gerald.Slade@sFrI3.com\n15  AAAAAAAAOKEKEAAA               Frank            Bradley    Frank.Bradley@OvMz5KdDFykhRIaZ5.org\n16  AAAAAAAAPPKHCAAA              Joseph          Delatorre             Joseph.Delatorre@QpB6j.com\n17  AAAAAAAADEIIGAAA               Andre                                        Andre.Clark@DX.com\n18  AAAAAAAAKNKHBAAA             Russell             Harris    Russell.Harris@3kD4OY51fumMJbsq.com\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n         and t_w_secyear.dyear = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name             customer_email_address\n0   AAAAAAAAAAAJDAAA              Israel         Mclaughlin            Israel.Mclaughlin@d.com\n1   AAAAAAAAAADMAAAA               Linda             Fuller        Linda.Fuller@74cRU7hjaf.org\n2   AAAAAAAAAADOFAAA              Steven           Anderson         Steven.Anderson@vEZaBg.com\n3   AAAAAAAAAAFJGAAA                  Jo            Hibbard            Jo.Hibbard@2FcKvK7d.com\n4   AAAAAAAAAAGBGAAA             William            Sprouse                                   \n5   AAAAAAAAAAGMDAAA             Melissa               Holt      Melissa.Holt@p5GeTG2xSeae.com\n6   AAAAAAAAAAGNAAAA             Carlena             Garcia           Carlena.Garcia@UBIGZ.edu\n7   AAAAAAAAAAGPAAAA              Joseph              White      Joseph.White@ilHNcgs0jUaU.edu\n8   AAAAAAAAAAHNDAAA                                                Rudy.Roman@jhZrB2H7TX7.edu\n9   AAAAAAAAAAIODAAA               Karen             Pearce           Karen.Pearce@VLIDRMU.org\n10  AAAAAAAAAAJFCAAA                Mike             Hailey    Mike.Hailey@Spa5NxOfuj1CYLv.com\n11  AAAAAAAAAAJHDAAA             Anthony            Jackson    Anthony.Jackson@lqIQ0Mxq9LQ.org\n12  AAAAAAAAAAKFEAAA               Caryl              Stone  Caryl.Stone@QyV5SdgbY96DYyvvZ.edu\n13  AAAAAAAAAAKPDAAA            Kimberly              Lopez        Kimberly.Lopez@nHUAbnM8.com\n14  AAAAAAAAAALDBAAA              Mickey             Keaton      Mickey.Keaton@ub6HoiCe6RJ.com\n15  AAAAAAAAAALNBAAA               Ervin             Pedigo        Ervin.Pedigo@9SUTpqlpfp.edu\n16  AAAAAAAAAAMAGAAA               Hilda             Hanson       Hilda.Hanson@HUgo4LEObmL.org\n17  AAAAAAAAAAMEFAAA              Denise             Jarvis         Denise.Jarvis@x74JhODL.org\n18  AAAAAAAAAAMODAAA               Jason              Perez         Jason.Perez@usOYS5BvzB.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017088,
                    "execution_time": 0.00781,
                    "compile_time": 7e-05,
                    "planning_time": 0.003514
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056032,
                    "execution_time": 0.00793,
                    "compile_time": 7e-05,
                    "planning_time": 0.038742
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name             customer_email_address\n0   AAAAAAAAAAAJDAAA              Israel         Mclaughlin            Israel.Mclaughlin@d.com\n1   AAAAAAAAAADMAAAA               Linda             Fuller        Linda.Fuller@74cRU7hjaf.org\n2   AAAAAAAAAADOFAAA              Steven           Anderson         Steven.Anderson@vEZaBg.com\n3   AAAAAAAAAAFJGAAA                  Jo            Hibbard            Jo.Hibbard@2FcKvK7d.com\n4   AAAAAAAAAAGBGAAA             William            Sprouse                                   \n5   AAAAAAAAAAGMDAAA             Melissa               Holt      Melissa.Holt@p5GeTG2xSeae.com\n6   AAAAAAAAAAGNAAAA             Carlena             Garcia           Carlena.Garcia@UBIGZ.edu\n7   AAAAAAAAAAGPAAAA              Joseph              White      Joseph.White@ilHNcgs0jUaU.edu\n8   AAAAAAAAAAHNDAAA                                                Rudy.Roman@jhZrB2H7TX7.edu\n9   AAAAAAAAAAIODAAA               Karen             Pearce           Karen.Pearce@VLIDRMU.org\n10  AAAAAAAAAAJFCAAA                Mike             Hailey    Mike.Hailey@Spa5NxOfuj1CYLv.com\n11  AAAAAAAAAAJHDAAA             Anthony            Jackson    Anthony.Jackson@lqIQ0Mxq9LQ.org\n12  AAAAAAAAAAKFEAAA               Caryl              Stone  Caryl.Stone@QyV5SdgbY96DYyvvZ.edu\n13  AAAAAAAAAAKPDAAA            Kimberly              Lopez        Kimberly.Lopez@nHUAbnM8.com\n14  AAAAAAAAAALDBAAA              Mickey             Keaton      Mickey.Keaton@ub6HoiCe6RJ.com\n15  AAAAAAAAAALNBAAA               Ervin             Pedigo        Ervin.Pedigo@9SUTpqlpfp.edu\n16  AAAAAAAAAAMAGAAA               Hilda             Hanson       Hilda.Hanson@HUgo4LEObmL.org\n17  AAAAAAAAAAMEFAAA              Denise             Jarvis         Denise.Jarvis@x74JhODL.org\n18  AAAAAAAAAAMODAAA               Jason              Perez         Jason.Perez@usOYS5BvzB.org\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n         and t_w_secyear.dyear = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name             customer_email_address\n0   AAAAAAAAAAAJDAAA              Israel         Mclaughlin            Israel.Mclaughlin@d.com\n1   AAAAAAAAAADMAAAA               Linda             Fuller        Linda.Fuller@74cRU7hjaf.org\n2   AAAAAAAAAADOFAAA              Steven           Anderson         Steven.Anderson@vEZaBg.com\n3   AAAAAAAAAAFJGAAA                  Jo            Hibbard            Jo.Hibbard@2FcKvK7d.com\n4   AAAAAAAAAAGBGAAA             William            Sprouse                                   \n5   AAAAAAAAAAGMDAAA             Melissa               Holt      Melissa.Holt@p5GeTG2xSeae.com\n6   AAAAAAAAAAGNAAAA             Carlena             Garcia           Carlena.Garcia@UBIGZ.edu\n7   AAAAAAAAAAGPAAAA              Joseph              White      Joseph.White@ilHNcgs0jUaU.edu\n8   AAAAAAAAAAHNDAAA                                                Rudy.Roman@jhZrB2H7TX7.edu\n9   AAAAAAAAAAIODAAA               Karen             Pearce           Karen.Pearce@VLIDRMU.org\n10  AAAAAAAAAAJFCAAA                Mike             Hailey    Mike.Hailey@Spa5NxOfuj1CYLv.com\n11  AAAAAAAAAAJHDAAA             Anthony            Jackson    Anthony.Jackson@lqIQ0Mxq9LQ.org\n12  AAAAAAAAAAKFEAAA               Caryl              Stone  Caryl.Stone@QyV5SdgbY96DYyvvZ.edu\n13  AAAAAAAAAAKPDAAA            Kimberly              Lopez        Kimberly.Lopez@nHUAbnM8.com\n14  AAAAAAAAAALDBAAA              Mickey             Keaton      Mickey.Keaton@ub6HoiCe6RJ.com\n15  AAAAAAAAAALNBAAA               Ervin             Pedigo        Ervin.Pedigo@9SUTpqlpfp.edu\n16  AAAAAAAAAAMAGAAA               Hilda             Hanson       Hilda.Hanson@HUgo4LEObmL.org\n17  AAAAAAAAAAMEFAAA              Denise             Jarvis         Denise.Jarvis@x74JhODL.org\n18  AAAAAAAAAAMODAAA               Jason              Perez         Jason.Perez@usOYS5BvzB.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018805,
                    "execution_time": 0.008549,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.003882
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053692,
                    "execution_time": 0.008805,
                    "compile_time": 7.2e-05,
                    "planning_time": 0.038775
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name             customer_email_address\n0   AAAAAAAAAAAJDAAA              Israel         Mclaughlin            Israel.Mclaughlin@d.com\n1   AAAAAAAAAADMAAAA               Linda             Fuller        Linda.Fuller@74cRU7hjaf.org\n2   AAAAAAAAAADOFAAA              Steven           Anderson         Steven.Anderson@vEZaBg.com\n3   AAAAAAAAAAFJGAAA                  Jo            Hibbard            Jo.Hibbard@2FcKvK7d.com\n4   AAAAAAAAAAGBGAAA             William            Sprouse                                   \n5   AAAAAAAAAAGMDAAA             Melissa               Holt      Melissa.Holt@p5GeTG2xSeae.com\n6   AAAAAAAAAAGNAAAA             Carlena             Garcia           Carlena.Garcia@UBIGZ.edu\n7   AAAAAAAAAAGPAAAA              Joseph              White      Joseph.White@ilHNcgs0jUaU.edu\n8   AAAAAAAAAAHNDAAA                                                Rudy.Roman@jhZrB2H7TX7.edu\n9   AAAAAAAAAAIODAAA               Karen             Pearce           Karen.Pearce@VLIDRMU.org\n10  AAAAAAAAAAJFCAAA                Mike             Hailey    Mike.Hailey@Spa5NxOfuj1CYLv.com\n11  AAAAAAAAAAJHDAAA             Anthony            Jackson    Anthony.Jackson@lqIQ0Mxq9LQ.org\n12  AAAAAAAAAAKFEAAA               Caryl              Stone  Caryl.Stone@QyV5SdgbY96DYyvvZ.edu\n13  AAAAAAAAAAKPDAAA            Kimberly              Lopez        Kimberly.Lopez@nHUAbnM8.com\n14  AAAAAAAAAALDBAAA              Mickey             Keaton      Mickey.Keaton@ub6HoiCe6RJ.com\n15  AAAAAAAAAALNBAAA               Ervin             Pedigo        Ervin.Pedigo@9SUTpqlpfp.edu\n16  AAAAAAAAAAMAGAAA               Hilda             Hanson       Hilda.Hanson@HUgo4LEObmL.org\n17  AAAAAAAAAAMEFAAA              Denise             Jarvis         Denise.Jarvis@x74JhODL.org\n18  AAAAAAAAAAMODAAA               Jason              Perez         Jason.Perez@usOYS5BvzB.org\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n         and t_w_secyear.dyear = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n         ,t_s_secyear.customer_last_name\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name             customer_email_address\n0   AAAAAAAAAAAJDAAA              Israel         Mclaughlin            Israel.Mclaughlin@d.com\n1   AAAAAAAAAADMAAAA               Linda             Fuller        Linda.Fuller@74cRU7hjaf.org\n2   AAAAAAAAAADOFAAA              Steven           Anderson         Steven.Anderson@vEZaBg.com\n3   AAAAAAAAAAFJGAAA                  Jo            Hibbard            Jo.Hibbard@2FcKvK7d.com\n4   AAAAAAAAAAGBGAAA             William            Sprouse                                   \n5   AAAAAAAAAAGMDAAA             Melissa               Holt      Melissa.Holt@p5GeTG2xSeae.com\n6   AAAAAAAAAAGNAAAA             Carlena             Garcia           Carlena.Garcia@UBIGZ.edu\n7   AAAAAAAAAAGPAAAA              Joseph              White      Joseph.White@ilHNcgs0jUaU.edu\n8   AAAAAAAAAAHNDAAA                                                Rudy.Roman@jhZrB2H7TX7.edu\n9   AAAAAAAAAAIODAAA               Karen             Pearce           Karen.Pearce@VLIDRMU.org\n10  AAAAAAAAAAJFCAAA                Mike             Hailey    Mike.Hailey@Spa5NxOfuj1CYLv.com\n11  AAAAAAAAAAJHDAAA             Anthony            Jackson    Anthony.Jackson@lqIQ0Mxq9LQ.org\n12  AAAAAAAAAAKFEAAA               Caryl              Stone  Caryl.Stone@QyV5SdgbY96DYyvvZ.edu\n13  AAAAAAAAAAKPDAAA            Kimberly              Lopez        Kimberly.Lopez@nHUAbnM8.com\n14  AAAAAAAAAALDBAAA              Mickey             Keaton      Mickey.Keaton@ub6HoiCe6RJ.com\n15  AAAAAAAAAALNBAAA               Ervin             Pedigo        Ervin.Pedigo@9SUTpqlpfp.edu\n16  AAAAAAAAAAMAGAAA               Hilda             Hanson       Hilda.Hanson@HUgo4LEObmL.org\n17  AAAAAAAAAAMEFAAA              Denise             Jarvis         Denise.Jarvis@x74JhODL.org\n18  AAAAAAAAAAMODAAA               Jason              Perez         Jason.Perez@usOYS5BvzB.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017808,
                    "execution_time": 0.007847,
                    "compile_time": 7.3e-05,
                    "planning_time": 0.003893
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053815,
                    "execution_time": 0.008723,
                    "compile_time": 7.1e-05,
                    "planning_time": 0.038913
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" NULLS LAST"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name             customer_email_address\n0   AAAAAAAAAAAJDAAA              Israel         Mclaughlin            Israel.Mclaughlin@d.com\n1   AAAAAAAAAADMAAAA               Linda             Fuller        Linda.Fuller@74cRU7hjaf.org\n2   AAAAAAAAAADOFAAA              Steven           Anderson         Steven.Anderson@vEZaBg.com\n3   AAAAAAAAAAFJGAAA                  Jo            Hibbard            Jo.Hibbard@2FcKvK7d.com\n4   AAAAAAAAAAGBGAAA             William            Sprouse                                   \n5   AAAAAAAAAAGMDAAA             Melissa               Holt      Melissa.Holt@p5GeTG2xSeae.com\n6   AAAAAAAAAAGNAAAA             Carlena             Garcia           Carlena.Garcia@UBIGZ.edu\n7   AAAAAAAAAAGPAAAA              Joseph              White      Joseph.White@ilHNcgs0jUaU.edu\n8   AAAAAAAAAAHNDAAA                                                Rudy.Roman@jhZrB2H7TX7.edu\n9   AAAAAAAAAAIODAAA               Karen             Pearce           Karen.Pearce@VLIDRMU.org\n10  AAAAAAAAAAJFCAAA                Mike             Hailey    Mike.Hailey@Spa5NxOfuj1CYLv.com\n11  AAAAAAAAAAJHDAAA             Anthony            Jackson    Anthony.Jackson@lqIQ0Mxq9LQ.org\n12  AAAAAAAAAAKFEAAA               Caryl              Stone  Caryl.Stone@QyV5SdgbY96DYyvvZ.edu\n13  AAAAAAAAAAKPDAAA            Kimberly              Lopez        Kimberly.Lopez@nHUAbnM8.com\n14  AAAAAAAAAALDBAAA              Mickey             Keaton      Mickey.Keaton@ub6HoiCe6RJ.com\n15  AAAAAAAAAALNBAAA               Ervin             Pedigo        Ervin.Pedigo@9SUTpqlpfp.edu\n16  AAAAAAAAAAMAGAAA               Hilda             Hanson       Hilda.Hanson@HUgo4LEObmL.org\n17  AAAAAAAAAAMEFAAA              Denise             Jarvis         Denise.Jarvis@x74JhODL.org\n18  AAAAAAAAAAMODAAA               Jason              Perez         Jason.Perez@usOYS5BvzB.org\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n         and t_w_secyear.dyear = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n         ,t_s_secyear.customer_last_name\n         ,t_s_secyear.customer_email_address\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name             customer_email_address\n0   AAAAAAAAAAAJDAAA              Israel         Mclaughlin            Israel.Mclaughlin@d.com\n1   AAAAAAAAAADMAAAA               Linda             Fuller        Linda.Fuller@74cRU7hjaf.org\n2   AAAAAAAAAADOFAAA              Steven           Anderson         Steven.Anderson@vEZaBg.com\n3   AAAAAAAAAAFJGAAA                  Jo            Hibbard            Jo.Hibbard@2FcKvK7d.com\n4   AAAAAAAAAAGBGAAA             William            Sprouse                                   \n5   AAAAAAAAAAGMDAAA             Melissa               Holt      Melissa.Holt@p5GeTG2xSeae.com\n6   AAAAAAAAAAGNAAAA             Carlena             Garcia           Carlena.Garcia@UBIGZ.edu\n7   AAAAAAAAAAGPAAAA              Joseph              White      Joseph.White@ilHNcgs0jUaU.edu\n8   AAAAAAAAAAHNDAAA                                                Rudy.Roman@jhZrB2H7TX7.edu\n9   AAAAAAAAAAIODAAA               Karen             Pearce           Karen.Pearce@VLIDRMU.org\n10  AAAAAAAAAAJFCAAA                Mike             Hailey    Mike.Hailey@Spa5NxOfuj1CYLv.com\n11  AAAAAAAAAAJHDAAA             Anthony            Jackson    Anthony.Jackson@lqIQ0Mxq9LQ.org\n12  AAAAAAAAAAKFEAAA               Caryl              Stone  Caryl.Stone@QyV5SdgbY96DYyvvZ.edu\n13  AAAAAAAAAAKPDAAA            Kimberly              Lopez        Kimberly.Lopez@nHUAbnM8.com\n14  AAAAAAAAAALDBAAA              Mickey             Keaton      Mickey.Keaton@ub6HoiCe6RJ.com\n15  AAAAAAAAAALNBAAA               Ervin             Pedigo        Ervin.Pedigo@9SUTpqlpfp.edu\n16  AAAAAAAAAAMAGAAA               Hilda             Hanson       Hilda.Hanson@HUgo4LEObmL.org\n17  AAAAAAAAAAMEFAAA              Denise             Jarvis         Denise.Jarvis@x74JhODL.org\n18  AAAAAAAAAAMODAAA               Jason              Perez         Jason.Perez@usOYS5BvzB.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017685,
                    "execution_time": 0.007899,
                    "compile_time": 8.3e-05,
                    "planning_time": 0.003887
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053793,
                    "execution_time": 0.008207,
                    "compile_time": 7.5e-05,
                    "planning_time": 0.039313
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name             customer_email_address\n0   AAAAAAAAAAAJDAAA              Israel         Mclaughlin            Israel.Mclaughlin@d.com\n1   AAAAAAAAAADMAAAA               Linda             Fuller        Linda.Fuller@74cRU7hjaf.org\n2   AAAAAAAAAADOFAAA              Steven           Anderson         Steven.Anderson@vEZaBg.com\n3   AAAAAAAAAAFJGAAA                  Jo            Hibbard            Jo.Hibbard@2FcKvK7d.com\n4   AAAAAAAAAAGBGAAA             William            Sprouse                                   \n5   AAAAAAAAAAGMDAAA             Melissa               Holt      Melissa.Holt@p5GeTG2xSeae.com\n6   AAAAAAAAAAGNAAAA             Carlena             Garcia           Carlena.Garcia@UBIGZ.edu\n7   AAAAAAAAAAGPAAAA              Joseph              White      Joseph.White@ilHNcgs0jUaU.edu\n8   AAAAAAAAAAHNDAAA                                                Rudy.Roman@jhZrB2H7TX7.edu\n9   AAAAAAAAAAIODAAA               Karen             Pearce           Karen.Pearce@VLIDRMU.org\n10  AAAAAAAAAAJFCAAA                Mike             Hailey    Mike.Hailey@Spa5NxOfuj1CYLv.com\n11  AAAAAAAAAAJHDAAA             Anthony            Jackson    Anthony.Jackson@lqIQ0Mxq9LQ.org\n12  AAAAAAAAAAKFEAAA               Caryl              Stone  Caryl.Stone@QyV5SdgbY96DYyvvZ.edu\n13  AAAAAAAAAAKPDAAA            Kimberly              Lopez        Kimberly.Lopez@nHUAbnM8.com\n14  AAAAAAAAAALDBAAA              Mickey             Keaton      Mickey.Keaton@ub6HoiCe6RJ.com\n15  AAAAAAAAAALNBAAA               Ervin             Pedigo        Ervin.Pedigo@9SUTpqlpfp.edu\n16  AAAAAAAAAAMAGAAA               Hilda             Hanson       Hilda.Hanson@HUgo4LEObmL.org\n17  AAAAAAAAAAMEFAAA              Denise             Jarvis         Denise.Jarvis@x74JhODL.org\n18  AAAAAAAAAAMODAAA               Jason              Perez         Jason.Perez@usOYS5BvzB.org\n...*/"
    },
    {
        "input": "-- start template query11.tpl query 51 in stream 0\nwith /* TPC-DS query11.tpl 0.51 */ year_total as (\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ss_ext_list_price-ss_ext_discount_amt) year_total\n       ,'s' sale_type\n from customer\n     ,store_sales\n     ,date_dim\n where c_customer_sk = ss_customer_sk\n   and ss_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year \n union all\n select c_customer_id customer_id\n       ,c_first_name customer_first_name\n       ,c_last_name customer_last_name\n       ,c_preferred_cust_flag customer_preferred_cust_flag\n       ,c_birth_country customer_birth_country\n       ,c_login customer_login\n       ,c_email_address customer_email_address\n       ,d_year dyear\n       ,sum(ws_ext_list_price-ws_ext_discount_amt) year_total\n       ,'w' sale_type\n from customer\n     ,web_sales\n     ,date_dim\n where c_customer_sk = ws_bill_customer_sk\n   and ws_sold_date_sk = d_date_sk\n group by c_customer_id\n         ,c_first_name\n         ,c_last_name\n         ,c_preferred_cust_flag \n         ,c_birth_country\n         ,c_login\n         ,c_email_address\n         ,d_year\n         )\n  select  \n                  t_s_secyear.customer_id\n                 ,t_s_secyear.customer_first_name\n                 ,t_s_secyear.customer_last_name\n                 ,t_s_secyear.customer_email_address\n from year_total t_s_firstyear\n     ,year_total t_s_secyear\n     ,year_total t_w_firstyear\n     ,year_total t_w_secyear\n where t_s_secyear.customer_id = t_s_firstyear.customer_id\n         and t_s_firstyear.customer_id = t_w_secyear.customer_id\n         and t_s_firstyear.customer_id = t_w_firstyear.customer_id\n         and t_s_firstyear.sale_type = 's'\n         and t_w_firstyear.sale_type = 'w'\n         and t_s_secyear.sale_type = 's'\n         and t_w_secyear.sale_type = 'w'\n         and t_s_firstyear.dyear = 1998\n         and t_s_secyear.dyear = 1998+1\n         and t_w_firstyear.dyear = 1998\n         and t_w_secyear.dyear = 1998+1\n         and t_s_firstyear.year_total > 0\n         and t_w_firstyear.year_total > 0\n         and case when t_w_firstyear.year_total > 0 then t_w_secyear.year_total / t_w_firstyear.year_total else 0.0 end\n             > case when t_s_firstyear.year_total > 0 then t_s_secyear.year_total / t_s_firstyear.year_total else 0.0 end\n order by t_s_secyear.customer_id\n         ,t_s_secyear.customer_first_name\n         ,t_s_secyear.customer_last_name\n         ,t_s_secyear.customer_email_address\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"CUSTOMER_2\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_SK\" AS \"C_CUSTOMER_SK\" , \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" AS \"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" AS \"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"C_EMAIL_ADDRESS\" FROM \"CUSTOMER\" AS \"CUSTOMER\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_YEAR\" AS \"D_YEAR\" FROM \"DATE_DIM\" AS \"DATE_DIM\" ) , \"YEAR_TOTAL\" AS ( SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"STORE_SALES\".\"SS_EXT_LIST_PRICE\" - \"STORE_SALES\".\"SS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 's' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"STORE_SALES\" AS \"STORE_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"STORE_SALES\".\"SS_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" UNION ALL SELECT \"CUSTOMER\".\"C_CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" AS \"DYEAR\" , SUM ( \"WEB_SALES\".\"WS_EXT_LIST_PRICE\" - \"WEB_SALES\".\"WS_EXT_DISCOUNT_AMT\" ) AS \"YEAR_TOTAL\" , 'w' AS \"SALE_TYPE\" FROM \"CUSTOMER_2\" AS \"CUSTOMER\" JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"WEB_SALES\".\"WS_BILL_CUSTOMER_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"WEB_SALES\".\"WS_SOLD_DATE_SK\" GROUP BY \"CUSTOMER\".\"C_CUSTOMER_ID\" , \"CUSTOMER\".\"C_FIRST_NAME\" , \"CUSTOMER\".\"C_LAST_NAME\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" , \"CUSTOMER\".\"C_BIRTH_COUNTRY\" , \"CUSTOMER\".\"C_LOGIN\" , \"CUSTOMER\".\"C_EMAIL_ADDRESS\" , \"DATE_DIM\".\"D_YEAR\" ) SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"YEAR_TOTAL\" AS \"T_S_FIRSTYEAR\" JOIN \"YEAR_TOTAL\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"YEAR_TOTAL\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"YEAR_TOTAL\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" LIMIT 21",
                "preview": "\n/*         customer_id customer_first_name customer_last_name             customer_email_address\n0   AAAAAAAAAAAJDAAA              Israel         Mclaughlin            Israel.Mclaughlin@d.com\n1   AAAAAAAAAADMAAAA               Linda             Fuller        Linda.Fuller@74cRU7hjaf.org\n2   AAAAAAAAAADOFAAA              Steven           Anderson         Steven.Anderson@vEZaBg.com\n3   AAAAAAAAAAFJGAAA                  Jo            Hibbard            Jo.Hibbard@2FcKvK7d.com\n4   AAAAAAAAAAGBGAAA             William            Sprouse                                   \n5   AAAAAAAAAAGMDAAA             Melissa               Holt      Melissa.Holt@p5GeTG2xSeae.com\n6   AAAAAAAAAAGNAAAA             Carlena             Garcia           Carlena.Garcia@UBIGZ.edu\n7   AAAAAAAAAAGPAAAA              Joseph              White      Joseph.White@ilHNcgs0jUaU.edu\n8   AAAAAAAAAAHNDAAA                                                Rudy.Roman@jhZrB2H7TX7.edu\n9   AAAAAAAAAAIODAAA               Karen             Pearce           Karen.Pearce@VLIDRMU.org\n10  AAAAAAAAAAJFCAAA                Mike             Hailey    Mike.Hailey@Spa5NxOfuj1CYLv.com\n11  AAAAAAAAAAJHDAAA             Anthony            Jackson    Anthony.Jackson@lqIQ0Mxq9LQ.org\n12  AAAAAAAAAAKFEAAA               Caryl              Stone  Caryl.Stone@QyV5SdgbY96DYyvvZ.edu\n13  AAAAAAAAAAKPDAAA            Kimberly              Lopez        Kimberly.Lopez@nHUAbnM8.com\n14  AAAAAAAAAALDBAAA              Mickey             Keaton      Mickey.Keaton@ub6HoiCe6RJ.com\n15  AAAAAAAAAALNBAAA               Ervin             Pedigo        Ervin.Pedigo@9SUTpqlpfp.edu\n16  AAAAAAAAAAMAGAAA               Hilda             Hanson       Hilda.Hanson@HUgo4LEObmL.org\n17  AAAAAAAAAAMEFAAA              Denise             Jarvis         Denise.Jarvis@x74JhODL.org\n18  AAAAAAAAAAMODAAA               Jason              Perez         Jason.Perez@usOYS5BvzB.org\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017947,
                    "execution_time": 0.00807,
                    "compile_time": 7.1e-05,
                    "planning_time": 0.003925
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.01936,
                    "execution_time": 0.008859,
                    "compile_time": 7.4e-05,
                    "planning_time": 0.004186
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"T_S_SECYEAR\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_FIRSTYEAR\" JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_S_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_S_SECYEAR\".\"CUSTOMER_ID\" AND \"T_S_SECYEAR\".\"DYEAR\" = 1999 AND \"T_S_SECYEAR\".\"SALE_TYPE\" = 's' JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_FIRSTYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_FIRSTYEAR\".\"CUSTOMER_ID\" AND \"T_W_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_W_FIRSTYEAR\".\"SALE_TYPE\" = 'w' AND \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 JOIN \"SPEQLITE_TEMP_TABLE_8\" AS \"T_W_SECYEAR\" ON \"T_S_FIRSTYEAR\".\"CUSTOMER_ID\" = \"T_W_SECYEAR\".\"CUSTOMER_ID\" AND \"T_W_SECYEAR\".\"DYEAR\" = 1999 AND \"T_W_SECYEAR\".\"SALE_TYPE\" = 'w' AND CASE WHEN \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_S_SECYEAR\".\"YEAR_TOTAL\" / \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END < CASE WHEN \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 THEN \"T_W_SECYEAR\".\"YEAR_TOTAL\" / \"T_W_FIRSTYEAR\".\"YEAR_TOTAL\" ELSE 0.0 END WHERE \"T_S_FIRSTYEAR\".\"DYEAR\" = 1998 AND \"T_S_FIRSTYEAR\".\"SALE_TYPE\" = 's' AND \"T_S_FIRSTYEAR\".\"YEAR_TOTAL\" > 0 ORDER BY \"T_S_SECYEAR\".\"CUSTOMER_ID\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"T_S_SECYEAR\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" AS \"CUSTOMER_ID\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" AS \"CUSTOMER_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" AS \"CUSTOMER_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" AS \"CUSTOMER_EMAIL_ADDRESS\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" ORDER BY \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_ID\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_FIRST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_LAST_NAME\" NULLS LAST , \"SPEQLITE_TEMP_TABLE_11\".\"CUSTOMER_EMAIL_ADDRESS\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*         customer_id customer_first_name customer_last_name             customer_email_address\n0   AAAAAAAAAAAJDAAA              Israel         Mclaughlin            Israel.Mclaughlin@d.com\n1   AAAAAAAAAADMAAAA               Linda             Fuller        Linda.Fuller@74cRU7hjaf.org\n2   AAAAAAAAAADOFAAA              Steven           Anderson         Steven.Anderson@vEZaBg.com\n3   AAAAAAAAAAFJGAAA                  Jo            Hibbard            Jo.Hibbard@2FcKvK7d.com\n4   AAAAAAAAAAGBGAAA             William            Sprouse                                   \n5   AAAAAAAAAAGMDAAA             Melissa               Holt      Melissa.Holt@p5GeTG2xSeae.com\n6   AAAAAAAAAAGNAAAA             Carlena             Garcia           Carlena.Garcia@UBIGZ.edu\n7   AAAAAAAAAAGPAAAA              Joseph              White      Joseph.White@ilHNcgs0jUaU.edu\n8   AAAAAAAAAAHNDAAA                                                Rudy.Roman@jhZrB2H7TX7.edu\n9   AAAAAAAAAAIODAAA               Karen             Pearce           Karen.Pearce@VLIDRMU.org\n10  AAAAAAAAAAJFCAAA                Mike             Hailey    Mike.Hailey@Spa5NxOfuj1CYLv.com\n11  AAAAAAAAAAJHDAAA             Anthony            Jackson    Anthony.Jackson@lqIQ0Mxq9LQ.org\n12  AAAAAAAAAAKFEAAA               Caryl              Stone  Caryl.Stone@QyV5SdgbY96DYyvvZ.edu\n13  AAAAAAAAAAKPDAAA            Kimberly              Lopez        Kimberly.Lopez@nHUAbnM8.com\n14  AAAAAAAAAALDBAAA              Mickey             Keaton      Mickey.Keaton@ub6HoiCe6RJ.com\n15  AAAAAAAAAALNBAAA               Ervin             Pedigo        Ervin.Pedigo@9SUTpqlpfp.edu\n16  AAAAAAAAAAMAGAAA               Hilda             Hanson       Hilda.Hanson@HUgo4LEObmL.org\n17  AAAAAAAAAAMEFAAA              Denise             Jarvis         Denise.Jarvis@x74JhODL.org\n18  AAAAAAAAAAMODAAA               Jason              Perez         Jason.Perez@usOYS5BvzB.org\n...*/"
    }
]