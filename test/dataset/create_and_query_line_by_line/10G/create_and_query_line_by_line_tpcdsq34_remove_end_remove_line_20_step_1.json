[
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n          from store_sales\n          group by ss_ticket_number, ss_customer_sk) as subquery\njoin customer on customer.c_customer_sk = subquery.ss_customer_sk /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SUBQUERY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.54442,
                    "execution_time": 0.372239,
                    "compile_time": 0.000283,
                    "planning_time": 0.026088,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.623795,
                    "execution_time": 0.384913,
                    "compile_time": 0.000277,
                    "planning_time": 0.087041,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.933906,
                    "execution_time": 0.488551,
                    "compile_time": 0.000457,
                    "planning_time": 0.025936,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.952523,
                    "execution_time": 0.499119,
                    "compile_time": 0.000441,
                    "planning_time": 0.025771,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_2\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0         Amos      Phillip          Dr.                     N              8971   10\n1       Curtis     Adelaida          Ms.                     Y           1283614   13\n2        Curry      Loraine          Ms.                     Y              9043    9\n3        Clark      Michele         Miss                     Y           2109715   11\n4        Smith        David          Dr.                     N           1434439   11\n5       Wright       Norman          Sir                     Y            387332   12\n6       Valdez       Keneth          Mr.                     N           1288109   10\n7       Harris       Brenda         Miss                     N           1212850    8\n8       Miller          Amy          Ms.                     Y             89146    7\n9     Hartmann      William          Dr.                     Y            841154   10\n10       Lewis       Walker          Dr.                     N           2342515    9\n11      Manuel                      Mrs.                                 1215780   10\n12       Smith         Lisa          Dr.                     N            917267    9\n13     Oconner        James          Sir                     Y           1892488   16\n14    Franklin          Ian          Mr.                     Y           2194745   15\n15   Alexander     Kathleen          Ms.                     N           2120164    9\n16         Cox       Martha          Ms.                     Y           1593980   14\n17       Woods     Jennifer          Dr.                     N             96381   10\n18        Vega         John          Mr.                     N           1671430   12\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017852,
                    "execution_time": 0.007838,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003725
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.067382,
                    "execution_time": 0.007945,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.039043
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_1\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_2\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_2\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_2\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0         Amos      Phillip          Dr.                     N              8971   10\n1       Curtis     Adelaida          Ms.                     Y           1283614   13\n2        Curry      Loraine          Ms.                     Y              9043    9\n3        Clark      Michele         Miss                     Y           2109715   11\n4        Smith        David          Dr.                     N           1434439   11\n5       Wright       Norman          Sir                     Y            387332   12\n6       Valdez       Keneth          Mr.                     N           1288109   10\n7       Harris       Brenda         Miss                     N           1212850    8\n8       Miller          Amy          Ms.                     Y             89146    7\n9     Hartmann      William          Dr.                     Y            841154   10\n10       Lewis       Walker          Dr.                     N           2342515    9\n11      Manuel                      Mrs.                                 1215780   10\n12       Smith         Lisa          Dr.                     N            917267    9\n13     Oconner        James          Sir                     Y           1892488   16\n14    Franklin          Ian          Mr.                     Y           2194745   15\n15   Alexander     Kathleen          Ms.                     N           2120164    9\n16         Cox       Martha          Ms.                     Y           1593980   14\n17       Woods     Jennifer          Dr.                     N             96381   10\n18        Vega         John          Mr.                     N           1671430   12\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ ss_ticket_number\n       \n       \n       \n       \n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n          group by ss_ticket_number, ss_customer_sk) as subquery /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_1\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.349453,
                    "execution_time": 0.235892,
                    "compile_time": 0.000254,
                    "planning_time": 0.002969,
                    "create_size": 640
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.41096,
                    "execution_time": 0.234624,
                    "compile_time": 0.000247,
                    "planning_time": 0.059923,
                    "create_size": 640
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*    ss_ticket_number  cnt\n0            1711114   10\n1            1711114    1\n2            1040867   13\n3             508973    8\n4            1041559   15\n5            1042168   10\n6            2090285    7\n7            2090285    1\n8            2092670   11\n9             212078   11\n10           2316910    8\n11           2316910    1\n12           1268602   13\n13           1268602    1\n14           1636696   13\n15           1193829   11\n16           1638217   14\n17            818739   15\n18            818739    1\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.016931,
                    "execution_time": 0.007767,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.00316
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.0537,
                    "execution_time": 0.007397,
                    "compile_time": 4.3e-05,
                    "planning_time": 0.037742
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_3\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*    ss_ticket_number  cnt\n0            1711114   10\n1            1711114    1\n2            1040867   13\n3             508973    8\n4            1041559   15\n5            1042168   10\n6            2090285    7\n7            2090285    1\n8            2092670   11\n9             212078   11\n10           2316910    8\n11           2316910    1\n12           1268602   13\n13           1268602    1\n14           1636696   13\n15           1193829   11\n16           1638217   14\n17            818739   15\n18            818739    1\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n          group by ss_ticket_number, ss_customer_sk) as subquery /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SUBQUERY AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH SUBQUERY AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\"",
                "rewrite": "WITH SUBQUERY AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" CROSS JOIN \"STORE\" AS \"STORE\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n          group by ss_ticket_number, ss_customer_sk) as subquery /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SUBQUERY AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 15,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "WITH SUBQUERY AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\"",
                "rewrite": "WITH SUBQUERY AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"SUBQUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
            }
        ],
        "preview": null
    },
    {
        "input": "select /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales\n    join date_dim on store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    join store on store_sales.ss_store_sk = store.s_store_sk\n    join household_demographics on store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    group by ss_ticket_number, ss_customer_sk\n   ) as sales_summary\njoin customer on sales_summary.ss_customer_sk = customer.c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"CNT\" AS \"CNT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.685446,
                    "execution_time": 0.476957,
                    "compile_time": 0.00038,
                    "planning_time": 0.046451,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.920219,
                    "execution_time": 0.614982,
                    "compile_time": 0.000393,
                    "planning_time": 0.125917,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_5\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_4\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_4\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.924209,
                    "execution_time": 0.47812,
                    "compile_time": 0.000458,
                    "planning_time": 0.025658,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.990662,
                    "execution_time": 0.476017,
                    "compile_time": 0.000447,
                    "planning_time": 0.08809,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0       Newton      William          Mr.                     N           1775929    8\n1       Peters       Thomas          Dr.                     N           1776206   16\n2         Long        James          Sir                     Y           1032105   12\n3        Cheng      Heather          Ms.                     Y           2159858   13\n4        Brown      Donnell          Mr.                     Y           1256667   13\n5    Velasquez      Jeffrey          Mr.                     Y            961144   14\n6     Schwartz         Lili         Miss                     Y           2006525    8\n7      Perkins      Loretta         Mrs.                     Y            965241   11\n8         Reis      Raymond          Dr.                     N            444268   10\n9     Roberson        Brent          Sir                     Y            667237   13\n10     Winkler      Charles          Sir                     Y           1873685    9\n11         Lau         Rosa          Dr.                     Y           2172987    8\n12        York       Edward          Dr.                     N           1636934    8\n13       Haney        David          Dr.                     N            294661    8\n14      Newton        Taryn         Mrs.                     N           1047636   10\n15      Guerra       Dennis          Dr.                     N           1048820   14\n16     Sherman       Harvey          Sir                     Y            897774    9\n17    Thompson        Maude         Mrs.                     N            298242    9\n18     Winters        India          Dr.                     Y            819841   12\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017495,
                    "execution_time": 0.007462,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003802
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.05357,
                    "execution_time": 0.008298,
                    "compile_time": 4.5e-05,
                    "planning_time": 0.038873
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_4\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_4\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_4\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_5\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_5\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_5\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_5\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_5\" AS \"SPEQLITE_TEMP_TABLE_5\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0       Newton      William          Mr.                     N           1775929    8\n1       Peters       Thomas          Dr.                     N           1776206   16\n2         Long        James          Sir                     Y           1032105   12\n3        Cheng      Heather          Ms.                     Y           2159858   13\n4        Brown      Donnell          Mr.                     Y           1256667   13\n5    Velasquez      Jeffrey          Mr.                     Y            961144   14\n6     Schwartz         Lili         Miss                     Y           2006525    8\n7      Perkins      Loretta         Mrs.                     Y            965241   11\n8         Reis      Raymond          Dr.                     N            444268   10\n9     Roberson        Brent          Sir                     Y            667237   13\n10     Winkler      Charles          Sir                     Y           1873685    9\n11         Lau         Rosa          Dr.                     Y           2172987    8\n12        York       Edward          Dr.                     N           1636934    8\n13       Haney        David          Dr.                     N            294661    8\n14      Newton        Taryn         Mrs.                     N           1047636   10\n15      Guerra       Dennis          Dr.                     N           1048820   14\n16     Sherman       Harvey          Sir                     Y            897774    9\n17    Thompson        Maude         Mrs.                     N            298242    9\n18     Winters        India          Dr.                     Y            819841   12\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales\n    join date_dim on store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    join store on store_sales.ss_store_sk = store.s_store_sk  \n    join household_demographics on store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    where (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    group by ss_ticket_number, ss_customer_sk) as subquery_name\njoin customer on subquery_name.ss_customer_sk = customer.c_customer_sk\nwhere customer.c_preferred_cust_flag = 'Y'\nand subquery_name.cnt > 1\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SUBQUERY_NAME\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SUBQUERY_NAME\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY_NAME\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY_NAME\" AS \"SUBQUERY_NAME\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SUBQUERY_NAME\".\"SS_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" = 'Y' WHERE \"SUBQUERY_NAME\".\"CNT\" > 1"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_6\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" WHERE ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.513086,
                    "execution_time": 0.298876,
                    "compile_time": 0.000379,
                    "planning_time": 0.052263,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.595092,
                    "execution_time": 0.304981,
                    "compile_time": 0.000395,
                    "planning_time": 0.125333,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_7\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_6\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"SS_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" = 'Y' WHERE \"SPEQLITE_TEMP_TABLE_6\".\"CNT\" > 1",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.687442,
                    "execution_time": 0.146399,
                    "compile_time": 0.112627,
                    "planning_time": 0.027624,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.0463,
                    "execution_time": 0.16266,
                    "compile_time": 6.370747,
                    "planning_time": 0.088015,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Parra         Shad          Sir                     Y           1406597   13\n1        Eason      Delbert          Mr.                     Y           2174886   13\n2      Jackson       Martha          Ms.                     Y           1071542    5\n3       Yazzie       Joseph          Sir                     Y           2126612   11\n4       Norman                       Dr.                     Y           1375442   12\n5       Gordon      Carolyn          Dr.                     Y           1325257   10\n6          Cox        David          Mr.                     Y           2099637   16\n7       Albert      Michael          Sir                     Y            387699   12\n8       Curtis        James          Mr.                     Y           1672736   12\n9      Merritt       Bertha         Mrs.                     Y           2162020    9\n10      Aviles      Clifton          Sir                     Y            444719    9\n11       Combs     Florence          Ms.                     Y            165307    9\n12      Weaver      Matthew          Sir                     Y           1328173    8\n13       Ellis       Edwina          Dr.                     Y           2207865    8\n14   Hightower         Lois         Miss                     Y            639039    9\n15   Hernandez         Leon          Sir                     Y            617465    9\n16  Cartwright       Pamela         Mrs.                     Y            750232   13\n17      George                       Sir                     Y            386258   10\n18       Young       Thelma         Mrs.                     Y           1974460    9\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017761,
                    "execution_time": 0.007563,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.003806
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056105,
                    "execution_time": 0.008086,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.038877
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_6\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_6\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_6\" AS \"SPEQLITE_TEMP_TABLE_6\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_6\".\"SS_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" = 'Y' WHERE \"SPEQLITE_TEMP_TABLE_6\".\"CNT\" > 1",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_7\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_7\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_7\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_7\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_7\" AS \"SPEQLITE_TEMP_TABLE_7\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Parra         Shad          Sir                     Y           1406597   13\n1        Eason      Delbert          Mr.                     Y           2174886   13\n2      Jackson       Martha          Ms.                     Y           1071542    5\n3       Yazzie       Joseph          Sir                     Y           2126612   11\n4       Norman                       Dr.                     Y           1375442   12\n5       Gordon      Carolyn          Dr.                     Y           1325257   10\n6          Cox        David          Mr.                     Y           2099637   16\n7       Albert      Michael          Sir                     Y            387699   12\n8       Curtis        James          Mr.                     Y           1672736   12\n9      Merritt       Bertha         Mrs.                     Y           2162020    9\n10      Aviles      Clifton          Sir                     Y            444719    9\n11       Combs     Florence          Ms.                     Y            165307    9\n12      Weaver      Matthew          Sir                     Y           1328173    8\n13       Ellis       Edwina          Dr.                     Y           2207865    8\n14   Hightower         Lois         Miss                     Y            639039    9\n15   Hernandez         Leon          Sir                     Y            617465    9\n16  Cartwright       Pamela         Mrs.                     Y            750232   13\n17      George                       Sir                     Y            386258   10\n18       Young       Thelma         Mrs.                     Y           1974460    9\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales, date_dim, store, household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n          household_demographics.hd_buy_potential = '1001-1500')\n    group by ss_ticket_number, ss_customer_sk) as sales_data\n   join customer on sales_data.ss_customer_sk = customer.c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALES_DATA\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-1500' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_DATA\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_DATA\".\"CNT\" AS \"CNT\" FROM \"SALES_DATA\" AS \"SALES_DATA\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_DATA\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_8\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '1001-1500' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.244889,
                    "execution_time": 0.105792,
                    "compile_time": 0.000379,
                    "planning_time": 0.049154,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.451708,
                    "execution_time": 0.230961,
                    "compile_time": 0.000397,
                    "planning_time": 0.124558,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_9\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.290919,
                    "execution_time": 0.074972,
                    "compile_time": 0.000316,
                    "planning_time": 0.02553,
                    "create_size": 1080
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.365445,
                    "execution_time": 0.074391,
                    "compile_time": 0.000315,
                    "planning_time": 0.09482,
                    "create_size": 1080
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_9\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Brady      Mildred          Dr.                     Y           1730866   12\n1       Folsom       Joseph          Sir                     N           1399872   12\n2        Rubin         John          Dr.                     N           1138507   15\n3     Hammonds      Darrell          Mr.                     N            827833   12\n4      Bradley         Ruby         Miss                     N           1453403   10\n5        Brown       Carole         Miss                     N           1201808    6\n6        Wells        Hazel          Dr.                     Y           1150337    9\n7       Downey       Claude          Mr.                     N           1642328   10\n8       Taylor      Melissa         Miss                     Y           1913146   12\n9         Pham         Beth          Dr.                     Y           1844720   11\n10     Spencer       Tyrell          Sir                     Y           1339785   12\n11       Means        Linda          Ms.                     N            856588   13\n12    Santiago         John          Dr.                     N            359268   11\n13   Jefferson       Dennis          Sir                     N            697071    9\n14       Mills        David          Dr.                     Y           2357295   12\n15       Brown         John          Mr.                     Y           1252861   10\n16       Brown         John          Mr.                     Y           2178740   15\n17       Smith       Sandra          Dr.                     Y            116358   13\n18        King       Denver                                  N           1757466   12\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017808,
                    "execution_time": 0.007418,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.004008
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057348,
                    "execution_time": 0.007897,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.039673
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_8\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_8\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_8\" AS \"SPEQLITE_TEMP_TABLE_8\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_8\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_9\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_9\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_9\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_9\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_9\" AS \"SPEQLITE_TEMP_TABLE_9\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0        Brady      Mildred          Dr.                     Y           1730866   12\n1       Folsom       Joseph          Sir                     N           1399872   12\n2        Rubin         John          Dr.                     N           1138507   15\n3     Hammonds      Darrell          Mr.                     N            827833   12\n4      Bradley         Ruby         Miss                     N           1453403   10\n5        Brown       Carole         Miss                     N           1201808    6\n6        Wells        Hazel          Dr.                     Y           1150337    9\n7       Downey       Claude          Mr.                     N           1642328   10\n8       Taylor      Melissa         Miss                     Y           1913146   12\n9         Pham         Beth          Dr.                     Y           1844720   11\n10     Spencer       Tyrell          Sir                     Y           1339785   12\n11       Means        Linda          Ms.                     N            856588   13\n12    Santiago         John          Dr.                     N            359268   11\n13   Jefferson       Dennis          Sir                     N            697071    9\n14       Mills        David          Dr.                     Y           2357295   12\n15       Brown         John          Mr.                     Y           1252861   10\n16       Brown         John          Mr.                     Y           2178740   15\n17       Smith       Sandra          Dr.                     Y            116358   13\n18        King       Denver                                  N           1757466   12\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n   ) as subquery_name\n   join customer on subquery_name.ss_customer_sk = customer.c_customer_sk\n",
        "optimize": [
            "WITH \"SUBQUERY_NAME\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SUBQUERY_NAME\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SUBQUERY_NAME\".\"CNT\" AS \"CNT\" FROM \"SUBQUERY_NAME\" AS \"SUBQUERY_NAME\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SUBQUERY_NAME\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_10\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.333789,
                    "execution_time": 0.116296,
                    "compile_time": 0.000416,
                    "planning_time": 0.057284,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.408733,
                    "execution_time": 0.116762,
                    "compile_time": 0.000442,
                    "planning_time": 0.124699,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_11\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_10\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.516376,
                    "execution_time": 0.095314,
                    "compile_time": 0.00046,
                    "planning_time": 0.027244,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.699583,
                    "execution_time": 0.094419,
                    "compile_time": 0.120093,
                    "planning_time": 0.08916,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_11\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0         Diaz         Gary          Dr.                     N            314293   11\n1       Murray      Charles          Dr.                     Y           1046666   14\n2     Clifford        Derek          Mr.                     N           1991816   13\n3     Clifford        Derek          Mr.                     N            322766   12\n4       Runyon       George          Dr.                     Y           2010710   13\n5        Allen         Rick          Sir                     Y           1128658   12\n6     Stephens        Nancy          Ms.                     Y           1666872   13\n7                                                                        2217281   12\n8        Joyce         Erma         Miss                     N            847437   10\n9       Arnold    Carmelita         Miss                     Y           1493226   15\n10       Nolan        Larry          Sir                     N           1420676    7\n11       Nolan        Larry          Sir                     N           1981891   11\n12     Rushing        Brian          Sir                     N           1683069   11\n13        Pond        Edwin          Mr.                     N            867271   13\n14      Ramsey      Dorothy          Ms.                     N             44520    9\n15         Ali         Alma          Ms.                     N           1882928    9\n16         Ali         Alma          Ms.                     N           1166280    9\n17      Brooks      Carmela          Ms.                     Y           2384143    9\n18       Tubbs       Brenda          Ms.                     N            136932    8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017623,
                    "execution_time": 0.007516,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003863
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056304,
                    "execution_time": 0.007942,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039069
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_10\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_10\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_10\" AS \"SPEQLITE_TEMP_TABLE_10\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_10\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_11\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_11\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_11\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_11\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_11\" AS \"SPEQLITE_TEMP_TABLE_11\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0         Diaz         Gary          Dr.                     N            314293   11\n1       Murray      Charles          Dr.                     Y           1046666   14\n2     Clifford        Derek          Mr.                     N           1991816   13\n3     Clifford        Derek          Mr.                     N            322766   12\n4       Runyon       George          Dr.                     Y           2010710   13\n5        Allen         Rick          Sir                     Y           1128658   12\n6     Stephens        Nancy          Ms.                     Y           1666872   13\n7                                                                        2217281   12\n8        Joyce         Erma         Miss                     N            847437   10\n9       Arnold    Carmelita         Miss                     Y           1493226   15\n10       Nolan        Larry          Sir                     N           1420676    7\n11       Nolan        Larry          Sir                     N           1981891   11\n12     Rushing        Brian          Sir                     N           1683069   11\n13        Pond        Edwin          Mr.                     N            867271   13\n14      Ramsey      Dorothy          Ms.                     N             44520    9\n15         Ali         Alma          Ms.                     N           1882928    9\n16         Ali         Alma          Ms.                     N           1166280    9\n17      Brooks      Carmela          Ms.                     Y           2384143    9\n18       Tubbs       Brenda          Ms.                     N            136932    8\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt \nfrom\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    group by ss_ticket_number, ss_customer_sk) as sales_summary\njoin customer on sales_summary.ss_customer_sk = customer.c_customer_sk /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"CNT\" AS \"CNT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_12\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.275083,
                    "execution_time": 0.11142,
                    "compile_time": 0.000397,
                    "planning_time": 0.049145,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.486772,
                    "execution_time": 0.239462,
                    "compile_time": 0.000416,
                    "planning_time": 0.129343,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_13\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_12\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_12\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.360522,
                    "execution_time": 0.078074,
                    "compile_time": 0.000336,
                    "planning_time": 0.02651,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.421591,
                    "execution_time": 0.077103,
                    "compile_time": 0.00033,
                    "planning_time": 0.088843,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_13\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0       Dallas      Stanton          Mr.                     Y            939501   15\n1        Smith       Darrin          Dr.                     N           2369917   10\n2       Joseph      Heather          Ms.                     Y           1622494   13\n3    Scroggins        Floyd          Sir                     Y           1469930    7\n4      Raymond        Honey         Miss                     N           1803003   10\n5     Billings      Dorothy         Mrs.                     N            735918   15\n6     Davidson      Darrell          Dr.                     N           1256961   10\n7         Chan       Howard          Dr.                     N            982579   13\n8        Hardy          Jan          Mr.                     Y            406844   12\n9        Young       Steven          Mr.                     N            887027    9\n10     Carroll        Jorge          Mr.                     N           1165303    9\n11        Cohn       Kermit          Mr.                     Y            420280    8\n12    Aldridge       Eugene          Sir                     Y           1296209   11\n13    Aldridge       Eugene          Sir                     Y           1897196    9\n14       Young         John          Sir                     N            113509   10\n15      Downey    Elisabeth         Miss                     N           1427261   10\n16      Manuel        James          Dr.                     N           1307294    8\n17     Delaney       Laurie          Ms.                     N           1255225   10\n18      Melvin       Deanne         Mrs.                     Y            767326   11\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017593,
                    "execution_time": 0.007482,
                    "compile_time": 5e-05,
                    "planning_time": 0.003849
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055158,
                    "execution_time": 0.008266,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.038978
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_12\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_12\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_12\" AS \"SPEQLITE_TEMP_TABLE_12\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_12\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_13\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_13\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_13\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_13\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_13\" AS \"SPEQLITE_TEMP_TABLE_13\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0       Dallas      Stanton          Mr.                     Y            939501   15\n1        Smith       Darrin          Dr.                     N           2369917   10\n2       Joseph      Heather          Ms.                     Y           1622494   13\n3    Scroggins        Floyd          Sir                     Y           1469930    7\n4      Raymond        Honey         Miss                     N           1803003   10\n5     Billings      Dorothy         Mrs.                     N            735918   15\n6     Davidson      Darrell          Dr.                     N           1256961   10\n7         Chan       Howard          Dr.                     N            982579   13\n8        Hardy          Jan          Mr.                     Y            406844   12\n9        Young       Steven          Mr.                     N            887027    9\n10     Carroll        Jorge          Mr.                     N           1165303    9\n11        Cohn       Kermit          Mr.                     Y            420280    8\n12    Aldridge       Eugene          Sir                     Y           1296209   11\n13    Aldridge       Eugene          Sir                     Y           1897196    9\n14       Young         John          Sir                     N            113509   10\n15      Downey    Elisabeth         Miss                     N           1427261   10\n16      Manuel        James          Dr.                     N           1307294    8\n17     Delaney       Laurie          Ms.                     N           1255225   10\n18      Melvin       Deanne         Mrs.                     Y            767326   11\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 then 1 else 0 end) = 1 \n    group by ss_ticket_number, ss_customer_sk) as sales_summary\njoin customer on sales_summary.ss_customer_sk = customer.c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN 1 ELSE 0 END = 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"CNT\" AS \"CNT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_14\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN 1 ELSE 0 END = 1 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.274111,
                    "execution_time": 0.109518,
                    "compile_time": 0.000412,
                    "planning_time": 0.049829,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.368163,
                    "execution_time": 0.111392,
                    "compile_time": 0.000408,
                    "planning_time": 0.127809,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_15\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_14\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_14\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_14\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.35937,
                    "execution_time": 0.079058,
                    "compile_time": 0.000327,
                    "planning_time": 0.026892,
                    "create_size": 1152
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.460654,
                    "execution_time": 0.080711,
                    "compile_time": 0.000338,
                    "planning_time": 0.124506,
                    "create_size": 1152
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_15\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\" LIMIT 21",
                "preview": "\n/*    c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Perryman      Maurice          Sir                     N           1342221   11\n1          Long        Bobby          Sir                     N            297461    8\n2            Ha      Melissa          Dr.                     Y           1865834    8\n3            Ha      Melissa          Dr.                     Y           1561207   12\n4         Lucas       George          Mr.                     N           2332284   12\n5        Napier        Ellen          Ms.                     Y           2126312   13\n6         Payne      Zachary          Dr.                     Y            730893   14\n7         Gross      Charles          Sir                     Y           1913561   15\n8       Ramirez      Dominic          Sir                     Y           1960776    8\n9        Santos       Teresa         Mrs.                     N           2024940    7\n10        Reedy  Christopher          Sir                     N           2224845   10\n11      Johnson          Ian          Sir                     Y            427045   10\n12      Gardner         Leon          Sir                     Y            888522   10\n13      Alvarez          Ana         Miss                     Y            130835    8\n14      Trotter     Geoffrey          Mr.                     Y           1467468    9\n15      Trotter     Geoffrey          Mr.                     Y            915037    8\n16     Mcfadden        Juana          Ms.                     Y            141658   10\n17     Mcfadden        Juana          Ms.                     Y           1408454   12\n18      Marquez         Eric          Sir                     N           1538283    8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017877,
                    "execution_time": 0.00766,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.003889
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053377,
                    "execution_time": 0.007831,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039118
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_14\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_14\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_14\" AS \"SPEQLITE_TEMP_TABLE_14\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_14\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_15\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_15\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_15\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_15\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_15\" AS \"SPEQLITE_TEMP_TABLE_15\""
            }
        ],
        "preview": "\n/*    c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Perryman      Maurice          Sir                     N           1342221   11\n1          Long        Bobby          Sir                     N            297461    8\n2            Ha      Melissa          Dr.                     Y           1865834    8\n3            Ha      Melissa          Dr.                     Y           1561207   12\n4         Lucas       George          Mr.                     N           2332284   12\n5        Napier        Ellen          Ms.                     Y           2126312   13\n6         Payne      Zachary          Dr.                     Y            730893   14\n7         Gross      Charles          Sir                     Y           1913561   15\n8       Ramirez      Dominic          Sir                     Y           1960776    8\n9        Santos       Teresa         Mrs.                     N           2024940    7\n10        Reedy  Christopher          Sir                     N           2224845   10\n11      Johnson          Ian          Sir                     Y            427045   10\n12      Gardner         Leon          Sir                     Y            888522   10\n13      Alvarez          Ana         Miss                     Y            130835    8\n14      Trotter     Geoffrey          Mr.                     Y           1467468    9\n15      Trotter     Geoffrey          Mr.                     Y            915037    8\n16     Mcfadden        Juana          Ms.                     Y            141658   10\n17     Mcfadden        Juana          Ms.                     Y           1408454   12\n18      Marquez         Eric          Sir                     N           1538283    8\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \nelse 0 end) > 0\n    group by ss_ticket_number, ss_customer_sk\n) as agg_query\njoin customer on agg_query.ss_customer_sk = customer.c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"AGG_QUERY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE 0 END > 0 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"AGG_QUERY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"AGG_QUERY\".\"CNT\" AS \"CNT\" FROM \"AGG_QUERY\" AS \"AGG_QUERY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"AGG_QUERY\".\"SS_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_16\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE 0 END > 0 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.249422,
                    "execution_time": 0.10775,
                    "compile_time": 0.000414,
                    "planning_time": 0.0501,
                    "create_size": 768
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.521182,
                    "execution_time": 0.295849,
                    "compile_time": 0.000412,
                    "planning_time": 0.12848,
                    "create_size": 768
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_17\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"SPEQLITE_TEMP_TABLE_16\".\"SS_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.298989,
                    "execution_time": 0.076641,
                    "compile_time": 0.000331,
                    "planning_time": 0.027197,
                    "create_size": 1053
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.359255,
                    "execution_time": 0.073796,
                    "compile_time": 0.000323,
                    "planning_time": 0.087671,
                    "create_size": 1080
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0       Cannon      Candice          Dr.                     Y              9454    8\n1     Gallegos         Lisa          Dr.                     Y           1216486    7\n2         Lohr      Rebecca         Mrs.                     N           1908388   10\n3     Phillips       Carrie         Mrs.                     Y           1641669   11\n4         Hoyt       Gloria         Mrs.                     Y            570446   12\n5       Garner         June          Dr.                     Y           1161813    9\n6                   William                                               620929   11\n7       Bowden       Joanna         Mrs.                     N            827112   10\n8    Henderson       Elbert          Mr.                     N           2370950    8\n9       Webber     Kimberly         Miss                     Y            450841   10\n10     Freeman       Donald          Dr.                     N              6457    7\n11    Thornton       Sherie         Miss                     Y            608779   12\n12      Murray        Brian          Mr.                     N            827708   13\n13      Taylor     Margaret         Mrs.                     N           1901799    8\n14     Holland        Susan         Miss                     Y            484466    9\n15     Holland        Susan         Miss                     Y            190958    5\n16    Robinson         Elva          Dr.                     N            460592   15\n17       Beach     Samantha         Miss                     N            317265   14\n18    Newberry                                                             96595    8\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017621,
                    "execution_time": 0.007298,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.003964
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056562,
                    "execution_time": 0.007711,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.039386
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_16\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_16\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_16\" AS \"SPEQLITE_TEMP_TABLE_16\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"SPEQLITE_TEMP_TABLE_16\".\"SS_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_17\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_17\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_17\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_17\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_17\" AS \"SPEQLITE_TEMP_TABLE_17\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0       Cannon      Candice          Dr.                     Y              9454    8\n1     Gallegos         Lisa          Dr.                     Y           1216486    7\n2         Lohr      Rebecca         Mrs.                     N           1908388   10\n3     Phillips       Carrie         Mrs.                     Y           1641669   11\n4         Hoyt       Gloria         Mrs.                     Y            570446   12\n5       Garner         June          Dr.                     Y           1161813    9\n6                   William                                               620929   11\n7       Bowden       Joanna         Mrs.                     N            827112   10\n8    Henderson       Elbert          Mr.                     N           2370950    8\n9       Webber     Kimberly         Miss                     Y            450841   10\n10     Freeman       Donald          Dr.                     N              6457    7\n11    Thornton       Sherie         Miss                     Y            608779   12\n12      Murray        Brian          Mr.                     N            827708   13\n13      Taylor     Margaret         Mrs.                     N           1901799    8\n14     Holland        Susan         Miss                     Y            484466    9\n15     Holland        Susan         Miss                     Y            190958    5\n16    Robinson         Elva          Dr.                     N            460592   15\n17       Beach     Samantha         Miss                     N            317265   14\n18    Newberry                                                             96595    8\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n) as sales_summary\njoin customer on sales_summary.ss_customer_sk = customer.c_customer_sk\n",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"CNT\" AS \"CNT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_18\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.220221,
                    "execution_time": 0.098966,
                    "compile_time": 0.000418,
                    "planning_time": 0.050837,
                    "create_size": 528
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.30227,
                    "execution_time": 0.100659,
                    "compile_time": 0.000423,
                    "planning_time": 0.128021,
                    "create_size": 528
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_19\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_18\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_18\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_18\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.23457,
                    "execution_time": 0.073091,
                    "compile_time": 0.000332,
                    "planning_time": 0.027327,
                    "create_size": 720
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.295869,
                    "execution_time": 0.06672,
                    "compile_time": 0.000349,
                    "planning_time": 0.088888,
                    "create_size": 720
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_19\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_19\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Schmidt          Kay                                              1031786   12\n1         Seay     Ruthanne          Ms.                     Y            273706   11\n2         Seay     Ruthanne          Ms.                     Y            178332    9\n3     Anderson         Anne         Mrs.                     N              5764   13\n4       Foster        Susan         Miss                     N            563100   11\n5     Anderson         Mark          Sir                     Y            178872    9\n6         Hill    Elizabeth         Miss                     Y           2168973   13\n7        White    Cornelius          Mr.                     Y           1651258   13\n8       Fuller       Audrey          Ms.                     Y           2382477   12\n9         Good        Kevin          Dr.                     N            505857   13\n10       Knapp                      Mrs.                     Y           2102583   12\n11     Griffin        Larry          Mr.                     Y           1780786   12\n12     Gardner      Gilbert          Dr.                     N            948971   11\n13      Renner        Kelly          Mr.                     Y           1228114   12\n14                                                           N           1772630   16\n15                   Esther                                               334342   11\n16      Weller        Wendy          Dr.                     N            370670   12\n17       Brown     Margaret         Mrs.                     Y           1413986   10\n18      Harris        James          Dr.                     N             88883    9\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018516,
                    "execution_time": 0.007985,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.003985
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056339,
                    "execution_time": 0.007702,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.039263
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_18\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_18\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_18\" AS \"SPEQLITE_TEMP_TABLE_18\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_18\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_19\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_19\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_19\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_19\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_19\" AS \"SPEQLITE_TEMP_TABLE_19\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Schmidt          Kay                                              1031786   12\n1         Seay     Ruthanne          Ms.                     Y            273706   11\n2         Seay     Ruthanne          Ms.                     Y            178332    9\n3     Anderson         Anne         Mrs.                     N              5764   13\n4       Foster        Susan         Miss                     N            563100   11\n5     Anderson         Mark          Sir                     Y            178872    9\n6         Hill    Elizabeth         Miss                     Y           2168973   13\n7        White    Cornelius          Mr.                     Y           1651258   13\n8       Fuller       Audrey          Ms.                     Y           2382477   12\n9         Good        Kevin          Dr.                     N            505857   13\n10       Knapp                      Mrs.                     Y           2102583   12\n11     Griffin        Larry          Mr.                     Y           1780786   12\n12     Gardner      Gilbert          Dr.                     N            948971   11\n13      Renner        Kelly          Mr.                     Y           1228114   12\n14                                                           N           1772630   16\n15                   Esther                                               334342   11\n16      Weller        Wendy          Dr.                     N            370670   12\n17       Brown     Margaret         Mrs.                     Y           1413986   10\n18      Harris        James          Dr.                     N             88883    9\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n) as sales_summary\njoin customer on sales_summary.ss_customer_sk = customer.c_customer_sk\n",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"CNT\" AS \"CNT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_20\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.18776,
                    "execution_time": 0.080459,
                    "compile_time": 0.000421,
                    "planning_time": 0.052155,
                    "create_size": 336
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.269241,
                    "execution_time": 0.081092,
                    "compile_time": 0.000412,
                    "planning_time": 0.128455,
                    "create_size": 336
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_21\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_20\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_20\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.172448,
                    "execution_time": 0.057834,
                    "compile_time": 0.000302,
                    "planning_time": 0.027106,
                    "create_size": 432
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.254237,
                    "execution_time": 0.062785,
                    "compile_time": 0.000338,
                    "planning_time": 0.096818,
                    "create_size": 432
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_21\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_21\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_21\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_21\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\" LIMIT 21",
                "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Hankins       Vivian         Miss                     N           1942728   11\n1     Caldwell     Adrianne          Ms.                     N            240147    7\n2        Bowen        Craig          Sir                     N           1693543   13\n3    Goldsmith        Danny          Mr.                     Y           1831645   13\n4        Smith         Ruth          Ms.                     N           1422845   16\n5         King        Bobby          Dr.                     Y           2291523   16\n6      Parsons     Marjorie          Dr.                     Y           1908726   15\n7      Noriega         Tina         Mrs.                     Y           2365023   13\n8       Olivas        Roger          Sir                     Y            408155    8\n9      Baldwin       Maggie         Mrs.                     N           1702080   14\n10     Roberts       Melvin          Dr.                     Y           1783223    9\n11     Dejesus       George          Dr.                     N           2314819    7\n12      Osgood        Dorie          Ms.                     Y           1553969    9\n13     Metcalf  Christopher          Sir                     N            603303   15\n14       Payne      Deborah          Ms.                     Y            972973    8\n15       Smith        Betty          Ms.                     N           1162238   15\n16      Easton        Nancy          Dr.                     N           1640076    6\n17     Carroll      William          Mr.                     Y           2181207   12\n18       Heinz      Antonia          Dr.                     Y            122812    7\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.017336,
                    "execution_time": 0.007264,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.003763
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056259,
                    "execution_time": 0.00783,
                    "compile_time": 4.9e-05,
                    "planning_time": 0.039043
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_20\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_20\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_20\" AS \"SPEQLITE_TEMP_TABLE_20\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_20\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_21\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_21\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_21\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_21\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_21\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_21\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_21\" AS \"SPEQLITE_TEMP_TABLE_21\""
            }
        ],
        "preview": "\n/*   c_last_name c_first_name c_salutation c_preferred_cust_flag  ss_ticket_number  cnt\n0      Hankins       Vivian         Miss                     N           1942728   11\n1     Caldwell     Adrianne          Ms.                     N            240147    7\n2        Bowen        Craig          Sir                     N           1693543   13\n3    Goldsmith        Danny          Mr.                     Y           1831645   13\n4        Smith         Ruth          Ms.                     N           1422845   16\n5         King        Bobby          Dr.                     Y           2291523   16\n6      Parsons     Marjorie          Dr.                     Y           1908726   15\n7      Noriega         Tina         Mrs.                     Y           2365023   13\n8       Olivas        Roger          Sir                     Y            408155    8\n9      Baldwin       Maggie         Mrs.                     N           1702080   14\n10     Roberts       Melvin          Dr.                     Y           1783223    9\n11     Dejesus       George          Dr.                     N           2314819    7\n12      Osgood        Dorie          Ms.                     Y           1553969    9\n13     Metcalf  Christopher          Sir                     N            603303   15\n14       Payne      Deborah          Ms.                     Y            972973    8\n15       Smith        Betty          Ms.                     N           1162238   15\n16      Easton        Nancy          Dr.                     N           1640076    6\n17     Carroll      William          Mr.                     Y           2181207   12\n18       Heinz      Antonia          Dr.                     Y            122812    7\n...*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n    and store.s_county in ('Sumner County','Gage County','Bronx County','Salem County')\n    \n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n   ) as sales_summary\n   join customer on sales_summary.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"CNT\" AS \"CNT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_22\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.119165,
                    "execution_time": 0.036005,
                    "compile_time": 0.00036,
                    "planning_time": 0.053685,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 4.484862,
                    "execution_time": 0.176283,
                    "compile_time": 4.13734,
                    "planning_time": 0.1314,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_23\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_22\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_22\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.088625,
                    "execution_time": 0.037241,
                    "compile_time": 0.000262,
                    "planning_time": 0.026803,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.156204,
                    "execution_time": 0.036875,
                    "compile_time": 0.003932,
                    "planning_time": 0.088566,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_23\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_23\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_23\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_23\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018173,
                    "execution_time": 0.00699,
                    "compile_time": 5e-05,
                    "planning_time": 0.005006
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.055901,
                    "execution_time": 0.00729,
                    "compile_time": 5.2e-05,
                    "planning_time": 0.040409
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_22\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_22\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_22\" AS \"SPEQLITE_TEMP_TABLE_22\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_22\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_23\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_23\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_23\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_23\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_23\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_23\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_23\" AS \"SPEQLITE_TEMP_TABLE_23\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n    and store.s_county in ('Sumner County','Gage County','Bronx County','Salem County',\n                           'Perry County','San Miguel County','Hubbard County','Pennington County')\n/*CURSOR_IDENTIFIER*/\n    group by ss_ticket_number, ss_customer_sk\n) as sales_summary\njoin customer on sales_summary.ss_customer_sk = customer.c_customer_sk",
        "optimize": [
            "WITH \"SALES_SUMMARY\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' , 'Perry County' , 'San Miguel County' , 'Hubbard County' , 'Pennington County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SALES_SUMMARY\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SALES_SUMMARY\".\"CNT\" AS \"CNT\" FROM \"SALES_SUMMARY\" AS \"SALES_SUMMARY\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SALES_SUMMARY\".\"SS_CUSTOMER_SK\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_24\" AS SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' , 'Perry County' , 'San Miguel County' , 'Hubbard County' , 'Pennington County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.150221,
                    "execution_time": 0.036022,
                    "compile_time": 0.029376,
                    "planning_time": 0.054641,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 3.715512,
                    "execution_time": 0.035918,
                    "compile_time": 3.512519,
                    "planning_time": 0.133205,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_25\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_24\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_24\".\"SS_CUSTOMER_SK\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.088613,
                    "execution_time": 0.037237,
                    "compile_time": 0.000256,
                    "planning_time": 0.026366,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.152424,
                    "execution_time": 0.037843,
                    "compile_time": 0.00026,
                    "planning_time": 0.08921,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_25\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018084,
                    "execution_time": 0.007109,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.004755
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054252,
                    "execution_time": 0.007827,
                    "compile_time": 4.7e-05,
                    "planning_time": 0.040156
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_24\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_24\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_25\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n    and store.s_county in ('Sumner County','Gage County','Bronx County','Salem County',\n                           'Perry County','San Miguel County','Hubbard County','Pennington County')\n    group by ss_ticket_number,ss_customer_sk) dn,customer\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DN\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' , 'Perry County' , 'San Miguel County' , 'Hubbard County' , 'Pennington County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DN\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DN\".\"CNT\" AS \"CNT\" FROM \"DN\" AS \"DN\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_26\" AS SELECT \"SPEQLITE_TEMP_TABLE_24\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.060782,
                    "execution_time": 0.034966,
                    "compile_time": 0.000192,
                    "planning_time": 0.004044,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.120492,
                    "execution_time": 0.034025,
                    "compile_time": 0.000194,
                    "planning_time": 0.062567,
                    "create_size": 0
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_27\" AS SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_26\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_26\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_26\" AS \"SPEQLITE_TEMP_TABLE_26\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.094606,
                    "execution_time": 0.047366,
                    "compile_time": 0.000246,
                    "planning_time": 0.026874,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.159679,
                    "execution_time": 0.048567,
                    "compile_time": 0.000246,
                    "planning_time": 0.087611,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_27\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_27\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_27\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_27\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_27\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_27\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_27\" AS \"SPEQLITE_TEMP_TABLE_27\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018287,
                    "execution_time": 0.007106,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.004792
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.054453,
                    "execution_time": 0.007813,
                    "compile_time": 5e-05,
                    "planning_time": 0.040227
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_26\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_26\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_26\" AS \"SPEQLITE_TEMP_TABLE_26\" CROSS JOIN \"CUSTOMER\" AS \"CUSTOMER\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_27\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_27\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_27\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_27\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_27\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_27\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_27\" AS \"SPEQLITE_TEMP_TABLE_27\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n    and store.s_county in ('Sumner County','Gage County','Bronx County','Salem County',\n                           'Perry County','San Miguel County','Hubbard County','Pennington County')\n    group by ss_ticket_number,ss_customer_sk) dn,customer\n    where ss_customer_sk = c_customer_sk\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DN\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' , 'Perry County' , 'San Miguel County' , 'Hubbard County' , 'Pennington County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DN\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DN\".\"CNT\" AS \"CNT\" FROM \"DN\" AS \"DN\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"DN\".\"SS_CUSTOMER_SK\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"C_SALUTATION\" AS \"C_SALUTATION\" , \"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018401,
                    "execution_time": 0.007267,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004983
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053261,
                    "execution_time": 0.007185,
                    "compile_time": 4.6e-05,
                    "planning_time": 0.039886
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_24\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_24\".\"SS_CUSTOMER_SK\"",
                "rewrite": "SELECT \"C_LAST_NAME\" AS \"C_LAST_NAME\", \"C_FIRST_NAME\" AS \"C_FIRST_NAME\", \"C_SALUTATION\" AS \"C_SALUTATION\", \"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\", \"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\", \"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n    and store.s_county in ('Sumner County','Gage County','Bronx County','Salem County',\n                           'Perry County','San Miguel County','Hubbard County','Pennington County')\n    group by ss_ticket_number,ss_customer_sk) dn,customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 15 and 20\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DN\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' , 'Perry County' , 'San Miguel County' , 'Hubbard County' , 'Pennington County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DN\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DN\".\"CNT\" AS \"CNT\" FROM \"DN\" AS \"DN\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"DN\".\"SS_CUSTOMER_SK\" WHERE \"DN\".\"CNT\" <= 20 AND \"DN\".\"CNT\" >= 15"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_28\" AS SELECT \"SPEQLITE_TEMP_TABLE_25\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_25\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" WHERE \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" >= 15",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.062387,
                    "execution_time": 0.033417,
                    "compile_time": 0.000198,
                    "planning_time": 0.005786,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.122752,
                    "execution_time": 0.034206,
                    "compile_time": 0.000203,
                    "planning_time": 0.063507,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_28\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_28\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_28\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_28\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_28\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_28\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018273,
                    "execution_time": 0.007106,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004901
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.053829,
                    "execution_time": 0.007494,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.04004
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_24\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_24\".\"SS_CUSTOMER_SK\" WHERE \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" >= 15",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_28\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_28\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_28\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_28\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_28\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_28\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_28\" AS \"SPEQLITE_TEMP_TABLE_28\""
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n    and store.s_county in ('Sumner County','Gage County','Bronx County','Salem County',\n                           'Perry County','San Miguel County','Hubbard County','Pennington County')\n    group by ss_ticket_number,ss_customer_sk) dn,customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 15 and 20\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DN\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' , 'Perry County' , 'San Miguel County' , 'Hubbard County' , 'Pennington County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DN\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DN\".\"CNT\" AS \"CNT\" FROM \"DN\" AS \"DN\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"DN\".\"SS_CUSTOMER_SK\" WHERE \"DN\".\"CNT\" <= 20 AND \"DN\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" DESC NULLS FIRST , \"SS_TICKET_NUMBER\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_25\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" WHERE \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" , \"C_FIRST_NAME\" , \"C_SALUTATION\" , \"C_PREFERRED_CUST_FLAG\" DESC , \"SS_TICKET_NUMBER\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020715,
                    "execution_time": 0.007926,
                    "compile_time": 7.7e-05,
                    "planning_time": 0.006301
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.170211,
                    "execution_time": 0.008339,
                    "compile_time": 0.111398,
                    "planning_time": 0.042072
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_24\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_24\".\"SS_CUSTOMER_SK\" WHERE \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" DESC NULLS FIRST , \"SS_TICKET_NUMBER\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_25\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" WHERE \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" DESC NULLS FIRST , \"SS_TICKET_NUMBER\" NULLS LAST"
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/"
    },
    {
        "input": "-- start template query34.tpl query 73 in stream 0\nselect /* TPC-DS query34.tpl 0.73 */ c_last_name\n       ,c_first_name\n       ,c_salutation\n       ,c_preferred_cust_flag\n       ,ss_ticket_number\n       ,cnt from\n   (select ss_ticket_number\n          ,ss_customer_sk\n          ,count(*) cnt\n    from store_sales,date_dim,store,household_demographics\n    where store_sales.ss_sold_date_sk = date_dim.d_date_sk\n    and store_sales.ss_store_sk = store.s_store_sk  \n    and store_sales.ss_hdemo_sk = household_demographics.hd_demo_sk\n    and (date_dim.d_dom between 1 and 3 or date_dim.d_dom between 25 and 28)\n    and (household_demographics.hd_buy_potential = '501-1000' or\n         household_demographics.hd_buy_potential = '5001-10000')\n    and household_demographics.hd_vehicle_count > 0\n    and (case when household_demographics.hd_vehicle_count > 0 \n\tthen household_demographics.hd_dep_count/ household_demographics.hd_vehicle_count \n\telse null \n\tend)  > 1.2\n    and date_dim.d_year in (2000,2000+1,2000+2)\n    and store.s_county in ('Sumner County','Gage County','Bronx County','Salem County',\n                           'Perry County','San Miguel County','Hubbard County','Pennington County')\n    group by ss_ticket_number,ss_customer_sk) dn,customer\n    where ss_customer_sk = c_customer_sk\n      and cnt between 15 and 20\n    order by c_last_name,c_first_name,c_salutation,c_preferred_cust_flag desc, ss_ticket_number\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"DN\" AS ( SELECT \"STORE_SALES\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" AS \"SS_CUSTOMER_SK\" , COUNT ( * ) AS \"CNT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" IN ( 2000 , 2001 , 2002 ) AND ( ( \"DATE_DIM\".\"D_DOM\" <= 28 AND \"DATE_DIM\".\"D_DOM\" >= 25 ) OR ( \"DATE_DIM\".\"D_DOM\" <= 3 AND \"DATE_DIM\".\"D_DOM\" >= 1 ) ) JOIN \"HOUSEHOLD_DEMOGRAPHICS\" AS \"HOUSEHOLD_DEMOGRAPHICS\" ON ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '5001-10000' OR \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_BUY_POTENTIAL\" = '501-1000' ) AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEMO_SK\" = \"STORE_SALES\".\"SS_HDEMO_SK\" AND \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 AND CASE WHEN \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" > 0 THEN CAST ( \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_DEP_COUNT\" / \"HOUSEHOLD_DEMOGRAPHICS\".\"HD_VEHICLE_COUNT\" AS BIGINT ) ELSE NULL END > 1.2 JOIN \"STORE\" AS \"STORE\" ON \"STORE\".\"S_COUNTY\" IN ( 'Sumner County' , 'Gage County' , 'Bronx County' , 'Salem County' , 'Perry County' , 'San Miguel County' , 'Hubbard County' , 'Pennington County' ) AND \"STORE\".\"S_STORE_SK\" = \"STORE_SALES\".\"SS_STORE_SK\" GROUP BY \"STORE_SALES\".\"SS_TICKET_NUMBER\" , \"STORE_SALES\".\"SS_CUSTOMER_SK\" ) SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"DN\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"DN\".\"CNT\" AS \"CNT\" FROM \"DN\" AS \"DN\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"DN\".\"SS_CUSTOMER_SK\" WHERE \"DN\".\"CNT\" <= 20 AND \"DN\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" DESC NULLS FIRST , \"SS_TICKET_NUMBER\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_25\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" WHERE \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" , \"C_FIRST_NAME\" , \"C_SALUTATION\" , \"C_PREFERRED_CUST_FLAG\" DESC , \"SS_TICKET_NUMBER\" LIMIT 21",
                "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.020668,
                    "execution_time": 0.007947,
                    "compile_time": 7.6e-05,
                    "planning_time": 0.006206
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.021285,
                    "execution_time": 0.008226,
                    "compile_time": 7.9e-05,
                    "planning_time": 0.006383
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"CUSTOMER\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"CUSTOMER\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"CUSTOMER\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"CUSTOMER\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_24\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_24\" AS \"SPEQLITE_TEMP_TABLE_24\" JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CUSTOMER\".\"C_CUSTOMER_SK\" = \"SPEQLITE_TEMP_TABLE_24\".\"SS_CUSTOMER_SK\" WHERE \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_24\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" DESC NULLS FIRST , \"SS_TICKET_NUMBER\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_25\".\"C_LAST_NAME\" AS \"C_LAST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_FIRST_NAME\" AS \"C_FIRST_NAME\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_SALUTATION\" AS \"C_SALUTATION\" , \"SPEQLITE_TEMP_TABLE_25\".\"C_PREFERRED_CUST_FLAG\" AS \"C_PREFERRED_CUST_FLAG\" , \"SPEQLITE_TEMP_TABLE_25\".\"SS_TICKET_NUMBER\" AS \"SS_TICKET_NUMBER\" , \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" AS \"CNT\" FROM \"SPEQLITE_TEMP_TABLE_25\" AS \"SPEQLITE_TEMP_TABLE_25\" WHERE \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" <= 20 AND \"SPEQLITE_TEMP_TABLE_25\".\"CNT\" >= 15 ORDER BY \"C_LAST_NAME\" NULLS LAST , \"C_FIRST_NAME\" NULLS LAST , \"C_SALUTATION\" NULLS LAST , \"C_PREFERRED_CUST_FLAG\" DESC NULLS FIRST , \"SS_TICKET_NUMBER\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*Empty DataFrame\nColumns: [c_last_name, c_first_name, c_salutation, c_preferred_cust_flag, ss_ticket_number, cnt]\nIndex: []*/"
    }
]