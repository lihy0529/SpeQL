[
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n )  /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"_Q_0\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" ) SELECT \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"_Q_0\".\"CA_STATE\" AS \"CA_STATE\" , \"_Q_0\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"_Q_0\".\"AGG1\" AS \"AGG1\" , \"_Q_0\".\"AGG2\" AS \"AGG2\" , \"_Q_0\".\"AGG3\" AS \"AGG3\" , \"_Q_0\".\"AGG4\" AS \"AGG4\" , \"_Q_0\".\"AGG5\" AS \"AGG5\" , \"_Q_0\".\"AGG6\" AS \"AGG6\" , \"_Q_0\".\"AGG7\" AS \"AGG7\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' )",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.282697,
                    "execution_time": 0.101017,
                    "compile_time": 0.000677,
                    "planning_time": 0.079394,
                    "create_size": 336
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.536581,
                    "execution_time": 0.221799,
                    "compile_time": 0.130015,
                    "planning_time": 0.079555,
                    "create_size": 336
                }
            },
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.242712,
                    "execution_time": 0.081827,
                    "compile_time": 0.000453,
                    "planning_time": 0.012641,
                    "create_size": 518
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.286965,
                    "execution_time": 0.081419,
                    "compile_time": 0.000451,
                    "planning_time": 0.05526,
                    "create_size": 518
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*           i_item_id     ca_country ca_state             ca_county   agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAADGCHBAAA                      CA                         28.0   69.21     0.00   31.14  -127.12  1985.0   1.0\n1   AAAAAAAAOHAHAAAA  United States       CA           Mono County   86.0   62.01     0.00    4.96 -3329.06  1935.0   0.0\n2   AAAAAAAAKKEOAAAA  United States       OK        Washita County   18.0  145.04     0.00  124.73   623.52  1985.0   5.0\n3   AAAAAAAAOPJBBAAA  United States       AL     Washington County   19.0   76.91     0.00   23.07  -668.80  1955.0   0.0\n4   AAAAAAAADHACBAAA  United States       KY       Woodford County   10.0   92.89     0.00   39.94   -28.70  1966.0   4.0\n5   AAAAAAAAMEGKAAAA  United States       SD     Pennington County   25.0  173.80     0.00   81.68   522.75  1962.0   5.0\n6   AAAAAAAAKJPDAAAA  United States       KY      Jefferson County  100.0   97.57  4244.25   56.59 -2146.25  1973.0   4.0\n7   AAAAAAAAIGKCAAAA  United States       AL        Jackson County   95.0  136.41     0.00   98.21  4402.30  1988.0   3.0\n8   AAAAAAAAMJOGAAAA  United States       AL        Jackson County   88.0  202.05     0.00   28.28 -6059.68  1988.0   3.0\n9   AAAAAAAAMJIOAAAA  United States       SD        Roberts County   49.0  171.28  5182.31  162.71  -526.82  1938.0   3.0\n10  AAAAAAAAOFBBBAAA  United States       CA      San Mateo County    9.0  183.95   152.93   20.23  -526.43  1965.0   2.0\n11  AAAAAAAAADIEBAAA  United States       OK          Grant County   63.0   46.51   690.19   35.34  -808.00  1943.0   3.0\n12  AAAAAAAALNMHAAAA  United States       AL        Fayette County   16.0  118.51    19.33    2.37  -943.97  1927.0   0.0\n13  AAAAAAAAAKNCBAAA  United States       SD       Mellette County   23.0  119.81     0.00   82.66   450.80  1962.0   5.0\n14  AAAAAAAABEPCAAAA  United States       NV           Lyon County   86.0  169.31     0.00   91.42  -554.70  1982.0   6.0\n15  AAAAAAAANOBFBAAA  United States       NV           Lyon County   70.0  105.86     0.00   42.34  -723.10  1982.0   6.0\n16  AAAAAAAAJDLCAAAA  United States       CA  Santa Barbara County   56.0   18.92     0.00    2.08  -356.72  1990.0   4.0\n17  AAAAAAAAPJEAAAAA  United States       CA         Orange County   91.0   74.77     0.00    7.47 -5621.07  1947.0   5.0\n18  AAAAAAAAFALMAAAA  United States       AL       Marshall County   80.0   75.67     0.00   46.91   616.00  1974.0   3.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018462,
                    "execution_time": 0.007304,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004571
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056881,
                    "execution_time": 0.008162,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.040427
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_2\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_2\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*           i_item_id     ca_country ca_state             ca_county   agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAADGCHBAAA                      CA                         28.0   69.21     0.00   31.14  -127.12  1985.0   1.0\n1   AAAAAAAAOHAHAAAA  United States       CA           Mono County   86.0   62.01     0.00    4.96 -3329.06  1935.0   0.0\n2   AAAAAAAAKKEOAAAA  United States       OK        Washita County   18.0  145.04     0.00  124.73   623.52  1985.0   5.0\n3   AAAAAAAAOPJBBAAA  United States       AL     Washington County   19.0   76.91     0.00   23.07  -668.80  1955.0   0.0\n4   AAAAAAAADHACBAAA  United States       KY       Woodford County   10.0   92.89     0.00   39.94   -28.70  1966.0   4.0\n5   AAAAAAAAMEGKAAAA  United States       SD     Pennington County   25.0  173.80     0.00   81.68   522.75  1962.0   5.0\n6   AAAAAAAAKJPDAAAA  United States       KY      Jefferson County  100.0   97.57  4244.25   56.59 -2146.25  1973.0   4.0\n7   AAAAAAAAIGKCAAAA  United States       AL        Jackson County   95.0  136.41     0.00   98.21  4402.30  1988.0   3.0\n8   AAAAAAAAMJOGAAAA  United States       AL        Jackson County   88.0  202.05     0.00   28.28 -6059.68  1988.0   3.0\n9   AAAAAAAAMJIOAAAA  United States       SD        Roberts County   49.0  171.28  5182.31  162.71  -526.82  1938.0   3.0\n10  AAAAAAAAOFBBBAAA  United States       CA      San Mateo County    9.0  183.95   152.93   20.23  -526.43  1965.0   2.0\n11  AAAAAAAAADIEBAAA  United States       OK          Grant County   63.0   46.51   690.19   35.34  -808.00  1943.0   3.0\n12  AAAAAAAALNMHAAAA  United States       AL        Fayette County   16.0  118.51    19.33    2.37  -943.97  1927.0   0.0\n13  AAAAAAAAAKNCBAAA  United States       SD       Mellette County   23.0  119.81     0.00   82.66   450.80  1962.0   5.0\n14  AAAAAAAABEPCAAAA  United States       NV           Lyon County   86.0  169.31     0.00   91.42  -554.70  1982.0   6.0\n15  AAAAAAAANOBFBAAA  United States       NV           Lyon County   70.0  105.86     0.00   42.34  -723.10  1982.0   6.0\n16  AAAAAAAAJDLCAAAA  United States       CA  Santa Barbara County   56.0   18.92     0.00    2.08  -356.72  1990.0   4.0\n17  AAAAAAAAPJEAAAAA  United States       CA         Orange County   91.0   74.77     0.00    7.47 -5621.07  1947.0   5.0\n18  AAAAAAAAFALMAAAA  United States       AL       Marshall County   80.0   75.67     0.00   46.91   616.00  1974.0   3.0\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales,\n      customer_demographics cd1,\n      customer_demographics cd2,\n      customer,\n      customer_address,\n      date_dim,\n      item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7\n\tfrom results\n\tgroup by i_item_id \n) as subquery \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"SUBQUERY\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" ) SELECT \"SUBQUERY\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SUBQUERY\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SUBQUERY\".\"CA_STATE\" AS \"CA_STATE\" , \"SUBQUERY\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SUBQUERY\".\"AGG1\" AS \"AGG1\" , \"SUBQUERY\".\"AGG2\" AS \"AGG2\" , \"SUBQUERY\".\"AGG3\" AS \"AGG3\" , \"SUBQUERY\".\"AGG4\" AS \"AGG4\" , \"SUBQUERY\".\"AGG5\" AS \"AGG5\" , \"SUBQUERY\".\"AGG6\" AS \"AGG6\" , \"SUBQUERY\".\"AGG7\" AS \"AGG7\" FROM \"SUBQUERY\" AS \"SUBQUERY\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_3\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.39897,
                    "execution_time": 0.10898,
                    "compile_time": 0.000661,
                    "planning_time": 0.023132,
                    "create_size": 1008
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.462964,
                    "execution_time": 0.125,
                    "compile_time": 0.000693,
                    "planning_time": 0.066457,
                    "create_size": 1008
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*           i_item_id     ca_country ca_state ca_county   agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAKMGAAAAA  United States     None      None   89.0   23.59     0.00    2.59 -1027.06  1969.0   5.0\n1   AAAAAAAAIPPCAAAA  United States     None      None   35.0  190.08     0.00   41.81 -1506.75  1969.0   5.0\n2   AAAAAAAAEAEHBAAA  United States     None      None   76.0  190.90     0.00   51.54 -1684.92  1974.0   3.0\n3   AAAAAAAADHAFBAAA  United States     None      None   60.0  132.38     0.00   90.89  3012.85  1976.5   2.0\n4   AAAAAAAAFLONAAAA  United States     None      None   41.0   79.51     0.00   49.54   446.08  1977.0   3.5\n5   AAAAAAAAAMHDAAAA  United States     None      None   71.0   65.94     0.00    0.00 -1592.53  1943.0   0.0\n6   AAAAAAAABOJNAAAA  United States     None      None   63.0   30.70     0.00    8.28  -435.96  1953.0   3.0\n7   AAAAAAAAILHIBAAA  United States     None      None   54.5   81.09   470.54   73.88   271.07  1971.5   4.5\n8   AAAAAAAAIENHAAAA  United States     None      None   77.0   42.08     0.00   40.39   -98.56  1962.0   5.0\n9   AAAAAAAABGKHBAAA  United States     None      None   25.0   61.48     0.00   15.98  -134.25  1962.0   1.0\n10  AAAAAAAAHJBFAAAA  United States     None      None   60.0   42.18     0.00   11.38  -202.20  1966.0   6.0\n11  AAAAAAAAOLMDAAAA  United States     None      None   47.0  258.84     0.00  207.07  5356.12  1945.0   5.0\n12  AAAAAAAAFLEEBAAA  United States     None      None  100.0   39.21     0.00   21.17    85.00  1961.0   2.0\n13  AAAAAAAAKHMEBAAA  United States     None      None    8.0  108.37     0.00   26.00  -552.56  1960.0   0.0\n14  AAAAAAAAOHCIBAAA  United States     None      None   16.0   30.14     0.00   10.54    -6.72  1942.0   3.0\n15  AAAAAAAANFCOAAAA  United States     None      None   45.0   54.54     0.00   22.90  -172.80  1979.0   1.0\n16  AAAAAAAAGBEOAAAA  United States     None      None   98.0  294.72     0.00  156.20  5647.74  1950.0   3.0\n17  AAAAAAAAIPBLAAAA  United States     None      None   96.0   95.94  1199.03   13.43 -4888.31  1972.0   0.0\n18  AAAAAAAAGDAHBAAA  United States     None      None   20.0   92.67   645.51   75.06   156.29  1965.0   6.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.0196,
                    "execution_time": 0.007682,
                    "compile_time": 6.1e-05,
                    "planning_time": 0.004787
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.056214,
                    "execution_time": 0.007624,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.0403
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*           i_item_id     ca_country ca_state ca_county   agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAKMGAAAAA  United States     None      None   89.0   23.59     0.00    2.59 -1027.06  1969.0   5.0\n1   AAAAAAAAIPPCAAAA  United States     None      None   35.0  190.08     0.00   41.81 -1506.75  1969.0   5.0\n2   AAAAAAAAEAEHBAAA  United States     None      None   76.0  190.90     0.00   51.54 -1684.92  1974.0   3.0\n3   AAAAAAAADHAFBAAA  United States     None      None   60.0  132.38     0.00   90.89  3012.85  1976.5   2.0\n4   AAAAAAAAFLONAAAA  United States     None      None   41.0   79.51     0.00   49.54   446.08  1977.0   3.5\n5   AAAAAAAAAMHDAAAA  United States     None      None   71.0   65.94     0.00    0.00 -1592.53  1943.0   0.0\n6   AAAAAAAABOJNAAAA  United States     None      None   63.0   30.70     0.00    8.28  -435.96  1953.0   3.0\n7   AAAAAAAAILHIBAAA  United States     None      None   54.5   81.09   470.54   73.88   271.07  1971.5   4.5\n8   AAAAAAAAIENHAAAA  United States     None      None   77.0   42.08     0.00   40.39   -98.56  1962.0   5.0\n9   AAAAAAAABGKHBAAA  United States     None      None   25.0   61.48     0.00   15.98  -134.25  1962.0   1.0\n10  AAAAAAAAHJBFAAAA  United States     None      None   60.0   42.18     0.00   11.38  -202.20  1966.0   6.0\n11  AAAAAAAAOLMDAAAA  United States     None      None   47.0  258.84     0.00  207.07  5356.12  1945.0   5.0\n12  AAAAAAAAFLEEBAAA  United States     None      None  100.0   39.21     0.00   21.17    85.00  1961.0   2.0\n13  AAAAAAAAKHMEBAAA  United States     None      None    8.0  108.37     0.00   26.00  -552.56  1960.0   0.0\n14  AAAAAAAAOHCIBAAA  United States     None      None   16.0   30.14     0.00   10.54    -6.72  1942.0   3.0\n15  AAAAAAAANFCOAAAA  United States     None      None   45.0   54.54     0.00   22.90  -172.80  1979.0   1.0\n16  AAAAAAAAGBEOAAAA  United States     None      None   98.0  294.72     0.00  156.20  5647.74  1950.0   3.0\n17  AAAAAAAAIPBLAAAA  United States     None      None   96.0   95.94  1199.03   13.43 -4888.31  1972.0   0.0\n18  AAAAAAAAGDAHBAAA  United States     None      None   20.0   92.67   645.51   75.06   156.29  1965.0   6.0\n...*/"
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n group by i_item_id\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"_Q_0\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"_Q_0\".\"CA_STATE\" AS \"CA_STATE\" , \"_Q_0\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"_Q_0\".\"AGG1\" AS \"AGG1\" , \"_Q_0\".\"AGG2\" AS \"AGG2\" , \"_Q_0\".\"AGG3\" AS \"AGG3\" , \"_Q_0\".\"AGG4\" AS \"AGG4\" , \"_Q_0\".\"AGG5\" AS \"AGG5\" , \"_Q_0\".\"AGG6\" AS \"AGG6\" , \"_Q_0\".\"AGG7\" AS \"AGG7\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*           i_item_id     ca_country ca_state           ca_county   agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAMGIFAAAA  United States       KY      Fayette County   81.0   61.16     0.00   18.34  -640.71  1986.0   6.0\n1   AAAAAAAALDKGBAAA  United States       KY         Knox County   22.0  205.05  1293.32  125.08  -353.26  1962.0   5.0\n2   AAAAAAAABHEABAAA  United States       WI   Green Lake County   10.0  159.61     0.00   38.30  -567.10  1933.0   4.0\n3   AAAAAAAAGEJBAAAA  United States       KY       Leslie County  100.0    4.66     0.00    2.00  -228.00  1975.0   2.0\n4   AAAAAAAAPLJIAAAA  United States       NV       Storey County   81.0  129.65     0.00    5.18 -7417.98  1975.0   5.0\n5   AAAAAAAACAPOAAAA  United States       WI       Oconto County   69.0   63.06     0.00   40.98  1233.72  1929.0   1.0\n6   AAAAAAAAMOAFBAAA  United States       AL      Baldwin County   80.0    4.63     0.00    1.38   -29.60  1940.0   0.0\n7   AAAAAAAAGNEHBAAA  United States       CA  San Joaquin County   65.0  150.07     0.00   42.01 -3562.65  1943.0   1.0\n8   AAAAAAAADLCGAAAA  United States       KY       Harlan County    2.0   78.89     0.00   33.92    10.04  1944.0   1.0\n9   AAAAAAAAIGHLAAAA  United States       SD        Butte County   64.0   62.58   832.99   25.03  -935.39  1935.0   3.0\n10  AAAAAAAAEEFHAAAA  United States       SD     Lawrence County   90.0  200.90     0.00  148.66  6921.90  1948.0   5.0\n11  AAAAAAAAIJHEBAAA  United States       KY      Menifee County   25.0  159.86     0.00  147.07  2322.00  1931.0   5.0\n12  AAAAAAAAIHKIBAAA  United States       CA       Amador County   96.0   87.42     0.00   69.93    -0.96  1978.0   2.0\n13  AAAAAAAANOOFAAAA  United States       KY   Montgomery County    2.0   15.08     0.00    5.88   -13.38  1992.0   1.0\n14  AAAAAAAAKMOABAAA  United States       CA        Glenn County   49.0   10.99     0.00    3.73  -173.95  1954.0   6.0\n15  AAAAAAAANGMGAAAA  United States       KY         Todd County   98.0   47.34    37.76    0.47 -3259.02  1955.0   5.0\n16  AAAAAAAAFMCDAAAA  United States       SD      Sanborn County   14.0   56.40     0.00   37.78    80.22  1964.0   2.0\n17  AAAAAAAAKJCCAAAA  United States       WI      Portage County    1.0  178.98     0.00   91.27    -2.44  1980.0   2.0\n18  AAAAAAAADKAIBAAA  United States       KY        Meade County   22.0  156.72   371.66   76.79   -83.90  1930.0   3.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018755,
                    "execution_time": 0.00748,
                    "compile_time": 5.3e-05,
                    "planning_time": 0.004663
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019963,
                    "execution_time": 0.008128,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.004804
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*           i_item_id     ca_country ca_state           ca_county   agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAMGIFAAAA  United States       KY      Fayette County   81.0   61.16     0.00   18.34  -640.71  1986.0   6.0\n1   AAAAAAAALDKGBAAA  United States       KY         Knox County   22.0  205.05  1293.32  125.08  -353.26  1962.0   5.0\n2   AAAAAAAABHEABAAA  United States       WI   Green Lake County   10.0  159.61     0.00   38.30  -567.10  1933.0   4.0\n3   AAAAAAAAGEJBAAAA  United States       KY       Leslie County  100.0    4.66     0.00    2.00  -228.00  1975.0   2.0\n4   AAAAAAAAPLJIAAAA  United States       NV       Storey County   81.0  129.65     0.00    5.18 -7417.98  1975.0   5.0\n5   AAAAAAAACAPOAAAA  United States       WI       Oconto County   69.0   63.06     0.00   40.98  1233.72  1929.0   1.0\n6   AAAAAAAAMOAFBAAA  United States       AL      Baldwin County   80.0    4.63     0.00    1.38   -29.60  1940.0   0.0\n7   AAAAAAAAGNEHBAAA  United States       CA  San Joaquin County   65.0  150.07     0.00   42.01 -3562.65  1943.0   1.0\n8   AAAAAAAADLCGAAAA  United States       KY       Harlan County    2.0   78.89     0.00   33.92    10.04  1944.0   1.0\n9   AAAAAAAAIGHLAAAA  United States       SD        Butte County   64.0   62.58   832.99   25.03  -935.39  1935.0   3.0\n10  AAAAAAAAEEFHAAAA  United States       SD     Lawrence County   90.0  200.90     0.00  148.66  6921.90  1948.0   5.0\n11  AAAAAAAAIJHEBAAA  United States       KY      Menifee County   25.0  159.86     0.00  147.07  2322.00  1931.0   5.0\n12  AAAAAAAAIHKIBAAA  United States       CA       Amador County   96.0   87.42     0.00   69.93    -0.96  1978.0   2.0\n13  AAAAAAAANOOFAAAA  United States       KY   Montgomery County    2.0   15.08     0.00    5.88   -13.38  1992.0   1.0\n14  AAAAAAAAKMOABAAA  United States       CA        Glenn County   49.0   10.99     0.00    3.73  -173.95  1954.0   6.0\n15  AAAAAAAANGMGAAAA  United States       KY         Todd County   98.0   47.34    37.76    0.47 -3259.02  1955.0   5.0\n16  AAAAAAAAFMCDAAAA  United States       SD      Sanborn County   14.0   56.40     0.00   37.78    80.22  1964.0   2.0\n17  AAAAAAAAKJCCAAAA  United States       WI      Portage County    1.0  178.98     0.00   91.27    -2.44  1980.0   2.0\n18  AAAAAAAADKAIBAAA  United States       KY        Meade County   22.0  156.72   371.66   76.79   -83.90  1930.0   3.0\n...*/"
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id\n ) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"_Q_0\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" ) SELECT \"_Q_0\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"_Q_0\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"_Q_0\".\"CA_STATE\" AS \"CA_STATE\" , \"_Q_0\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"_Q_0\".\"AGG1\" AS \"AGG1\" , \"_Q_0\".\"AGG2\" AS \"AGG2\" , \"_Q_0\".\"AGG3\" AS \"AGG3\" , \"_Q_0\".\"AGG4\" AS \"AGG4\" , \"_Q_0\".\"AGG5\" AS \"AGG5\" , \"_Q_0\".\"AGG6\" AS \"AGG6\" , \"_Q_0\".\"AGG7\" AS \"AGG7\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\" LIMIT 21",
                "preview": "\n/*           i_item_id     ca_country ca_state ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAOIIGBAAA  United States     None      None  21.0  286.93  1290.66  120.51  -852.18  1935.0   3.0\n1   AAAAAAAACONGAAAA  United States     None      None  23.0  144.42     0.00   23.10  -830.07  1935.0   5.0\n2   AAAAAAAALPCGAAAA  United States     None      None  78.0   31.07   346.64   16.46 -1049.42  1962.0   5.0\n3   AAAAAAAAKKKGBAAA  United States     None      None  93.0  158.42     0.00   60.19 -1996.71  1965.0   2.0\n4   AAAAAAAAMBJABAAA  United States     None      None  32.5  101.31     0.00   10.59  -536.90  1960.0   3.0\n5   AAAAAAAAGCLIBAAA  United States     None      None  97.0   51.92     0.00    1.55 -2236.82  1937.0   2.0\n6   AAAAAAAAICFNAAAA  United States     None      None  57.0   25.72     0.00   15.94  -185.82  1926.0   5.0\n7   AAAAAAAAPHOABAAA  United States     None      None  54.0   94.17     0.00   49.91     4.32  1979.0   2.0\n8   AAAAAAAAHPMDAAAA  United States     None      None  98.0   23.15     0.00   20.60   143.08  1969.0   3.0\n9   AAAAAAAACMODBAAA  United States     None      None  22.5   68.09     0.00   40.59  -157.80  1955.5   1.0\n10  AAAAAAAAAKNDAAAA  United States     None      None  79.0  168.21     0.00   38.68 -4761.33  1940.0   4.0\n11  AAAAAAAAGJJEBAAA  United States     None      None  17.0  250.73     0.00    5.01 -1541.73  1973.0   4.0\n12  AAAAAAAAEKLDAAAA  United States     None      None  92.0   46.22     0.00    0.00 -3514.40  1948.0   0.0\n13  AAAAAAAACDHGBAAA  United States     None      None  75.0   44.48     0.00   11.12 -1164.00  1924.0   0.0\n14  AAAAAAAAMCMMAAAA  United States     None      None  75.0   49.55     0.00   45.09  1504.50  1968.0   2.0\n15  AAAAAAAAALOGBAAA  United States     None      None  88.0  181.15     0.00  105.06  1392.16  1976.0   1.0\n16  AAAAAAAAGDICAAAA  United States     None      None  24.5   57.72    79.74   54.25   638.88  1925.0   3.0\n17  AAAAAAAANFDABAAA  United States     None      None  74.0  197.02     0.00   23.64 -3366.26     NaN   0.0\n18  AAAAAAAAGMBJAAAA  United States     None      None   7.0  164.70     9.68   11.08  -419.19  1941.5   4.5\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018624,
                    "execution_time": 0.007554,
                    "compile_time": 5e-05,
                    "planning_time": 0.004549
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.019291,
                    "execution_time": 0.007712,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.004734
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_3\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_3\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_3\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_3\" AS \"SPEQLITE_TEMP_TABLE_3\""
            }
        ],
        "preview": "\n/*           i_item_id     ca_country ca_state ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAOIIGBAAA  United States     None      None  21.0  286.93  1290.66  120.51  -852.18  1935.0   3.0\n1   AAAAAAAACONGAAAA  United States     None      None  23.0  144.42     0.00   23.10  -830.07  1935.0   5.0\n2   AAAAAAAALPCGAAAA  United States     None      None  78.0   31.07   346.64   16.46 -1049.42  1962.0   5.0\n3   AAAAAAAAKKKGBAAA  United States     None      None  93.0  158.42     0.00   60.19 -1996.71  1965.0   2.0\n4   AAAAAAAAMBJABAAA  United States     None      None  32.5  101.31     0.00   10.59  -536.90  1960.0   3.0\n5   AAAAAAAAGCLIBAAA  United States     None      None  97.0   51.92     0.00    1.55 -2236.82  1937.0   2.0\n6   AAAAAAAAICFNAAAA  United States     None      None  57.0   25.72     0.00   15.94  -185.82  1926.0   5.0\n7   AAAAAAAAPHOABAAA  United States     None      None  54.0   94.17     0.00   49.91     4.32  1979.0   2.0\n8   AAAAAAAAHPMDAAAA  United States     None      None  98.0   23.15     0.00   20.60   143.08  1969.0   3.0\n9   AAAAAAAACMODBAAA  United States     None      None  22.5   68.09     0.00   40.59  -157.80  1955.5   1.0\n10  AAAAAAAAAKNDAAAA  United States     None      None  79.0  168.21     0.00   38.68 -4761.33  1940.0   4.0\n11  AAAAAAAAGJJEBAAA  United States     None      None  17.0  250.73     0.00    5.01 -1541.73  1973.0   4.0\n12  AAAAAAAAEKLDAAAA  United States     None      None  92.0   46.22     0.00    0.00 -3514.40  1948.0   0.0\n13  AAAAAAAACDHGBAAA  United States     None      None  75.0   44.48     0.00   11.12 -1164.00  1924.0   0.0\n14  AAAAAAAAMCMMAAAA  United States     None      None  75.0   49.55     0.00   45.09  1504.50  1968.0   2.0\n15  AAAAAAAAALOGBAAA  United States     None      None  88.0  181.15     0.00  105.06  1392.16  1976.0   1.0\n16  AAAAAAAAGDICAAAA  United States     None      None  24.5   57.72    79.74   54.25   638.88  1925.0   3.0\n17  AAAAAAAANFDABAAA  United States     None      None  74.0  197.02     0.00   23.64 -3366.26     NaN   0.0\n18  AAAAAAAAGMBJAAAA  United States     None      None   7.0  164.70     9.68   11.08  -419.19  1941.5   4.5\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id\n\tunion all\n\tselect NULL AS i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\t) as combined_results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"COMBINED_RESULTS\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"COMBINED_RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"COMBINED_RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"COMBINED_RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"COMBINED_RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"COMBINED_RESULTS\".\"AGG1\" AS \"AGG1\" , \"COMBINED_RESULTS\".\"AGG2\" AS \"AGG2\" , \"COMBINED_RESULTS\".\"AGG3\" AS \"AGG3\" , \"COMBINED_RESULTS\".\"AGG4\" AS \"AGG4\" , \"COMBINED_RESULTS\".\"AGG5\" AS \"AGG5\" , \"COMBINED_RESULTS\".\"AGG6\" AS \"AGG6\" , \"COMBINED_RESULTS\".\"AGG7\" AS \"AGG7\" FROM \"COMBINED_RESULTS\" AS \"COMBINED_RESULTS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_4\" AS SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_STATE\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"CA_COUNTRY\" UNION ALL SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" GROUP BY \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"SPEQLITE_TEMP_TABLE_1\".\"AGG7\" ) AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 0.429334,
                    "execution_time": 0.124332,
                    "compile_time": 0.000834,
                    "planning_time": 0.02873,
                    "create_size": 1008
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 0.476818,
                    "execution_time": 0.12281,
                    "compile_time": 0.000834,
                    "planning_time": 0.074505,
                    "create_size": 1008
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*           i_item_id ca_country ca_state ca_county   agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAPNKHBAAA       None     None      None  86.00    5.56     0.00    0.00  -205.54  1936.0  2.00\n1   AAAAAAAAAHOHBAAA       None     None      None  23.50  110.29     0.00    5.84   -91.80  1948.5  3.50\n2   AAAAAAAADNHFAAAA       None     None      None  79.00   15.78     0.00    5.52   -47.40  1935.0  4.00\n3   AAAAAAAAAMMIAAAA       None     None      None  93.00  115.68     0.00  109.89  6483.96  1989.0  6.00\n4   AAAAAAAAOPODAAAA       None     None      None  27.50  120.17     0.00   81.23    33.31  1990.0  0.00\n5   AAAAAAAAGOLJAAAA       None     None      None  18.00   56.65     0.00   44.18   264.06  1969.0  5.00\n6   AAAAAAAAGEHEBAAA       None     None      None  13.50  203.64     0.00  125.85   871.80  1974.0  5.50\n7   AAAAAAAAICGIBAAA       None     None      None  60.00   27.92     0.00    9.77  -467.40  1936.0  5.00\n8   AAAAAAAADPGNAAAA       None     None      None   6.00   63.10     0.00    5.67  -228.90  1932.0  4.00\n9   AAAAAAAAAAOLAAAA       None     None      None  46.00   65.10    49.33    3.25 -2416.49  1935.0  6.00\n10  AAAAAAAAALCJAAAA       None     None      None  75.00  191.78     0.00   33.06 -4264.35  1967.5  2.50\n11  AAAAAAAALFPGAAAA       None     None      None  24.00  152.08  1097.88   97.33  -974.04  1985.0  1.00\n12  AAAAAAAALKBDAAAA       None     None      None  80.00   25.37     0.00    1.52 -1675.20  1986.0  5.00\n13  AAAAAAAAKMAGBAAA       None     None      None  29.50   64.54    85.14   13.07  -429.91  1972.0  4.00\n14  AAAAAAAAADFHBAAA       None     None      None  78.00  195.92     0.00  129.30  3972.54  1984.0  2.00\n15  AAAAAAAAMBFNAAAA       None     None      None  68.00   54.83   332.14   22.66  -900.02  1982.5  1.00\n16  AAAAAAAAABHFAAAA       None     None      None  85.00   40.94     0.00    3.27 -1160.25  1974.0  3.00\n17  AAAAAAAABDFEAAAA       None     None      None  80.00    6.58     0.00    2.56   -49.60  1962.0  5.00\n18  AAAAAAAACACDAAAA       None     None      None  75.66   31.91   187.50   19.74  -124.87  1952.5  2.66\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019289,
                    "execution_time": 0.007588,
                    "compile_time": 5.6e-05,
                    "planning_time": 0.004839
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057026,
                    "execution_time": 0.008262,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.040485
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*           i_item_id ca_country ca_state ca_county   agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAPNKHBAAA       None     None      None  86.00    5.56     0.00    0.00  -205.54  1936.0  2.00\n1   AAAAAAAAAHOHBAAA       None     None      None  23.50  110.29     0.00    5.84   -91.80  1948.5  3.50\n2   AAAAAAAADNHFAAAA       None     None      None  79.00   15.78     0.00    5.52   -47.40  1935.0  4.00\n3   AAAAAAAAAMMIAAAA       None     None      None  93.00  115.68     0.00  109.89  6483.96  1989.0  6.00\n4   AAAAAAAAOPODAAAA       None     None      None  27.50  120.17     0.00   81.23    33.31  1990.0  0.00\n5   AAAAAAAAGOLJAAAA       None     None      None  18.00   56.65     0.00   44.18   264.06  1969.0  5.00\n6   AAAAAAAAGEHEBAAA       None     None      None  13.50  203.64     0.00  125.85   871.80  1974.0  5.50\n7   AAAAAAAAICGIBAAA       None     None      None  60.00   27.92     0.00    9.77  -467.40  1936.0  5.00\n8   AAAAAAAADPGNAAAA       None     None      None   6.00   63.10     0.00    5.67  -228.90  1932.0  4.00\n9   AAAAAAAAAAOLAAAA       None     None      None  46.00   65.10    49.33    3.25 -2416.49  1935.0  6.00\n10  AAAAAAAAALCJAAAA       None     None      None  75.00  191.78     0.00   33.06 -4264.35  1967.5  2.50\n11  AAAAAAAALFPGAAAA       None     None      None  24.00  152.08  1097.88   97.33  -974.04  1985.0  1.00\n12  AAAAAAAALKBDAAAA       None     None      None  80.00   25.37     0.00    1.52 -1675.20  1986.0  5.00\n13  AAAAAAAAKMAGBAAA       None     None      None  29.50   64.54    85.14   13.07  -429.91  1972.0  4.00\n14  AAAAAAAAADFHBAAA       None     None      None  78.00  195.92     0.00  129.30  3972.54  1984.0  2.00\n15  AAAAAAAAMBFNAAAA       None     None      None  68.00   54.83   332.14   22.66  -900.02  1982.5  1.00\n16  AAAAAAAAABHFAAAA       None     None      None  85.00   40.94     0.00    3.27 -1160.25  1974.0  3.00\n17  AAAAAAAABDFEAAAA       None     None      None  80.00    6.58     0.00    2.56   -49.60  1962.0  5.00\n18  AAAAAAAACACDAAAA       None     None      None  75.66   31.91   187.50   19.74  -124.87  1952.5  2.66\n...*/"
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        NULL::character varying as ca_country,\n        NULL::character varying as ca_state, \n        NULL::character varying as ca_county,\n        NULL::decimal(12,2) as agg1,\n        NULL::decimal(12,2) as agg2,\n        NULL::decimal(12,2) as agg3,\n        NULL::decimal(12,2) as agg4,\n        NULL::decimal(12,2) as agg5,\n        NULL::decimal(12,2) as agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n  from item,\n       customer_demographics cd1\n  where cd1.cd_gender = 'M' and \n        cd1.cd_education_status = 'Primary'\n )\nselect i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\nfrom (\n    select i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n        avg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n    from results\n    group by i_item_id, ca_country, ca_state, ca_county\n    union all\n    select i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n        avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n    from results\n    group by i_item_id, ca_country, ca_state\n    union all\n    select i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n        avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n    from results\n    group by i_item_id, ca_country\n    union all\n    select i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n        avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n    from results\n    group by i_item_id\n    union all\n    select NULL AS i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n        avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n    from results\n) as final_results\n/*CURSOR_IDENTIFIER*/",
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id\n\tunion all\n\tselect NULL AS i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n ) foo\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"FOO\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"FOO\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"FOO\".\"CA_STATE\" AS \"CA_STATE\" , \"FOO\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"FOO\".\"AGG1\" AS \"AGG1\" , \"FOO\".\"AGG2\" AS \"AGG2\" , \"FOO\".\"AGG3\" AS \"AGG3\" , \"FOO\".\"AGG4\" AS \"AGG4\" , \"FOO\".\"AGG5\" AS \"AGG5\" , \"FOO\".\"AGG6\" AS \"AGG6\" , \"FOO\".\"AGG7\" AS \"AGG7\" FROM \"FOO\" AS \"FOO\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" LIMIT 21",
                "preview": "\n/*           i_item_id     ca_country ca_state          ca_county   agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAFDHGBAAA  United States       KY       Logan County   73.0  102.54     0.00   93.31  2629.46  1940.0   3.0\n1   AAAAAAAACFDJAAAA  United States       NV   Esmeralda County    9.0   70.90   140.38   28.36  -215.80  1966.0   3.0\n2   AAAAAAAAMNLNAAAA  United States       KY     Fayette County   76.0    9.52     0.00    3.52   -66.12  1986.0   6.0\n3   AAAAAAAAKIMOAAAA  United States       KY      Carter County   77.0  144.02     0.00   31.68 -2742.74  1968.0   0.0\n4   AAAAAAAAEAKMAAAA  United States       KY  Montgomery County   70.0   25.93     0.00   23.33   651.70     NaN   6.0\n5   AAAAAAAAIDBEAAAA  United States       OK      Nowata County   41.0  151.46     0.00   21.20 -1644.92  1987.0   5.0\n6   AAAAAAAAMJPABAAA  United States       KY        Ohio County    4.0   45.73     0.00    1.37  -130.04  1959.0   5.0\n7   AAAAAAAAGOGIAAAA  United States       AL         Lee County  100.0    5.91     0.00    4.07   -78.00  1950.0   1.0\n8   AAAAAAAAMKEEBAAA  United States       SD       Butte County    1.0   86.94    40.08   46.07   -48.69  1935.0   3.0\n9   AAAAAAAAPCKNAAAA  United States       OK      Hughes County   46.0   84.95  1371.58   66.26  -337.96  1953.0   2.0\n10  AAAAAAAAGMKHAAAA  United States       KY     Jackson County   71.0   92.51     0.00    0.00 -2460.15  1935.0   2.0\n11  AAAAAAAAOHKPAAAA  United States       SD     Buffalo County    6.0  144.85   653.90  143.40  -111.86  1981.0   0.0\n12  AAAAAAAAHINDAAAA  United States       WI   Sheboygan County   62.0   84.23     0.00    5.05 -4909.16  1935.0   1.0\n13  AAAAAAAAGMNEAAAA  United States       WI      Vernon County   64.0  138.98     0.00    4.16 -5953.92  1973.0   6.0\n14  AAAAAAAAOINJAAAA  United States       AL        Hale County   97.0  102.09     0.00   64.31  2650.04  1946.0   5.0\n15  AAAAAAAAFABABAAA  United States       OK         Kay County   56.0  116.82     0.00   17.52 -2019.92  1952.0   1.0\n16  AAAAAAAANCLFAAAA  United States       WI  Green Lake County   26.0  146.43     0.00   96.64  1092.00  1933.0   4.0\n17  AAAAAAAALGOJAAAA  United States       OK       Mayes County    5.0    4.26     0.00    0.38    -5.80  1959.0   2.0\n18  AAAAAAAAOGFGBAAA  United States       AL   Limestone County   39.0   63.94   971.02   42.20  -864.55  1969.0   3.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.019482,
                    "execution_time": 0.008002,
                    "compile_time": 5.4e-05,
                    "planning_time": 0.004689
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.020604,
                    "execution_time": 0.007696,
                    "compile_time": 5.5e-05,
                    "planning_time": 0.004839
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\""
            }
        ],
        "preview": "\n/*           i_item_id     ca_country ca_state          ca_county   agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAFDHGBAAA  United States       KY       Logan County   73.0  102.54     0.00   93.31  2629.46  1940.0   3.0\n1   AAAAAAAACFDJAAAA  United States       NV   Esmeralda County    9.0   70.90   140.38   28.36  -215.80  1966.0   3.0\n2   AAAAAAAAMNLNAAAA  United States       KY     Fayette County   76.0    9.52     0.00    3.52   -66.12  1986.0   6.0\n3   AAAAAAAAKIMOAAAA  United States       KY      Carter County   77.0  144.02     0.00   31.68 -2742.74  1968.0   0.0\n4   AAAAAAAAEAKMAAAA  United States       KY  Montgomery County   70.0   25.93     0.00   23.33   651.70     NaN   6.0\n5   AAAAAAAAIDBEAAAA  United States       OK      Nowata County   41.0  151.46     0.00   21.20 -1644.92  1987.0   5.0\n6   AAAAAAAAMJPABAAA  United States       KY        Ohio County    4.0   45.73     0.00    1.37  -130.04  1959.0   5.0\n7   AAAAAAAAGOGIAAAA  United States       AL         Lee County  100.0    5.91     0.00    4.07   -78.00  1950.0   1.0\n8   AAAAAAAAMKEEBAAA  United States       SD       Butte County    1.0   86.94    40.08   46.07   -48.69  1935.0   3.0\n9   AAAAAAAAPCKNAAAA  United States       OK      Hughes County   46.0   84.95  1371.58   66.26  -337.96  1953.0   2.0\n10  AAAAAAAAGMKHAAAA  United States       KY     Jackson County   71.0   92.51     0.00    0.00 -2460.15  1935.0   2.0\n11  AAAAAAAAOHKPAAAA  United States       SD     Buffalo County    6.0  144.85   653.90  143.40  -111.86  1981.0   0.0\n12  AAAAAAAAHINDAAAA  United States       WI   Sheboygan County   62.0   84.23     0.00    5.05 -4909.16  1935.0   1.0\n13  AAAAAAAAGMNEAAAA  United States       WI      Vernon County   64.0  138.98     0.00    4.16 -5953.92  1973.0   6.0\n14  AAAAAAAAOINJAAAA  United States       AL        Hale County   97.0  102.09     0.00   64.31  2650.04  1946.0   5.0\n15  AAAAAAAAFABABAAA  United States       OK         Kay County   56.0  116.82     0.00   17.52 -2019.92  1952.0   1.0\n16  AAAAAAAANCLFAAAA  United States       WI  Green Lake County   26.0  146.43     0.00   96.64  1092.00  1933.0   4.0\n17  AAAAAAAALGOJAAAA  United States       OK       Mayes County    5.0    4.26     0.00    0.38    -5.80  1959.0   2.0\n18  AAAAAAAAOGFGBAAA  United States       AL   Limestone County   39.0   63.94   971.02   42.20  -864.55  1969.0   3.0\n...*/"
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id\n\tunion all\n\tselect NULL AS i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n ) foo\n order by ca_country, ca_state, ca_county, i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"FOO\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"FOO\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"FOO\".\"CA_STATE\" AS \"CA_STATE\" , \"FOO\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"FOO\".\"AGG1\" AS \"AGG1\" , \"FOO\".\"AGG2\" AS \"AGG2\" , \"FOO\".\"AGG3\" AS \"AGG3\" , \"FOO\".\"AGG4\" AS \"AGG4\" , \"FOO\".\"AGG5\" AS \"AGG5\" , \"FOO\".\"AGG6\" AS \"AGG6\" , \"FOO\".\"AGG7\" AS \"AGG7\" FROM \"FOO\" AS \"FOO\" ORDER BY \"CA_COUNTRY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"CA_COUNTRY\" , \"CA_STATE\" , \"CA_COUNTY\" , \"I_ITEM_ID\" LIMIT 21",
                "preview": "\n/*           i_item_id ca_country ca_state        ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAADHHAAAA                  AL                   98.0  133.93     0.00   89.73  3968.02  1985.0   3.0\n1   AAAAAAAAADMBBAAA                  AL                   49.0  152.98     0.00  139.21  3631.39  1985.0   3.0\n2   AAAAAAAAAEHFAAAA                  AL                   10.0    9.04     0.00    5.87   -12.00  1985.0   3.0\n3   AAAAAAAACGDMAAAA                  AL                   31.0  105.07     0.00   97.71  1066.71  1985.0   3.0\n4   AAAAAAAAEJBHBAAA                  AL                   43.0   94.15     0.00   77.20  1888.99  1985.0   3.0\n5   AAAAAAAAGOPPAAAA                  AL                   88.0   77.86     0.00   73.96   892.32  1985.0   3.0\n6   AAAAAAAAHJJAAAAA                  AL                   42.0   83.32   949.56   38.32 -1555.20  1985.0   3.0\n7   AAAAAAAAHLHAAAAA                  AL                    6.0   81.74   271.19   64.57  -204.35  1985.0   3.0\n8   AAAAAAAALNEFBAAA                  AL                   38.0   90.13     0.00   13.51  -824.60  1985.0   3.0\n9   AAAAAAAAMDOGAAAA                  AL                   39.0  131.02  1567.95   40.61 -3855.30  1985.0   3.0\n10  AAAAAAAAMIEDBAAA                  AL                   68.0  119.71     0.00   94.57    21.08  1985.0   3.0\n11  AAAAAAAAOAJDAAAA                  AL                   47.0  114.21     0.00   25.12 -3046.07  1985.0   3.0\n12  AAAAAAAACDGPAAAA                  AL  Marshall County   7.0   86.23     0.00   52.60   106.89  1974.0   1.0\n13  AAAAAAAACJKIAAAA                  AL  Marshall County  94.0   92.57  2341.47   63.87 -1643.99  1974.0   1.0\n14  AAAAAAAADDLBBAAA                  AL  Marshall County   6.0  100.79     0.00   64.50   157.92  1974.0   1.0\n15  AAAAAAAAJHMIBAAA                  AL  Marshall County  36.0  107.48   986.58   54.81 -2060.10  1974.0   1.0\n16  AAAAAAAALGLFBAAA                  AL  Marshall County  91.0   48.63     0.00   24.31 -1356.81  1974.0   1.0\n17  AAAAAAAALJKDBAAA                  AL  Marshall County  83.0  106.80     0.00   89.71  -468.95  1974.0   1.0\n18  AAAAAAAAMDHBAAAA                  AL  Marshall County  28.0  197.76     0.00  193.80  3398.08  1974.0   1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.023049,
                    "execution_time": 0.010648,
                    "compile_time": 8.8e-05,
                    "planning_time": 0.005128
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.063239,
                    "execution_time": 0.012237,
                    "compile_time": 8.5e-05,
                    "planning_time": 0.040573
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"CA_COUNTRY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"CA_COUNTRY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST"
            }
        ],
        "preview": "\n/*           i_item_id ca_country ca_state        ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAADHHAAAA                  AL                   98.0  133.93     0.00   89.73  3968.02  1985.0   3.0\n1   AAAAAAAAADMBBAAA                  AL                   49.0  152.98     0.00  139.21  3631.39  1985.0   3.0\n2   AAAAAAAAAEHFAAAA                  AL                   10.0    9.04     0.00    5.87   -12.00  1985.0   3.0\n3   AAAAAAAACGDMAAAA                  AL                   31.0  105.07     0.00   97.71  1066.71  1985.0   3.0\n4   AAAAAAAAEJBHBAAA                  AL                   43.0   94.15     0.00   77.20  1888.99  1985.0   3.0\n5   AAAAAAAAGOPPAAAA                  AL                   88.0   77.86     0.00   73.96   892.32  1985.0   3.0\n6   AAAAAAAAHJJAAAAA                  AL                   42.0   83.32   949.56   38.32 -1555.20  1985.0   3.0\n7   AAAAAAAAHLHAAAAA                  AL                    6.0   81.74   271.19   64.57  -204.35  1985.0   3.0\n8   AAAAAAAALNEFBAAA                  AL                   38.0   90.13     0.00   13.51  -824.60  1985.0   3.0\n9   AAAAAAAAMDOGAAAA                  AL                   39.0  131.02  1567.95   40.61 -3855.30  1985.0   3.0\n10  AAAAAAAAMIEDBAAA                  AL                   68.0  119.71     0.00   94.57    21.08  1985.0   3.0\n11  AAAAAAAAOAJDAAAA                  AL                   47.0  114.21     0.00   25.12 -3046.07  1985.0   3.0\n12  AAAAAAAACDGPAAAA                  AL  Marshall County   7.0   86.23     0.00   52.60   106.89  1974.0   1.0\n13  AAAAAAAACJKIAAAA                  AL  Marshall County  94.0   92.57  2341.47   63.87 -1643.99  1974.0   1.0\n14  AAAAAAAADDLBBAAA                  AL  Marshall County   6.0  100.79     0.00   64.50   157.92  1974.0   1.0\n15  AAAAAAAAJHMIBAAA                  AL  Marshall County  36.0  107.48   986.58   54.81 -2060.10  1974.0   1.0\n16  AAAAAAAALGLFBAAA                  AL  Marshall County  91.0   48.63     0.00   24.31 -1356.81  1974.0   1.0\n17  AAAAAAAALJKDBAAA                  AL  Marshall County  83.0  106.80     0.00   89.71  -468.95  1974.0   1.0\n18  AAAAAAAAMDHBAAAA                  AL  Marshall County  28.0  197.76     0.00  193.80  3398.08  1974.0   1.0\n...*/"
    },
    {
        "input": "-- start template query18a.tpl query 90 in stream 0\nwith /* TPC-DS query18a.tpl 0.90 */ results as\n (select i_item_id,\n        ca_country,\n        ca_state, \n        ca_county,\n        cast(cs_quantity as decimal(12,2)) agg1,\n        cast(cs_list_price as decimal(12,2)) agg2,\n        cast(cs_coupon_amt as decimal(12,2)) agg3,\n        cast(cs_sales_price as decimal(12,2)) agg4,\n        cast(cs_net_profit as decimal(12,2)) agg5,\n        cast(c_birth_year as decimal(12,2)) agg6,\n        cast(cd1.cd_dep_count as decimal(12,2)) agg7\n from catalog_sales, customer_demographics cd1, customer_demographics cd2, customer, customer_address, date_dim, item\n where cs_sold_date_sk = d_date_sk and\n       cs_item_sk = i_item_sk and\n       cs_bill_cdemo_sk = cd1.cd_demo_sk and\n       cs_bill_customer_sk = c_customer_sk and\n       cd1.cd_gender = 'M' and \n       cd1.cd_education_status = 'Primary' and\n       c_current_cdemo_sk = cd2.cd_demo_sk and\n       c_current_addr_sk = ca_address_sk and\n       c_birth_month in (9,5,1,2,3,8) and\n       d_year = 1999 and\n       ca_state in ('NV','AL','CA','WI','SD','OK','KY')\n )\n  select  i_item_id, ca_country, ca_state, ca_county, agg1, agg2, agg3, agg4, agg5, agg6, agg7\n from (\n \tselect i_item_id, ca_country, ca_state, ca_county, avg(agg1) agg1, \n \t\tavg(agg2) agg2, avg(agg3) agg3, avg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n \tfrom results\n\tgroup by i_item_id, ca_country, ca_state, ca_county\n \tunion all\n \tselect i_item_id, ca_country, ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id, ca_country, ca_state\n \tunion all\n\tselect i_item_id, ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n \tgroup by i_item_id, ca_country\n \tunion all\n \tselect i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n\tgroup by i_item_id\n\tunion all\n\tselect NULL AS i_item_id, NULL as ca_country, NULL as ca_state, NULL as county, avg(agg1) agg1, avg(agg2) agg2, avg(agg3) agg3,\n\t\tavg(agg4) agg4, avg(agg5) agg5, avg(agg6) agg6, avg(agg7) agg7 \n\tfrom results\n ) foo\n order by ca_country, ca_state, ca_county, i_item_id\n limit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"RESULTS\" AS ( SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"CUSTOMER_ADDRESS\".\"CA_STATE\" AS \"CA_STATE\" , \"CUSTOMER_ADDRESS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , CAST ( \"CATALOG_SALES\".\"CS_QUANTITY\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG1\" , \"CATALOG_SALES\".\"CS_LIST_PRICE\" AS \"AGG2\" , \"CATALOG_SALES\".\"CS_COUPON_AMT\" AS \"AGG3\" , \"CATALOG_SALES\".\"CS_SALES_PRICE\" AS \"AGG4\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"AGG5\" , CAST ( \"CUSTOMER\".\"C_BIRTH_YEAR\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG6\" , CAST ( \"CD1\".\"CD_DEP_COUNT\" AS DECIMAL ( 12 , 2 ) ) AS \"AGG7\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD1\" ON \"CATALOG_SALES\".\"CS_BILL_CDEMO_SK\" = \"CD1\".\"CD_DEMO_SK\" AND \"CD1\".\"CD_EDUCATION_STATUS\" = 'Primary' AND \"CD1\".\"CD_GENDER\" = 'M' JOIN \"CUSTOMER\" AS \"CUSTOMER\" ON \"CATALOG_SALES\".\"CS_BILL_CUSTOMER_SK\" = \"CUSTOMER\".\"C_CUSTOMER_SK\" AND \"CUSTOMER\".\"C_BIRTH_MONTH\" IN ( 9 , 5 , 1 , 2 , 3 , 8 ) JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" = \"DATE_DIM\".\"D_DATE_SK\" AND \"DATE_DIM\".\"D_YEAR\" = 1999 JOIN \"ITEM\" AS \"ITEM\" ON \"CATALOG_SALES\".\"CS_ITEM_SK\" = \"ITEM\".\"I_ITEM_SK\" JOIN \"CUSTOMER_DEMOGRAPHICS\" AS \"CD2\" ON \"CD2\".\"CD_DEMO_SK\" = \"CUSTOMER\".\"C_CURRENT_CDEMO_SK\" JOIN \"CUSTOMER_ADDRESS\" AS \"CUSTOMER_ADDRESS\" ON \"CUSTOMER\".\"C_CURRENT_ADDR_SK\" = \"CUSTOMER_ADDRESS\".\"CA_ADDRESS_SK\" AND \"CUSTOMER_ADDRESS\".\"CA_STATE\" IN ( 'NV' , 'AL' , 'CA' , 'WI' , 'SD' , 'OK' , 'KY' ) ) , \"FOO\" AS ( SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" AS \"CA_COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" , \"RESULTS\".\"CA_COUNTY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" , \"RESULTS\".\"CA_STATE\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" , \"RESULTS\".\"CA_COUNTRY\" UNION ALL SELECT \"RESULTS\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"I_ITEM_ID\" UNION ALL SELECT NULL AS \"I_ITEM_ID\" , NULL AS \"CA_COUNTRY\" , NULL AS \"CA_STATE\" , NULL AS \"COUNTY\" , AVG ( \"RESULTS\".\"AGG1\" ) AS \"AGG1\" , AVG ( \"RESULTS\".\"AGG2\" ) AS \"AGG2\" , AVG ( \"RESULTS\".\"AGG3\" ) AS \"AGG3\" , AVG ( \"RESULTS\".\"AGG4\" ) AS \"AGG4\" , AVG ( \"RESULTS\".\"AGG5\" ) AS \"AGG5\" , AVG ( \"RESULTS\".\"AGG6\" ) AS \"AGG6\" , AVG ( \"RESULTS\".\"AGG7\" ) AS \"AGG7\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"FOO\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"FOO\".\"CA_STATE\" AS \"CA_STATE\" , \"FOO\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"FOO\".\"AGG1\" AS \"AGG1\" , \"FOO\".\"AGG2\" AS \"AGG2\" , \"FOO\".\"AGG3\" AS \"AGG3\" , \"FOO\".\"AGG4\" AS \"AGG4\" , \"FOO\".\"AGG5\" AS \"AGG5\" , \"FOO\".\"AGG6\" AS \"AGG6\" , \"FOO\".\"AGG7\" AS \"AGG7\" FROM \"FOO\" AS \"FOO\" ORDER BY \"CA_COUNTRY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"CA_COUNTRY\" , \"CA_STATE\" , \"CA_COUNTY\" , \"I_ITEM_ID\" LIMIT 21",
                "preview": "\n/*           i_item_id ca_country ca_state        ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAADHHAAAA                  AL                   98.0  133.93     0.00   89.73  3968.02  1985.0   3.0\n1   AAAAAAAAADMBBAAA                  AL                   49.0  152.98     0.00  139.21  3631.39  1985.0   3.0\n2   AAAAAAAAAEHFAAAA                  AL                   10.0    9.04     0.00    5.87   -12.00  1985.0   3.0\n3   AAAAAAAACGDMAAAA                  AL                   31.0  105.07     0.00   97.71  1066.71  1985.0   3.0\n4   AAAAAAAAEJBHBAAA                  AL                   43.0   94.15     0.00   77.20  1888.99  1985.0   3.0\n5   AAAAAAAAGOPPAAAA                  AL                   88.0   77.86     0.00   73.96   892.32  1985.0   3.0\n6   AAAAAAAAHJJAAAAA                  AL                   42.0   83.32   949.56   38.32 -1555.20  1985.0   3.0\n7   AAAAAAAAHLHAAAAA                  AL                    6.0   81.74   271.19   64.57  -204.35  1985.0   3.0\n8   AAAAAAAALNEFBAAA                  AL                   38.0   90.13     0.00   13.51  -824.60  1985.0   3.0\n9   AAAAAAAAMDOGAAAA                  AL                   39.0  131.02  1567.95   40.61 -3855.30  1985.0   3.0\n10  AAAAAAAAMIEDBAAA                  AL                   68.0  119.71     0.00   94.57    21.08  1985.0   3.0\n11  AAAAAAAAOAJDAAAA                  AL                   47.0  114.21     0.00   25.12 -3046.07  1985.0   3.0\n12  AAAAAAAACDGPAAAA                  AL  Marshall County   7.0   86.23     0.00   52.60   106.89  1974.0   1.0\n13  AAAAAAAACJKIAAAA                  AL  Marshall County  94.0   92.57  2341.47   63.87 -1643.99  1974.0   1.0\n14  AAAAAAAADDLBBAAA                  AL  Marshall County   6.0  100.79     0.00   64.50   157.92  1974.0   1.0\n15  AAAAAAAAJHMIBAAA                  AL  Marshall County  36.0  107.48   986.58   54.81 -2060.10  1974.0   1.0\n16  AAAAAAAALGLFBAAA                  AL  Marshall County  91.0   48.63     0.00   24.31 -1356.81  1974.0   1.0\n17  AAAAAAAALJKDBAAA                  AL  Marshall County  83.0  106.80     0.00   89.71  -468.95  1974.0   1.0\n18  AAAAAAAAMDHBAAAA                  AL  Marshall County  28.0  197.76     0.00  193.80  3398.08  1974.0   1.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.022558,
                    "execution_time": 0.010447,
                    "compile_time": 8.4e-05,
                    "planning_time": 0.005203
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.023762,
                    "execution_time": 0.011395,
                    "compile_time": 8.5e-05,
                    "planning_time": 0.005303
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"CA_COUNTRY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST LIMIT 100",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_4\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTRY\" AS \"CA_COUNTRY\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_STATE\" AS \"CA_STATE\" , \"SPEQLITE_TEMP_TABLE_4\".\"CA_COUNTY\" AS \"CA_COUNTY\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG1\" AS \"AGG1\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG2\" AS \"AGG2\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG3\" AS \"AGG3\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG4\" AS \"AGG4\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG5\" AS \"AGG5\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG6\" AS \"AGG6\" , \"SPEQLITE_TEMP_TABLE_4\".\"AGG7\" AS \"AGG7\" FROM \"SPEQLITE_TEMP_TABLE_4\" AS \"SPEQLITE_TEMP_TABLE_4\" ORDER BY \"CA_COUNTRY\" NULLS LAST , \"CA_STATE\" NULLS LAST , \"CA_COUNTY\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST LIMIT 100"
            }
        ],
        "preview": "\n/*           i_item_id ca_country ca_state        ca_county  agg1    agg2     agg3    agg4     agg5    agg6  agg7\n0   AAAAAAAAADHHAAAA                  AL                   98.0  133.93     0.00   89.73  3968.02  1985.0   3.0\n1   AAAAAAAAADMBBAAA                  AL                   49.0  152.98     0.00  139.21  3631.39  1985.0   3.0\n2   AAAAAAAAAEHFAAAA                  AL                   10.0    9.04     0.00    5.87   -12.00  1985.0   3.0\n3   AAAAAAAACGDMAAAA                  AL                   31.0  105.07     0.00   97.71  1066.71  1985.0   3.0\n4   AAAAAAAAEJBHBAAA                  AL                   43.0   94.15     0.00   77.20  1888.99  1985.0   3.0\n5   AAAAAAAAGOPPAAAA                  AL                   88.0   77.86     0.00   73.96   892.32  1985.0   3.0\n6   AAAAAAAAHJJAAAAA                  AL                   42.0   83.32   949.56   38.32 -1555.20  1985.0   3.0\n7   AAAAAAAAHLHAAAAA                  AL                    6.0   81.74   271.19   64.57  -204.35  1985.0   3.0\n8   AAAAAAAALNEFBAAA                  AL                   38.0   90.13     0.00   13.51  -824.60  1985.0   3.0\n9   AAAAAAAAMDOGAAAA                  AL                   39.0  131.02  1567.95   40.61 -3855.30  1985.0   3.0\n10  AAAAAAAAMIEDBAAA                  AL                   68.0  119.71     0.00   94.57    21.08  1985.0   3.0\n11  AAAAAAAAOAJDAAAA                  AL                   47.0  114.21     0.00   25.12 -3046.07  1985.0   3.0\n12  AAAAAAAACDGPAAAA                  AL  Marshall County   7.0   86.23     0.00   52.60   106.89  1974.0   1.0\n13  AAAAAAAACJKIAAAA                  AL  Marshall County  94.0   92.57  2341.47   63.87 -1643.99  1974.0   1.0\n14  AAAAAAAADDLBBAAA                  AL  Marshall County   6.0  100.79     0.00   64.50   157.92  1974.0   1.0\n15  AAAAAAAAJHMIBAAA                  AL  Marshall County  36.0  107.48   986.58   54.81 -2060.10  1974.0   1.0\n16  AAAAAAAALGLFBAAA                  AL  Marshall County  91.0   48.63     0.00   24.31 -1356.81  1974.0   1.0\n17  AAAAAAAALJKDBAAA                  AL  Marshall County  83.0  106.80     0.00   89.71  -468.95  1974.0   1.0\n18  AAAAAAAAMDHBAAAA                  AL  Marshall County  28.0  197.76     0.00  193.80  3398.08  1974.0   1.0\n...*/"
    }
]