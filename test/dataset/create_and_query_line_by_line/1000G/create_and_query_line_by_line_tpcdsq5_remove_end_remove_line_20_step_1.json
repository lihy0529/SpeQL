[
    {
        "input": "-- start template query5a.tpl query 98 in stream 0\nwith /* TPC-DS query5a.tpl 0.98 */ ssr as\n (select s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_sold_date_sk  as date_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from store_sales\n    union all\n    select sr_store_sk as store_sk,\n           sr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns\n   ) salesreturns,\n     (select d_date_sk, d_date from date_dim) as dim, -- Assuming date_dim has these columns\n     store\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date) \n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and store_sk = s_store_sk\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_sold_date_sk  as date_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from catalog_sales\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns\n   ) salesreturns,\n     (select d_date_sk, d_date from date_dim) as dim, -- Assuming date_dim has these columns\n     catalog_page\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_sold_date_sk  as date_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from web_sales\n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           wr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n   ) salesreturns,\n     (select d_date_sk, d_date from date_dim) as dim, -- Assuming date_dim has these columns\n     web_site\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and wsr_web_site_sk = web_site_sk\n group by web_site_id)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  wsr\n ) summary\n group by rollup(channel, id)\n )\n select * from results\n order by channel, id\n /*CURSOR_IDENTIFIER*/;",
        "optimize": [
            "WITH \"SALESRETURNS\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" ) , \"DIM\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 14 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-08-11' AS DATE ) ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS\" AS \"SALESRETURNS\" JOIN \"DIM\" AS \"DIM\" ON \"DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"SALESRETURNS\".\"STORE_SK\" = \"STORE\".\"S_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"SALESRETURNS_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" UNION ALL SELECT \"CATALOG_RETURNS\".\"CR_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" AS \"RETURN_AMT\" , \"CATALOG_RETURNS\".\"CR_NET_LOSS\" AS \"NET_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CP_CATALOG_PAGE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_2\" AS \"SALESRETURNS\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"SALESRETURNS\".\"PAGE_SK\" JOIN \"DIM\" AS \"DIM\" ON \"DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"SALESRETURNS_3\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"WEB_SALES\".\"WS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"WEB_RETURNS\".\"WR_RETURN_AMT\" AS \"RETURN_AMT\" , \"WEB_RETURNS\".\"WR_NET_LOSS\" AS \"NET_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" LEFT JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_3\" AS \"SALESRETURNS\" JOIN \"DIM\" AS \"DIM\" ON \"DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"SALESRETURNS\".\"WSR_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"SUMMARY\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"S_STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS\" AS \"RETURNS\" , \"SSR\".\"PROFIT\" - \"SSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CP_CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS\" AS \"RETURNS\" , \"CSR\".\"PROFIT\" - \"CSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS\" AS \"RETURNS\" , \"WSR\".\"PROFIT\" - \"WSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) , \"RESULTS\" AS ( SELECT \"SUMMARY\".\"CHANNEL\" AS \"CHANNEL\" , \"SUMMARY\".\"ID\" AS \"ID\" , SUM ( \"SUMMARY\".\"SALES\" ) AS \"SALES\" , SUM ( \"SUMMARY\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"SUMMARY\".\"PROFIT\" ) AS \"PROFIT\" FROM \"SUMMARY\" AS \"SUMMARY\" GROUP BY ROLLUP ( \"SUMMARY\".\"CHANNEL\" , \"SUMMARY\".\"ID\" ) ) SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" ORDER BY \"RESULTS\".\"CHANNEL\" NULLS LAST , \"RESULTS\".\"ID\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT SS_STORE_SK AS STORE_SK , SS_SOLD_DATE_SK AS DATE_SK , SS_EXT_SALES_PRICE AS SALES_PRICE , SS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM STORE_SALES UNION ALL SELECT SR_STORE_SK AS STORE_SK , SR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , SR_RETURN_AMT AS RETURN_AMT , SR_NET_LOSS AS NET_LOSS FROM STORE_RETURNS ) AS SALESRETURNS , ( SELECT D_DATE_SK , D_DATE FROM DATE_DIM ) AS DIM , STORE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND STORE_SK = S_STORE_SK GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT CS_CATALOG_PAGE_SK AS PAGE_SK , CS_SOLD_DATE_SK AS DATE_SK , CS_EXT_SALES_PRICE AS SALES_PRICE , CS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM CATALOG_SALES UNION ALL SELECT CR_CATALOG_PAGE_SK AS PAGE_SK , CR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , CR_RETURN_AMOUNT AS RETURN_AMT , CR_NET_LOSS AS NET_LOSS FROM CATALOG_RETURNS ) AS SALESRETURNS , ( SELECT D_DATE_SK , D_DATE FROM DATE_DIM ) AS DIM , CATALOG_PAGE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND PAGE_SK = CP_CATALOG_PAGE_SK GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WS_SOLD_DATE_SK AS DATE_SK , WS_EXT_SALES_PRICE AS SALES_PRICE , WS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM WEB_SALES UNION ALL SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , WR_RETURN_AMT AS RETURN_AMT , WR_NET_LOSS AS NET_LOSS FROM WEB_RETURNS LEFT OUTER JOIN WEB_SALES ON ( WR_ITEM_SK = WS_ITEM_SK AND WR_ORDER_NUMBER = WS_ORDER_NUMBER ) ) AS SALESRETURNS , ( SELECT D_DATE_SK , D_DATE FROM DATE_DIM ) AS DIM , WEB_SITE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND WSR_WEB_SITE_SK = WEB_SITE_SK GROUP BY WEB_SITE_ID ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || S_STORE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CP_CATALOG_PAGE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM WSR ) AS SUMMARY GROUP BY ROLLUP ( CHANNEL , ID ) ) SELECT * FROM RESULTS ORDER BY CHANNEL NULLS FIRST , ID NULLS FIRST LIMIT 21",
                "preview": "\n/*            channel                            id         sales       returns        profit\n0              None                          None  1.139289e+11  2.456063e+09 -3.115885e+10\n1   catalog channel                          None  3.933968e+10  8.143654e+08 -4.419421e+09\n2   catalog channel  catalog_pageAAAAAAAAAABAAAAA  0.000000e+00  1.656711e+06 -9.172215e+05\n3   catalog channel  catalog_pageAAAAAAAAAACAAAAA  7.044388e+07  5.136965e+05 -8.143912e+06\n4   catalog channel  catalog_pageAAAAAAAAAADAAAAA  3.616008e+07  1.776591e+05 -3.584936e+06\n5   catalog channel  catalog_pageAAAAAAAAAAEAAAAA  0.000000e+00  1.364126e+05 -6.931269e+04\n6   catalog channel  catalog_pageAAAAAAAAAAFAAAAA  0.000000e+00  1.428035e+05 -8.549706e+04\n7   catalog channel  catalog_pageAAAAAAAAAAGAAAAA  0.000000e+00  1.170422e+05 -8.117707e+04\n8   catalog channel  catalog_pageAAAAAAAAAAHAAAAA  0.000000e+00  4.710439e+04 -2.456803e+04\n9   catalog channel  catalog_pageAAAAAAAAAAIAAAAA  3.531500e+07  6.323390e+03 -3.542951e+06\n10  catalog channel  catalog_pageAAAAAAAAABAAAAAA  0.000000e+00  1.838226e+06 -1.041520e+06\n11  catalog channel  catalog_pageAAAAAAAAABBAAAAA  0.000000e+00  1.821163e+06 -1.089170e+06\n12  catalog channel  catalog_pageAAAAAAAAABCAAAAA  6.981124e+07  6.277490e+05 -7.962786e+06\n13  catalog channel  catalog_pageAAAAAAAAABDAAAAA  3.626820e+07  2.007993e+05 -3.459942e+06\n14  catalog channel  catalog_pageAAAAAAAAABEAAAAA  0.000000e+00  1.616619e+05 -9.393338e+04\n15  catalog channel  catalog_pageAAAAAAAAABFAAAAA  0.000000e+00  1.471747e+05 -7.597794e+04\n16  catalog channel  catalog_pageAAAAAAAAABGAAAAA  0.000000e+00  8.522167e+04 -4.560551e+04\n17  catalog channel  catalog_pageAAAAAAAAABHAAAAA  0.000000e+00  2.702420e+04 -2.594221e+04\n18  catalog channel  catalog_pageAAAAAAAAABIAAAAA  3.577945e+07  1.219200e+02 -3.528809e+06\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.110342,
                    "execution_time": 1.89926,
                    "compile_time": 0.000846,
                    "planning_time": 0.172059
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 29.321309,
                    "execution_time": 25.996028,
                    "compile_time": 3.10987,
                    "planning_time": 0.174546
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id         sales       returns        profit\n0              None                          None  1.139289e+11  2.456063e+09 -3.115885e+10\n1   catalog channel                          None  3.933968e+10  8.143654e+08 -4.419421e+09\n2   catalog channel  catalog_pageAAAAAAAAAABAAAAA  0.000000e+00  1.656711e+06 -9.172215e+05\n3   catalog channel  catalog_pageAAAAAAAAAACAAAAA  7.044388e+07  5.136965e+05 -8.143912e+06\n4   catalog channel  catalog_pageAAAAAAAAAADAAAAA  3.616008e+07  1.776591e+05 -3.584936e+06\n5   catalog channel  catalog_pageAAAAAAAAAAEAAAAA  0.000000e+00  1.364126e+05 -6.931269e+04\n6   catalog channel  catalog_pageAAAAAAAAAAFAAAAA  0.000000e+00  1.428035e+05 -8.549706e+04\n7   catalog channel  catalog_pageAAAAAAAAAAGAAAAA  0.000000e+00  1.170422e+05 -8.117707e+04\n8   catalog channel  catalog_pageAAAAAAAAAAHAAAAA  0.000000e+00  4.710439e+04 -2.456803e+04\n9   catalog channel  catalog_pageAAAAAAAAAAIAAAAA  3.531500e+07  6.323390e+03 -3.542951e+06\n10  catalog channel  catalog_pageAAAAAAAAABAAAAAA  0.000000e+00  1.838226e+06 -1.041520e+06\n11  catalog channel  catalog_pageAAAAAAAAABBAAAAA  0.000000e+00  1.821163e+06 -1.089170e+06\n12  catalog channel  catalog_pageAAAAAAAAABCAAAAA  6.981124e+07  6.277490e+05 -7.962786e+06\n13  catalog channel  catalog_pageAAAAAAAAABDAAAAA  3.626820e+07  2.007993e+05 -3.459942e+06\n14  catalog channel  catalog_pageAAAAAAAAABEAAAAA  0.000000e+00  1.616619e+05 -9.393338e+04\n15  catalog channel  catalog_pageAAAAAAAAABFAAAAA  0.000000e+00  1.471747e+05 -7.597794e+04\n16  catalog channel  catalog_pageAAAAAAAAABGAAAAA  0.000000e+00  8.522167e+04 -4.560551e+04\n17  catalog channel  catalog_pageAAAAAAAAABHAAAAA  0.000000e+00  2.702420e+04 -2.594221e+04\n18  catalog channel  catalog_pageAAAAAAAAABIAAAAA  3.577945e+07  1.219200e+02 -3.528809e+06\n...*/"
    },
    {
        "input": "-- start template query5a.tpl query 98 in stream 0\nwith /* TPC-DS query5a.tpl 0.98 */ ssr as\n (select s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_sold_date_sk  as date_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from store_sales\n    union all\n    select sr_store_sk as store_sk,\n           sr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns\n   ) salesreturns,\n     date_dim,\n     store\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date) \n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and store_sk = s_store_sk\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_sold_date_sk  as date_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from catalog_sales\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns\n   ) salesreturns,\n     date_dim,\n     catalog_page\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_sold_date_sk  as date_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from web_sales\n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           wr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n   ) salesreturns,\n     date_dim,\n     web_site\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and wsr_web_site_sk = web_site_sk\n group by web_site_id)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   csr\n union all\n select 'web channel' as channel\n        , 'web' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) as combined\n group by channel, id\n )\nselect *\nfrom results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALESRETURNS\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 14 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-08-11' AS DATE ) ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"SALESRETURNS\".\"STORE_SK\" = \"STORE\".\"S_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"SALESRETURNS_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" UNION ALL SELECT \"CATALOG_RETURNS\".\"CR_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" AS \"RETURN_AMT\" , \"CATALOG_RETURNS\".\"CR_NET_LOSS\" AS \"NET_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CP_CATALOG_PAGE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_2\" AS \"SALESRETURNS\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"SALESRETURNS\".\"PAGE_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"SALESRETURNS_3\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"WEB_SALES\".\"WS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"WEB_RETURNS\".\"WR_RETURN_AMT\" AS \"RETURN_AMT\" , \"WEB_RETURNS\".\"WR_NET_LOSS\" AS \"NET_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" LEFT JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_3\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"SALESRETURNS\".\"WSR_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"COMBINED\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"S_STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS\" AS \"RETURNS\" , \"SSR\".\"PROFIT\" - \"SSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CP_CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS\" AS \"RETURNS\" , \"CSR\".\"PROFIT\" - \"CSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS\" AS \"RETURNS\" , \"WSR\".\"PROFIT\" - \"WSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) , \"RESULTS\" AS ( SELECT \"COMBINED\".\"CHANNEL\" AS \"CHANNEL\" , \"COMBINED\".\"ID\" AS \"ID\" , SUM ( \"COMBINED\".\"SALES\" ) AS \"SALES\" , SUM ( \"COMBINED\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"COMBINED\".\"PROFIT\" ) AS \"PROFIT\" FROM \"COMBINED\" AS \"COMBINED\" GROUP BY \"COMBINED\".\"CHANNEL\" , \"COMBINED\".\"ID\" ) SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT SS_STORE_SK AS STORE_SK , SS_SOLD_DATE_SK AS DATE_SK , SS_EXT_SALES_PRICE AS SALES_PRICE , SS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM STORE_SALES UNION ALL SELECT SR_STORE_SK AS STORE_SK , SR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , SR_RETURN_AMT AS RETURN_AMT , SR_NET_LOSS AS NET_LOSS FROM STORE_RETURNS ) AS SALESRETURNS , DATE_DIM , STORE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND STORE_SK = S_STORE_SK GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT CS_CATALOG_PAGE_SK AS PAGE_SK , CS_SOLD_DATE_SK AS DATE_SK , CS_EXT_SALES_PRICE AS SALES_PRICE , CS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM CATALOG_SALES UNION ALL SELECT CR_CATALOG_PAGE_SK AS PAGE_SK , CR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , CR_RETURN_AMOUNT AS RETURN_AMT , CR_NET_LOSS AS NET_LOSS FROM CATALOG_RETURNS ) AS SALESRETURNS , DATE_DIM , CATALOG_PAGE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND PAGE_SK = CP_CATALOG_PAGE_SK GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WS_SOLD_DATE_SK AS DATE_SK , WS_EXT_SALES_PRICE AS SALES_PRICE , WS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM WEB_SALES UNION ALL SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , WR_RETURN_AMT AS RETURN_AMT , WR_NET_LOSS AS NET_LOSS FROM WEB_RETURNS LEFT OUTER JOIN WEB_SALES ON ( WR_ITEM_SK = WS_ITEM_SK AND WR_ORDER_NUMBER = WS_ORDER_NUMBER ) ) AS SALESRETURNS , DATE_DIM , WEB_SITE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND WSR_WEB_SITE_SK = WEB_SITE_SK GROUP BY WEB_SITE_ID ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || S_STORE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CP_CATALOG_PAGE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web' || WEB_SITE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM WSR ) AS COMBINED GROUP BY CHANNEL , ID ) SELECT * FROM RESULTS LIMIT 21",
                "preview": "\n/*            channel                            id         sales     returns       profit\n0     store channel         storeAAAAAAAAGDCAAAAA  1.076905e+08  2700512.42 -49006189.84\n1     store channel         storeAAAAAAAADMBAAAAA  1.093360e+08  2681808.93 -48734980.34\n2     store channel         storeAAAAAAAAMHBAAAAA  1.104753e+08  2837849.98 -49911512.95\n3     store channel         storeAAAAAAAAPKDAAAAA  1.071633e+08  2794880.79 -48305969.12\n4     store channel         storeAAAAAAAAHKCAAAAA  1.090882e+08  2728221.98 -48934073.44\n5   catalog channel  catalog_pageAAAAAAAAFCDAAAAA  3.589285e+07   195902.65  -3520852.60\n6   catalog channel  catalog_pageAAAAAAAACPCAAAAA  3.530103e+07   185259.08  -3838080.05\n7   catalog channel  catalog_pageAAAAAAAAOMCAAAAA  3.555729e+07   203844.22  -3322598.50\n8   catalog channel  catalog_pageAAAAAAAADMBAAAAA  7.153583e+07   589622.64  -7549514.02\n9   catalog channel  catalog_pageAAAAAAAADKHAAAAA  3.626743e+07     8161.28  -3532569.38\n10  catalog channel  catalog_pageAAAAAAAAPMHAAAAA  3.590986e+07      239.29  -2956121.21\n11  catalog channel  catalog_pageAAAAAAAALIBAAAAA  7.089724e+07   584918.84  -6914313.70\n12  catalog channel  catalog_pageAAAAAAAADCDAAAAA  3.561098e+07   158051.24  -3668703.06\n13  catalog channel  catalog_pageAAAAAAAAPJHAAAAA  3.493310e+07      989.64  -4100797.89\n14  catalog channel  catalog_pageAAAAAAAAKDIAAAAA  3.599760e+07      981.42  -3413976.22\n15  catalog channel  catalog_pageAAAAAAAALOHAAAAA  3.536355e+07     8338.67  -3740365.73\n16  catalog channel  catalog_pageAAAAAAAAHOCAAAAA  3.604311e+07   246119.84  -2967260.13\n17  catalog channel  catalog_pageAAAAAAAAMBDAAAAA  3.560285e+07   175691.33  -3883503.46\n18  catalog channel  catalog_pageAAAAAAAACLCAAAAA  3.665413e+07   157504.01  -3329317.29\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.087647,
                    "execution_time": 1.897011,
                    "compile_time": 0.000781,
                    "planning_time": 0.154021
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 7.180031,
                    "execution_time": 6.873231,
                    "compile_time": 0.000773,
                    "planning_time": 0.267303
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id         sales     returns       profit\n0     store channel         storeAAAAAAAAGDCAAAAA  1.076905e+08  2700512.42 -49006189.84\n1     store channel         storeAAAAAAAADMBAAAAA  1.093360e+08  2681808.93 -48734980.34\n2     store channel         storeAAAAAAAAMHBAAAAA  1.104753e+08  2837849.98 -49911512.95\n3     store channel         storeAAAAAAAAPKDAAAAA  1.071633e+08  2794880.79 -48305969.12\n4     store channel         storeAAAAAAAAHKCAAAAA  1.090882e+08  2728221.98 -48934073.44\n5   catalog channel  catalog_pageAAAAAAAAFCDAAAAA  3.589285e+07   195902.65  -3520852.60\n6   catalog channel  catalog_pageAAAAAAAACPCAAAAA  3.530103e+07   185259.08  -3838080.05\n7   catalog channel  catalog_pageAAAAAAAAOMCAAAAA  3.555729e+07   203844.22  -3322598.50\n8   catalog channel  catalog_pageAAAAAAAADMBAAAAA  7.153583e+07   589622.64  -7549514.02\n9   catalog channel  catalog_pageAAAAAAAADKHAAAAA  3.626743e+07     8161.28  -3532569.38\n10  catalog channel  catalog_pageAAAAAAAAPMHAAAAA  3.590986e+07      239.29  -2956121.21\n11  catalog channel  catalog_pageAAAAAAAALIBAAAAA  7.089724e+07   584918.84  -6914313.70\n12  catalog channel  catalog_pageAAAAAAAADCDAAAAA  3.561098e+07   158051.24  -3668703.06\n13  catalog channel  catalog_pageAAAAAAAAPJHAAAAA  3.493310e+07      989.64  -4100797.89\n14  catalog channel  catalog_pageAAAAAAAAKDIAAAAA  3.599760e+07      981.42  -3413976.22\n15  catalog channel  catalog_pageAAAAAAAALOHAAAAA  3.536355e+07     8338.67  -3740365.73\n16  catalog channel  catalog_pageAAAAAAAAHOCAAAAA  3.604311e+07   246119.84  -2967260.13\n17  catalog channel  catalog_pageAAAAAAAAMBDAAAAA  3.560285e+07   175691.33  -3883503.46\n18  catalog channel  catalog_pageAAAAAAAACLCAAAAA  3.665413e+07   157504.01  -3329317.29\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query5a.tpl query 98 in stream 0\nwith /* TPC-DS query5a.tpl 0.98 */ ssr as\n (select s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(returns) as returns,\n        sum(profit_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_sold_date_sk  as date_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as decimal(7,2)) as returns,\n            cast(0 as decimal(7,2)) as profit_loss\n    from store_sales\n    union all\n    select sr_store_sk as store_sk,\n           sr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           sr_return_amt as returns,\n           sr_net_loss as profit_loss\n    from store_returns\n   ) salesreturns,\n     date_dim,\n     store\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and store_sk = s_store_sk\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(returns) as returns,\n        sum(profit_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_sold_date_sk  as date_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as decimal(7,2)) as returns,\n            cast(0 as decimal(7,2)) as profit_loss\n    from catalog_sales\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           cr_return_amount as returns,\n           cr_net_loss as profit_loss\n    from catalog_returns\n   ) salesreturns,\n     date_dim,\n     catalog_page\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(returns) as returns,\n        sum(profit_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_sold_date_sk  as date_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as decimal(7,2)) as returns,\n            cast(0 as decimal(7,2)) as profit_loss\n    from web_sales\n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           wr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           wr_return_amt as returns,\n           wr_net_loss as profit_loss\n    from web_returns left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n   ) salesreturns,\n     date_dim,\n     web_site\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and wsr_web_site_sk = web_site_sk\n group by web_site_id)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  wsr\n )\n group by channel, id)\nselect * from results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALESRETURNS\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURNS\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURNS\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"PROFIT_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 14 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-08-11' AS DATE ) ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"PROFIT_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"SALESRETURNS\".\"STORE_SK\" = \"STORE\".\"S_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"SALESRETURNS_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURNS\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT_LOSS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" UNION ALL SELECT \"CATALOG_RETURNS\".\"CR_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" AS \"RETURNS\" , \"CATALOG_RETURNS\".\"CR_NET_LOSS\" AS \"PROFIT_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CP_CATALOG_PAGE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"PROFIT_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_2\" AS \"SALESRETURNS\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"SALESRETURNS\".\"PAGE_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"SALESRETURNS_3\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"WEB_SALES\".\"WS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURNS\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT_LOSS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"WEB_RETURNS\".\"WR_RETURN_AMT\" AS \"RETURNS\" , \"WEB_RETURNS\".\"WR_NET_LOSS\" AS \"PROFIT_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" LEFT JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"PROFIT_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_3\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"SALESRETURNS\".\"WSR_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"_Q_0\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"S_STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS\" AS \"RETURNS\" , \"SSR\".\"PROFIT\" - \"SSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CP_CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS\" AS \"RETURNS\" , \"CSR\".\"PROFIT\" - \"CSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS\" AS \"RETURNS\" , \"WSR\".\"PROFIT\" - \"WSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) , \"RESULTS\" AS ( SELECT \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"ID\" AS \"ID\" , SUM ( \"_Q_0\".\"SALES\" ) AS \"SALES\" , SUM ( \"_Q_0\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"_Q_0\".\"PROFIT\" ) AS \"PROFIT\" FROM \"_Q_0\" AS \"_Q_0\" GROUP BY \"_Q_0\".\"CHANNEL\" , \"_Q_0\".\"ID\" ) SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURNS\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURNS\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"PROFIT_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT_LOSS ) AS PROFIT_LOSS FROM ( SELECT SS_STORE_SK AS STORE_SK , SS_SOLD_DATE_SK AS DATE_SK , SS_EXT_SALES_PRICE AS SALES_PRICE , SS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURNS , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT_LOSS FROM STORE_SALES UNION ALL SELECT SR_STORE_SK AS STORE_SK , SR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , SR_RETURN_AMT AS RETURNS , SR_NET_LOSS AS PROFIT_LOSS FROM STORE_RETURNS ) AS SALESRETURNS , DATE_DIM , STORE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND STORE_SK = S_STORE_SK GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT_LOSS ) AS PROFIT_LOSS FROM ( SELECT CS_CATALOG_PAGE_SK AS PAGE_SK , CS_SOLD_DATE_SK AS DATE_SK , CS_EXT_SALES_PRICE AS SALES_PRICE , CS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURNS , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT_LOSS FROM CATALOG_SALES UNION ALL SELECT CR_CATALOG_PAGE_SK AS PAGE_SK , CR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , CR_RETURN_AMOUNT AS RETURNS , CR_NET_LOSS AS PROFIT_LOSS FROM CATALOG_RETURNS ) AS SALESRETURNS , DATE_DIM , CATALOG_PAGE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND PAGE_SK = CP_CATALOG_PAGE_SK GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT_LOSS ) AS PROFIT_LOSS FROM ( SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WS_SOLD_DATE_SK AS DATE_SK , WS_EXT_SALES_PRICE AS SALES_PRICE , WS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURNS , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT_LOSS FROM WEB_SALES UNION ALL SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , WR_RETURN_AMT AS RETURNS , WR_NET_LOSS AS PROFIT_LOSS FROM WEB_RETURNS LEFT OUTER JOIN WEB_SALES ON ( WR_ITEM_SK = WS_ITEM_SK AND WR_ORDER_NUMBER = WS_ORDER_NUMBER ) ) AS SALESRETURNS , DATE_DIM , WEB_SITE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND WSR_WEB_SITE_SK = WEB_SITE_SK GROUP BY WEB_SITE_ID ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || S_STORE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CP_CATALOG_PAGE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web' || WEB_SITE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM WSR ) GROUP BY CHANNEL , ID ) SELECT * FROM RESULTS LIMIT 21",
                "preview": "\n/*            channel                            id         sales     returns       profit\n0     store channel         storeAAAAAAAAMHBAAAAA  1.104753e+08  2837849.98 -49911512.95\n1     store channel         storeAAAAAAAAHKCAAAAA  1.090882e+08  2728221.98 -48934073.44\n2     store channel         storeAAAAAAAADMBAAAAA  1.093360e+08  2681808.93 -48734980.34\n3     store channel         storeAAAAAAAAGDCAAAAA  1.076905e+08  2700512.42 -49006189.84\n4     store channel         storeAAAAAAAAPKDAAAAA  1.071633e+08  2794880.79 -48305969.12\n5   catalog channel  catalog_pageAAAAAAAAFCDAAAAA  3.589285e+07   195902.65  -3520852.60\n6   catalog channel  catalog_pageAAAAAAAACPCAAAAA  3.530103e+07   185259.08  -3838080.05\n7   catalog channel  catalog_pageAAAAAAAAOMCAAAAA  3.555729e+07   203844.22  -3322598.50\n8   catalog channel  catalog_pageAAAAAAAADMBAAAAA  7.153583e+07   589622.64  -7549514.02\n9   catalog channel  catalog_pageAAAAAAAADKHAAAAA  3.626743e+07     8161.28  -3532569.38\n10  catalog channel  catalog_pageAAAAAAAAPMHAAAAA  3.590986e+07      239.29  -2956121.21\n11  catalog channel  catalog_pageAAAAAAAALIBAAAAA  7.089724e+07   584918.84  -6914313.70\n12  catalog channel  catalog_pageAAAAAAAADCDAAAAA  3.561098e+07   158051.24  -3668703.06\n13  catalog channel  catalog_pageAAAAAAAAPJHAAAAA  3.493310e+07      989.64  -4100797.89\n14  catalog channel  catalog_pageAAAAAAAAKDIAAAAA  3.599760e+07      981.42  -3413976.22\n15  catalog channel  catalog_pageAAAAAAAALOHAAAAA  3.536355e+07     8338.67  -3740365.73\n16  catalog channel  catalog_pageAAAAAAAAHOCAAAAA  3.604311e+07   246119.84  -2967260.13\n17  catalog channel  catalog_pageAAAAAAAAMBDAAAAA  3.560285e+07   175691.33  -3883503.46\n18  catalog channel  catalog_pageAAAAAAAACLCAAAAA  3.665413e+07   157504.01  -3329317.29\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.075362,
                    "execution_time": 1.886315,
                    "compile_time": 0.000744,
                    "planning_time": 0.152555
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 7.308097,
                    "execution_time": 6.997726,
                    "compile_time": 0.000792,
                    "planning_time": 0.269029
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id         sales     returns       profit\n0     store channel         storeAAAAAAAAMHBAAAAA  1.104753e+08  2837849.98 -49911512.95\n1     store channel         storeAAAAAAAAHKCAAAAA  1.090882e+08  2728221.98 -48934073.44\n2     store channel         storeAAAAAAAADMBAAAAA  1.093360e+08  2681808.93 -48734980.34\n3     store channel         storeAAAAAAAAGDCAAAAA  1.076905e+08  2700512.42 -49006189.84\n4     store channel         storeAAAAAAAAPKDAAAAA  1.071633e+08  2794880.79 -48305969.12\n5   catalog channel  catalog_pageAAAAAAAAFCDAAAAA  3.589285e+07   195902.65  -3520852.60\n6   catalog channel  catalog_pageAAAAAAAACPCAAAAA  3.530103e+07   185259.08  -3838080.05\n7   catalog channel  catalog_pageAAAAAAAAOMCAAAAA  3.555729e+07   203844.22  -3322598.50\n8   catalog channel  catalog_pageAAAAAAAADMBAAAAA  7.153583e+07   589622.64  -7549514.02\n9   catalog channel  catalog_pageAAAAAAAADKHAAAAA  3.626743e+07     8161.28  -3532569.38\n10  catalog channel  catalog_pageAAAAAAAAPMHAAAAA  3.590986e+07      239.29  -2956121.21\n11  catalog channel  catalog_pageAAAAAAAALIBAAAAA  7.089724e+07   584918.84  -6914313.70\n12  catalog channel  catalog_pageAAAAAAAADCDAAAAA  3.561098e+07   158051.24  -3668703.06\n13  catalog channel  catalog_pageAAAAAAAAPJHAAAAA  3.493310e+07      989.64  -4100797.89\n14  catalog channel  catalog_pageAAAAAAAAKDIAAAAA  3.599760e+07      981.42  -3413976.22\n15  catalog channel  catalog_pageAAAAAAAALOHAAAAA  3.536355e+07     8338.67  -3740365.73\n16  catalog channel  catalog_pageAAAAAAAAHOCAAAAA  3.604311e+07   246119.84  -2967260.13\n17  catalog channel  catalog_pageAAAAAAAAMBDAAAAA  3.560285e+07   175691.33  -3883503.46\n18  catalog channel  catalog_pageAAAAAAAACLCAAAAA  3.665413e+07   157504.01  -3329317.29\n...*/"
    },
    {
        "input": "-- start template query5a.tpl query 98 in stream 0\nwith /* TPC-DS query5a.tpl 0.98 */ ssr as\n (select s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_sold_date_sk  as date_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from store_sales\n    union all\n    select sr_store_sk as store_sk,\n           sr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns\n   ) salesreturns,\n     date_dim,\n     store\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date) \n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and store_sk = s_store_sk\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_sold_date_sk  as date_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from catalog_sales\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns\n   ) salesreturns,\n     date_dim,\n     catalog_page\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_sold_date_sk  as date_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from web_sales\n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           wr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n   ) salesreturns,\n     date_dim,\n     web_site\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and wsr_web_site_sk = web_site_sk\n group by web_site_id)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from wsr\n ) final_results\n group by channel, id)\n select *\n from results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALESRETURNS\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 14 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-08-11' AS DATE ) ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"SALESRETURNS\".\"STORE_SK\" = \"STORE\".\"S_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"SALESRETURNS_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" UNION ALL SELECT \"CATALOG_RETURNS\".\"CR_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" AS \"RETURN_AMT\" , \"CATALOG_RETURNS\".\"CR_NET_LOSS\" AS \"NET_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CP_CATALOG_PAGE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_2\" AS \"SALESRETURNS\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"SALESRETURNS\".\"PAGE_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"SALESRETURNS_3\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"WEB_SALES\".\"WS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"WEB_RETURNS\".\"WR_RETURN_AMT\" AS \"RETURN_AMT\" , \"WEB_RETURNS\".\"WR_NET_LOSS\" AS \"NET_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" LEFT JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_3\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"SALESRETURNS\".\"WSR_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"FINAL_RESULTS\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"S_STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS\" AS \"RETURNS\" , \"SSR\".\"PROFIT\" - \"SSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CP_CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS\" AS \"RETURNS\" , \"CSR\".\"PROFIT\" - \"CSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS\" AS \"RETURNS\" , \"WSR\".\"PROFIT\" - \"WSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) , \"RESULTS\" AS ( SELECT \"FINAL_RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"FINAL_RESULTS\".\"ID\" AS \"ID\" , SUM ( \"FINAL_RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"FINAL_RESULTS\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"FINAL_RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"FINAL_RESULTS\" AS \"FINAL_RESULTS\" GROUP BY \"FINAL_RESULTS\".\"CHANNEL\" , \"FINAL_RESULTS\".\"ID\" ) SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT SS_STORE_SK AS STORE_SK , SS_SOLD_DATE_SK AS DATE_SK , SS_EXT_SALES_PRICE AS SALES_PRICE , SS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM STORE_SALES UNION ALL SELECT SR_STORE_SK AS STORE_SK , SR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , SR_RETURN_AMT AS RETURN_AMT , SR_NET_LOSS AS NET_LOSS FROM STORE_RETURNS ) AS SALESRETURNS , DATE_DIM , STORE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND STORE_SK = S_STORE_SK GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT CS_CATALOG_PAGE_SK AS PAGE_SK , CS_SOLD_DATE_SK AS DATE_SK , CS_EXT_SALES_PRICE AS SALES_PRICE , CS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM CATALOG_SALES UNION ALL SELECT CR_CATALOG_PAGE_SK AS PAGE_SK , CR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , CR_RETURN_AMOUNT AS RETURN_AMT , CR_NET_LOSS AS NET_LOSS FROM CATALOG_RETURNS ) AS SALESRETURNS , DATE_DIM , CATALOG_PAGE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND PAGE_SK = CP_CATALOG_PAGE_SK GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WS_SOLD_DATE_SK AS DATE_SK , WS_EXT_SALES_PRICE AS SALES_PRICE , WS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM WEB_SALES UNION ALL SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , WR_RETURN_AMT AS RETURN_AMT , WR_NET_LOSS AS NET_LOSS FROM WEB_RETURNS LEFT OUTER JOIN WEB_SALES ON ( WR_ITEM_SK = WS_ITEM_SK AND WR_ORDER_NUMBER = WS_ORDER_NUMBER ) ) AS SALESRETURNS , DATE_DIM , WEB_SITE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND WSR_WEB_SITE_SK = WEB_SITE_SK GROUP BY WEB_SITE_ID ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || S_STORE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CP_CATALOG_PAGE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web' || WEB_SITE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM WSR ) AS FINAL_RESULTS GROUP BY CHANNEL , ID ) SELECT * FROM RESULTS LIMIT 21",
                "preview": "\n/*            channel                            id         sales     returns       profit\n0     store channel         storeAAAAAAAAMKBAAAAA  1.108521e+08  2729315.00 -50124025.49\n1     store channel         storeAAAAAAAAMBDAAAAA  1.089528e+08  2823594.03 -48022210.40\n2     store channel         storeAAAAAAAAAMCAAAAA  1.102836e+08  2796285.30 -49589729.51\n3     store channel         storeAAAAAAAAIOBAAAAA  1.072798e+08  2674863.03 -47321050.70\n4     store channel         storeAAAAAAAAJNAAAAAA  1.065576e+08  2710104.95 -47604802.18\n5     store channel         storeAAAAAAAACCDAAAAA  1.102220e+08  2716551.65 -49539532.30\n6     store channel         storeAAAAAAAAGABAAAAA  1.069608e+08  2744343.58 -48117033.10\n7     store channel         storeAAAAAAAAEMDAAAAA  1.081839e+08  2553416.02 -47955095.97\n8     store channel         storeAAAAAAAAIFAAAAAA  1.092344e+08  2749722.45 -49074026.01\n9     store channel         storeAAAAAAAACLBAAAAA  1.067802e+08  2775899.43 -49069501.69\n10  catalog channel  catalog_pageAAAAAAAAJBCAAAAA  7.110759e+07   503053.47  -7697913.33\n11  catalog channel  catalog_pageAAAAAAAAIGBAAAAA  7.092886e+07   574991.51  -7478341.66\n12  catalog channel  catalog_pageAAAAAAAACGBAAAAA  7.124535e+07   489397.14  -8062294.50\n13  catalog channel  catalog_pageAAAAAAAAHEIAAAAA  3.537683e+07      927.72  -3560444.02\n14  catalog channel  catalog_pageAAAAAAAAIDIAAAAA  3.552803e+07     1975.84  -3310805.21\n15  catalog channel  catalog_pageAAAAAAAAJKBAAAAA  7.087486e+07   535535.82  -7715686.73\n16  catalog channel  catalog_pageAAAAAAAABBCAAAAA  7.132585e+07   479996.19  -7276779.84\n17  catalog channel  catalog_pageAAAAAAAAICIAAAAA  3.561253e+07     4076.64  -2903972.92\n18  catalog channel  catalog_pageAAAAAAAAPLCAAAAA  3.499834e+07   176281.76  -3410315.03\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.075243,
                    "execution_time": 1.874127,
                    "compile_time": 0.000759,
                    "planning_time": 0.163925
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 7.480492,
                    "execution_time": 7.168451,
                    "compile_time": 0.000775,
                    "planning_time": 0.274159
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id         sales     returns       profit\n0     store channel         storeAAAAAAAAMKBAAAAA  1.108521e+08  2729315.00 -50124025.49\n1     store channel         storeAAAAAAAAMBDAAAAA  1.089528e+08  2823594.03 -48022210.40\n2     store channel         storeAAAAAAAAAMCAAAAA  1.102836e+08  2796285.30 -49589729.51\n3     store channel         storeAAAAAAAAIOBAAAAA  1.072798e+08  2674863.03 -47321050.70\n4     store channel         storeAAAAAAAAJNAAAAAA  1.065576e+08  2710104.95 -47604802.18\n5     store channel         storeAAAAAAAACCDAAAAA  1.102220e+08  2716551.65 -49539532.30\n6     store channel         storeAAAAAAAAGABAAAAA  1.069608e+08  2744343.58 -48117033.10\n7     store channel         storeAAAAAAAAEMDAAAAA  1.081839e+08  2553416.02 -47955095.97\n8     store channel         storeAAAAAAAAIFAAAAAA  1.092344e+08  2749722.45 -49074026.01\n9     store channel         storeAAAAAAAACLBAAAAA  1.067802e+08  2775899.43 -49069501.69\n10  catalog channel  catalog_pageAAAAAAAAJBCAAAAA  7.110759e+07   503053.47  -7697913.33\n11  catalog channel  catalog_pageAAAAAAAAIGBAAAAA  7.092886e+07   574991.51  -7478341.66\n12  catalog channel  catalog_pageAAAAAAAACGBAAAAA  7.124535e+07   489397.14  -8062294.50\n13  catalog channel  catalog_pageAAAAAAAAHEIAAAAA  3.537683e+07      927.72  -3560444.02\n14  catalog channel  catalog_pageAAAAAAAAIDIAAAAA  3.552803e+07     1975.84  -3310805.21\n15  catalog channel  catalog_pageAAAAAAAAJKBAAAAA  7.087486e+07   535535.82  -7715686.73\n16  catalog channel  catalog_pageAAAAAAAABBCAAAAA  7.132585e+07   479996.19  -7276779.84\n17  catalog channel  catalog_pageAAAAAAAAICIAAAAA  3.561253e+07     4076.64  -2903972.92\n18  catalog channel  catalog_pageAAAAAAAAPLCAAAAA  3.499834e+07   176281.76  -3410315.03\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query5a.tpl query 98 in stream 0\nwith /* TPC-DS query5a.tpl 0.98 */ ssr as\n (select s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_sold_date_sk  as date_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from store_sales\n    union all\n    select sr_store_sk as store_sk,\n           sr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns\n   ) salesreturns,\n     date_dim,\n     store\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date) \n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and store_sk = s_store_sk\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_sold_date_sk  as date_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from catalog_sales\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns\n   ) salesreturns,\n     date_dim,\n     catalog_page\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_sold_date_sk  as date_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from web_sales\n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           wr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n   ) salesreturns,\n     date_dim,\n     web_site\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and wsr_web_site_sk = web_site_sk\n group by web_site_id)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from wsr\n ) final_results\n group by channel, id\n) \nselect * from results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALESRETURNS\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 14 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-08-11' AS DATE ) ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"SALESRETURNS\".\"STORE_SK\" = \"STORE\".\"S_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"SALESRETURNS_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" UNION ALL SELECT \"CATALOG_RETURNS\".\"CR_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" AS \"RETURN_AMT\" , \"CATALOG_RETURNS\".\"CR_NET_LOSS\" AS \"NET_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CP_CATALOG_PAGE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_2\" AS \"SALESRETURNS\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"SALESRETURNS\".\"PAGE_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"SALESRETURNS_3\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"WEB_SALES\".\"WS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"WEB_RETURNS\".\"WR_RETURN_AMT\" AS \"RETURN_AMT\" , \"WEB_RETURNS\".\"WR_NET_LOSS\" AS \"NET_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" LEFT JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_3\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"SALESRETURNS\".\"WSR_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"FINAL_RESULTS\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"S_STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS\" AS \"RETURNS\" , \"SSR\".\"PROFIT\" - \"SSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CP_CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS\" AS \"RETURNS\" , \"CSR\".\"PROFIT\" - \"CSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS\" AS \"RETURNS\" , \"WSR\".\"PROFIT\" - \"WSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) , \"RESULTS\" AS ( SELECT \"FINAL_RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"FINAL_RESULTS\".\"ID\" AS \"ID\" , SUM ( \"FINAL_RESULTS\".\"SALES\" ) AS \"SALES\" , SUM ( \"FINAL_RESULTS\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"FINAL_RESULTS\".\"PROFIT\" ) AS \"PROFIT\" FROM \"FINAL_RESULTS\" AS \"FINAL_RESULTS\" GROUP BY \"FINAL_RESULTS\".\"CHANNEL\" , \"FINAL_RESULTS\".\"ID\" ) SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT SS_STORE_SK AS STORE_SK , SS_SOLD_DATE_SK AS DATE_SK , SS_EXT_SALES_PRICE AS SALES_PRICE , SS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM STORE_SALES UNION ALL SELECT SR_STORE_SK AS STORE_SK , SR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , SR_RETURN_AMT AS RETURN_AMT , SR_NET_LOSS AS NET_LOSS FROM STORE_RETURNS ) AS SALESRETURNS , DATE_DIM , STORE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND STORE_SK = S_STORE_SK GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT CS_CATALOG_PAGE_SK AS PAGE_SK , CS_SOLD_DATE_SK AS DATE_SK , CS_EXT_SALES_PRICE AS SALES_PRICE , CS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM CATALOG_SALES UNION ALL SELECT CR_CATALOG_PAGE_SK AS PAGE_SK , CR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , CR_RETURN_AMOUNT AS RETURN_AMT , CR_NET_LOSS AS NET_LOSS FROM CATALOG_RETURNS ) AS SALESRETURNS , DATE_DIM , CATALOG_PAGE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND PAGE_SK = CP_CATALOG_PAGE_SK GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WS_SOLD_DATE_SK AS DATE_SK , WS_EXT_SALES_PRICE AS SALES_PRICE , WS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM WEB_SALES UNION ALL SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , WR_RETURN_AMT AS RETURN_AMT , WR_NET_LOSS AS NET_LOSS FROM WEB_RETURNS LEFT OUTER JOIN WEB_SALES ON ( WR_ITEM_SK = WS_ITEM_SK AND WR_ORDER_NUMBER = WS_ORDER_NUMBER ) ) AS SALESRETURNS , DATE_DIM , WEB_SITE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND WSR_WEB_SITE_SK = WEB_SITE_SK GROUP BY WEB_SITE_ID ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || S_STORE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CP_CATALOG_PAGE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM WSR ) AS FINAL_RESULTS GROUP BY CHANNEL , ID ) SELECT * FROM RESULTS LIMIT 21",
                "preview": "\n/*            channel                            id         sales     returns       profit\n0     store channel         storeAAAAAAAANJAAAAAA  1.073466e+08  2766437.27 -47592661.35\n1     store channel         storeAAAAAAAANECAAAAA  1.076930e+08  2811255.59 -48197511.26\n2     store channel         storeAAAAAAAAFODAAAAA  1.086414e+08  2922963.99 -48757012.11\n3     store channel         storeAAAAAAAABMAAAAAA  1.123702e+08  2659072.08 -49919298.84\n4     store channel         storeAAAAAAAAELCAAAAA  1.093689e+08  2818963.96 -48470544.54\n5     store channel         storeAAAAAAAANDAAAAAA  1.086147e+08  2690267.44 -48818874.89\n6     store channel         storeAAAAAAAAMFDAAAAA  1.104518e+08  2703550.09 -49337709.51\n7     store channel         storeAAAAAAAAKPBAAAAA  1.083937e+08  2553493.44 -48492397.94\n8     store channel         storeAAAAAAAALEBAAAAA  1.078443e+08  2663331.12 -48553422.84\n9     store channel         storeAAAAAAAAKMDAAAAA  1.078057e+08  2630718.77 -48330309.02\n10    store channel         storeAAAAAAAABHCAAAAA  1.100492e+08  2716941.75 -48367536.17\n11  catalog channel  catalog_pageAAAAAAAAFDBAAAAA  7.048443e+07   566880.70  -6998190.03\n12  catalog channel  catalog_pageAAAAAAAABCDAAAAA  3.565838e+07   127428.29  -3667042.41\n13  catalog channel  catalog_pageAAAAAAAAIMBAAAAA  7.106300e+07   590008.72  -7221797.86\n14  catalog channel  catalog_pageAAAAAAAAMOBAAAAA  7.045117e+07   649568.82  -7965600.55\n15  catalog channel  catalog_pageAAAAAAAACMCAAAAA  3.537271e+07   195136.99  -3242583.83\n16  catalog channel  catalog_pageAAAAAAAAFBDAAAAA  3.631782e+07   205649.69  -3450073.27\n17  catalog channel  catalog_pageAAAAAAAANNHAAAAA  3.548001e+07       45.86  -3419728.41\n18  catalog channel  catalog_pageAAAAAAAAJEBAAAAA  7.100734e+07   478544.50  -7523266.31\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.067297,
                    "execution_time": 1.877806,
                    "compile_time": 0.000768,
                    "planning_time": 0.152562
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 7.208177,
                    "execution_time": 6.906337,
                    "compile_time": 0.000747,
                    "planning_time": 0.264873
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id         sales     returns       profit\n0     store channel         storeAAAAAAAANJAAAAAA  1.073466e+08  2766437.27 -47592661.35\n1     store channel         storeAAAAAAAANECAAAAA  1.076930e+08  2811255.59 -48197511.26\n2     store channel         storeAAAAAAAAFODAAAAA  1.086414e+08  2922963.99 -48757012.11\n3     store channel         storeAAAAAAAABMAAAAAA  1.123702e+08  2659072.08 -49919298.84\n4     store channel         storeAAAAAAAAELCAAAAA  1.093689e+08  2818963.96 -48470544.54\n5     store channel         storeAAAAAAAANDAAAAAA  1.086147e+08  2690267.44 -48818874.89\n6     store channel         storeAAAAAAAAMFDAAAAA  1.104518e+08  2703550.09 -49337709.51\n7     store channel         storeAAAAAAAAKPBAAAAA  1.083937e+08  2553493.44 -48492397.94\n8     store channel         storeAAAAAAAALEBAAAAA  1.078443e+08  2663331.12 -48553422.84\n9     store channel         storeAAAAAAAAKMDAAAAA  1.078057e+08  2630718.77 -48330309.02\n10    store channel         storeAAAAAAAABHCAAAAA  1.100492e+08  2716941.75 -48367536.17\n11  catalog channel  catalog_pageAAAAAAAAFDBAAAAA  7.048443e+07   566880.70  -6998190.03\n12  catalog channel  catalog_pageAAAAAAAABCDAAAAA  3.565838e+07   127428.29  -3667042.41\n13  catalog channel  catalog_pageAAAAAAAAIMBAAAAA  7.106300e+07   590008.72  -7221797.86\n14  catalog channel  catalog_pageAAAAAAAAMOBAAAAA  7.045117e+07   649568.82  -7965600.55\n15  catalog channel  catalog_pageAAAAAAAACMCAAAAA  3.537271e+07   195136.99  -3242583.83\n16  catalog channel  catalog_pageAAAAAAAAFBDAAAAA  3.631782e+07   205649.69  -3450073.27\n17  catalog channel  catalog_pageAAAAAAAANNHAAAAA  3.548001e+07       45.86  -3419728.41\n18  catalog channel  catalog_pageAAAAAAAAJEBAAAAA  7.100734e+07   478544.50  -7523266.31\n...*/"
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": null,
        "optimize": null,
        "create": null,
        "query": null,
        "rewrite_main_query": null,
        "preview": null
    },
    {
        "input": "-- start template query5a.tpl query 98 in stream 0\nwith /* TPC-DS query5a.tpl 0.98 */ ssr as\n (select s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_sold_date_sk  as date_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from store_sales\n    union all\n    select sr_store_sk as store_sk,\n           sr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns\n   ) salesreturns,\n     date_dim,\n     store\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date) \n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and store_sk = s_store_sk\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_sold_date_sk  as date_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from catalog_sales\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns\n   ) salesreturns,\n     date_dim,\n     catalog_page\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_sold_date_sk  as date_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from web_sales\n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           wr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n   ) salesreturns,\n     date_dim,\n     web_site\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and wsr_web_site_sk = web_site_sk\n group by web_site_id)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr)\n group by channel, id\n )\n select * from results; \n /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALESRETURNS\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 14 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-08-11' AS DATE ) ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"SALESRETURNS\".\"STORE_SK\" = \"STORE\".\"S_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"SALESRETURNS_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" UNION ALL SELECT \"CATALOG_RETURNS\".\"CR_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" AS \"RETURN_AMT\" , \"CATALOG_RETURNS\".\"CR_NET_LOSS\" AS \"NET_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CP_CATALOG_PAGE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_2\" AS \"SALESRETURNS\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"SALESRETURNS\".\"PAGE_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"SALESRETURNS_3\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"WEB_SALES\".\"WS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"WEB_RETURNS\".\"WR_RETURN_AMT\" AS \"RETURN_AMT\" , \"WEB_RETURNS\".\"WR_NET_LOSS\" AS \"NET_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" LEFT JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_3\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"SALESRETURNS\".\"WSR_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"_Q_0\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"S_STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS\" AS \"RETURNS\" , \"SSR\".\"PROFIT\" - \"SSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CP_CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS\" AS \"RETURNS\" , \"CSR\".\"PROFIT\" - \"CSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS\" AS \"RETURNS\" , \"WSR\".\"PROFIT\" - \"WSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) , \"RESULTS\" AS ( SELECT \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"ID\" AS \"ID\" , SUM ( \"_Q_0\".\"SALES\" ) AS \"SALES\" , SUM ( \"_Q_0\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"_Q_0\".\"PROFIT\" ) AS \"PROFIT\" FROM \"_Q_0\" AS \"_Q_0\" GROUP BY \"_Q_0\".\"CHANNEL\" , \"_Q_0\".\"ID\" ) SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT SS_STORE_SK AS STORE_SK , SS_SOLD_DATE_SK AS DATE_SK , SS_EXT_SALES_PRICE AS SALES_PRICE , SS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM STORE_SALES UNION ALL SELECT SR_STORE_SK AS STORE_SK , SR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , SR_RETURN_AMT AS RETURN_AMT , SR_NET_LOSS AS NET_LOSS FROM STORE_RETURNS ) AS SALESRETURNS , DATE_DIM , STORE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND STORE_SK = S_STORE_SK GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT CS_CATALOG_PAGE_SK AS PAGE_SK , CS_SOLD_DATE_SK AS DATE_SK , CS_EXT_SALES_PRICE AS SALES_PRICE , CS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM CATALOG_SALES UNION ALL SELECT CR_CATALOG_PAGE_SK AS PAGE_SK , CR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , CR_RETURN_AMOUNT AS RETURN_AMT , CR_NET_LOSS AS NET_LOSS FROM CATALOG_RETURNS ) AS SALESRETURNS , DATE_DIM , CATALOG_PAGE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND PAGE_SK = CP_CATALOG_PAGE_SK GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WS_SOLD_DATE_SK AS DATE_SK , WS_EXT_SALES_PRICE AS SALES_PRICE , WS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM WEB_SALES UNION ALL SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , WR_RETURN_AMT AS RETURN_AMT , WR_NET_LOSS AS NET_LOSS FROM WEB_RETURNS LEFT OUTER JOIN WEB_SALES ON ( WR_ITEM_SK = WS_ITEM_SK AND WR_ORDER_NUMBER = WS_ORDER_NUMBER ) ) AS SALESRETURNS , DATE_DIM , WEB_SITE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND WSR_WEB_SITE_SK = WEB_SITE_SK GROUP BY WEB_SITE_ID ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || S_STORE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CP_CATALOG_PAGE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM WSR ) GROUP BY CHANNEL , ID ) SELECT * FROM RESULTS LIMIT 21",
                "preview": "\n/*            channel                            id         sales     returns       profit\n0     store channel         storeAAAAAAAAJBAAAAAA  1.102087e+08  2752853.77 -48973940.20\n1     store channel         storeAAAAAAAAONCAAAAA  1.090882e+08  2717144.82 -49945730.30\n2     store channel         storeAAAAAAAAHJAAAAAA  1.089407e+08  2497884.07 -48037627.95\n3     store channel         storeAAAAAAAAMJBAAAAA  1.113164e+08  2721801.43 -50298254.38\n4     store channel         storeAAAAAAAACDDAAAAA  1.086889e+08  2727555.39 -47622226.55\n5     store channel         storeAAAAAAAAIHBAAAAA  1.091958e+08  2585331.86 -48945616.84\n6   catalog channel  catalog_pageAAAAAAAAGLBAAAAA  7.212324e+07   618253.97  -6996437.86\n7   catalog channel  catalog_pageAAAAAAAALCIAAAAA  3.603101e+07     3025.50  -3350829.68\n8   catalog channel  catalog_pageAAAAAAAAIIBAAAAA  7.133409e+07   548705.89  -7432536.83\n9   catalog channel  catalog_pageAAAAAAAAMMHAAAAA  3.583911e+07      140.22  -3203524.85\n10  catalog channel  catalog_pageAAAAAAAAIHIAAAAA  3.504343e+07     2202.48  -3408427.44\n11  catalog channel  catalog_pageAAAAAAAAOHCAAAAA  3.520201e+07   197801.76  -3673561.39\n12  catalog channel  catalog_pageAAAAAAAAKBBAAAAA  7.171047e+07   540458.32  -6974294.75\n13  catalog channel  catalog_pageAAAAAAAAOJIAAAAA  3.539679e+07       77.55  -3526164.02\n14  catalog channel  catalog_pageAAAAAAAANAIAAAAA  3.527822e+07     5255.70  -4012631.97\n15  catalog channel  catalog_pageAAAAAAAAFACAAAAA  7.284707e+07   561443.05  -7018714.92\n16  catalog channel  catalog_pageAAAAAAAAEBDAAAAA  3.462513e+07   203581.64  -3897921.40\n17  catalog channel  catalog_pageAAAAAAAACJDAAAAA  0.000000e+00   145398.70    -75255.32\n18  catalog channel  catalog_pageAAAAAAAADNAAAAAA  0.000000e+00  1801316.30  -1101367.79\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.081182,
                    "execution_time": 1.891301,
                    "compile_time": 0.000745,
                    "planning_time": 0.153102
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 7.346673,
                    "execution_time": 7.046736,
                    "compile_time": 0.000738,
                    "planning_time": 0.262762
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id         sales     returns       profit\n0     store channel         storeAAAAAAAAJBAAAAAA  1.102087e+08  2752853.77 -48973940.20\n1     store channel         storeAAAAAAAAONCAAAAA  1.090882e+08  2717144.82 -49945730.30\n2     store channel         storeAAAAAAAAHJAAAAAA  1.089407e+08  2497884.07 -48037627.95\n3     store channel         storeAAAAAAAAMJBAAAAA  1.113164e+08  2721801.43 -50298254.38\n4     store channel         storeAAAAAAAACDDAAAAA  1.086889e+08  2727555.39 -47622226.55\n5     store channel         storeAAAAAAAAIHBAAAAA  1.091958e+08  2585331.86 -48945616.84\n6   catalog channel  catalog_pageAAAAAAAAGLBAAAAA  7.212324e+07   618253.97  -6996437.86\n7   catalog channel  catalog_pageAAAAAAAALCIAAAAA  3.603101e+07     3025.50  -3350829.68\n8   catalog channel  catalog_pageAAAAAAAAIIBAAAAA  7.133409e+07   548705.89  -7432536.83\n9   catalog channel  catalog_pageAAAAAAAAMMHAAAAA  3.583911e+07      140.22  -3203524.85\n10  catalog channel  catalog_pageAAAAAAAAIHIAAAAA  3.504343e+07     2202.48  -3408427.44\n11  catalog channel  catalog_pageAAAAAAAAOHCAAAAA  3.520201e+07   197801.76  -3673561.39\n12  catalog channel  catalog_pageAAAAAAAAKBBAAAAA  7.171047e+07   540458.32  -6974294.75\n13  catalog channel  catalog_pageAAAAAAAAOJIAAAAA  3.539679e+07       77.55  -3526164.02\n14  catalog channel  catalog_pageAAAAAAAANAIAAAAA  3.527822e+07     5255.70  -4012631.97\n15  catalog channel  catalog_pageAAAAAAAAFACAAAAA  7.284707e+07   561443.05  -7018714.92\n16  catalog channel  catalog_pageAAAAAAAAEBDAAAAA  3.462513e+07   203581.64  -3897921.40\n17  catalog channel  catalog_pageAAAAAAAACJDAAAAA  0.000000e+00   145398.70    -75255.32\n18  catalog channel  catalog_pageAAAAAAAADNAAAAAA  0.000000e+00  1801316.30  -1101367.79\n...*/"
    },
    {
        "input": "-- start template query5a.tpl query 98 in stream 0\nwith /* TPC-DS query5a.tpl 0.98 */ ssr as\n (select s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_sold_date_sk  as date_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from store_sales\n    union all\n    select sr_store_sk as store_sk,\n           sr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns\n   ) salesreturns,\n     date_dim,\n     store\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date) \n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and store_sk = s_store_sk\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_sold_date_sk  as date_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from catalog_sales\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns\n   ) salesreturns,\n     date_dim,\n     catalog_page\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_sold_date_sk  as date_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from web_sales\n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           wr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n   ) salesreturns,\n     date_dim,\n     web_site\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and wsr_web_site_sk = web_site_sk\n group by web_site_id)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\n group by channel, id\n )\nselect * from results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALESRETURNS\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 14 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-08-11' AS DATE ) ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"SALESRETURNS\".\"STORE_SK\" = \"STORE\".\"S_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"SALESRETURNS_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" UNION ALL SELECT \"CATALOG_RETURNS\".\"CR_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" AS \"RETURN_AMT\" , \"CATALOG_RETURNS\".\"CR_NET_LOSS\" AS \"NET_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CP_CATALOG_PAGE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_2\" AS \"SALESRETURNS\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"SALESRETURNS\".\"PAGE_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"SALESRETURNS_3\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"WEB_SALES\".\"WS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"WEB_RETURNS\".\"WR_RETURN_AMT\" AS \"RETURN_AMT\" , \"WEB_RETURNS\".\"WR_NET_LOSS\" AS \"NET_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" LEFT JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_3\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"SALESRETURNS\".\"WSR_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"S_STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS\" AS \"RETURNS\" , \"SSR\".\"PROFIT\" - \"SSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CP_CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS\" AS \"RETURNS\" , \"CSR\".\"PROFIT\" - \"CSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS\" AS \"RETURNS\" , \"WSR\".\"PROFIT\" - \"WSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) , \"RESULTS\" AS ( SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\" ) SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT SS_STORE_SK AS STORE_SK , SS_SOLD_DATE_SK AS DATE_SK , SS_EXT_SALES_PRICE AS SALES_PRICE , SS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM STORE_SALES UNION ALL SELECT SR_STORE_SK AS STORE_SK , SR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , SR_RETURN_AMT AS RETURN_AMT , SR_NET_LOSS AS NET_LOSS FROM STORE_RETURNS ) AS SALESRETURNS , DATE_DIM , STORE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND STORE_SK = S_STORE_SK GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT CS_CATALOG_PAGE_SK AS PAGE_SK , CS_SOLD_DATE_SK AS DATE_SK , CS_EXT_SALES_PRICE AS SALES_PRICE , CS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM CATALOG_SALES UNION ALL SELECT CR_CATALOG_PAGE_SK AS PAGE_SK , CR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , CR_RETURN_AMOUNT AS RETURN_AMT , CR_NET_LOSS AS NET_LOSS FROM CATALOG_RETURNS ) AS SALESRETURNS , DATE_DIM , CATALOG_PAGE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND PAGE_SK = CP_CATALOG_PAGE_SK GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WS_SOLD_DATE_SK AS DATE_SK , WS_EXT_SALES_PRICE AS SALES_PRICE , WS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM WEB_SALES UNION ALL SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , WR_RETURN_AMT AS RETURN_AMT , WR_NET_LOSS AS NET_LOSS FROM WEB_RETURNS LEFT OUTER JOIN WEB_SALES ON ( WR_ITEM_SK = WS_ITEM_SK AND WR_ORDER_NUMBER = WS_ORDER_NUMBER ) ) AS SALESRETURNS , DATE_DIM , WEB_SITE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND WSR_WEB_SITE_SK = WEB_SITE_SK GROUP BY WEB_SITE_ID ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || S_STORE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CP_CATALOG_PAGE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM WSR ) AS X GROUP BY CHANNEL , ID ) SELECT * FROM RESULTS LIMIT 21",
                "preview": "\n/*            channel                            id         sales     returns       profit\n0     store channel         storeAAAAAAAACLBAAAAA  1.067802e+08  2775899.43 -49069501.69\n1     store channel         storeAAAAAAAAGABAAAAA  1.069608e+08  2744343.58 -48117033.10\n2     store channel         storeAAAAAAAAIFAAAAAA  1.092344e+08  2749722.45 -49074026.01\n3     store channel         storeAAAAAAAACCDAAAAA  1.102220e+08  2716551.65 -49539532.30\n4     store channel         storeAAAAAAAAIOBAAAAA  1.072798e+08  2674863.03 -47321050.70\n5     store channel         storeAAAAAAAAMBDAAAAA  1.089528e+08  2823594.03 -48022210.40\n6     store channel         storeAAAAAAAAAMCAAAAA  1.102836e+08  2796285.30 -49589729.51\n7     store channel         storeAAAAAAAAMKBAAAAA  1.108521e+08  2729315.00 -50124025.49\n8     store channel         storeAAAAAAAAJNAAAAAA  1.065576e+08  2710104.95 -47604802.18\n9     store channel         storeAAAAAAAAEMDAAAAA  1.081839e+08  2553416.02 -47955095.97\n10  catalog channel  catalog_pageAAAAAAAAJBCAAAAA  7.110759e+07   503053.47  -7697913.33\n11  catalog channel  catalog_pageAAAAAAAAIGBAAAAA  7.092886e+07   574991.51  -7478341.66\n12  catalog channel  catalog_pageAAAAAAAACGBAAAAA  7.124535e+07   489397.14  -8062294.50\n13  catalog channel  catalog_pageAAAAAAAAHEIAAAAA  3.537683e+07      927.72  -3560444.02\n14  catalog channel  catalog_pageAAAAAAAAIDIAAAAA  3.552803e+07     1975.84  -3310805.21\n15  catalog channel  catalog_pageAAAAAAAAJKBAAAAA  7.087486e+07   535535.82  -7715686.73\n16  catalog channel  catalog_pageAAAAAAAABBCAAAAA  7.132585e+07   479996.19  -7276779.84\n17  catalog channel  catalog_pageAAAAAAAAICIAAAAA  3.561253e+07     4076.64  -2903972.92\n18  catalog channel  catalog_pageAAAAAAAAPLCAAAAA  3.499834e+07   176281.76  -3410315.03\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.077028,
                    "execution_time": 1.88806,
                    "compile_time": 0.000743,
                    "planning_time": 0.152547
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 7.377477,
                    "execution_time": 7.077926,
                    "compile_time": 0.000735,
                    "planning_time": 0.26321
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id         sales     returns       profit\n0     store channel         storeAAAAAAAACLBAAAAA  1.067802e+08  2775899.43 -49069501.69\n1     store channel         storeAAAAAAAAGABAAAAA  1.069608e+08  2744343.58 -48117033.10\n2     store channel         storeAAAAAAAAIFAAAAAA  1.092344e+08  2749722.45 -49074026.01\n3     store channel         storeAAAAAAAACCDAAAAA  1.102220e+08  2716551.65 -49539532.30\n4     store channel         storeAAAAAAAAIOBAAAAA  1.072798e+08  2674863.03 -47321050.70\n5     store channel         storeAAAAAAAAMBDAAAAA  1.089528e+08  2823594.03 -48022210.40\n6     store channel         storeAAAAAAAAAMCAAAAA  1.102836e+08  2796285.30 -49589729.51\n7     store channel         storeAAAAAAAAMKBAAAAA  1.108521e+08  2729315.00 -50124025.49\n8     store channel         storeAAAAAAAAJNAAAAAA  1.065576e+08  2710104.95 -47604802.18\n9     store channel         storeAAAAAAAAEMDAAAAA  1.081839e+08  2553416.02 -47955095.97\n10  catalog channel  catalog_pageAAAAAAAAJBCAAAAA  7.110759e+07   503053.47  -7697913.33\n11  catalog channel  catalog_pageAAAAAAAAIGBAAAAA  7.092886e+07   574991.51  -7478341.66\n12  catalog channel  catalog_pageAAAAAAAACGBAAAAA  7.124535e+07   489397.14  -8062294.50\n13  catalog channel  catalog_pageAAAAAAAAHEIAAAAA  3.537683e+07      927.72  -3560444.02\n14  catalog channel  catalog_pageAAAAAAAAIDIAAAAA  3.552803e+07     1975.84  -3310805.21\n15  catalog channel  catalog_pageAAAAAAAAJKBAAAAA  7.087486e+07   535535.82  -7715686.73\n16  catalog channel  catalog_pageAAAAAAAABBCAAAAA  7.132585e+07   479996.19  -7276779.84\n17  catalog channel  catalog_pageAAAAAAAAICIAAAAA  3.561253e+07     4076.64  -2903972.92\n18  catalog channel  catalog_pageAAAAAAAAPLCAAAAA  3.499834e+07   176281.76  -3410315.03\n...*/"
    },
    {
        "input": "-- start template query5a.tpl query 98 in stream 0\nwith /* TPC-DS query5a.tpl 0.98 */ ssr as\n (select s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_sold_date_sk  as date_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from store_sales\n    union all\n    select sr_store_sk as store_sk,\n           sr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns\n   ) salesreturns,\n     date_dim,\n     store\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date) \n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and store_sk = s_store_sk\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_sold_date_sk  as date_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from catalog_sales\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns\n   ) salesreturns,\n     date_dim,\n     catalog_page\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_sold_date_sk  as date_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from web_sales\n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           wr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n   ) salesreturns,\n     date_dim,\n     web_site\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and wsr_web_site_sk = web_site_sk\n group by web_site_id)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\n group by channel, id)\nSELECT * FROM results /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALESRETURNS\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 14 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-08-11' AS DATE ) ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"SALESRETURNS\".\"STORE_SK\" = \"STORE\".\"S_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"SALESRETURNS_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" UNION ALL SELECT \"CATALOG_RETURNS\".\"CR_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" AS \"RETURN_AMT\" , \"CATALOG_RETURNS\".\"CR_NET_LOSS\" AS \"NET_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CP_CATALOG_PAGE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_2\" AS \"SALESRETURNS\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"SALESRETURNS\".\"PAGE_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"SALESRETURNS_3\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"WEB_SALES\".\"WS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"WEB_RETURNS\".\"WR_RETURN_AMT\" AS \"RETURN_AMT\" , \"WEB_RETURNS\".\"WR_NET_LOSS\" AS \"NET_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" LEFT JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_3\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"SALESRETURNS\".\"WSR_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"S_STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS\" AS \"RETURNS\" , \"SSR\".\"PROFIT\" - \"SSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CP_CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS\" AS \"RETURNS\" , \"CSR\".\"PROFIT\" - \"CSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS\" AS \"RETURNS\" , \"WSR\".\"PROFIT\" - \"WSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) , \"RESULTS\" AS ( SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\" ) SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT SS_STORE_SK AS STORE_SK , SS_SOLD_DATE_SK AS DATE_SK , SS_EXT_SALES_PRICE AS SALES_PRICE , SS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM STORE_SALES UNION ALL SELECT SR_STORE_SK AS STORE_SK , SR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , SR_RETURN_AMT AS RETURN_AMT , SR_NET_LOSS AS NET_LOSS FROM STORE_RETURNS ) AS SALESRETURNS , DATE_DIM , STORE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND STORE_SK = S_STORE_SK GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT CS_CATALOG_PAGE_SK AS PAGE_SK , CS_SOLD_DATE_SK AS DATE_SK , CS_EXT_SALES_PRICE AS SALES_PRICE , CS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM CATALOG_SALES UNION ALL SELECT CR_CATALOG_PAGE_SK AS PAGE_SK , CR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , CR_RETURN_AMOUNT AS RETURN_AMT , CR_NET_LOSS AS NET_LOSS FROM CATALOG_RETURNS ) AS SALESRETURNS , DATE_DIM , CATALOG_PAGE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND PAGE_SK = CP_CATALOG_PAGE_SK GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WS_SOLD_DATE_SK AS DATE_SK , WS_EXT_SALES_PRICE AS SALES_PRICE , WS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM WEB_SALES UNION ALL SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , WR_RETURN_AMT AS RETURN_AMT , WR_NET_LOSS AS NET_LOSS FROM WEB_RETURNS LEFT OUTER JOIN WEB_SALES ON ( WR_ITEM_SK = WS_ITEM_SK AND WR_ORDER_NUMBER = WS_ORDER_NUMBER ) ) AS SALESRETURNS , DATE_DIM , WEB_SITE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND WSR_WEB_SITE_SK = WEB_SITE_SK GROUP BY WEB_SITE_ID ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || S_STORE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CP_CATALOG_PAGE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM WSR ) AS X GROUP BY CHANNEL , ID ) SELECT * FROM RESULTS LIMIT 21",
                "preview": "\n/*            channel                            id         sales     returns       profit\n0     store channel         storeAAAAAAAALOAAAAAA  1.109875e+08  2643977.69 -49705896.14\n1     store channel         storeAAAAAAAAMDCAAAAA  1.078800e+08  2622309.73 -48606100.23\n2     store channel         storeAAAAAAAAIIBAAAAA  1.107126e+08  2893937.73 -49268061.66\n3     store channel         storeAAAAAAAADLCAAAAA  1.085645e+08  2790327.63 -49051376.29\n4     store channel         storeAAAAAAAAGEBAAAAA  1.077680e+08  2751223.27 -49206684.75\n5     store channel         storeAAAAAAAAGOCAAAAA  1.080356e+08  2662973.81 -48832543.17\n6   catalog channel  catalog_pageAAAAAAAALMCAAAAA  3.572828e+07   205928.49  -3221824.22\n7   catalog channel  catalog_pageAAAAAAAAFMBAAAAA  7.220366e+07   568673.79  -7522804.92\n8   catalog channel  catalog_pageAAAAAAAAFLBAAAAA  7.141099e+07   486186.31  -6810998.98\n9   catalog channel  catalog_pageAAAAAAAAMCCAAAAA  3.604540e+07   152979.17  -3229586.54\n10  catalog channel  catalog_pageAAAAAAAADOCAAAAA  3.504283e+07   176170.60  -3962240.37\n11  catalog channel  catalog_pageAAAAAAAALNHAAAAA  3.611224e+07      374.65  -3019400.44\n12  catalog channel  catalog_pageAAAAAAAAJPCAAAAA  3.594037e+07   157114.88  -3818772.49\n13  catalog channel  catalog_pageAAAAAAAAGDBAAAAA  7.198372e+07   543173.91  -8016154.82\n14  catalog channel  catalog_pageAAAAAAAAEDDAAAAA  3.599661e+07   141367.48  -3542018.98\n15  catalog channel  catalog_pageAAAAAAAAGOCAAAAA  3.535701e+07   192090.24  -3395454.68\n16  catalog channel  catalog_pageAAAAAAAACDIAAAAA  3.481769e+07     1720.42  -3887203.52\n17  catalog channel  catalog_pageAAAAAAAAFDCAAAAA  3.596111e+07   150727.17  -3686144.46\n18  catalog channel  catalog_pageAAAAAAAAAIBAAAAA  7.049346e+07   511914.15  -8102687.84\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.084334,
                    "execution_time": 1.896124,
                    "compile_time": 0.000748,
                    "planning_time": 0.152037
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 7.069709,
                    "execution_time": 6.878076,
                    "compile_time": 0.000758,
                    "planning_time": 0.154841
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id         sales     returns       profit\n0     store channel         storeAAAAAAAALOAAAAAA  1.109875e+08  2643977.69 -49705896.14\n1     store channel         storeAAAAAAAAMDCAAAAA  1.078800e+08  2622309.73 -48606100.23\n2     store channel         storeAAAAAAAAIIBAAAAA  1.107126e+08  2893937.73 -49268061.66\n3     store channel         storeAAAAAAAADLCAAAAA  1.085645e+08  2790327.63 -49051376.29\n4     store channel         storeAAAAAAAAGEBAAAAA  1.077680e+08  2751223.27 -49206684.75\n5     store channel         storeAAAAAAAAGOCAAAAA  1.080356e+08  2662973.81 -48832543.17\n6   catalog channel  catalog_pageAAAAAAAALMCAAAAA  3.572828e+07   205928.49  -3221824.22\n7   catalog channel  catalog_pageAAAAAAAAFMBAAAAA  7.220366e+07   568673.79  -7522804.92\n8   catalog channel  catalog_pageAAAAAAAAFLBAAAAA  7.141099e+07   486186.31  -6810998.98\n9   catalog channel  catalog_pageAAAAAAAAMCCAAAAA  3.604540e+07   152979.17  -3229586.54\n10  catalog channel  catalog_pageAAAAAAAADOCAAAAA  3.504283e+07   176170.60  -3962240.37\n11  catalog channel  catalog_pageAAAAAAAALNHAAAAA  3.611224e+07      374.65  -3019400.44\n12  catalog channel  catalog_pageAAAAAAAAJPCAAAAA  3.594037e+07   157114.88  -3818772.49\n13  catalog channel  catalog_pageAAAAAAAAGDBAAAAA  7.198372e+07   543173.91  -8016154.82\n14  catalog channel  catalog_pageAAAAAAAAEDDAAAAA  3.599661e+07   141367.48  -3542018.98\n15  catalog channel  catalog_pageAAAAAAAAGOCAAAAA  3.535701e+07   192090.24  -3395454.68\n16  catalog channel  catalog_pageAAAAAAAACDIAAAAA  3.481769e+07     1720.42  -3887203.52\n17  catalog channel  catalog_pageAAAAAAAAFDCAAAAA  3.596111e+07   150727.17  -3686144.46\n18  catalog channel  catalog_pageAAAAAAAAAIBAAAAA  7.049346e+07   511914.15  -8102687.84\n...*/"
    },
    {
        "input": "-- start template query5a.tpl query 98 in stream 0\nwith /* TPC-DS query5a.tpl 0.98 */ ssr as\n (select s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_sold_date_sk  as date_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from store_sales\n    union all\n    select sr_store_sk as store_sk,\n           sr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns\n   ) salesreturns,\n     date_dim,\n     store\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date) \n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and store_sk = s_store_sk\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_sold_date_sk  as date_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from catalog_sales\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns\n   ) salesreturns,\n     date_dim,\n     catalog_page\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_sold_date_sk  as date_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from web_sales\n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           wr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n   ) salesreturns,\n     date_dim,\n     web_site\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and wsr_web_site_sk = web_site_sk\n group by web_site_id)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\n group by channel, id)\n select  channel, id, sales, returns, profit from results \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALESRETURNS\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 14 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-08-11' AS DATE ) ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"SALESRETURNS\".\"STORE_SK\" = \"STORE\".\"S_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"SALESRETURNS_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" UNION ALL SELECT \"CATALOG_RETURNS\".\"CR_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" AS \"RETURN_AMT\" , \"CATALOG_RETURNS\".\"CR_NET_LOSS\" AS \"NET_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CP_CATALOG_PAGE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_2\" AS \"SALESRETURNS\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"SALESRETURNS\".\"PAGE_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"SALESRETURNS_3\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"WEB_SALES\".\"WS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"WEB_RETURNS\".\"WR_RETURN_AMT\" AS \"RETURN_AMT\" , \"WEB_RETURNS\".\"WR_NET_LOSS\" AS \"NET_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" LEFT JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_3\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"SALESRETURNS\".\"WSR_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"S_STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS\" AS \"RETURNS\" , \"SSR\".\"PROFIT\" - \"SSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CP_CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS\" AS \"RETURNS\" , \"CSR\".\"PROFIT\" - \"CSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS\" AS \"RETURNS\" , \"WSR\".\"PROFIT\" - \"WSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) , \"RESULTS\" AS ( SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\" ) SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT SS_STORE_SK AS STORE_SK , SS_SOLD_DATE_SK AS DATE_SK , SS_EXT_SALES_PRICE AS SALES_PRICE , SS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM STORE_SALES UNION ALL SELECT SR_STORE_SK AS STORE_SK , SR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , SR_RETURN_AMT AS RETURN_AMT , SR_NET_LOSS AS NET_LOSS FROM STORE_RETURNS ) AS SALESRETURNS , DATE_DIM , STORE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND STORE_SK = S_STORE_SK GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT CS_CATALOG_PAGE_SK AS PAGE_SK , CS_SOLD_DATE_SK AS DATE_SK , CS_EXT_SALES_PRICE AS SALES_PRICE , CS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM CATALOG_SALES UNION ALL SELECT CR_CATALOG_PAGE_SK AS PAGE_SK , CR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , CR_RETURN_AMOUNT AS RETURN_AMT , CR_NET_LOSS AS NET_LOSS FROM CATALOG_RETURNS ) AS SALESRETURNS , DATE_DIM , CATALOG_PAGE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND PAGE_SK = CP_CATALOG_PAGE_SK GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WS_SOLD_DATE_SK AS DATE_SK , WS_EXT_SALES_PRICE AS SALES_PRICE , WS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM WEB_SALES UNION ALL SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , WR_RETURN_AMT AS RETURN_AMT , WR_NET_LOSS AS NET_LOSS FROM WEB_RETURNS LEFT OUTER JOIN WEB_SALES ON ( WR_ITEM_SK = WS_ITEM_SK AND WR_ORDER_NUMBER = WS_ORDER_NUMBER ) ) AS SALESRETURNS , DATE_DIM , WEB_SITE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND WSR_WEB_SITE_SK = WEB_SITE_SK GROUP BY WEB_SITE_ID ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || S_STORE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CP_CATALOG_PAGE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM WSR ) AS X GROUP BY CHANNEL , ID ) SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM RESULTS LIMIT 21",
                "preview": "\n/*            channel                            id         sales     returns       profit\n0     store channel         storeAAAAAAAABMAAAAAA  1.123702e+08  2659072.08 -49919298.84\n1     store channel         storeAAAAAAAAFODAAAAA  1.086414e+08  2922963.99 -48757012.11\n2     store channel         storeAAAAAAAANJAAAAAA  1.073466e+08  2766437.27 -47592661.35\n3     store channel         storeAAAAAAAAELCAAAAA  1.093689e+08  2818963.96 -48470544.54\n4     store channel         storeAAAAAAAALEBAAAAA  1.078443e+08  2663331.12 -48553422.84\n5     store channel         storeAAAAAAAAKPBAAAAA  1.083937e+08  2553493.44 -48492397.94\n6     store channel         storeAAAAAAAAKMDAAAAA  1.078057e+08  2630718.77 -48330309.02\n7     store channel         storeAAAAAAAANDAAAAAA  1.086147e+08  2690267.44 -48818874.89\n8     store channel         storeAAAAAAAABHCAAAAA  1.100492e+08  2716941.75 -48367536.17\n9     store channel         storeAAAAAAAANECAAAAA  1.076930e+08  2811255.59 -48197511.26\n10    store channel         storeAAAAAAAAMFDAAAAA  1.104518e+08  2703550.09 -49337709.51\n11  catalog channel  catalog_pageAAAAAAAAFDBAAAAA  7.048443e+07   566880.70  -6998190.03\n12  catalog channel  catalog_pageAAAAAAAABCDAAAAA  3.565838e+07   127428.29  -3667042.41\n13  catalog channel  catalog_pageAAAAAAAAIMBAAAAA  7.106300e+07   590008.72  -7221797.86\n14  catalog channel  catalog_pageAAAAAAAAMOBAAAAA  7.045117e+07   649568.82  -7965600.55\n15  catalog channel  catalog_pageAAAAAAAACMCAAAAA  3.537271e+07   195136.99  -3242583.83\n16  catalog channel  catalog_pageAAAAAAAAFBDAAAAA  3.631782e+07   205649.69  -3450073.27\n17  catalog channel  catalog_pageAAAAAAAANNHAAAAA  3.548001e+07       45.86  -3419728.41\n18  catalog channel  catalog_pageAAAAAAAAJEBAAAAA  7.100734e+07   478544.50  -7523266.31\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.067281,
                    "execution_time": 1.877693,
                    "compile_time": 0.000748,
                    "planning_time": 0.153274
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 7.170752,
                    "execution_time": 6.8688,
                    "compile_time": 0.000758,
                    "planning_time": 0.264851
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id         sales     returns       profit\n0     store channel         storeAAAAAAAABMAAAAAA  1.123702e+08  2659072.08 -49919298.84\n1     store channel         storeAAAAAAAAFODAAAAA  1.086414e+08  2922963.99 -48757012.11\n2     store channel         storeAAAAAAAANJAAAAAA  1.073466e+08  2766437.27 -47592661.35\n3     store channel         storeAAAAAAAAELCAAAAA  1.093689e+08  2818963.96 -48470544.54\n4     store channel         storeAAAAAAAALEBAAAAA  1.078443e+08  2663331.12 -48553422.84\n5     store channel         storeAAAAAAAAKPBAAAAA  1.083937e+08  2553493.44 -48492397.94\n6     store channel         storeAAAAAAAAKMDAAAAA  1.078057e+08  2630718.77 -48330309.02\n7     store channel         storeAAAAAAAANDAAAAAA  1.086147e+08  2690267.44 -48818874.89\n8     store channel         storeAAAAAAAABHCAAAAA  1.100492e+08  2716941.75 -48367536.17\n9     store channel         storeAAAAAAAANECAAAAA  1.076930e+08  2811255.59 -48197511.26\n10    store channel         storeAAAAAAAAMFDAAAAA  1.104518e+08  2703550.09 -49337709.51\n11  catalog channel  catalog_pageAAAAAAAAFDBAAAAA  7.048443e+07   566880.70  -6998190.03\n12  catalog channel  catalog_pageAAAAAAAABCDAAAAA  3.565838e+07   127428.29  -3667042.41\n13  catalog channel  catalog_pageAAAAAAAAIMBAAAAA  7.106300e+07   590008.72  -7221797.86\n14  catalog channel  catalog_pageAAAAAAAAMOBAAAAA  7.045117e+07   649568.82  -7965600.55\n15  catalog channel  catalog_pageAAAAAAAACMCAAAAA  3.537271e+07   195136.99  -3242583.83\n16  catalog channel  catalog_pageAAAAAAAAFBDAAAAA  3.631782e+07   205649.69  -3450073.27\n17  catalog channel  catalog_pageAAAAAAAANNHAAAAA  3.548001e+07       45.86  -3419728.41\n18  catalog channel  catalog_pageAAAAAAAAJEBAAAAA  7.100734e+07   478544.50  -7523266.31\n...*/"
    },
    {
        "input": "-- start template query5a.tpl query 98 in stream 0\nwith /* TPC-DS query5a.tpl 0.98 */ ssr as\n (select s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_sold_date_sk  as date_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from store_sales\n    union all\n    select sr_store_sk as store_sk,\n           sr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns\n   ) salesreturns,\n     date_dim,\n     store\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date) \n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and store_sk = s_store_sk\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_sold_date_sk  as date_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from catalog_sales\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns\n   ) salesreturns,\n     date_dim,\n     catalog_page\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_sold_date_sk  as date_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from web_sales\n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           wr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n   ) salesreturns,\n     date_dim,\n     web_site\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and wsr_web_site_sk = web_site_sk\n group by web_site_id)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\n group by channel, id)\n select  channel, id, sales, returns, profit from ( \n  select channel, id, sales, returns, profit from results)\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALESRETURNS\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 14 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-08-11' AS DATE ) ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"SALESRETURNS\".\"STORE_SK\" = \"STORE\".\"S_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"SALESRETURNS_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" UNION ALL SELECT \"CATALOG_RETURNS\".\"CR_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" AS \"RETURN_AMT\" , \"CATALOG_RETURNS\".\"CR_NET_LOSS\" AS \"NET_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CP_CATALOG_PAGE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_2\" AS \"SALESRETURNS\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"SALESRETURNS\".\"PAGE_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"SALESRETURNS_3\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"WEB_SALES\".\"WS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"WEB_RETURNS\".\"WR_RETURN_AMT\" AS \"RETURN_AMT\" , \"WEB_RETURNS\".\"WR_NET_LOSS\" AS \"NET_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" LEFT JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_3\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"SALESRETURNS\".\"WSR_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"S_STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS\" AS \"RETURNS\" , \"SSR\".\"PROFIT\" - \"SSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CP_CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS\" AS \"RETURNS\" , \"CSR\".\"PROFIT\" - \"CSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS\" AS \"RETURNS\" , \"WSR\".\"PROFIT\" - \"WSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) , \"RESULTS\" AS ( SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\" ) SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT SS_STORE_SK AS STORE_SK , SS_SOLD_DATE_SK AS DATE_SK , SS_EXT_SALES_PRICE AS SALES_PRICE , SS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM STORE_SALES UNION ALL SELECT SR_STORE_SK AS STORE_SK , SR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , SR_RETURN_AMT AS RETURN_AMT , SR_NET_LOSS AS NET_LOSS FROM STORE_RETURNS ) AS SALESRETURNS , DATE_DIM , STORE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND STORE_SK = S_STORE_SK GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT CS_CATALOG_PAGE_SK AS PAGE_SK , CS_SOLD_DATE_SK AS DATE_SK , CS_EXT_SALES_PRICE AS SALES_PRICE , CS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM CATALOG_SALES UNION ALL SELECT CR_CATALOG_PAGE_SK AS PAGE_SK , CR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , CR_RETURN_AMOUNT AS RETURN_AMT , CR_NET_LOSS AS NET_LOSS FROM CATALOG_RETURNS ) AS SALESRETURNS , DATE_DIM , CATALOG_PAGE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND PAGE_SK = CP_CATALOG_PAGE_SK GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WS_SOLD_DATE_SK AS DATE_SK , WS_EXT_SALES_PRICE AS SALES_PRICE , WS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM WEB_SALES UNION ALL SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , WR_RETURN_AMT AS RETURN_AMT , WR_NET_LOSS AS NET_LOSS FROM WEB_RETURNS LEFT OUTER JOIN WEB_SALES ON ( WR_ITEM_SK = WS_ITEM_SK AND WR_ORDER_NUMBER = WS_ORDER_NUMBER ) ) AS SALESRETURNS , DATE_DIM , WEB_SITE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND WSR_WEB_SITE_SK = WEB_SITE_SK GROUP BY WEB_SITE_ID ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || S_STORE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CP_CATALOG_PAGE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM WSR ) AS X GROUP BY CHANNEL , ID ) SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM ( SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM RESULTS ) LIMIT 21",
                "preview": "\n/*            channel                            id         sales     returns       profit\n0     store channel         storeAAAAAAAAMKBAAAAA  1.108521e+08  2729315.00 -50124025.49\n1     store channel         storeAAAAAAAAAMCAAAAA  1.102836e+08  2796285.30 -49589729.51\n2     store channel         storeAAAAAAAACCDAAAAA  1.102220e+08  2716551.65 -49539532.30\n3     store channel         storeAAAAAAAAEMDAAAAA  1.081839e+08  2553416.02 -47955095.97\n4     store channel         storeAAAAAAAAJNAAAAAA  1.065576e+08  2710104.95 -47604802.18\n5     store channel         storeAAAAAAAAMBDAAAAA  1.089528e+08  2823594.03 -48022210.40\n6     store channel         storeAAAAAAAAIFAAAAAA  1.092344e+08  2749722.45 -49074026.01\n7     store channel         storeAAAAAAAAGABAAAAA  1.069608e+08  2744343.58 -48117033.10\n8     store channel         storeAAAAAAAAIOBAAAAA  1.072798e+08  2674863.03 -47321050.70\n9     store channel         storeAAAAAAAACLBAAAAA  1.067802e+08  2775899.43 -49069501.69\n10  catalog channel  catalog_pageAAAAAAAAJBCAAAAA  7.110759e+07   503053.47  -7697913.33\n11  catalog channel  catalog_pageAAAAAAAAIGBAAAAA  7.092886e+07   574991.51  -7478341.66\n12  catalog channel  catalog_pageAAAAAAAACGBAAAAA  7.124535e+07   489397.14  -8062294.50\n13  catalog channel  catalog_pageAAAAAAAAHEIAAAAA  3.537683e+07      927.72  -3560444.02\n14  catalog channel  catalog_pageAAAAAAAAIDIAAAAA  3.552803e+07     1975.84  -3310805.21\n15  catalog channel  catalog_pageAAAAAAAAJKBAAAAA  7.087486e+07   535535.82  -7715686.73\n16  catalog channel  catalog_pageAAAAAAAABBCAAAAA  7.132585e+07   479996.19  -7276779.84\n17  catalog channel  catalog_pageAAAAAAAAICIAAAAA  3.561253e+07     4076.64  -2903972.92\n18  catalog channel  catalog_pageAAAAAAAAPLCAAAAA  3.499834e+07   176281.76  -3410315.03\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.090814,
                    "execution_time": 1.894182,
                    "compile_time": 0.000717,
                    "planning_time": 0.160236
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 7.310435,
                    "execution_time": 6.996618,
                    "compile_time": 0.000738,
                    "planning_time": 0.277061
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id         sales     returns       profit\n0     store channel         storeAAAAAAAAMKBAAAAA  1.108521e+08  2729315.00 -50124025.49\n1     store channel         storeAAAAAAAAAMCAAAAA  1.102836e+08  2796285.30 -49589729.51\n2     store channel         storeAAAAAAAACCDAAAAA  1.102220e+08  2716551.65 -49539532.30\n3     store channel         storeAAAAAAAAEMDAAAAA  1.081839e+08  2553416.02 -47955095.97\n4     store channel         storeAAAAAAAAJNAAAAAA  1.065576e+08  2710104.95 -47604802.18\n5     store channel         storeAAAAAAAAMBDAAAAA  1.089528e+08  2823594.03 -48022210.40\n6     store channel         storeAAAAAAAAIFAAAAAA  1.092344e+08  2749722.45 -49074026.01\n7     store channel         storeAAAAAAAAGABAAAAA  1.069608e+08  2744343.58 -48117033.10\n8     store channel         storeAAAAAAAAIOBAAAAA  1.072798e+08  2674863.03 -47321050.70\n9     store channel         storeAAAAAAAACLBAAAAA  1.067802e+08  2775899.43 -49069501.69\n10  catalog channel  catalog_pageAAAAAAAAJBCAAAAA  7.110759e+07   503053.47  -7697913.33\n11  catalog channel  catalog_pageAAAAAAAAIGBAAAAA  7.092886e+07   574991.51  -7478341.66\n12  catalog channel  catalog_pageAAAAAAAACGBAAAAA  7.124535e+07   489397.14  -8062294.50\n13  catalog channel  catalog_pageAAAAAAAAHEIAAAAA  3.537683e+07      927.72  -3560444.02\n14  catalog channel  catalog_pageAAAAAAAAIDIAAAAA  3.552803e+07     1975.84  -3310805.21\n15  catalog channel  catalog_pageAAAAAAAAJKBAAAAA  7.087486e+07   535535.82  -7715686.73\n16  catalog channel  catalog_pageAAAAAAAABBCAAAAA  7.132585e+07   479996.19  -7276779.84\n17  catalog channel  catalog_pageAAAAAAAAICIAAAAA  3.561253e+07     4076.64  -2903972.92\n18  catalog channel  catalog_pageAAAAAAAAPLCAAAAA  3.499834e+07   176281.76  -3410315.03\n...*/"
    },
    {
        "input": "-- start template query5a.tpl query 98 in stream 0\nwith /* TPC-DS query5a.tpl 0.98 */ ssr as\n (select s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_sold_date_sk  as date_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from store_sales\n    union all\n    select sr_store_sk as store_sk,\n           sr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns\n   ) salesreturns\n     , date_dim\n     , store\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date) \n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and store_sk = s_store_sk\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_sold_date_sk  as date_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from catalog_sales\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns\n   ) salesreturns\n     , date_dim\n     , catalog_page\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_sold_date_sk  as date_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from web_sales\n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           wr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n   ) salesreturns\n     , date_dim\n     , web_site\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and wsr_web_site_sk = web_site_sk\n group by web_site_id)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\n group by channel, id)\n select  channel, id, sales, returns, profit from ( \n  select channel, id, sales, returns, profit from results\n  union all\n  select channel, id, sales, returns, profit from results\n) as final_results\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALESRETURNS\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 14 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-08-11' AS DATE ) ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"SALESRETURNS\".\"STORE_SK\" = \"STORE\".\"S_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"SALESRETURNS_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" UNION ALL SELECT \"CATALOG_RETURNS\".\"CR_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" AS \"RETURN_AMT\" , \"CATALOG_RETURNS\".\"CR_NET_LOSS\" AS \"NET_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CP_CATALOG_PAGE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_2\" AS \"SALESRETURNS\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"SALESRETURNS\".\"PAGE_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"SALESRETURNS_3\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"WEB_SALES\".\"WS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"WEB_RETURNS\".\"WR_RETURN_AMT\" AS \"RETURN_AMT\" , \"WEB_RETURNS\".\"WR_NET_LOSS\" AS \"NET_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" LEFT JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_3\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"SALESRETURNS\".\"WSR_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"S_STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS\" AS \"RETURNS\" , \"SSR\".\"PROFIT\" - \"SSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CP_CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS\" AS \"RETURNS\" , \"CSR\".\"PROFIT\" - \"CSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS\" AS \"RETURNS\" , \"WSR\".\"PROFIT\" - \"WSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) , \"RESULTS\" AS ( SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\" ) , \"FINAL_RESULTS\" AS ( SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" UNION ALL SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FINAL_RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"FINAL_RESULTS\".\"ID\" AS \"ID\" , \"FINAL_RESULTS\".\"SALES\" AS \"SALES\" , \"FINAL_RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"FINAL_RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"FINAL_RESULTS\" AS \"FINAL_RESULTS\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT SS_STORE_SK AS STORE_SK , SS_SOLD_DATE_SK AS DATE_SK , SS_EXT_SALES_PRICE AS SALES_PRICE , SS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM STORE_SALES UNION ALL SELECT SR_STORE_SK AS STORE_SK , SR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , SR_RETURN_AMT AS RETURN_AMT , SR_NET_LOSS AS NET_LOSS FROM STORE_RETURNS ) AS SALESRETURNS , DATE_DIM , STORE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND STORE_SK = S_STORE_SK GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT CS_CATALOG_PAGE_SK AS PAGE_SK , CS_SOLD_DATE_SK AS DATE_SK , CS_EXT_SALES_PRICE AS SALES_PRICE , CS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM CATALOG_SALES UNION ALL SELECT CR_CATALOG_PAGE_SK AS PAGE_SK , CR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , CR_RETURN_AMOUNT AS RETURN_AMT , CR_NET_LOSS AS NET_LOSS FROM CATALOG_RETURNS ) AS SALESRETURNS , DATE_DIM , CATALOG_PAGE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND PAGE_SK = CP_CATALOG_PAGE_SK GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WS_SOLD_DATE_SK AS DATE_SK , WS_EXT_SALES_PRICE AS SALES_PRICE , WS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM WEB_SALES UNION ALL SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , WR_RETURN_AMT AS RETURN_AMT , WR_NET_LOSS AS NET_LOSS FROM WEB_RETURNS LEFT OUTER JOIN WEB_SALES ON ( WR_ITEM_SK = WS_ITEM_SK AND WR_ORDER_NUMBER = WS_ORDER_NUMBER ) ) AS SALESRETURNS , DATE_DIM , WEB_SITE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND WSR_WEB_SITE_SK = WEB_SITE_SK GROUP BY WEB_SITE_ID ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || S_STORE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CP_CATALOG_PAGE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM WSR ) AS X GROUP BY CHANNEL , ID ) SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM ( SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM RESULTS UNION ALL SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM RESULTS ) AS FINAL_RESULTS LIMIT 21",
                "preview": "\n/*            channel                            id        sales     returns      profit\n0   catalog channel  catalog_pageAAAAAAAAGHBAAAAA  70592875.36   641210.23 -7950575.34\n1   catalog channel  catalog_pageAAAAAAAAJBBAAAAA  71100135.48   601293.28 -7401105.32\n2   catalog channel  catalog_pageAAAAAAAAJDBAAAAA  70892326.81   496345.27 -7950302.33\n3   catalog channel  catalog_pageAAAAAAAACCBAAAAA  71053440.07   578260.46 -7726126.55\n4   catalog channel  catalog_pageAAAAAAAAJADAAAAA  35310476.13   222907.72 -3284562.97\n5   catalog channel  catalog_pageAAAAAAAABADAAAAA  35058006.66   187094.08 -3698182.08\n6   catalog channel  catalog_pageAAAAAAAAFJCAAAAA  34702593.01   196084.20 -3673224.92\n7   catalog channel  catalog_pageAAAAAAAACGCAAAAA  34350491.72   206571.18 -3950070.51\n8   catalog channel  catalog_pageAAAAAAAAIGDAAAAA         0.00   127799.35   -84395.00\n9   catalog channel  catalog_pageAAAAAAAACCAAAAAA         0.00  1654569.91 -1018072.38\n10  catalog channel  catalog_pageAAAAAAAAHFAAAAAA         0.00  1985811.07 -1156925.62\n11  catalog channel  catalog_pageAAAAAAAAOGAAAAAA         0.00  1743902.83 -1014261.69\n12  catalog channel  catalog_pageAAAAAAAAEDAAAAAA         0.00  1866949.06 -1081228.46\n13  catalog channel  catalog_pageAAAAAAAAFBAAAAAA         0.00  1779502.56 -1048683.16\n14  catalog channel  catalog_pageAAAAAAAAMFEAAAAA         0.00   148595.04   -93954.99\n15  catalog channel  catalog_pageAAAAAAAAELDAAAAA         0.00    91242.73   -59250.72\n16  catalog channel  catalog_pageAAAAAAAAGHDAAAAA         0.00   157165.41   -99222.98\n17  catalog channel  catalog_pageAAAAAAAAANDAAAAA         0.00   110782.15   -74706.77\n18  catalog channel  catalog_pageAAAAAAAALFDAAAAA         0.00   123426.53   -73335.39\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 2.321899,
                    "execution_time": 1.945668,
                    "compile_time": 0.001108,
                    "planning_time": 2.299799
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 7.556283,
                    "execution_time": 6.896732,
                    "compile_time": 0.173666,
                    "planning_time": 7.360582
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id        sales     returns      profit\n0   catalog channel  catalog_pageAAAAAAAAGHBAAAAA  70592875.36   641210.23 -7950575.34\n1   catalog channel  catalog_pageAAAAAAAAJBBAAAAA  71100135.48   601293.28 -7401105.32\n2   catalog channel  catalog_pageAAAAAAAAJDBAAAAA  70892326.81   496345.27 -7950302.33\n3   catalog channel  catalog_pageAAAAAAAACCBAAAAA  71053440.07   578260.46 -7726126.55\n4   catalog channel  catalog_pageAAAAAAAAJADAAAAA  35310476.13   222907.72 -3284562.97\n5   catalog channel  catalog_pageAAAAAAAABADAAAAA  35058006.66   187094.08 -3698182.08\n6   catalog channel  catalog_pageAAAAAAAAFJCAAAAA  34702593.01   196084.20 -3673224.92\n7   catalog channel  catalog_pageAAAAAAAACGCAAAAA  34350491.72   206571.18 -3950070.51\n8   catalog channel  catalog_pageAAAAAAAAIGDAAAAA         0.00   127799.35   -84395.00\n9   catalog channel  catalog_pageAAAAAAAACCAAAAAA         0.00  1654569.91 -1018072.38\n10  catalog channel  catalog_pageAAAAAAAAHFAAAAAA         0.00  1985811.07 -1156925.62\n11  catalog channel  catalog_pageAAAAAAAAOGAAAAAA         0.00  1743902.83 -1014261.69\n12  catalog channel  catalog_pageAAAAAAAAEDAAAAAA         0.00  1866949.06 -1081228.46\n13  catalog channel  catalog_pageAAAAAAAAFBAAAAAA         0.00  1779502.56 -1048683.16\n14  catalog channel  catalog_pageAAAAAAAAMFEAAAAA         0.00   148595.04   -93954.99\n15  catalog channel  catalog_pageAAAAAAAAELDAAAAA         0.00    91242.73   -59250.72\n16  catalog channel  catalog_pageAAAAAAAAGHDAAAAA         0.00   157165.41   -99222.98\n17  catalog channel  catalog_pageAAAAAAAAANDAAAAA         0.00   110782.15   -74706.77\n18  catalog channel  catalog_pageAAAAAAAALFDAAAAA         0.00   123426.53   -73335.39\n...*/"
    },
    {
        "input": "-- start template query5a.tpl query 98 in stream 0\nwith /* TPC-DS query5a.tpl 0.98 */ ssr as\n (select s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_sold_date_sk  as date_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from store_sales\n    union all\n    select sr_store_sk as store_sk,\n           sr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns\n   ) salesreturns,\n     date_dim,\n     store\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date) \n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and store_sk = s_store_sk\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_sold_date_sk  as date_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from catalog_sales\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns\n   ) salesreturns,\n     date_dim,\n     catalog_page\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_sold_date_sk  as date_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from web_sales\n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           wr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n   ) salesreturns,\n     date_dim,\n     web_site\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and wsr_web_site_sk = web_site_sk\n group by web_site_id)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\n group by channel, id)\n select  channel, id, sales, returns, profit from ( \n  select channel, id, sales, returns, profit from results\n  union\n  select channel, null as id, sum(sales), sum(returns), sum(profit) from results group by channel\n) /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALESRETURNS\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 14 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-08-11' AS DATE ) ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"SALESRETURNS\".\"STORE_SK\" = \"STORE\".\"S_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"SALESRETURNS_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" UNION ALL SELECT \"CATALOG_RETURNS\".\"CR_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" AS \"RETURN_AMT\" , \"CATALOG_RETURNS\".\"CR_NET_LOSS\" AS \"NET_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CP_CATALOG_PAGE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_2\" AS \"SALESRETURNS\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"SALESRETURNS\".\"PAGE_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"SALESRETURNS_3\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"WEB_SALES\".\"WS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"WEB_RETURNS\".\"WR_RETURN_AMT\" AS \"RETURN_AMT\" , \"WEB_RETURNS\".\"WR_NET_LOSS\" AS \"NET_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" LEFT JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_3\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"SALESRETURNS\".\"WSR_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"S_STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS\" AS \"RETURNS\" , \"SSR\".\"PROFIT\" - \"SSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CP_CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS\" AS \"RETURNS\" , \"CSR\".\"PROFIT\" - \"CSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS\" AS \"RETURNS\" , \"WSR\".\"PROFIT\" - \"WSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) , \"RESULTS\" AS ( SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\" ) , \"_Q_0\" AS ( SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , NULL AS \"ID\" , SUM ( \"RESULTS\".\"SALES\" ) AS \"_COL_2\" , SUM ( \"RESULTS\".\"RETURNS\" ) AS \"_COL_3\" , SUM ( \"RESULTS\".\"PROFIT\" ) AS \"_COL_4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"CHANNEL\" ) SELECT \"_Q_0\".\"CHANNEL\" AS \"CHANNEL\" , \"_Q_0\".\"ID\" AS \"ID\" , \"_Q_0\".\"SALES\" AS \"SALES\" , \"_Q_0\".\"RETURNS\" AS \"RETURNS\" , \"_Q_0\".\"PROFIT\" AS \"PROFIT\" FROM \"_Q_0\" AS \"_Q_0\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT SS_STORE_SK AS STORE_SK , SS_SOLD_DATE_SK AS DATE_SK , SS_EXT_SALES_PRICE AS SALES_PRICE , SS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM STORE_SALES UNION ALL SELECT SR_STORE_SK AS STORE_SK , SR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , SR_RETURN_AMT AS RETURN_AMT , SR_NET_LOSS AS NET_LOSS FROM STORE_RETURNS ) AS SALESRETURNS , DATE_DIM , STORE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND STORE_SK = S_STORE_SK GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT CS_CATALOG_PAGE_SK AS PAGE_SK , CS_SOLD_DATE_SK AS DATE_SK , CS_EXT_SALES_PRICE AS SALES_PRICE , CS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM CATALOG_SALES UNION ALL SELECT CR_CATALOG_PAGE_SK AS PAGE_SK , CR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , CR_RETURN_AMOUNT AS RETURN_AMT , CR_NET_LOSS AS NET_LOSS FROM CATALOG_RETURNS ) AS SALESRETURNS , DATE_DIM , CATALOG_PAGE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND PAGE_SK = CP_CATALOG_PAGE_SK GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WS_SOLD_DATE_SK AS DATE_SK , WS_EXT_SALES_PRICE AS SALES_PRICE , WS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM WEB_SALES UNION ALL SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , WR_RETURN_AMT AS RETURN_AMT , WR_NET_LOSS AS NET_LOSS FROM WEB_RETURNS LEFT OUTER JOIN WEB_SALES ON ( WR_ITEM_SK = WS_ITEM_SK AND WR_ORDER_NUMBER = WS_ORDER_NUMBER ) ) AS SALESRETURNS , DATE_DIM , WEB_SITE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND WSR_WEB_SITE_SK = WEB_SITE_SK GROUP BY WEB_SITE_ID ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || S_STORE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CP_CATALOG_PAGE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM WSR ) AS X GROUP BY CHANNEL , ID ) SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM ( SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM RESULTS UNION SELECT CHANNEL , NULL AS ID , SUM ( SALES ) , SUM ( RETURNS ) , SUM ( PROFIT ) FROM RESULTS GROUP BY CHANNEL ) LIMIT 21",
                "preview": "\n/*            channel                            id        sales     returns      profit\n0   catalog channel  catalog_pageAAAAAAAAMNEAAAAA         0.00   201032.92  -107460.01\n1   catalog channel  catalog_pageAAAAAAAACGHAAAAA         0.00    23054.20   -14866.00\n2   catalog channel  catalog_pageAAAAAAAAIIHAAAAA         0.00    18685.81   -12045.10\n3   catalog channel  catalog_pageAAAAAAAAOCHAAAAA         0.00    41123.97   -16357.93\n4   catalog channel  catalog_pageAAAAAAAANJFAAAAA         0.00    83259.42   -37465.13\n5   catalog channel  catalog_pageAAAAAAAAGBAAAAAA         0.00  2085320.39 -1197479.91\n6   catalog channel  catalog_pageAAAAAAAAGOEAAAAA         0.00   103889.20   -75210.31\n7   catalog channel  catalog_pageAAAAAAAAIBGAAAAA         0.00    72685.14   -43732.83\n8   catalog channel  catalog_pageAAAAAAAAGCFAAAAA         0.00   104617.36   -68915.60\n9   catalog channel  catalog_pageAAAAAAAABAAAAAAA         0.00  1888062.35 -1028508.53\n10  catalog channel  catalog_pageAAAAAAAAPKEAAAAA         0.00   106143.61   -66724.61\n11  catalog channel  catalog_pageAAAAAAAAFHEAAAAA         0.00   148124.49   -66764.54\n12  catalog channel  catalog_pageAAAAAAAAEAIAAAAA  35389683.01     4662.91 -3507914.61\n13  catalog channel  catalog_pageAAAAAAAABECAAAAA  35343881.90   201690.65 -3633373.53\n14  catalog channel  catalog_pageAAAAAAAAMJAAAAAA         0.00  1840386.92 -1088258.06\n15  catalog channel  catalog_pageAAAAAAAAJDEAAAAA         0.00   204282.16   -99729.62\n16  catalog channel  catalog_pageAAAAAAAAOFDAAAAA         0.00   133936.96   -78877.76\n17  catalog channel  catalog_pageAAAAAAAAGJAAAAAA         0.00  1929719.53 -1089187.98\n18  catalog channel  catalog_pageAAAAAAAACKAAAAAA         0.00  1897707.37 -1103094.42\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 4.032279,
                    "execution_time": 3.578038,
                    "compile_time": 0.001879,
                    "planning_time": 0.774202
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 8.972154,
                    "execution_time": 8.410828,
                    "compile_time": 0.001831,
                    "planning_time": 1.03199
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id        sales     returns      profit\n0   catalog channel  catalog_pageAAAAAAAAMNEAAAAA         0.00   201032.92  -107460.01\n1   catalog channel  catalog_pageAAAAAAAACGHAAAAA         0.00    23054.20   -14866.00\n2   catalog channel  catalog_pageAAAAAAAAIIHAAAAA         0.00    18685.81   -12045.10\n3   catalog channel  catalog_pageAAAAAAAAOCHAAAAA         0.00    41123.97   -16357.93\n4   catalog channel  catalog_pageAAAAAAAANJFAAAAA         0.00    83259.42   -37465.13\n5   catalog channel  catalog_pageAAAAAAAAGBAAAAAA         0.00  2085320.39 -1197479.91\n6   catalog channel  catalog_pageAAAAAAAAGOEAAAAA         0.00   103889.20   -75210.31\n7   catalog channel  catalog_pageAAAAAAAAIBGAAAAA         0.00    72685.14   -43732.83\n8   catalog channel  catalog_pageAAAAAAAAGCFAAAAA         0.00   104617.36   -68915.60\n9   catalog channel  catalog_pageAAAAAAAABAAAAAAA         0.00  1888062.35 -1028508.53\n10  catalog channel  catalog_pageAAAAAAAAPKEAAAAA         0.00   106143.61   -66724.61\n11  catalog channel  catalog_pageAAAAAAAAFHEAAAAA         0.00   148124.49   -66764.54\n12  catalog channel  catalog_pageAAAAAAAAEAIAAAAA  35389683.01     4662.91 -3507914.61\n13  catalog channel  catalog_pageAAAAAAAABECAAAAA  35343881.90   201690.65 -3633373.53\n14  catalog channel  catalog_pageAAAAAAAAMJAAAAAA         0.00  1840386.92 -1088258.06\n15  catalog channel  catalog_pageAAAAAAAAJDEAAAAA         0.00   204282.16   -99729.62\n16  catalog channel  catalog_pageAAAAAAAAOFDAAAAA         0.00   133936.96   -78877.76\n17  catalog channel  catalog_pageAAAAAAAAGJAAAAAA         0.00  1929719.53 -1089187.98\n18  catalog channel  catalog_pageAAAAAAAACKAAAAAA         0.00  1897707.37 -1103094.42\n...*/"
    },
    {
        "input": "-- start template query5a.tpl query 98 in stream 0\nwith /* TPC-DS query5a.tpl 0.98 */ ssr as\n (select s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_sold_date_sk  as date_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from store_sales\n    union all\n    select sr_store_sk as store_sk,\n           sr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns\n   ) salesreturns,\n     date_dim,\n     store\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date) \n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and store_sk = s_store_sk\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_sold_date_sk  as date_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from catalog_sales\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns\n   ) salesreturns,\n     date_dim,\n     catalog_page\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_sold_date_sk  as date_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from web_sales\n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           wr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n   ) salesreturns,\n     date_dim,\n     web_site\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and wsr_web_site_sk = web_site_sk\n group by web_site_id)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - 0) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - 0) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - 0) as profit\n from   wsr\n ) x\n group by channel, id)\n select  channel, id, sales, returns, profit from ( \n  select channel, id, sales, returns, profit from results\n  union\n  select channel, null as id, sum(sales), sum(returns), sum(profit) from results group by channel\n) results_final  /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALESRETURNS\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 14 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-08-11' AS DATE ) ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" FROM \"SALESRETURNS\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"SALESRETURNS\".\"STORE_SK\" = \"STORE\".\"S_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"SALESRETURNS_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" UNION ALL SELECT \"CATALOG_RETURNS\".\"CR_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" AS \"RETURN_AMT\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CP_CATALOG_PAGE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" FROM \"SALESRETURNS_2\" AS \"SALESRETURNS\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"SALESRETURNS\".\"PAGE_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"SALESRETURNS_3\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"WEB_SALES\".\"WS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"WEB_RETURNS\".\"WR_RETURN_AMT\" AS \"RETURN_AMT\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" LEFT JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" FROM \"SALESRETURNS_3\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"SALESRETURNS\".\"WSR_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"S_STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS\" AS \"RETURNS\" , \"SSR\".\"PROFIT\" - 0 AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CP_CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS\" AS \"RETURNS\" , \"CSR\".\"PROFIT\" - 0 AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS\" AS \"RETURNS\" , \"WSR\".\"PROFIT\" - 0 AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) , \"RESULTS\" AS ( SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\" ) , \"RESULTS_FINAL\" AS ( SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , NULL AS \"ID\" , SUM ( \"RESULTS\".\"SALES\" ) AS \"_COL_2\" , SUM ( \"RESULTS\".\"RETURNS\" ) AS \"_COL_3\" , SUM ( \"RESULTS\".\"PROFIT\" ) AS \"_COL_4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"CHANNEL\" ) SELECT \"RESULTS_FINAL\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS_FINAL\".\"ID\" AS \"ID\" , \"RESULTS_FINAL\".\"SALES\" AS \"SALES\" , \"RESULTS_FINAL\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS_FINAL\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS_FINAL\" AS \"RESULTS_FINAL\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT SS_STORE_SK AS STORE_SK , SS_SOLD_DATE_SK AS DATE_SK , SS_EXT_SALES_PRICE AS SALES_PRICE , SS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM STORE_SALES UNION ALL SELECT SR_STORE_SK AS STORE_SK , SR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , SR_RETURN_AMT AS RETURN_AMT , SR_NET_LOSS AS NET_LOSS FROM STORE_RETURNS ) AS SALESRETURNS , DATE_DIM , STORE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND STORE_SK = S_STORE_SK GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT CS_CATALOG_PAGE_SK AS PAGE_SK , CS_SOLD_DATE_SK AS DATE_SK , CS_EXT_SALES_PRICE AS SALES_PRICE , CS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM CATALOG_SALES UNION ALL SELECT CR_CATALOG_PAGE_SK AS PAGE_SK , CR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , CR_RETURN_AMOUNT AS RETURN_AMT , CR_NET_LOSS AS NET_LOSS FROM CATALOG_RETURNS ) AS SALESRETURNS , DATE_DIM , CATALOG_PAGE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND PAGE_SK = CP_CATALOG_PAGE_SK GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WS_SOLD_DATE_SK AS DATE_SK , WS_EXT_SALES_PRICE AS SALES_PRICE , WS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM WEB_SALES UNION ALL SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , WR_RETURN_AMT AS RETURN_AMT , WR_NET_LOSS AS NET_LOSS FROM WEB_RETURNS LEFT OUTER JOIN WEB_SALES ON ( WR_ITEM_SK = WS_ITEM_SK AND WR_ORDER_NUMBER = WS_ORDER_NUMBER ) ) AS SALESRETURNS , DATE_DIM , WEB_SITE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND WSR_WEB_SITE_SK = WEB_SITE_SK GROUP BY WEB_SITE_ID ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || S_STORE_ID AS ID , SALES , RETURNS , ( PROFIT - 0 ) AS PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CP_CATALOG_PAGE_ID AS ID , SALES , RETURNS , ( PROFIT - 0 ) AS PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS , ( PROFIT - 0 ) AS PROFIT FROM WSR ) AS X GROUP BY CHANNEL , ID ) SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM ( SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM RESULTS UNION SELECT CHANNEL , NULL AS ID , SUM ( SALES ) , SUM ( RETURNS ) , SUM ( PROFIT ) FROM RESULTS GROUP BY CHANNEL ) AS RESULTS_FINAL LIMIT 21",
                "preview": "\n/*            channel                            id  sales     returns  profit\n0   catalog channel  catalog_pageAAAAAAAANGAAAAAA    0.0  1730112.02     0.0\n1   catalog channel  catalog_pageAAAAAAAAGBEAAAAA    0.0   138445.77     0.0\n2   catalog channel  catalog_pageAAAAAAAADEAAAAAA    0.0  1621687.33     0.0\n3   catalog channel  catalog_pageAAAAAAAACMFAAAAA    0.0   110552.11     0.0\n4   catalog channel  catalog_pageAAAAAAAAAHAAAAAA    0.0  1957757.60     0.0\n5   catalog channel  catalog_pageAAAAAAAAKMAAAAAA    0.0  1774102.56     0.0\n6   catalog channel  catalog_pageAAAAAAAAOOEAAAAA    0.0   116775.70     0.0\n7   catalog channel  catalog_pageAAAAAAAACABAAAAA    0.0  1781167.69     0.0\n8   catalog channel  catalog_pageAAAAAAAAKLFAAAAA    0.0    79454.51     0.0\n9   catalog channel  catalog_pageAAAAAAAAGOGAAAAA    0.0    33119.31     0.0\n10  catalog channel  catalog_pageAAAAAAAAINFAAAAA    0.0    78848.93     0.0\n11  catalog channel  catalog_pageAAAAAAAALEDAAAAA    0.0   138303.72     0.0\n12  catalog channel  catalog_pageAAAAAAAADCFAAAAA    0.0   129775.62     0.0\n13  catalog channel  catalog_pageAAAAAAAAGJFAAAAA    0.0    65497.70     0.0\n14  catalog channel  catalog_pageAAAAAAAAPJEAAAAA    0.0    99116.99     0.0\n15  catalog channel  catalog_pageAAAAAAAAMPFAAAAA    0.0   106395.62     0.0\n16  catalog channel  catalog_pageAAAAAAAAEIFAAAAA    0.0    76919.43     0.0\n17  catalog channel  catalog_pageAAAAAAAALJGAAAAA    0.0    37079.80     0.0\n18  catalog channel  catalog_pageAAAAAAAAKEEAAAAA    0.0   120816.63     0.0\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 3.931461,
                    "execution_time": 3.482554,
                    "compile_time": 0.001799,
                    "planning_time": 0.749424
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 10.846225,
                    "execution_time": 7.16314,
                    "compile_time": 3.109013,
                    "planning_time": 1.122574
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id  sales     returns  profit\n0   catalog channel  catalog_pageAAAAAAAANGAAAAAA    0.0  1730112.02     0.0\n1   catalog channel  catalog_pageAAAAAAAAGBEAAAAA    0.0   138445.77     0.0\n2   catalog channel  catalog_pageAAAAAAAADEAAAAAA    0.0  1621687.33     0.0\n3   catalog channel  catalog_pageAAAAAAAACMFAAAAA    0.0   110552.11     0.0\n4   catalog channel  catalog_pageAAAAAAAAAHAAAAAA    0.0  1957757.60     0.0\n5   catalog channel  catalog_pageAAAAAAAAKMAAAAAA    0.0  1774102.56     0.0\n6   catalog channel  catalog_pageAAAAAAAAOOEAAAAA    0.0   116775.70     0.0\n7   catalog channel  catalog_pageAAAAAAAACABAAAAA    0.0  1781167.69     0.0\n8   catalog channel  catalog_pageAAAAAAAAKLFAAAAA    0.0    79454.51     0.0\n9   catalog channel  catalog_pageAAAAAAAAGOGAAAAA    0.0    33119.31     0.0\n10  catalog channel  catalog_pageAAAAAAAAINFAAAAA    0.0    78848.93     0.0\n11  catalog channel  catalog_pageAAAAAAAALEDAAAAA    0.0   138303.72     0.0\n12  catalog channel  catalog_pageAAAAAAAADCFAAAAA    0.0   129775.62     0.0\n13  catalog channel  catalog_pageAAAAAAAAGJFAAAAA    0.0    65497.70     0.0\n14  catalog channel  catalog_pageAAAAAAAAPJEAAAAA    0.0    99116.99     0.0\n15  catalog channel  catalog_pageAAAAAAAAMPFAAAAA    0.0   106395.62     0.0\n16  catalog channel  catalog_pageAAAAAAAAEIFAAAAA    0.0    76919.43     0.0\n17  catalog channel  catalog_pageAAAAAAAALJGAAAAA    0.0    37079.80     0.0\n18  catalog channel  catalog_pageAAAAAAAAKEEAAAAA    0.0   120816.63     0.0\n...*/"
    },
    {
        "input": "-- start template query5a.tpl query 98 in stream 0\nwith /* TPC-DS query5a.tpl 0.98 */ ssr as\n (select s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_sold_date_sk  as date_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from store_sales\n    union all\n    select sr_store_sk as store_sk,\n           sr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns\n   ) salesreturns,\n     date_dim,\n     store\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date) \n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and store_sk = s_store_sk\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_sold_date_sk  as date_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from catalog_sales\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns\n   ) salesreturns,\n     date_dim,\n     catalog_page\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_sold_date_sk  as date_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from web_sales\n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           wr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n   ) salesreturns,\n     date_dim,\n     web_site\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and wsr_web_site_sk = web_site_sk\n group by web_site_id)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\n group by channel, id)\n select  channel, id, sales, returns, profit from ( \n  select channel, id, sales, returns, profit from results\n  union\n  select channel, null as id, sum(sales), sum(returns), sum(profit) from results group by channel\n  union\n  select null as channel, null as id, sum(sales), sum(returns), sum(profit) from results) foo\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALESRETURNS\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 14 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-08-11' AS DATE ) ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"SALESRETURNS\".\"STORE_SK\" = \"STORE\".\"S_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"SALESRETURNS_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" UNION ALL SELECT \"CATALOG_RETURNS\".\"CR_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" AS \"RETURN_AMT\" , \"CATALOG_RETURNS\".\"CR_NET_LOSS\" AS \"NET_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CP_CATALOG_PAGE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_2\" AS \"SALESRETURNS\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"SALESRETURNS\".\"PAGE_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"SALESRETURNS_3\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"WEB_SALES\".\"WS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"WEB_RETURNS\".\"WR_RETURN_AMT\" AS \"RETURN_AMT\" , \"WEB_RETURNS\".\"WR_NET_LOSS\" AS \"NET_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" LEFT JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_3\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"SALESRETURNS\".\"WSR_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"S_STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS\" AS \"RETURNS\" , \"SSR\".\"PROFIT\" - \"SSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CP_CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS\" AS \"RETURNS\" , \"CSR\".\"PROFIT\" - \"CSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS\" AS \"RETURNS\" , \"WSR\".\"PROFIT\" - \"WSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) , \"RESULTS\" AS ( SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\" ) , \"FOO\" AS ( SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , NULL AS \"ID\" , SUM ( \"RESULTS\".\"SALES\" ) AS \"_COL_2\" , SUM ( \"RESULTS\".\"RETURNS\" ) AS \"_COL_3\" , SUM ( \"RESULTS\".\"PROFIT\" ) AS \"_COL_4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"CHANNEL\" UNION SELECT NULL AS \"CHANNEL\" , NULL AS \"ID\" , SUM ( \"RESULTS\".\"SALES\" ) AS \"_COL_2\" , SUM ( \"RESULTS\".\"RETURNS\" ) AS \"_COL_3\" , SUM ( \"RESULTS\".\"PROFIT\" ) AS \"_COL_4\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"CHANNEL\" AS \"CHANNEL\" , \"FOO\".\"ID\" AS \"ID\" , \"FOO\".\"SALES\" AS \"SALES\" , \"FOO\".\"RETURNS\" AS \"RETURNS\" , \"FOO\".\"PROFIT\" AS \"PROFIT\" FROM \"FOO\" AS \"FOO\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT SS_STORE_SK AS STORE_SK , SS_SOLD_DATE_SK AS DATE_SK , SS_EXT_SALES_PRICE AS SALES_PRICE , SS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM STORE_SALES UNION ALL SELECT SR_STORE_SK AS STORE_SK , SR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , SR_RETURN_AMT AS RETURN_AMT , SR_NET_LOSS AS NET_LOSS FROM STORE_RETURNS ) AS SALESRETURNS , DATE_DIM , STORE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND STORE_SK = S_STORE_SK GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT CS_CATALOG_PAGE_SK AS PAGE_SK , CS_SOLD_DATE_SK AS DATE_SK , CS_EXT_SALES_PRICE AS SALES_PRICE , CS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM CATALOG_SALES UNION ALL SELECT CR_CATALOG_PAGE_SK AS PAGE_SK , CR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , CR_RETURN_AMOUNT AS RETURN_AMT , CR_NET_LOSS AS NET_LOSS FROM CATALOG_RETURNS ) AS SALESRETURNS , DATE_DIM , CATALOG_PAGE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND PAGE_SK = CP_CATALOG_PAGE_SK GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WS_SOLD_DATE_SK AS DATE_SK , WS_EXT_SALES_PRICE AS SALES_PRICE , WS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM WEB_SALES UNION ALL SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , WR_RETURN_AMT AS RETURN_AMT , WR_NET_LOSS AS NET_LOSS FROM WEB_RETURNS LEFT OUTER JOIN WEB_SALES ON ( WR_ITEM_SK = WS_ITEM_SK AND WR_ORDER_NUMBER = WS_ORDER_NUMBER ) ) AS SALESRETURNS , DATE_DIM , WEB_SITE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND WSR_WEB_SITE_SK = WEB_SITE_SK GROUP BY WEB_SITE_ID ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || S_STORE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CP_CATALOG_PAGE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM WSR ) AS X GROUP BY CHANNEL , ID ) SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM ( SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM RESULTS UNION SELECT CHANNEL , NULL AS ID , SUM ( SALES ) , SUM ( RETURNS ) , SUM ( PROFIT ) FROM RESULTS GROUP BY CHANNEL UNION SELECT NULL AS CHANNEL , NULL AS ID , SUM ( SALES ) , SUM ( RETURNS ) , SUM ( PROFIT ) FROM RESULTS ) AS FOO LIMIT 21",
                "preview": "\n/*            channel                            id         sales     returns       profit\n0   catalog channel  catalog_pageAAAAAAAAEMDAAAAA  0.000000e+00   174543.14    -96067.28\n1   catalog channel  catalog_pageAAAAAAAAPGHAAAAA  0.000000e+00    41277.48    -29316.54\n2   catalog channel  catalog_pageAAAAAAAAKGAAAAAA  0.000000e+00  1896874.80  -1037206.41\n3   catalog channel  catalog_pageAAAAAAAAJBGAAAAA  0.000000e+00    59964.29    -30773.45\n4   catalog channel  catalog_pageAAAAAAAAABEAAAAA  0.000000e+00   161661.92    -93933.38\n5   catalog channel  catalog_pageAAAAAAAALFAAAAAA  0.000000e+00  1608819.18   -990548.32\n6   catalog channel  catalog_pageAAAAAAAAGDFAAAAA  0.000000e+00   105616.95    -66284.34\n7   catalog channel  catalog_pageAAAAAAAAHIAAAAAA  0.000000e+00  1738220.63  -1060999.00\n8     store channel         storeAAAAAAAAGKBAAAAA  1.082124e+08  2639686.87 -48829852.56\n9     store channel         storeAAAAAAAAOHCAAAAA  1.089665e+08  2619472.98 -48615524.98\n10  catalog channel  catalog_pageAAAAAAAAKMGAAAAA  0.000000e+00    33942.45    -15343.84\n11  catalog channel  catalog_pageAAAAAAAACJEAAAAA  0.000000e+00    77412.06    -45437.87\n12  catalog channel  catalog_pageAAAAAAAAGGGAAAAA  0.000000e+00    83572.74    -61068.14\n13  catalog channel  catalog_pageAAAAAAAAEFHAAAAA  0.000000e+00    31920.43    -27682.72\n14  catalog channel  catalog_pageAAAAAAAADAFAAAAA  0.000000e+00   156617.33    -99027.17\n15  catalog channel  catalog_pageAAAAAAAAGLEAAAAA  0.000000e+00   126059.00    -80030.04\n16  catalog channel  catalog_pageAAAAAAAADKGAAAAA  0.000000e+00    58821.07    -34599.55\n17  catalog channel  catalog_pageAAAAAAAAFHHAAAAA  0.000000e+00    60072.93    -32919.11\n18  catalog channel  catalog_pageAAAAAAAAEHFAAAAA  0.000000e+00    98944.76    -52050.80\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 5.800252,
                    "execution_time": 5.164295,
                    "compile_time": 0.002329,
                    "planning_time": 0.942729
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 10.648718,
                    "execution_time": 9.889524,
                    "compile_time": 0.002367,
                    "planning_time": 1.222889
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id         sales     returns       profit\n0   catalog channel  catalog_pageAAAAAAAAEMDAAAAA  0.000000e+00   174543.14    -96067.28\n1   catalog channel  catalog_pageAAAAAAAAPGHAAAAA  0.000000e+00    41277.48    -29316.54\n2   catalog channel  catalog_pageAAAAAAAAKGAAAAAA  0.000000e+00  1896874.80  -1037206.41\n3   catalog channel  catalog_pageAAAAAAAAJBGAAAAA  0.000000e+00    59964.29    -30773.45\n4   catalog channel  catalog_pageAAAAAAAAABEAAAAA  0.000000e+00   161661.92    -93933.38\n5   catalog channel  catalog_pageAAAAAAAALFAAAAAA  0.000000e+00  1608819.18   -990548.32\n6   catalog channel  catalog_pageAAAAAAAAGDFAAAAA  0.000000e+00   105616.95    -66284.34\n7   catalog channel  catalog_pageAAAAAAAAHIAAAAAA  0.000000e+00  1738220.63  -1060999.00\n8     store channel         storeAAAAAAAAGKBAAAAA  1.082124e+08  2639686.87 -48829852.56\n9     store channel         storeAAAAAAAAOHCAAAAA  1.089665e+08  2619472.98 -48615524.98\n10  catalog channel  catalog_pageAAAAAAAAKMGAAAAA  0.000000e+00    33942.45    -15343.84\n11  catalog channel  catalog_pageAAAAAAAACJEAAAAA  0.000000e+00    77412.06    -45437.87\n12  catalog channel  catalog_pageAAAAAAAAGGGAAAAA  0.000000e+00    83572.74    -61068.14\n13  catalog channel  catalog_pageAAAAAAAAEFHAAAAA  0.000000e+00    31920.43    -27682.72\n14  catalog channel  catalog_pageAAAAAAAADAFAAAAA  0.000000e+00   156617.33    -99027.17\n15  catalog channel  catalog_pageAAAAAAAAGLEAAAAA  0.000000e+00   126059.00    -80030.04\n16  catalog channel  catalog_pageAAAAAAAADKGAAAAA  0.000000e+00    58821.07    -34599.55\n17  catalog channel  catalog_pageAAAAAAAAFHHAAAAA  0.000000e+00    60072.93    -32919.11\n18  catalog channel  catalog_pageAAAAAAAAEHFAAAAA  0.000000e+00    98944.76    -52050.80\n...*/"
    },
    {
        "input": "-- start template query5a.tpl query 98 in stream 0\nwith /* TPC-DS query5a.tpl 0.98 */ ssr as\n (select s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_sold_date_sk  as date_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from store_sales\n    union all\n    select sr_store_sk as store_sk,\n           sr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns\n   ) salesreturns,\n     date_dim,\n     store\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date) \n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and store_sk = s_store_sk\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_sold_date_sk  as date_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from catalog_sales\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns\n   ) salesreturns,\n     date_dim,\n     catalog_page\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_sold_date_sk  as date_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from web_sales\n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           wr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n   ) salesreturns,\n     date_dim,\n     web_site\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and wsr_web_site_sk = web_site_sk\n group by web_site_id)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\n group by channel, id)\n select  channel, id, sales, returns, profit from ( \n  select channel, id, sales, returns, profit from results\n  union\n  select channel, null as id, sum(sales), sum(returns), sum(profit) from results group by channel\n  union\n  select null as channel, null as id, sum(sales), sum(returns), sum(profit) from results) foo\norder by channel, id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALESRETURNS\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 14 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-08-11' AS DATE ) ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"SALESRETURNS\".\"STORE_SK\" = \"STORE\".\"S_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"SALESRETURNS_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" UNION ALL SELECT \"CATALOG_RETURNS\".\"CR_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" AS \"RETURN_AMT\" , \"CATALOG_RETURNS\".\"CR_NET_LOSS\" AS \"NET_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CP_CATALOG_PAGE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_2\" AS \"SALESRETURNS\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"SALESRETURNS\".\"PAGE_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"SALESRETURNS_3\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"WEB_SALES\".\"WS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"WEB_RETURNS\".\"WR_RETURN_AMT\" AS \"RETURN_AMT\" , \"WEB_RETURNS\".\"WR_NET_LOSS\" AS \"NET_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" LEFT JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_3\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"SALESRETURNS\".\"WSR_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"S_STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS\" AS \"RETURNS\" , \"SSR\".\"PROFIT\" - \"SSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CP_CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS\" AS \"RETURNS\" , \"CSR\".\"PROFIT\" - \"CSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS\" AS \"RETURNS\" , \"WSR\".\"PROFIT\" - \"WSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) , \"RESULTS\" AS ( SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\" ) , \"FOO\" AS ( SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , NULL AS \"ID\" , SUM ( \"RESULTS\".\"SALES\" ) AS \"_COL_2\" , SUM ( \"RESULTS\".\"RETURNS\" ) AS \"_COL_3\" , SUM ( \"RESULTS\".\"PROFIT\" ) AS \"_COL_4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"CHANNEL\" UNION SELECT NULL AS \"CHANNEL\" , NULL AS \"ID\" , SUM ( \"RESULTS\".\"SALES\" ) AS \"_COL_2\" , SUM ( \"RESULTS\".\"RETURNS\" ) AS \"_COL_3\" , SUM ( \"RESULTS\".\"PROFIT\" ) AS \"_COL_4\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"CHANNEL\" AS \"CHANNEL\" , \"FOO\".\"ID\" AS \"ID\" , \"FOO\".\"SALES\" AS \"SALES\" , \"FOO\".\"RETURNS\" AS \"RETURNS\" , \"FOO\".\"PROFIT\" AS \"PROFIT\" FROM \"FOO\" AS \"FOO\" ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT SS_STORE_SK AS STORE_SK , SS_SOLD_DATE_SK AS DATE_SK , SS_EXT_SALES_PRICE AS SALES_PRICE , SS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM STORE_SALES UNION ALL SELECT SR_STORE_SK AS STORE_SK , SR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , SR_RETURN_AMT AS RETURN_AMT , SR_NET_LOSS AS NET_LOSS FROM STORE_RETURNS ) AS SALESRETURNS , DATE_DIM , STORE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND STORE_SK = S_STORE_SK GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT CS_CATALOG_PAGE_SK AS PAGE_SK , CS_SOLD_DATE_SK AS DATE_SK , CS_EXT_SALES_PRICE AS SALES_PRICE , CS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM CATALOG_SALES UNION ALL SELECT CR_CATALOG_PAGE_SK AS PAGE_SK , CR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , CR_RETURN_AMOUNT AS RETURN_AMT , CR_NET_LOSS AS NET_LOSS FROM CATALOG_RETURNS ) AS SALESRETURNS , DATE_DIM , CATALOG_PAGE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND PAGE_SK = CP_CATALOG_PAGE_SK GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WS_SOLD_DATE_SK AS DATE_SK , WS_EXT_SALES_PRICE AS SALES_PRICE , WS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM WEB_SALES UNION ALL SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , WR_RETURN_AMT AS RETURN_AMT , WR_NET_LOSS AS NET_LOSS FROM WEB_RETURNS LEFT OUTER JOIN WEB_SALES ON ( WR_ITEM_SK = WS_ITEM_SK AND WR_ORDER_NUMBER = WS_ORDER_NUMBER ) ) AS SALESRETURNS , DATE_DIM , WEB_SITE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND WSR_WEB_SITE_SK = WEB_SITE_SK GROUP BY WEB_SITE_ID ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || S_STORE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CP_CATALOG_PAGE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM WSR ) AS X GROUP BY CHANNEL , ID ) SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM ( SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM RESULTS UNION SELECT CHANNEL , NULL AS ID , SUM ( SALES ) , SUM ( RETURNS ) , SUM ( PROFIT ) FROM RESULTS GROUP BY CHANNEL UNION SELECT NULL AS CHANNEL , NULL AS ID , SUM ( SALES ) , SUM ( RETURNS ) , SUM ( PROFIT ) FROM RESULTS ) AS FOO ORDER BY CHANNEL NULLS FIRST , ID NULLS FIRST LIMIT 21",
                "preview": "\n/*            channel                            id         sales       returns        profit\n0              None                          None  1.139289e+11  2.456063e+09 -3.115885e+10\n1   catalog channel                          None  3.933968e+10  8.143654e+08 -4.419421e+09\n2   catalog channel  catalog_pageAAAAAAAAAABAAAAA  0.000000e+00  1.656711e+06 -9.172215e+05\n3   catalog channel  catalog_pageAAAAAAAAAACAAAAA  7.044388e+07  5.136965e+05 -8.143912e+06\n4   catalog channel  catalog_pageAAAAAAAAAADAAAAA  3.616008e+07  1.776591e+05 -3.584936e+06\n5   catalog channel  catalog_pageAAAAAAAAAAEAAAAA  0.000000e+00  1.364126e+05 -6.931269e+04\n6   catalog channel  catalog_pageAAAAAAAAAAFAAAAA  0.000000e+00  1.428035e+05 -8.549706e+04\n7   catalog channel  catalog_pageAAAAAAAAAAGAAAAA  0.000000e+00  1.170422e+05 -8.117707e+04\n8   catalog channel  catalog_pageAAAAAAAAAAHAAAAA  0.000000e+00  4.710439e+04 -2.456803e+04\n9   catalog channel  catalog_pageAAAAAAAAAAIAAAAA  3.531500e+07  6.323390e+03 -3.542951e+06\n10  catalog channel  catalog_pageAAAAAAAAABAAAAAA  0.000000e+00  1.838226e+06 -1.041520e+06\n11  catalog channel  catalog_pageAAAAAAAAABBAAAAA  0.000000e+00  1.821163e+06 -1.089170e+06\n12  catalog channel  catalog_pageAAAAAAAAABCAAAAA  6.981124e+07  6.277490e+05 -7.962786e+06\n13  catalog channel  catalog_pageAAAAAAAAABDAAAAA  3.626820e+07  2.007993e+05 -3.459942e+06\n14  catalog channel  catalog_pageAAAAAAAAABEAAAAA  0.000000e+00  1.616619e+05 -9.393338e+04\n15  catalog channel  catalog_pageAAAAAAAAABFAAAAA  0.000000e+00  1.471747e+05 -7.597794e+04\n16  catalog channel  catalog_pageAAAAAAAAABGAAAAA  0.000000e+00  8.522167e+04 -4.560551e+04\n17  catalog channel  catalog_pageAAAAAAAAABHAAAAA  0.000000e+00  2.702420e+04 -2.594221e+04\n18  catalog channel  catalog_pageAAAAAAAAABIAAAAA  3.577945e+07  1.219200e+02 -3.528809e+06\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 5.815055,
                    "execution_time": 5.176073,
                    "compile_time": 0.002379,
                    "planning_time": 0.943543
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 10.594412,
                    "execution_time": 9.831682,
                    "compile_time": 0.002488,
                    "planning_time": 1.221027
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id         sales       returns        profit\n0              None                          None  1.139289e+11  2.456063e+09 -3.115885e+10\n1   catalog channel                          None  3.933968e+10  8.143654e+08 -4.419421e+09\n2   catalog channel  catalog_pageAAAAAAAAAABAAAAA  0.000000e+00  1.656711e+06 -9.172215e+05\n3   catalog channel  catalog_pageAAAAAAAAAACAAAAA  7.044388e+07  5.136965e+05 -8.143912e+06\n4   catalog channel  catalog_pageAAAAAAAAAADAAAAA  3.616008e+07  1.776591e+05 -3.584936e+06\n5   catalog channel  catalog_pageAAAAAAAAAAEAAAAA  0.000000e+00  1.364126e+05 -6.931269e+04\n6   catalog channel  catalog_pageAAAAAAAAAAFAAAAA  0.000000e+00  1.428035e+05 -8.549706e+04\n7   catalog channel  catalog_pageAAAAAAAAAAGAAAAA  0.000000e+00  1.170422e+05 -8.117707e+04\n8   catalog channel  catalog_pageAAAAAAAAAAHAAAAA  0.000000e+00  4.710439e+04 -2.456803e+04\n9   catalog channel  catalog_pageAAAAAAAAAAIAAAAA  3.531500e+07  6.323390e+03 -3.542951e+06\n10  catalog channel  catalog_pageAAAAAAAAABAAAAAA  0.000000e+00  1.838226e+06 -1.041520e+06\n11  catalog channel  catalog_pageAAAAAAAAABBAAAAA  0.000000e+00  1.821163e+06 -1.089170e+06\n12  catalog channel  catalog_pageAAAAAAAAABCAAAAA  6.981124e+07  6.277490e+05 -7.962786e+06\n13  catalog channel  catalog_pageAAAAAAAAABDAAAAA  3.626820e+07  2.007993e+05 -3.459942e+06\n14  catalog channel  catalog_pageAAAAAAAAABEAAAAA  0.000000e+00  1.616619e+05 -9.393338e+04\n15  catalog channel  catalog_pageAAAAAAAAABFAAAAA  0.000000e+00  1.471747e+05 -7.597794e+04\n16  catalog channel  catalog_pageAAAAAAAAABGAAAAA  0.000000e+00  8.522167e+04 -4.560551e+04\n17  catalog channel  catalog_pageAAAAAAAAABHAAAAA  0.000000e+00  2.702420e+04 -2.594221e+04\n18  catalog channel  catalog_pageAAAAAAAAABIAAAAA  3.577945e+07  1.219200e+02 -3.528809e+06\n...*/"
    },
    {
        "input": "-- start template query5a.tpl query 98 in stream 0\nwith /* TPC-DS query5a.tpl 0.98 */ ssr as\n (select s_store_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ss_store_sk as store_sk,\n            ss_sold_date_sk  as date_sk,\n            ss_ext_sales_price as sales_price,\n            ss_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from store_sales\n    union all\n    select sr_store_sk as store_sk,\n           sr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           sr_return_amt as return_amt,\n           sr_net_loss as net_loss\n    from store_returns\n   ) salesreturns,\n     date_dim,\n     store\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date) \n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and store_sk = s_store_sk\n group by s_store_id)\n ,\n csr as\n (select cp_catalog_page_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  cs_catalog_page_sk as page_sk,\n            cs_sold_date_sk  as date_sk,\n            cs_ext_sales_price as sales_price,\n            cs_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from catalog_sales\n    union all\n    select cr_catalog_page_sk as page_sk,\n           cr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           cr_return_amount as return_amt,\n           cr_net_loss as net_loss\n    from catalog_returns\n   ) salesreturns,\n     date_dim,\n     catalog_page\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and page_sk = cp_catalog_page_sk\n group by cp_catalog_page_id)\n ,\n wsr as\n (select web_site_id,\n        sum(sales_price) as sales,\n        sum(profit) as profit,\n        sum(return_amt) as returns,\n        sum(net_loss) as profit_loss\n from\n  ( select  ws_web_site_sk as wsr_web_site_sk,\n            ws_sold_date_sk  as date_sk,\n            ws_ext_sales_price as sales_price,\n            ws_net_profit as profit,\n            cast(0 as decimal(7,2)) as return_amt,\n            cast(0 as decimal(7,2)) as net_loss\n    from web_sales\n    union all\n    select ws_web_site_sk as wsr_web_site_sk,\n           wr_returned_date_sk as date_sk,\n           cast(0 as decimal(7,2)) as sales_price,\n           cast(0 as decimal(7,2)) as profit,\n           wr_return_amt as return_amt,\n           wr_net_loss as net_loss\n    from web_returns left outer join web_sales on\n         ( wr_item_sk = ws_item_sk\n           and wr_order_number = ws_order_number)\n   ) salesreturns,\n     date_dim,\n     web_site\n where date_sk = d_date_sk\n       and d_date between cast('1998-08-11' as date)\n                  and dateadd(day,14,cast('1998-08-11' as date))\n       and wsr_web_site_sk = web_site_sk\n group by web_site_id)\n ,\n results as\n (select channel\n        , id\n        , sum(sales) as sales\n        , sum(returns) as returns\n        , sum(profit) as profit\n from \n (select 'store channel' as channel\n        , 'store' || s_store_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   ssr\n union all\n select 'catalog channel' as channel\n        , 'catalog_page' || cp_catalog_page_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from  csr\n union all\n select 'web channel' as channel\n        , 'web_site' || web_site_id as id\n        , sales\n        , returns\n        , (profit - profit_loss) as profit\n from   wsr\n ) x\n group by channel, id)\n select  channel, id, sales, returns, profit from ( \n  select channel, id, sales, returns, profit from results\n  union\n  select channel, null as id, sum(sales), sum(returns), sum(profit) from results group by channel\n  union\n  select null as channel, null as id, sum(sales), sum(returns), sum(profit) from results) foo\norder by channel, id\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "WITH \"SALESRETURNS\" AS ( SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\" ) , \"DATE_DIM_2\" AS ( SELECT \"DATE_DIM\".\"D_DATE_SK\" AS \"D_DATE_SK\" , \"DATE_DIM\".\"D_DATE\" AS \"D_DATE\" FROM \"DATE_DIM\" AS \"DATE_DIM\" WHERE \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 14 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '1998-08-11' AS DATE ) ) , \"SSR\" AS ( SELECT \"STORE\".\"S_STORE_ID\" AS \"S_STORE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"STORE\" AS \"STORE\" ON \"SALESRETURNS\".\"STORE_SK\" = \"STORE\".\"S_STORE_SK\" GROUP BY \"STORE\".\"S_STORE_ID\" ) , \"SALESRETURNS_2\" AS ( SELECT \"CATALOG_SALES\".\"CS_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_SALES\".\"CS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"CATALOG_SALES\".\"CS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"CATALOG_SALES\".\"CS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"CATALOG_SALES\" AS \"CATALOG_SALES\" UNION ALL SELECT \"CATALOG_RETURNS\".\"CR_CATALOG_PAGE_SK\" AS \"PAGE_SK\" , \"CATALOG_RETURNS\".\"CR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"CATALOG_RETURNS\".\"CR_RETURN_AMOUNT\" AS \"RETURN_AMT\" , \"CATALOG_RETURNS\".\"CR_NET_LOSS\" AS \"NET_LOSS\" FROM \"CATALOG_RETURNS\" AS \"CATALOG_RETURNS\" ) , \"CSR\" AS ( SELECT \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" AS \"CP_CATALOG_PAGE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_2\" AS \"SALESRETURNS\" JOIN \"CATALOG_PAGE\" AS \"CATALOG_PAGE\" ON \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_SK\" = \"SALESRETURNS\".\"PAGE_SK\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" GROUP BY \"CATALOG_PAGE\".\"CP_CATALOG_PAGE_ID\" ) , \"SALESRETURNS_3\" AS ( SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_SALES\".\"WS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"WEB_SALES\".\"WS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"WEB_SALES\".\"WS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"WEB_SALES\" AS \"WEB_SALES\" UNION ALL SELECT \"WEB_SALES\".\"WS_WEB_SITE_SK\" AS \"WSR_WEB_SITE_SK\" , \"WEB_RETURNS\".\"WR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"WEB_RETURNS\".\"WR_RETURN_AMT\" AS \"RETURN_AMT\" , \"WEB_RETURNS\".\"WR_NET_LOSS\" AS \"NET_LOSS\" FROM \"WEB_RETURNS\" AS \"WEB_RETURNS\" LEFT JOIN \"WEB_SALES\" AS \"WEB_SALES\" ON \"WEB_RETURNS\".\"WR_ITEM_SK\" = \"WEB_SALES\".\"WS_ITEM_SK\" AND \"WEB_RETURNS\".\"WR_ORDER_NUMBER\" = \"WEB_SALES\".\"WS_ORDER_NUMBER\" ) , \"WSR\" AS ( SELECT \"WEB_SITE\".\"WEB_SITE_ID\" AS \"WEB_SITE_ID\" , SUM ( \"SALESRETURNS\".\"SALES_PRICE\" ) AS \"SALES\" , SUM ( \"SALESRETURNS\".\"PROFIT\" ) AS \"PROFIT\" , SUM ( \"SALESRETURNS\".\"RETURN_AMT\" ) AS \"RETURNS\" , SUM ( \"SALESRETURNS\".\"NET_LOSS\" ) AS \"PROFIT_LOSS\" FROM \"SALESRETURNS_3\" AS \"SALESRETURNS\" JOIN \"DATE_DIM_2\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"SALESRETURNS\".\"DATE_SK\" JOIN \"WEB_SITE\" AS \"WEB_SITE\" ON \"SALESRETURNS\".\"WSR_WEB_SITE_SK\" = \"WEB_SITE\".\"WEB_SITE_SK\" GROUP BY \"WEB_SITE\".\"WEB_SITE_ID\" ) , \"X\" AS ( SELECT 'store channel' AS \"CHANNEL\" , 'store' || \"SSR\".\"S_STORE_ID\" AS \"ID\" , \"SSR\".\"SALES\" AS \"SALES\" , \"SSR\".\"RETURNS\" AS \"RETURNS\" , \"SSR\".\"PROFIT\" - \"SSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"SSR\" AS \"SSR\" UNION ALL SELECT 'catalog channel' AS \"CHANNEL\" , 'catalog_page' || \"CSR\".\"CP_CATALOG_PAGE_ID\" AS \"ID\" , \"CSR\".\"SALES\" AS \"SALES\" , \"CSR\".\"RETURNS\" AS \"RETURNS\" , \"CSR\".\"PROFIT\" - \"CSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"CSR\" AS \"CSR\" UNION ALL SELECT 'web channel' AS \"CHANNEL\" , 'web_site' || \"WSR\".\"WEB_SITE_ID\" AS \"ID\" , \"WSR\".\"SALES\" AS \"SALES\" , \"WSR\".\"RETURNS\" AS \"RETURNS\" , \"WSR\".\"PROFIT\" - \"WSR\".\"PROFIT_LOSS\" AS \"PROFIT\" FROM \"WSR\" AS \"WSR\" ) , \"RESULTS\" AS ( SELECT \"X\".\"CHANNEL\" AS \"CHANNEL\" , \"X\".\"ID\" AS \"ID\" , SUM ( \"X\".\"SALES\" ) AS \"SALES\" , SUM ( \"X\".\"RETURNS\" ) AS \"RETURNS\" , SUM ( \"X\".\"PROFIT\" ) AS \"PROFIT\" FROM \"X\" AS \"X\" GROUP BY \"X\".\"CHANNEL\" , \"X\".\"ID\" ) , \"FOO\" AS ( SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , \"RESULTS\".\"ID\" AS \"ID\" , \"RESULTS\".\"SALES\" AS \"SALES\" , \"RESULTS\".\"RETURNS\" AS \"RETURNS\" , \"RESULTS\".\"PROFIT\" AS \"PROFIT\" FROM \"RESULTS\" AS \"RESULTS\" UNION SELECT \"RESULTS\".\"CHANNEL\" AS \"CHANNEL\" , NULL AS \"ID\" , SUM ( \"RESULTS\".\"SALES\" ) AS \"_COL_2\" , SUM ( \"RESULTS\".\"RETURNS\" ) AS \"_COL_3\" , SUM ( \"RESULTS\".\"PROFIT\" ) AS \"_COL_4\" FROM \"RESULTS\" AS \"RESULTS\" GROUP BY \"RESULTS\".\"CHANNEL\" UNION SELECT NULL AS \"CHANNEL\" , NULL AS \"ID\" , SUM ( \"RESULTS\".\"SALES\" ) AS \"_COL_2\" , SUM ( \"RESULTS\".\"RETURNS\" ) AS \"_COL_3\" , SUM ( \"RESULTS\".\"PROFIT\" ) AS \"_COL_4\" FROM \"RESULTS\" AS \"RESULTS\" ) SELECT \"FOO\".\"CHANNEL\" AS \"CHANNEL\" , \"FOO\".\"ID\" AS \"ID\" , \"FOO\".\"SALES\" AS \"SALES\" , \"FOO\".\"RETURNS\" AS \"RETURNS\" , \"FOO\".\"PROFIT\" AS \"PROFIT\" FROM \"FOO\" AS \"FOO\" ORDER BY \"CHANNEL\" NULLS LAST , \"ID\" NULLS LAST LIMIT 100"
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"STORE_SALES\".\"SS_STORE_SK\" AS \"STORE_SK\" , \"STORE_SALES\".\"SS_SOLD_DATE_SK\" AS \"DATE_SK\" , \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" AS \"SALES_PRICE\" , \"STORE_SALES\".\"SS_NET_PROFIT\" AS \"PROFIT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"RETURN_AMT\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"NET_LOSS\" FROM \"STORE_SALES\" AS \"STORE_SALES\" UNION ALL SELECT \"STORE_RETURNS\".\"SR_STORE_SK\" AS \"STORE_SK\" , \"STORE_RETURNS\".\"SR_RETURNED_DATE_SK\" AS \"DATE_SK\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"SALES_PRICE\" , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS \"PROFIT\" , \"STORE_RETURNS\".\"SR_RETURN_AMT\" AS \"RETURN_AMT\" , \"STORE_RETURNS\".\"SR_NET_LOSS\" AS \"NET_LOSS\" FROM \"STORE_RETURNS\" AS \"STORE_RETURNS\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "WITH SSR AS ( SELECT S_STORE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT SS_STORE_SK AS STORE_SK , SS_SOLD_DATE_SK AS DATE_SK , SS_EXT_SALES_PRICE AS SALES_PRICE , SS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM STORE_SALES UNION ALL SELECT SR_STORE_SK AS STORE_SK , SR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , SR_RETURN_AMT AS RETURN_AMT , SR_NET_LOSS AS NET_LOSS FROM STORE_RETURNS ) AS SALESRETURNS , DATE_DIM , STORE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND STORE_SK = S_STORE_SK GROUP BY S_STORE_ID ) , CSR AS ( SELECT CP_CATALOG_PAGE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT CS_CATALOG_PAGE_SK AS PAGE_SK , CS_SOLD_DATE_SK AS DATE_SK , CS_EXT_SALES_PRICE AS SALES_PRICE , CS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM CATALOG_SALES UNION ALL SELECT CR_CATALOG_PAGE_SK AS PAGE_SK , CR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , CR_RETURN_AMOUNT AS RETURN_AMT , CR_NET_LOSS AS NET_LOSS FROM CATALOG_RETURNS ) AS SALESRETURNS , DATE_DIM , CATALOG_PAGE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND PAGE_SK = CP_CATALOG_PAGE_SK GROUP BY CP_CATALOG_PAGE_ID ) , WSR AS ( SELECT WEB_SITE_ID , SUM ( SALES_PRICE ) AS SALES , SUM ( PROFIT ) AS PROFIT , SUM ( RETURN_AMT ) AS RETURNS , SUM ( NET_LOSS ) AS PROFIT_LOSS FROM ( SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WS_SOLD_DATE_SK AS DATE_SK , WS_EXT_SALES_PRICE AS SALES_PRICE , WS_NET_PROFIT AS PROFIT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS RETURN_AMT , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS NET_LOSS FROM WEB_SALES UNION ALL SELECT WS_WEB_SITE_SK AS WSR_WEB_SITE_SK , WR_RETURNED_DATE_SK AS DATE_SK , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS SALES_PRICE , CAST ( 0 AS DECIMAL ( 7 , 2 ) ) AS PROFIT , WR_RETURN_AMT AS RETURN_AMT , WR_NET_LOSS AS NET_LOSS FROM WEB_RETURNS LEFT OUTER JOIN WEB_SALES ON ( WR_ITEM_SK = WS_ITEM_SK AND WR_ORDER_NUMBER = WS_ORDER_NUMBER ) ) AS SALESRETURNS , DATE_DIM , WEB_SITE WHERE DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '1998-08-11' AS DATE ) AND DATEADD ( DAY , 14 , CAST ( '1998-08-11' AS DATE ) ) AND WSR_WEB_SITE_SK = WEB_SITE_SK GROUP BY WEB_SITE_ID ) , RESULTS AS ( SELECT CHANNEL , ID , SUM ( SALES ) AS SALES , SUM ( RETURNS ) AS RETURNS , SUM ( PROFIT ) AS PROFIT FROM ( SELECT 'store channel' AS CHANNEL , 'store' || S_STORE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM SSR UNION ALL SELECT 'catalog channel' AS CHANNEL , 'catalog_page' || CP_CATALOG_PAGE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM CSR UNION ALL SELECT 'web channel' AS CHANNEL , 'web_site' || WEB_SITE_ID AS ID , SALES , RETURNS , ( PROFIT - PROFIT_LOSS ) AS PROFIT FROM WSR ) AS X GROUP BY CHANNEL , ID ) SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM ( SELECT CHANNEL , ID , SALES , RETURNS , PROFIT FROM RESULTS UNION SELECT CHANNEL , NULL AS ID , SUM ( SALES ) , SUM ( RETURNS ) , SUM ( PROFIT ) FROM RESULTS GROUP BY CHANNEL UNION SELECT NULL AS CHANNEL , NULL AS ID , SUM ( SALES ) , SUM ( RETURNS ) , SUM ( PROFIT ) FROM RESULTS ) AS FOO ORDER BY CHANNEL NULLS FIRST , ID NULLS FIRST LIMIT 21",
                "preview": "\n/*            channel                            id         sales       returns        profit\n0              None                          None  1.139289e+11  2.456063e+09 -3.115885e+10\n1   catalog channel                          None  3.933968e+10  8.143654e+08 -4.419421e+09\n2   catalog channel  catalog_pageAAAAAAAAAABAAAAA  0.000000e+00  1.656711e+06 -9.172215e+05\n3   catalog channel  catalog_pageAAAAAAAAAACAAAAA  7.044388e+07  5.136965e+05 -8.143912e+06\n4   catalog channel  catalog_pageAAAAAAAAAADAAAAA  3.616008e+07  1.776591e+05 -3.584936e+06\n5   catalog channel  catalog_pageAAAAAAAAAAEAAAAA  0.000000e+00  1.364126e+05 -6.931269e+04\n6   catalog channel  catalog_pageAAAAAAAAAAFAAAAA  0.000000e+00  1.428035e+05 -8.549706e+04\n7   catalog channel  catalog_pageAAAAAAAAAAGAAAAA  0.000000e+00  1.170422e+05 -8.117707e+04\n8   catalog channel  catalog_pageAAAAAAAAAAHAAAAA  0.000000e+00  4.710439e+04 -2.456803e+04\n9   catalog channel  catalog_pageAAAAAAAAAAIAAAAA  3.531500e+07  6.323390e+03 -3.542951e+06\n10  catalog channel  catalog_pageAAAAAAAAABAAAAAA  0.000000e+00  1.838226e+06 -1.041520e+06\n11  catalog channel  catalog_pageAAAAAAAAABBAAAAA  0.000000e+00  1.821163e+06 -1.089170e+06\n12  catalog channel  catalog_pageAAAAAAAAABCAAAAA  6.981124e+07  6.277490e+05 -7.962786e+06\n13  catalog channel  catalog_pageAAAAAAAAABDAAAAA  3.626820e+07  2.007993e+05 -3.459942e+06\n14  catalog channel  catalog_pageAAAAAAAAABEAAAAA  0.000000e+00  1.616619e+05 -9.393338e+04\n15  catalog channel  catalog_pageAAAAAAAAABFAAAAA  0.000000e+00  1.471747e+05 -7.597794e+04\n16  catalog channel  catalog_pageAAAAAAAAABGAAAAA  0.000000e+00  8.522167e+04 -4.560551e+04\n17  catalog channel  catalog_pageAAAAAAAAABHAAAAA  0.000000e+00  2.702420e+04 -2.594221e+04\n18  catalog channel  catalog_pageAAAAAAAAABIAAAAA  3.577945e+07  1.219200e+02 -3.528809e+06\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 5.794408,
                    "execution_time": 5.171967,
                    "compile_time": 0.002349,
                    "planning_time": 0.928092
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 10.271596,
                    "execution_time": 9.628409,
                    "compile_time": 0.002424,
                    "planning_time": 1.090137
                }
            }
        ],
        "rewrite_main_query": null,
        "preview": "\n/*            channel                            id         sales       returns        profit\n0              None                          None  1.139289e+11  2.456063e+09 -3.115885e+10\n1   catalog channel                          None  3.933968e+10  8.143654e+08 -4.419421e+09\n2   catalog channel  catalog_pageAAAAAAAAAABAAAAA  0.000000e+00  1.656711e+06 -9.172215e+05\n3   catalog channel  catalog_pageAAAAAAAAAACAAAAA  7.044388e+07  5.136965e+05 -8.143912e+06\n4   catalog channel  catalog_pageAAAAAAAAAADAAAAA  3.616008e+07  1.776591e+05 -3.584936e+06\n5   catalog channel  catalog_pageAAAAAAAAAAEAAAAA  0.000000e+00  1.364126e+05 -6.931269e+04\n6   catalog channel  catalog_pageAAAAAAAAAAFAAAAA  0.000000e+00  1.428035e+05 -8.549706e+04\n7   catalog channel  catalog_pageAAAAAAAAAAGAAAAA  0.000000e+00  1.170422e+05 -8.117707e+04\n8   catalog channel  catalog_pageAAAAAAAAAAHAAAAA  0.000000e+00  4.710439e+04 -2.456803e+04\n9   catalog channel  catalog_pageAAAAAAAAAAIAAAAA  3.531500e+07  6.323390e+03 -3.542951e+06\n10  catalog channel  catalog_pageAAAAAAAAABAAAAAA  0.000000e+00  1.838226e+06 -1.041520e+06\n11  catalog channel  catalog_pageAAAAAAAAABBAAAAA  0.000000e+00  1.821163e+06 -1.089170e+06\n12  catalog channel  catalog_pageAAAAAAAAABCAAAAA  6.981124e+07  6.277490e+05 -7.962786e+06\n13  catalog channel  catalog_pageAAAAAAAAABDAAAAA  3.626820e+07  2.007993e+05 -3.459942e+06\n14  catalog channel  catalog_pageAAAAAAAAABEAAAAA  0.000000e+00  1.616619e+05 -9.393338e+04\n15  catalog channel  catalog_pageAAAAAAAAABFAAAAA  0.000000e+00  1.471747e+05 -7.597794e+04\n16  catalog channel  catalog_pageAAAAAAAAABGAAAAA  0.000000e+00  8.522167e+04 -4.560551e+04\n17  catalog channel  catalog_pageAAAAAAAAABHAAAAA  0.000000e+00  2.702420e+04 -2.594221e+04\n18  catalog channel  catalog_pageAAAAAAAAABIAAAAA  3.577945e+07  1.219200e+02 -3.528809e+06\n...*/"
    }
]