[
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id, i_item_desc, i_category, i_class, i_current_price\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_5\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY_COL_6\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS_COL_7\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE_COL_8\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_5\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY_COL_6\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS_COL_7\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE_COL_8\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC_COL_5\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY_COL_6\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS_COL_7\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE_COL_8\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n1=1 GROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" CROSS JOIN \"ITEM\" AS \"ITEM\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1,
                    "create_size": 0
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" LIMIT 21",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 60,
                    "execution_time": -1,
                    "compile_time": -1,
                    "planning_time": -1
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" CROSS JOIN \"DATE_DIM\" AS \"DATE_DIM\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
            }
        ],
        "preview": null
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_1\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 44.529869,
                    "execution_time": 44.204771,
                    "compile_time": 0.00067,
                    "planning_time": 0.063341,
                    "create_size": 260
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 44.382817,
                    "execution_time": 43.971895,
                    "compile_time": 0.00178,
                    "planning_time": 0.122012,
                    "create_size": 260
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_1\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\" LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                            i_item_desc i_category    i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAKDHFAAAA                                             Helpful, other numbers like as good techniques; therefore administrative kinds present sometimes. Really professional payments specify around internationa      Music  classical             1.36  13476327.50        0.0102\n1   AAAAAAAAEBEHEAAA                                                                                                                                                                                                  Exist      Music  classical             1.50  20863190.28        0.0158\n2   AAAAAAAAOHJCDAAA  Big, western talks change. Millions would leave origins. Full, difficult others reinforce recently on a groups. Trees give. Only days run. Changes dream along with a guests. Friends may come differ      Music  classical            18.18  20365054.96        0.0154\n3   AAAAAAAAKDNCEAAA                                                                                                                                     Extremely constant communications hide in a reports; initial membe      Music  classical             4.10  21013112.70        0.0159\n4   AAAAAAAAGHKACAAA                                                                                                                                                                             Limited balls will feel mo      Music  classical             4.41  13739819.19        0.0104\n5   AAAAAAAAFABBAAAA                                     Easy times drive certainly poor officers. Common, previous bones retrieve however investigations; scottish men should provide. Possible methods must authorise. Mo      Music  classical             5.58  34617663.92        0.0263\n6   AAAAAAAAMGIIEAAA                                                                        Things can allow more complex, single travellers. Possible sequences market; interesting samples give here fresh demands. Quite      Music  classical             0.44  20480151.07        0.0155\n7   AAAAAAAANBMCAAAA                                                                  Never other women used to leave past, only consultants. Much combined ages shall not watch today present local spirits. Women think s      Music  classical             9.67  33919562.50        0.0257\n8   AAAAAAAAGIPFBAAA                                         Vital methods could cut away relatives. Previously full aspects go so. Educational, single possibilities can take particularly soon new orders. Public individ      Music  classical             7.04  19988825.20        0.0151\n9   AAAAAAAACMBEDAAA                                                                                   Problems will take more historical loans; dependent sources promote; schools can concentrate provisions; different,       Music  classical             3.44  13673631.36        0.0103\n10  AAAAAAAAFEEHCAAA                                                                                                                                                      Too integrated drawings manufacture so attitudes.      Music  classical             4.35  34089373.97        0.0259\n11  AAAAAAAANOFGCAAA                                                                                                                                                 Effects may remember as then direct steps. Hot, massiv      Music  classical             3.99  33916943.71        0.0257\n12  AAAAAAAADAIEEAAA                                                                                                                                                           Military papers show signals. Unemployed, lo      Music  classical             7.66  34343665.12        0.0260\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018708,
                    "execution_time": 0.007352,
                    "compile_time": 5e-05,
                    "planning_time": 0.005013
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057116,
                    "execution_time": 0.007351,
                    "compile_time": 5.1e-05,
                    "planning_time": 0.040806
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_1\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_1\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_1\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_1\" AS \"SPEQLITE_TEMP_TABLE_1\""
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                            i_item_desc i_category    i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAKDHFAAAA                                             Helpful, other numbers like as good techniques; therefore administrative kinds present sometimes. Really professional payments specify around internationa      Music  classical             1.36  13476327.50        0.0102\n1   AAAAAAAAEBEHEAAA                                                                                                                                                                                                  Exist      Music  classical             1.50  20863190.28        0.0158\n2   AAAAAAAAOHJCDAAA  Big, western talks change. Millions would leave origins. Full, difficult others reinforce recently on a groups. Trees give. Only days run. Changes dream along with a guests. Friends may come differ      Music  classical            18.18  20365054.96        0.0154\n3   AAAAAAAAKDNCEAAA                                                                                                                                     Extremely constant communications hide in a reports; initial membe      Music  classical             4.10  21013112.70        0.0159\n4   AAAAAAAAGHKACAAA                                                                                                                                                                             Limited balls will feel mo      Music  classical             4.41  13739819.19        0.0104\n5   AAAAAAAAFABBAAAA                                     Easy times drive certainly poor officers. Common, previous bones retrieve however investigations; scottish men should provide. Possible methods must authorise. Mo      Music  classical             5.58  34617663.92        0.0263\n6   AAAAAAAAMGIIEAAA                                                                        Things can allow more complex, single travellers. Possible sequences market; interesting samples give here fresh demands. Quite      Music  classical             0.44  20480151.07        0.0155\n7   AAAAAAAANBMCAAAA                                                                  Never other women used to leave past, only consultants. Much combined ages shall not watch today present local spirits. Women think s      Music  classical             9.67  33919562.50        0.0257\n8   AAAAAAAAGIPFBAAA                                         Vital methods could cut away relatives. Previously full aspects go so. Educational, single possibilities can take particularly soon new orders. Public individ      Music  classical             7.04  19988825.20        0.0151\n9   AAAAAAAACMBEDAAA                                                                                   Problems will take more historical loans; dependent sources promote; schools can concentrate provisions; different,       Music  classical             3.44  13673631.36        0.0103\n10  AAAAAAAAFEEHCAAA                                                                                                                                                      Too integrated drawings manufacture so attitudes.      Music  classical             4.35  34089373.97        0.0259\n11  AAAAAAAANOFGCAAA                                                                                                                                                 Effects may remember as then direct steps. Hot, massiv      Music  classical             3.99  33916943.71        0.0257\n12  AAAAAAAADAIEEAAA                                                                                                                                                           Military papers show signals. Unemployed, lo      Music  classical             7.66  34343665.12        0.0260\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) and cast('2001-12-31' as date) \nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2001-12-31' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": [
            {
                "create": "CREATE TEMPORARY TABLE \"SPEQLITE_TEMP_TABLE_2\" AS SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST ( '2001-12-31' AS DATE ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\"",
                "retry_time": 0,
                "create_metrics": {
                    "elapsed_time": 7.390193,
                    "execution_time": 7.206125,
                    "compile_time": 0.000678,
                    "planning_time": 0.04671,
                    "create_size": 260
                },
                "create_metrics_warm_up": {
                    "elapsed_time": 7.530421,
                    "execution_time": 7.261632,
                    "compile_time": 0.001766,
                    "planning_time": 0.12699,
                    "create_size": 260
                }
            }
        ],
        "query": [
            {
                "query": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_2\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\" LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGMHPAAAA                                                                                                                                               Recent, public relations will not want. Nuclear hour        Men  shirts             2.81   5937794.49        0.0259\n1   AAAAAAAAAOAPAAAA                                                                                                                            Successful males think thus considerable, superb operations; years seem        Men  shirts             2.55   5852952.93        0.0256\n2   AAAAAAAAOKDEDAAA                                                                                                                  Recent, fine buildings think much utterly public months; joint, secret women wait        Men  shirts             5.01   5633596.44        0.0246\n3   AAAAAAAACMOIEAAA                       Reasonable, soft americans would travel much buyers. Firmly correct subsidies use. Also social blocks hurry reasons; days should consider only, new effects; white projects         Men  shirts             7.22   5995507.05        0.0262\n4   AAAAAAAAKCJDCAAA                                                                                                    Quiet arms ought to put never jobs. Final, external pieces shall leave typical models. Posts be        Men  shirts             7.59   5851099.92        0.0256\n5   AAAAAAAAAJJNBAAA                                                                                                                                                                                                 In        Men  shirts            93.12   5891166.25        0.0257\n6   AAAAAAAAEBDOBAAA                                            High, social years should encourage especially years. Statutory techniques can construct precisely children. Squarely soviet influences show a little r        Men  shirts             5.88   5689712.14        0.0248\n7   AAAAAAAAGFHACAAA                                                                                          Ruling jobs donate even. Views might keep other, healthy schemes; powers should not refer very forces; sc        Men  shirts             7.88   5771963.98        0.0252\n8   AAAAAAAAAIPBEAAA                                                                                                                                                                                    External prison        Men  shirts             4.95   5952689.66        0.0260\n9   AAAAAAAAOMOKAAAA                                                 Rewards pay thoughtfully national arrangements. Single, minute orders drop there important organisms; crazy traditions should get letters. Dark, e        Men  shirts             1.38   5993197.70        0.0262\n10  AAAAAAAAKJAKCAAA        More great mistakes take especially evident circumstances. Actually general followers may not take traditional kids. A bit little systems could worry still pictures. Far nice plans should        Men  shirts             6.16   5692878.92        0.0249\n11  AAAAAAAABGGGAAAA                                                  Cultural, european rules cannot move in a groups. Increased, active properties shall not seem main, small pounds. Groups work maybe; important th        Men  shirts             8.80   5679922.94        0.0248\n12  AAAAAAAAJFDOAAAA                                                                                                                                                                                   Also dead projec        Men  shirts             0.47   5906653.80        0.0258\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.018534,
                    "execution_time": 0.007255,
                    "compile_time": 4.8e-05,
                    "planning_time": 0.004986
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.057118,
                    "execution_time": 0.007345,
                    "compile_time": 5e-05,
                    "planning_time": 0.04078
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= CAST('2001-12-31' AS DATE) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": "SELECT \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CLASS\" AS \"I_CLASS\" , \"SPEQLITE_TEMP_TABLE_2\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , \"SPEQLITE_TEMP_TABLE_2\".\"ITEMREVENUE\" AS \"ITEMREVENUE\" , \"SPEQLITE_TEMP_TABLE_2\".\"REVENUERATIO\" AS \"REVENUERATIO\" FROM \"SPEQLITE_TEMP_TABLE_2\" AS \"SPEQLITE_TEMP_TABLE_2\""
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                        i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGMHPAAAA                                                                                                                                               Recent, public relations will not want. Nuclear hour        Men  shirts             2.81   5937794.49        0.0259\n1   AAAAAAAAAOAPAAAA                                                                                                                            Successful males think thus considerable, superb operations; years seem        Men  shirts             2.55   5852952.93        0.0256\n2   AAAAAAAAOKDEDAAA                                                                                                                  Recent, fine buildings think much utterly public months; joint, secret women wait        Men  shirts             5.01   5633596.44        0.0246\n3   AAAAAAAACMOIEAAA                       Reasonable, soft americans would travel much buyers. Firmly correct subsidies use. Also social blocks hurry reasons; days should consider only, new effects; white projects         Men  shirts             7.22   5995507.05        0.0262\n4   AAAAAAAAKCJDCAAA                                                                                                    Quiet arms ought to put never jobs. Final, external pieces shall leave typical models. Posts be        Men  shirts             7.59   5851099.92        0.0256\n5   AAAAAAAAAJJNBAAA                                                                                                                                                                                                 In        Men  shirts            93.12   5891166.25        0.0257\n6   AAAAAAAAEBDOBAAA                                            High, social years should encourage especially years. Statutory techniques can construct precisely children. Squarely soviet influences show a little r        Men  shirts             5.88   5689712.14        0.0248\n7   AAAAAAAAGFHACAAA                                                                                          Ruling jobs donate even. Views might keep other, healthy schemes; powers should not refer very forces; sc        Men  shirts             7.88   5771963.98        0.0252\n8   AAAAAAAAAIPBEAAA                                                                                                                                                                                    External prison        Men  shirts             4.95   5952689.66        0.0260\n9   AAAAAAAAOMOKAAAA                                                 Rewards pay thoughtfully national arrangements. Single, minute orders drop there important organisms; crazy traditions should get letters. Dark, e        Men  shirts             1.38   5993197.70        0.0262\n10  AAAAAAAAKJAKCAAA        More great mistakes take especially evident circumstances. Actually general followers may not take traditional kids. A bit little systems could worry still pictures. Far nice plans should        Men  shirts             6.16   5692878.92        0.0249\n11  AAAAAAAABGGGAAAA                                                  Cultural, european rules cannot move in a groups. Increased, active properties shall not seem main, small pounds. Groups work maybe; important th        Men  shirts             8.80   5679922.94        0.0248\n12  AAAAAAAAJFDOAAAA                                                                                                                                                                                   Also dead projec        Men  shirts             0.47   5906653.80        0.0258\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\nGROUP BY i_item_id, i_item_desc, i_category, i_class, i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAHPIEDAAA                                                                                                                                                   Spiritual comments woul      Music                      NaN    358330.62        1.5158\n1   AAAAAAAAKOHOBAAA                                                                                                                                                                                  Men                      NaN    388770.14        1.6446\n2   AAAAAAAAMFHACAAA                                                                                                                                                                                  Men                     3.18    341950.63        1.4465\n3   AAAAAAAAAMLDAAAA                                                                                                                                                                                  Men                      NaN    360327.67        1.5243\n4   AAAAAAAAEBPOBAAA                                                           Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                      NaN    334919.14        1.4168\n5   AAAAAAAAHOEPAAAA                                     Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN    350848.34        1.4842\n6   AAAAAAAAOGDMAAAA                                                                                                                                                                                Music                     9.32    340420.37        1.4400\n7   AAAAAAAAEJDJAAAA                                                   More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN    347576.82        1.4703\n8   AAAAAAAAGPDBDAAA                                                                                                                                                                                  Men                      NaN    346070.92        1.4640\n9   AAAAAAAAKHDDAAAA                                                                                                              Entire, related interests obtain typically. Narrow patients       Music                      NaN    314812.84        1.3317\n10  AAAAAAAANOHAAAAA                                                                         Goods will not comply for the facts; social, true girls ought to know now for a topics. Babies wo      Music                      NaN    283961.23        1.2012\n11  AAAAAAAAKGCBAAAA                                                                Always industrial systems should not believe of course hard fingers. Either overall drawings appear increa      Music                     4.44    373858.33        1.5815\n12  AAAAAAAAHNGNBAAA                                                                                                                                                                                Music                      NaN    312853.89        1.3234\n13  AAAAAAAAEGEFAAAA                  Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN    386915.62        1.6367\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.48259,
                    "execution_time": 0.423067,
                    "compile_time": 0.000301,
                    "planning_time": 0.042111
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.554053,
                    "execution_time": 0.430726,
                    "compile_time": 0.000297,
                    "planning_time": 0.104203
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAHPIEDAAA                                                                                                                                                   Spiritual comments woul      Music                      NaN    358330.62        1.5158\n1   AAAAAAAAKOHOBAAA                                                                                                                                                                                  Men                      NaN    388770.14        1.6446\n2   AAAAAAAAMFHACAAA                                                                                                                                                                                  Men                     3.18    341950.63        1.4465\n3   AAAAAAAAAMLDAAAA                                                                                                                                                                                  Men                      NaN    360327.67        1.5243\n4   AAAAAAAAEBPOBAAA                                                           Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                      NaN    334919.14        1.4168\n5   AAAAAAAAHOEPAAAA                                     Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN    350848.34        1.4842\n6   AAAAAAAAOGDMAAAA                                                                                                                                                                                Music                     9.32    340420.37        1.4400\n7   AAAAAAAAEJDJAAAA                                                   More right ways integrate. Slight positions should know letters. Commercial genes prevent; claims should not go outward      Shoes                      NaN    347576.82        1.4703\n8   AAAAAAAAGPDBDAAA                                                                                                                                                                                  Men                      NaN    346070.92        1.4640\n9   AAAAAAAAKHDDAAAA                                                                                                              Entire, related interests obtain typically. Narrow patients       Music                      NaN    314812.84        1.3317\n10  AAAAAAAANOHAAAAA                                                                         Goods will not comply for the facts; social, true girls ought to know now for a topics. Babies wo      Music                      NaN    283961.23        1.2012\n11  AAAAAAAAKGCBAAAA                                                                Always industrial systems should not believe of course hard fingers. Either overall drawings appear increa      Music                     4.44    373858.33        1.5815\n12  AAAAAAAAHNGNBAAA                                                                                                                                                                                Music                      NaN    312853.89        1.3234\n13  AAAAAAAAEGEFAAAA                  Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN    386915.62        1.6367\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by i_item_id, i_item_desc, i_category, i_class, i_current_price \n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAKOHOBAAA                                                                                                                                                                                  Men                      NaN    388770.14        1.6446\n1   AAAAAAAAGPDBDAAA                                                                                                                                                                                  Men                      NaN    346070.92        1.4640\n2   AAAAAAAAHNGNBAAA                                                                                                                                                                                Music                      NaN    312853.89        1.3234\n3   AAAAAAAAEBPOBAAA                                                           Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                      NaN    334919.14        1.4168\n4   AAAAAAAAANEHEAAA                          Main, early ages shall give later now large funds; as certain accounts might decide narrowly then good decades; british, right questions make ju        Men                     7.51    336900.62        1.4252\n5   AAAAAAAAOGDMAAAA                                                                                                                                                                                Music                     9.32    340420.37        1.4400\n6   AAAAAAAAHPIEDAAA                                                                                                                                                   Spiritual comments woul      Music                      NaN    358330.62        1.5158\n7   AAAAAAAAHOEPAAAA                                     Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN    350848.34        1.4842\n8   AAAAAAAAMFHACAAA                                                                                                                                                                                  Men                     3.18    341950.63        1.4465\n9   AAAAAAAAHFKFEAAA  Models can enjoy just social, public fingers. Black, good departments might mean clearly to a windows. Fortunate, unusual defendants struggle farmers; schools talk part        Men                     2.46    357230.66        1.5112\n10  AAAAAAAACNCCEAAA                                                                                                                                                                                  Men                     3.50    303953.33        1.2858\n11  AAAAAAAAPPNFEAAA                                                                                                                                                                                Music                     6.96    339736.94        1.4372\n12  AAAAAAAADJBFBAAA                                                                          Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN    411392.07        1.7403\n13  AAAAAAAAABLKAAAA                 Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43    370269.72        1.5663\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.477907,
                    "execution_time": 0.418897,
                    "compile_time": 0.000304,
                    "planning_time": 0.041122
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.483363,
                    "execution_time": 0.424532,
                    "compile_time": 0.000297,
                    "planning_time": 0.040784
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAKOHOBAAA                                                                                                                                                                                  Men                      NaN    388770.14        1.6446\n1   AAAAAAAAGPDBDAAA                                                                                                                                                                                  Men                      NaN    346070.92        1.4640\n2   AAAAAAAAHNGNBAAA                                                                                                                                                                                Music                      NaN    312853.89        1.3234\n3   AAAAAAAAEBPOBAAA                                                           Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                      NaN    334919.14        1.4168\n4   AAAAAAAAANEHEAAA                          Main, early ages shall give later now large funds; as certain accounts might decide narrowly then good decades; british, right questions make ju        Men                     7.51    336900.62        1.4252\n5   AAAAAAAAOGDMAAAA                                                                                                                                                                                Music                     9.32    340420.37        1.4400\n6   AAAAAAAAHPIEDAAA                                                                                                                                                   Spiritual comments woul      Music                      NaN    358330.62        1.5158\n7   AAAAAAAAHOEPAAAA                                     Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN    350848.34        1.4842\n8   AAAAAAAAMFHACAAA                                                                                                                                                                                  Men                     3.18    341950.63        1.4465\n9   AAAAAAAAHFKFEAAA  Models can enjoy just social, public fingers. Black, good departments might mean clearly to a windows. Fortunate, unusual defendants struggle farmers; schools talk part        Men                     2.46    357230.66        1.5112\n10  AAAAAAAACNCCEAAA                                                                                                                                                                                  Men                     3.50    303953.33        1.2858\n11  AAAAAAAAPPNFEAAA                                                                                                                                                                                Music                     6.96    339736.94        1.4372\n12  AAAAAAAADJBFBAAA                                                                          Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN    411392.07        1.7403\n13  AAAAAAAAABLKAAAA                 Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43    370269.72        1.5663\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id, i_item_desc, i_category, i_class, i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                             i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAFIKHBAAA         Solicitors raise merely economic, forward charges; delighted lives impress effectively other cities. Royal individuals let yet quickly social years. Even basic books mean alone particular rep        Men  accessories             2.81    297605.06        0.0232\n1   AAAAAAAAMICLCAAA                                                             Addresses can impose again findings. At least good years get mainly often invisible strengths. So continuous carers blame boys. Also alive         Men  accessories             2.09    325951.07        0.0254\n2   AAAAAAAAGLLCCAAA  Regular, prime owners ought to understand. Local beings used to bring male bands; cars might love then with a hundreds. International women provide special patterns. Years might carry arms; increasi        Men  accessories            96.84    374428.29        0.0292\n3   AAAAAAAALKGMBAAA                                                                   More great activities may use written comments. Researchers grow dangerous, senior assumptions. Large heads ought to produce before a        Men  accessories             6.14    332538.91        0.0259\n4   AAAAAAAAHNHKAAAA                                                                                                                                              Quick reasons strengthen yesterday by a developments. Fede        Men  accessories             3.27    344549.99        0.0269\n5   AAAAAAAACKMOAAAA                            Less little children would harm here strongly massive details. Aboard european eyes identify easy functions. English, western governors move as the buildings. For example t        Men  accessories             2.81    342879.73        0.0267\n6   AAAAAAAAKELPAAAA                                                                              Best similar estates sell only, liberal officers. Certainly advisory details shall take. Males will not respond main, ligh        Men  accessories             0.93    319190.06        0.0249\n7   AAAAAAAAHLIHBAAA                                                                                                           Decades know ever shops. Probably mechanical rats beg probably years. Classical, natural theo        Men  accessories             0.17    386954.61        0.0302\n8   AAAAAAAABMDAAAAA                                                                                                       Male, human sales perform studies. Dependent, hostile services answer principles. Formal men show        Men  accessories             8.66    335459.99        0.0261\n9   AAAAAAAAFAGIAAAA                                                                                                                                             Public races might not leave various, early efforts. Unknow        Men  accessories             8.14    360739.88        0.0281\n10  AAAAAAAALGODAAAA                                             Urgent plants walk also critical regions. Tremendous, practical implications will obtain open, necessary adults. Fair machines prove; direct, terrible poli        Men  accessories             6.67    323823.29        0.0252\n11  AAAAAAAACEMDBAAA                                                                                                                     Early moving stations may help well particular markets. Dead ways spend services. F        Men  accessories             4.32    368707.09        0.0287\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.487447,
                    "execution_time": 0.42619,
                    "compile_time": 0.000309,
                    "planning_time": 0.043226
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.490122,
                    "execution_time": 0.431253,
                    "compile_time": 0.000324,
                    "planning_time": 0.041152
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                             i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAFIKHBAAA         Solicitors raise merely economic, forward charges; delighted lives impress effectively other cities. Royal individuals let yet quickly social years. Even basic books mean alone particular rep        Men  accessories             2.81    297605.06        0.0232\n1   AAAAAAAAMICLCAAA                                                             Addresses can impose again findings. At least good years get mainly often invisible strengths. So continuous carers blame boys. Also alive         Men  accessories             2.09    325951.07        0.0254\n2   AAAAAAAAGLLCCAAA  Regular, prime owners ought to understand. Local beings used to bring male bands; cars might love then with a hundreds. International women provide special patterns. Years might carry arms; increasi        Men  accessories            96.84    374428.29        0.0292\n3   AAAAAAAALKGMBAAA                                                                   More great activities may use written comments. Researchers grow dangerous, senior assumptions. Large heads ought to produce before a        Men  accessories             6.14    332538.91        0.0259\n4   AAAAAAAAHNHKAAAA                                                                                                                                              Quick reasons strengthen yesterday by a developments. Fede        Men  accessories             3.27    344549.99        0.0269\n5   AAAAAAAACKMOAAAA                            Less little children would harm here strongly massive details. Aboard european eyes identify easy functions. English, western governors move as the buildings. For example t        Men  accessories             2.81    342879.73        0.0267\n6   AAAAAAAAKELPAAAA                                                                              Best similar estates sell only, liberal officers. Certainly advisory details shall take. Males will not respond main, ligh        Men  accessories             0.93    319190.06        0.0249\n7   AAAAAAAAHLIHBAAA                                                                                                           Decades know ever shops. Probably mechanical rats beg probably years. Classical, natural theo        Men  accessories             0.17    386954.61        0.0302\n8   AAAAAAAABMDAAAAA                                                                                                       Male, human sales perform studies. Dependent, hostile services answer principles. Formal men show        Men  accessories             8.66    335459.99        0.0261\n9   AAAAAAAAFAGIAAAA                                                                                                                                             Public races might not leave various, early efforts. Unknow        Men  accessories             8.14    360739.88        0.0281\n10  AAAAAAAALGODAAAA                                             Urgent plants walk also critical regions. Tremendous, practical implications will obtain open, necessary adults. Fair machines prove; direct, terrible poli        Men  accessories             6.67    323823.29        0.0252\n11  AAAAAAAACEMDBAAA                                                                                                                     Early moving stations may help well particular markets. Dead ways spend services. F        Men  accessories             4.32    368707.09        0.0287\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAANEHEAAA                          Main, early ages shall give later now large funds; as certain accounts might decide narrowly then good decades; british, right questions make ju        Men                     7.51    336900.62        1.4252\n1   AAAAAAAAKKIFBAAA                                                                                                                                                                                  Men                      NaN    329138.04        1.3923\n2   AAAAAAAAKOHOBAAA                                                                                                                                                                                  Men                      NaN    388770.14        1.6446\n3   AAAAAAAAHNGNBAAA                                                                                                                                                                                Music                      NaN    312853.89        1.3234\n4   AAAAAAAAGPDBDAAA                                                                                                                                                                                  Men                      NaN    346070.92        1.4640\n5   AAAAAAAAEBPOBAAA                                                           Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                      NaN    334919.14        1.4168\n6   AAAAAAAAOGDMAAAA                                                                                                                                                                                Music                     9.32    340420.37        1.4400\n7   AAAAAAAAHOEPAAAA                                     Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN    350848.34        1.4842\n8   AAAAAAAAHPIEDAAA                                                                                                                                                   Spiritual comments woul      Music                      NaN    358330.62        1.5158\n9   AAAAAAAAMFHACAAA                                                                                                                                                                                  Men                     3.18    341950.63        1.4465\n10  AAAAAAAACNCCEAAA                                                                                                                                                                                  Men                     3.50    303953.33        1.2858\n11  AAAAAAAAEGEFAAAA                  Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN    386915.62        1.6367\n12  AAAAAAAAPPNFEAAA                                                                                                                                                                                Music                     6.96    339736.94        1.4372\n13  AAAAAAAAABLKAAAA                 Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43    370269.72        1.5663\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.483495,
                    "execution_time": 0.424483,
                    "compile_time": 0.000304,
                    "planning_time": 0.041448
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.479892,
                    "execution_time": 0.420102,
                    "compile_time": 0.000309,
                    "planning_time": 0.041715
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAANEHEAAA                          Main, early ages shall give later now large funds; as certain accounts might decide narrowly then good decades; british, right questions make ju        Men                     7.51    336900.62        1.4252\n1   AAAAAAAAKKIFBAAA                                                                                                                                                                                  Men                      NaN    329138.04        1.3923\n2   AAAAAAAAKOHOBAAA                                                                                                                                                                                  Men                      NaN    388770.14        1.6446\n3   AAAAAAAAHNGNBAAA                                                                                                                                                                                Music                      NaN    312853.89        1.3234\n4   AAAAAAAAGPDBDAAA                                                                                                                                                                                  Men                      NaN    346070.92        1.4640\n5   AAAAAAAAEBPOBAAA                                                           Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                      NaN    334919.14        1.4168\n6   AAAAAAAAOGDMAAAA                                                                                                                                                                                Music                     9.32    340420.37        1.4400\n7   AAAAAAAAHOEPAAAA                                     Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN    350848.34        1.4842\n8   AAAAAAAAHPIEDAAA                                                                                                                                                   Spiritual comments woul      Music                      NaN    358330.62        1.5158\n9   AAAAAAAAMFHACAAA                                                                                                                                                                                  Men                     3.18    341950.63        1.4465\n10  AAAAAAAACNCCEAAA                                                                                                                                                                                  Men                     3.50    303953.33        1.2858\n11  AAAAAAAAEGEFAAAA                  Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN    386915.62        1.6367\n12  AAAAAAAAPPNFEAAA                                                                                                                                                                                Music                     6.96    339736.94        1.4372\n13  AAAAAAAAABLKAAAA                 Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43    370269.72        1.5663\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class \n        ,i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAOGDMAAAA                                                                                                                                                                                Music                     9.32    340420.37        1.4400\n1   AAAAAAAAKOHOBAAA                                                                                                                                                                                  Men                      NaN    388770.14        1.6446\n2   AAAAAAAACNCCEAAA                                                                                                                                                                                  Men                     3.50    303953.33        1.2858\n3   AAAAAAAAPPNFEAAA                                                                                                                                                                                Music                     6.96    339736.94        1.4372\n4   AAAAAAAAJMGKDAAA                                                                                                                                                                                Music                     5.14    367709.56        1.5555\n5   AAAAAAAAKHDDAAAA                                                                                                              Entire, related interests obtain typically. Narrow patients       Music                      NaN    314812.84        1.3317\n6   AAAAAAAAEBPOBAAA                                                           Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                      NaN    334919.14        1.4168\n7   AAAAAAAAHOEPAAAA                                     Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN    350848.34        1.4842\n8   AAAAAAAAIEKFEAAA                                                                          Artistic arrangements obtain anyway completely bad issues. Careful, full processes exist like a       Music                      NaN    336104.23        1.4218\n9   AAAAAAAAGPCIEAAA                                                                                                                                                                                Music                     2.42    322602.15        1.3647\n10  AAAAAAAACPCLBAAA                                                                                                                                                                                Shoes                      NaN    355712.22        1.5047\n11  AAAAAAAAGPDBDAAA                                                                                                                                                                                  Men                      NaN    346070.92        1.4640\n12  AAAAAAAAALEEBAAA                                                                                                                          Later left spirits must not upgrade certainly as      Music                     4.87    349031.96        1.4765\n13  AAAAAAAAPHCHAAAA                                                                                                                                                                                  Men                      NaN    312211.94        1.3207\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.490641,
                    "execution_time": 0.429332,
                    "compile_time": 0.000305,
                    "planning_time": 0.042852
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.490748,
                    "execution_time": 0.433486,
                    "compile_time": 0.0003,
                    "planning_time": 0.039653
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAOGDMAAAA                                                                                                                                                                                Music                     9.32    340420.37        1.4400\n1   AAAAAAAAKOHOBAAA                                                                                                                                                                                  Men                      NaN    388770.14        1.6446\n2   AAAAAAAACNCCEAAA                                                                                                                                                                                  Men                     3.50    303953.33        1.2858\n3   AAAAAAAAPPNFEAAA                                                                                                                                                                                Music                     6.96    339736.94        1.4372\n4   AAAAAAAAJMGKDAAA                                                                                                                                                                                Music                     5.14    367709.56        1.5555\n5   AAAAAAAAKHDDAAAA                                                                                                              Entire, related interests obtain typically. Narrow patients       Music                      NaN    314812.84        1.3317\n6   AAAAAAAAEBPOBAAA                                                           Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                      NaN    334919.14        1.4168\n7   AAAAAAAAHOEPAAAA                                     Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN    350848.34        1.4842\n8   AAAAAAAAIEKFEAAA                                                                          Artistic arrangements obtain anyway completely bad issues. Careful, full processes exist like a       Music                      NaN    336104.23        1.4218\n9   AAAAAAAAGPCIEAAA                                                                                                                                                                                Music                     2.42    322602.15        1.3647\n10  AAAAAAAACPCLBAAA                                                                                                                                                                                Shoes                      NaN    355712.22        1.5047\n11  AAAAAAAAGPDBDAAA                                                                                                                                                                                  Men                      NaN    346070.92        1.4640\n12  AAAAAAAAALEEBAAA                                                                                                                          Later left spirits must not upgrade certainly as      Music                     4.87    349031.96        1.4765\n13  AAAAAAAAPHCHAAAA                                                                                                                                                                                  Men                      NaN    312211.94        1.3207\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                       i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAANEHEAAA  Main, early ages shall give later now large funds; as certain accounts might decide narrowly then good decades; british, right questions make ju        Men                     7.51    336900.62        1.4252\n1   AAAAAAAAAGOEEAAA                                                                                                                                                        Shoes                      NaN    397117.11        1.6799\n2   AAAAAAAAKKIFBAAA                                                                                                                                                          Men                      NaN    329138.04        1.3923\n3   AAAAAAAADJBFBAAA                                                  Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN    411392.07        1.7403\n4   AAAAAAAAHNGNBAAA                                                                                                                                                        Music                      NaN    312853.89        1.3234\n5   AAAAAAAAAMLDAAAA                                                                                                                                                          Men                      NaN    360327.67        1.5243\n6   AAAAAAAAINOIEAAA                              Southern, widespread rumours might not benefit clean, entire plates; new, back contacts return however traditional s      Music                      NaN    450739.81        1.9067\n7   AAAAAAAAHOEPAAAA             Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN    350848.34        1.4842\n8   AAAAAAAAPPNFEAAA                                                                                                                                                        Music                     6.96    339736.94        1.4372\n9   AAAAAAAAAPLHCAAA                     Dead good regions should remain then other cheeks; alternative, remarkable arguments care more awful, extensive clients. Tech      Music                    30.30    334719.68        1.4159\n10  AAAAAAAAOGDMAAAA                                                                                                                                                        Music                     9.32    340420.37        1.4400\n11  AAAAAAAAIDAGCAAA                                                                                                                                                        Music                    43.87    356281.29        1.5071\n12  AAAAAAAAEBPOBAAA                                   Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                      NaN    334919.14        1.4168\n13  AAAAAAAAHPIEDAAA                                                                                                                           Spiritual comments woul      Music                      NaN    358330.62        1.5158\n14  AAAAAAAAKOHOBAAA                                                                                                                                                          Men                      NaN    388770.14        1.6446\n15  AAAAAAAACNCCEAAA                                                                                                                                                          Men                     3.50    303953.33        1.2858\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.484501,
                    "execution_time": 0.423591,
                    "compile_time": 0.000323,
                    "planning_time": 0.042655
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.485837,
                    "execution_time": 0.427964,
                    "compile_time": 0.000303,
                    "planning_time": 0.040005
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                       i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAANEHEAAA  Main, early ages shall give later now large funds; as certain accounts might decide narrowly then good decades; british, right questions make ju        Men                     7.51    336900.62        1.4252\n1   AAAAAAAAAGOEEAAA                                                                                                                                                        Shoes                      NaN    397117.11        1.6799\n2   AAAAAAAAKKIFBAAA                                                                                                                                                          Men                      NaN    329138.04        1.3923\n3   AAAAAAAADJBFBAAA                                                  Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN    411392.07        1.7403\n4   AAAAAAAAHNGNBAAA                                                                                                                                                        Music                      NaN    312853.89        1.3234\n5   AAAAAAAAAMLDAAAA                                                                                                                                                          Men                      NaN    360327.67        1.5243\n6   AAAAAAAAINOIEAAA                              Southern, widespread rumours might not benefit clean, entire plates; new, back contacts return however traditional s      Music                      NaN    450739.81        1.9067\n7   AAAAAAAAHOEPAAAA             Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN    350848.34        1.4842\n8   AAAAAAAAPPNFEAAA                                                                                                                                                        Music                     6.96    339736.94        1.4372\n9   AAAAAAAAAPLHCAAA                     Dead good regions should remain then other cheeks; alternative, remarkable arguments care more awful, extensive clients. Tech      Music                    30.30    334719.68        1.4159\n10  AAAAAAAAOGDMAAAA                                                                                                                                                        Music                     9.32    340420.37        1.4400\n11  AAAAAAAAIDAGCAAA                                                                                                                                                        Music                    43.87    356281.29        1.5071\n12  AAAAAAAAEBPOBAAA                                   Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                      NaN    334919.14        1.4168\n13  AAAAAAAAHPIEDAAA                                                                                                                           Spiritual comments woul      Music                      NaN    358330.62        1.5158\n14  AAAAAAAAKOHOBAAA                                                                                                                                                          Men                      NaN    388770.14        1.6446\n15  AAAAAAAACNCCEAAA                                                                                                                                                          Men                     3.50    303953.33        1.2858\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\""
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAANEHEAAA                          Main, early ages shall give later now large funds; as certain accounts might decide narrowly then good decades; british, right questions make ju        Men                     7.51    336900.62        1.4252\n1   AAAAAAAAEBPOBAAA                                                           Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                      NaN    334919.14        1.4168\n2   AAAAAAAAHNGNBAAA                                                                                                                                                                                Music                      NaN    312853.89        1.3234\n3   AAAAAAAAHOEPAAAA                                     Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN    350848.34        1.4842\n4   AAAAAAAAAGOEEAAA                                                                                                                                                                                Shoes                      NaN    397117.11        1.6799\n5   AAAAAAAADJBFBAAA                                                                          Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN    411392.07        1.7403\n6   AAAAAAAAJMGKDAAA                                                                                                                                                                                Music                     5.14    367709.56        1.5555\n7   AAAAAAAAIDAGCAAA                                                                                                                                                                                Music                    43.87    356281.29        1.5071\n8   AAAAAAAAALEEBAAA                                                                                                                          Later left spirits must not upgrade certainly as      Music                     4.87    349031.96        1.4765\n9   AAAAAAAAPHCHAAAA                                                                                                                                                                                  Men                      NaN    312211.94        1.3207\n10  AAAAAAAAHPIEDAAA                                                                                                                                                   Spiritual comments woul      Music                      NaN    358330.62        1.5158\n11  AAAAAAAAIEKFEAAA                                                                          Artistic arrangements obtain anyway completely bad issues. Careful, full processes exist like a       Music                      NaN    336104.23        1.4218\n12  AAAAAAAAFLPIBAAA                   Wide, chinese conditions used to ensure afterwards thinking, only conclusions. Good, new processes could not stay newly new limitations. Feelings will       Shoes                     1.56    346228.41        1.4646\n13  AAAAAAAAAMLDAAAA                                                                                                                                                                                  Men                      NaN    360327.67        1.5243\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.485531,
                    "execution_time": 0.426824,
                    "compile_time": 0.000305,
                    "planning_time": 0.041067
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.481508,
                    "execution_time": 0.422707,
                    "compile_time": 0.000308,
                    "planning_time": 0.040799
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\"",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAANEHEAAA                          Main, early ages shall give later now large funds; as certain accounts might decide narrowly then good decades; british, right questions make ju        Men                     7.51    336900.62        1.4252\n1   AAAAAAAAEBPOBAAA                                                           Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                      NaN    334919.14        1.4168\n2   AAAAAAAAHNGNBAAA                                                                                                                                                                                Music                      NaN    312853.89        1.3234\n3   AAAAAAAAHOEPAAAA                                     Civil others tell in the roles. Easy letters might come by a types; tender police could go obviously still cultural applications; add      Music                      NaN    350848.34        1.4842\n4   AAAAAAAAAGOEEAAA                                                                                                                                                                                Shoes                      NaN    397117.11        1.6799\n5   AAAAAAAADJBFBAAA                                                                          Annual applications know even months. Forward schemes call major courts; regulations lose better      Shoes                      NaN    411392.07        1.7403\n6   AAAAAAAAJMGKDAAA                                                                                                                                                                                Music                     5.14    367709.56        1.5555\n7   AAAAAAAAIDAGCAAA                                                                                                                                                                                Music                    43.87    356281.29        1.5071\n8   AAAAAAAAALEEBAAA                                                                                                                          Later left spirits must not upgrade certainly as      Music                     4.87    349031.96        1.4765\n9   AAAAAAAAPHCHAAAA                                                                                                                                                                                  Men                      NaN    312211.94        1.3207\n10  AAAAAAAAHPIEDAAA                                                                                                                                                   Spiritual comments woul      Music                      NaN    358330.62        1.5158\n11  AAAAAAAAIEKFEAAA                                                                          Artistic arrangements obtain anyway completely bad issues. Careful, full processes exist like a       Music                      NaN    336104.23        1.4218\n12  AAAAAAAAFLPIBAAA                   Wide, chinese conditions used to ensure afterwards thinking, only conclusions. Good, new processes could not stay newly new limitations. Feelings will       Shoes                     1.56    346228.41        1.4646\n13  AAAAAAAAAMLDAAAA                                                                                                                                                                                  Men                      NaN    360327.67        1.5243\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n    i_item_id /*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_ITEM_ID NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                           i_item_desc i_category         i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAAAABAAA           Outside waste minutes make for a men. Grand, suitable citizens raise merely within the officials. Minutes may not represent in part with a officials. Old, social resources may not catch r        Men          shirts             7.87    338109.77        0.0263\n1   AAAAAAAAAAADBAAA                         Always video-taped parties talk recently junior students. Special, principal cases hurt. Exciting results mean then following circumstances. Payments can fail much with a sy      Shoes        athletic             3.23    241241.76        0.0192\n2   AAAAAAAAAAAEBAAA                                                                                                                                                Industrial, free movies add more; contributions explai        Men          shirts             5.93    295754.44        0.0230\n3   AAAAAAAAAAAGBAAA                             Oddly social creditors could become twice supposed original writers. Members play there. For instance electoral firms will not understand too literary, underlying prices        Men           pants             4.88    287729.37        0.0238\n4   AAAAAAAAAAAGEAAA                           Partly administrative gardens pass easily drivers. Close buildings state also with a tears. Only imperial products ensure. Distinctly present charges shall not invoke. Una      Music             pop             0.73    307125.95        0.0246\n5   AAAAAAAAAAALAAAA                                                                                                                                                 Now major examples show. Products would not lobby the      Shoes          womens             1.66    337738.64        0.0265\n6   AAAAAAAAAAAMCAAA                                                                                             Guilty aspects talk only, only devices. Effective, nice quantities may not cut usually just new committee      Shoes            kids             0.30    327689.48        0.0259\n7   AAAAAAAAAAAPBAAA                                                                                                                                                    Massive regulations lead meanwhile possible citize      Music       classical             2.86    320865.25        0.0252\n8   AAAAAAAAAABBAAAA                                                                                                                                                                                       Recent discussi      Music         country             5.37    362272.81        0.0291\n9   AAAAAAAAAABBCAAA                                                                                                          Even old spirits might give. Dark, powerful conditions used to emerge rich, alone cities. Th        Men          shirts             1.75    344463.59        0.0268\n10  AAAAAAAAAABCCAAA  Women carry soviet players. Monthly, new lists could scream particularly practices. Political police eliminate legal, key enterprises. Good, new losses might not allow outside a articles. New, sha        Men  sports-apparel             4.98    350643.61        0.0279\n11  AAAAAAAAAABDAAAA                                                                                                    Extended, central centuries ought to predict thus early controls; so financial years shall not see        Men  sports-apparel             1.36    326556.67        0.0259\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.9388,
                    "execution_time": 0.880702,
                    "compile_time": 0.000333,
                    "planning_time": 0.040688
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.969832,
                    "execution_time": 0.843178,
                    "compile_time": 0.124333,
                    "planning_time": 0.107929
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_ITEM_ID\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                           i_item_desc i_category         i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAAAAABAAA           Outside waste minutes make for a men. Grand, suitable citizens raise merely within the officials. Minutes may not represent in part with a officials. Old, social resources may not catch r        Men          shirts             7.87    338109.77        0.0263\n1   AAAAAAAAAAADBAAA                         Always video-taped parties talk recently junior students. Special, principal cases hurt. Exciting results mean then following circumstances. Payments can fail much with a sy      Shoes        athletic             3.23    241241.76        0.0192\n2   AAAAAAAAAAAEBAAA                                                                                                                                                Industrial, free movies add more; contributions explai        Men          shirts             5.93    295754.44        0.0230\n3   AAAAAAAAAAAGBAAA                             Oddly social creditors could become twice supposed original writers. Members play there. For instance electoral firms will not understand too literary, underlying prices        Men           pants             4.88    287729.37        0.0238\n4   AAAAAAAAAAAGEAAA                           Partly administrative gardens pass easily drivers. Close buildings state also with a tears. Only imperial products ensure. Distinctly present charges shall not invoke. Una      Music             pop             0.73    307125.95        0.0246\n5   AAAAAAAAAAALAAAA                                                                                                                                                 Now major examples show. Products would not lobby the      Shoes          womens             1.66    337738.64        0.0265\n6   AAAAAAAAAAAMCAAA                                                                                             Guilty aspects talk only, only devices. Effective, nice quantities may not cut usually just new committee      Shoes            kids             0.30    327689.48        0.0259\n7   AAAAAAAAAAAPBAAA                                                                                                                                                    Massive regulations lead meanwhile possible citize      Music       classical             2.86    320865.25        0.0252\n8   AAAAAAAAAABBAAAA                                                                                                                                                                                       Recent discussi      Music         country             5.37    362272.81        0.0291\n9   AAAAAAAAAABBCAAA                                                                                                          Even old spirits might give. Dark, powerful conditions used to emerge rich, alone cities. Th        Men          shirts             1.75    344463.59        0.0268\n10  AAAAAAAAAABCCAAA  Women carry soviet players. Monthly, new lists could scream particularly practices. Political police eliminate legal, key enterprises. Good, new losses might not allow outside a articles. New, sha        Men  sports-apparel             4.98    350643.61        0.0279\n11  AAAAAAAAAABDAAAA                                                                                                    Extended, central centuries ought to predict thus early controls; so financial years shall not see        Men  sports-apparel             1.36    326556.67        0.0259\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                                                               i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGOCEDAAA                                                                                                                                               Available ages can get tentatively. Northern cases can spea        Men  accessories             6.05    302536.45        0.0236\n1   AAAAAAAAIIAAEAAA                                                                     Buildings run over the materials. Major difficulties bear bedrooms. Just late horses put ordinarily now complete months. Institutions        Men        pants             0.79    336847.70        0.0278\n2   AAAAAAAAKLJBDAAA                           Years close ahead high points. Kinds take short years. Arts should not expect further very small securities. Great years will bring right completely american panels. Aims bear        Men  accessories             1.25    376625.70        0.0294\n3   AAAAAAAAJIPCDAAA                               Special, electrical banks would not conform perfect results. Elements sound physical sides. Technical, major areas welcome. Biological, forward facilities assert well annu        Men        pants             1.66    276831.06        0.0229\n4   AAAAAAAAEEJNBAAA                                                                                                    Important, general fees can grow then future, economic economies. Then actual approaches mean always i        Men  accessories             4.07    265094.01        0.0206\n5   AAAAAAAACDHDCAAA                                                                                                                                    Problems would weigh well. Marks meet. Similar groups help absolutely         Men        pants             0.80    396593.40        0.0328\n6   AAAAAAAAABDDBAAA  Capable, domestic periods shall find for instance poor eyes. Largely weak strengths grieve british ministers. Nowhere new processes win just total, living members. Pictures flash centres. Feet change.        Men  accessories             4.80    353072.69        0.0275\n7   AAAAAAAAEAFABAAA                      Hands ought to assess physical, assistant women. Hard, necessary windows mean likely discussions. Literary conditions vary cold, ruling areas. Judges shall produce constantly conte        Men        pants             3.37    397344.00        0.0329\n8   AAAAAAAAOJEEBAAA                                          Important views would compare better local boys. Interests would establish as usual. Major appeals let villages; firms find then; even civil sections focus ther        Men  accessories             1.92    364964.66        0.0284\n9   AAAAAAAAMMMHBAAA                                                                                Degrees let confident, sudden premises. Unique topics cannot find. Securities try just various characters. Others should s        Men        pants            96.67    295129.72        0.0244\n10  AAAAAAAAAMFPDAAA                                                                                                                                     Regulations think always still live minutes. Major, international cou        Men  accessories             4.64    301518.90        0.0235\n11  AAAAAAAAMJFPAAAA                                                                                                                                 Moving actions ought to get by a factors. Hard, reliable risks may not co        Men        pants             4.27    317432.27        0.0262\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.882751,
                    "execution_time": 0.823645,
                    "compile_time": 0.000367,
                    "planning_time": 0.041177
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.981662,
                    "execution_time": 0.857073,
                    "compile_time": 0.000361,
                    "planning_time": 0.106589
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                                                               i_item_desc i_category      i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAGOCEDAAA                                                                                                                                               Available ages can get tentatively. Northern cases can spea        Men  accessories             6.05    302536.45        0.0236\n1   AAAAAAAAIIAAEAAA                                                                     Buildings run over the materials. Major difficulties bear bedrooms. Just late horses put ordinarily now complete months. Institutions        Men        pants             0.79    336847.70        0.0278\n2   AAAAAAAAKLJBDAAA                           Years close ahead high points. Kinds take short years. Arts should not expect further very small securities. Great years will bring right completely american panels. Aims bear        Men  accessories             1.25    376625.70        0.0294\n3   AAAAAAAAJIPCDAAA                               Special, electrical banks would not conform perfect results. Elements sound physical sides. Technical, major areas welcome. Biological, forward facilities assert well annu        Men        pants             1.66    276831.06        0.0229\n4   AAAAAAAAEEJNBAAA                                                                                                    Important, general fees can grow then future, economic economies. Then actual approaches mean always i        Men  accessories             4.07    265094.01        0.0206\n5   AAAAAAAACDHDCAAA                                                                                                                                    Problems would weigh well. Marks meet. Similar groups help absolutely         Men        pants             0.80    396593.40        0.0328\n6   AAAAAAAAABDDBAAA  Capable, domestic periods shall find for instance poor eyes. Largely weak strengths grieve british ministers. Nowhere new processes win just total, living members. Pictures flash centres. Feet change.        Men  accessories             4.80    353072.69        0.0275\n7   AAAAAAAAEAFABAAA                      Hands ought to assess physical, assistant women. Hard, necessary windows mean likely discussions. Literary conditions vary cold, ruling areas. Judges shall produce constantly conte        Men        pants             3.37    397344.00        0.0329\n8   AAAAAAAAOJEEBAAA                                          Important views would compare better local boys. Interests would establish as usual. Major appeals let villages; firms find then; even civil sections focus ther        Men  accessories             1.92    364964.66        0.0284\n9   AAAAAAAAMMMHBAAA                                                                                Degrees let confident, sudden premises. Unique topics cannot find. Securities try just various characters. Others should s        Men        pants            96.67    295129.72        0.0244\n10  AAAAAAAAAMFPDAAA                                                                                                                                     Regulations think always still live minutes. Major, international cou        Men  accessories             4.64    301518.90        0.0235\n11  AAAAAAAAMJFPAAAA                                                                                                                                 Moving actions ought to get by a factors. Hard, reliable risks may not co        Men        pants             4.27    317432.27        0.0262\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAHFKFEAAA  Models can enjoy just social, public fingers. Black, good departments might mean clearly to a windows. Fortunate, unusual defendants struggle farmers; schools talk part        Men                     2.46    357230.66        1.5112\n1   AAAAAAAAFAKKDAAA                                                                                                                                                                  Consider        Men                      NaN    318292.17        1.3464\n2   AAAAAAAAPBHACAAA                               National values like thereby electrical families; civil arms ought to feel combined, natural industries. Terrible activities will give prov        Men                     0.52    348714.03        1.4751\n3   AAAAAAAAJJAKDAAA                                                                                                                                                                Of course         Men                     6.19    303343.36        1.2832\n4   AAAAAAAAABLKAAAA                 Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43    370269.72        1.5663\n5   AAAAAAAACNCCEAAA                                                                                                                                                                                  Men                     3.50    303953.33        1.2858\n6   AAAAAAAAGPDBDAAA                                                                                                                                                                                  Men                      NaN    346070.92        1.4640\n7   AAAAAAAAEBPOBAAA                                                           Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                      NaN    334919.14        1.4168\n8   AAAAAAAAEGEFAAAA                  Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN    386915.62        1.6367\n9   AAAAAAAAMKHLDAAA                                                                                                                                                                                  Men                      NaN    348380.36        1.4737\n10  AAAAAAAAEOEIBAAA                                                                                                                                                            Total, very fo        Men                    12.72    302416.95        1.2793\n11  AAAAAAAAGIGEBAAA                                                                                                                                                               At least sm        Men                      NaN    293152.89        1.2401\n12  AAAAAAAANBDPCAAA                                                                                                                                                                                  Men                      NaN    339447.80        1.4359\n13  AAAAAAAAPHCHAAAA                                                                                                                                                                                  Men                      NaN    312211.94        1.3207\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.890801,
                    "execution_time": 0.830809,
                    "compile_time": 0.000338,
                    "planning_time": 0.042283
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.921517,
                    "execution_time": 0.792646,
                    "compile_time": 0.000353,
                    "planning_time": 0.110756
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAHFKFEAAA  Models can enjoy just social, public fingers. Black, good departments might mean clearly to a windows. Fortunate, unusual defendants struggle farmers; schools talk part        Men                     2.46    357230.66        1.5112\n1   AAAAAAAAFAKKDAAA                                                                                                                                                                  Consider        Men                      NaN    318292.17        1.3464\n2   AAAAAAAAPBHACAAA                               National values like thereby electrical families; civil arms ought to feel combined, natural industries. Terrible activities will give prov        Men                     0.52    348714.03        1.4751\n3   AAAAAAAAJJAKDAAA                                                                                                                                                                Of course         Men                     6.19    303343.36        1.2832\n4   AAAAAAAAABLKAAAA                 Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43    370269.72        1.5663\n5   AAAAAAAACNCCEAAA                                                                                                                                                                                  Men                     3.50    303953.33        1.2858\n6   AAAAAAAAGPDBDAAA                                                                                                                                                                                  Men                      NaN    346070.92        1.4640\n7   AAAAAAAAEBPOBAAA                                                           Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                      NaN    334919.14        1.4168\n8   AAAAAAAAEGEFAAAA                  Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN    386915.62        1.6367\n9   AAAAAAAAMKHLDAAA                                                                                                                                                                                  Men                      NaN    348380.36        1.4737\n10  AAAAAAAAEOEIBAAA                                                                                                                                                            Total, very fo        Men                    12.72    302416.95        1.2793\n11  AAAAAAAAGIGEBAAA                                                                                                                                                               At least sm        Men                      NaN    293152.89        1.2401\n12  AAAAAAAANBDPCAAA                                                                                                                                                                                  Men                      NaN    339447.80        1.4359\n13  AAAAAAAAPHCHAAAA                                                                                                                                                                                  Men                      NaN    312211.94        1.3207\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                 Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43    370269.72        1.5663\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                  Men                      NaN    360327.67        1.5243\n2   AAAAAAAAANEHEAAA                          Main, early ages shall give later now large funds; as certain accounts might decide narrowly then good decades; british, right questions make ju        Men                     7.51    336900.62        1.4252\n3   AAAAAAAACNCCEAAA                                                                                                                                                                                  Men                     3.50    303953.33        1.2858\n4   AAAAAAAAEBPOBAAA                                                           Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                      NaN    334919.14        1.4168\n5   AAAAAAAAEGEFAAAA                  Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN    386915.62        1.6367\n6   AAAAAAAAEOEIBAAA                                                                                                                                                            Total, very fo        Men                    12.72    302416.95        1.2793\n7   AAAAAAAAFAKKDAAA                                                                                                                                                                  Consider        Men                      NaN    318292.17        1.3464\n8   AAAAAAAAGIGEBAAA                                                                                                                                                               At least sm        Men                      NaN    293152.89        1.2401\n9   AAAAAAAAGKCHDAAA                                                                                                                                                                                  Men                     2.89    303819.22        1.2852\n10  AAAAAAAAGPDBDAAA                                                                                                                                                                                  Men                      NaN    346070.92        1.4640\n11  AAAAAAAAHFKFEAAA  Models can enjoy just social, public fingers. Black, good departments might mean clearly to a windows. Fortunate, unusual defendants struggle farmers; schools talk part        Men                     2.46    357230.66        1.5112\n12  AAAAAAAAJJAKDAAA                                                                                                                                                                Of course         Men                     6.19    303343.36        1.2832\n13  AAAAAAAAKADJEAAA                                                                                                                                                                                  Men                      NaN    320003.91        1.3537\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.889587,
                    "execution_time": 0.828504,
                    "compile_time": 0.000352,
                    "planning_time": 0.042941
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.967515,
                    "execution_time": 0.828131,
                    "compile_time": 0.00039,
                    "planning_time": 0.121286
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                 Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43    370269.72        1.5663\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                  Men                      NaN    360327.67        1.5243\n2   AAAAAAAAANEHEAAA                          Main, early ages shall give later now large funds; as certain accounts might decide narrowly then good decades; british, right questions make ju        Men                     7.51    336900.62        1.4252\n3   AAAAAAAACNCCEAAA                                                                                                                                                                                  Men                     3.50    303953.33        1.2858\n4   AAAAAAAAEBPOBAAA                                                           Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                      NaN    334919.14        1.4168\n5   AAAAAAAAEGEFAAAA                  Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN    386915.62        1.6367\n6   AAAAAAAAEOEIBAAA                                                                                                                                                            Total, very fo        Men                    12.72    302416.95        1.2793\n7   AAAAAAAAFAKKDAAA                                                                                                                                                                  Consider        Men                      NaN    318292.17        1.3464\n8   AAAAAAAAGIGEBAAA                                                                                                                                                               At least sm        Men                      NaN    293152.89        1.2401\n9   AAAAAAAAGKCHDAAA                                                                                                                                                                                  Men                     2.89    303819.22        1.2852\n10  AAAAAAAAGPDBDAAA                                                                                                                                                                                  Men                      NaN    346070.92        1.4640\n11  AAAAAAAAHFKFEAAA  Models can enjoy just social, public fingers. Black, good departments might mean clearly to a windows. Fortunate, unusual defendants struggle farmers; schools talk part        Men                     2.46    357230.66        1.5112\n12  AAAAAAAAJJAKDAAA                                                                                                                                                                Of course         Men                     6.19    303343.36        1.2832\n13  AAAAAAAAKADJEAAA                                                                                                                                                                                  Men                      NaN    320003.91        1.3537\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                 Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43    370269.72        1.5663\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                  Men                      NaN    360327.67        1.5243\n2   AAAAAAAAANEHEAAA                          Main, early ages shall give later now large funds; as certain accounts might decide narrowly then good decades; british, right questions make ju        Men                     7.51    336900.62        1.4252\n3   AAAAAAAACNCCEAAA                                                                                                                                                                                  Men                     3.50    303953.33        1.2858\n4   AAAAAAAAEBPOBAAA                                                           Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                      NaN    334919.14        1.4168\n5   AAAAAAAAEGEFAAAA                  Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN    386915.62        1.6367\n6   AAAAAAAAEOEIBAAA                                                                                                                                                            Total, very fo        Men                    12.72    302416.95        1.2793\n7   AAAAAAAAFAKKDAAA                                                                                                                                                                  Consider        Men                      NaN    318292.17        1.3464\n8   AAAAAAAAGIGEBAAA                                                                                                                                                               At least sm        Men                      NaN    293152.89        1.2401\n9   AAAAAAAAGKCHDAAA                                                                                                                                                                                  Men                     2.89    303819.22        1.2852\n10  AAAAAAAAGPDBDAAA                                                                                                                                                                                  Men                      NaN    346070.92        1.4640\n11  AAAAAAAAHFKFEAAA  Models can enjoy just social, public fingers. Black, good departments might mean clearly to a windows. Fortunate, unusual defendants struggle farmers; schools talk part        Men                     2.46    357230.66        1.5112\n12  AAAAAAAAJJAKDAAA                                                                                                                                                                Of course         Men                     6.19    303343.36        1.2832\n13  AAAAAAAAKADJEAAA                                                                                                                                                                                  Men                      NaN    320003.91        1.3537\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.498073,
                    "execution_time": 0.427291,
                    "compile_time": 0.000356,
                    "planning_time": 0.041639
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.968232,
                    "execution_time": 0.844132,
                    "compile_time": 0.000365,
                    "planning_time": 0.105983
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                 Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43    370269.72        1.5663\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                  Men                      NaN    360327.67        1.5243\n2   AAAAAAAAANEHEAAA                          Main, early ages shall give later now large funds; as certain accounts might decide narrowly then good decades; british, right questions make ju        Men                     7.51    336900.62        1.4252\n3   AAAAAAAACNCCEAAA                                                                                                                                                                                  Men                     3.50    303953.33        1.2858\n4   AAAAAAAAEBPOBAAA                                                           Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                      NaN    334919.14        1.4168\n5   AAAAAAAAEGEFAAAA                  Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN    386915.62        1.6367\n6   AAAAAAAAEOEIBAAA                                                                                                                                                            Total, very fo        Men                    12.72    302416.95        1.2793\n7   AAAAAAAAFAKKDAAA                                                                                                                                                                  Consider        Men                      NaN    318292.17        1.3464\n8   AAAAAAAAGIGEBAAA                                                                                                                                                               At least sm        Men                      NaN    293152.89        1.2401\n9   AAAAAAAAGKCHDAAA                                                                                                                                                                                  Men                     2.89    303819.22        1.2852\n10  AAAAAAAAGPDBDAAA                                                                                                                                                                                  Men                      NaN    346070.92        1.4640\n11  AAAAAAAAHFKFEAAA  Models can enjoy just social, public fingers. Black, good departments might mean clearly to a windows. Fortunate, unusual defendants struggle farmers; schools talk part        Men                     2.46    357230.66        1.5112\n12  AAAAAAAAJJAKDAAA                                                                                                                                                                Of course         Men                     6.19    303343.36        1.2832\n13  AAAAAAAAKADJEAAA                                                                                                                                                                                  Men                      NaN    320003.91        1.3537\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n        ,revenueratio\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST , \"REVENUERATIO\" NULLS LAST"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST , REVENUERATIO NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                 Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43    370269.72        1.5663\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                  Men                      NaN    360327.67        1.5243\n2   AAAAAAAAANEHEAAA                          Main, early ages shall give later now large funds; as certain accounts might decide narrowly then good decades; british, right questions make ju        Men                     7.51    336900.62        1.4252\n3   AAAAAAAACNCCEAAA                                                                                                                                                                                  Men                     3.50    303953.33        1.2858\n4   AAAAAAAAEBPOBAAA                                                           Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                      NaN    334919.14        1.4168\n5   AAAAAAAAEGEFAAAA                  Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN    386915.62        1.6367\n6   AAAAAAAAEOEIBAAA                                                                                                                                                            Total, very fo        Men                    12.72    302416.95        1.2793\n7   AAAAAAAAFAKKDAAA                                                                                                                                                                  Consider        Men                      NaN    318292.17        1.3464\n8   AAAAAAAAGIGEBAAA                                                                                                                                                               At least sm        Men                      NaN    293152.89        1.2401\n9   AAAAAAAAGKCHDAAA                                                                                                                                                                                  Men                     2.89    303819.22        1.2852\n10  AAAAAAAAGPDBDAAA                                                                                                                                                                                  Men                      NaN    346070.92        1.4640\n11  AAAAAAAAHFKFEAAA  Models can enjoy just social, public fingers. Black, good departments might mean clearly to a windows. Fortunate, unusual defendants struggle farmers; schools talk part        Men                     2.46    357230.66        1.5112\n12  AAAAAAAAJJAKDAAA                                                                                                                                                                Of course         Men                     6.19    303343.36        1.2832\n13  AAAAAAAAKADJEAAA                                                                                                                                                                                  Men                      NaN    320003.91        1.3537\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.493471,
                    "execution_time": 0.431526,
                    "compile_time": 0.000352,
                    "planning_time": 0.043496
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.856091,
                    "execution_time": 0.439401,
                    "compile_time": 0.289697,
                    "planning_time": 0.107764
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST, \"REVENUERATIO\" NULLS LAST",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                 Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43    370269.72        1.5663\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                  Men                      NaN    360327.67        1.5243\n2   AAAAAAAAANEHEAAA                          Main, early ages shall give later now large funds; as certain accounts might decide narrowly then good decades; british, right questions make ju        Men                     7.51    336900.62        1.4252\n3   AAAAAAAACNCCEAAA                                                                                                                                                                                  Men                     3.50    303953.33        1.2858\n4   AAAAAAAAEBPOBAAA                                                           Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                      NaN    334919.14        1.4168\n5   AAAAAAAAEGEFAAAA                  Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN    386915.62        1.6367\n6   AAAAAAAAEOEIBAAA                                                                                                                                                            Total, very fo        Men                    12.72    302416.95        1.2793\n7   AAAAAAAAFAKKDAAA                                                                                                                                                                  Consider        Men                      NaN    318292.17        1.3464\n8   AAAAAAAAGIGEBAAA                                                                                                                                                               At least sm        Men                      NaN    293152.89        1.2401\n9   AAAAAAAAGKCHDAAA                                                                                                                                                                                  Men                     2.89    303819.22        1.2852\n10  AAAAAAAAGPDBDAAA                                                                                                                                                                                  Men                      NaN    346070.92        1.4640\n11  AAAAAAAAHFKFEAAA  Models can enjoy just social, public fingers. Black, good departments might mean clearly to a windows. Fortunate, unusual defendants struggle farmers; schools talk part        Men                     2.46    357230.66        1.5112\n12  AAAAAAAAJJAKDAAA                                                                                                                                                                Of course         Men                     6.19    303343.36        1.2832\n13  AAAAAAAAKADJEAAA                                                                                                                                                                                  Men                      NaN    320003.91        1.3537\n...*/"
    },
    {
        "input": "-- start template query98.tpl query 32 in stream 0\nselect /* TPC-DS query98.tpl 0.32 */ i_item_id\n      ,i_item_desc \n      ,i_category \n      ,i_class \n      ,i_current_price\n      ,sum(ss_ext_sales_price) as itemrevenue \n      ,sum(ss_ext_sales_price)*100/sum(sum(ss_ext_sales_price)) over\n          (partition by i_class) as revenueratio\nfrom\t\n\tstore_sales\n    \t,item \n    \t,date_dim\nwhere \n\tss_item_sk = i_item_sk \n  \tand i_category in ('Men', 'Music', 'Shoes')\n  \tand ss_sold_date_sk = d_date_sk\n\tand d_date between cast('2001-03-17' as date) \n\t\t\t\tand dateadd(day,30,cast('2001-03-17' as date))\ngroup by \n\ti_item_id\n        ,i_item_desc \n        ,i_category\n        ,i_class\n        ,i_current_price\norder by \n\ti_category\n        ,i_class\n        ,i_item_id\n        ,i_item_desc\n        ,revenueratio\nlimit 100\n/*CURSOR_IDENTIFIER*/",
        "optimize": [
            "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" AS \"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) AS \"ITEMREVENUE\" , SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) * 100 / SUM ( SUM ( \"STORE_SALES\".\"SS_EXT_SALES_PRICE\" ) ) OVER ( PARTITION BY \"ITEM\".\"I_CLASS\" ) AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD ( 'DAY' , 30 , DAY , TIMESTAMP ) AND \"DATE_DIM\".\"D_DATE\" >= CAST ( '2001-03-17' AS DATE ) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ( 'Men' , 'Music' , 'Shoes' ) AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\" , \"ITEM\".\"I_ITEM_DESC\" , \"ITEM\".\"I_CATEGORY\" , \"ITEM\".\"I_CLASS\" , \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST , \"I_CLASS\" NULLS LAST , \"I_ITEM_ID\" NULLS LAST , \"I_ITEM_DESC\" NULLS LAST , \"REVENUERATIO\" NULLS LAST LIMIT 100"
        ],
        "create": null,
        "query": [
            {
                "query": "SELECT I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE , SUM ( SS_EXT_SALES_PRICE ) AS ITEMREVENUE , SUM ( SS_EXT_SALES_PRICE ) * 100 / SUM ( SUM ( SS_EXT_SALES_PRICE ) ) OVER ( PARTITION BY I_CLASS ) AS REVENUERATIO FROM STORE_SALES , ITEM , DATE_DIM WHERE SS_ITEM_SK = I_ITEM_SK AND I_CATEGORY IN ( 'Men' , 'Music' , 'Shoes' ) AND SS_SOLD_DATE_SK = D_DATE_SK AND D_DATE BETWEEN CAST ( '2001-03-17' AS DATE ) AND DATEADD ( DAY , 30 , CAST ( '2001-03-17' AS DATE ) ) GROUP BY I_ITEM_ID , I_ITEM_DESC , I_CATEGORY , I_CLASS , I_CURRENT_PRICE ORDER BY I_CATEGORY NULLS FIRST , I_CLASS NULLS FIRST , I_ITEM_ID NULLS FIRST , I_ITEM_DESC NULLS FIRST , REVENUERATIO NULLS FIRST LIMIT 21",
                "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                 Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43    370269.72        1.5663\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                  Men                      NaN    360327.67        1.5243\n2   AAAAAAAAANEHEAAA                          Main, early ages shall give later now large funds; as certain accounts might decide narrowly then good decades; british, right questions make ju        Men                     7.51    336900.62        1.4252\n3   AAAAAAAACNCCEAAA                                                                                                                                                                                  Men                     3.50    303953.33        1.2858\n4   AAAAAAAAEBPOBAAA                                                           Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                      NaN    334919.14        1.4168\n5   AAAAAAAAEGEFAAAA                  Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN    386915.62        1.6367\n6   AAAAAAAAEOEIBAAA                                                                                                                                                            Total, very fo        Men                    12.72    302416.95        1.2793\n7   AAAAAAAAFAKKDAAA                                                                                                                                                                  Consider        Men                      NaN    318292.17        1.3464\n8   AAAAAAAAGIGEBAAA                                                                                                                                                               At least sm        Men                      NaN    293152.89        1.2401\n9   AAAAAAAAGKCHDAAA                                                                                                                                                                                  Men                     2.89    303819.22        1.2852\n10  AAAAAAAAGPDBDAAA                                                                                                                                                                                  Men                      NaN    346070.92        1.4640\n11  AAAAAAAAHFKFEAAA  Models can enjoy just social, public fingers. Black, good departments might mean clearly to a windows. Fortunate, unusual defendants struggle farmers; schools talk part        Men                     2.46    357230.66        1.5112\n12  AAAAAAAAJJAKDAAA                                                                                                                                                                Of course         Men                     6.19    303343.36        1.2832\n13  AAAAAAAAKADJEAAA                                                                                                                                                                                  Men                      NaN    320003.91        1.3537\n...*/",
                "retry_time": 0,
                "query_metrics": {
                    "elapsed_time": 0.495221,
                    "execution_time": 0.431055,
                    "compile_time": 0.000364,
                    "planning_time": 0.045806
                },
                "query_metrics_warm_up": {
                    "elapsed_time": 0.502362,
                    "execution_time": 0.441641,
                    "compile_time": 0.000355,
                    "planning_time": 0.041906
                }
            }
        ],
        "rewrite_main_query": [
            {
                "script": "SELECT \"ITEM\".\"I_ITEM_ID\" AS \"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\" AS \"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\" AS \"I_CATEGORY\", \"ITEM\".\"I_CLASS\" AS \"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" AS \"I_CURRENT_PRICE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") AS \"ITEMREVENUE\", SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\") * 100 / SUM(SUM(\"STORE_SALES\".\"SS_EXT_SALES_PRICE\")) OVER (PARTITION BY \"ITEM\".\"I_CLASS\") AS \"REVENUERATIO\" FROM \"STORE_SALES\" AS \"STORE_SALES\" JOIN \"DATE_DIM\" AS \"DATE_DIM\" ON \"DATE_DIM\".\"D_DATE\" <= TS_OR_DS_ADD('DAY', 30, DAY, TIMESTAMP) AND \"DATE_DIM\".\"D_DATE\" >= CAST('2001-03-17' AS DATE) AND \"DATE_DIM\".\"D_DATE_SK\" = \"STORE_SALES\".\"SS_SOLD_DATE_SK\" JOIN \"ITEM\" AS \"ITEM\" ON \"ITEM\".\"I_CATEGORY\" IN ('Men', 'Music', 'Shoes') AND \"ITEM\".\"I_ITEM_SK\" = \"STORE_SALES\".\"SS_ITEM_SK\" GROUP BY \"ITEM\".\"I_ITEM_ID\", \"ITEM\".\"I_ITEM_DESC\", \"ITEM\".\"I_CATEGORY\", \"ITEM\".\"I_CLASS\", \"ITEM\".\"I_CURRENT_PRICE\" ORDER BY \"I_CATEGORY\" NULLS LAST, \"I_CLASS\" NULLS LAST, \"I_ITEM_ID\" NULLS LAST, \"I_ITEM_DESC\" NULLS LAST, \"REVENUERATIO\" NULLS LAST LIMIT 100",
                "rewrite": null
            }
        ],
        "preview": "\n/*           i_item_id                                                                                                                                                               i_item_desc i_category i_class  i_current_price  itemrevenue  revenueratio\n0   AAAAAAAAABLKAAAA                 Always personal minutes can scream by a sums; hours might perceive glad, other police. Financial, anxious officers prove for a areas. Blue, good personne        Men                     3.43    370269.72        1.5663\n1   AAAAAAAAAMLDAAAA                                                                                                                                                                                  Men                      NaN    360327.67        1.5243\n2   AAAAAAAAANEHEAAA                          Main, early ages shall give later now large funds; as certain accounts might decide narrowly then good decades; british, right questions make ju        Men                     7.51    336900.62        1.4252\n3   AAAAAAAACNCCEAAA                                                                                                                                                                                  Men                     3.50    303953.33        1.2858\n4   AAAAAAAAEBPOBAAA                                                           Civil problems would go proud rules. Again fond ways can come yet regular industrial years. Guilty failures for        Men                      NaN    334919.14        1.4168\n5   AAAAAAAAEGEFAAAA                  Pale funds could accept relations. Mines would include thus historical tenants. Philosophical shoulders can understand significantly by now simple paren        Men                      NaN    386915.62        1.6367\n6   AAAAAAAAEOEIBAAA                                                                                                                                                            Total, very fo        Men                    12.72    302416.95        1.2793\n7   AAAAAAAAFAKKDAAA                                                                                                                                                                  Consider        Men                      NaN    318292.17        1.3464\n8   AAAAAAAAGIGEBAAA                                                                                                                                                               At least sm        Men                      NaN    293152.89        1.2401\n9   AAAAAAAAGKCHDAAA                                                                                                                                                                                  Men                     2.89    303819.22        1.2852\n10  AAAAAAAAGPDBDAAA                                                                                                                                                                                  Men                      NaN    346070.92        1.4640\n11  AAAAAAAAHFKFEAAA  Models can enjoy just social, public fingers. Black, good departments might mean clearly to a windows. Fortunate, unusual defendants struggle farmers; schools talk part        Men                     2.46    357230.66        1.5112\n12  AAAAAAAAJJAKDAAA                                                                                                                                                                Of course         Men                     6.19    303343.36        1.2832\n13  AAAAAAAAKADJEAAA                                                                                                                                                                                  Men                      NaN    320003.91        1.3537\n...*/"
    }
]